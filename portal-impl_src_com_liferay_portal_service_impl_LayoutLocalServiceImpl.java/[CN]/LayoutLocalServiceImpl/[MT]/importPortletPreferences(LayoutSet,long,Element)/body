{
  long defaultUserId=userLocalService.getDefaultUserId(layoutSet.getCompanyId());
  Iterator itr=parentEl.elements("portlet-preferences").iterator();
  while (itr.hasNext()) {
    Element el=(Element)itr.next();
    long ownerId=GetterUtil.getLong(el.attributeValue("owner-id"));
    int ownerType=GetterUtil.getInteger(el.attributeValue("owner-type"));
    boolean defaultUser=GetterUtil.getBoolean(el.attributeValue("default-user"));
    String portletId=el.attributeValue("portlet-id");
    String preferences=el.elementText("preferences");
    if (defaultUser) {
      ownerId=defaultUserId;
    }
    try {
      portletPreferencesLocalService.deletePortletPreferences(ownerId,ownerType,plid,portletId);
    }
 catch (    NoSuchPortletPreferencesException nsppe) {
    }
    long portletPreferencesId=counterLocalService.increment();
    PortletPreferences portletPreferences=portletPreferencesPersistence.create(portletPreferencesId);
    portletPreferences.setOwnerId(ownerId);
    portletPreferences.setOwnerType(ownerType);
    portletPreferences.setPlid(plid);
    portletPreferences.setPortletId(portletId);
    portletPreferences.setPreferences(preferences);
    portletPreferencesPersistence.update(portletPreferences);
  }
}
