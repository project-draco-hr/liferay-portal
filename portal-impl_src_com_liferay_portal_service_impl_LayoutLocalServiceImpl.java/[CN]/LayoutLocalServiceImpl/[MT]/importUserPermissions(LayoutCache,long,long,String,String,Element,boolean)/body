{
  Element userPermissionsEl=parentEl.element("user-permissions");
  if (userPermissionsEl == null) {
    return;
  }
  List userActionsEls=userPermissionsEl.elements("user-actions");
  for (int i=0; i < userActionsEls.size(); i++) {
    Element userActionsEl=(Element)userActionsEls.get(i);
    String emailAddress=userActionsEl.attributeValue("email-address");
    User user=layoutCache.getUser(companyId,groupId,emailAddress);
    if (user == null) {
      if (_log.isWarnEnabled()) {
        _log.warn("Ignoring permissions for user with email address " + emailAddress);
      }
    }
 else {
      List actions=getActions(userActionsEl);
      Resource resource=layoutCache.getResource(companyId,groupId,resourceName,ResourceImpl.SCOPE_INDIVIDUAL,resourcePrimKey,portletActions);
      permissionLocalService.setUserPermissions(user.getUserId(),(String[])actions.toArray(new String[0]),resource.getResourceId());
    }
  }
}
