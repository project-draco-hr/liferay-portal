{
  if (!DLStoreUtil.isValidName(fileName)) {
    throw new LARFileNameException(fileName);
  }
  Map<String,Serializable> settingsMap=ExportImportConfigurationSettingsMapFactory.buildSettingsMap(userId,groupId,privateLayout,layoutIds,parameterMap,startDate,endDate,null,null);
  ServiceContext serviceContext=new ServiceContext();
  ExportImportConfiguration exportImportConfiguration=exportImportConfigurationLocalService.addExportImportConfiguration(userId,groupId,taskName,StringPool.BLANK,ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT,settingsMap,WorkflowConstants.STATUS_DRAFT,serviceContext);
  Map<String,Serializable> taskContextMap=new HashMap<String,Serializable>();
  taskContextMap.put("exportImportConfigurationId",exportImportConfiguration.getExportImportConfigurationId());
  BackgroundTask backgroundTask=backgroundTaskLocalService.addBackgroundTask(userId,groupId,taskName,null,LayoutExportBackgroundTaskExecutor.class,taskContextMap,serviceContext);
  return backgroundTask.getBackgroundTaskId();
}
