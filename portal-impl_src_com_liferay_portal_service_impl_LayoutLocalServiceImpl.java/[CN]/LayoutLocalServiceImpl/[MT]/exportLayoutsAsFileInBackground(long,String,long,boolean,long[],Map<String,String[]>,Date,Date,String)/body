{
  if (!DLStoreUtil.isValidName(fileName)) {
    throw new LARFileNameException(fileName);
  }
  Map<String,Serializable> taskContextMap=BackgroundTaskContextMapFactory.buildTaskContextMap(userId,groupId,privateLayout,layoutIds,parameterMap,Constants.EXPORT,startDate,endDate,fileName);
  BackgroundTask backgroundTask=backgroundTaskLocalService.addBackgroundTask(userId,groupId,taskName,null,LayoutExportBackgroundTaskExecutor.class,taskContextMap,new ServiceContext());
  return backgroundTask.getBackgroundTaskId();
}
