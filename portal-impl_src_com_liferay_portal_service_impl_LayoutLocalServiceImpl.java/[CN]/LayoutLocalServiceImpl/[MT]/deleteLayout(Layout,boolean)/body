{
  List childLayouts=LayoutUtil.findByG_P_P(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId());
  for (int i=0; i < childLayouts.size(); i++) {
    Layout childLayout=(Layout)childLayouts.get(i);
    deleteLayout(childLayout,updateLayoutSet);
  }
  PortletPreferencesLocalServiceUtil.deletePortletPreferences(PortletKeys.PREFS_OWNER_ID_DEFAULT,PortletKeys.PREFS_OWNER_TYPE_LAYOUT,layout.getPlid());
  RatingsStatsLocalServiceUtil.deleteStats(Layout.class.getName(),layout.getPlid());
  MBMessageLocalServiceUtil.deleteDiscussionMessages(Layout.class.getName(),layout.getPlid());
  JournalContentSearchLocalServiceUtil.deleteLayoutContentSearches(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId());
  ImageLocalUtil.deleteImage(layout.getIconImageId());
  String primKey=layout.getPlid() + PortletImpl.LAYOUT_SEPARATOR + "%";
  Iterator itr=resourceFinder.findByC_P(layout.getCompanyId(),primKey).iterator();
  while (itr.hasNext()) {
    Resource resource=(Resource)itr.next();
    ResourceLocalServiceUtil.deleteResource(resource);
  }
  ResourceLocalServiceUtil.deleteResource(layout.getCompanyId(),Layout.class.getName(),ResourceImpl.SCOPE_INDIVIDUAL,layout.getPlid());
  LayoutUtil.remove(layout.getPlid());
  if (updateLayoutSet) {
    LayoutSetLocalServiceUtil.updatePageCount(layout.getGroupId(),layout.isPrivateLayout());
  }
}
