{
  Layout layout=getLayout(groupId,privateLayout,layoutId);
  List<PortletPreferences> portletPreferencesList=PortletPreferencesLocalServiceUtil.getPortletPreferencesByPlid(layout.getPlid());
  for (  PortletPreferences portletPreferences : portletPreferencesList) {
    String portletId=portletPreferences.getPortletId();
    javax.portlet.PortletPreferences preferences=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
    String scopeLayoutUuid=GetterUtil.getString(preferences.getValue("lfrScopeLayoutUuid",null));
    if (layout.getUuid().equals(scopeLayoutUuid)) {
      String portletTitle=PortalUtil.getPortletTitle(portletId,languageId);
      String newPortletTitle=PortalUtil.getNewPortletTitle(portletTitle,layout.getName(languageId),name);
      if (!newPortletTitle.equals(portletTitle)) {
        preferences.setValue("portlet-setup-title-" + languageId,newPortletTitle);
        preferences.setValue("portlet-setup-use-custom-title",Boolean.TRUE.toString());
      }
      preferences.store();
    }
  }
}
