{
  User user=userPersistence.findByPrimaryKey(userId);
  Map<String,Serializable> settingsMap=ExportImportConfigurationSettingsMapFactory.buildExportSettingsMap(userId,plid,groupId,portletId,parameterMap,Constants.EXPORT,startDate,endDate,user.getLocale(),user.getTimeZone(),fileName);
  ServiceContext serviceContext=new ServiceContext();
  ExportImportConfiguration exportImportConfiguration=exportImportConfigurationLocalService.addExportImportConfiguration(userId,groupId,taskName,StringPool.BLANK,ExportImportConfigurationConstants.TYPE_EXPORT_PORTLET,settingsMap,WorkflowConstants.STATUS_DRAFT,serviceContext);
  return exportPortletInfoAsFileInBackground(userId,exportImportConfiguration);
}
