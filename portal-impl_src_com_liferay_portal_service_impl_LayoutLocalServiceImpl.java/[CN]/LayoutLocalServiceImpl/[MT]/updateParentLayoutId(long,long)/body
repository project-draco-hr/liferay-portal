{
  Layout layout=layoutPersistence.findByPrimaryKey(plid);
  long parentLayoutId=LayoutConstants.DEFAULT_PARENT_LAYOUT_ID;
  if (parentPlid > 0) {
    Layout parentLayout=layoutPersistence.fetchByPrimaryKey(parentPlid);
    if (parentLayout != null) {
      parentLayoutId=parentLayout.getLayoutId();
    }
  }
  parentLayoutId=getParentLayoutId(layout.getGroupId(),layout.isPrivateLayout(),parentLayoutId);
  validateParentLayoutId(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),parentLayoutId);
  if (parentLayoutId != layout.getParentLayoutId()) {
    int priority=getNextPriority(layout.getGroupId(),layout.isPrivateLayout(),parentLayoutId);
    layout.setPriority(priority);
  }
  layout.setParentLayoutId(parentLayoutId);
  layoutPersistence.update(layout,false);
  return layout;
}
