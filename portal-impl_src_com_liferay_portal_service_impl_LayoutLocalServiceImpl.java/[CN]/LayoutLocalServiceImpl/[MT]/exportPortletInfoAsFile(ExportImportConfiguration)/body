{
  try {
    Map<String,Serializable> settingsMap=exportImportConfiguration.getSettingsMap();
    String portletId=MapUtil.getString(settingsMap,"portletId");
    Map<String,String[]> parameterMap=(Map<String,String[]>)settingsMap.get("parameterMap");
    long sourcePlid=MapUtil.getLong(settingsMap,"sourcePlid");
    long sourceGroupId=MapUtil.getLong(settingsMap,"sourceGroupId");
    DateRange dateRange=ExportImportDateUtil.getDateRange(exportImportConfiguration);
    PortletExporter portletExporter=PortletExporter.getInstance();
    return portletExporter.exportPortletInfoAsFile(sourcePlid,sourceGroupId,portletId,parameterMap,dateRange.getStartDate(),dateRange.getEndDate());
  }
 catch (  PortalException pe) {
    throw pe;
  }
catch (  SystemException se) {
    throw se;
  }
catch (  Exception e) {
    throw new SystemException(e);
  }
}
