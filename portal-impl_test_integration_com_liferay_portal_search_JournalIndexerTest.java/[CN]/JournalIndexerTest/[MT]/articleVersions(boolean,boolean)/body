{
  ServiceContext serviceContext=ServiceTestUtil.getServiceContext(_group.getGroupId());
  SearchContext searchContext1=ServiceTestUtil.getSearchContext(_group.getGroupId());
  searchContext1.setKeywords("Architectural");
  int initialSearchCount1=searchCount(_group.getGroupId(),searchContext1);
  SearchContext searchContext2=ServiceTestUtil.getSearchContext(_group.getGroupId());
  searchContext2.setKeywords("Apple");
  int initialSearchCount2=searchCount(_group.getGroupId(),searchContext2);
  JournalFolder folder=JournalTestUtil.addFolder(_group.getGroupId(),ServiceTestUtil.randomString());
  JournalArticle article=JournalTestUtil.addArticleWithWorkflow(_group.getGroupId(),folder.getFolderId(),"title","Liferay Architectural Approach",true);
  Assert.assertEquals(initialSearchCount1 + 1,searchCount(_group.getGroupId(),searchContext1));
  String content=DDMStructureTestUtil.getSampleStructuredContent("Apple tablet");
  serviceContext.setWorkflowAction(WorkflowConstants.ACTION_PUBLISH);
  article=JournalTestUtil.updateArticle(article,article.getTitle(),content,false,true,serviceContext);
  Assert.assertEquals(initialSearchCount1,searchCount(_group.getGroupId(),searchContext1));
  Assert.assertEquals(initialSearchCount2 + 1,searchCount(_group.getGroupId(),searchContext2));
  if (all) {
    if (delete) {
      JournalArticleLocalServiceUtil.deleteArticle(_group.getGroupId(),article.getArticleId(),serviceContext);
    }
 else {
      JournalArticleLocalServiceUtil.expireArticle(TestPropsValues.getUserId(),_group.getGroupId(),article.getArticleId(),article.getUrlTitle(),serviceContext);
    }
    Assert.assertEquals(initialSearchCount1,searchCount(_group.getGroupId(),searchContext1));
  }
 else {
    if (delete) {
      JournalArticleLocalServiceUtil.deleteArticle(article);
    }
 else {
      JournalArticleLocalServiceUtil.expireArticle(TestPropsValues.getUserId(),_group.getGroupId(),article.getArticleId(),article.getVersion(),article.getUrlTitle(),serviceContext);
    }
    Assert.assertEquals(initialSearchCount1 + 1,searchCount(_group.getGroupId(),searchContext1));
  }
  Assert.assertEquals(initialSearchCount2,searchCount(_group.getGroupId(),searchContext2));
}
