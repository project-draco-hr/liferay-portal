{
  HttpServletRequest httpReq=null;
  if (req instanceof ActionRequestImpl) {
    httpReq=((ActionRequestImpl)req).getHttpServletRequest();
    String contentType=httpReq.getHeader(HttpHeaders.CONTENT_TYPE);
    if ((contentType != null) && (contentType.startsWith(ContentTypes.MULTIPART_FORM_DATA))) {
      try {
        httpReq=new UploadServletRequest(httpReq);
      }
 catch (      IOException ioe) {
      }
      httpReq=new LiferayStrutsRequestImpl(httpReq);
    }
 else {
      httpReq=new LiferayStrutsRequestImpl((ActionRequestImpl)req);
    }
  }
 else {
    httpReq=new LiferayStrutsRequestImpl((RenderRequestImpl)req);
  }
  return httpReq;
}
