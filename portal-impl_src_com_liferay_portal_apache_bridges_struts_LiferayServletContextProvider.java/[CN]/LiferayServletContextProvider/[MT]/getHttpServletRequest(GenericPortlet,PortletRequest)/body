{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(portletRequest);
  if (portletRequest instanceof ActionRequest) {
    String contentType=request.getHeader(HttpHeaders.CONTENT_TYPE);
    if ((contentType != null) && (contentType.startsWith(ContentTypes.MULTIPART_FORM_DATA))) {
      request=new UploadServletRequestImpl(request);
      request=new LiferayStrutsRequestImpl(request);
    }
 else {
      request=new LiferayStrutsRequestImpl(request);
    }
  }
 else {
    request=new LiferayStrutsRequestImpl(request);
  }
  return request;
}
