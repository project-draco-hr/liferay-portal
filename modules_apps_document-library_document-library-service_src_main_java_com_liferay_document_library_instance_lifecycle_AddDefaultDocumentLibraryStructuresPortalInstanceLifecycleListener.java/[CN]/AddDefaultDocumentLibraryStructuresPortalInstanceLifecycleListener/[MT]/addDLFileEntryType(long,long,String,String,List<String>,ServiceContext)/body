{
  List<Long> ddmStructureIds=new ArrayList<>();
  for (  String ddmStructureName : ddmStructureNames) {
    String ddmStructureKey=ddmStructureName;
    DDMStructure ddmStructure=_ddmStructureLocalService.fetchStructure(groupId,PortalUtil.getClassNameId(DLFileEntryMetadata.class),ddmStructureKey);
    if (ddmStructure == null) {
      continue;
    }
    ddmStructureIds.add(ddmStructure.getStructureId());
  }
  Locale locale=PortalUtil.getSiteDefaultLocale(groupId);
  String definition=_defaultDDMStructureHelper.getDynamicDDMStructureDefinition(getClassLoader(),"com/liferay/document/library/events/dependencies" + "/document-library-structures.xml",languageKey,locale);
  DDMForm ddmForm=_ddmFormXSDDeserializer.deserialize(definition);
  serviceContext.setAttribute("ddmForm",_ddmBeanTranslator.translate(ddmForm));
  DLFileEntryType dlFileEntryType=_dlFileEntryTypeLocalService.fetchFileEntryType(groupId,dlFileEntryTypeKey);
  if (dlFileEntryType == null) {
    Map<Locale,String> localizationMap=new HashMap<>();
    for (    Locale curLocale : LanguageUtil.getAvailableLocales(groupId)) {
      localizationMap.put(curLocale,LanguageUtil.get(curLocale,languageKey));
    }
    _dlFileEntryTypeLocalService.addFileEntryType(userId,groupId,dlFileEntryTypeKey,localizationMap,localizationMap,ArrayUtil.toArray(ddmStructureIds.toArray(new Long[ddmStructureIds.size()])),serviceContext);
  }
}
