{
  List<TemplateNode> templateNodes=new ArrayList<TemplateNode>();
  Map<String,TemplateNode> prototypeTemplateNodes=new HashMap<String,TemplateNode>();
  List<Element> dynamicElementElements=element.elements("dynamic-element");
  for (  Element dynamicElementElement : dynamicElementElements) {
    Element dynamicContentElement=dynamicElementElement.element("dynamic-content");
    String data=StringPool.BLANK;
    if (dynamicContentElement != null) {
      data=dynamicContentElement.getText();
    }
    String name=dynamicElementElement.attributeValue("name",StringPool.BLANK);
    if (name.length() == 0) {
      throw new TransformException("Element missing \"name\" attribute");
    }
    String type=dynamicElementElement.attributeValue("type",StringPool.BLANK);
    TemplateNode templateNode=new TemplateNode(getThemeDisplay(),name,stripCDATA(data),type);
    if (dynamicElementElement.element("dynamic-element") != null) {
      templateNode.appendChildren(getTemplateNodes(dynamicElementElement));
    }
 else     if ((dynamicContentElement != null) && (dynamicContentElement.element("option") != null)) {
      List<Element> optionElements=dynamicContentElement.elements("option");
      for (      Element optionElement : optionElements) {
        templateNode.appendOption(stripCDATA(optionElement.getText()));
      }
    }
    TemplateNode prototypeTemplateNode=prototypeTemplateNodes.get(name);
    if (prototypeTemplateNode == null) {
      prototypeTemplateNode=templateNode;
      prototypeTemplateNodes.put(name,prototypeTemplateNode);
      templateNodes.add(templateNode);
    }
    prototypeTemplateNode.appendSibling(templateNode);
  }
  return templateNodes;
}
