{
  String[] sourceFileNames=sourceDirectory.listAll();
  Arrays.sort(sourceFileNames);
  String[] targetFileNames=targetDirectory.listAll();
  Arrays.sort(targetFileNames);
  if (sourceFileNames.length != targetFileNames.length) {
    Assert.fail(Arrays.toString(sourceFileNames) + " does not have the same length as " + Arrays.toString(targetFileNames));
  }
  for (  String fileName : sourceFileNames) {
    long sourceLength=sourceDirectory.fileLength(fileName);
    long targetLength=targetDirectory.fileLength(fileName);
    if (sourceLength != targetLength) {
      Assert.fail(fileName + " has different source and target lengths");
    }
    _assertContent(fileName,sourceDirectory.openInput(fileName),targetDirectory.openInput(fileName));
  }
}
