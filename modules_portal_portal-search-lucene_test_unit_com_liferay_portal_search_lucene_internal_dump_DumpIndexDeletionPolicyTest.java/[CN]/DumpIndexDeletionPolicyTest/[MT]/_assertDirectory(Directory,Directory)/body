{
  String[] sourceFileNames=sourceDirectory.listAll();
  Arrays.sort(sourceFileNames);
  String[] targetFileNames=targetDirectory.listAll();
  Arrays.sort(targetFileNames);
  Assert.assertEquals(Arrays.toString(sourceFileNames) + " does not have the same length as " + Arrays.toString(targetFileNames),sourceFileNames.length,targetFileNames.length);
  for (  String fileName : sourceFileNames) {
    long sourceLength=sourceDirectory.fileLength(fileName);
    long targetLength=targetDirectory.fileLength(fileName);
    Assert.assertEquals(fileName + " has different source and target lengths",sourceLength,targetLength);
    _assertContent(fileName,sourceDirectory.openInput(fileName),targetDirectory.openInput(fileName));
  }
}
