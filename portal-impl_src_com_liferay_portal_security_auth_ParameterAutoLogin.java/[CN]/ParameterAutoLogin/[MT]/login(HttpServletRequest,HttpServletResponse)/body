{
  try {
    String login=ParamUtil.getString(request,getLoginParam());
    if (Validator.isNull(login)) {
      return null;
    }
    String password=ParamUtil.getString(request,getPasswordParam());
    if (Validator.isNull(password)) {
      return null;
    }
    Company company=PortalUtil.getCompany(request);
    String authType=company.getAuthType();
    long userId=0;
    if (authType.equals(CompanyConstants.AUTH_TYPE_EA)) {
      userId=UserLocalServiceUtil.getUserIdByEmailAddress(company.getCompanyId(),login);
    }
 else     if (authType.equals(CompanyConstants.AUTH_TYPE_SN)) {
      userId=UserLocalServiceUtil.getUserIdByScreenName(company.getCompanyId(),login);
    }
 else     if (authType.equals(CompanyConstants.AUTH_TYPE_ID)) {
      userId=GetterUtil.getLong(login);
    }
 else {
      return null;
    }
    if (userId > 0) {
      User user=UserLocalServiceUtil.getUserById(userId);
      String encPassword=PwdEncryptor.encrypt(password,user.getPassword());
      if (!user.getPassword().equals(encPassword)) {
        return null;
      }
    }
    String[] credentials=new String[]{String.valueOf(userId),password,Boolean.FALSE.toString()};
    return credentials;
  }
 catch (  Exception e) {
    throw new AutoLoginException(e);
  }
}
