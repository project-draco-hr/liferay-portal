{
  Serializer serializer=new Serializer();
  serializer.index=1;
  try {
    serializer.getBuffer(Integer.MAX_VALUE);
    Assert.fail();
  }
 catch (  OutOfMemoryError oome) {
  }
  byte[] bytes=new byte[_COUNT];
  _random.nextBytes(bytes);
  serializer.buffer=bytes;
  serializer.index=bytes.length;
  byte[] newBytes=serializer.getBuffer(1);
  Assert.assertEquals(bytes.length * 2,newBytes.length);
  for (int i=0; i < bytes.length; i++) {
    Assert.assertEquals(bytes[i],newBytes[i]);
  }
  for (int i=bytes.length; i < newBytes.length; i++) {
    Assert.assertEquals(0,newBytes[i]);
  }
  serializer.buffer=bytes;
  serializer.index=bytes.length;
  newBytes=serializer.getBuffer(_COUNT + 1);
  Assert.assertEquals(bytes.length * 2 + 1,newBytes.length);
  for (int i=0; i < bytes.length; i++) {
    Assert.assertEquals(bytes[i],newBytes[i]);
  }
  for (int i=bytes.length; i < newBytes.length; i++) {
    Assert.assertEquals(0,newBytes[i]);
  }
}
