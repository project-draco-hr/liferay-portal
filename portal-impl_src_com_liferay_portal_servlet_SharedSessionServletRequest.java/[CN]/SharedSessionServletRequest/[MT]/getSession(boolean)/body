{
  if (create) {
    checkPortalSession();
  }
  if (_shared) {
    return _portalSession;
  }
  HttpSession portletSession=super.getSession(create);
  if ((portletSession != null) && (portletSession != _portalSession)) {
    SPIAgentRequest.populatePortletSessionAttributes(this,portletSession);
    return getSharedSessionWrapper(_portalSession,portletSession);
  }
  return portletSession;
}
