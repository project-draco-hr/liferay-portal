{
  if (create) {
    checkPortalSession();
  }
  if (_shared || isPortletConfigurationPortlet()) {
    return _portalSession;
  }
 else {
    HttpSession portletSession=super.getSession(create);
    if (portletSession != null) {
      return getSharedSessionWrapper(_portalSession,portletSession);
    }
    return null;
  }
}
