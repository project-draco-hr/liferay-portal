{
  if (pollerHeader == null) {
    return null;
  }
  boolean suspendPolling=false;
  if (pollerHeader.isStartPolling()) {
    BrowserTrackerLocalServiceUtil.updateBrowserTracker(pollerHeader.getUserId(),pollerHeader.getBrowserKey());
  }
 else {
    BrowserTracker browserTracker=BrowserTrackerLocalServiceUtil.getBrowserTracker(pollerHeader.getUserId(),pollerHeader.getBrowserKey());
    if (browserTracker.getBrowserKey() != pollerHeader.getBrowserKey()) {
      suspendPolling=true;
    }
  }
  JSONObject pollerResponseHeaderJSONObject=JSONFactoryUtil.createJSONObject();
  pollerResponseHeaderJSONObject.put("userId",pollerHeader.getUserId());
  pollerResponseHeaderJSONObject.put("initialRequest",pollerHeader.isInitialRequest());
  pollerResponseHeaderJSONObject.put("suspendPolling",suspendPolling);
  return pollerResponseHeaderJSONObject;
}
