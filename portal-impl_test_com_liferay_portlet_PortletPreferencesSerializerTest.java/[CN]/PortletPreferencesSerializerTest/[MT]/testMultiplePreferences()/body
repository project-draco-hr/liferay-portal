{
  String expectXML="<portlet-preferences><preference><name>testPreference</name>" + "<value>testValue1</value><value>testValue2</value>" + "</preference></portlet-preferences>";
  PortletPreferencesImpl preferences=new PortletPreferencesImpl();
  String[] values={"testValue1","testValue2"};
  preferences.setValues("testPreference",values);
  String resultXML=PortletPreferencesSerializer.toXML(preferences);
  assertEquals(expectXML,resultXML);
  PortletPreferencesImpl resultPreferences=(PortletPreferencesImpl)PortletPreferencesSerializer.fromDefaultXML(expectXML);
  Map<String,Preference> preferenceMap=resultPreferences.getPreferences();
  assertEquals(1,preferenceMap.size());
  Preference preference=preferenceMap.values().iterator().next();
  assertEquals("testPreference",preference.getName());
  values=preference.getValues();
  assertEquals(2,values.length);
  assertEquals("testValue1",values[0]);
  assertEquals("testValue2",values[1]);
}
