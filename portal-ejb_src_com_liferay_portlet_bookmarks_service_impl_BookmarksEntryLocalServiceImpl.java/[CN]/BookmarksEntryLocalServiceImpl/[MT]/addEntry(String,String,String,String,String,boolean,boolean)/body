{
  User user=UserUtil.findByPrimaryKey(userId);
  BookmarksFolder folder=BookmarksFolderUtil.findByPrimaryKey(folderId);
  if (Validator.isNull(name)) {
    name=url;
  }
  Date now=new Date();
  validate(url);
  String entryId=Long.toString(CounterLocalServiceUtil.increment(BookmarksEntry.class.getName()));
  BookmarksEntry entry=BookmarksEntryUtil.create(entryId);
  entry.setCompanyId(user.getCompanyId());
  entry.setUserId(user.getUserId());
  entry.setCreateDate(now);
  entry.setModifiedDate(now);
  entry.setFolderId(folderId);
  entry.setName(name);
  entry.setUrl(url);
  entry.setComments(comments);
  BookmarksEntryUtil.update(entry);
  addEntryResources(folder,entry,addCommunityPermissions,addGuestPermissions);
  return entry;
}
