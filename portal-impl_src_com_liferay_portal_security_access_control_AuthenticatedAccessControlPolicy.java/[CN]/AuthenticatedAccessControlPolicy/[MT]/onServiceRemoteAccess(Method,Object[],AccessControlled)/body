{
  AccessControlContext accessControlContext=AccessControlUtil.getAccessControlContext();
  if (accessControlContext != null) {
    Map<String,Object> settings=accessControlContext.getSettings();
    int serviceDepthCounter=(Integer)settings.get(AccessControlContext.Settings.SERVICE_DEPTH_COUNTER.toString());
    if (serviceDepthCounter > 1) {
      return;
    }
  }
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  ServiceAccessPolicyManager serviceAccessControlProfileManager=ServiceAccessPolicyManagerUtil.getServiceAccessPolicyManager();
  if ((serviceAccessControlProfileManager == null) && !accessControlled.guestAccessEnabled() && ((permissionChecker == null) || !permissionChecker.isSignedIn())) {
    throw new SecurityException("Authenticated access required");
  }
}
