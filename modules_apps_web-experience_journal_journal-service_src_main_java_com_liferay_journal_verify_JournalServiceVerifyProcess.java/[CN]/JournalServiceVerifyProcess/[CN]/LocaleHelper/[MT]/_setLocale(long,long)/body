{
  Locale siteDefaultLocale=_sitesDefaultLocale.get(groupId);
  if (siteDefaultLocale == null) {
    Locale companyDefaultLocale=_companiesDefaultLocale.get(companyId);
    if (companyDefaultLocale == null) {
      User defaultUser=_userLocalService.getDefaultUser(companyId);
      companyDefaultLocale=LocaleUtil.fromLanguageId(defaultUser.getLanguageId());
      _companiesDefaultLocale.put(companyId,companyDefaultLocale);
    }
    LocaleThreadLocal.setDefaultLocale(companyDefaultLocale);
    siteDefaultLocale=PortalUtil.getSiteDefaultLocale(groupId);
  }
  LocaleThreadLocal.setSiteDefaultLocale(siteDefaultLocale);
  _sitesDefaultLocale.put(groupId,siteDefaultLocale);
}
