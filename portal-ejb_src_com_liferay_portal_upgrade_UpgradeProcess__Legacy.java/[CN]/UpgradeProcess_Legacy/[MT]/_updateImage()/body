{
  Iterator itr=ImageLocalServiceUtil.search("%.ig.%").iterator();
  while (itr.hasNext()) {
    Image image=(Image)itr.next();
    String oldImageId=image.getImageId();
    String newImageId=StringUtil.replace(oldImageId,".ig.",".image_gallery.");
    if (newImageId.endsWith(".tn")) {
      newImageId=newImageId.substring(0,newImageId.length() - 2) + "small";
    }
 else {
      newImageId=newImageId + ".large";
    }
    ImageLocalServiceUtil.updateImage(newImageId,image.getTextObj());
    ImageLocalServiceUtil.deleteImage(oldImageId);
  }
  itr=ImageLocalServiceUtil.search("%.s.%").iterator();
  while (itr.hasNext()) {
    Image image=(Image)itr.next();
    String oldImageId=image.getImageId();
    String newImageId=StringUtil.replace(oldImageId,".s.",".shopping.item.");
    ImageLocalServiceUtil.updateImage(newImageId,image.getTextObj());
    ImageLocalServiceUtil.deleteImage(oldImageId);
  }
}
