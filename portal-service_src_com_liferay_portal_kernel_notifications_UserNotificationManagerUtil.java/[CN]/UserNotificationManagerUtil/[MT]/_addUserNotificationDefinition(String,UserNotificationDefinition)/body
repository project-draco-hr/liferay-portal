{
  Registry registry=RegistryUtil.getRegistry();
  Map<String,Object> properties=new HashMap<>();
  properties.put("javax.portlet.name",portletId);
  ServiceRegistration<UserNotificationDefinition> serviceRegistration=registry.registerService(UserNotificationDefinition.class,userNotificationDefinition,properties);
  List<ServiceRegistration<UserNotificationDefinition>> serviceRegistrations=new ArrayList<>();
  List<ServiceRegistration<UserNotificationDefinition>> userNotificationServiceRegistrations=_userNotificationDefinitionServiceRegistrations.get(portletId);
  if ((userNotificationServiceRegistrations != null) && !userNotificationServiceRegistrations.isEmpty()) {
    serviceRegistrations.addAll(userNotificationServiceRegistrations);
  }
  serviceRegistrations.add(serviceRegistration);
  _userNotificationDefinitionServiceRegistrations.put(portletId,serviceRegistrations);
}
