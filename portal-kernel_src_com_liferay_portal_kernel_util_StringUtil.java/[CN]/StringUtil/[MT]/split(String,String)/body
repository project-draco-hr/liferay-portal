{
  if ((Validator.isNull(s)) || (delimiter == null) || (delimiter.equals(StringPool.BLANK))) {
    return new String[0];
  }
  s=s.trim();
  if (!s.endsWith(delimiter)) {
    StringBuilder sb=new StringBuilder();
    sb.append(s);
    sb.append(delimiter);
    s=sb.toString();
  }
  if (s.equals(delimiter)) {
    return new String[0];
  }
  List<String> nodeValues=new ArrayList<String>();
  if (delimiter.equals(StringPool.NEW_LINE) || delimiter.equals(StringPool.RETURN)) {
    try {
      UnsyncBufferedReader unsyncBufferedReader=new UnsyncBufferedReader(new UnsyncStringReader(s));
      String line=null;
      while ((line=unsyncBufferedReader.readLine()) != null) {
        nodeValues.add(line);
      }
      unsyncBufferedReader.close();
    }
 catch (    IOException ioe) {
      _log.error(ioe.getMessage());
    }
  }
 else {
    int offset=0;
    int pos=s.indexOf(delimiter,offset);
    while (pos != -1) {
      nodeValues.add(new String(s.substring(offset,pos)));
      offset=pos + delimiter.length();
      pos=s.indexOf(delimiter,offset);
    }
  }
  return nodeValues.toArray(new String[nodeValues.size()]);
}
