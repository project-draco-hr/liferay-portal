{
  Layout layout=null;
  if (isLayout) {
    long groupId=ParamUtil.getLong(actionRequest,"groupId");
    boolean privateLayout=ParamUtil.getBoolean(actionRequest,"privateLayout");
    long layoutId=ParamUtil.getLong(actionRequest,"layoutId");
    layout=layoutLocalService.getLayout(groupId,privateLayout,layoutId);
  }
  for (  Map.Entry<String,ThemeSetting> entry : themeSettings.entrySet()) {
    String key=entry.getKey();
    ThemeSetting themeSetting=entry.getValue();
    String property=device + "ThemeSettingsProperties--" + key+ StringPool.DOUBLE_DASH;
    String value=ParamUtil.getString(actionRequest,property,themeSetting.getValue());
    if ((isLayout && !Objects.equals(value,layout.getDefaultThemeSetting(key,device,false))) || (!isLayout && !value.equals(themeSetting.getValue()))) {
      typeSettingsProperties.setProperty(ThemeSettingImpl.namespaceProperty(device,key),value);
    }
  }
}
