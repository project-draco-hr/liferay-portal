{
  Company company=companyPersistence.findByPrimaryKey(companyId);
  if (company.getVirtualHost().equals(CompanyConstants.WSRP_VIRTUAL_HOST)) {
    return;
  }
  if (!autoScreenName) {
    validateScreenName(companyId,userId,screenName);
  }
  if (!autoPassword) {
    PasswordPolicy passwordPolicy=passwordPolicyLocalService.getDefaultPasswordPolicy(companyId);
    PwdToolkitUtil.validate(companyId,0,password1,password2,passwordPolicy);
  }
  validateEmailAddress(emailAddress);
  User user=userPersistence.fetchByC_EA(companyId,emailAddress);
  if (user != null) {
    throw new DuplicateUserEmailAddressException();
  }
  String[] reservedEmailAddresses=PrefsPropsUtil.getStringArray(companyId,PropsKeys.ADMIN_RESERVED_EMAIL_ADDRESSES,StringPool.NEW_LINE,PropsValues.ADMIN_RESERVED_EMAIL_ADDRESSES);
  for (int i=0; i < reservedEmailAddresses.length; i++) {
    if (emailAddress.equalsIgnoreCase(reservedEmailAddresses[i])) {
      throw new ReservedUserEmailAddressException();
    }
  }
  if (Validator.isNull(firstName)) {
    throw new ContactFirstNameException();
  }
 else   if (Validator.isNull(lastName)) {
    throw new ContactLastNameException();
  }
}
