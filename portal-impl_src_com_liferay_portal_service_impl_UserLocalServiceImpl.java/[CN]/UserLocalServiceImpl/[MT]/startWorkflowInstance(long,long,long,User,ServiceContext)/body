{
  final boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
  Callable<Void> callable=new ShardCallable<Void>(companyId){
    @Override protected Void doCall() throws Exception {
      boolean currentWorkflowEnabled=WorkflowThreadLocal.isEnabled();
      try {
        WorkflowThreadLocal.setEnabled(workflowEnabled);
        WorkflowHandlerRegistryUtil.startWorkflowInstance(companyId,workflowUserId,User.class.getName(),userId,user,workflowServiceContext);
        return null;
      }
  finally {
        WorkflowThreadLocal.setEnabled(currentWorkflowEnabled);
      }
    }
  }
;
  TransactionCommitCallbackRegistryUtil.registerCallback(callable);
}
