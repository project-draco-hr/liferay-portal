{
  groupPersistence.addUsers(groupId,userIds);
  Group group=groupPersistence.findByPrimaryKey(groupId);
  Role role=rolePersistence.findByC_N(group.getCompanyId(),RoleConstants.COMMUNITY_MEMBER);
  for (int i=0; i < userIds.length; i++) {
    long userId=userIds[i];
    userGroupRoleLocalService.addUserGroupRoles(userId,groupId,new long[]{role.getRoleId()});
  }
  try {
    UserIndexer.updateUsers(userIds);
  }
 catch (  SearchException se) {
    _log.error("Indexing " + StringUtil.merge(userIds),se);
  }
  PermissionCacheUtil.clearCache();
}
