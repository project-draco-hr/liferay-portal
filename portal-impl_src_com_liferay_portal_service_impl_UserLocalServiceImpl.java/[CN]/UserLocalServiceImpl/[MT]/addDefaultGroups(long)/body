{
  User user=userPersistence.findByPrimaryKey(userId);
  Set<Long> groupIdsSet=new HashSet<Long>();
  long companyId=user.getCompanyId();
  String[] defaultGroupNames=PrefsPropsUtil.getStringArray(companyId,PropsKeys.ADMIN_DEFAULT_GROUP_NAMES,StringPool.NEW_LINE,PropsValues.ADMIN_DEFAULT_GROUP_NAMES);
  for (  String defaultGroupName : defaultGroupNames) {
    try {
      Company company=CompanyLocalServiceUtil.getCompany(companyId);
      Account account=company.getAccount();
      if (defaultGroupName.equals(account.getName())) {
        defaultGroupName=GroupConstants.GUEST;
      }
      Group group=groupPersistence.findByC_N(user.getCompanyId(),defaultGroupName);
      if (!userPersistence.containsGroup(userId,group.getGroupId())) {
        groupIdsSet.add(group.getGroupId());
      }
    }
 catch (    NoSuchGroupException nsge) {
    }
  }
  long[] groupIds=ArrayUtil.toArray(groupIdsSet.toArray(new Long[groupIdsSet.size()]));
  groupLocalService.addUserGroups(userId,groupIds);
}
