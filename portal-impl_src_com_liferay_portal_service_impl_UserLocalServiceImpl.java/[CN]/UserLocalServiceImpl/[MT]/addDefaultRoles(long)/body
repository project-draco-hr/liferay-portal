{
  User user=userPersistence.findByPrimaryKey(userId);
  Set<Long> roleIdSet=new HashSet<>();
  String[] defaultRoleNames=PrefsPropsUtil.getStringArray(user.getCompanyId(),PropsKeys.ADMIN_DEFAULT_ROLE_NAMES,StringPool.NEW_LINE,PropsValues.ADMIN_DEFAULT_ROLE_NAMES);
  for (  String defaultRoleName : defaultRoleNames) {
    Role role=rolePersistence.fetchByC_N(user.getCompanyId(),defaultRoleName);
    if ((role != null) && (role.getType() == RoleConstants.TYPE_REGULAR)) {
      roleIdSet.add(role.getRoleId());
    }
  }
  long[] roleIds=ArrayUtil.toArray(roleIdSet.toArray(new Long[roleIdSet.size()]));
  roleIds=UsersAdminUtil.addRequiredRoles(user,roleIds);
  userPersistence.addRoles(userId,roleIds);
}
