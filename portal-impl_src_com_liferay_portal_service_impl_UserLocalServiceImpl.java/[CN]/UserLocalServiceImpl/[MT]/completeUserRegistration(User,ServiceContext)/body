{
  boolean autoPassword=GetterUtil.getBoolean(serviceContext.getAttribute("autoPassword"));
  String password=null;
  if (autoPassword) {
    PasswordPolicy passwordPolicy=passwordPolicyLocalService.getPasswordPolicy(user.getCompanyId(),user.getOrganizationIds());
    password=PwdToolkitUtil.generate(passwordPolicy);
  }
  boolean sendEmail=GetterUtil.getBoolean(serviceContext.getAttribute("sendEmail"));
  if (sendEmail) {
    try {
      sendEmail(user,password);
    }
 catch (    IOException ioe) {
      throw new SystemException(ioe);
    }
  }
}
