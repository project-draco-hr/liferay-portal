{
  if (Validator.isNull(emailAddress) && !PropsValues.USERS_EMAIL_ADDRESS_REQUIRED) {
    return;
  }
  EmailAddressValidator emailAddressValidator=EmailAddressValidatorFactory.getInstance();
  if (!emailAddressValidator.validate(companyId,emailAddress)) {
    throw new UserEmailAddressException();
  }
  String pop3User=PrefsPropsUtil.getString(PropsKeys.MAIL_SESSION_MAIL_POP3_USER,PropsValues.MAIL_SESSION_MAIL_POP3_USER);
  if (emailAddress.equalsIgnoreCase(pop3User)) {
    throw new ReservedUserEmailAddressException();
  }
  String[] reservedEmailAddresses=PrefsPropsUtil.getStringArray(companyId,PropsKeys.ADMIN_RESERVED_EMAIL_ADDRESSES,StringPool.NEW_LINE,PropsValues.ADMIN_RESERVED_EMAIL_ADDRESSES);
  for (  String reservedEmailAddress : reservedEmailAddresses) {
    if (emailAddress.equalsIgnoreCase(reservedEmailAddress)) {
      throw new ReservedUserEmailAddressException();
    }
  }
}
