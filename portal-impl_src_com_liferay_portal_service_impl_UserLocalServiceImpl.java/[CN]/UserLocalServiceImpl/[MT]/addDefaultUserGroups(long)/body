{
  User user=userPersistence.findByPrimaryKey(userId);
  Set<Long> userGroupIdSet=new HashSet<>();
  String[] defaultUserGroupNames=PrefsPropsUtil.getStringArray(user.getCompanyId(),PropsKeys.ADMIN_DEFAULT_USER_GROUP_NAMES,StringPool.NEW_LINE,PropsValues.ADMIN_DEFAULT_USER_GROUP_NAMES);
  for (  String defaultUserGroupName : defaultUserGroupNames) {
    UserGroup userGroup=userGroupPersistence.fetchByC_N(user.getCompanyId(),defaultUserGroupName);
    if ((userGroup != null) && !userPersistence.containsUserGroup(userId,userGroup.getUserGroupId())) {
      userGroupIdSet.add(userGroup.getUserGroupId());
    }
  }
  long[] userGroupIds=ArrayUtil.toArray(userGroupIdSet.toArray(new Long[userGroupIdSet.size()]));
  if (PropsValues.USER_GROUPS_COPY_LAYOUTS_TO_USER_PERSONAL_SITE) {
    for (    long userGroupId : userGroupIds) {
      userGroupLocalService.copyUserGroupLayouts(userGroupId,userId);
    }
  }
  userPersistence.addUserGroups(userId,userGroupIds);
}
