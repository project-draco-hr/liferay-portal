{
  Role role=rolePersistence.findByPrimaryKey(roleId);
  String roleName=role.getName();
  if (roleName.equals(RoleConstants.USER) || (roleName.equals(RoleConstants.ADMINISTRATOR) && getRoleUsersCount(role.getRoleId()) <= 1)) {
    return;
  }
  rolePersistence.removeUsers(roleId,userIds);
  Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(User.class);
  indexer.reindex(userIds);
  PermissionCacheUtil.clearCache(userIds);
}
