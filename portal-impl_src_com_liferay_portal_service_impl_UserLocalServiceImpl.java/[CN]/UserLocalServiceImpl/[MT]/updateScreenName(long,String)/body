{
  User user=userPersistence.findByPrimaryKey(userId);
  screenName=getScreenName(screenName);
  validateScreenName(user.getCompanyId(),userId,screenName);
  user.setScreenName(screenName);
  userPersistence.update(user,false);
  Group group=groupLocalService.getUserGroup(user.getCompanyId(),userId);
  group.setFriendlyURL(StringPool.SLASH + screenName);
  groupPersistence.update(group,false);
  try {
    UserIndexer.updateUser(user);
  }
 catch (  SearchException se) {
    _log.error("Indexing " + user.getUserId(),se);
  }
}
