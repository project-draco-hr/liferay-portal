{
  User user=userPersistence.findByPrimaryKey(userId);
  if (!StringUtil.equalsIgnoreCase(user.getScreenName(),screenName)) {
    validateScreenName(user.getCompanyId(),userId,screenName);
  }
  validateEmailAddress(user.getCompanyId(),emailAddress);
  validateOpenId(user.getCompanyId(),userId,openId);
  if (!user.isDefaultUser()) {
    if (Validator.isNotNull(emailAddress) && !StringUtil.equalsIgnoreCase(user.getEmailAddress(),emailAddress)) {
      if (userPersistence.fetchByC_EA(user.getCompanyId(),emailAddress) != null) {
        throw new DuplicateUserEmailAddressException("{userId=" + userId + "}");
      }
    }
    validateFullName(user.getCompanyId(),firstName,middleName,lastName);
  }
  if (Validator.isNotNull(smsSn)) {
    throw new UserSmsException.MustNotBeNull();
  }
 else   if (!Validator.isEmailAddress(smsSn)) {
    throw new UserSmsException.MustBeValidEmailAddress(smsSn);
  }
}
