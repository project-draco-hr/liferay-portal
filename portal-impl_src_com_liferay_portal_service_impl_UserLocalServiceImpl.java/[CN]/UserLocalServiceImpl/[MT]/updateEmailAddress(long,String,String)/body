{
  if (!emailAddress1.equals(emailAddress2)) {
    throw new UserEmailAddressException();
  }
  validateEmailAddress(emailAddress1,StringPool.DASH);
  User user=userPersistence.findByPrimaryKey(userId);
  checkInvalidEmailAddresses(user.getCompanyId(),emailAddress1);
  user.setEmailAddress(emailAddress1);
  userPersistence.update(user,false);
}
