{
  final User user=userPersistence.findByPrimaryKey(userId);
  user.setStatus(status);
  userPersistence.update(user,false);
  final Indexer indexer=IndexerRegistryUtil.getIndexer(User.class);
  TransactionCommitCallbackUtil.registerCallback(new Callable<Void>(){
    public Void call() throws Exception {
      indexer.reindex(user);
      return null;
    }
  }
);
  return user;
}
