{
  User user=userPersistence.findByPrimaryKey(userId);
  if ((status == WorkflowConstants.STATUS_APPROVED) && (user.getStatus() != WorkflowConstants.STATUS_APPROVED)) {
    validateCompanyMaxUsers(user.getCompanyId());
  }
  user.setStatus(status);
  userPersistence.update(user);
  reindex(user);
  return user;
}
