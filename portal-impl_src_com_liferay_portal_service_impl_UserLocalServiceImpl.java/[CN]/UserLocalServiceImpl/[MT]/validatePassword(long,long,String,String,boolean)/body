{
  if (Validator.isNull(password1) || Validator.isNull(password2)) {
    throw new UserPasswordException(UserPasswordException.PASSWORD_INVALID);
  }
  if (!password1.equals(password2)) {
    throw new UserPasswordException(UserPasswordException.PASSWORDS_DO_NOT_MATCH);
  }
  if (!skipPasswordPolicyValidation) {
    PasswordPolicy passwordPolicy=passwordPolicyLocalService.getPasswordPolicyByUserId(userId);
    PwdToolkitUtil.validate(companyId,userId,password1,password2,passwordPolicy);
  }
}
