{
  User user=null;
  try {
    if (authType.equals(CompanyImpl.AUTH_TYPE_EA)) {
      user=getUserByEmailAddress(companyId,login);
    }
 else     if (authType.equals(CompanyImpl.AUTH_TYPE_SN)) {
      user=getUserByScreenName(companyId,login);
    }
 else     if (authType.equals(CompanyImpl.AUTH_TYPE_ID)) {
      user=getUserById(companyId,Long.parseLong(login));
    }
    String userPassword=user.getPassword();
    if (user.isPasswordEncrypted()) {
      String encPassword=PwdEncryptor.encrypt(password);
      if (userPassword.equals(encPassword)) {
        return user.getUserId();
      }
    }
 else {
      if (userPassword.equals(password)) {
        return user.getUserId();
      }
    }
  }
 catch (  NoSuchUserException nsue) {
  }
  return -1;
}
