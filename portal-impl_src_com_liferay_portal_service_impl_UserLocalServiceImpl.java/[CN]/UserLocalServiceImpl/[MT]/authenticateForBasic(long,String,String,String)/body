{
  try {
    User user=null;
    if (authType.equals(CompanyImpl.AUTH_TYPE_EA)) {
      user=getUserByEmailAddress(companyId,login);
    }
 else     if (authType.equals(CompanyImpl.AUTH_TYPE_SN)) {
      user=getUserByScreenName(companyId,login);
    }
 else     if (authType.equals(CompanyImpl.AUTH_TYPE_ID)) {
      user=getUserById(companyId,GetterUtil.getLong(login));
    }
    String userPassword=user.getPassword();
    if (!user.isPasswordEncrypted()) {
      userPassword=PwdEncryptor.encrypt(userPassword);
    }
    String encPassword=PwdEncryptor.encrypt(password);
    if (userPassword.equals(password) || userPassword.equals(encPassword)) {
      return user.getUserId();
    }
  }
 catch (  NoSuchUserException nsue) {
  }
  return 0;
}
