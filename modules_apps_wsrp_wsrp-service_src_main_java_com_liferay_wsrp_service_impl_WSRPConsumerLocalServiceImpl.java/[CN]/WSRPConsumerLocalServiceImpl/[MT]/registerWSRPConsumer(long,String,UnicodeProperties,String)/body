{
  WSRPConsumer wsrpConsumer=wsrpConsumerPersistence.findByPrimaryKey(wsrpConsumerId);
  RegistrationContext registrationContext=null;
  if (registrationProperties != null) {
    try {
      registrationContext=register(wsrpConsumer,adminPortletId,registrationProperties);
    }
 catch (    PortalException pe) {
      throw pe;
    }
catch (    SystemException se) {
      throw se;
    }
catch (    Exception e) {
      throw new WSRPConsumerWSDLException(e);
    }
  }
 else   if (Validator.isNotNull(registrationHandle)) {
    registrationContext=new RegistrationContext();
    registrationContext.setRegistrationHandle(registrationHandle);
  }
  wsrpConsumer.setModifiedDate(new Date());
  wsrpConsumer.setRegistrationContext(registrationContext);
  wsrpConsumer.setRegistrationProperties(registrationProperties);
  wsrpConsumerPersistence.update(wsrpConsumer);
  return wsrpConsumer;
}
