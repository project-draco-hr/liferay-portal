{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  String portletId=portletDisplay.getId();
  if (portletId.equals(PortletKeys.PORTLET_CONFIGURATION)) {
    portletId=ParamUtil.getString(request,"portletResource");
  }
  DLPortletInstanceSettings dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(themeDisplay.getLayout(),portletId);
  return new DLActionsDisplayContext(request,dlPortletInstanceSettings);
}
