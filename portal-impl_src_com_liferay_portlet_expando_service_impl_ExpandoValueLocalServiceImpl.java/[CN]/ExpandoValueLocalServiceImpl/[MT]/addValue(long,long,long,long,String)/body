{
  validate(data);
  ExpandoRow row=expandoRowPersistence.fetchByT_C(tableId,classPK);
  if (row == null) {
    long rowId=counterLocalService.increment();
    row=expandoRowPersistence.create(rowId);
    row.setTableId(tableId);
    row.setClassPK(classPK);
    expandoRowPersistence.update(row,false);
  }
  ExpandoValue value=expandoValuePersistence.fetchByT_C_R(tableId,columnId,row.getRowId());
  if (value == null) {
    long valueId=counterLocalService.increment();
    value=expandoValuePersistence.create(valueId);
    value.setTableId(tableId);
    value.setColumnId(columnId);
    value.setRowId(row.getRowId());
    value.setClassNameId(classNameId);
    value.setClassPK(classPK);
  }
  value.setData(data);
  expandoValuePersistence.update(value,false);
  return value;
}
