{
  validate(data);
  ExpandoColumn column=expandoColumnPersistence.findByPrimaryKey(columnId);
  ExpandoValue value=expandoValuePersistence.fetchByT_C_R(column.getTableId(),columnId,rowId);
  if (value == null) {
    ExpandoTable table=expandoTablePersistence.findByPrimaryKey(column.getTableId());
    long valueId=counterLocalService.increment();
    value=expandoValuePersistence.create(valueId);
    value.setTableId(column.getTableId());
    value.setColumnId(columnId);
    value.setRowId(rowId);
    value.setClassNameId(table.getClassNameId());
    value.setClassPK(classPK);
  }
  value.setData(data);
  expandoValuePersistence.update(value,false);
  return value;
}
