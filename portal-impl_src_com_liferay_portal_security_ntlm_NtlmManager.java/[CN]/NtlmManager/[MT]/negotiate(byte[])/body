{
  try {
    Type1Message msg1=new Type1Message(material);
    _secureRandom.nextBytes(_serverChallenge);
    Type2Message msg2=new Type2Message(msg1.getFlags(),_serverChallenge,_domain);
    if (msg2.getFlag(NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY)) {
      msg2.setFlag(NtlmFlags.NTLMSSP_NEGOTIATE_LM_KEY,false);
      msg2.setFlag(NtlmFlags.NTLMSSP_NEGOTIATE_TARGET_INFO,true);
      msg2.setTargetInformation(getTargetInformation());
    }
    return msg2.toByteArray();
  }
 catch (  Exception e) {
    _log.error(e);
  }
  return null;
}
