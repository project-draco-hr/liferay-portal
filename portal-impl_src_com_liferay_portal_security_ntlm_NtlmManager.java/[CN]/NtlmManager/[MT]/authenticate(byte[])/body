{
  try {
    Type3Message msg3=new Type3Message(material);
    if (msg3.getFlag(NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY) && msg3.getNTResponse().length == 24) {
      MessageDigest md5=MessageDigest.getInstance("MD5");
      byte[] tmp=new byte[16];
      System.arraycopy(_serverChallenge,0,tmp,0,8);
      System.arraycopy(msg3.getLMResponse(),0,tmp,8,8);
      md5.update(tmp);
      _serverChallenge=md5.digest();
    }
    return NetlogonUtil.logon(msg3.getDomain(),msg3.getUser(),msg3.getWorkstation(),_serverChallenge,msg3.getNTResponse(),msg3.getLMResponse());
  }
 catch (  Exception e) {
    _log.error(e);
  }
  return null;
}
