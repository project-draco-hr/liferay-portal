{
  DLFolderPermission.check(getPermissionChecker(),serviceContext.getScopeGroupId(),folderId,ActionKeys.UPDATE);
  boolean hasLock=lockLocalService.hasLock(getUserId(),DLFolder.class.getName(),folderId);
  Lock lock=null;
  if (!hasLock) {
    lock=doLockFolder(folderId,null,false,DLFolderImpl.LOCK_EXPIRATION_TIME);
  }
  try {
    return dlFolderLocalService.updateFolder(folderId,name,description,defaultFileEntryTypeId,fileEntryTypeIds,overrideFileEntryTypes,serviceContext);
  }
  finally {
    if (!hasLock) {
      unlockFolder(serviceContext.getScopeGroupId(),folderId,lock.getUuid());
    }
  }
}
