{
  User user=getUser();
  DLFolderPermission.check(getPermissionChecker(),folderId,ActionKeys.UPDATE);
  boolean alreadyHasLock=lockService.hasLock(DLFolder.class.getName(),folderId,user.getUserId());
  Lock lock=null;
  if (!alreadyHasLock) {
    lock=lockFolder(folderId);
  }
  try {
    return dlFolderLocalService.updateFolder(folderId,parentFolderId,name,description);
  }
  finally {
    if (!alreadyHasLock) {
      unlockFolder(folderId,lock.getUuid());
    }
  }
}
