{
  if (sessionFactory == null) {
    return openSession();
  }
  Session session=sessionFactory.getCurrentSession();
  if (_log.isDebugEnabled()) {
    LiferayClassicSession classicSession=(LiferayClassicSession)session;
    SessionImpl sessionImpl=(SessionImpl)classicSession.getHibernateClassicSession();
    _log.debug("Session is using connection release mode " + sessionImpl.getConnectionReleaseMode());
  }
  return session;
}
