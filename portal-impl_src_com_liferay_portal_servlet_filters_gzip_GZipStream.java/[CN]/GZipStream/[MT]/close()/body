{
  if (_closed) {
    throw new IOException();
  }
  _gzipOutputStream.finish();
  int contentLength=_unsyncByteArrayOutputStream.size();
  _response.setContentLength(contentLength);
  _response.addHeader(HttpHeaders.CONTENT_ENCODING,_GZIP);
  _outputStream.write(_unsyncByteArrayOutputStream.unsafeGetByteArray(),0,contentLength);
  _outputStream.flush();
  _outputStream.close();
  _closed=true;
}
