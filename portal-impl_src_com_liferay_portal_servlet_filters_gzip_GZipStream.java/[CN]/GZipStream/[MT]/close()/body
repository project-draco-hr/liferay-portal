{
  if (_closed) {
    throw new IOException();
  }
  _gzipOutputStream.finish();
  byte[] bytes=_byteArrayOutputStream.toByteArray();
  _response.setContentLength(bytes.length);
  _response.addHeader(HttpHeaders.CONTENT_ENCODING,_GZIP);
  _outputStream.write(bytes);
  _outputStream.flush();
  _outputStream.close();
  _closed=true;
}
