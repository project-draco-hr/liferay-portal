{
  DoAsUserThread[] doAsUserThreads=new DoAsUserThread[THREAD_COUNT];
  for (int i=0; i < doAsUserThreads.length; i++) {
    String subject="Test Message " + i;
    doAsUserThreads[i]=new AddMessageThread(_userIds[i],subject);
  }
  for (  DoAsUserThread doAsUserThread : doAsUserThreads) {
    doAsUserThread.start();
  }
  for (  DoAsUserThread doAsUserThread : doAsUserThreads) {
    doAsUserThread.join();
  }
  int successCount=0;
  for (  DoAsUserThread doAsUserThread : doAsUserThreads) {
    if (doAsUserThread.isSuccess()) {
      successCount++;
    }
  }
  assertTrue("Only " + successCount + " out of "+ THREAD_COUNT+ " threads added messages successfully",successCount == THREAD_COUNT);
}
