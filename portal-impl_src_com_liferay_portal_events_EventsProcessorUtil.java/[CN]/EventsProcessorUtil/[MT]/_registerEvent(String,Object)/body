{
  Map<String,Object> properties=new HashMap<>();
  properties.put("key",key);
  Registry registry=RegistryUtil.getRegistry();
  ServiceRegistration<LifecycleAction> serviceRegistration=registry.registerService(LifecycleAction.class,(LifecycleAction)event,properties);
  Map<Object,ServiceRegistration<LifecycleAction>> serviceRegistrationMap=_serviceRegistrations.get(key);
  if (serviceRegistrationMap == null) {
    _serviceRegistrations.putIfAbsent(key,new ConcurrentHashMap<Object,ServiceRegistration<LifecycleAction>>());
    serviceRegistrationMap=_serviceRegistrations.get(key);
  }
  serviceRegistrationMap.put(event,serviceRegistration);
}
