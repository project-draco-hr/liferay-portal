{
  String factoryClassName=properties.getProperty(EhcacheConstants.CACHE_EVENT_LISTENER_FACTORY_CLASS_NAME);
  if (Validator.isNull(factoryClassName)) {
    return null;
  }
  try {
    CacheEventListenerFactory cacheEventListenerFactory=_cacheEventListenerFactories.get(factoryClassName);
    if (cacheEventListenerFactory == null) {
      cacheEventListenerFactory=(CacheEventListenerFactory)InstanceFactory.newInstance(ClassLoaderUtil.getPortalClassLoader(),factoryClassName);
      _cacheEventListenerFactories.put(factoryClassName,cacheEventListenerFactory);
    }
    CacheEventListener cacheEventListener=cacheEventListenerFactory.createCacheEventListener(properties);
    if (cacheEventListener instanceof net.sf.ehcache.distribution.CacheReplicator) {
      return new EhcacheCacheReplicatorAdapter(cacheEventListener);
    }
 else {
      return new EhcacheCacheListenerAdapter(cacheEventListener);
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  return null;
}
