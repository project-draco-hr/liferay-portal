{
  PortletPreferences portletSetup=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
  for (  Map.Entry<String,String> entry : preferences.entrySet()) {
    String key=entry.getKey();
    String value=entry.getValue();
    portletSetup.setValue(key,value);
  }
  portletSetup.store();
  return portletSetup;
}
