{
  final UpdateVersionTask updateVersionTask=GradleUtil.addTask(project,UPDATE_BUNDLE_VERSION_TASK_NAME,UpdateVersionTask.class);
  updateVersionTask.onlyIf(new Spec<Task>(){
    @Override public boolean isSatisfiedBy(    Task task){
      UpdateVersionTask updateVersionTask=(UpdateVersionTask)task;
      String version=updateVersionTask.getVersion();
      if (version.contains("LIFERAY-PATCHED-")) {
        return false;
      }
      return true;
    }
  }
);
  updateVersionTask.pattern("bnd.bnd",Constants.BUNDLE_VERSION + ": " + UpdateVersionTask.VERSION_PLACEHOLDER);
  updateVersionTask.setDescription("Updates the project version in the " + Constants.BUNDLE_VERSION + " header.");
  updateVersionTask.setVersion(new Callable<Object>(){
    @Override public Object call() throws Exception {
      Project project=updateVersionTask.getProject();
      return project.getVersion();
    }
  }
);
  project.afterEvaluate(new Action<Project>(){
    @Override public void execute(    Project project){
      File moduleConfigFile=getModuleConfigFile(project);
      if (moduleConfigFile == null) {
        return;
      }
      updateVersionTask.pattern(moduleConfigFile,"\"version\": \"" + UpdateVersionTask.VERSION_PLACEHOLDER + "\"");
    }
  }
);
  return updateVersionTask;
}
