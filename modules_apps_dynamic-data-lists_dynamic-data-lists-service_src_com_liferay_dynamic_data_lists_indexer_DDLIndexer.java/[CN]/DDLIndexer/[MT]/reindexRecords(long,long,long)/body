{
  List<DDLRecord> records=DDLRecordLocalServiceUtil.getMinAndMaxCompanyRecords(companyId,WorkflowConstants.STATUS_APPROVED,DDLRecordSetConstants.SCOPE_DYNAMIC_DATA_LISTS,startRecordId,endRecordId);
  Collection<Document> documents=new ArrayList<>(records.size());
  for (  DDLRecord record : records) {
    try {
      Document document=getDocument(record);
      documents.add(document);
    }
 catch (    SearchException e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to index ddl record: " + record.getRecordId() + " - "+ record.getVersion(),e);
      }
    }
  }
  SearchEngineUtil.updateDocuments(getSearchEngineId(),companyId,documents,isCommitImmediately());
}
