{
  ServerSocket socket=null;
  for (int i=0; i < 100; i++) {
    try {
      socket=new ServerSocket(_port.getValue());
      break;
    }
 catch (    BindException be) {
      if (be.getMessage().startsWith("Address already in use")) {
        _log.warn("Port " + _port.getValue() + " is already in use");
        _port.increment();
      }
 else {
        _log.error(be.getMessage());
        break;
      }
    }
catch (    IOException ioe) {
      ioe.printStackTrace();
      break;
    }
 finally {
      try {
        socket.close();
      }
 catch (      Exception e) {
      }
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Using port " + _port.getValue());
  }
  int returnValue=_port.getValue();
  _port.increment();
  return returnValue;
}
