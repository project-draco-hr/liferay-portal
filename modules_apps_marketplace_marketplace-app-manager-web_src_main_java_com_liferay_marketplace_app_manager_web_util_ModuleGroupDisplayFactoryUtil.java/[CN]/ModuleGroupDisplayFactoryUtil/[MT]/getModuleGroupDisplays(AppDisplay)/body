{
  List<Bundle> bundles=appDisplay.getBundles();
  Map<String,ModuleGroupDisplay> moduleGroupDisplaysMap=new HashMap<>();
  for (  Bundle bundle : bundles) {
    Dictionary<String,String> headers=bundle.getHeaders();
    String moduleGroupTitle=headers.get(BundleConstants.LIFERAY_RELENG_MODULE_GROUP_TITLE);
    if (moduleGroupTitle == null) {
      moduleGroupTitle=ModuleGroupDisplay.MODULE_GROUP_TITLE_INDEPENDENT_MODULES;
    }
    ModuleGroupDisplay moduleGroupDisplay=moduleGroupDisplaysMap.get(moduleGroupTitle);
    if (moduleGroupDisplay == null) {
      String moduleGroupDescription=headers.get(BundleConstants.LIFERAY_RELENG_MODULE_GROUP_DESCRIPTION);
      Version moduleGroupVersion=bundle.getVersion();
      moduleGroupDisplay=new SimpleModuleGroupDisplay(appDisplay,moduleGroupTitle,moduleGroupDescription,moduleGroupVersion);
      moduleGroupDisplaysMap.put(moduleGroupTitle,moduleGroupDisplay);
    }
    moduleGroupDisplay.addBundle(bundle);
  }
  return ListUtil.fromMapValues(moduleGroupDisplaysMap);
}
