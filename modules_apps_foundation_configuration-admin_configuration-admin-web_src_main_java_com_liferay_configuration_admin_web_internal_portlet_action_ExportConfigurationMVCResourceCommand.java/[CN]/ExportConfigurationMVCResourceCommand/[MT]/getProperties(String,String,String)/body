{
  Properties properties=new Properties();
  Map<String,ConfigurationModel> configurationModels=_configurationModelRetriever.getConfigurationModels(languageId);
  ConfigurationModel configurationModel=configurationModels.get(pid);
  if ((configurationModel == null) && Validator.isNotNull(factoryPid)) {
    configurationModel=configurationModels.get(factoryPid);
  }
  if (configurationModel == null) {
    return properties;
  }
  Configuration configuration=_configurationModelRetriever.getConfiguration(pid);
  if (configuration == null) {
    return properties;
  }
  ExtendedAttributeDefinition[] attributeDefinitions=configurationModel.getAttributeDefinitions(ConfigurationModel.ALL);
  for (  AttributeDefinition attributeDefinition : attributeDefinitions) {
    String[] values=AttributeDefinitionUtil.getProperty(attributeDefinition,configuration);
    String value=null;
    if (values.length == 1) {
      value=values[0];
    }
 else     if (values.length > 1) {
      value=StringUtil.merge(values,"\n");
    }
    if (value == null) {
      value=StringPool.BLANK;
    }
    properties.setProperty(attributeDefinition.getID(),value);
  }
  return properties;
}
