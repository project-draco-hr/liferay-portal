{
  TestPortalCacheListener<String,String> localCacheListener=new TestPortalCacheListener<>();
  _ehcachePortalCache.registerCacheListener(localCacheListener,PortalCacheListenerScope.LOCAL);
  _ehcachePortalCache.put(_KEY_2,_VALUE_2);
  localCacheListener.assertActionsCount(1);
  localCacheListener.assertPut(_KEY_2,_VALUE_2);
  localCacheListener.reset();
  _defaultCacheListener.assertActionsCount(1);
  _defaultCacheListener.assertPut(_KEY_2,_VALUE_2);
  _defaultCacheListener.reset();
  _defaultCacheReplicator.assertActionsCount(1);
  _defaultCacheReplicator.assertPut(_KEY_2,_VALUE_2);
  _defaultCacheReplicator.reset();
  TestPortalCacheListener<String,String> remoteCacheListener=new TestPortalCacheListener<>();
  _ehcachePortalCache.registerCacheListener(remoteCacheListener,PortalCacheListenerScope.REMOTE);
  _ehcachePortalCache.put(_KEY_2,_VALUE_1);
  localCacheListener.assertActionsCount(1);
  localCacheListener.assertUpdated(_KEY_2,_VALUE_1);
  localCacheListener.reset();
  remoteCacheListener.assertActionsCount(0);
  _defaultCacheListener.assertActionsCount(1);
  _defaultCacheListener.assertUpdated(_KEY_2,_VALUE_1);
  _defaultCacheListener.reset();
  _defaultCacheReplicator.assertActionsCount(1);
  _defaultCacheReplicator.assertUpdated(_KEY_2,_VALUE_1);
  _defaultCacheReplicator.reset();
  _ehcachePortalCache.registerCacheListener(remoteCacheListener,PortalCacheListenerScope.ALL);
  _ehcachePortalCache.put(_KEY_2,_VALUE_2);
  localCacheListener.assertActionsCount(1);
  localCacheListener.assertUpdated(_KEY_2,_VALUE_2);
  localCacheListener.reset();
  remoteCacheListener.assertActionsCount(0);
  _defaultCacheListener.assertActionsCount(1);
  _defaultCacheListener.assertUpdated(_KEY_2,_VALUE_2);
  _defaultCacheListener.reset();
  _defaultCacheReplicator.assertActionsCount(1);
  _defaultCacheReplicator.assertUpdated(_KEY_2,_VALUE_2);
  _defaultCacheReplicator.reset();
  _ehcachePortalCache.unregisterCacheListener(localCacheListener);
  _ehcachePortalCache.put(_KEY_1,_VALUE_2);
  localCacheListener.assertActionsCount(0);
  remoteCacheListener.assertActionsCount(0);
  _defaultCacheListener.assertActionsCount(1);
  _defaultCacheListener.assertUpdated(_KEY_1,_VALUE_2);
  _defaultCacheListener.reset();
  _defaultCacheReplicator.assertActionsCount(1);
  _defaultCacheReplicator.assertUpdated(_KEY_1,_VALUE_2);
  _defaultCacheReplicator.reset();
  _ehcachePortalCache.unregisterCacheListener(new TestPortalCacheListener<String,String>());
  _ehcachePortalCache.put(_KEY_1,_VALUE_1);
  localCacheListener.assertActionsCount(0);
  remoteCacheListener.assertActionsCount(0);
  _defaultCacheListener.assertActionsCount(1);
  _defaultCacheListener.assertUpdated(_KEY_1,_VALUE_1);
  _defaultCacheListener.reset();
  _defaultCacheReplicator.assertActionsCount(1);
  _defaultCacheReplicator.assertUpdated(_KEY_1,_VALUE_1);
  _defaultCacheReplicator.reset();
  _ehcachePortalCache.unregisterCacheListeners();
  _ehcachePortalCache.put(_KEY_1,_VALUE_2);
  localCacheListener.assertActionsCount(0);
  remoteCacheListener.assertActionsCount(0);
  _defaultCacheListener.assertActionsCount(0);
  _defaultCacheReplicator.assertActionsCount(0);
}
