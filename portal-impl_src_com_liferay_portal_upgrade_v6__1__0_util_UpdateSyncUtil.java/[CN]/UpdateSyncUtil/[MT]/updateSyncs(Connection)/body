{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    StringBundler sb=new StringBundler(10);
    sb.append("select DLFileEntry.fileEntryId as fileId, ");
    sb.append("DLFileEntry.groupId as groupId, DLFileEntry.companyId");
    sb.append(" as companyId, DLFileEntry.createDate as createDate, ");
    sb.append("DLFileEntry.folderId as parentFolderId, 'file' as ");
    sb.append("type from DLFileEntry union all select ");
    sb.append("DLFolder.folderId as fileId, DLFolder.groupId as ");
    sb.append("groupId, DLFolder.companyId as companyId, ");
    sb.append("DLFolder.createDate as createDate, ");
    sb.append("DLFolder.parentFolderId as parentFolderId, 'folder' ");
    sb.append("as type from DLFolder");
    try (PreparedStatement ps=connection.prepareStatement(sb.toString());ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        long fileId=rs.getLong("fileId");
        long groupId=rs.getLong("groupId");
        long companyId=rs.getLong("companyId");
        Timestamp createDate=rs.getTimestamp("createDate");
        long parentFolderId=rs.getLong("parentFolderId");
        String type=rs.getString("type");
        addSync(connection,increment(),companyId,createDate,createDate,fileId,groupId,parentFolderId,"add",type);
      }
    }
   }
 }
