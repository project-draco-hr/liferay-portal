{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    StringBundler sb=new StringBundler(10);
    sb.append("select DLFileEntry.fileEntryId as fileId, ");
    sb.append("DLFileEntry.groupId as groupId, DLFileEntry.companyId");
    sb.append(" as companyId, DLFileEntry.createDate as createDate, ");
    sb.append("DLFileEntry.folderId as parentFolderId, 'file' as ");
    sb.append("type from DLFileEntry union all select ");
    sb.append("DLFolder.folderId as fileId, DLFolder.groupId as ");
    sb.append("groupId, DLFolder.companyId as companyId, ");
    sb.append("DLFolder.createDate as createDate, ");
    sb.append("DLFolder.parentFolderId as parentFolderId, 'folder' ");
    sb.append("as type from DLFolder");
    try (PreparedStatement ps=connection.prepareStatement(sb.toString());PreparedStatement ps2=AutoBatchPreparedStatementUtil.concurrentAutoBatch(connection,"insert into DLSync (syncId, companyId, createDate, " + "modifiedDate, fileId, repositoryId, " + "parentFolderId, event, type_) "+ "values (?, ?, ?, ?, ?, ?, ?, ?, ?)");ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        long fileId=rs.getLong("fileId");
        long groupId=rs.getLong("groupId");
        long companyId=rs.getLong("companyId");
        Timestamp createDate=rs.getTimestamp("createDate");
        long parentFolderId=rs.getLong("parentFolderId");
        String type=rs.getString("type");
        ps2.setLong(1,increment());
        ps2.setLong(2,companyId);
        ps2.setTimestamp(3,createDate);
        ps2.setTimestamp(4,createDate);
        ps2.setLong(5,fileId);
        ps2.setLong(6,groupId);
        ps2.setLong(7,parentFolderId);
        ps2.setString(8,"add");
        ps2.setString(9,type);
        ps2.addBatch();
      }
      ps2.executeBatch();
    }
   }
 }
