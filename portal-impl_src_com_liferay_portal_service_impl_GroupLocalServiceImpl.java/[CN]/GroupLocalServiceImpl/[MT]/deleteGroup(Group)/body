{
  if (PortalUtil.isSystemGroup(group.getName())) {
    throw new RequiredGroupException(String.valueOf(group.getGroupId()));
  }
  layoutSetBranchLocalService.deleteLayoutSetBranches(group.getGroupId(),true,true);
  layoutSetBranchLocalService.deleteLayoutSetBranches(group.getGroupId(),false,true);
  ServiceContext serviceContext=new ServiceContext();
  try {
    layoutSetLocalService.deleteLayoutSet(group.getGroupId(),true,serviceContext);
  }
 catch (  NoSuchLayoutSetException nslse) {
  }
  try {
    layoutSetLocalService.deleteLayoutSet(group.getGroupId(),false,serviceContext);
  }
 catch (  NoSuchLayoutSetException nslse) {
  }
  userGroupRoleLocalService.deleteUserGroupRolesByGroupId(group.getGroupId());
  userGroupGroupRoleLocalService.deleteUserGroupGroupRolesByGroupId(group.getGroupId());
  membershipRequestLocalService.deleteMembershipRequests(group.getGroupId());
  subscriptionLocalService.deleteSubscriptions(group.getCompanyId(),BlogsEntry.class.getName(),group.getGroupId());
  subscriptionLocalService.deleteSubscriptions(group.getCompanyId(),JournalArticle.class.getName(),group.getGroupId());
  teamLocalService.deleteTeams(group.getGroupId());
  unscheduleStaging(group);
  if (group.hasStagingGroup()) {
    deleteGroup(group.getStagingGroup().getGroupId());
  }
  ThemeLoader themeLoader=ThemeLoaderFactory.getDefaultThemeLoader();
  if (themeLoader != null) {
    String themePath=themeLoader.getFileStorage() + StringPool.SLASH + group.getGroupId();
    FileUtil.deltree(themePath + "-private");
    FileUtil.deltree(themePath + "-public");
  }
  if (group.isRegularSite()) {
    assetEntryLocalService.deleteEntry(Group.class.getName(),group.getGroupId());
  }
  assetVocabularyLocalService.deleteVocabularies(group.getGroupId());
  blogsEntryLocalService.deleteEntries(group.getGroupId());
  blogsStatsUserLocalService.deleteStatsUserByGroupId(group.getGroupId());
  bookmarksFolderLocalService.deleteFolders(group.getGroupId());
  calEventLocalService.deleteEvents(group.getGroupId());
  repositoryLocalService.deleteRepositories(group.getGroupId());
  dlFileEntryTypeLocalService.deleteFileEntryTypes(group.getGroupId());
  journalArticleLocalService.deleteArticles(group.getGroupId());
  journalTemplateLocalService.deleteTemplates(group.getGroupId());
  journalStructureLocalService.deleteStructures(group.getGroupId());
  mbBanLocalService.deleteBansByGroupId(group.getGroupId());
  mbCategoryLocalService.deleteCategories(group.getGroupId());
  mbStatsUserLocalService.deleteStatsUsersByGroupId(group.getGroupId());
  pollsQuestionLocalService.deleteQuestions(group.getGroupId());
  shoppingCartLocalService.deleteGroupCarts(group.getGroupId());
  shoppingCategoryLocalService.deleteCategories(group.getGroupId());
  shoppingCouponLocalService.deleteCoupons(group.getGroupId());
  shoppingOrderLocalService.deleteOrders(group.getGroupId());
  scFrameworkVersionLocalService.deleteFrameworkVersions(group.getGroupId());
  scProductEntryLocalService.deleteProductEntries(group.getGroupId());
  wikiNodeLocalService.deleteNodes(group.getGroupId());
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
    List<ResourcePermission> resourcePermissions=resourcePermissionPersistence.findByC_P(group.getCompanyId(),String.valueOf(group.getGroupId()));
    for (    ResourcePermission resourcePermission : resourcePermissions) {
      resourcePermissionLocalService.deleteResourcePermission(resourcePermission);
    }
  }
 else {
    List<Resource> resources=resourceFinder.findByC_P(group.getCompanyId(),String.valueOf(group.getGroupId()));
    for (    Resource resource : resources) {
      resourceLocalService.deleteResource(resource);
    }
  }
  if (!group.isStagingGroup() && group.isOrganization() || group.isRegularSite()) {
    resourceLocalService.deleteResource(group.getCompanyId(),Group.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,group.getGroupId());
  }
  if (group.isOrganization() && group.isSite()) {
    group.setSite(false);
    groupPersistence.update(group,false);
  }
 else {
    groupPersistence.remove(group);
  }
  PermissionCacheUtil.clearCache();
}
