{
  Group group=groupPersistence.findByPrimaryKey(groupId);
  UnicodeProperties oldTypeSettingsProperties=group.getTypeSettingsProperties();
  UnicodeProperties typeSettingsProperties=new UnicodeProperties(true);
  typeSettingsProperties.fastLoad(typeSettings);
  String newLocales=typeSettingsProperties.getProperty(PropsKeys.LOCALES);
  if (newLocales != null) {
    String oldLocales=oldTypeSettingsProperties.getProperty(PropsKeys.LOCALES,StringPool.BLANK);
    if (!Validator.equals(oldLocales,newLocales)) {
      validateLocales(newLocales);
      LanguageUtil.resetAvailableGroupLocales(groupId);
    }
  }
  group.setTypeSettings(typeSettings);
  groupPersistence.update(group);
  return group;
}
