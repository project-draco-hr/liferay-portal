{
  Group group=groupPersistence.findByPrimaryKey(groupId);
  UnicodeProperties typeSettingsProperties=group.getTypeSettingsProperties();
  typeSettingsProperties.setProperty("workflowEnabled",String.valueOf(workflowEnabled));
  if (workflowEnabled) {
    if (workflowStages < PropsValues.TASKS_DEFAULT_STAGES) {
      workflowStages=PropsValues.TASKS_DEFAULT_STAGES;
    }
    if (Validator.isNull(workflowRoleNames)) {
      workflowRoleNames=PropsValues.TASKS_DEFAULT_ROLE_NAMES;
    }
    typeSettingsProperties.setProperty("workflowStages",String.valueOf(workflowStages));
    typeSettingsProperties.setProperty("workflowRoleNames",workflowRoleNames);
  }
  group.setTypeSettings(group.getTypeSettings());
  groupPersistence.update(group,false);
  if (!workflowEnabled) {
    tasksProposalLocalService.deleteProposals(groupId);
  }
  return group;
}
