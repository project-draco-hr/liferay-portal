{
  try (RevWalk revWalk=new RevWalk(repository)){
    revWalk.markStart(revWalk.parseCommit(repository.resolve(Constants.HEAD)));
    revWalk.setRetainBody(false);
    revWalk.setRevFilter(AndRevFilter.create(CommitTimeRevFilter.before(date),MaxCountRevFilter.create(1)));
    RevCommit revCommit=revWalk.next();
    if (revCommit == null) {
      throw new GradleException("Unable to find any commit before " + date);
    }
    return revCommit.name();
  }
 }
