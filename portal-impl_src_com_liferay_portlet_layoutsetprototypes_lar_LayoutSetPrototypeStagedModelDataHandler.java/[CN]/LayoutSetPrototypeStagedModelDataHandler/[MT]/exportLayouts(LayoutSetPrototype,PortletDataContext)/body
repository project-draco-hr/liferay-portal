{
  File file=null;
  InputStream inputStream=null;
  try {
    file=SitesUtil.exportLayoutSetPrototype(layoutSetPrototype,new ServiceContext());
    inputStream=new FileInputStream(file);
    String path=ExportImportPathUtil.getModelPath(layoutSetPrototype,getLayoutSetPrototypeLarFileName(layoutSetPrototype));
    portletDataContext.addZipEntry(path,inputStream);
    List<Layout> layoutSetPrototypeLayouts=LayoutLocalServiceUtil.getLayouts(layoutSetPrototype.getGroup().getGroupId(),true);
    Element layoutSetPrototypeElement=portletDataContext.getExportDataElement(layoutSetPrototype);
    for (    Layout layoutSetPrototypeLayout : layoutSetPrototypeLayouts) {
      portletDataContext.addReferenceElement(layoutSetPrototype,layoutSetPrototypeElement,layoutSetPrototypeLayout,PortletDataContext.REFERENCE_TYPE_EMBEDDED,false);
    }
  }
  finally {
    StreamUtil.cleanUp(inputStream);
    if (file != null) {
      file.delete();
    }
  }
}
