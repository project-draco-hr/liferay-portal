{
  if (_serviceReferenceServiceTuple == null) {
    TS service=_serviceTrackerCustomizer.addingService(_serviceReference);
    if (service == null) {
      return;
    }
    _serviceReferenceServiceTuple=new ServiceReferenceServiceTuple<>(_serviceReference,service);
  }
  ServiceTrackerBucket<SR,TS,R> serviceTrackerBucket=_serviceTrackerBuckets.get(key);
  if (serviceTrackerBucket == null) {
    ServiceTrackerBucket<SR,TS,R> newServiceTrackerBucket=_serviceTrackerMapBucketFactory.create();
    serviceTrackerBucket=_serviceTrackerBuckets.putIfAbsent(key,newServiceTrackerBucket);
    if (serviceTrackerBucket == null) {
      serviceTrackerBucket=newServiceTrackerBucket;
    }
  }
  serviceTrackerBucket.store(_serviceReferenceServiceTuple);
}
