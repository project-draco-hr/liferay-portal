{
  if ((_serviceReferenceServiceTuple == null) && !_invokedServiceTrackerCustomizer) {
    TS service=_serviceTrackerCustomizer.addingService(_serviceReference);
    _invokedServiceTrackerCustomizer=true;
    if (service == null) {
      return;
    }
    _serviceReferenceServiceTuple=new ServiceReferenceServiceTuple<>(_serviceReference,service);
  }
  storeKey(key,_serviceReferenceServiceTuple);
  if (_listener != null) {
    try {
      _listener.update(ServiceTrackerMapImpl.this,key,_serviceReferenceServiceTuple.getService(),_serviceTrackerBuckets.get(key).getContent());
    }
 catch (    Throwable t) {
      _logger.log(Logger.LOG_ERROR,"Invocation to listener threw Exception: ",t);
    }
  }
}
