{
  List<Role> filteredRoles=new ArrayList<>();
  List<Role> roles=RoleLocalServiceUtil.getRoles(themeDisplay.getCompanyId());
  for (  Role role : roles) {
    if (role.isTeam()) {
      Team team=TeamLocalServiceUtil.getTeam(role.getClassPK());
      if (GroupPermissionUtil.contains(themeDisplay.getPermissionChecker(),team.getGroupId(),ActionKeys.MANAGE_ANNOUNCEMENTS) || RolePermissionUtil.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),role.getRoleId(),ActionKeys.MANAGE_ANNOUNCEMENTS)) {
        filteredRoles.add(role);
      }
    }
 else     if (RolePermissionUtil.contains(themeDisplay.getPermissionChecker(),role.getRoleId(),ActionKeys.MANAGE_ANNOUNCEMENTS)) {
      filteredRoles.add(role);
    }
  }
  return filteredRoles;
}
