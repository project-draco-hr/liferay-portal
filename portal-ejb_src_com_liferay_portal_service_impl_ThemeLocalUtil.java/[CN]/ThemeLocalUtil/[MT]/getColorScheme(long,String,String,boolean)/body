{
  colorSchemeId=GetterUtil.getString(colorSchemeId);
  Theme theme=getTheme(companyId,themeId,wapTheme);
  Map colorSchemesMap=theme.getColorSchemesMap();
  ColorScheme colorScheme=(ColorScheme)colorSchemesMap.get(colorSchemeId);
  if (colorScheme == null) {
    List colorSchemes=theme.getColorSchemes();
    if (colorSchemes.size() > 0) {
      colorScheme=(ColorScheme)colorSchemes.get(0);
    }
  }
  if (colorScheme == null) {
    if (wapTheme) {
      colorSchemeId=ColorSchemeImpl.getDefaultWapColorSchemeId();
    }
 else {
      colorSchemeId=ColorSchemeImpl.getDefaultRegularColorSchemeId();
    }
  }
  if (colorScheme == null) {
    colorScheme=ColorSchemeImpl.getNullColorScheme();
  }
  return colorScheme;
}
