{
  boolean undeployEnabled=PrefsPropsUtil.getBoolean(PropsKeys.HOT_UNDEPLOY_ENABLED,PropsValues.HOT_UNDEPLOY_ENABLED);
  if (!undeployEnabled) {
    return;
  }
  if (!appServerType.equals(ServerDetector.GLASSFISH_ID) && !appServerType.equals(ServerDetector.JBOSS_ID) && !appServerType.equals(ServerDetector.JETTY_ID)&& !appServerType.equals(ServerDetector.TOMCAT_ID)&& !appServerType.equals(ServerDetector.WEBLOGIC_ID)&& !appServerType.equals(ServerDetector.WILDFLY_ID)) {
    return;
  }
  if (!deployDir.exists()) {
    String deployDirPath=deployDir.getAbsolutePath();
    if (StringUtil.endsWith(deployDirPath,".war")) {
      deployDirPath=deployDirPath.substring(0,deployDirPath.length() - 4);
    }
 else {
      deployDirPath=deployDirPath.concat(".war");
    }
    deployDir=new File(deployDirPath);
  }
  if (!deployDir.exists()) {
    return;
  }
  if (deployDir.isFile()) {
    FileUtil.delete(deployDir);
  }
 else {
    File webXml=new File(deployDir + "/WEB-INF/web.xml");
    if (!webXml.exists()) {
      return;
    }
    if (_log.isInfoEnabled()) {
      _log.info("Undeploy " + deployDir);
    }
    FileUtil.delete(deployDir + "/WEB-INF/web.xml");
    DeleteTask.deleteDirectory(deployDir);
  }
  if (appServerType.equals(ServerDetector.JETTY_ID)) {
    FileUtil.delete(getJettyHome() + "/contexts/" + deployDir.getName()+ ".xml");
  }
  if (appServerType.equals(ServerDetector.JBOSS_ID) || appServerType.equals(ServerDetector.WILDFLY_ID)) {
    File deployedFile=new File(deployDir.getParent(),deployDir.getName() + ".deployed");
    FileUtil.delete(deployedFile);
  }
  int undeployInterval=PrefsPropsUtil.getInteger(PropsKeys.HOT_UNDEPLOY_INTERVAL,PropsValues.HOT_UNDEPLOY_INTERVAL);
  if (_log.isInfoEnabled()) {
    _log.info("Wait " + undeployInterval + " ms to allow the plugin time to fully undeploy");
  }
  if (undeployInterval > 0) {
    Thread.sleep(undeployInterval);
  }
}
