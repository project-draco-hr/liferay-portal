{
  boolean last=false;
  do {
    UndoableEdit edit=editToBeUndone();
    if (edit != null) {
      String presName=edit.getPresentationName();
      if (presName.toLowerCase().indexOf("style") == -1) {
        last=true;
      }
      super.undo();
    }
 else {
      last=true;
    }
  }
 while (!last);
}
