{
  int avail=count - pos;
  if (avail <= 0) {
    if (len >= getBufIfOpen().length && markpos < 0) {
      return getInIfOpen().read(b,off,len);
    }
    fill();
    avail=count - pos;
    if (avail <= 0) {
      return -1;
    }
  }
  int cnt=(avail < len) ? avail : len;
  System.arraycopy(getBufIfOpen(),pos,b,off,cnt);
  pos+=cnt;
  return cnt;
}
