{
  long threadId=ParamUtil.getLong(request,"threadId");
  MBMessage message=null;
  if (threadId > 0) {
    MBThread thread=MBThreadLocalServiceUtil.getThread(threadId);
    message=MBMessageServiceUtil.getMessage(thread.getRootMessageId());
  }
  if ((message != null) && message.isInTrash()) {
    throw new NoSuchMessageException("{threadId=" + threadId + "}");
  }
  return message;
}
