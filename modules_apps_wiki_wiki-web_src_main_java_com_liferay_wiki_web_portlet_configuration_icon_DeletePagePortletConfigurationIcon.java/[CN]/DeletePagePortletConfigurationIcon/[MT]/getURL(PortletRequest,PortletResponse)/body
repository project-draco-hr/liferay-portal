{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  try {
    WikiPage page=ActionUtil.getPage(portletRequest);
    PortletURL portletURL=PortalUtil.getControlPanelPortletURL(portletRequest,WikiPortletKeys.WIKI_ADMIN,PortletRequest.ACTION_PHASE);
    portletURL.setParameter(ActionRequest.ACTION_NAME,"/wiki/edit_page");
    portletURL.setParameter(Constants.CMD,Constants.DELETE);
    if (!page.isDraft() && isTrashEnabled(themeDisplay.getScopeGroupId())) {
      portletURL.setParameter(Constants.CMD,Constants.MOVE_TO_TRASH);
    }
 else {
      portletURL.setParameter("version",String.valueOf(page.getVersion()));
    }
    PortletURL redirectURL=PortalUtil.getControlPanelPortletURL(portletRequest,WikiPortletKeys.WIKI_ADMIN,PortletRequest.ACTION_PHASE);
    redirectURL.setParameter("mvcRenderCommandName","/wiki/view_pages");
    redirectURL.setParameter("navigation","all-pages");
    redirectURL.setParameter("nodeId",String.valueOf(page.getNodeId()));
    portletURL.setParameter("redirect",redirectURL.toString());
    portletURL.setParameter("nodeId",String.valueOf(page.getNodeId()));
    portletURL.setParameter("title",page.getTitle());
    return portletURL.toString();
  }
 catch (  Exception e) {
  }
  return StringPool.BLANK;
}
