{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  long plid=ParamUtil.getLong(request,"p_l_id");
  if (plid == LayoutConstants.DEFAULT_PLID) {
    plid=themeDisplay.getPlid();
  }
  long companyId=ParamUtil.getLong(request,"companyId");
  long groupId=ParamUtil.getLong(request,"groupId");
  long organizationId=ParamUtil.getLong(request,"organizationId");
  int status=WorkflowConstants.STATUS_APPROVED;
  int max=ParamUtil.getInteger(request,"max",SearchContainer.DEFAULT_DELTA);
  String type=ParamUtil.getString(request,"type",RSSUtil.FORMAT_DEFAULT);
  double version=ParamUtil.getDouble(request,"version",RSSUtil.VERSION_DEFAULT);
  String displayStyle=ParamUtil.getString(request,"displayStyle",RSSUtil.DISPLAY_STYLE_DEFAULT);
  String feedURL=themeDisplay.getPortalURL() + themeDisplay.getPathMain() + "/blogs/find_entry?";
  String entryURL=feedURL;
  String rss=StringPool.BLANK;
  if (companyId > 0) {
    feedURL=StringPool.BLANK;
    rss=_blogsEntryService.getCompanyEntriesRSS(companyId,new Date(),status,max,type,version,displayStyle,feedURL,entryURL,themeDisplay);
  }
 else   if (groupId > 0) {
    feedURL+="p_l_id=" + plid;
    entryURL=feedURL;
    rss=_blogsEntryService.getGroupEntriesRSS(groupId,new Date(),status,max,type,version,displayStyle,feedURL,entryURL,themeDisplay);
  }
 else   if (organizationId > 0) {
    feedURL=StringPool.BLANK;
    rss=_blogsEntryService.getOrganizationEntriesRSS(organizationId,new Date(),status,max,type,version,displayStyle,feedURL,entryURL,themeDisplay);
  }
 else   if (layout != null) {
    groupId=themeDisplay.getScopeGroupId();
    feedURL=themeDisplay.getPathMain() + "/blogs/rss";
    entryURL=feedURL;
    rss=_blogsEntryService.getGroupEntriesRSS(groupId,new Date(),status,max,type,version,displayStyle,feedURL,entryURL,themeDisplay);
  }
  return rss.getBytes(StringPool.UTF8);
}
