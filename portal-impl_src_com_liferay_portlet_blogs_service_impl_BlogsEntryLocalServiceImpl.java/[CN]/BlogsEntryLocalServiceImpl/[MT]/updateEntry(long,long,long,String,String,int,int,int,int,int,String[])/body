{
  User user=UserUtil.findByPrimaryKey(userId);
  categoryId=getCategoryId(user.getCompanyId(),categoryId);
  Date now=new Date();
  Date displayDate=PortalUtil.getDate(displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,user.getTimeZone(),new EntryDisplayDateException());
  validate(title,content);
  BlogsEntry entry=BlogsEntryUtil.findByPrimaryKey(entryId);
  entry.setModifiedDate(now);
  entry.setCategoryId(categoryId);
  entry.setTitle(title);
  entry.setContent(content);
  entry.setDisplayDate(displayDate);
  BlogsEntryUtil.update(entry);
  BlogsStatsUser statsUser=BlogsStatsUserUtil.fetchByG_U(entry.getGroupId(),entry.getUserId());
  if (statsUser != null) {
    statsUser.setLastPostDate(now);
    BlogsStatsUserUtil.update(statsUser);
  }
  updateTagsAsset(userId,entry,tagsEntries);
  try {
    Indexer.updateEntry(entry.getCompanyId(),entry.getGroupId(),userId,categoryId,entryId,title,content);
  }
 catch (  IOException ioe) {
    _log.error("Indexing " + entryId,ioe);
  }
  return entry;
}
