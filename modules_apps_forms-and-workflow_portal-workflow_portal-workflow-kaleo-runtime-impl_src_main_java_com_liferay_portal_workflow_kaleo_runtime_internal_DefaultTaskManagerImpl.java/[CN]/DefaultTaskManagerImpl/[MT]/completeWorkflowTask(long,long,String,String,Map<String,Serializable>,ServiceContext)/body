{
  try {
    KaleoTaskInstanceToken kaleoTaskInstanceToken=kaleoTaskInstanceTokenLocalService.getKaleoTaskInstanceToken(workflowTaskInstanceId);
    kaleoTaskFormInstanceLocalService.addKaleoTaskFormInstance(kaleoTaskInstanceToken.getGroupId(),workflowTaskFormId,formValues,kaleoTaskInstanceToken,serviceContext);
    if (kaleoTaskInstanceTokenLocalService.hasPendingKaleoTaskForms(workflowTaskInstanceId)) {
      return _kaleoWorkflowModelConverter.toWorkflowTask(kaleoTaskInstanceToken,workflowContext);
    }
    if (Validator.isNull(transitionName)) {
      KaleoTask kaleoTask=kaleoTaskLocalService.getKaleoTask(kaleoTaskInstanceToken.getKaleoTaskId());
      KaleoNode kaleoNode=kaleoTask.getKaleoNode();
      List<KaleoTransition> kaleoTransitions=kaleoNode.getKaleoTransitions();
      if (kaleoTransitions.size() == 1) {
        if (_log.isDebugEnabled()) {
          _log.debug("Automatically completing form task: " + kaleoTask.getName());
        }
        KaleoTransition kaleoTransition=kaleoTransitions.get(0);
        transitionName=kaleoTransition.getName();
      }
    }
    return doCompleteWorkflowTask(workflowTaskInstanceId,transitionName,null,workflowContext,serviceContext);
  }
 catch (  Exception e) {
    throw new WorkflowException(e);
  }
}
