{
  Connection connection=null;
  PreparedStatement preparedStatement=null;
  ResultSet resultSet=null;
  try {
    connection=DataAccess.getUpgradeOptimizedConnection();
    preparedStatement=connection.prepareStatement("select fileEntryTypeId, name, description from " + "DLFileEntryType where groupId = ? and fileEntryTypeKey " + "= ?");
    preparedStatement.setLong(1,groupId);
    preparedStatement.setString(2,dlFileEntryTypeKey);
    resultSet=preparedStatement.executeQuery();
    if (!resultSet.next()) {
      return null;
    }
    long fileEntryTypeId=resultSet.getLong(1);
    String name=resultSet.getString(2);
    String description=resultSet.getString(3);
    if (resultSet.next()) {
      throw new IllegalStateException(String.format("Found at least two rows for groupId = %s and " + "fileEntryTypeKey = %s on table DLFileEntryType; " + "expected 1 row",groupId,dlFileEntryTypeKey));
    }
    DLFileEntryTypeData dlFileEntryTypeData=new DLFileEntryTypeData(fileEntryTypeId,name,description);
    return dlFileEntryTypeData;
  }
  finally {
    DataAccess.cleanUp(connection,preparedStatement,resultSet);
  }
}
