{
  DDMStructure ddmStructure=ddmStructureLocalService.getStructure(PortalUtil.getSiteGroupId(groupId),classNameLocalService.getClassNameId(JournalArticle.class),ddmStructureKey,true);
  DDMTemplate ddmTemplate=ddmTemplateLocalService.getTemplate(PortalUtil.getSiteGroupId(groupId),classNameLocalService.getClassNameId(DDMStructure.class),ddmTemplateKey,true);
  if (incrementVersion) {
    ddmStorageLinkLocalService.addStorageLink(ddmStructure.getClassNameId(),id,ddmStructure.getStructureId(),new ServiceContext());
    ddmTemplateLinkLocalService.addTemplateLink(classNameLocalService.getClassNameId(JournalArticle.class),id,ddmTemplate.getTemplateId());
  }
 else {
    DDMStorageLink ddmStorageLink=ddmStorageLinkLocalService.getClassStorageLink(id);
    ddmStorageLink.setStructureId(ddmStructure.getStructureId());
    ddmStorageLinkLocalService.updateDDMStorageLink(ddmStorageLink);
    ddmTemplateLinkLocalService.updateTemplateLink(classNameLocalService.getClassNameId(JournalArticle.class),id,ddmTemplate.getTemplateId());
  }
}
