{
  StdSchedulerFactory schedulerFactory=new StdSchedulerFactory();
  Properties properties=PropsUtil.getProperties(propertiesPrefix,true);
  if (useQuartzCluster && PropsValues.CLUSTER_LINK_ENABLED) {
    DB db=DBFactoryUtil.getDB();
    String dbType=db.getType();
    if (dbType.equals(DB.TYPE_HYPERSONIC)) {
      _log.error("Unable to cluster scheduler on Hypersonic");
    }
 else {
      properties.put("org.quartz.jobStore.isClustered",Boolean.TRUE.toString());
    }
  }
  schedulerFactory.initialize(properties);
  return schedulerFactory.getScheduler();
}
