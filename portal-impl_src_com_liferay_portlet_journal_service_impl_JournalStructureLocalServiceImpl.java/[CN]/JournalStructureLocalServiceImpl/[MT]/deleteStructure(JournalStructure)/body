{
  Group companyGroup=groupLocalService.getCompanyGroup(structure.getCompanyId());
  if (structure.getGroupId() == companyGroup.getGroupId()) {
    int count=journalArticlePersistence.countByStructureId(structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_WEB_CONTENT);
    }
    count=journalStructurePersistence.countByParentStructureId(structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_STRUCTURE);
    }
    count=journalTemplatePersistence.countByStructureId(structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_TEMPLATE);
    }
  }
 else {
    int count=journalArticlePersistence.countByG_C_S(structure.getGroupId(),0,structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_WEB_CONTENT);
    }
    count=journalStructurePersistence.countByG_P(structure.getGroupId(),structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_STRUCTURE);
    }
    count=journalTemplatePersistence.countByG_S(structure.getGroupId(),structure.getStructureId());
    if (count > 0) {
      throw new RequiredStructureException(RequiredStructureException.REFERENCED_TEMPLATE);
    }
  }
  webDAVPropsLocalService.deleteWebDAVProps(JournalStructure.class.getName(),structure.getId());
  expandoValueLocalService.deleteValues(JournalStructure.class.getName(),structure.getId());
  resourceLocalService.deleteResource(structure.getCompanyId(),JournalStructure.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,structure.getId());
  try {
    long classNameId=PortalUtil.getClassNameId(JournalStructure.class.getName());
    List<JournalArticle> articles=journalArticlePersistence.findByG_C_C(structure.getGroupId(),classNameId,structure.getId());
    for (    JournalArticle article : articles) {
      journalArticleLocalService.deleteArticle(article,null,null);
    }
  }
 catch (  NoSuchArticleException nsae) {
  }
  journalStructurePersistence.remove(structure);
}
