{
  long proposalId=ParamUtil.getLong(req,"proposalId");
  long groupId=ParamUtil.getLong(req,"groupId");
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  Group liveGroup=group;
  Group stagingGroup=liveGroup.getStagingGroup();
  TasksProposal proposal=TasksProposalLocalServiceUtil.getProposal(proposalId);
  Layout layout=LayoutLocalServiceUtil.getLayout(proposal.getClassPK());
  Map<Long,Boolean> layoutIdMap=new LinkedHashMap<Long,Boolean>();
  layoutIdMap.put(layout.getPlid(),Boolean.FALSE);
  Map parameterMap=getStagingParameters();
  publishLayouts(layoutIdMap,stagingGroup.getGroupId(),liveGroup.getGroupId(),layout.isPrivateLayout(),parameterMap);
  TasksProposalServiceUtil.deleteProposal(proposal.getProposalId());
}
