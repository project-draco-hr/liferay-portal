{
  long proposalId=ParamUtil.getLong(req,"proposalId");
  long groupId=ParamUtil.getLong(req,"groupId");
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  Group liveGroup=group;
  Group stagingGroup=liveGroup.getStagingGroup();
  TasksProposal proposal=TasksProposalLocalServiceUtil.getProposal(proposalId);
  String className=PortalUtil.getClassName(proposal.getClassNameId());
  if (className.equals(Layout.class.getName())) {
    StagingUtil.publishToLive(req);
  }
 else   if (className.equals(Portlet.class.getName())) {
    String classPK=proposal.getClassPK();
    String portletId=classPK.substring(classPK.indexOf(PortletImpl.LAYOUT_SEPARATOR) + PortletImpl.LAYOUT_SEPARATOR.length());
    Portlet portlet=PortletLocalServiceUtil.getPortletById(proposal.getCompanyId(),portletId);
    StagingUtil.publishToLive(req,portlet);
  }
  TasksProposalServiceUtil.deleteProposal(proposal.getProposalId());
}
