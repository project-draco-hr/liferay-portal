{
  PermissionChecker permissionChecker=getPermissionChecker();
  MBPermission.check(permissionChecker,serviceContext.getScopeGroupId(),ActionKeys.BAN_USER);
  User banUser=userPersistence.findByPrimaryKey(banUserId);
  boolean groupAdmin=false;
  try {
    groupAdmin=PortalUtil.isGroupAdmin(banUser,serviceContext.getScopeGroupId());
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
  if (groupAdmin) {
    throw new PrincipalException();
  }
  return mbBanLocalService.addBan(getUserId(),banUserId,serviceContext);
}
