{
  long start=0;
  int block=1;
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if ((Validator.isNull(actionId)) || (resourceIds == null) || (resourceIds.length == 0)) {
    return false;
  }
  List permissions=PermissionFinder.findByA_R(actionId,resourceIds);
  if (permissions.size() == 0) {
    return false;
  }
  String resourceId=resourceIds[0];
  start=logHasUserPermissions(userId,actionId,resourceId,start,block++);
  List userGroups=permissionCheckerBag.getUserGroups();
  List userOrgs=permissionCheckerBag.getUserOrgs();
  List groups=permissionCheckerBag.getGroups();
  List roles=permissionCheckerBag.getRoles();
  start=logHasUserPermissions(userId,actionId,resourceId,start,block++);
  if (checkOrgGroupPermission(userOrgs,userGroups,permissions)) {
    return true;
  }
  start=logHasUserPermissions(userId,actionId,resourceId,start,block++);
  if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 1) {
    return hasUserPermissions_1(userId,actionId,resourceId,permissions,groups,start,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 2) {
    return hasUserPermissions_2(userId,actionId,resourceId,permissions,groups,start,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 3) {
    return hasUserPermissions_3(userId,actionId,resourceId,permissions,groups,roles,start,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 4) {
    return hasUserPermissions_4(userId,actionId,resourceId,permissions,groups,roles,start,block);
  }
  return false;
}
