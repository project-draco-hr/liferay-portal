{
  long start=0;
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if ((Validator.isNull(actionId)) || (resourceIds == null) || (resourceIds.length == 0)) {
    return false;
  }
  List permissions=PermissionFinder.findByA_R(actionId,resourceIds);
  if (permissions.size() == 0) {
    return false;
  }
  String resourceId=resourceIds[0];
  logUserPermission(userId,actionId,resourceId,start,1);
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if (PermissionFinder.countByUsersPermissions(permissions,userId) > 0) {
    return true;
  }
  logUserPermission(userId,actionId,resourceId,start,2);
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  List userGroups=new ArrayList();
  if (Validator.isNotNull(groupId)) {
    userGroups.add(GroupUtil.findByPrimaryKey(groupId));
  }
  List userOrgs=permissionCheckerBag.getUserOrgs();
  List userOrgGroups=permissionCheckerBag.getUserOrgGroups();
  List groups=new ArrayList(userGroups.size() + userOrgGroups.size());
  groups.addAll(userGroups);
  groups.addAll(userOrgGroups);
  logUserPermission(userId,actionId,resourceId,start,3);
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if (checkOrgGroupPermission(userOrgs,userGroups,permissions)) {
    return true;
  }
  logUserPermission(userId,actionId,resourceId,start,4);
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if (groups.size() > 0) {
    if (PermissionFinder.countByGroupsPermissions(permissions,groups) > 0) {
      return true;
    }
  }
  logUserPermission(userId,actionId,resourceId,start,5);
  if (_log.isDebugEnabled()) {
    start=System.currentTimeMillis();
  }
  if (PermissionFinder.countByUsersRoles(permissions,userId) > 0) {
    return true;
  }
  if (PermissionFinder.countByGroupsRoles(permissions,groups) > 0) {
    return true;
  }
  logUserPermission(userId,actionId,resourceId,start,6);
  return false;
}
