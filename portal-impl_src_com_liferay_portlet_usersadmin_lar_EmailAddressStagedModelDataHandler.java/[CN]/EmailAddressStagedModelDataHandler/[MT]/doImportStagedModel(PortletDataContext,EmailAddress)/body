{
  long userId=portletDataContext.getUserId(emailAddress.getUserUuid());
  ServiceContext serviceContext=portletDataContext.createServiceContext(emailAddress,UsersAdminPortletDataHandler.NAMESPACE);
  EmailAddress existingEmailAddress=EmailAddressLocalServiceUtil.fetchEmailAddressByUuidAndCompanyId(emailAddress.getUuid(),portletDataContext.getCompanyId());
  EmailAddress importedEmailAddress=null;
  if (existingEmailAddress == null) {
    serviceContext.setUuid(emailAddress.getUuid());
    importedEmailAddress=EmailAddressLocalServiceUtil.addEmailAddress(userId,emailAddress.getClassName(),emailAddress.getClassPK(),emailAddress.getAddress(),emailAddress.getTypeId(),emailAddress.isPrimary(),serviceContext);
  }
 else {
    importedEmailAddress=EmailAddressLocalServiceUtil.updateEmailAddress(existingEmailAddress.getEmailAddressId(),emailAddress.getAddress(),emailAddress.getTypeId(),emailAddress.isPrimary());
  }
  portletDataContext.importClassedModel(emailAddress,importedEmailAddress,UsersAdminPortletDataHandler.NAMESPACE);
}
