{
  if (kbFolder.getGroupId() != parentKBFolder.getGroupId()) {
    throw new NoSuchFolderException(String.format("No KB folder with KB folder ID %s found in group %s",parentKBFolder.getKbFolderId(),kbFolder.getGroupId()));
  }
  List<Long> ancestorKBFolderIds=parentKBFolder.getAncestorKBFolderIds();
  if (ancestorKBFolderIds.contains(kbFolder.getKbFolderId())) {
    throw new KBFolderParentException(String.format("Cannot move KBFolder %s inside its descendant KBFolder %s",kbFolder.getKbFolderId(),parentKBFolder.getKbFolderId()));
  }
}
