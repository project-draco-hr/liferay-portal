{
  List<ResponseElement> elements=getElements(sharepointRequest);
  StringBundler sb=new StringBundler(elements.size() + 9);
  sb.append("<html><head><title>vermeer RPC packet</title></head>");
  sb.append(StringPool.NEW_LINE);
  sb.append("<body>");
  sb.append(StringPool.NEW_LINE);
  Property property=new Property("method",getMethodName() + ":" + SharepointUtil.VERSION);
  sb.append(property.parse());
  for (  ResponseElement element : elements) {
    sb.append(element.parse());
  }
  sb.append("</body>");
  sb.append(StringPool.NEW_LINE);
  sb.append("</html>");
  if (appendNewline) {
    sb.append(StringPool.NEW_LINE);
  }
  String html=sb.toString();
  if (_log.isDebugEnabled()) {
    _log.debug("Response HTML\n" + html);
  }
  return html;
}
