{
  if (_readWithImageIO) {
  }
 else {
  }
  String type=null;
  Enumeration enu=ImageCodec.getCodecs();
  while (enu.hasMoreElements()) {
    ImageCodec codec=(ImageCodec)enu.nextElement();
    if (codec.isFormatRecognized(bytes)) {
      type=codec.getFormatName();
      break;
    }
  }
  if (type == null) {
    return new ImageBag(null,TYPE_NOT_AVAILABLE);
  }
  RenderedImage renderedImage=null;
  ImageDecoder decoder=ImageCodec.createImageDecoder(type,new ByteArrayInputStream(bytes),null);
  try {
    renderedImage=decoder.decodeAsRenderedImage();
  }
 catch (  IOException ioe) {
    if (_log.isDebugEnabled()) {
      _log.debug(type + ": " + ioe.getMessage());
    }
  }
  return new ImageBag(renderedImage,type);
}
