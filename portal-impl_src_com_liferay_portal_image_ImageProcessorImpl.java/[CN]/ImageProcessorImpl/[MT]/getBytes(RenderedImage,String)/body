{
  if (contentType.equals("jpeg")) {
    contentType=TYPE_JPEG;
  }
 else   if (contentType.equals("tif")) {
    contentType=TYPE_TIFF;
  }
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  if (contentType.indexOf(TYPE_BMP) != -1) {
    ImageEncoder encoder=ImageCodec.createImageEncoder(TYPE_BMP,baos,null);
    encoder.encode(renderedImage);
  }
 else   if (contentType.indexOf(TYPE_GIF) != -1) {
    encodeGIF(renderedImage,baos);
  }
 else   if (contentType.indexOf(TYPE_JPEG) != -1) {
    ImageIO.write(renderedImage,TYPE_JPEG,baos);
  }
 else   if (contentType.indexOf(TYPE_PNG) != -1) {
    ImageIO.write(renderedImage,TYPE_PNG,baos);
  }
 else   if (contentType.indexOf(TYPE_TIFF) != -1) {
    ImageEncoder encoder=ImageCodec.createImageEncoder(TYPE_TIFF,baos,null);
    encoder.encode(renderedImage);
  }
  return baos.toByteArray();
}
