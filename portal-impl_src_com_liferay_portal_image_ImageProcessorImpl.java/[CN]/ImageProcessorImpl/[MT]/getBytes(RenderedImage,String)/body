{
  UnsyncByteArrayOutputStream baos=new UnsyncByteArrayOutputStream();
  if (contentType.indexOf(TYPE_BMP) != -1) {
    ImageEncoder encoder=ImageCodec.createImageEncoder(TYPE_BMP,baos,null);
    encoder.encode(renderedImage);
  }
 else   if (contentType.indexOf(TYPE_GIF) != -1) {
    encodeGIF(renderedImage,baos);
  }
 else   if ((contentType.indexOf(TYPE_JPEG) != -1) || (contentType.indexOf("jpeg") != -1)) {
    ImageIO.write(renderedImage,"jpeg",baos);
  }
 else   if (contentType.indexOf(TYPE_PNG) != -1) {
    ImageIO.write(renderedImage,TYPE_PNG,baos);
  }
 else   if (contentType.indexOf("tif") != -1) {
    ImageEncoder encoder=ImageCodec.createImageEncoder(TYPE_TIFF,baos,null);
    encoder.encode(renderedImage);
  }
  return baos.toByteArray();
}
