{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  String initUrl=ParamUtil.getString(actionRequest,"initUrl");
  if (!initUrl.startsWith("/") && !StringUtil.startsWith(initUrl,"http://") && !StringUtil.startsWith(initUrl,"https://")&& !StringUtil.startsWith(initUrl,"mhtml://")) {
    initUrl=HttpUtil.getProtocol(actionRequest) + "://" + initUrl;
  }
  String scope=ParamUtil.getString(actionRequest,"scope");
  String proxyHost=ParamUtil.getString(actionRequest,"proxyHost");
  String proxyPort=ParamUtil.getString(actionRequest,"proxyPort");
  String proxyAuthentication=ParamUtil.getString(actionRequest,"proxyAuthentication");
  String proxyAuthenticationUsername=ParamUtil.getString(actionRequest,"proxyAuthenticationUsername");
  String proxyAuthenticationPassword=ParamUtil.getString(actionRequest,"proxyAuthenticationPassword");
  String proxyAuthenticationHost=ParamUtil.getString(actionRequest,"proxyAuthenticationHost");
  String proxyAuthenticationDomain=ParamUtil.getString(actionRequest,"proxyAuthenticationDomain");
  String stylesheet=ParamUtil.getString(actionRequest,"stylesheet");
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(actionRequest,portletResource);
  prefs.setValue("initUrl",initUrl);
  prefs.setValue("scope",scope);
  prefs.setValue("proxyHost",proxyHost);
  prefs.setValue("proxyPort",proxyPort);
  prefs.setValue("proxyAuthentication",proxyAuthentication);
  prefs.setValue("proxyAuthenticationUsername",proxyAuthenticationUsername);
  prefs.setValue("proxyAuthenticationPassword",proxyAuthenticationPassword);
  prefs.setValue("proxyAuthenticationHost",proxyAuthenticationHost);
  prefs.setValue("proxyAuthenticationDomain",proxyAuthenticationDomain);
  prefs.setValue("stylesheet",stylesheet);
  prefs.store();
  SessionMessages.add(actionRequest,portletConfig.getPortletName() + ".doConfigure");
}
