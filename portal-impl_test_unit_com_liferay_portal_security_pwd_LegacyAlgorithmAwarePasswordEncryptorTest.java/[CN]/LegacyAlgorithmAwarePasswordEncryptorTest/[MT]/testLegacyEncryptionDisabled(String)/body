{
  String legacyEncryptionAlgorithm=PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY;
  try {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=null;
    String expectedResults=PasswordEncryptorUtil.encrypt(algorithm,"password",null);
    Assert.assertEquals(-1,expectedResults.indexOf("{" + PasswordEncryptorUtil.TYPE_PBKDF2));
    Assert.assertEquals(-1,expectedResults.indexOf("{" + algorithm));
    String newPassword=PasswordEncryptorUtil.encrypt(algorithm,"password",expectedResults);
    Assert.assertEquals(expectedResults,newPassword);
  }
  finally {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=legacyEncryptionAlgorithm;
  }
}
