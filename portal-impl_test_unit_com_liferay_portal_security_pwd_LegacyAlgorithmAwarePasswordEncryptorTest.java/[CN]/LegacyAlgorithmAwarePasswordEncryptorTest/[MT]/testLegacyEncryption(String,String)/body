{
  String legacyEncryptionAlgorithm=PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY;
  try {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=algorithm;
    String newPassword=PasswordEncryptorUtil.encrypt("password",currentEncryptedPassword);
    Assert.assertEquals(currentEncryptedPassword,newPassword);
    newPassword=PasswordEncryptorUtil.encrypt("password");
    Assert.assertNotEquals(-1,newPassword.indexOf("{" + PasswordEncryptorUtil.TYPE_PBKDF2));
    String expectedResults=PasswordEncryptorUtil.encrypt(algorithm,"password",null);
    Assert.assertTrue(algorithm.contains(getAlgorithmHeader(expectedResults)));
    String newPassword2=PasswordEncryptorUtil.encrypt("password",expectedResults);
    Assert.assertEquals(expectedResults,newPassword2);
  }
  finally {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=legacyEncryptionAlgorithm;
  }
}
