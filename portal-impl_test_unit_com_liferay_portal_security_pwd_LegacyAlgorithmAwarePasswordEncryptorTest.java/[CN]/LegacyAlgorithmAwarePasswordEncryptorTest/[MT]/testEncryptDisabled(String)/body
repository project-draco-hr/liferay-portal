{
  String legacyEncryptionAlgorithm=PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY;
  try {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=null;
    String encryptedPassword=PasswordEncryptorUtil.encrypt(algorithm,"password",null);
    Assert.assertEquals(-1,encryptedPassword.indexOf("{" + PasswordEncryptorUtil.TYPE_PBKDF2));
    Assert.assertEquals(-1,encryptedPassword.indexOf("{" + algorithm));
    Assert.assertEquals(encryptedPassword,PasswordEncryptorUtil.encrypt(algorithm,"password",encryptedPassword));
  }
  finally {
    PropsValues.PASSWORDS_ENCRYPTION_ALGORITHM_LEGACY=legacyEncryptionAlgorithm;
  }
}
