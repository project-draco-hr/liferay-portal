{
  Velocity.init();
  VelocityContext vc=new VelocityContext();
  if (variables != null) {
    Iterator<Map.Entry<String,Object>> itr=variables.entrySet().iterator();
    while (itr.hasNext()) {
      Map.Entry<String,Object> entry=itr.next();
      String key=entry.getKey();
      Object value=entry.getValue();
      if (Validator.isNotNull(key)) {
        vc.put(key,value);
      }
    }
  }
  StringWriter output=new StringWriter();
  Velocity.evaluate(vc,output,VelocityUtil.class.getName(),input);
  return output.toString();
}
