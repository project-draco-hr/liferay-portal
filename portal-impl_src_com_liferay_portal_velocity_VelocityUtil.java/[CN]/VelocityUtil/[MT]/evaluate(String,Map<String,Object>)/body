{
  Velocity.init();
  VelocityContext velocityContext=new VelocityContext();
  if (variables != null) {
    Iterator<Map.Entry<String,Object>> itr=variables.entrySet().iterator();
    while (itr.hasNext()) {
      Map.Entry<String,Object> entry=itr.next();
      String key=entry.getKey();
      Object value=entry.getValue();
      if (Validator.isNotNull(key)) {
        velocityContext.put(key,value);
      }
    }
  }
  UnsyncStringWriter unsyncStringWriter=new UnsyncStringWriter();
  Velocity.evaluate(velocityContext,unsyncStringWriter,VelocityUtil.class.getName(),input);
  return unsyncStringWriter.toString();
}
