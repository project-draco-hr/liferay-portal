{
  HttpServletResponse response=(HttpServletResponse)getResponse();
  if (response.isCommitted()) {
    return;
  }
  for (  Map.Entry<String,Set<Header>> entry : _headers.entrySet()) {
    String headerKey=entry.getKey();
    Set<Header> headers=entry.getValue();
    boolean first=true;
    for (    Header header : headers) {
      if (first) {
        header.setToResponse(headerKey,response);
        first=false;
      }
 else {
        header.addToResponse(headerKey,response);
      }
    }
  }
  if (_location != null) {
    response.sendRedirect(_location);
  }
 else   if (_error) {
    response.sendError(_status,_errorMessage);
  }
 else {
    if (_charsetName != null) {
      response.setCharacterEncoding(_charsetName);
    }
    if (_contentLength != -1) {
      response.setContentLength(_contentLength);
    }
    if (_contentType != null) {
      response.setContentType(_contentType);
    }
    if (_locale != null) {
      response.setLocale(_locale);
    }
    if (_status != SC_OK) {
      response.setStatus(_status,_statusMessage);
    }
  }
  _committed=true;
}
