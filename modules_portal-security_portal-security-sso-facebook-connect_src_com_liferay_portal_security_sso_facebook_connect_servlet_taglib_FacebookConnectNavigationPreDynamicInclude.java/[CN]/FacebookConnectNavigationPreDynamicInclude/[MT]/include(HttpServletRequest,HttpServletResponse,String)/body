{
  String strutsAction=ParamUtil.getString(request,"struts_action");
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (strutsAction.startsWith("/login/facebook_connect") || !_facebookConnect.isEnabled(themeDisplay.getCompanyId())) {
    return;
  }
  String facebookAuthRedirectURL=_facebookConnect.getRedirectURL(themeDisplay.getCompanyId());
  request.setAttribute(FacebookConnectWebKeys.FACEBOOK_AUTH_REDIRECT_URL,facebookAuthRedirectURL);
  String facebookAuthURL=_facebookConnect.getAuthURL(themeDisplay.getCompanyId());
  request.setAttribute(FacebookConnectWebKeys.FACEBOOK_AUTH_URL,facebookAuthURL);
  String facebookAppId=_facebookConnect.getAppId(themeDisplay.getCompanyId());
  request.setAttribute(FacebookConnectWebKeys.FACEBOOK_APP_ID,facebookAppId);
  RequestDispatcher requestDispatcher=_servletContext.getRequestDispatcher(_JSP_PATH);
  try {
    requestDispatcher.include(request,response);
  }
 catch (  ServletException se) {
    _log.error("Unable to include JSP",se);
    throw new IOException("Unable to include " + _JSP_PATH,se);
  }
}
