{
  _bundleContext=bundleContext;
  _serviceTrackerMap=ServiceTrackerMapFactory.multiValueMap(bundleContext,WikiEngine.class,null,new ServiceReferenceMapper<String,WikiEngine>(){
    @Override public void map(    ServiceReference<WikiEngine> serviceReference,    Emitter<String> emitter){
      String enabled=(String)serviceReference.getProperty("enabled");
      if (Validator.isNull(enabled)) {
        enabled=Boolean.TRUE.toString();
      }
      if (!Boolean.valueOf(enabled)) {
        return;
      }
      WikiEngine wikiEngine=_bundleContext.getService(serviceReference);
      try {
        emitter.emit(wikiEngine.getFormat());
      }
  finally {
        _bundleContext.ungetService(serviceReference);
      }
    }
  }
);
  _serviceTrackerMap.open();
}
