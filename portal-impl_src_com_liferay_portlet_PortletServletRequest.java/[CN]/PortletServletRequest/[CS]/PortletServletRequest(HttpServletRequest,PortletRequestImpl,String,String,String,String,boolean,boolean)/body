{
  super(request);
  _request=request;
  _portletRequestImpl=portletRequestImpl;
  _lifecycle=_portletRequestImpl.getLifecycle();
  _pathInfo=GetterUtil.getString(pathInfo);
  _queryString=GetterUtil.getString(queryString);
  _requestURI=GetterUtil.getString(requestURI);
  _servletPath=GetterUtil.getString(servletPath);
  _named=named;
  _include=include;
  long userId=PortalUtil.getUserId(request);
  String remoteUser=request.getRemoteUser();
  Portlet portlet=portletRequestImpl.getPortlet();
  String userPrincipalStrategy=portlet.getUserPrincipalStrategy();
  if (userPrincipalStrategy.equals(PortletConstants.USER_PRINCIPAL_STRATEGY_SCREEN_NAME)) {
    try {
      User user=PortalUtil.getUser(request);
      _remoteUser=user.getScreenName();
      _remoteUserId=user.getUserId();
      _userPrincipal=new ProtectedPrincipal(_remoteUser);
    }
 catch (    Exception e) {
      _log.error(e);
    }
  }
 else {
    if ((userId > 0) && (remoteUser == null)) {
      _remoteUser=String.valueOf(userId);
      _remoteUserId=userId;
      _userPrincipal=new ProtectedPrincipal(_remoteUser);
    }
 else {
      _remoteUser=remoteUser;
      _remoteUserId=GetterUtil.getLong(remoteUser);
      _userPrincipal=request.getUserPrincipal();
    }
  }
}
