{
  Element rootElement=null;
  try {
    if (document != null) {
      rootElement=document.getRootElement();
    }
 else {
      document=_saxReader.createDocument();
      rootElement=document.addElement("root");
    }
    Iterator<Field> itr=fields.iterator(true);
    while (itr.hasNext()) {
      Field field=itr.next();
      List<Node> nodes=getElementsByName(document,field.getName());
      for (      Node node : nodes) {
        document.remove(node);
      }
      appendField(rootElement,field);
    }
    return document.formattedString();
  }
 catch (  IOException ioe) {
    throw new SystemException(ioe);
  }
}
