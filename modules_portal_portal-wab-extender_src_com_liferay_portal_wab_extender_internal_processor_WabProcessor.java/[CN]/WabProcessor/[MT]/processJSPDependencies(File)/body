{
  DependencyVisitor dependencyVisitor=new DependencyVisitor();
  Source source=new ClassLoaderSource(_classLoader);
  String content=FileUtil.read(file);
  int contentX=-1;
  int contentY=content.length();
  Set<String> packageNames=new HashSet<String>();
  while (true) {
    contentX=content.lastIndexOf("<%@",contentY);
    if (contentX == -1) {
      break;
    }
    contentY=contentX;
    int importX=content.indexOf("import=\"",contentY);
    int importY=-1;
    if (importX != -1) {
      importX=importX + "import=\"".length();
      importY=content.indexOf("\"",importX);
    }
    if ((importX != -1) && (importY != -1)) {
      String s=content.substring(importX,importY);
      packageNames.addAll(processClass(dependencyVisitor,s.replace('.','/') + ".class",source));
    }
    contentY-=3;
  }
  Set<String> globals=dependencyVisitor.getGlobals();
  for (  String global : globals) {
    packageNames.add(global.replaceAll(StringPool.SLASH,StringPool.PERIOD));
  }
  return packageNames;
}
