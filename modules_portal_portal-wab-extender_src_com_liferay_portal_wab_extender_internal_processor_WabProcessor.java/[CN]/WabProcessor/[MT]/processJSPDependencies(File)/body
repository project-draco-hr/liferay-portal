{
  DependencyVisitor dependencyVisitor=new DependencyVisitor();
  Source source=new ClassLoaderSource(_classLoader);
  String content=FileUtil.read(file);
  int pos=-1;
  int startPos=content.length();
  Set<String> packages=new HashSet<String>();
  while (true) {
    pos=content.lastIndexOf("<%@",startPos);
    if (pos == -1) {
      break;
    }
    startPos=pos;
    int x=content.indexOf("import=\"",startPos);
    int y=-1;
    if (x != -1) {
      x=x + "import=\"".length();
      y=content.indexOf("\"",x);
    }
    if ((x != -1) && (y != -1)) {
      String s=content.substring(x,y);
      packages.addAll(processClass(dependencyVisitor,s.replace('.','/') + ".class",source));
    }
    startPos-=3;
  }
  Set<String> globals=dependencyVisitor.getGlobals();
  for (  String global : globals) {
    packages.add(global.replaceAll(StringPool.SLASH,StringPool.PERIOD));
  }
  return packages;
}
