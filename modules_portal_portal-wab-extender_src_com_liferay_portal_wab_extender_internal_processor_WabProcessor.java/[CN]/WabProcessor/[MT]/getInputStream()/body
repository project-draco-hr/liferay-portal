{
  _pluginDir=autoDeploy();
  if ((_pluginDir == null) || !_pluginDir.exists() || !_pluginDir.isDirectory()) {
    return null;
  }
  if (!isValidOSGiBundle()) {
    transformToOSGiBundle();
  }
  File file=_file.getParentFile();
  File outputFile=new File(file,"output.zip");
  JarOutputStream jarOutputStream=new JarOutputStream(new FileOutputStream(outputFile));
  try {
    writeJarPath(jarOutputStream,_ignoredResources,"META-INF/MANIFEST.MF",getManifestFile());
    writeJarPaths(jarOutputStream,_ignoredResources,_pluginDir,_pluginDir.toURI());
  }
  finally {
    jarOutputStream.close();
  }
  if (PropsValues.MODULE_FRAMEWORK_WEB_EXTENDER_GENERATED_WABS_STORE) {
    writeGeneratedWab(outputFile);
  }
  return new FileInputStream(outputFile);
}
