{
  long statsUserId=counterLocalService.increment();
  MBStatsUser statsUser=mbStatsUserPersistence.create(statsUserId);
  statsUser.setGroupId(groupId);
  statsUser.setUserId(userId);
  try {
    mbStatsUserPersistence.update(statsUser);
  }
 catch (  SystemException se) {
    if (_log.isWarnEnabled()) {
      _log.warn("Add failed, fetch {groupId=" + groupId + ", userId="+ userId+ "}");
    }
    statsUser=mbStatsUserPersistence.fetchByG_U(groupId,userId,false);
    if (statsUser == null) {
      throw se;
    }
  }
  return statsUser;
}
