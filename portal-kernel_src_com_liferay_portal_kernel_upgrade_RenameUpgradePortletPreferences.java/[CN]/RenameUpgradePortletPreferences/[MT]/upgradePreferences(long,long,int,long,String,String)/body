{
  PortletPreferences preferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  Map<String,String[]> preferencesMap=preferences.getMap();
  Map<String,String> preferenceNamesMap=getPreferenceNamesMap();
  for (  Map.Entry<String,String> entry : preferenceNamesMap.entrySet()) {
    String name=entry.getKey();
    String[] values=preferencesMap.get(name);
    if (values == null) {
      continue;
    }
    preferences.reset(name);
    preferences.setValues(entry.getValue(),values);
  }
  return PortletPreferencesFactoryUtil.toXML(preferences);
}
