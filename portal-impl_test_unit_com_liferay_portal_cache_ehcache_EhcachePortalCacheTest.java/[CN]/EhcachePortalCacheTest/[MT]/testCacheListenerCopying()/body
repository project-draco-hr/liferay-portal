{
  RegisteredEventListeners registeredEventListeners=_ehcachePortalCache.ehcache.getCacheEventNotificationService();
  Set<CacheEventListener> cacheEventListeners=registeredEventListeners.getCacheEventListeners();
  Assert.assertEquals(1,cacheEventListeners.size());
  Iterator<CacheEventListener> iterator=cacheEventListeners.iterator();
  CacheEventListener cacheEventListener=iterator.next();
  Assert.assertTrue(cacheEventListener instanceof PortalCacheCacheEventListener);
  PortalCacheCacheEventListener<Serializable,Serializable> portalCacheCacheEventListener=(PortalCacheCacheEventListener<Serializable,Serializable>)cacheEventListener;
  Assert.assertSame(_defaultCacheListener,portalCacheCacheEventListener.getCacheListener());
  Assert.assertSame(_ehcachePortalCache,portalCacheCacheEventListener.getPortalCache());
  String newCacheName="newCache";
  _cacheManager.addCache(newCacheName);
  Cache newCache=_cacheManager.getCache(newCacheName);
  _ehcachePortalCache.setEhcache(newCache);
  registeredEventListeners=newCache.getCacheEventNotificationService();
  Assert.assertEquals(1,cacheEventListeners.size());
  iterator=cacheEventListeners.iterator();
  cacheEventListener=iterator.next();
  Assert.assertTrue(cacheEventListener instanceof PortalCacheCacheEventListener);
  portalCacheCacheEventListener=(PortalCacheCacheEventListener<Serializable,Serializable>)cacheEventListener;
  Assert.assertSame(_defaultCacheListener,portalCacheCacheEventListener.getCacheListener());
  Assert.assertSame(_ehcachePortalCache,portalCacheCacheEventListener.getPortalCache());
}
