{
  Files.walkFileTree(filePath,new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult preVisitDirectory(    Path filePath,    BasicFileAttributes basicFileAttributes) throws IOException {
      SyncFile syncFile=SyncFileService.fetchSyncFile(filePath.toString());
      if (syncFile == null) {
        return FileVisitResult.SKIP_SUBTREE;
      }
      doWriteFileKey(filePath,String.valueOf(syncFile.getSyncFileId()));
      return super.preVisitDirectory(filePath,basicFileAttributes);
    }
    @Override public FileVisitResult visitFile(    Path filePath,    BasicFileAttributes basicFileAttributes) throws IOException {
      SyncFile syncFile=SyncFileService.fetchSyncFile(filePath.toString());
      if (syncFile != null) {
        doWriteFileKey(filePath,String.valueOf(syncFile.getSyncFileId()));
      }
      return FileVisitResult.CONTINUE;
    }
  }
);
}
