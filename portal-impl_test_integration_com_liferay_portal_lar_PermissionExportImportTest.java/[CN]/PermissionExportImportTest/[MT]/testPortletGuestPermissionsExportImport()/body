{
  LayoutSetPrototype exportLayoutSetPrototype=LayoutTestUtil.addLayoutSetPrototype(RandomTestUtil.randomString());
  Group exportGroup=exportLayoutSetPrototype.getGroup();
  Layout exportLayout=LayoutTestUtil.addLayout(exportGroup,true);
  String exportResourcePrimKey=PortletPermissionUtil.getPrimaryKey(exportLayout.getPlid(),_PORTLET_ID);
  Role role=RoleLocalServiceUtil.getRole(TestPropsValues.getCompanyId(),RoleConstants.GUEST);
  addPortletPermissions(exportGroup,role,exportResourcePrimKey);
  Element portletElement=exportPortletPermissions(exportGroup,exportLayout);
  LayoutSetPrototype importLayoutSetPrototype=LayoutTestUtil.addLayoutSetPrototype(RandomTestUtil.randomString());
  Group importGroup=importLayoutSetPrototype.getGroup();
  Layout importLayout=LayoutTestUtil.addLayout(importGroup,true);
  String importResourcePrimKey=PortletPermissionUtil.getPrimaryKey(importLayout.getPlid(),_PORTLET_ID);
  importPortletPermissions(importGroup,importLayout,portletElement);
  validateImportedPortletPermissions(importGroup,role,importResourcePrimKey);
  LayoutSetPrototypeLocalServiceUtil.deleteLayoutSetPrototype(exportLayoutSetPrototype);
  LayoutSetPrototypeLocalServiceUtil.deleteLayoutSetPrototype(importLayoutSetPrototype);
}
