{
  if (hasFile(companyId,repositoryId,fileName,versionLabel)) {
    throw new DuplicateFileException(companyId,repositoryId,fileName,versionLabel);
  }
  try {
    S3Object s3Object=new S3Object(_s3Bucket,getKey(companyId,repositoryId,fileName,versionLabel));
    s3Object.setDataInputStream(is);
    _s3Service.putObject(_s3Bucket,s3Object);
  }
 catch (  Exception e) {
    if (isS3NoSuchKeyException(e)) {
      throw new NoSuchFileException(companyId,repositoryId,fileName,versionLabel,e);
    }
    throw new SystemException(e);
  }
 finally {
    StreamUtil.cleanUp(is);
  }
}
