{
  String xmlUrl=getParameter(actionRequest,"xmlUrl");
  String xslUrl=getParameter(actionRequest,"xslUrl");
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  xmlUrl=StringUtil.replace(xmlUrl,"@portal_url@",themeDisplay.getPortalURL());
  xslUrl=StringUtil.replace(xslUrl,"@portal_url@",themeDisplay.getPortalURL());
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  Portlet xslPortlet=PortletLocalServiceUtil.getPortletById(portletResource);
  Map initParameters=xslPortlet.getInitParams();
  String[] allowedProtocols=GetterUtil.getStringValues(initParameters.get("allowed-protocols"),_ALLOWED_PROTOCOLS);
  if (!hasAllowedProtocol(xmlUrl,allowedProtocols)) {
    SessionErrors.add(actionRequest,"xmlUrl");
  }
  if (!hasAllowedProtocol(xslUrl,allowedProtocols)) {
    SessionErrors.add(actionRequest,"xslUrl");
  }
}
