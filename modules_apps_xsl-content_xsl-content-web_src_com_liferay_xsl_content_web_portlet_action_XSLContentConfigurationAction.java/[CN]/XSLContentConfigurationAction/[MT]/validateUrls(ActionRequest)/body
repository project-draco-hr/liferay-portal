{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String[] validUrlPrefixes=getValidUrlPrefixes(actionRequest);
  String xmlUrl=getParameter(actionRequest,"xmlUrl");
  xmlUrl=StringUtil.replace(xmlUrl,"@portal_url@",themeDisplay.getPortalURL());
  if (!hasAllowedProtocol(xmlUrl) || !hasValidUrlPrefix(validUrlPrefixes,xmlUrl)) {
    SessionErrors.add(actionRequest,"xmlUrl");
  }
  String xslUrl=getParameter(actionRequest,"xslUrl");
  xslUrl=StringUtil.replace(xslUrl,"@portal_url@",themeDisplay.getPortalURL());
  if (!hasAllowedProtocol(xslUrl) || !hasValidUrlPrefix(validUrlPrefixes,xslUrl)) {
    SessionErrors.add(actionRequest,"xslUrl");
  }
}
