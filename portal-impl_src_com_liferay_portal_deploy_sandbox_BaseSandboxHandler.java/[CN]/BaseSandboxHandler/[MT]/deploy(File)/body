{
  try {
    if (!isEnabled(dir)) {
      return;
    }
    String dirName=dir.getName();
    if (_log.isInfoEnabled()) {
      _log.info("Deploying " + dirName);
    }
    String pluginName=getPluginName(dirName);
    createPluginPackageProperties(dir,pluginName);
    PluginPackage pluginPackage=_deployer.readPluginPackage(dir);
    clonePlugin(dir,pluginPackage);
    String displayName=getDisplayName(dirName);
    _deployer.processPluginPackageProperties(dir,displayName,pluginPackage);
    _deployer.copyJars(dir,pluginPackage);
    _deployer.copyProperties(dir,pluginPackage);
    _deployer.copyTlds(dir,pluginPackage);
    _deployer.copyXmls(dir,displayName,pluginPackage);
    _deployer.updateWebXml(new File(dir,"WEB-INF/web.xml"),dir,displayName,pluginPackage);
    createContextXml(dir);
  }
 catch (  Exception e) {
    throw new SandboxDeployException(e);
  }
}
