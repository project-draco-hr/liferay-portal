{
  User user=PortalUtil.getSelectedUser(actionRequest,false);
  if (user == null) {
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long[] addRoleIds=StringUtil.split(ParamUtil.getString(actionRequest,"addRoleIds"),0L);
  long[] removeRoleIds=StringUtil.split(ParamUtil.getString(actionRequest,"removeRoleIds"),0L);
  _userGroupRoleService.addUserGroupRoles(user.getUserId(),themeDisplay.getSiteGroupId(),addRoleIds);
  _userGroupRoleService.deleteUserGroupRoles(user.getUserId(),themeDisplay.getSiteGroupId(),removeRoleIds);
  String redirect=ParamUtil.getString(actionRequest,"assignmentsRedirect");
  if (Validator.isNotNull(redirect)) {
    actionRequest.setAttribute(WebKeys.REDIRECT,redirect);
  }
}
