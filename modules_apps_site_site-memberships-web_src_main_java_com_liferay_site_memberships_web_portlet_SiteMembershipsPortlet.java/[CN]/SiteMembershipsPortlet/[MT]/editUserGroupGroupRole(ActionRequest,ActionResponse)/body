{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long userGroupId=ParamUtil.getLong(actionRequest,"userGroupId");
  long[] roleIds=ParamUtil.getLongValues(actionRequest,"rowIds");
  List<UserGroupGroupRole> userGroupGroupRoles=_userGroupGroupRoleLocalService.getUserGroupGroupRoles(userGroupId,themeDisplay.getSiteGroupId());
  List<Long> curRoleIds=ListUtil.toList(userGroupGroupRoles,UsersAdmin.USER_GROUP_GROUP_ROLE_ID_ACCESSOR);
  List<Long> removeRoleIds=new ArrayList<>();
  for (  long roleId : curRoleIds) {
    if (!ArrayUtil.contains(roleIds,roleId)) {
      removeRoleIds.add(roleId);
    }
  }
  _userGroupGroupRoleService.addUserGroupGroupRoles(userGroupId,themeDisplay.getSiteGroupId(),roleIds);
  _userGroupGroupRoleService.deleteUserGroupGroupRoles(userGroupId,themeDisplay.getSiteGroupId(),ArrayUtil.toLongArray(removeRoleIds));
}
