{
  long initialSearchGroupEntriesCount=0;
  assertGroupEntriesCount(initialSearchGroupEntriesCount);
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(group.getGroupId());
  BaseModel<?> parentBaseModel1=getParentBaseModel(group,serviceContext);
  BaseModel<?> parentBaseModel2=getParentBaseModel(group,serviceContext);
  String name=PrincipalThreadLocal.getName();
  try {
    User user1=UserTestUtil.addUser(null,0);
    PrincipalThreadLocal.setName(user1.getUserId());
    baseModel=addBaseModel(parentBaseModel1,true,RandomTestUtil.randomString(),serviceContext);
    baseModel=addBaseModel(parentBaseModel1,true,RandomTestUtil.randomString(),serviceContext);
    baseModel=addBaseModel(parentBaseModel2,true,RandomTestUtil.randomString(),serviceContext);
    User user2=UserTestUtil.addUser(null,0);
    PrincipalThreadLocal.setName(user2.getUserId());
    baseModel=addBaseModel(parentBaseModel1,true,RandomTestUtil.randomString(),serviceContext);
    baseModel=addBaseModel(parentBaseModel2,true,RandomTestUtil.randomString(),serviceContext);
  }
  finally {
    PrincipalThreadLocal.setName(name);
  }
  assertGroupEntriesCount(initialSearchGroupEntriesCount + 5);
  moveParentBaseModelToTrash((Long)parentBaseModel2.getPrimaryKeyObj());
  assertGroupEntriesCount(initialSearchGroupEntriesCount + 3);
  TrashHandler parentTrashHandler=TrashHandlerRegistryUtil.getTrashHandler(getParentBaseModelClassName());
  parentTrashHandler.restoreTrashEntry(TestPropsValues.getUserId(),(Long)parentBaseModel2.getPrimaryKeyObj());
  assertGroupEntriesCount(initialSearchGroupEntriesCount + 5);
}
