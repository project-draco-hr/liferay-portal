{
  if (isSharedRequestAttribute(name)) {
    if (value == _nullValue) {
      servletRequest.removeAttribute(name);
      if (_log.isDebugEnabled()) {
        _log.debug("Remove shared attribute " + name);
      }
    }
 else {
      Object masterValue=servletRequest.getAttribute(name);
      if ((masterValue == null) || !(value instanceof Mergeable)) {
        servletRequest.setAttribute(name,value);
        if (_log.isDebugEnabled()) {
          _log.debug("Set shared attribute " + name);
        }
      }
 else {
        Mergeable<Object> masterMergeable=(Mergeable<Object>)masterValue;
        Mergeable<Object> slaveMergeable=(Mergeable<Object>)value;
        masterMergeable.merge(slaveMergeable);
        if (_log.isDebugEnabled()) {
          _log.debug("Merge shared attribute " + name);
        }
      }
    }
  }
 else {
    if ((value != _nullValue) && _log.isDebugEnabled()) {
      _log.debug("Ignore setting restricted attribute " + name);
    }
  }
}
