{
  Long parentFolderId=(Long)getParameterValue("parentFolderId");
  if (parentFolderId != null) {
    super.processRequest();
    return;
  }
  SyncSite syncSite=(SyncSite)getParameterValue("syncSite");
  syncSite=SyncSiteService.fetchSyncSite(syncSite.getGroupId(),syncSite.getSyncAccountId());
  syncSite.setState(SyncSite.STATE_IN_PROGRESS);
  SyncSiteService.update(syncSite);
  if (syncSite.getRemoteSyncTime() == -1) {
    String filePathName=syncSite.getFilePathName();
    SyncFile syncFile=SyncFileService.fetchSyncFile(filePathName);
    if (syncFile == null) {
      Files.createDirectories(Paths.get(filePathName));
      SyncFileService.addSyncFile(null,null,null,filePathName,null,syncSite.getName(),0,syncSite.getGroupId(),SyncFile.STATE_SYNCED,syncSite.getSyncAccountId(),SyncFile.TYPE_SYSTEM,false);
    }
  }
  Map<String,Object> parameters=getParameters();
  parameters.clear();
  parameters.put("lastAccessTime",syncSite.getRemoteSyncTime());
  parameters.put("max",0);
  parameters.put("repositoryId",syncSite.getGroupId());
  parameters.put("syncSite",syncSite);
  executePost(_URL_PATH,parameters);
}
