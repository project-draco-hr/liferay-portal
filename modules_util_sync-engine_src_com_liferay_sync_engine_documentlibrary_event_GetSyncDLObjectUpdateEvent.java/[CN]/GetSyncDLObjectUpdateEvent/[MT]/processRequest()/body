{
  Long parentFolderId=(Long)getParameterValue("parentFolderId");
  if (parentFolderId != null) {
    super.processRequest();
    return;
  }
  SyncSite syncSite=(SyncSite)getParameterValue("syncSite");
  syncSite=SyncSiteService.fetchSyncSite(syncSite.getGroupId(),syncSite.getSyncAccountId());
  syncSite.setState(SyncSite.STATE_IN_PROGRESS);
  SyncSiteService.update(syncSite);
  if (syncSite.getRemoteSyncTime() == -1) {
    String filePathName=syncSite.getFilePathName();
    if (!Files.exists(Paths.get(filePathName))) {
      Files.createDirectories(Paths.get(filePathName));
    }
  }
  Map<String,Object> parameters=getParameters();
  parameters.put("lastAccessTime",syncSite.getRemoteSyncTime());
  parameters.put("max",0);
  parameters.put("repositoryId",syncSite.getGroupId());
  if ((syncSite.getRemoteSyncTime() == -1) && ReleaseInfo.isServerCompatible(getSyncAccountId(),5)) {
    parameters.put("retrieveFromCache",false);
  }
  parameters.put("syncSite",syncSite);
  executePost(_URL_PATH,parameters);
}
