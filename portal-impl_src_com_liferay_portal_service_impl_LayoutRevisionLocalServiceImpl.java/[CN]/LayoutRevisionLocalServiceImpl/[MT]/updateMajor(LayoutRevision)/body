{
  List<LayoutRevision> parentLayoutRevisions=new ArrayList<>();
  long parentLayoutRevisionId=layoutRevision.getParentLayoutRevisionId();
  while (parentLayoutRevisionId != LayoutRevisionConstants.DEFAULT_PARENT_LAYOUT_REVISION_ID) {
    LayoutRevision parentLayoutRevision=layoutRevisionPersistence.findByPrimaryKey(parentLayoutRevisionId);
    if (parentLayoutRevision.isMajor()) {
      break;
    }
    parentLayoutRevisions.add(parentLayoutRevision);
    parentLayoutRevisionId=parentLayoutRevision.getParentLayoutRevisionId();
  }
  layoutRevision.setParentLayoutRevisionId(parentLayoutRevisionId);
  layoutRevision.setMajor(true);
  layoutRevisionPersistence.update(layoutRevision);
  for (  LayoutRevision parentLayoutRevision : parentLayoutRevisions) {
    List<LayoutRevision> childrenLayoutRevisions=parentLayoutRevision.getChildren();
    if (!childrenLayoutRevisions.isEmpty()) {
      break;
    }
    layoutRevisionLocalService.deleteLayoutRevision(parentLayoutRevision);
  }
  return layoutRevision;
}
