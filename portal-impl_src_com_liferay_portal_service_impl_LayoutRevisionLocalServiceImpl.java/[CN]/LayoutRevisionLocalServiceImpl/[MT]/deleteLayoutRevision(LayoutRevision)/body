{
  if (layoutRevision.hasChildren()) {
    for (    LayoutRevision curLayoutRevision : layoutRevision.getChildren()) {
      curLayoutRevision.setParentLayoutRevisionId(layoutRevision.getParentLayoutRevisionId());
      layoutRevisionPersistence.update(curLayoutRevision);
    }
  }
  List<PortletPreferences> portletPreferencesList=portletPreferencesLocalService.getPortletPreferencesByPlid(layoutRevision.getLayoutRevisionId());
  for (  PortletPreferences portletPreferences : portletPreferencesList) {
    try {
      portletPreferencesLocalService.deletePortletPreferences(portletPreferences.getPortletPreferencesId());
    }
 catch (    NoSuchPortletPreferencesException nsppe) {
    }
  }
  User user=userPersistence.findByPrimaryKey(layoutRevision.getUserId());
  StagingUtil.deleteRecentLayoutRevisionId(user,layoutRevision.getLayoutSetBranchId(),layoutRevision.getPlid());
  return layoutRevisionPersistence.remove(layoutRevision);
}
