{
  if (layoutRevision.hasChildren()) {
    for (    LayoutRevision curLayoutRevision : layoutRevision.getChildren()) {
      curLayoutRevision.setParentLayoutRevisionId(layoutRevision.getParentLayoutRevisionId());
      layoutRevisionPersistence.update(curLayoutRevision);
    }
  }
  List<PortletPreferences> portletPreferencesList=portletPreferencesLocalService.getPortletPreferencesByPlid(layoutRevision.getLayoutRevisionId());
  for (  PortletPreferences portletPreferences : portletPreferencesList) {
    try {
      portletPreferencesLocalService.deletePortletPreferences(portletPreferences.getPortletPreferencesId());
    }
 catch (    NoSuchPortletPreferencesException nsppe) {
    }
  }
  User user=userPersistence.fetchByPrimaryKey(layoutRevision.getUserId());
  boolean isDefaultUser=true;
  if (user == null) {
    isDefaultUser=false;
  }
  StagingUtil.deleteRecentLayoutRevisionId(layoutRevision.getUserId(),layoutRevision.getLayoutSetBranchId(),layoutRevision.getPlid(),isDefaultUser);
  if (layoutRevision.isPending()) {
    workflowInstanceLinkLocalService.deleteWorkflowInstanceLink(layoutRevision.getCompanyId(),layoutRevision.getGroupId(),LayoutRevision.class.getName(),layoutRevision.getLayoutRevisionId());
  }
  return layoutRevisionPersistence.remove(layoutRevision);
}
