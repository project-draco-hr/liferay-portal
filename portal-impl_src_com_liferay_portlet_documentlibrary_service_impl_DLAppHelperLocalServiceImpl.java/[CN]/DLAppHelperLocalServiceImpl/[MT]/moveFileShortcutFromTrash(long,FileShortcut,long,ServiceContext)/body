{
  if (fileShortcut.isInTrashExplicitly()) {
    restoreFileShortcutFromTrash(userId,fileShortcut);
  }
 else {
    TrashVersion trashVersion=trashVersionLocalService.fetchVersion(DLFileShortcut.class.getName(),fileShortcut.getFileShortcutId());
    int status=WorkflowConstants.STATUS_APPROVED;
    if (trashVersion != null) {
      status=trashVersion.getStatus();
    }
    dlFileShortcutLocalService.updateStatus(userId,fileShortcut.getFileShortcutId(),status,new ServiceContext());
    if (trashVersion != null) {
      trashVersionLocalService.deleteTrashVersion(trashVersion);
    }
    JSONObject extraDataJSONObject=JSONFactoryUtil.createJSONObject();
    extraDataJSONObject.put("title",fileShortcut.getToTitle());
    socialActivityLocalService.addActivity(userId,fileShortcut.getGroupId(),DLFileShortcut.class.getName(),fileShortcut.getFileShortcutId(),SocialActivityConstants.TYPE_RESTORE_FROM_TRASH,extraDataJSONObject.toString(),0);
  }
  return dlAppService.updateFileShortcut(fileShortcut.getFileShortcutId(),newFolderId,fileShortcut.getToFileEntryId(),serviceContext);
}
