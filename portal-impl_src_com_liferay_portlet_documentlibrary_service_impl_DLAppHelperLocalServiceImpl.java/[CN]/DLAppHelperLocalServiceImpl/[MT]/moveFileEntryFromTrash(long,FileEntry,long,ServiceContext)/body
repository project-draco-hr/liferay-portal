{
  boolean hasLock=dlFileEntryLocalService.hasFileEntryLock(userId,fileEntry.getFileEntryId());
  if (!hasLock) {
    dlFileEntryLocalService.lockFileEntry(userId,fileEntry.getFileEntryId());
  }
  try {
    return doMoveFileEntryFromTrash(userId,fileEntry,newFolderId,serviceContext);
  }
  finally {
    if (!hasLock) {
      dlFileEntryLocalService.unlockFileEntry(fileEntry.getFileEntryId());
    }
  }
}
