{
  if (!DLAppHelperThreadLocal.isEnabled()) {
    return;
  }
  String cmd=serviceContext.getCommand();
  if ((cmd != null) && cmd.equals(Constants.REVERT)) {
    List<AssetCategory> categories=assetCategoryLocalService.getCategories(DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId());
    List<Long> categoryIds=ListUtil.toList(categories,AssetCategory.CATEGORY_ID_ACCESSOR);
    serviceContext.setAssetCategoryIds(ArrayUtil.toLongArray(categoryIds));
  }
  updateAsset(userId,fileEntry,destinationFileVersion,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames(),serviceContext.getAssetLinkEntryIds());
}
