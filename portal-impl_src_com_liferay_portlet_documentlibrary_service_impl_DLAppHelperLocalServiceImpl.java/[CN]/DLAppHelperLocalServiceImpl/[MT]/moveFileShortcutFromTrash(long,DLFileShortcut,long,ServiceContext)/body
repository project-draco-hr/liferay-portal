{
  TrashEntry trashEntry=dlFileShortcut.getTrashEntry();
  if (trashEntry.isTrashEntry(DLFileShortcut.class,dlFileShortcut.getFileShortcutId())) {
    restoreFileShortcutFromTrash(userId,dlFileShortcut);
  }
 else {
    TrashVersion trashVersion=trashVersionLocalService.fetchVersion(trashEntry.getEntryId(),DLFileShortcut.class.getName(),dlFileShortcut.getFolderId());
    int status=WorkflowConstants.STATUS_APPROVED;
    if (trashVersion != null) {
      status=trashVersion.getStatus();
    }
    dlFileShortcutLocalService.updateStatus(userId,dlFileShortcut.getFileShortcutId(),status,new ServiceContext());
    if (trashVersion != null) {
      trashVersionLocalService.deleteTrashVersion(trashVersion);
    }
    JSONObject extraDataJSONObject=JSONFactoryUtil.createJSONObject();
    extraDataJSONObject.put("title",dlFileShortcut.getToTitle());
    socialActivityLocalService.addActivity(userId,dlFileShortcut.getGroupId(),DLFileShortcut.class.getName(),dlFileShortcut.getFileShortcutId(),SocialActivityConstants.TYPE_RESTORE_FROM_TRASH,extraDataJSONObject.toString(),0);
  }
  return dlAppService.updateFileShortcut(dlFileShortcut.getFileShortcutId(),newFolderId,dlFileShortcut.getToFileEntryId(),serviceContext);
}
