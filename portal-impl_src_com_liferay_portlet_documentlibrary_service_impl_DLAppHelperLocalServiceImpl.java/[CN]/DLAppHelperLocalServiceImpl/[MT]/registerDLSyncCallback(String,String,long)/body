{
  final long modifiedDate=System.currentTimeMillis();
  dlSyncEventLocalService.addOrUpdateDLSyncEvent(typeId,type,event,modifiedDate);
  TransactionCommitCallbackRegistryUtil.registerCallback(new Callable<Void>(){
    @Override public Void call() throws Exception {
      Message message=new Message();
      Map<String,Object> values=new HashMap<String,Object>(4);
      values.put("event",event);
      values.put("modifiedDate",modifiedDate);
      values.put("type",type);
      values.put("typeId",typeId);
      message.setValues(values);
      MessageBusUtil.sendMessage(DestinationNames.DOCUMENT_LIBRARY_SYNC_PROCESSOR,message);
      return null;
    }
  }
);
}
