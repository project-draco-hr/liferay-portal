{
  if (status == WorkflowConstants.STATUS_APPROVED) {
    if (fileEntry.getVersion().equals(latestFileVersion.getVersion())) {
      if ((latestFileVersion.getVersion() != DLFileEntryConstants.DEFAULT_VERSION)) {
        AssetEntry draftAssetEntry=null;
        try {
          draftAssetEntry=assetEntryLocalService.getEntry(DLFileEntryConstants.getClassName(),latestFileVersion.getPrimaryKey());
          long[] assetCategoryIds=draftAssetEntry.getCategoryIds();
          String[] assetTagNames=draftAssetEntry.getTagNames();
          assetEntryLocalService.updateEntry(userId,fileEntry.getRepositoryId(),DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId(),fileEntry.getUuid(),assetCategoryIds,assetTagNames,true,null,null,null,null,draftAssetEntry.getMimeType(),fileEntry.getTitle(),fileEntry.getDescription(),null,null,0,0,null,false);
          assetEntryLocalService.deleteEntry(draftAssetEntry.getEntryId());
        }
 catch (        NoSuchEntryException nsee) {
        }
      }
      assetEntryLocalService.updateVisible(DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId(),true);
    }
    socialActivityLocalService.addUniqueActivity(latestFileVersion.getStatusByUserId(),fileEntry.getRepositoryId(),latestFileVersion.getCreateDate(),DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId(),DLActivityKeys.ADD_FILE_ENTRY,StringPool.BLANK,0);
  }
 else {
    if (Validator.isNull(fileEntry.getVersion())) {
      assetEntryLocalService.updateVisible(DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId(),false);
    }
  }
}
