{
  boolean hasLock=dlFileEntryLocalService.hasFileEntryLock(userId,fileEntry.getFileEntryId());
  if (!hasLock) {
    dlFileEntryLocalService.lockFileEntry(userId,fileEntry.getFileEntryId());
  }
  try {
    return doMoveFileEntryToTrash(userId,fileEntry);
  }
  finally {
    if (!hasLock) {
      dlFileEntryLocalService.unlockFileEntry(fileEntry.getFileEntryId());
    }
  }
}
