{
  long fileEntryId=fileEntry.getFileEntryId();
  boolean hasLock=dlFileEntryLocalService.hasFileEntryLock(userId,fileEntryId);
  if (!hasLock) {
    dlFileEntryLocalService.lockFileEntry(userId,fileEntryId);
  }
  try {
    return moveFileEntryToTrashImpl(userId,fileEntry);
  }
  finally {
    if (!hasLock) {
      dlFileEntryLocalService.unlockFileEntry(fileEntryId);
    }
  }
}
