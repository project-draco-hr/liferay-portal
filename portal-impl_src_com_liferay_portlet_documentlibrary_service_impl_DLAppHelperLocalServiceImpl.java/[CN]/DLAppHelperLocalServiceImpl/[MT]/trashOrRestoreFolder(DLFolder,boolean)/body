{
  TrashEntry trashEntry=null;
  if (moveToTrash) {
    trashEntry=trashEntryLocalService.getEntry(DLFolderConstants.getClassName(),dlFolder.getFolderId());
  }
  long dlFileEntryClassNameId=classNameLocalService.getClassNameId(DLFileEntry.class);
  List<AssetEntry> dlFileEntryAssets=dlFileEntryFinder.findAE_ByC_T(dlFileEntryClassNameId,dlFolder.getTreePath());
  for (  AssetEntry dlFileEntryAsset : dlFileEntryAssets) {
    assetEntryLocalService.updateVisible(dlFileEntryAsset,!moveToTrash);
  }
  long dlFolderClassNameId=classNameLocalService.getClassNameId(DLFolder.class);
  List<AssetEntry> dlFolderAssets=dlFolderFinder.findAE_ByC_T(dlFolderClassNameId,dlFolder.getTreePath());
  for (  AssetEntry dlFolderAsset : dlFolderAssets) {
    assetEntryLocalService.updateVisible(dlFolderAsset,!moveToTrash);
  }
  List<DLFolder> dlFolders=dlFolderPersistence.findByG_M_T_H(dlFolder.getGroupId(),false,CustomSQLUtil.keywords(dlFolder.getTreePath(),WildcardMode.TRAILING)[0],false);
  for (  DLFolder childDLFolder : dlFolders) {
    trashOrRestoreFolder(dlFolder,childDLFolder,moveToTrash,trashEntry);
  }
}
