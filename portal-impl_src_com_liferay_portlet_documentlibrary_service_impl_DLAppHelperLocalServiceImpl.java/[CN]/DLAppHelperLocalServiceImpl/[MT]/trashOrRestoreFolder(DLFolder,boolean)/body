{
  TrashEntry trashEntry=null;
  if (moveToTrash) {
    trashEntry=trashEntryLocalService.getEntry(DLFolderConstants.getClassName(),dlFolder.getFolderId());
  }
  long dlFileEntryClassNameId=classNameLocalService.getClassNameId(DLFileEntry.class);
  List<AssetEntry> dlFileEntryAssetEntries=assetEntryFinder.joinDLFE_ByAssetEntry(dlFileEntryClassNameId,dlFolder.getTreePath());
  for (  AssetEntry dlFileEntryAssetEntry : dlFileEntryAssetEntries) {
    assetEntryLocalService.updateVisible(dlFileEntryAssetEntry,!moveToTrash);
  }
  long dlFolderClassNameId=classNameLocalService.getClassNameId(DLFolder.class);
  List<AssetEntry> dlFolderAssetEntries=assetEntryFinder.joinDLF_ByAssetEntry(dlFolderClassNameId,dlFolder.getTreePath());
  for (  AssetEntry dlFolderAssetEntry : dlFolderAssetEntries) {
    assetEntryLocalService.updateVisible(dlFolderAssetEntry,!moveToTrash);
  }
  List<DLFolder> dlFolders=dlFolderPersistence.findByG_M_T_H(dlFolder.getGroupId(),false,CustomSQLUtil.keywords(dlFolder.getTreePath(),WildcardMode.TRAILING)[0],false);
  for (  DLFolder childDLFolder : dlFolders) {
    trashOrRestoreFolder(dlFolder,childDLFolder,moveToTrash,trashEntry);
  }
}
