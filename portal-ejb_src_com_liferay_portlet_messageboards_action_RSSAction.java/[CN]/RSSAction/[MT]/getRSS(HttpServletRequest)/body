{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  Company company=themeDisplay.getCompany();
  String plid=ParamUtil.getString(req,"p_l_id");
  String categoryId=ParamUtil.getString(req,"categoryId");
  String threadId=ParamUtil.getString(req,"threadId");
  double version=ParamUtil.getDouble(req,"version");
  String url="http://" + company.getPortalURL() + themeDisplay.getPathMain()+ "/message_boards/find_message?p_l_id="+ plid+ "&categoryId="+ categoryId;
  String rss=StringPool.BLANK;
  if (Validator.isNotNull(categoryId)) {
    rss=MBMessageLocalServiceUtil.getCategoryMessagesRSS(categoryId,0,SearchContainer.DEFAULT_DELTA,version,url);
  }
 else {
    rss=MBMessageLocalServiceUtil.getThreadMessagesRSS(threadId,0,SearchContainer.DEFAULT_DELTA,version,url);
  }
  return rss.getBytes();
}
