{
  String path=GetterUtil.getString(request.getPathInfo());
  String method=GetterUtil.getString(request.getMethod());
  String pathParameters=null;
  JSONRPCRequest jsonRpcRequest=null;
  int pathParametersIndex=_getPathParametersIndex(path);
  if (pathParametersIndex != -1) {
    pathParameters=path.substring(pathParametersIndex);
    path=path.substring(0,pathParametersIndex);
  }
 else {
    if (method.equals(HttpMethods.POST) && !PortalUtil.isMultipartRequest(request)) {
      jsonRpcRequest=new JSONRPCRequest(request);
      if (jsonRpcRequest.isValid()) {
        path+=StringPool.SLASH + jsonRpcRequest.getMethod();
        method=null;
      }
 else {
        jsonRpcRequest=null;
      }
    }
  }
  JSONWebServiceActionParameters actionParameters=new JSONWebServiceActionParameters();
  actionParameters.collectAll(request,pathParameters,jsonRpcRequest);
  String[] parameterNames=actionParameters.getParameterNames();
  int actionConfigIndex=_getJSONWebServiceActionConfigIndex(path,method,parameterNames);
  if (actionConfigIndex == -1) {
    throw new RuntimeException("No JSON web service action associated with path " + path + " and method "+ method);
  }
  JSONWebServiceActionConfig jsonWebServiceActionConfig=_jsonWebServiceActionConfig.get(actionConfigIndex);
  return new JSONWebServiceActionImpl(jsonWebServiceActionConfig,actionParameters);
}
