{
  _group=GroupTestUtil.addGroup();
  _blogLayout=LayoutTestUtil.addLayout(_group);
  _assetLayout=LayoutTestUtil.addLayout(_group);
  if (portletExists) {
    LayoutTestUtil.addPortletToLayout(_blogLayout,PortletKeys.BLOGS);
  }
  Map<String,String[]> preferenceMap=new HashMap<>();
  preferenceMap.put("assetLinkBehavior",new String[]{"viewInPortlet"});
  _assetPublisherPortletId=PortletKeys.ASSET_PUBLISHER + PortletConstants.INSTANCE_SEPARATOR + RandomTestUtil.randomString();
  LayoutTestUtil.addPortletToLayout(TestPropsValues.getUserId(),_assetLayout,_assetPublisherPortletId,"column-1",preferenceMap);
  Group group=_group;
  if (blogEntryWithDifferentGroup) {
    group=GroupTestUtil.addGroup();
  }
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(group.getGroupId(),TestPropsValues.getUserId());
  _blogsEntry=BlogsEntryLocalServiceUtil.addEntry(TestPropsValues.getUserId(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),serviceContext);
}
