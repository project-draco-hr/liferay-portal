{
  StringMaker sm=new StringMaker();
  sm.append(resourceName);
  sm.append(StringPool.PIPE);
  sm.append(scope);
  sm.append(StringPool.PIPE);
  sm.append(resourcePrimKey);
  String key=sm.toString();
  Resource resource=resourcesMap.get(key);
  if (resource == null) {
    try {
      resource=ResourceLocalServiceUtil.getResource(companyId,resourceName,scope,resourcePrimKey);
    }
 catch (    NoSuchResourceException nsre) {
      ResourceLocalServiceUtil.addResources(companyId,groupId,0,resourceName,resourcePrimKey,portletActions,true,true);
      resource=ResourceLocalServiceUtil.getResource(companyId,resourceName,scope,resourcePrimKey);
    }
    resourcesMap.put(key,resource);
  }
  return resource;
}
