{
  long entityGroupId=0;
  Long entityGroupIdObj=(Long)entityGroupIdMap.get(entityName);
  if (entityGroupIdObj == null) {
    if (entityName.equals("user-group")) {
      List userGroups=UserGroupLocalServiceUtil.search(companyId,name,null,null,0,1);
      if (userGroups.size() > 0) {
        UserGroup userGroup=(UserGroup)userGroups.get(0);
        Group group=userGroup.getGroup();
        entityGroupId=group.getGroupId();
      }
    }
 else     if (entityName.equals("organization") || entityName.equals("location")) {
      List organizations=null;
      if (entityName.equals("organization")) {
        organizations=OrganizationLocalServiceUtil.search(companyId,OrganizationImpl.ANY_PARENT_ORGANIZATION_ID,name,OrganizationImpl.TYPE_REGULAR,null,null,null,null,null,null,true,0,1);
      }
 else       if (entityName.equals("location")) {
        organizations=OrganizationLocalServiceUtil.search(companyId,OrganizationImpl.ANY_PARENT_ORGANIZATION_ID,name,OrganizationImpl.TYPE_LOCATION,null,null,null,null,null,null,true,0,1);
      }
      if (organizations.size() > 0) {
        Organization organization=(Organization)organizations.get(0);
        Group group=organization.getGroup();
        entityGroupId=group.getGroupId();
      }
    }
    entityGroupIdMap.put(entityName,entityGroupIdObj);
  }
 else {
    entityGroupId=entityGroupIdObj.longValue();
  }
  return entityGroupId;
}
