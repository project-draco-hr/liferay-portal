{
  String groupId=ParamUtil.getString(req,"groupId");
  boolean privateLayout=ParamUtil.getBoolean(req,"private");
  String parentLayoutId=ParamUtil.getString(req,"parent");
  String mainPath=ParamUtil.getString(req,"mainPath");
  String doAsUserId=ParamUtil.getString(req,"doAsUserId");
  String type=Layout.TYPE_PORTLET;
  String friendlyURL=StringPool.BLANK;
  boolean hidden=false;
  String name="New Page";
  Layout layout=LayoutServiceUtil.addLayout(groupId,privateLayout,parentLayoutId,name,type,hidden,friendlyURL);
  LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
  layoutTypePortlet.setLayoutTemplateId(PropsUtil.get(PropsUtil.LAYOUT_DEFAULT_TEMPLATE_ID));
  LayoutServiceUtil.updateLayout(layout.getLayoutId(),layout.getOwnerId(),layout.getTypeSettings());
  String layoutURL=PortalUtil.getLayoutActualURL(layout,mainPath);
  if (Validator.isNotNull(doAsUserId)) {
    layoutURL=Http.addParameter(layoutURL,"doAsUserId",doAsUserId);
  }
  return layoutURL;
}
