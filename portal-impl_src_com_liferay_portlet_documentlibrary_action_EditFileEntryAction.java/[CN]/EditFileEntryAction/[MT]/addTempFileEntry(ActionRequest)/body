{
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(actionRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long folderId=ParamUtil.getLong(uploadPortletRequest,"folderId");
  InputStream inputStream=null;
  try {
    inputStream=uploadPortletRequest.getFileAsStream("file");
    String sourceFileName=uploadPortletRequest.getFileName("file");
    DLAppServiceUtil.addTempFileEntry(themeDisplay.getScopeGroupId(),folderId,sourceFileName,_TEMP_FOLDER_NAME,inputStream);
  }
  finally {
    StreamUtil.cleanUp(inputStream);
  }
}
