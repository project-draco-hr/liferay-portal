{
  if (e instanceof AssetCategoryException || e instanceof AssetTagException) {
    SessionErrors.add(actionRequest,e.getClass(),e);
  }
 else   if (e instanceof DuplicateFileException || e instanceof DuplicateFolderNameException || e instanceof FileExtensionException|| e instanceof FileMimeTypeException|| e instanceof FileNameException|| e instanceof FileSizeException|| e instanceof NoSuchFolderException|| e instanceof SourceFileNameException|| e instanceof StorageFieldRequiredException) {
    if (!cmd.equals(Constants.ADD_MULTIPLE) && !cmd.equals(Constants.ADD_TEMP)) {
      SessionErrors.add(actionRequest,e.getClass());
      return;
    }
    if (e instanceof DuplicateFileException || e instanceof FileExtensionException || e instanceof FileNameException|| e instanceof FileSizeException) {
      HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
      response.setContentType(ContentTypes.TEXT_HTML);
      response.setStatus(HttpServletResponse.SC_OK);
      int errorType=0;
      if (e instanceof DuplicateFileException) {
        errorType=ServletResponseConstants.SC_DUPLICATE_FILE_EXCEPTION;
      }
 else       if (e instanceof FileExtensionException) {
        errorType=ServletResponseConstants.SC_FILE_EXTENSION_EXCEPTION;
      }
 else       if (e instanceof FileNameException) {
        errorType=ServletResponseConstants.SC_FILE_NAME_EXCEPTION;
      }
 else       if (e instanceof FileSizeException) {
        errorType=ServletResponseConstants.SC_FILE_SIZE_EXCEPTION;
      }
      ServletResponseUtil.write(response,String.valueOf(errorType));
    }
    SessionErrors.add(actionRequest,e.getClass());
  }
 else   if (e instanceof DuplicateLockException || e instanceof InvalidFileVersionException || e instanceof NoSuchFileEntryException|| e instanceof PrincipalException) {
    if (e instanceof DuplicateLockException) {
      DuplicateLockException dle=(DuplicateLockException)e;
      SessionErrors.add(actionRequest,dle.getClass(),dle.getLock());
    }
 else {
      SessionErrors.add(actionRequest,e.getClass());
    }
    setForward(actionRequest,"portlet.document_library.error");
  }
 else {
    throw e;
  }
}
