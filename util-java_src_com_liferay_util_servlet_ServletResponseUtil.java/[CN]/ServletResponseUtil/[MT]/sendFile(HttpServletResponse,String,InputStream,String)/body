{
  if (_log.isDebugEnabled()) {
    _log.debug("Sending file of type " + contentType);
  }
  res.setContentType(contentType);
  res.setHeader(HttpHeaders.CACHE_CONTROL,HttpHeaders.PUBLIC);
  res.setHeader(HttpHeaders.PRAGMA,HttpHeaders.PUBLIC);
  if (Validator.isNotNull(fileName)) {
    res.setHeader(HttpHeaders.CONTENT_DISPOSITION,"attachment; filename=\"" + fileName + "\"");
  }
  ServletOutputStream sos=null;
  try {
    sos=res.getOutputStream();
    int c=is.read();
    while (c != -1) {
      sos.write(c);
      c=is.read();
    }
  }
  finally {
    try {
      is.close();
    }
 catch (    Exception e) {
      _log.warn(e);
    }
    try {
      sos.flush();
    }
 catch (    Exception e) {
      _log.warn(e);
    }
    try {
      sos.close();
    }
 catch (    Exception e) {
      _log.warn(e);
    }
  }
}
