{
  if (response instanceof StringServletResponse) {
    StringServletResponse targetStringResponse=(StringServletResponse)response;
    String content=FileUtil.read(file);
    targetStringResponse.setString(content);
  }
 else   if (response instanceof ByteBufferServletResponse) {
    ByteBufferServletResponse targetByteBufferResponse=(ByteBufferServletResponse)response;
    ByteBuffer byteBuffer=ByteBuffer.wrap(FileUtil.getBytes(file));
    targetByteBufferResponse.setByteBuffer(byteBuffer);
  }
 else {
    FileInputStream fileInputStream=new FileInputStream(file);
    FileChannel fileChannel=fileInputStream.getChannel();
    try {
      int contentLength=(int)fileChannel.size();
      response.setContentLength(contentLength);
      fileChannel.transferTo(0,contentLength,Channels.newChannel(response.getOutputStream()));
    }
  finally {
      fileChannel.close();
    }
  }
}
