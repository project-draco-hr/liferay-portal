{
  Matcher matcher=_xssPattern.matcher(jspContent);
  while (matcher.find()) {
    boolean xssVulnerable=false;
    String jspVariable=matcher.group(1);
    String inputVulnerability="<input[^<>]*(<[^(/>)]*/>)*[^<>]* value=\"<%= " + jspVariable + " %>";
    Pattern inputVulnerabilityPattern=Pattern.compile(inputVulnerability,Pattern.CASE_INSENSITIVE);
    Matcher inputVulnerabilityMatcher=inputVulnerabilityPattern.matcher(jspContent);
    if (inputVulnerabilityMatcher.find()) {
      xssVulnerable=true;
    }
    String anchorVulnerability=" href=\"<%= " + jspVariable + " %>";
    if (jspContent.indexOf(anchorVulnerability) != -1) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability1="'<%= " + jspVariable + " %>";
    if (jspContent.indexOf(inlineStringVulnerability1) != -1) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability2="(\"<%= " + jspVariable + " %>";
    if (jspContent.indexOf(inlineStringVulnerability2) != -1) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability3=" \"<%= " + jspVariable + " %>";
    if (jspContent.indexOf(inlineStringVulnerability3) != -1) {
      xssVulnerable=true;
    }
    String documentIdVulnerability=".<%= " + jspVariable + " %>";
    if (jspContent.indexOf(documentIdVulnerability) != -1) {
      xssVulnerable=true;
    }
    if (xssVulnerable) {
      helper.printFmtError(fileName,"(xss): " + fileName + " ("+ jspVariable+ ")");
    }
  }
}
