{
  Matcher matcher=_xssPattern.matcher(jspContent);
  while (matcher.find()) {
    boolean xssVulnerable=false;
    String jspVariable=matcher.group(1);
    String anchorVulnerability=" href=\"<%= " + jspVariable + " %>";
    if (_checkTaglibVulnerability(jspContent,anchorVulnerability)) {
      xssVulnerable=true;
    }
    String inputVulnerability=" value=\"<%= " + jspVariable + " %>";
    if (_checkTaglibVulnerability(jspContent,inputVulnerability)) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability1="'<%= " + jspVariable + " %>";
    if (jspContent.contains(inlineStringVulnerability1)) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability2="(\"<%= " + jspVariable + " %>";
    if (jspContent.contains(inlineStringVulnerability2)) {
      xssVulnerable=true;
    }
    String inlineStringVulnerability3=" \"<%= " + jspVariable + " %>";
    if (jspContent.contains(inlineStringVulnerability3)) {
      xssVulnerable=true;
    }
    String documentIdVulnerability=".<%= " + jspVariable + " %>";
    if (jspContent.contains(documentIdVulnerability)) {
      xssVulnerable=true;
    }
    if (xssVulnerable) {
      _sourceFormatterHelper.printError(fileName,"(xss): " + fileName + " ("+ jspVariable+ ")");
    }
  }
}
