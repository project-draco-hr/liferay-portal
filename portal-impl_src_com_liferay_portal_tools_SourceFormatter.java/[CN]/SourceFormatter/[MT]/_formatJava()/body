{
  String basedir="./";
  String copyright=_getCopyright();
  String oldCopyright=_getOldCopyright();
  boolean portalJavaFiles=true;
  String[] files=null;
  if (_fileUtil.exists(basedir + "portal-impl")) {
    files=_getPortalJavaFiles();
  }
 else {
    portalJavaFiles=false;
    files=_getPluginJavaFiles();
  }
  Properties properties=new Properties();
  File propertiesFile=_getPropertiesFile(basedir,".java.temp");
  String propertiesContent=StringPool.BLANK;
  if (propertiesFile.exists()) {
    propertiesContent=_fileUtil.read(propertiesFile);
    PropertiesUtil.load(properties,propertiesContent);
  }
  for (int i=0; i < files.length; i++) {
    File file=new File(basedir + files[i]);
    String key=StringUtil.replace(file.getPath(),StringPool.BACK_SLASH,StringPool.SLASH);
    long lastModified=GetterUtil.getLong(properties.getProperty(key));
    if (file.lastModified() == lastModified) {
      continue;
    }
 else {
      properties.setProperty(key,String.valueOf(file.lastModified()));
    }
    String content=_fileUtil.read(file);
    String className=file.getName();
    className=className.substring(0,className.length() - 5);
    String packagePath=files[i];
    int packagePathX=packagePath.indexOf(File.separator + "src" + File.separator);
    int packagePathY=packagePath.lastIndexOf(File.separator);
    if ((packagePathX + 5) >= packagePathY) {
      packagePath=StringPool.BLANK;
    }
 else {
      packagePath=packagePath.substring(packagePathX + 5,packagePathY);
    }
    packagePath=StringUtil.replace(packagePath,File.separator,StringPool.PERIOD);
    if (packagePath.endsWith(".model")) {
      if (content.indexOf("extends " + className + "Model {") != -1) {
        continue;
      }
    }
    String newContent=_formatJavaContent(files[i],className,content);
    if (newContent.indexOf("$\n */") != -1) {
      System.out.println("*: " + files[i]);
      newContent=StringUtil.replace(newContent,"$\n */","$\n *\n */");
    }
    if ((oldCopyright != null) && newContent.contains(oldCopyright)) {
      newContent=StringUtil.replace(newContent,oldCopyright,copyright);
      System.out.println("old (c): " + files[i]);
    }
    if (newContent.indexOf(copyright) == -1) {
      System.out.println("(c): " + files[i]);
    }
    if (newContent.indexOf(className + ".java.html") == -1) {
      System.out.println("Java2HTML: " + files[i]);
    }
    if (newContent.contains(" * @author Raymond Aug") && !newContent.contains(" * @author Raymond Aug\u00e9")) {
      newContent=newContent.replaceFirst("Raymond Aug.++","Raymond Aug\u00e9");
      System.out.println("UTF-8: " + files[i]);
    }
    if (newContent.contains("com.liferay.portal.PortalException")) {
      newContent=StringUtil.replace(newContent,"com.liferay.portal.PortalException","com.liferay.portal.kernel.exception.PortalException");
    }
    if (newContent.contains("com.liferay.portal.SystemException")) {
      newContent=StringUtil.replace(newContent,"com.liferay.portal.SystemException","com.liferay.portal.kernel.exception.SystemException");
    }
    if (newContent.contains("com.liferay.util.LocalizationUtil")) {
      newContent=StringUtil.replace(newContent,"com.liferay.util.LocalizationUtil","com.liferay.portal.kernel.util.LocalizationUtil");
    }
    newContent=stripImports(newContent,packagePath,className);
    if (newContent.indexOf(";\n/**") != -1) {
      newContent=StringUtil.replace(newContent,";\n/**",";\n\n/**");
    }
    if (newContent.indexOf("\t/*\n\t *") != -1) {
      newContent=StringUtil.replace(newContent,"\t/*\n\t *","\t/**\n\t *");
    }
    if (newContent.indexOf("if(") != -1) {
      newContent=StringUtil.replace(newContent,"if(","if (");
    }
    if (newContent.indexOf("while(") != -1) {
      newContent=StringUtil.replace(newContent,"while(","while (");
    }
    if (newContent.indexOf("\n\n\n") != -1) {
      newContent=StringUtil.replace(newContent,"\n\n\n","\n\n");
    }
    if (newContent.indexOf("*/\npackage ") != -1) {
      System.out.println("package: " + files[i]);
    }
    if (newContent.indexOf("    ") != -1) {
      if (!files[i].endsWith("StringPool.java")) {
        System.out.println("tab: " + files[i]);
      }
    }
    if (newContent.indexOf("  {") != -1) {
      System.out.println("{:" + files[i]);
    }
    if (!newContent.endsWith("\n\n}") && !newContent.endsWith("{\n}")) {
      System.out.println("}: " + files[i]);
    }
    if (portalJavaFiles && className.endsWith("ServiceImpl") && (newContent.indexOf("ServiceUtil.") != -1)) {
      System.out.println("ServiceUtil: " + files[i]);
    }
    if ((newContent != null) && !content.equals(newContent)) {
      _fileUtil.write(file,newContent);
      System.out.println(file);
    }
  }
  String newPropertiesContent=PropertiesUtil.toString(properties);
  if (!propertiesContent.equals(newPropertiesContent)) {
    _fileUtil.write(propertiesFile,newPropertiesContent);
  }
}
