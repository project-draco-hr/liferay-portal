{
  if (_receiveRequest) {
    MessageBusUtil.registerMessageListener(DestinationNames.POLLER_RESPONSE,this);
  }
  for (  PollerRequestResponsePair pollerRequestResponsePair : _pollerRequestResponsePairs.values()) {
    PollerRequest pollerRequest=pollerRequestResponsePair.getPollerRequest();
    if (_receiveRequest) {
      PollerResponse pollerResponse=new DefaultPollerResponse(pollerRequest.getPortletId(),pollerRequest.getChunkId());
      pollerRequestResponsePair.setPollerResponse(pollerResponse);
    }
    Message message=new Message();
    message.setPayload(pollerRequestResponsePair);
    if (_receiveRequest) {
      message.setResponseDestinationName(DestinationNames.POLLER_RESPONSE);
    }
    String responseId=PortalUUIDUtil.generate();
    message.setResponseId(responseId);
    _responseIds.put(responseId,responseId);
    MessageBusUtil.sendMessage(DestinationNames.POLLER,message);
  }
}
