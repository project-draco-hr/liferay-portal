{
  PortletPermissionUtil.check(getPermissionChecker(),plid,PortletKeys.ANNOUNCEMENTS,ActionKeys.ADD_ANNOUNCEMENT);
  if (classNameId == 0) {
    if (!getPermissionChecker().isOmniadmin()) {
      throw new PrincipalException();
    }
  }
 else {
    String className=PortalUtil.getClassName(classNameId);
    if (className.equals(Role.class.getName()) && !RolePermissionUtil.contains(getPermissionChecker(),classPK,ActionKeys.ASSIGN_MEMBERS)) {
      throw new PrincipalException();
    }
 else     if (className.equals(UserGroup.class.getName()) && !UserGroupPermissionUtil.contains(getPermissionChecker(),classPK,ActionKeys.ASSIGN_MEMBERS)) {
      throw new PrincipalException();
    }
 else     if (className.equals(Group.class.getName()) && !GroupPermissionUtil.contains(getPermissionChecker(),classPK,ActionKeys.ASSIGN_MEMBERS)) {
      throw new PrincipalException();
    }
 else     if (className.equals(Organization.class.getName()) && !OrganizationPermissionUtil.contains(getPermissionChecker(),classPK,ActionKeys.ASSIGN_MEMBERS)) {
      throw new PrincipalException();
    }
  }
  return announcementLocalService.addAnnouncement(userId,classNameId,classPK,title,content,url,type,displayMonth,displayDay,displayYear,expirationMonth,expirationDay,expirationYear,priority,alert);
}
