{
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Map<String,Boolean> activitySettingsMap=new LinkedHashMap<String,Boolean>();
  List<SocialActivitySetting> activitySettings=SocialActivitySettingLocalServiceUtil.getActivitySettings(themeDisplay.getScopeGroupIdOrLiveGroupId());
  String[] modelNames=SocialConfigurationUtil.getActivityModelNames();
  Comparator<String> comparator=new ModelResourceComparator(themeDisplay.getLocale());
  Arrays.sort(modelNames,comparator);
  for (  String modelName : modelNames) {
    activitySettingsMap.put(modelName,false);
  }
  for (  SocialActivitySetting activitySetting : activitySettings) {
    String name=activitySetting.getName();
    if (name.equals("enabled") && activitySettingsMap.containsKey(activitySetting.getClassName())) {
      activitySettingsMap.put(activitySetting.getClassName(),GetterUtil.getBoolean(activitySetting.getValue()));
    }
  }
  renderRequest.setAttribute(WebKeys.SOCIAL_ACTIVITY_SETTINGS_MAP,activitySettingsMap);
  return mapping.findForward("portlet.social_activity.view");
}
