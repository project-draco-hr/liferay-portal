{
  LayoutReference[] layoutReferences=layoutLocalService.getLayouts(companyId,portletId,preferencesKey,preferencesValue);
  List<LayoutReference> filteredLayoutReferences=new ArrayList<>(layoutReferences.length);
  for (  LayoutReference layoutReference : layoutReferences) {
    try {
      if (LayoutPermissionUtil.contains(getPermissionChecker(),layoutReference.getLayoutSoap().getPlid(),ActionKeys.VIEW)) {
        filteredLayoutReferences.add(layoutReference);
      }
    }
 catch (    PortalException pe) {
      continue;
    }
  }
  return filteredLayoutReferences.toArray(new LayoutReference[filteredLayoutReferences.size()]);
}
