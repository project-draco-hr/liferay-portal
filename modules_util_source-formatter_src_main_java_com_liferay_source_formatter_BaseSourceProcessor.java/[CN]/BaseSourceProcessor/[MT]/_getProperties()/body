{
  String fileName="source-formatter.properties";
  Properties properties=new Properties();
  List<Properties> propertiesList=new ArrayList<>();
  if (portalSource) {
    File propertiesFile=getFile("portal-impl/src/" + fileName,PORTAL_MAX_DIR_LEVEL);
    if (propertiesFile != null) {
      InputStream inputStream=new FileInputStream(propertiesFile);
      properties=new Properties();
      properties.load(inputStream);
      propertiesList.add(properties);
    }
  }
 else {
    for (int i=0; i <= PLUGINS_MAX_DIR_LEVEL; i++) {
      try {
        InputStream inputStream=new FileInputStream(sourceFormatterArgs.getBaseDirName() + fileName);
        Properties props=new Properties();
        props.load(inputStream);
        propertiesList.add(props);
        break;
      }
 catch (      FileNotFoundException fnfe) {
      }
      fileName="../" + fileName;
    }
  }
  if (propertiesList.isEmpty()) {
    return properties;
  }
  properties=propertiesList.get(0);
  if (propertiesList.size() == 1) {
    return properties;
  }
  for (int i=1; i < propertiesList.size(); i++) {
    Properties props=propertiesList.get(i);
    Enumeration<String> enu=(Enumeration<String>)props.propertyNames();
    while (enu.hasMoreElements()) {
      String key=enu.nextElement();
      String value=props.getProperty(key);
      if (Validator.isNull(value)) {
        continue;
      }
      if (key.contains("excludes")) {
        String existingValue=properties.getProperty(key);
        if (Validator.isNotNull(existingValue)) {
          value=existingValue + StringPool.COMMA + value;
        }
        properties.put(key,value);
      }
 else       if (!properties.containsKey(key)) {
        properties.put(key,value);
      }
    }
  }
  return properties;
}
