{
  preFormat();
  List<String> fileNames=getFileNames();
  int processorThreadCount=GetterUtil.getInteger(System.getProperty("source.formatter.processor.thread.count"),5);
  ExecutorService executorService=Executors.newFixedThreadPool(processorThreadCount);
  List<Future<Void>> futures=new ArrayList<>(fileNames.size());
  for (  final String fileName : fileNames) {
    Future<Void> future=executorService.submit(new Callable<Void>(){
      @Override public Void call() throws Exception {
        try {
          format(fileName);
          return null;
        }
 catch (        Exception e) {
          throw new RuntimeException("Unable to format " + fileName,e);
        }
      }
    }
);
    futures.add(future);
  }
  for (  Future<Void> future : futures) {
    future.get();
  }
  executorService.shutdown();
  postFormat();
  _sourceFormatterHelper.close();
}
