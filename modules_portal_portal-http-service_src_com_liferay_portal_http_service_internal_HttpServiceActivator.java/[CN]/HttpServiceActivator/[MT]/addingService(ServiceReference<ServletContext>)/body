{
  BundleContext bundleContext=getBundleContext();
  ServletContext servletContext=bundleContext.getService(serviceReference);
  ServletConfig servletConfig=new BundleServletConfig(servletContext,"Web Extender Servlet",null,new PortalHttpContext(servletContext));
  try {
    _webExtenderServlet=new WebExtenderServlet(bundleContext);
    _webExtenderServlet.init(servletConfig);
    _webBundleDeployer=new WebBundleDeployer(_webExtenderServlet);
    _startedBundleListener=new StartedBundleListener(_webBundleDeployer);
    bundleContext.addBundleListener(_startedBundleListener);
    _stoppedBundleListener=new StoppedBundleListener(_webBundleDeployer);
    bundleContext.addBundleListener(_stoppedBundleListener);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  checkStartableBundles();
  return servletContext;
}
