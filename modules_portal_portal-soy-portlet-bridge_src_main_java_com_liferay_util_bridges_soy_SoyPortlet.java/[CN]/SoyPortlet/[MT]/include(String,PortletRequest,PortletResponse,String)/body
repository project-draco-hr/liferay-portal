{
  try {
    template.put(TemplateConstants.NAMESPACE,namespace);
    Writer writer=null;
    if (portletResponse instanceof MimeResponse) {
      MimeResponse mimeResponse=(MimeResponse)portletResponse;
      writer=UnsyncPrintWriterPool.borrow(mimeResponse.getWriter());
    }
 else {
      writer=new UnsyncStringWriter();
    }
    template.processTemplate(writer);
  }
 catch (  Exception e) {
    throw new PortletException(e);
  }
  if (clearRequestParameters) {
    if (lifecycle.equals(PortletRequest.RENDER_PHASE)) {
      portletResponse.setProperty("clear-request-parameters","true");
    }
  }
}
