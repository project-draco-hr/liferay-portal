{
  DirectoryScanner directoryScanner=new DirectoryScanner();
  directoryScanner.setBasedir(dir);
  directoryScanner.setIncludes(new String[]{"**\\liferay-plugin-package.properties"});
  directoryScanner.scan();
  String dirName=dir.getCanonicalPath();
  for (  String fileName : directoryScanner.getIncludedFiles()) {
    setupWarProject(dirName,fileName);
  }
  directoryScanner=new DirectoryScanner();
  directoryScanner.setBasedir(dir);
  directoryScanner.setIncludes(new String[]{"**\\build.xml"});
  directoryScanner.scan();
  for (  String fileName : directoryScanner.getIncludedFiles()) {
    String content=_fileUtil.read(dirName + "/" + fileName);
    boolean osgiProject=false;
    if (content.contains("<import file=\"../../build-common-osgi-plugin.xml\" />") || content.contains("../tools/sdk/build-common-osgi-plugin.xml\" />")) {
      osgiProject=true;
    }
    boolean sharedProject=false;
    if (content.contains("<import file=\"../build-common-shared.xml\" />") || content.contains("../tools/sdk/build-common-shared.xml\" />")) {
      sharedProject=true;
    }
    List<String> dependencyJars=Collections.emptyList();
    if (osgiProject) {
      int x=content.indexOf("osgi.plugin.portal.lib.jars");
      if (x != -1) {
        x=content.indexOf("value=\"",x);
        x=content.indexOf("\"",x);
        int y=content.indexOf("\"",x + 1);
        dependencyJars=Arrays.asList(StringUtil.split(content.substring(x + 1,y)));
      }
    }
    if (osgiProject || sharedProject) {
      setupJarProject(dirName,fileName,dependencyJars,sharedProject);
    }
  }
}
