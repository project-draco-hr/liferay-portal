{
  AssetEntry assetEntry=_assetEntry;
  if ((assetEntry == null) && Validator.isNotNull(_className) && (_classPK > 0)) {
    try {
      assetEntry=AssetEntryLocalServiceUtil.getEntry(_className,_classPK);
    }
 catch (    PortalException e) {
      _log.error(e);
    }
  }
  request.setAttribute("liferay-ui:asset-display:assetEntry",_assetEntry);
  AssetRenderer assetRenderer=_assetRenderer;
  if (assetRenderer == null) {
    assetRenderer=assetEntry.getAssetRenderer();
  }
  request.setAttribute(WebKeys.ASSET_RENDERER,assetRenderer);
  try {
    _page=assetRenderer.render((RenderRequest)pageContext.getAttribute("renderRequest"),(RenderResponse)pageContext.getAttribute("renderResponse"),_template);
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (Validator.isNull(_page)) {
    _page="/html/taglib/ui/asset_diplay/" + _template + ".jsp";
  }
  AssetRendererFactory assetRendererFactory=_assetRendererFactory;
  if (assetRendererFactory == null) {
    assetRendererFactory=assetEntry.getAssetRendererFactory();
  }
  request.setAttribute(WebKeys.ASSET_RENDERER_FACTORY,assetRendererFactory);
  if (Validator.isNotNull(assetRendererFactory.getPortletId())) {
    String rootPortletId=PortletConstants.getRootPortletId(assetRendererFactory.getPortletId());
    PortletBag portletBag=PortletBagPool.get(rootPortletId);
    servletContext=portletBag.getServletContext();
  }
  addParam("showComments",String.valueOf(_showComments));
  addParam("showExtraInfo",String.valueOf(_showExtraInfo));
  addParam("showHeader",String.valueOf(_showHeader));
}
