{
  JournalArticle journalArticle=null;
  Group companyGroup=GroupLocalServiceUtil.getCompanyGroup(themeDisplay.getCompanyId());
  try {
    journalArticle=JournalArticleLocalServiceUtil.getDisplayArticle(themeDisplay.getScopeGroupId(),articleId);
  }
 catch (  NoSuchArticleException nsae) {
    journalArticle=JournalArticleLocalServiceUtil.getDisplayArticle(companyGroup.getGroupId(),articleId);
  }
  String portletIds=getRuntimePortletIds(journalArticle.getContent());
  if (Validator.isNotNull(journalArticle.getTemplateId())) {
    JournalTemplate journalTemplate=null;
    try {
      journalTemplate=JournalTemplateLocalServiceUtil.getTemplate(themeDisplay.getScopeGroupId(),journalArticle.getTemplateId());
    }
 catch (    NoSuchTemplateException nste) {
      journalTemplate=JournalTemplateLocalServiceUtil.getTemplate(companyGroup.getGroupId(),journalArticle.getTemplateId());
    }
    portletIds=StringUtil.add(portletIds,getRuntimePortletIds(journalTemplate.getXsl()));
  }
  return portletIds;
}
