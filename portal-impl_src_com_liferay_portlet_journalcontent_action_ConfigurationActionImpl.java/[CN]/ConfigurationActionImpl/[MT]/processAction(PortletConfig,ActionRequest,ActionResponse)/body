{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(req,"groupId");
  String articleId=ParamUtil.getString(req,"articleId").toUpperCase();
  String templateId=ParamUtil.getString(req,"templateId").toUpperCase();
  String languageId=LanguageUtil.getLanguageId(req);
  boolean disableCaching=ParamUtil.getBoolean(req,"disableCaching");
  String content=JournalContentUtil.getContent(groupId,articleId,templateId,languageId,themeDisplay,disableCaching);
  boolean showAvailableLocales=ParamUtil.getBoolean(req,"showAvailableLocales");
  boolean enableRatings=ParamUtil.getBoolean(req,"enableRatings");
  boolean enableComments=ParamUtil.getBoolean(req,"enableComments");
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("group-id",String.valueOf(groupId));
  prefs.setValue("article-id",articleId);
  prefs.setValue("template-id",templateId);
  prefs.setValue("disable-caching",String.valueOf(disableCaching));
  prefs.setValue("show-available-locales",String.valueOf(showAvailableLocales));
  prefs.setValue("enable-ratings",String.valueOf(enableRatings));
  prefs.setValue("enable-comments",String.valueOf(enableComments));
  prefs.store();
  updateContentSearch(req,portletResource,articleId);
  res.sendRedirect(ParamUtil.getString(req,"redirect"));
}
