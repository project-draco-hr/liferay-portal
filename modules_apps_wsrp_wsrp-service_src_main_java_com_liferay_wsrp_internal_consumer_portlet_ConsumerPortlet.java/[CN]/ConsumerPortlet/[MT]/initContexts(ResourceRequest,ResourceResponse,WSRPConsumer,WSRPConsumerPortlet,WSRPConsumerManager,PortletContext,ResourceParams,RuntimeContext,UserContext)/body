{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(resourceRequest);
  initContexts(resourceRequest,resourceResponse,wsrpConsumer,wsrpConsumerPortlet,wsrpConsumerManager,resourceParams,portletContext,runtimeContext,userContext);
  String resourceID=resourceRequest.getResourceID();
  resourceParams.setResourceID(resourceID);
  resourceParams.setPortletStateChange(StateChange.cloneBeforeWrite);
  String resourceState=ParamUtil.getString(resourceRequest,"wsrp-resourceState");
  if (Validator.isNotNull(resourceState)) {
    resourceParams.setResourceState(resourceState);
  }
  String resourceCacheability=ParamUtil.getString(resourceRequest,"wsrp-resourceCacheability");
  if (Validator.isNotNull(resourceCacheability)) {
    resourceParams.setResourceState(resourceCacheability);
  }
  String contentType=request.getContentType();
  if (Validator.isNotNull(contentType) && contentType.startsWith(ContentTypes.MULTIPART_FORM_DATA)) {
    processMultipartForm(resourceRequest,resourceResponse,resourceParams);
  }
 else {
    processFormParameters(resourceRequest,resourceResponse,resourceParams);
  }
}
