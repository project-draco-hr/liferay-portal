{
  log(client.getUserId() + " is attempting a sign on");
  String userId=client.getUserId();
  validateUserId(userId);
  Auth auth=_authenticator.authenticate(userId,password);
  auth=checkUserId(auth);
  int access=auth.getAccess();
  if (access == IAuthenticator.NONE) {
    throw new AccessException(ACCESS_DENIED);
  }
 else {
    log(client.getUserId() + " is authenticated. Access = " + access+ (client.getTunneling() ? " (tunneling)" : ""));
  }
  client.setUserId(auth.getUserId());
synchronized (_users) {
    client.setAccessLevel(access);
    _users.put(clientKey(client),client);
    _cumulativeLogins++;
  }
  client.ackSignon(auth.getUserId());
  sendMotd(client);
  _distributedState.signon(getName(),userId);
}
