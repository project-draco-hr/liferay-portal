{
  if (!_hasErrorTemplate) {
    try {
      _processTemplate(_templateResource,writer);
      return true;
    }
 catch (    Exception e) {
      throw new TemplateException("Unable to process FreeMarker template " + _templateResource.getTemplateId(),e);
    }
  }
  try {
    UnsyncStringWriter unsyncStringWriter=new UnsyncStringWriter();
    _processTemplate(_templateResource,unsyncStringWriter);
    StringBundler sb=unsyncStringWriter.getStringBundler();
    sb.writeTo(writer);
    return true;
  }
 catch (  Exception e1) {
    if ((e1 instanceof ParseException) || (e1 instanceof freemarker.template.TemplateException)) {
      put("exception",e1.getMessage());
      if (_templateResource instanceof StringTemplateResource) {
        StringTemplateResource stringTemplateResource=(StringTemplateResource)_templateResource;
        put("script",stringTemplateResource.getContent());
      }
      if (e1 instanceof ParseException) {
        ParseException pe=(ParseException)e1;
        put("column",pe.getColumnNumber());
        put("line",pe.getLineNumber());
      }
      try {
        _processTemplate(_errorTemplateResource,writer);
      }
 catch (      Exception e2) {
        throw new TemplateException("Unable to process FreeMarker template " + _errorTemplateResource.getTemplateId(),e2);
      }
    }
 else {
      throw new TemplateException("Unable to process FreeMarker template " + _templateResource.getTemplateId(),e1);
    }
  }
  return false;
}
