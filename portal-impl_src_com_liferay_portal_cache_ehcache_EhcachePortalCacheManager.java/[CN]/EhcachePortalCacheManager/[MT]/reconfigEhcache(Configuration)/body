{
  Map<String,CacheConfiguration> cacheConfigurations=configuration.getCacheConfigurations();
  for (  CacheConfiguration cacheConfiguration : cacheConfigurations.values()) {
    String portalCacheName=cacheConfiguration.getName();
synchronized (_cacheManager) {
      if (_cacheManager.cacheExists(portalCacheName)) {
        if (_log.isInfoEnabled()) {
          _log.info("Overriding existing cache " + portalCacheName);
        }
        _cacheManager.removeCache(portalCacheName);
      }
      Cache cache=new Cache(cacheConfiguration);
      _cacheManager.addCache(cache);
      PortalCache<K,V> portalCache=portalCaches.get(portalCacheName);
      if (portalCache != null) {
        EhcachePortalCache<K,V> ehcachePortalCache=_getEhcachePortalCache(portalCache);
        if (ehcachePortalCache != null) {
          ehcachePortalCache.reconfigEhcache(cache);
        }
 else {
          _log.error("Unable to reconfig cache with name " + portalCacheName);
        }
      }
    }
  }
}
