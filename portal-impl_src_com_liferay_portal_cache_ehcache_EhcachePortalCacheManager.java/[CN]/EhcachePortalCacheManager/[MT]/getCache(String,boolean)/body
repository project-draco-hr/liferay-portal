{
  Ehcache cache=_cacheManager.getEhcache(name);
  if (cache == null) {
synchronized (_cacheManager) {
      cache=_cacheManager.getEhcache(name);
      if (cache == null) {
        _cacheManager.addCache(name);
        cache=_cacheManager.getEhcache(name);
        cache.setStatisticsEnabled(PropsValues.EHCACHE_STATISTICS_ENABLED);
        if (_log.isInfoEnabled()) {
          _log.info("Cache name " + name + " is using implementation "+ cache.getClass().getName());
        }
      }
    }
  }
  PortalCache portalCache=new EhcachePortalCache(cache);
  portalCache.setDebug(_debug);
  if (PropsValues.TRANSACTIONAL_CACHE_ENABLED && (name.startsWith(FinderCacheImpl.CACHE_NAME) || name.startsWith(EntityCacheImpl.CACHE_NAME))) {
    portalCache=new TransactionalPortalCache(portalCache);
  }
  if (PropsValues.EHCACHE_BLOCKING_CACHE_ALLOWED && blocking) {
    portalCache=new BlockingPortalCache(portalCache);
  }
  return portalCache;
}
