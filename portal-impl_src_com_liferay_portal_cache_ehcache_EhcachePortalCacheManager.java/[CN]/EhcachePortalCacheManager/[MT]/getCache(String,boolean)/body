{
  PortalCache<K,V> portalCache=_portalCaches.get(name);
  if (portalCache == null) {
synchronized (_cacheManager) {
      portalCache=_portalCaches.get(name);
      if (portalCache == null) {
        if (!_cacheManager.cacheExists(name)) {
          _cacheManager.addCache(name);
        }
        Cache cache=_cacheManager.getCache(name);
        portalCache=new EhcachePortalCache<K,V>(this,cache);
        if (PropsValues.TRANSACTIONAL_CACHE_ENABLED && isTransactionalPortalCache(name)) {
          portalCache=new TransactionalPortalCache<K,V>(portalCache);
        }
        if (PropsValues.EHCACHE_BLOCKING_CACHE_ALLOWED && blocking) {
          portalCache=new BlockingPortalCache<K,V>(portalCache);
        }
        _portalCaches.put(name,portalCache);
      }
    }
  }
  return portalCache;
}
