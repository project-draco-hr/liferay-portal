{
  if (size < _MINIMUM_INCREMENT_SIZE) {
    size=_MINIMUM_INCREMENT_SIZE;
  }
  Session session=null;
  try {
    session=openSession();
    Counter counter=null;
    try {
      counter=(Counter)session.load(Counter.class,name);
    }
 catch (    ObjectNotFoundException onfe) {
      counter=new Counter();
      counter.setName(name);
      counter.setCurrentId(_DEFAULT_CURRENT_ID);
      session.save(counter);
      session.flush();
    }
    long currentId=counter.getCurrentId() + size;
    counter.setCurrentId(currentId);
    session.flush();
    return currentId;
  }
 catch (  HibernateException he) {
    he.printStackTrace();
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
