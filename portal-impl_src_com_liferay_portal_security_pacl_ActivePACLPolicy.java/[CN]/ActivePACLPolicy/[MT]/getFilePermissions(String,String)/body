{
  List<Permission> permissions=new CopyOnWriteArrayList<Permission>();
  Properties properties=getProperties();
  String value=properties.getProperty(key);
  String[] paths=StringUtil.split(value);
  if (value.contains("${comma}")) {
    for (int i=0; i < paths.length; i++) {
      paths[i]=StringUtil.replace(paths[i],"${comma}",StringPool.COMMA);
    }
  }
  for (  String path : paths) {
    Permission permission=new FilePermission(path,action);
    permissions.add(permission);
  }
  if (action.equals(_FILE_PERMISSION_READ)) {
    Permission permission=new FilePermission(_rootDir + "-",action);
    permissions.add(permission);
    permission=new FilePermission(System.getProperty("catalina.home") + "/work/Catalina/localhost/" + getServletContextName()+ "/-",action);
    permissions.add(permission);
  }
  return permissions;
}
