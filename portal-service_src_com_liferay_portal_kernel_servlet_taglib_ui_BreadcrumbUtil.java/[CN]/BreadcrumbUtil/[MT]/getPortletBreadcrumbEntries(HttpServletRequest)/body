{
  List<BreadcrumbEntry> portletBreadcrumbEntries=PortalUtil.getPortletBreadcrumbs(request);
  if (portletBreadcrumbEntries == null) {
    return Collections.emptyList();
  }
  List<BreadcrumbEntry> breadcrumbEntries=new ArrayList<BreadcrumbEntry>();
  for (int i=0; i < portletBreadcrumbEntries.size(); i++) {
    BreadcrumbEntry portletBreadcrumbEntry=portletBreadcrumbEntries.get(i);
    BreadcrumbEntry breadcrumbEntry=new BreadcrumbEntry();
    String portletBreadcrumbURL=portletBreadcrumbEntry.getURL();
    boolean isLastEntry=(i == (portletBreadcrumbEntries.size() - 1));
    if (Validator.isNotNull(portletBreadcrumbURL) && !isLastEntry) {
      if (!CookieKeys.hasSessionId(request)) {
        HttpSession session=request.getSession();
        portletBreadcrumbURL=PortalUtil.getURLWithSessionId(portletBreadcrumbURL,session.getId());
      }
      breadcrumbEntry.setURL(portletBreadcrumbURL);
    }
    breadcrumbEntry.setData(portletBreadcrumbEntry.getData());
    breadcrumbEntry.setEntity(portletBreadcrumbEntry.getEntity());
    breadcrumbEntry.setTitle(portletBreadcrumbEntry.getTitle());
    breadcrumbEntries.add(breadcrumbEntry);
  }
  return breadcrumbEntries;
}
