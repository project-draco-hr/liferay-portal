{
  ActionableDynamicQuery actionableDynamicQuery=DLFileEntryLocalServiceUtil.getActionableDynamicQuery();
  actionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod(){
    @Override public void performAction(    Object object){
      DLFileEntry dlFileEntry=(DLFileEntry)object;
      if (dlFileEntry.isInTrash()) {
        return;
      }
      String newTitle=dlFileEntry.getTitle();
      for (      String blacklistChar : PropsValues.DL_CHAR_BLACKLIST) {
        newTitle=newTitle.replace(blacklistChar,StringPool.UNDERLINE);
      }
      if (!dlFileEntry.getTitle().equals(newTitle)) {
        try {
          dlFileEntry=renameTitle(dlFileEntry,newTitle);
        }
 catch (        Exception e) {
          if (_log.isWarnEnabled()) {
            _log.warn("Unable to rename duplicate title for " + "file entry " + dlFileEntry.getFileEntryId(),e);
          }
        }
      }
      if (!DLWebDAVUtil.isRepresentableTitle(dlFileEntry.getTitle())) {
        try {
          dlFileEntry=renameWithRepresentableTitle(dlFileEntry);
        }
 catch (        Exception e) {
          if (_log.isWarnEnabled()) {
            _log.warn("Unable to rename file entry " + dlFileEntry.getFileEntryId() + " with a WebDAV title",e);
          }
        }
      }
      try {
        DLFileEntryLocalServiceUtil.validateFile(dlFileEntry.getGroupId(),dlFileEntry.getFolderId(),dlFileEntry.getFileEntryId(),dlFileEntry.getFileName(),dlFileEntry.getTitle());
      }
 catch (      PortalException pe) {
        if (!(pe instanceof DuplicateFileException) && !(pe instanceof DuplicateFolderNameException)) {
          return;
        }
        try {
          renameDuplicateTitle(dlFileEntry);
        }
 catch (        Exception e) {
          if (_log.isWarnEnabled()) {
            _log.warn("Unable to rename duplicate title for " + "file entry " + dlFileEntry.getFileEntryId(),e);
          }
        }
      }
    }
  }
);
  actionableDynamicQuery.performActions();
}
