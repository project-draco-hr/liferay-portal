{
  PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  String[] assetEntryXmls=portletPreferences.getValues("asset-entry-xml",new String[0]);
  if (ArrayUtil.isNotEmpty(assetEntryXmls)) {
    upgradeUuids(assetEntryXmls);
    portletPreferences.setValues("assetEntryXml",assetEntryXmls);
  }
  String subtypeFieldsFilterEnabled=portletPreferences.getValue("subtypeFieldsFilterEnabled",Boolean.FALSE.toString());
  if (subtypeFieldsFilterEnabled.equals(Boolean.TRUE.toString())) {
    boolean journalFilterByFieldEnable=isFilterByFieldEnable(portletPreferences,_JOURNAL_FILTER_BY_FIELD_ENABLED_KEY);
    boolean dlFilterByFieldEnable=isFilterByFieldEnable(portletPreferences,_DL_FILTER_BY_FIELD_ENABLED_KEY);
    if (journalFilterByFieldEnable) {
      upgradeJournalDateFieldValue(portletPreferences);
    }
 else     if (dlFilterByFieldEnable) {
      upgradeDLDateFieldsValues(portletPreferences);
    }
  }
  return PortletPreferencesFactoryUtil.toXML(portletPreferences);
}
