{
  if (!_outputMerge) {
    File outputFolder=new File(_outputDir,"output");
    if (!_tempDir.renameTo(outputFolder)) {
      FileUtil.copyDirectory(_tempDir,outputFolder);
    }
    return;
  }
  File outputFile=new File(_outputDir,"sample-" + _dbType + ".sql");
  FileOutputStream fileOutputStream=new FileOutputStream(outputFile);
  FileChannel fileChannel=fileOutputStream.getChannel();
  File lastSQLFile=null;
  for (  File tableFile : _tempDir.listFiles()) {
    String fileName=tableFile.getName();
    if (fileName.equals(_endSQLFileName)) {
      lastSQLFile=tableFile;
      continue;
    }
    doMergeSQL(tableFile,fileChannel);
    tableFile.delete();
  }
  if (lastSQLFile != null) {
    doMergeSQL(lastSQLFile,fileChannel);
    lastSQLFile.delete();
  }
  fileChannel.close();
}
