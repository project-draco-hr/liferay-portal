{
  final CharPipe charPipe=new CharPipe(_PIPE_BUFFER_SIZE);
  final Writer writer=createUnsyncBufferedWriter(charPipe.getWriter());
  Thread thread=new Thread(){
    @Override public void run(){
      try {
        Writer writerSampleSQL=new UnsyncTeeWriter(writer,createFileWriter(new File(_outputDir,"sample.sql")));
        Map<String,Object> context=getContext();
        FreeMarkerUtil.process(_SCRIPT,context,writerSampleSQL);
        for (        String fileName : _CSV_FILE_NAMES) {
          Writer writer=(Writer)context.get(fileName + "CSVWriter");
          writer.close();
        }
        writerSampleSQL.close();
        charPipe.close();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
    }
  }
;
  thread.start();
  return charPipe;
}
