{
  _dbType=properties.getProperty("sample.sql.db.type");
  _maxAssetCategoryCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.category.count"));
  _maxAssetEntryToAssetCategoryCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.entry.to.asset.category.count"));
  _maxAssetEntryToAssetTagCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.entry.to.asset.tag.count"));
  _maxAssetPublisherFilterRuleCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.publisher.filter.rule.count"));
  _maxAssetPublisherPageCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.publisher.page.count"));
  _maxAssetTagCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.tag.count"));
  _maxAssetVocabularyCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.asset.vocabulary.count"));
  _maxBlogsEntryCommentCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.blogs.entry.comment.count"));
  _maxBlogsEntryCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.blogs.entry.count"));
  _maxDDLCustomFieldCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.ddl.custom.field.count"));
  _maxDDLRecordCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.ddl.record.count"));
  _maxDDLRecordSetCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.ddl.record.set.count"));
  _maxDLFileEntryCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.dl.file.entry.count"));
  _maxDLFileEntrySize=GetterUtil.getInteger(properties.getProperty("sample.sql.max.dl.file.entry.size"));
  _maxDLFolderCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.dl.folder.count"));
  _maxDLFolderDepth=GetterUtil.getInteger(properties.getProperty("sample.sql.max.dl.folder.depth"));
  _maxGroupCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.group.count"));
  _maxJournalArticleCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.journal.article.count"));
  _maxJournalArticlePageCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.journal.article.page.count"));
  _maxJournalArticleSize=GetterUtil.getInteger(properties.getProperty("sample.sql.max.journal.article.size"));
  _maxJournalArticleVersionCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.journal.article.version.count"));
  _maxMBCategoryCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.mb.category.count"));
  _maxMBMessageCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.mb.message.count"));
  _maxMBThreadCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.mb.thread.count"));
  _maxUserCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.user.count"));
  _maxUserToGroupCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.user.to.group.count"));
  _maxWikiNodeCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.wiki.node.count"));
  _maxWikiPageCommentCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.wiki.page.comment.count"));
  _maxWikiPageCount=GetterUtil.getInteger(properties.getProperty("sample.sql.max.wiki.page.count"));
  _optimizeBufferSize=GetterUtil.getInteger(properties.getProperty("sample.sql.optimize.buffer.size"));
  _outputDir=properties.getProperty("sample.sql.output.dir");
  _outputMerge=GetterUtil.getBoolean(properties.getProperty("sample.sql.output.merge"));
  _dataFactory=new DataFactory(_maxAssetCategoryCount,_maxAssetEntryToAssetCategoryCount,_maxAssetEntryToAssetTagCount,_maxAssetPublisherFilterRuleCount,_maxAssetPublisherPageCount,_maxAssetTagCount,_maxAssetVocabularyCount,_maxBlogsEntryCount,_maxDDLCustomFieldCount,_maxGroupCount,_maxJournalArticleCount,_maxJournalArticleSize,_maxMBCategoryCount,_maxMBThreadCount,_maxMBMessageCount,_maxUserToGroupCount);
  _db=DBFactoryUtil.getDB(_dbType);
  if (_db instanceof MySQLDB) {
    _db=new SampleMySQLDB();
  }
  FileUtil.delete(_outputDir + "/sample-" + _dbType+ ".sql");
  FileUtil.deltree(_outputDir + "/output");
  _tempDir=new File(_outputDir,"temp");
  _tempDir.mkdirs();
  final CharPipe charPipe=new CharPipe(_PIPE_BUFFER_SIZE);
  generateSQL(charPipe);
  try {
    compressSQL(charPipe.getReader());
    mergeSQL();
  }
  finally {
    FileUtil.deltree(_tempDir);
  }
  StringBundler sb=new StringBundler();
  Set<String> propertyNames=properties.stringPropertyNames();
  List<String> keys=new ArrayList<String>(propertyNames);
  Collections.sort(keys);
  for (  String key : keys) {
    if (!key.startsWith("sample.sql")) {
      continue;
    }
    String value=properties.getProperty(key);
    sb.append(key);
    sb.append(StringPool.EQUAL);
    sb.append(value);
    sb.append(StringPool.NEW_LINE);
  }
  FileUtil.write(new File(_outputDir,"benchmarks-actual.properties"),sb.toString());
}
