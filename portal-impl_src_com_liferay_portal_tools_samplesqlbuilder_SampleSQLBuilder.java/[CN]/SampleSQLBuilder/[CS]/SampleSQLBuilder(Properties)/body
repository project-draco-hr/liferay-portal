{
  _dbType=properties.getProperty("sample.sql.db.type");
  _optimizeBufferSize=GetterUtil.getInteger(properties.getProperty("sample.sql.optimize.buffer.size"));
  _outputDir=properties.getProperty("sample.sql.output.dir");
  _outputMerge=GetterUtil.getBoolean(properties.getProperty("sample.sql.output.merge"));
  _dataFactory=new DataFactory(properties);
  _db=DBFactoryUtil.getDB(_dbType);
  if (_db instanceof MySQLDB) {
    _db=new SampleMySQLDB();
  }
  FileUtil.delete(_outputDir + "/sample-" + _dbType+ ".sql");
  FileUtil.deltree(_outputDir + "/output");
  _tempDir=new File(_outputDir,"temp");
  _tempDir.mkdirs();
  final CharPipe charPipe=new CharPipe(_PIPE_BUFFER_SIZE);
  generateSQL(charPipe);
  try {
    compressSQL(charPipe.getReader());
    mergeSQL();
  }
  finally {
    FileUtil.deltree(_tempDir);
  }
  StringBundler sb=new StringBundler();
  for (  String key : properties.stringPropertyNames()) {
    if (!key.startsWith("sample.sql")) {
      continue;
    }
    String value=properties.getProperty(key);
    sb.append(key);
    sb.append(StringPool.EQUAL);
    sb.append(value);
    sb.append(StringPool.NEW_LINE);
  }
  FileUtil.write(new File(_outputDir,"benchmarks-actual.properties"),sb.toString());
}
