{
  try {
    _outputDir=outputDir;
    _dbType=dbType;
    _maxBlogsEntryCommentCount=maxBlogsEntryCommentCount;
    _maxBlogsEntryCount=maxBlogsEntryCount;
    _maxGroupCount=maxGroupCount;
    _maxMBCategoryCount=maxMBCategoryCount;
    _maxMBMessageCount=maxMBMessageCount;
    _maxMBThreadCount=maxMBThreadCount;
    _maxUserCount=maxUserCount;
    _maxUserToGroupCount=maxUserToGroupCount;
    _maxWikiNodeCount=maxWikiNodeCount;
    _maxWikiPageCommentCount=maxWikiPageCommentCount;
    _maxWikiPageCount=maxWikiPageCount;
    _securityEnabled=securityEnabled;
    int totalMThreadCount=maxMBCategoryCount * maxMBThreadCount;
    int totalMBMessageCount=totalMThreadCount * maxMBMessageCount;
    int counterOffset=_maxGroupCount + (_maxGroupCount * (maxMBCategoryCount + totalMThreadCount + totalMBMessageCount)) + 1;
    _counter=new SimpleCounter(counterOffset);
    _permissionCounter=new SimpleCounter();
    _resourceCounter=new SimpleCounter();
    _resourceCodeCounter=new SimpleCounter();
    _userScreenNameIncrementer=new SimpleCounter();
    _dataFactory=new DataFactory(baseDir,_maxGroupCount,_maxUserToGroupCount,_counter,_permissionCounter,_resourceCounter,_resourceCodeCounter);
    _db=DBFactoryUtil.getDB(_dbType);
    _tempDir=new File(_outputDir,"temp");
    _tempDir.mkdirs();
    final CharPipe charPipe=new CharPipe(1024 * 1024 * 10);
    generateSQL(charPipe);
    try {
      compressSQL(charPipe.getReader());
      mergeSQL();
    }
  finally {
      FileUtil.deltree(_tempDir);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
