{
  try {
    _outputDir=outputDir;
    _dbType=dbType;
    _maxBlogsEntryCommentCount=maxBlogsEntryCommentCount;
    _maxBlogsEntryCount=maxBlogsEntryCount;
    _maxGroupCount=maxGroupCount;
    _maxMBCategoryCount=maxMBCategoryCount;
    _maxMBMessageCount=maxMBMessageCount;
    _maxMBThreadCount=maxMBThreadCount;
    _maxUserCount=maxUserCount;
    _maxUserToGroupCount=maxUserToGroupCount;
    _maxWikiNodeCount=maxWikiNodeCount;
    _maxWikiPageCommentCount=maxWikiPageCommentCount;
    _maxWikiPageCount=maxWikiPageCount;
    _securityEnabled=securityEnabled;
    int totalMThreadCount=maxMBCategoryCount * maxMBThreadCount;
    int totalMBMessageCount=totalMThreadCount * maxMBMessageCount;
    int counterOffset=_maxGroupCount + (_maxGroupCount * (maxMBCategoryCount + totalMThreadCount + totalMBMessageCount)) + 1;
    _counter=new SimpleCounter(counterOffset);
    _permissionCounter=new SimpleCounter();
    _resourceCounter=new SimpleCounter();
    _resourceCodeCounter=new SimpleCounter();
    _userScreenNameIncrementer=new SimpleCounter();
    _dataFactory=new DataFactory(baseDir,_maxGroupCount,_maxUserToGroupCount,_counter,_permissionCounter,_resourceCounter,_resourceCodeCounter);
    _writerGeneric=new FileWriter(_outputDir + "/sample.sql");
    createSample();
    _writerGeneric.flush();
    _writerSpecific=new FileWriter(_outputDir + "/sample-" + dbType+ ".sql");
    DB specificDB=DBFactoryUtil.getDB(_dbType);
    boolean previousBlankLine=false;
    UnsyncBufferedReader unsyncBufferedReader=new UnsyncBufferedReader(new FileReader(_outputDir + "/sample.sql"));
    String s=null;
    while ((s=unsyncBufferedReader.readLine()) != null) {
      s=specificDB.buildSQL(s).trim();
      _writerSpecific.write(s);
      if (previousBlankLine && Validator.isNull(s)) {
      }
 else {
        _writerSpecific.write(StringPool.NEW_LINE);
      }
      if (Validator.isNull(s)) {
        previousBlankLine=true;
      }
    }
    unsyncBufferedReader.close();
    _writerSpecific.flush();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
