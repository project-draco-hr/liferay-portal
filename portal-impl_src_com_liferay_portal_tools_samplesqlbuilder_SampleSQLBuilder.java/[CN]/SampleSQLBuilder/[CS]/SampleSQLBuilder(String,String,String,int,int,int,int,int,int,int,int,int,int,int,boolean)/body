{
  try {
    _outputDir=outputDir;
    _dbType=dbType;
    _maxBlogsEntryCommentCount=maxBlogsEntryCommentCount;
    _maxBlogsEntryCount=maxBlogsEntryCount;
    _maxGroupCount=maxGroupCount;
    _maxMBCategoryCount=maxMBCategoryCount;
    _maxMBMessageCount=maxMBMessageCount;
    _maxMBThreadCount=maxMBThreadCount;
    _maxUserCount=maxUserCount;
    _maxUserToGroupCount=maxUserToGroupCount;
    _maxWikiNodeCount=maxWikiNodeCount;
    _maxWikiPageCommentCount=maxWikiPageCommentCount;
    _maxWikiPageCount=maxWikiPageCount;
    _securityEnabled=securityEnabled;
    int totalMThreadCount=maxMBCategoryCount * maxMBThreadCount;
    int totalMBMessageCount=totalMThreadCount * maxMBMessageCount;
    int counterOffset=_maxGroupCount + (_maxGroupCount * (maxMBCategoryCount + totalMThreadCount + totalMBMessageCount)) + 1;
    _counter=new SimpleCounter(counterOffset);
    _permissionCounter=new SimpleCounter();
    _resourceCounter=new SimpleCounter();
    _resourceCodeCounter=new SimpleCounter();
    _userScreenNameIncrementer=new SimpleCounter();
    _dataFactory=new DataFactory(baseDir,_maxGroupCount,_maxUserToGroupCount,_counter,_permissionCounter,_resourceCounter,_resourceCodeCounter);
    _db=DBFactoryUtil.getDB(_dbType);
    _tempDir=new File(_outputDir,"temp");
    _tempDir.mkdirs();
    final CharPipe charPipe=new CharPipe(1024 * 1024 * 10);
    generateSQL(charPipe);
    try {
      compressSQL(charPipe.getReader());
      mergeSQL();
    }
  finally {
      FileUtil.deltree(_tempDir);
    }
    StringBundler dataSetInfo=new StringBundler(12);
    dataSetInfo.append("user.count=");
    dataSetInfo.append(_maxUserCount);
    dataSetInfo.append("\nblogs.count=");
    dataSetInfo.append(_maxBlogsEntryCount);
    dataSetInfo.append("\nmessageboards.category.count=");
    dataSetInfo.append(_maxMBCategoryCount);
    dataSetInfo.append("\nmessageboards.thread.count=");
    dataSetInfo.append(_maxMBThreadCount);
    dataSetInfo.append("\nwiki.node.count=");
    dataSetInfo.append(_maxWikiNodeCount);
    dataSetInfo.append("\nwiki.page.count=");
    dataSetInfo.append(_maxWikiPageCount);
    Writer dataSetInfoWriter=new FileWriter("dataset_info.properties");
    dataSetInfo.writeTo(dataSetInfoWriter);
    dataSetInfoWriter.close();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
