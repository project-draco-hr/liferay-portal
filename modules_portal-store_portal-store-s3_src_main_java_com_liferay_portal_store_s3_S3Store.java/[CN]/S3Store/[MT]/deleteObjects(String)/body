{
  try {
    String[] keys=new String[_DELETE_MAX];
    List<S3ObjectSummary> s3ObjectSummaries=getS3ObjectSummaries(prefix);
    Iterator<S3ObjectSummary> iterator=s3ObjectSummaries.iterator();
    while (iterator.hasNext()) {
      DeleteObjectsRequest deleteObjectsRequest=new DeleteObjectsRequest(_bucketName);
      for (int i=0; i < keys.length; i++) {
        if (iterator.hasNext()) {
          S3ObjectSummary s3ObjectSummary=iterator.next();
          keys[i]=s3ObjectSummary.getKey();
        }
 else {
          keys=Arrays.copyOfRange(keys,0,i);
          break;
        }
      }
      deleteObjectsRequest.withKeys(keys);
      _amazonS3.deleteObjects(deleteObjectsRequest);
    }
  }
 catch (  AmazonClientException amazonClientException) {
    throw transform(amazonClientException);
  }
}
