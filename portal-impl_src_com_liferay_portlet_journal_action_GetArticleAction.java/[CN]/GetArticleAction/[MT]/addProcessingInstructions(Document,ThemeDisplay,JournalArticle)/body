{
  Theme theme=themeDisplay.getTheme();
  StringBuilder sb=new StringBuilder();
  sb.append(themeDisplay.getCDNHost());
  sb.append(themeDisplay.getPathContext());
  sb.append("/html/portal/css.jsp?themeId=");
  sb.append(themeDisplay.getThemeId());
  sb.append("&colorSchemeId=");
  sb.append(themeDisplay.getColorSchemeId());
  sb.append("&t=");
  sb.append(theme.getTimestamp());
  if (themeDisplay.isThemeCssFastLoad()) {
    sb.append("&minifierType=css");
  }
  String url=sb.toString();
  Map<String,String> arguments=new LinkedHashMap<String,String>();
  arguments.put("type","text/css");
  arguments.put("href",url);
  arguments.put("title","portal css");
  arguments.put("alternate","yes");
  addStyleSheet(doc,url,arguments);
  sb=new StringBuilder();
  sb.append(themeDisplay.getPathThemeCss());
  sb.append("/main.css?t=");
  sb.append(theme.getTimestamp());
  if (themeDisplay.isThemeCssFastLoad()) {
    sb.append("&minifierType=css");
  }
  url=sb.toString();
  arguments.clear();
  arguments.put("type","text/css");
  arguments.put("href",url);
  arguments.put("title","theme css");
  addStyleSheet(doc,url,arguments);
  String templateId=article.getTemplateId();
  if (Validator.isNotNull(templateId)) {
    JournalTemplate template=null;
    try {
      template=JournalTemplateLocalServiceUtil.getTemplate(article.getGroupId(),templateId);
      if (Validator.equals(template.getLangType(),JournalTemplateImpl.LANG_TYPE_XSL)) {
        url=themeDisplay.getPathMain() + "/journal/get_template?groupId=" + article.getGroupId()+ "&templateId="+ templateId;
        arguments.clear();
        arguments.put("type","text/xsl");
        arguments.put("href",url);
        arguments.put("title","xsl");
        addStyleSheet(doc,url,arguments);
      }
    }
 catch (    Exception e) {
    }
  }
}
