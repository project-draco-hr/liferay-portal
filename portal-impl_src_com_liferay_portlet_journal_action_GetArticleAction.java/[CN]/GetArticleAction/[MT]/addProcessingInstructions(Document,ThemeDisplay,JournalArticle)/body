{
  String url=themeDisplay.getPathThemeCss() + "/main.css?companyId=" + themeDisplay.getCompanyId()+ "&themeId="+ themeDisplay.getThemeId()+ "&colorSchemeId="+ themeDisplay.getColorSchemeId();
  Map<String,String> arguments=new LinkedHashMap<String,String>();
  arguments.put("type","text/css");
  arguments.put("href",url);
  arguments.put("title","theme css");
  addStyleSheet(doc,url,arguments);
  url=themeDisplay.getPathMain() + "/portal/css_cached?themeId=" + themeDisplay.getThemeId()+ "&colorSchemeId="+ themeDisplay.getColorSchemeId();
  arguments.clear();
  arguments.put("type","text/css");
  arguments.put("href",url);
  arguments.put("title","cached css");
  arguments.put("alternate","yes");
  addStyleSheet(doc,url,arguments);
  String templateId=article.getTemplateId();
  if (Validator.isNotNull(templateId)) {
    JournalTemplate template=null;
    try {
      template=JournalTemplateLocalServiceUtil.getTemplate(article.getGroupId(),templateId);
      if (Validator.equals(template.getLangType(),JournalTemplateImpl.LANG_TYPE_XSL)) {
        url=themeDisplay.getPathMain() + "/journal/get_template?groupId=" + article.getGroupId()+ "&templateId="+ templateId;
        arguments.clear();
        arguments.put("type","text/xsl");
        arguments.put("href",url);
        arguments.put("title","xsl");
        addStyleSheet(doc,url,arguments);
      }
    }
 catch (    Exception e) {
    }
  }
}
