{
  Group group=groupLocalService.getGroup(groupId);
  InternetAddress from=new InternetAddress(email,fullName);
  String body=ContentUtil.get(PrefsPropsUtil.getString(companyId,PropsKeys.COMMUNITIES_MEMBERSHIP_INVITATION_EMAIL_BODY));
  String subject=ContentUtil.get(PrefsPropsUtil.getString(companyId,PropsKeys.COMMUNITIES_MEMBERSHIP_INVITATION_EMAIL_SUBJECT));
  body=StringUtil.replace(body,new String[]{"[$COMMUNITY_NAME$]","[$PORTAL_URL$]","[$SENDER_EMAIL_ADDRESS$]","[$SENDER_FULL_NAME$]"},new String[]{group.getName(),url,email,fullName});
  MailMessage mailMessage=new MailMessage(from,subject,body,true);
  try {
    InternetAddress to=new InternetAddress(email);
    mailMessage.setTo(to);
    mailService.sendEmail(mailMessage);
  }
 catch (  AddressException ae) {
    if (_log.isWarnEnabled()) {
      _log.warn("Invalid email address " + email);
    }
  }
}
