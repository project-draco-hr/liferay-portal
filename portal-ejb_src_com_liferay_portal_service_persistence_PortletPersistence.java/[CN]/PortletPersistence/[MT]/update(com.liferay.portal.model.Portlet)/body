{
  Session session=null;
  try {
    if (portlet.isNew() || portlet.isModified()) {
      session=openSession();
      if (portlet.isNew()) {
        PortletHBM portletHBM=new PortletHBM();
        portletHBM.setPortletId(portlet.getPortletId());
        portletHBM.setCompanyId(portlet.getCompanyId());
        portletHBM.setNarrow(portlet.getNarrow());
        portletHBM.setRoles(portlet.getRoles());
        portletHBM.setActive(portlet.getActive());
        session.save(portletHBM);
        session.flush();
      }
 else {
        PortletHBM portletHBM=(PortletHBM)session.get(PortletHBM.class,portlet.getPrimaryKey());
        if (portletHBM != null) {
          portletHBM.setNarrow(portlet.getNarrow());
          portletHBM.setRoles(portlet.getRoles());
          portletHBM.setActive(portlet.getActive());
          session.flush();
        }
 else {
          portletHBM=new PortletHBM();
          portletHBM.setPortletId(portlet.getPortletId());
          portletHBM.setCompanyId(portlet.getCompanyId());
          portletHBM.setNarrow(portlet.getNarrow());
          portletHBM.setRoles(portlet.getRoles());
          portletHBM.setActive(portlet.getActive());
          session.save(portletHBM);
          session.flush();
        }
      }
      portlet.setNew(false);
      portlet.setModified(false);
    }
    return portlet;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
