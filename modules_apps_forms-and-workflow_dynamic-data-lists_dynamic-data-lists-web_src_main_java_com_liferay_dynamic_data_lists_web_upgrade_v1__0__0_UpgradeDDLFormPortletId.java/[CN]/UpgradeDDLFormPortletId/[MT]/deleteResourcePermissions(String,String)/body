{
  DynamicQuery resourcePermissionQuery=_resourcePermissionLocalService.dynamicQuery();
  Property companyIdProperty=PropertyFactoryUtil.forName("companyId");
  Property nameProperty=PropertyFactoryUtil.forName("name");
  Property roleIdProperty=PropertyFactoryUtil.forName("roleId");
  Property scopeProperty=PropertyFactoryUtil.forName("scope");
  Criterion newNameCriterion=nameProperty.eq(new String(newRootPortletId));
  Criterion oldNameCriterion=nameProperty.eq(new String(oldRootPortletId));
  resourcePermissionQuery=resourcePermissionQuery.add(oldNameCriterion);
  List<ResourcePermission> resourcePermissions=_resourcePermissionLocalService.dynamicQuery(resourcePermissionQuery);
  for (  ResourcePermission resourcePermission : resourcePermissions) {
    long total=hasResourcePermission(resourcePermission.getCompanyId(),resourcePermission.getRoleId(),resourcePermission.getScope(),companyIdProperty,roleIdProperty,scopeProperty,newNameCriterion);
    if (total > 0) {
      _resourcePermissionLocalService.deleteResourcePermission(resourcePermission);
    }
  }
}
