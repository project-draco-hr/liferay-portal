{
  Map map=CollectionFactory.getSyncHashMap();
  HttpSession ses=req.getSession();
  for (int i=0; i < SHARED_SESSION_ATTRIBUTES.length; i++) {
    String attrName=SHARED_SESSION_ATTRIBUTES[i];
    Object attrValue=ses.getAttribute(attrName);
    if (attrValue != null) {
      map.put(attrName,attrValue);
    }
  }
  Enumeration enu=ses.getAttributeNames();
  while (enu.hasMoreElements()) {
    String attrName=(String)enu.nextElement();
    Object attrValue=ses.getAttribute(attrName);
    if (attrValue != null) {
      for (int i=0; i < CUSTOM_SHARED_SESSION_ATTRIBUTES.length; i++) {
        if (attrName.startsWith(CUSTOM_SHARED_SESSION_ATTRIBUTES[i])) {
          map.put(attrName,attrValue);
          break;
        }
      }
    }
  }
  return map;
}
