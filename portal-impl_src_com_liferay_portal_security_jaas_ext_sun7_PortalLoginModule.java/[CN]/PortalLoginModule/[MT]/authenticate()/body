{
  if (!(_currentRealm instanceof PortalRealm)) {
    throw new LoginException(PortalRealm.class.getName());
  }
  long userId=GetterUtil.getLong(_username);
  String[] groups=_getGroups(userId,_password);
  if (groups == null) {
    throw new LoginException(_username);
  }
  PortalRealm portalRealm=(PortalRealm)_currentRealm;
  portalRealm.setGroupNames(_username,groups);
  return commitAuthentication(_username,_password,_currentRealm,groups);
}
