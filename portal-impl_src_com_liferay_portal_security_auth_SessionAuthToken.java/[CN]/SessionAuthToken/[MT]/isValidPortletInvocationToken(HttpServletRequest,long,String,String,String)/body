{
  long companyId=PortalUtil.getCompanyId(request);
  if (AuthTokenWhitelistUtil.isPortletInvocationWhitelisted(companyId,portletId,strutsAction)) {
    return true;
  }
  if (Validator.isNotNull(tokenValue)) {
    String key=PortletPermissionUtil.getPrimaryKey(plid,portletId);
    String sessionToken=getSessionAuthenticationToken(request,key,false);
    if (Validator.isNotNull(sessionToken) && sessionToken.equals(tokenValue)) {
      return true;
    }
  }
  return false;
}
