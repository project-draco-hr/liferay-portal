{
  if (isIgnoreAction(request)) {
    return;
  }
  String requestAuthenticationToken=ParamUtil.getString(request,"p_auth");
  String sessionAuthenticationToken=getSessionAuthenticationToken(request,_PORTAL);
  if (!requestAuthenticationToken.equals(sessionAuthenticationToken)) {
    throw new PrincipalException("Invalid authentication token");
  }
}
