{
  HttpSession session=request.getSession();
  String authenticationToken=(String)session.getAttribute(WebKeys.AUTHENTICATION_TOKEN);
  if (!authenticationToken.equals(ParamUtil.getString(request,Constants.AUTHENTICATION_TOKEN))) {
    String strutsAction=ParamUtil.getString(request,"struts_action");
    if (_log.isWarnEnabled()) {
      _log.warn("Authentication token does not validate for action: " + strutsAction);
    }
    throw new PrincipalException();
  }
}
