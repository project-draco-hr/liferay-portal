{
  HttpServletRequest originalHttpRequest=PortalUtil.getOriginalServletRequest(request);
  HttpSession session=originalHttpRequest.getSession();
  String tokenKey=WebKeys.AUTHENTICATION_TOKEN.concat(key);
  String sessionAuthenticationToken=(String)session.getAttribute(tokenKey);
  if (createToken && Validator.isNull(sessionAuthenticationToken)) {
    sessionAuthenticationToken=PwdGenerator.getPassword(PropsValues.AUTH_TOKEN_LENGTH);
    session.setAttribute(tokenKey,sessionAuthenticationToken);
  }
  return sessionAuthenticationToken;
}
