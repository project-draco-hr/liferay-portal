{
  String[][] classNames=getClassNames();
  String[][] resourceNames=getResourceNames();
  List<Future<Void>> futures=new ArrayList<>((classNames.length * 5) + (resourceNames.length * 3));
  try {
    upgradeTable(futures,"Counter","name",classNames,WildcardMode.SURROUND);
    upgradeTable(futures,"ClassName_","value",classNames,WildcardMode.SURROUND);
    upgradeTable(futures,"ResourceAction","name",classNames,WildcardMode.SURROUND);
    upgradeTable(futures,"ResourceBlock","name",classNames,WildcardMode.SURROUND);
    upgradeTable(futures,"ResourcePermission","name",classNames,WildcardMode.SURROUND);
    upgradeTable(futures,"ResourceAction","name",resourceNames,WildcardMode.LEADING);
    upgradeTable(futures,"ResourceBlock","name",resourceNames,WildcardMode.LEADING);
    upgradeTable(futures,"ResourcePermission","name",resourceNames,WildcardMode.LEADING);
    for (    Future<Void> future : futures) {
      future.get();
    }
  }
 catch (  Exception e) {
    throw new UpgradeException(e);
  }
}
