{
  XMLSecurityTest xmlInputFactoryTest=new XMLSecurityTest(){
    @Override public void run(    String xml) throws Exception {
      XMLEventReader xmlEventReader=_secureXMLFactoryProvider.newXMLInputFactory().createXMLEventReader(new StringReader(xml));
      while (xmlEventReader.hasNext()) {
        xmlEventReader.next();
      }
    }
  }
;
  runXMLSecurityTest(xmlInputFactoryTest,_xmlBombBillionLaughsXML,OutOfMemoryError.class,"Billion Laughs XML attack does not work.",null,"Vulnerable to Billion Laughs XML attack.");
  runXMLSecurityTest(xmlInputFactoryTest,_xmlBombQuadraticBlowupXML,OutOfMemoryError.class,"Quadratic Blowup XML attack does not work.",null,"Vulnerable to Quadratic Blowup XML attack.");
  runXMLSecurityTest(xmlInputFactoryTest,_xxeGeneralEntitiesXML1,ConnectException.class,"General Entities XXE attack using SYSTEM entity does not work.",null,"Vulnerable to General Entities XXE attack using SYSTEM entity.");
  runXMLSecurityTest(xmlInputFactoryTest,_xxeGeneralEntitiesXML2,ConnectException.class,"General Entities XXE attack using PUBLIC entity does not work.",null,"Vulnerable to  General Entities XXE attack using PUBLIC entity.");
  runXMLSecurityTest(xmlInputFactoryTest,_xxeParameterEntitiesXML1,ConnectException.class,"Parameter Entities XXE using SYSTEM entity does not work.",null,"Vulnerable to Parameter Entities XXE using SYSTEM entity.");
  runXMLSecurityTest(xmlInputFactoryTest,_xxeParameterEntitiesXML2,ConnectException.class,"Parameter Entities XXE attack using PUBLIC entity does not work.",null,"Vulnerable to Parameter Entities XXE attack using PUBLIC entity.");
}
