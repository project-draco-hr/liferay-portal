{
  XMLSecurityTest documentBuilderTestCase=new XMLSecurityTest(){
    @Override public void run(    String xml) throws Exception {
      DocumentBuilderFactory documentBuilderFactory=_secureXMLFactoryProvider.newDocumentBuilderFactory();
      DocumentBuilder documentBuilder=documentBuilderFactory.newDocumentBuilder();
      documentBuilder.parse(new ByteArrayInputStream(xml.getBytes()));
    }
  }
;
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xmlBombBillionLaughsXML,OutOfMemoryError.class,"Billion Laughs XML attack doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xmlBombBillionLaughsXML,SAXParseException.class,"Vulnerable to Billion Laughs XML attack!");
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xmlBombQuadraticBlowupXML,OutOfMemoryError.class,"Quadratic Blowup XML attack doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xmlBombQuadraticBlowupXML,SAXParseException.class,"Vulnerable to Quadratic Blowup XML attack!");
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeGeneralEntitiesXML,ConnectException.class,"General Entities XXE attack using SYSTEM entity doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeGeneralEntitiesXML,SAXParseException.class,"Vulnerable to General Entities XXE attack using SYSTEM entity!");
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeGeneralEntitiesXML2,ConnectException.class,"General Entities XXE attack using PUBLIC entity doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeGeneralEntitiesXML2,SAXParseException.class,"Vulnerable to General Entities XXE attack using PUBLIC entity!");
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeParameterEntitiesXML,ConnectException.class,"Parameter Entities XXE using SYSTEM entity doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeParameterEntitiesXML,SAXParseException.class,"Vulnerable to Parameter Entities XXE using SYSTEM entity!");
  disableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeParameterEntitiesXML2,ConnectException.class,"Parameter Entities XXE attack using PUBLIC entity doesn't work!");
  enableXMLSecurity();
  runXMLSecurityTest(documentBuilderTestCase,_xxeParameterEntitiesXML2,SAXParseException.class,"Vulnerable to Parameter Entities XXE attack using PUBLIC entity!");
}
