{
  Iterator itr=PortletPreferencesLocalServiceUtil.getPortletPreferencesByPortletId("56_INSTANCE_%").iterator();
  while (itr.hasNext()) {
    PortletPreferences prefs=(PortletPreferences)itr.next();
    Layout layout=LayoutLocalServiceUtil.getLayout(prefs.getLayoutId(),prefs.getOwnerId());
    javax.portlet.PortletPreferences javaPrefs=PortletPreferencesSerializer.fromDefaultXML(prefs.getPreferences());
    long groupId=GetterUtil.getLong(javaPrefs.getValue("group-id",StringPool.BLANK));
    String[] articleIds=javaPrefs.getValues("article-id",new String[0]);
    if ((groupId <= 0) && (articleIds != null) && (articleIds.length > 0)) {
      String articleId=articleIds[0];
      groupId=_findGroupId(_FIND_JOURNAL_ARTICLE_GROUP,layout.getCompanyId(),articleId);
      if (groupId > 0) {
        _log.info("Upgrading portlet preferences " + prefs.getPrimaryKey());
        javaPrefs.setValue("group-id",String.valueOf(groupId));
        PortletPreferencesLocalServiceUtil.updatePreferences(prefs.getPrimaryKey(),javaPrefs);
      }
 else {
        _log.warn("No group id found for joural content with portlet " + "id " + prefs.getPortletId() + " and article id "+ articleId);
      }
    }
  }
}
