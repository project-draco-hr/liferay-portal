{
  structureKey=structureKey.trim().toUpperCase();
  DDMStructure structure=ddmStructurePersistence.fetchByG_S(groupId,structureKey);
  if (structure != null) {
    return structure;
  }
  if (!includeGlobalStructures) {
    throw new NoSuchStructureException("No JournalStructure exists with the structure key " + structureKey);
  }
  Group group=groupPersistence.findByPrimaryKey(groupId);
  Group companyGroup=groupLocalService.getCompanyGroup(group.getCompanyId());
  return ddmStructurePersistence.findByG_S(companyGroup.getGroupId(),structureKey);
}
