{
  List<DDMTemplate> templates=ddmTemplateLocalService.getTemplates(structure.getStructureId(),DDMTemplateConstants.TEMPLATE_TYPE_DETAIL);
  try {
    for (    DDMTemplate template : templates) {
      String script=template.getScript();
      Document templateDoc=SAXReaderUtil.read(script);
      Element templateRootElement=templateDoc.getRootElement();
      syncStructureTemplatesFields(template,templateRootElement);
      appendNewStructureRequiredFields(structure,templateDoc);
      try {
        script=DDMXMLUtil.formatXML(templateDoc.asXML());
      }
 catch (      Exception e) {
        throw new StructureXsdException();
      }
      template.setScript(script);
      ddmTemplatePersistence.update(template,false);
    }
  }
 catch (  DocumentException e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e,e);
    }
  }
}
