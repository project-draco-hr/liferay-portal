{
  List<DDMTemplate> templates=ddmTemplateLocalService.getTemplates(structure.getStructureId(),DDMTemplateConstants.TEMPLATE_TYPE_DETAIL);
  for (  DDMTemplate template : templates) {
    String script=template.getScript();
    Document templateDocument=null;
    try {
      templateDocument=SAXReaderUtil.read(script);
    }
 catch (    DocumentException de) {
      if (_log.isWarnEnabled()) {
        _log.warn(de,de);
      }
      continue;
    }
    Element templateRootElement=templateDocument.getRootElement();
    syncStructureTemplatesFields(template,templateRootElement);
    appendNewStructureRequiredFields(structure,templateDocument);
    try {
      script=DDMXMLUtil.formatXML(templateDocument.asXML());
    }
 catch (    Exception e) {
      throw new StructureXsdException();
    }
    template.setScript(script);
    ddmTemplatePersistence.update(template,false);
  }
}
