{
  structureKey=format(structureKey);
  DDMStructure structure=ddmStructurePersistence.fetchByG_C_S(groupId,classNameId,structureKey);
  if (structure != null) {
    return structure;
  }
  if (!includeGlobalStructures) {
    throw new NoSuchStructureException("No DDMStructure exists with the structure key " + structureKey);
  }
  Group group=groupPersistence.findByPrimaryKey(groupId);
  Group companyGroup=groupLocalService.getCompanyGroup(group.getCompanyId());
  return ddmStructurePersistence.findByG_C_S(companyGroup.getGroupId(),classNameId,structureKey);
}
