{
  try {
    String xsd=structure.getXsd();
    Document structureDoc=SAXReaderUtil.read(xsd);
    Element templateElement=templateDoc.getRootElement();
    XPath structureXPathSelector=SAXReaderUtil.createXPath("//dynamic-element" + "[.//meta-data/entry[@name=\"required\"]=\"true\"]");
    List<Node> nodes=structureXPathSelector.selectNodes(structureDoc);
    Iterator<Node> itr=nodes.iterator();
    while (itr.hasNext()) {
      Element element=(Element)itr.next();
      String name=element.attributeValue("name");
      StringBundler sb=new StringBundler(3);
      sb.append("//dynamic-element[@name=\"");
      sb.append(name);
      sb.append("\"]");
      XPath templateXPathSelector=SAXReaderUtil.createXPath(sb.toString());
      if (!templateXPathSelector.booleanValueOf(templateDoc)) {
        templateElement.add(element.createCopy());
      }
    }
  }
 catch (  DocumentException e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e,e);
    }
  }
}
