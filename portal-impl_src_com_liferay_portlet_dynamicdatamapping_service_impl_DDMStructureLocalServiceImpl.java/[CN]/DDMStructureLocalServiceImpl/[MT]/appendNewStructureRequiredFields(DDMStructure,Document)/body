{
  String definition=structure.getDefinition();
  Document structureDocument=null;
  try {
    structureDocument=SAXReaderUtil.read(definition);
  }
 catch (  DocumentException de) {
    if (_log.isWarnEnabled()) {
      _log.warn(de,de);
    }
    return;
  }
  Element templateElement=templateDocument.getRootElement();
  XPath structureXPath=SAXReaderUtil.createXPath("//dynamic-element[.//meta-data/entry[@name=\"required\"]=" + "\"true\"]");
  List<Node> nodes=structureXPath.selectNodes(structureDocument);
  for (  Node node : nodes) {
    Element element=(Element)node;
    String name=element.attributeValue("name");
    name=HtmlUtil.escapeXPathAttribute(name);
    XPath templateXPath=SAXReaderUtil.createXPath("//dynamic-element[@name=" + name + "]");
    if (!templateXPath.booleanValueOf(templateDocument)) {
      templateElement.add(element.createCopy());
    }
  }
}
