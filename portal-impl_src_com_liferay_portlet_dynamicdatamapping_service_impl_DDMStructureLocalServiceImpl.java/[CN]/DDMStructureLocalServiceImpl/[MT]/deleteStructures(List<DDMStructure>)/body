{
  Set<Long> deletedStructureIds=new HashSet<Long>();
  for (  DDMStructure structure : structures) {
    if (deletedStructureIds.contains(structure.getStructureId())) {
      continue;
    }
    if (!GroupThreadLocal.isDeleteInProcess()) {
      List<DDMStructure> childrenDDMStructures=ddmStructurePersistence.findByParentStructureId(structure.getStructureId());
      deletedStructureIds.addAll(deleteStructures(childrenDDMStructures));
    }
    ddmStructureLocalService.deleteStructure(structure);
    deletedStructureIds.add(structure.getStructureId());
  }
  return deletedStructureIds;
}
