{
  boolean remoteAccess=AccessControlThreadLocal.isRemoteAccess();
  try {
    AccessControlThreadLocal.setRemoteAccess(true);
    if (_pluginClassLoader == ClassLoaderUtil.getPortalClassLoader()) {
      super.service(request,response);
    }
 else {
      ClassLoader contextClassLoader=ClassLoaderUtil.getContextClassLoader();
      try {
        ClassLoaderUtil.setContextClassLoader(_pluginClassLoader);
        super.service(request,response);
      }
  finally {
        ClassLoaderUtil.setContextClassLoader(contextClassLoader);
      }
    }
  }
 catch (  IOException ioe) {
    throw ioe;
  }
catch (  ServletException se) {
    throw se;
  }
catch (  Exception e) {
    throw new ServletException(e);
  }
 finally {
    AccessControlThreadLocal.setRemoteAccess(remoteAccess);
  }
}
