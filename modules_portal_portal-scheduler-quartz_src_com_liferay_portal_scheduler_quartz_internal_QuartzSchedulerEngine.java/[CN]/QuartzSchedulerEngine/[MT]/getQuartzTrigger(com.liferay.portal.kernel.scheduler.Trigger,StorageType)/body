{
  if (trigger == null) {
    return null;
  }
  Date endDate=trigger.getEndDate();
  String jobName=fixMaxLength(trigger.getJobName(),_jobNameMaxLength,storageType);
  String groupName=fixMaxLength(trigger.getGroupName(),_groupNameMaxLength,storageType);
  Date startDate=trigger.getStartDate();
  if (startDate == null) {
    startDate=new Date(System.currentTimeMillis());
  }
  Trigger quartzTrigger=null;
  TriggerType triggerType=trigger.getTriggerType();
  if (triggerType.equals(TriggerType.CRON)) {
    TriggerBuilder<Trigger> triggerBuilder=TriggerBuilder.newTrigger();
    triggerBuilder.endAt(endDate);
    triggerBuilder.forJob(jobName,groupName);
    triggerBuilder.startAt(startDate);
    triggerBuilder.withIdentity(jobName,groupName);
    CronScheduleBuilder cronScheduleBuilder=CronScheduleBuilder.cronSchedule((String)trigger.getTriggerContent());
    triggerBuilder.withSchedule(cronScheduleBuilder);
    quartzTrigger=triggerBuilder.build();
  }
 else   if (triggerType.equals(TriggerType.SIMPLE)) {
    long interval=(Long)trigger.getTriggerContent();
    if (interval <= 0) {
      if (_log.isWarnEnabled()) {
        _log.warn("Not scheduling " + trigger.getJobName() + " because interval is less than or equal to 0");
      }
      return null;
    }
    TriggerBuilder<Trigger> triggerBuilder=TriggerBuilder.newTrigger();
    triggerBuilder.endAt(endDate);
    triggerBuilder.forJob(jobName,groupName);
    triggerBuilder.startAt(startDate);
    triggerBuilder.withIdentity(jobName,groupName);
    SimpleScheduleBuilder simpleScheduleBuilder=SimpleScheduleBuilder.simpleSchedule();
    simpleScheduleBuilder.withIntervalInMilliseconds(interval);
    simpleScheduleBuilder.withRepeatCount(SimpleTrigger.REPEAT_INDEFINITELY);
    triggerBuilder.withSchedule(simpleScheduleBuilder);
    quartzTrigger=triggerBuilder.build();
  }
 else {
    throw new SchedulerException("Unknown trigger type " + trigger.getTriggerType());
  }
  return quartzTrigger;
}
