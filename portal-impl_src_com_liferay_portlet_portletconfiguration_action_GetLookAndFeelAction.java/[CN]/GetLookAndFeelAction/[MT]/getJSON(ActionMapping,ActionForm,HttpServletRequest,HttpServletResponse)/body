{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  String portletId=ParamUtil.getString(req,"portletId");
  if (!PortletPermission.contains(permissionChecker,themeDisplay.getPlid(),portletId,ActionKeys.CONFIGURATION)) {
    return null;
  }
  PortletPreferences portletSetup=PortletPreferencesFactory.getPortletSetup(layout,portletId);
  String css=portletSetup.getValue("portlet-setup-css",StringPool.BLANK);
  try {
    if (Validator.isNotNull(css)) {
      if (_log.isDebugEnabled()) {
        _log.debug("Getting css " + css);
      }
      JSONObject jsonObj=new JSONObject(css);
      return jsonObj.toString();
    }
  }
 catch (  ParseException pe) {
    if (_log.isWarnEnabled()) {
      _log.warn(pe);
    }
  }
  return null;
}
