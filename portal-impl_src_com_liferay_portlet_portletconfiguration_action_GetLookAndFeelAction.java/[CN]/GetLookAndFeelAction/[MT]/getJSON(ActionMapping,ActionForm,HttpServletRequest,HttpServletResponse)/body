{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  String portletId=ParamUtil.getString(request,"portletId");
  if (!PortletPermissionUtil.contains(permissionChecker,themeDisplay.getPlid(),portletId,ActionKeys.CONFIGURATION)) {
    return null;
  }
  PortletPreferences portletSetup=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
  return PortletSetupUtil.cssToJSONString(portletSetup);
}
