{
  MBMessage message=(MBMessage)obj;
  Document document=getBaseModelDocument(PORTLET_ID,message);
  document.addKeyword(Field.CATEGORY_ID,message.getCategoryId());
  document.addText(Field.CONTENT,processContent(message));
  document.addKeyword(Field.ROOT_ENTRY_CLASS_PK,message.getRootMessageId());
  document.addText(Field.TITLE,message.getSubject());
  if (message.isAnonymous()) {
    document.remove(Field.USER_NAME);
  }
  try {
    MBDiscussionLocalServiceUtil.getThreadDiscussion(message.getThreadId());
    document.addKeyword("discussion",true);
  }
 catch (  NoSuchDiscussionException nsde) {
    document.addKeyword("discussion",false);
  }
  document.addKeyword("threadId",message.getThreadId());
  if (message.isDiscussion()) {
    Indexer indexer=IndexerRegistryUtil.getIndexer(message.getClassName());
    if (indexer != null) {
      indexer.addRelatedEntryFields(document,obj);
      document.addKeyword(Field.RELATED_ENTRY,true);
    }
  }
  return document;
}
