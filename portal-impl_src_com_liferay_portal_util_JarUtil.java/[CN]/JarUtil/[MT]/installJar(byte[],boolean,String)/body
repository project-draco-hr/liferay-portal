{
  String libPath=PropsValues.LIFERAY_LIB_PORTAL_DIR;
  if (globalClassPath) {
    libPath=PropsValues.LIFERAY_LIB_GLOBAL_DIR;
  }
  File file=new File(libPath + StringPool.SLASH + name);
  InputStream is=null;
  try {
    if (_log.isInfoEnabled()) {
      _log.info("Writing " + file);
    }
    if (bytes != null) {
      FileUtil.write(file,bytes);
    }
 else {
      is=DLStoreUtil.getFileAsStream(_REPOSITORY,_REPOSITORY,_FILE_PATH + name);
      FileUtil.write(file,is);
    }
  }
  finally {
    if (is != null) {
      is.close();
    }
  }
  addJarFileToClassLoader(file);
}
