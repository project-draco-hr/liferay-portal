{
  List<MBCategory> categories=MBCategoryLocalServiceUtil.getCompanyCategories(companyId,categoryStart,categoryEnd);
  for (  MBCategory category : categories) {
    long groupId=category.getGroupId();
    long categoryId=category.getCategoryId();
    int messageCount=MBMessageLocalServiceUtil.getCategoryMessagesCount(groupId,categoryId,WorkflowConstants.STATUS_APPROVED);
    int messagePages=messageCount / Indexer.DEFAULT_INTERVAL;
    for (int i=0; i <= messagePages; i++) {
      int messageStart=(i * Indexer.DEFAULT_INTERVAL);
      int messageEnd=messageStart + Indexer.DEFAULT_INTERVAL;
      reindexMessages(companyId,groupId,categoryId,messageStart,messageEnd);
    }
  }
}
