{
  try {
    String[] credentials=null;
    long companyId=PortalUtil.getCompanyId(request);
    if (!PrefsPropsUtil.getBoolean(companyId,PropsKeys.CAS_AUTH_ENABLED,PropsValues.CAS_AUTH_ENABLED)) {
      return credentials;
    }
    HttpSession session=request.getSession();
    String screenName=(String)session.getAttribute(CASFilter.CAS_FILTER_USER);
    if (screenName != null) {
      User user=null;
      try {
        user=UserLocalServiceUtil.getUserByScreenName(companyId,screenName);
      }
 catch (      NoSuchUserException nsue) {
        if (PrefsPropsUtil.getBoolean(companyId,PropsKeys.CAS_IMPORT_FROM_LDAP)) {
          user=addUser(companyId,screenName);
        }
 else {
          throw nsue;
        }
      }
      credentials=new String[3];
      credentials[0]=String.valueOf(user.getUserId());
      credentials[1]=user.getPassword();
      credentials[2]=Boolean.TRUE.toString();
    }
    return credentials;
  }
 catch (  Exception e) {
    throw new AutoLoginException(e);
  }
}
