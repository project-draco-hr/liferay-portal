{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  try {
    MBMessageDisplay messageDisplay=ActionUtil.getMessageDisplay(portletRequest);
    MBCategory category=messageDisplay.getCategory();
    long categoryId=MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID;
    if (category != null) {
      categoryId=category.getCategoryId();
    }
    if (MBCategoryPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),categoryId,ActionKeys.LOCK_THREAD)) {
      MBThread thread=messageDisplay.getThread();
      if (thread.isLocked()) {
        return new UnlockThreadPortletConfigurationIcon(portletRequest,thread);
      }
 else {
        return new LockThreadPortletConfigurationIcon(portletRequest,thread);
      }
    }
  }
 catch (  PortalException pe) {
  }
  return null;
}
