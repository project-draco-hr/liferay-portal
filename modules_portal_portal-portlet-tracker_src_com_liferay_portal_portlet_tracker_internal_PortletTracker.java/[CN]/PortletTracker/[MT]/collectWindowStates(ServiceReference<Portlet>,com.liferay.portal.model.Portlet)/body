{
  Map<String,Set<String>> windowStates=new HashMap<String,Set<String>>();
  Set<String> defaultWindowStates=new HashSet<String>();
  defaultWindowStates.add(toLowerCase(LiferayWindowState.EXCLUSIVE));
  defaultWindowStates.add(toLowerCase(LiferayWindowState.POP_UP));
  defaultWindowStates.add(toLowerCase(WindowState.MAXIMIZED));
  defaultWindowStates.add(toLowerCase(WindowState.MINIMIZED));
  defaultWindowStates.add(toLowerCase(WindowState.NORMAL));
  windowStates.put(ContentTypes.TEXT_HTML,defaultWindowStates);
  List<String> windowStatesList=StringPlus.asList(serviceReference.getProperty("javax.portlet.windowStates"));
  for (  String windowState : windowStatesList) {
    String[] parts=StringUtil.split(windowState,";");
    if (parts.length != 2) {
      continue;
    }
    String mimeType=parts[0];
    Set<String> mimeTypeWindowStates=new HashSet<String>();
    String[] states=StringUtil.split(parts[1]);
    mimeTypeWindowStates.add(toLowerCase(WindowState.NORMAL));
    boolean addDefaultStates=true;
    for (    String state : states) {
      mimeTypeWindowStates.add(toLowerCase(state));
      addDefaultStates=false;
    }
    if (addDefaultStates) {
      mimeTypeWindowStates.add(toLowerCase(LiferayWindowState.EXCLUSIVE));
      mimeTypeWindowStates.add(toLowerCase(LiferayWindowState.POP_UP));
      mimeTypeWindowStates.add(toLowerCase(WindowState.MAXIMIZED));
      mimeTypeWindowStates.add(toLowerCase(WindowState.MINIMIZED));
    }
    windowStates.put(mimeType,mimeTypeWindowStates);
  }
  portletModel.setWindowStates(windowStates);
}
