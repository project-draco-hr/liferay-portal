{
  PortletPreferences prefs=req.getPreferences();
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(req,"groupId");
  if (groupId < 1) {
    groupId=GetterUtil.getLong(prefs.getValue("group-id",StringPool.BLANK));
  }
  String articleId=ParamUtil.getString(req,"articleId");
  String templateId=ParamUtil.getString(req,"templateId");
  if (Validator.isNull(articleId)) {
    articleId=GetterUtil.getString(prefs.getValue("article-id",StringPool.BLANK));
    templateId=GetterUtil.getString(prefs.getValue("template-id",StringPool.BLANK));
  }
  String languageId=LanguageUtil.getLanguageId(req);
  boolean disableCaching=GetterUtil.getBoolean(prefs.getValue("disable-caching",StringPool.BLANK));
  int page=ParamUtil.getInteger(req,"page",1);
  String xmlRequest=PortletRequestUtil.toXML(req,res);
  JournalArticleDisplay articleDisplay=null;
  if ((groupId > 0) && Validator.isNotNull(articleId)) {
    articleDisplay=JournalContentUtil.getDisplay(groupId,articleId,templateId,languageId,themeDisplay,disableCaching,page,xmlRequest);
  }
  if (articleDisplay != null) {
    req.setAttribute(WebKeys.JOURNAL_ARTICLE_DISPLAY,articleDisplay);
  }
 else {
    req.removeAttribute(WebKeys.JOURNAL_ARTICLE_DISPLAY);
    req.setAttribute(WebKeys.PORTLET_DECORATE,Boolean.FALSE);
  }
  return mapping.findForward("portlet.journal_content.view");
}
