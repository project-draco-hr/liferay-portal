{
  List<Element> elements=_markupHeadElements.get(MimeResponse.MARKUP_HEAD_ELEMENT);
  if ((elements == null) || elements.isEmpty()) {
    return;
  }
  HttpServletRequest servletRequest=getHttpServletRequest();
  List<String> markupHeadElements=(List<String>)servletRequest.getAttribute(MimeResponse.MARKUP_HEAD_ELEMENT);
  if (markupHeadElements == null) {
    markupHeadElements=new ArrayList<String>();
  }
  for (  Element element : elements) {
    try {
      UnsyncStringWriter unsyncStringWriter=new UnsyncStringWriter();
      Transformer transformer=TransformerFactory.newInstance().newTransformer();
      transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION,"yes");
      transformer.transform(new DOMSource(element),new StreamResult(unsyncStringWriter));
      markupHeadElements.add(unsyncStringWriter.toString());
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e);
      }
    }
  }
  servletRequest.setAttribute(MimeResponse.MARKUP_HEAD_ELEMENT,markupHeadElements);
}
