{
  DLFolder dlFolder=dlFolderPersistence.fetchByG_P_N(groupId,folderId,title);
  if (dlFolder != null) {
    throw new DuplicateFolderNameException(title);
  }
  DLFileEntry dlFileEntry=dlFileEntryPersistence.fetchByG_F_T(groupId,folderId,title);
  if ((dlFileEntry != null) && (dlFileEntry.getFileEntryId() != fileEntryId)) {
    throw new DuplicateFileException(title);
  }
  String periodAndExtension=StringPool.PERIOD + extension;
  if (!title.endsWith(periodAndExtension)) {
    title+=periodAndExtension;
    dlFileEntry=dlFileEntryPersistence.fetchByG_F_T(groupId,folderId,title);
    if ((dlFileEntry != null) && (dlFileEntry.getFileEntryId() != fileEntryId)) {
      throw new DuplicateFileException(title);
    }
  }
}
