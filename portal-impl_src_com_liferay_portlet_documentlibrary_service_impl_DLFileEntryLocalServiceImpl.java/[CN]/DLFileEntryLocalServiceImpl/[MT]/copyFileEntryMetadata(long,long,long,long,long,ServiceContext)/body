{
  Map<String,Fields> fieldsMap=new HashMap<String,Fields>();
  List<DDMStructure> ddmStructures=null;
  if (fileEntryTypeId > 0) {
    DLFileEntryType dlFileEntryType=dlFileEntryTypeLocalService.getFileEntryType(fileEntryTypeId);
    ddmStructures=dlFileEntryType.getDDMStructures();
  }
 else {
    long classNameId=classNameLocalService.getClassNameId(DLFileEntryMetadata.class);
    ddmStructures=ddmStructureLocalService.getClassStructures(companyId,classNameId);
  }
  copyFileEntryMetadata(companyId,fileEntryTypeId,fileEntryId,fromFileVersionId,toFileVersionId,serviceContext,fieldsMap,ddmStructures);
}
