{
  DLFileEntry fileEntry=dlFileEntryPersistence.findByG_F_N(groupId,folderId,name);
  if (version > 0) {
    try {
      long repositoryId=getRepositoryId(groupId,folderId);
      dlService.deleteFile(fileEntry.getCompanyId(),PortletKeys.DOCUMENT_LIBRARY,repositoryId,fileEntry.getName(),version);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
    dlFileVersionPersistence.removeByF_N_V(folderId,name,version);
  }
 else {
    deleteFileEntry(fileEntry);
  }
}
