{
  boolean update=false;
  String extension=FileUtil.getExtension(name);
  Iterator itr=dlFileEntryPersistence.findByF_T(folderId,title).iterator();
  while (itr.hasNext()) {
    DLFileEntry fileEntry=(DLFileEntry)itr.next();
    String curExtension=FileUtil.getExtension(fileEntry.getName());
    if (PropsValues.WEBDAV_LITMUS && Validator.isNull(extension)) {
      if (Validator.isNull(curExtension)) {
        update=true;
        name=fileEntry.getName();
        break;
      }
    }
 else     if (extension.equals(curExtension)) {
      update=true;
      break;
    }
  }
  if (update) {
    return updateFileEntry(userId,folderId,folderId,name,sourceName,title,description,tagsEntries,extraSettings,file);
  }
 else {
    return addFileEntry(userId,folderId,name,title,description,tagsEntries,extraSettings,file,addCommunityPermissions,addGuestPermissions);
  }
}
