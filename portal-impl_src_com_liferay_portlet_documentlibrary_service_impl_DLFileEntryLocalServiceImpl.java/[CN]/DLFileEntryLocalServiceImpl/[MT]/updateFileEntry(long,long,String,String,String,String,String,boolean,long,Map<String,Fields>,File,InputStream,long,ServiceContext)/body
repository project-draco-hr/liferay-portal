{
  DLFileEntry dlFileEntry=dlFileEntryPersistence.findByPrimaryKey(fileEntryId);
  String extension=getExtension(title,sourceFileName);
  String extraSettings=StringPool.BLANK;
  Group scopeGroup=GroupLocalServiceUtil.getGroup(dlFileEntry.getGroupId());
  Group companyGroup=GroupLocalServiceUtil.getCompanyGroup(scopeGroup.getCompanyId());
  long[] groupIds=new long[]{dlFileEntry.getGroupId(),companyGroup.getGroupId()};
  if (scopeGroup.isLayout()) {
    groupIds=new long[]{scopeGroup.getParentGroupId(),companyGroup.getGroupId()};
  }
  fileEntryTypeId=getFileEntryTypeId(groupIds,dlFileEntry.getFolderId(),fileEntryTypeId);
  return updateFileEntry(userId,fileEntryId,sourceFileName,extension,mimeType,title,description,changeLog,majorVersion,extraSettings,fileEntryTypeId,fieldsMap,file,is,size,serviceContext);
}
