{
  HashMap<String,Fields> fieldsMap=new HashMap<String,Fields>();
  if (fileEntryTypeId <= 0) {
    return fieldsMap;
  }
  DLFileEntryType fileEntryType=dlFileEntryTypeLocalService.getFileEntryType(fileEntryTypeId);
  List<DDMStructure> ddmStructures=fileEntryType.getDDMStructures();
  for (  DDMStructure ddmStructure : ddmStructures) {
    Fields fields=(Fields)serviceContext.getAttribute(Fields.class.getName() + ddmStructure.getStructureId());
    if (fields == null) {
      String namespace=String.valueOf(ddmStructure.getStructureId());
      fields=DDMUtil.getFields(ddmStructure.getStructureId(),namespace,serviceContext);
    }
    fieldsMap.put(ddmStructure.getStructureKey(),fields);
  }
  return fieldsMap;
}
