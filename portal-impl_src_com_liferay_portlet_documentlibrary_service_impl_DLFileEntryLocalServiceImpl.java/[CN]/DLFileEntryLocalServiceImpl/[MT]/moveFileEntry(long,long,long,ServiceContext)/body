{
  if (!hasFileEntryLock(userId,fileEntryId)) {
    lockFileEntry(userId,fileEntryId);
  }
  try {
    DLFileEntry dlFileEntry=moveFileEntryImpl(userId,fileEntryId,newFolderId,serviceContext);
    dlAppHelperLocalService.moveFileEntry(new LiferayFileEntry(dlFileEntry));
    return dlFileEntryTypeLocalService.updateFileEntryFileEntryType(dlFileEntry,serviceContext);
  }
  finally {
    if (!isFileEntryCheckedOut(fileEntryId)) {
      unlockFileEntry(fileEntryId);
    }
  }
}
