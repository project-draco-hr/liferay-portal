{
  if (!hasFileEntryLock(userId,fileEntryId)) {
    lockFileEntry(userId,fileEntryId);
  }
  try {
    return moveFileEntryImpl(userId,fileEntryId,newFolderId,serviceContext);
  }
  finally {
    if (!isFileEntryCheckedOut(fileEntryId)) {
      unlockFileEntry(fileEntryId);
    }
  }
}
