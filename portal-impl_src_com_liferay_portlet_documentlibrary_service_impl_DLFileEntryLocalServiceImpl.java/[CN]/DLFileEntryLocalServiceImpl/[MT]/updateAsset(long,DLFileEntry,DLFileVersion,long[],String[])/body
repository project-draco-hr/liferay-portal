{
  String mimeType=MimeTypesUtil.getContentType(fileEntry.getTitle());
  boolean addDraftAssetEntry=false;
  if ((fileVersion != null) && !fileVersion.isApproved() && (fileVersion.getVersion() != DLFileEntryConstants.DEFAULT_VERSION)) {
    int approvedArticlesCount=dlFileVersionPersistence.countByG_F_N_S(fileEntry.getGroupId(),fileEntry.getFolderId(),fileEntry.getName(),WorkflowConstants.STATUS_APPROVED);
    if (approvedArticlesCount > 0) {
      addDraftAssetEntry=true;
    }
  }
  if (addDraftAssetEntry) {
    assetEntryLocalService.updateEntry(userId,fileEntry.getGroupId(),DLFileEntry.class.getName(),fileVersion.getFileVersionId(),assetCategoryIds,assetTagNames,false,null,null,null,null,mimeType,fileEntry.getTitle(),fileEntry.getDescription(),null,null,0,0,null,false);
  }
 else {
    assetEntryLocalService.updateEntry(userId,fileEntry.getGroupId(),DLFileEntry.class.getName(),fileEntry.getFileEntryId(),assetCategoryIds,assetTagNames,true,null,null,null,null,mimeType,fileEntry.getTitle(),fileEntry.getDescription(),null,null,0,0,null,false);
    List<DLFileShortcut> fileShortcuts=dlFileShortcutPersistence.findByG_TF_TN(fileEntry.getGroupId(),fileEntry.getFolderId(),fileEntry.getName());
    for (    DLFileShortcut fileShortcut : fileShortcuts) {
      assetEntryLocalService.updateEntry(userId,fileShortcut.getGroupId(),DLFileShortcut.class.getName(),fileShortcut.getFileShortcutId(),assetCategoryIds,assetTagNames,true,null,null,null,null,mimeType,fileEntry.getTitle(),fileEntry.getDescription(),null,null,0,0,null,false);
    }
  }
}
