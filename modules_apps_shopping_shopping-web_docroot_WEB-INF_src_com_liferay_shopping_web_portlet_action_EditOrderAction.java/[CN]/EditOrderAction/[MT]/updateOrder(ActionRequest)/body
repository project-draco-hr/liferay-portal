{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String number=ParamUtil.getString(actionRequest,"number");
  String ppTxnId=ParamUtil.getString(actionRequest,"ppTxnId");
  String ppPaymentStatus=ShoppingUtil.getPpPaymentStatus(ParamUtil.getString(actionRequest,"ppPaymentStatus"));
  double ppPaymentGross=ParamUtil.getDouble(actionRequest,"ppPaymentGross");
  String ppReceiverEmail=ParamUtil.getString(actionRequest,"ppReceiverEmail");
  String ppPayerEmail=ParamUtil.getString(actionRequest,"ppPayerEmail");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(actionRequest);
  ShoppingOrderServiceUtil.completeOrder(themeDisplay.getScopeGroupId(),number,ppTxnId,ppPaymentStatus,ppPaymentGross,ppReceiverEmail,ppPayerEmail,serviceContext);
}
