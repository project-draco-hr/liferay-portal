{
  if (_log.isInfoEnabled()) {
    _log.info("Dropping stale indexes");
  }
  Set<String> validIndexNames=new HashSet<String>();
  if (indexes.isEmpty()) {
    return validIndexNames;
  }
  String tablesSQLLowerCase=StringUtil.toLowerCase(tablesSQL);
  String indexesSQLLowerCase=StringUtil.toLowerCase(indexesSQL);
  Properties indexesPropertiesObj=PropertiesUtil.load(indexesProperties);
  Enumeration<String> enu=(Enumeration<String>)indexesPropertiesObj.propertyNames();
  while (enu.hasMoreElements()) {
    String key=enu.nextElement();
    String value=indexesPropertiesObj.getProperty(key);
    indexesPropertiesObj.setProperty(StringUtil.toLowerCase(key),value);
  }
  for (  Index index : indexes) {
    String indexNameUpperCase=StringUtil.toUpperCase(index.getIndexName());
    String indexNameLowerCase=StringUtil.toLowerCase(indexNameUpperCase);
    String tableName=index.getTableName();
    String tableNameLowerCase=StringUtil.toLowerCase(tableName);
    boolean unique=index.isUnique();
    validIndexNames.add(indexNameUpperCase);
    if (indexesPropertiesObj.containsKey(indexNameLowerCase)) {
      if (unique && indexesSQLLowerCase.contains("create unique index " + indexNameLowerCase + " ")) {
        continue;
      }
      if (!unique && indexesSQLLowerCase.contains("create index " + indexNameLowerCase + " ")) {
        continue;
      }
    }
 else     if (!tablesSQLLowerCase.contains("create table " + tableNameLowerCase + " (")) {
      continue;
    }
    validIndexNames.remove(indexNameUpperCase);
    String sql="drop index " + indexNameUpperCase + " on "+ tableName;
    if (_log.isInfoEnabled()) {
      _log.info(sql);
    }
    runSQL(con,sql);
  }
  return validIndexNames;
}
