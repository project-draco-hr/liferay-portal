{
  List<Index> indexes=getIndexes(con);
  Set<String> validIndexNames=null;
  if (dropIndexes) {
    validIndexNames=dropIndexes(con,tablesSQL,indexesSQL,indexes);
  }
 else {
    validIndexNames=new HashSet<>();
    for (    Index index : indexes) {
      String indexName=StringUtil.toUpperCase(index.getIndexName());
      validIndexNames.add(indexName);
    }
  }
  indexesSQL=applyMaxStringIndexLengthLimitation(_columnLengthPattern.matcher(indexesSQL));
  addIndexes(con,indexesSQL,validIndexNames);
}
