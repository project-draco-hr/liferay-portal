{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    long workflowTaskId=ParamUtil.getLong(portletRequest,"workflowTaskId");
    String comment=ParamUtil.getString(portletRequest,"comment");
    int dueDateMonth=ParamUtil.getInteger(portletRequest,"dueDateMonth");
    int dueDateDay=ParamUtil.getInteger(portletRequest,"dueDateDay");
    int dueDateYear=ParamUtil.getInteger(portletRequest,"dueDateYear");
    int dueDateHour=ParamUtil.getInteger(portletRequest,"dueDateHour");
    int dueDateMinute=ParamUtil.getInteger(portletRequest,"dueDateMinute");
    int dueDateAmPm=ParamUtil.getInteger(portletRequest,"dueDateAmPm");
    if (dueDateAmPm == Calendar.PM) {
      dueDateHour+=12;
    }
    Date dueDate=PortalUtil.getDate(dueDateMonth,dueDateDay,dueDateYear,dueDateHour,dueDateMinute,WorkflowTaskDueDateException.class);
    WorkflowTaskManagerUtil.updateDueDate(themeDisplay.getCompanyId(),themeDisplay.getUserId(),workflowTaskId,comment,dueDate);
    super.doProcessCommand(portletRequest,portletResponse);
  }
 catch (  Exception e) {
    if (e instanceof WorkflowTaskDueDateException) {
      SessionErrors.add(portletRequest,e.getClass());
    }
 else     if (e instanceof PrincipalException || e instanceof WorkflowException) {
      SessionErrors.add(portletRequest,e.getClass());
      PortletSession portletSession=portletRequest.getPortletSession();
      PortletContext portletContext=portletSession.getPortletContext();
      portletContext.getRequestDispatcher(portletResponse.encodeURL("/error.jsp")).include(portletRequest,portletResponse);
    }
 else {
      throw e;
    }
  }
}
