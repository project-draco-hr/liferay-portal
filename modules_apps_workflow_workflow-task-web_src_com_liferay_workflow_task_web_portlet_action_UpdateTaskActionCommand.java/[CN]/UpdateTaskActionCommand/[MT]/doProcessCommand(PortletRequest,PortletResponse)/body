{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    long workflowTaskId=ParamUtil.getLong(portletRequest,ActionUtil.WORKFLOW_TASK_ID);
    String comment=ParamUtil.getString(portletRequest,_COMMENT);
    int dueDateMonth=ParamUtil.getInteger(portletRequest,_DUE_DATE_MONTH);
    int dueDateDay=ParamUtil.getInteger(portletRequest,_DUE_DATE_DAY);
    int dueDateYear=ParamUtil.getInteger(portletRequest,_DUE_DATE_YEAR);
    int dueDateHour=ParamUtil.getInteger(portletRequest,_DUE_DATE_HOUR);
    int dueDateMinute=ParamUtil.getInteger(portletRequest,_DUE_DATE_MINUTE);
    int dueDateAmPm=ParamUtil.getInteger(portletRequest,_DUE_DATE_AM_PM);
    if (dueDateAmPm == Calendar.PM) {
      dueDateHour+=12;
    }
    Date dueDate=PortalUtil.getDate(dueDateMonth,dueDateDay,dueDateYear,dueDateHour,dueDateMinute,WorkflowTaskDueDateException.class);
    WorkflowTaskManagerUtil.updateDueDate(themeDisplay.getCompanyId(),themeDisplay.getUserId(),workflowTaskId,comment,dueDate);
    super.doProcessCommand(portletRequest,portletResponse);
  }
 catch (  Exception e) {
    if (e instanceof WorkflowTaskDueDateException) {
      SessionErrors.add(portletRequest,e.getClass());
    }
 else     if (e instanceof PrincipalException || e instanceof WorkflowException) {
      SessionErrors.add(portletRequest,e.getClass());
      PortletSession portletSession=portletRequest.getPortletSession();
      PortletContext portletContext=portletSession.getPortletContext();
      portletContext.getRequestDispatcher(portletResponse.encodeURL("/error.jsp")).include(portletRequest,portletResponse);
    }
 else {
      throw e;
    }
  }
}
