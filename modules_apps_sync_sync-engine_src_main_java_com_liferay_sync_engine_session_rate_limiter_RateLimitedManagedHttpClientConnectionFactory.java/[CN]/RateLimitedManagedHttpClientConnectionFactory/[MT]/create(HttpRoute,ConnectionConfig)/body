{
  if (connectionConfig == null) {
    connectionConfig=ConnectionConfig.DEFAULT;
  }
  CodingErrorAction malformedInputAction=connectionConfig.getMalformedInputAction();
  if (malformedInputAction == null) {
    malformedInputAction=CodingErrorAction.REPORT;
  }
  CodingErrorAction unmappableInputAction=connectionConfig.getUnmappableInputAction();
  if (unmappableInputAction == null) {
    unmappableInputAction=CodingErrorAction.REPORT;
  }
  CharsetDecoder charsetDecoder=null;
  CharsetEncoder charsetEncoder=null;
  Charset charset=connectionConfig.getCharset();
  if (charset != null) {
    charsetDecoder=charset.newDecoder();
    charsetDecoder.onMalformedInput(malformedInputAction);
    charsetDecoder.onUnmappableCharacter(unmappableInputAction);
    charsetEncoder=charset.newEncoder();
    charsetEncoder.onMalformedInput(malformedInputAction);
    charsetEncoder.onUnmappableCharacter(unmappableInputAction);
  }
  final String id="http-outgoing-" + Long.toString(_COUNTER.getAndIncrement());
  return new RateLimitedManagedHttpClientConnection(id,connectionConfig.getBufferSize(),connectionConfig.getFragmentSizeHint(),charsetDecoder,charsetEncoder,connectionConfig.getMessageConstraints(),null,null,null,null);
}
