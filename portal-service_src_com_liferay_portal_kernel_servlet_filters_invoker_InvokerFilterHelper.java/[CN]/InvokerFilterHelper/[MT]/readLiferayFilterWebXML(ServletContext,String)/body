{
  InputStream inputStream=servletContext.getResourceAsStream(path);
  if (inputStream == null) {
    return;
  }
  Document document=UnsecureSAXReaderUtil.read(inputStream,true);
  Element rootElement=document.getRootElement();
  Map<String,ObjectValuePair<Filter,FilterConfig>> filterObjectValuePairs=new HashMap<>();
  for (  Element filterElement : rootElement.elements("filter")) {
    String filterName=filterElement.elementText("filter-name");
    String filterClassName=filterElement.elementText("filter-class");
    Map<String,String> initParameterMap=new HashMap<>();
    List<Element> initParamElements=filterElement.elements("init-param");
    for (    Element initParamElement : initParamElements) {
      String name=initParamElement.elementText("param-name");
      String value=initParamElement.elementText("param-value");
      initParameterMap.put(name,value);
    }
    FilterConfig filterConfig=new InvokerFilterConfig(servletContext,filterName,initParameterMap);
    Filter filter=initFilter(servletContext,filterClassName,filterName,filterConfig);
    if (filter != null) {
      filterObjectValuePairs.put(filterName,new ObjectValuePair<>(filter,filterConfig));
    }
  }
  List<Element> filterMappingElements=rootElement.elements("filter-mapping");
  for (  Element filterMappingElement : filterMappingElements) {
    String filterName=filterMappingElement.elementText("filter-name");
    List<String> urlPatterns=new ArrayList<>();
    List<Element> urlPatternElements=filterMappingElement.elements("url-pattern");
    for (    Element urlPatternElement : urlPatternElements) {
      urlPatterns.add(urlPatternElement.getTextTrim());
    }
    List<String> dispatchers=new ArrayList<>(4);
    List<Element> dispatcherElements=filterMappingElement.elements("dispatcher");
    for (    Element dispatcherElement : dispatcherElements) {
      String dispatcher=StringUtil.toUpperCase(dispatcherElement.getTextTrim());
      dispatchers.add(dispatcher);
    }
    ObjectValuePair<Filter,FilterConfig> filterObjectValuePair=filterObjectValuePairs.get(filterName);
    if (filterObjectValuePair == null) {
      if (_log.isWarnEnabled()) {
        _log.warn("No filter and filter config for filter name " + filterName);
      }
      continue;
    }
    FilterMapping filterMapping=new FilterMapping(filterName,filterObjectValuePair.getKey(),filterObjectValuePair.getValue(),urlPatterns,dispatchers);
    registerFilterMapping(filterMapping,null,true);
  }
}
