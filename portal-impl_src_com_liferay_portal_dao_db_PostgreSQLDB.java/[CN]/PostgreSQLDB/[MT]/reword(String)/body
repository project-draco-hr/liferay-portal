{
  UnsyncBufferedReader br=new UnsyncBufferedReader(new UnsyncStringReader(data));
  StringBuilder sb=new StringBuilder();
  String line=null;
  while ((line=br.readLine()) != null) {
    if (line.startsWith(ALTER_COLUMN_NAME)) {
      String[] template=buildColumnNameTokens(line);
      line=StringUtil.replace("alter table @table@ rename @old-column@ to @new-column@;",REWORD_TEMPLATE,template);
    }
 else     if (line.startsWith(ALTER_COLUMN_TYPE)) {
      String[] template=buildColumnTypeTokens(line);
      line=StringUtil.replace("alter table @table@ alter @old-column@ type @type@ " + "using @old-column@::@type@;",REWORD_TEMPLATE,template);
    }
 else     if (line.indexOf(DROP_PRIMARY_KEY) != -1) {
      String[] tokens=StringUtil.split(line," ");
      line=StringUtil.replace("alter table @table@ drop constraint @table@_pkey;","@table@",tokens[2]);
    }
    sb.append(line);
    sb.append("\n");
  }
  br.close();
  return sb.toString();
}
