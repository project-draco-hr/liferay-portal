{
  String type=ShoppingConfig.SHOPPING_CONFIG;
  String name=ShoppingConfig.SHOPPING_CONFIG;
  List configs=getAdminConfig(companyId,type);
  AdminConfig config=null;
  ShoppingConfig shoppingConfig=null;
  if (configs.size() == 0) {
    String configId=Long.toString(CounterServiceUtil.increment(AdminConfig.class.getName()));
    Company company=CompanyLocalServiceUtil.getCompany(companyId);
    shoppingConfig=new ShoppingConfig(company.getEmailAddress(),ShoppingConfig.CC_TYPES,ShoppingConfig.DEFAULT_CURRENCY_ID,ShoppingConfig.DEFAULT_TAX_STATE,ShoppingConfig.DEFAULT_TAX_RATE,ShoppingConfig.DEFAULT_SHIPPING_FORMULA,ShoppingConfig.DEFAULT_SHIPPING,ShoppingConfig.DEFAULT_ALTERNATIVE_SHIPPING,ShoppingConfig.DEFAULT_INSURANCE_FORMULA,ShoppingConfig.DEFAULT_INSURANCE,ShoppingConfig.DEFAULT_MIN_ORDER,_getShoppingConfigOrderEmail(),_getShoppingConfigShippingEmail());
    config=AdminConfigUtil.create(configId);
    config.setCompanyId(companyId);
    config.setType(type);
    config.setName(name);
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
    configs.add(config);
  }
 else {
    config=(AdminConfig)configs.iterator().next();
    shoppingConfig=(ShoppingConfig)config.getConfigObj();
  }
  if (shoppingConfig.getCcTypes() == null) {
    shoppingConfig.setCcTypes(new String[0]);
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
  }
  if (shoppingConfig.getInsuranceFormula() == null) {
    shoppingConfig.setInsuranceFormula(ShoppingConfig.DEFAULT_INSURANCE_FORMULA);
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
  }
  if (shoppingConfig.getInsurance() == null) {
    shoppingConfig.setInsurance(ShoppingConfig.DEFAULT_INSURANCE);
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
  }
  if (shoppingConfig.getOrderEmail() == null) {
    shoppingConfig.setOrderEmail(_getShoppingConfigOrderEmail());
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
  }
  if (shoppingConfig.getShippingEmail() == null) {
    shoppingConfig.setShippingEmail(_getShoppingConfigShippingEmail());
    config.setConfigObj(shoppingConfig);
    AdminConfigUtil.update(config);
  }
  return shoppingConfig;
}
