{
  Properties props=new Properties();
  try {
    URL url=null;
    if (useServletContext) {
      url=_servletContext.getResource("/WEB-INF/" + name);
    }
 else {
      ClassLoader classLoader=getClass().getClassLoader();
      url=classLoader.getResource(name);
    }
    if (_log.isInfoEnabled()) {
      _log.info("Attempting to load " + name + " "+ localeKey+ " "+ useServletContext);
    }
    if (url != null) {
      InputStream is=url.openStream();
      props.load(is);
      is.close();
      if (_log.isInfoEnabled()) {
        _log.info("Loading " + url + " with "+ props.size()+ " values");
      }
    }
  }
 catch (  Exception e) {
    _log.warn(e);
  }
  if (props.size() < 1) {
    return;
  }
synchronized (messages) {
    Enumeration names=props.keys();
    while (names.hasMoreElements()) {
      String key=(String)names.nextElement();
      messages.put(messageKey(localeKey,key),props.getProperty(key));
    }
  }
}
