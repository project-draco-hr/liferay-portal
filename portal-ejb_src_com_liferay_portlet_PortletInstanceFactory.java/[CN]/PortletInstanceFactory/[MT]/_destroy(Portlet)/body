{
  String poolId=PortletInstanceFactory.class.getName();
  if (!portlet.isWARFile()) {
    StringMaker sm=new StringMaker();
    sm.append(poolId);
    sm.append(StringPool.PERIOD);
    sm.append(portlet.getCompanyId());
    poolId=sm.toString();
  }
  Map map=(Map)_pool.get(poolId);
  if (map == null) {
    return;
  }
  Map portletInstances=(Map)map.get(portlet.getRootPortletId());
  if (portletInstances == null) {
    return;
  }
  Iterator itr=portletInstances.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry entry=(Map.Entry)itr.next();
    CachePortlet portletInstance=(CachePortlet)entry.getValue();
    portletInstance.destroy();
  }
  map.remove(portlet.getRootPortletId());
  if (portlet.isWARFile()) {
    PortletContextWrapper pcw=(PortletContextWrapper)PortletContextPool.get(portlet.getRootPortletId());
    pcw.removePortletInstance();
  }
  PortletConfigFactory.destroy(portlet);
  PortletContextFactory.destroy(portlet);
}
