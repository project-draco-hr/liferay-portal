{
  Map<String,Object> contextObjects=new HashMap<String,Object>();
  contextObjects.put(DDLConstants.RESERVED_DDM_STRUCTURE_ID,recordSet.getDDMStructureId());
  contextObjects.put(DDLConstants.RESERVED_DDM_TEMPLATE_ID,ddmTemplateId);
  contextObjects.put(DDLConstants.RESERVED_RECORD_SET_DESCRIPTION,recordSet.getDescription(themeDisplay.getLocale()));
  contextObjects.put(DDLConstants.RESERVED_RECORD_SET_ID,recordSet.getRecordSetId());
  contextObjects.put(DDLConstants.RESERVED_RECORD_SET_NAME,recordSet.getName(themeDisplay.getLocale()));
  String viewMode=ParamUtil.getString(renderRequest,"viewMode");
  if (Validator.isNull(viewMode)) {
    viewMode=Constants.VIEW;
  }
  contextObjects.put("viewMode",viewMode);
  DDMTemplate ddmTemplate=DDMTemplateLocalServiceUtil.getTemplate(ddmTemplateId);
  return _transformer.transform(themeDisplay,contextObjects,ddmTemplate.getScript(),ddmTemplate.getLanguage());
}
