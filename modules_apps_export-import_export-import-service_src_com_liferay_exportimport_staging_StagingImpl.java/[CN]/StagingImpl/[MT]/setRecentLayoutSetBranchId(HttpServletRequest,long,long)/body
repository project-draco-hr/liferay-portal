{
  PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(request);
  try {
    setRecentLayoutAttribute(portalPreferences,getRecentLayoutSetBranchIdKey(layoutSetId),layoutSetBranchId);
    ProxiedLayoutsThreadLocal.clearProxiedLayouts();
  }
 catch (  JSONException jsone) {
    if (_log.isWarnEnabled()) {
      _log.warn("Unable to set recent layout set branch ID with layout " + "set " + layoutSetId + " and layout set branch "+ layoutSetBranchId,jsone);
    }
  }
}
