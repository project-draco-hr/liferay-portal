{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  String portletId=ParamUtil.getString(req,"portletResource");
  if (!PortletPermissionUtil.contains(permissionChecker,themeDisplay.getPlid(),portletId,ActionKeys.CONFIGURATION)) {
    throw new PrincipalException();
  }
}
