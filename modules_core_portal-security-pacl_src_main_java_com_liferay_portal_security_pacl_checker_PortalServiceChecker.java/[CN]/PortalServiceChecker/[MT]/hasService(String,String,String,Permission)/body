{
  int stackIndex=Reflection.getStackIndex(8,7);
  Class<?> callerClass=Reflection.getCallerClass(stackIndex);
  if (isTrustedCaller(callerClass,permission)) {
    callerClass=Reflection.getCallerClass(stackIndex + 1);
    if (isTrustedCaller(callerClass,permission)) {
      return true;
    }
  }
  Set<String> services=getServices(servletContextName);
  if (services.contains(className)) {
    return true;
  }
  if (Validator.isNull(methodName)) {
    return false;
  }
  if (services.contains(className.concat(StringPool.POUND).concat(methodName))) {
    return true;
  }
  return false;
}
