{
  List<LogRecord> logRecords=JDKLoggerTestUtil.configureJDKLogger(SPIAgentSerializable.class.getName(),Level.OFF);
  MockHttpSession mockHttpSession=new MockHttpSession();
  String serializeableAttribute="serializeableAttribute";
  mockHttpSession.setAttribute(serializeableAttribute,serializeableAttribute);
  final String nonserializableAttribute="nonserializableAttribute";
  mockHttpSession.setAttribute(nonserializableAttribute,new Object(){
    @Override public String toString(){
      return nonserializableAttribute;
    }
  }
);
  Map<String,Serializable> sessionAttributes=SPIAgentSerializable.extractSessionAttributes(mockHttpSession);
  Assert.assertTrue(logRecords.isEmpty());
  Assert.assertEquals(1,sessionAttributes.size());
  Assert.assertEquals(serializeableAttribute,sessionAttributes.get(serializeableAttribute));
  logRecords=JDKLoggerTestUtil.configureJDKLogger(SPIAgentSerializable.class.getName(),Level.WARNING);
  sessionAttributes=SPIAgentSerializable.extractSessionAttributes(mockHttpSession);
  Assert.assertEquals(1,logRecords.size());
  LogRecord logRecord=logRecords.get(0);
  Assert.assertEquals("Nonserializable session attribute name " + nonserializableAttribute + " with value "+ nonserializableAttribute,logRecord.getMessage());
  Assert.assertEquals(1,sessionAttributes.size());
  Assert.assertEquals(serializeableAttribute,sessionAttributes.get(serializeableAttribute));
}
