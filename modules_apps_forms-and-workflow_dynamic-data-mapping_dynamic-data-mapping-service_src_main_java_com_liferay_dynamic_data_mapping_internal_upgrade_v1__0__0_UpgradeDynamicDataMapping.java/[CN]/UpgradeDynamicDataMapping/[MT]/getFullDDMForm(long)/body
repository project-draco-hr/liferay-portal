{
  DDMForm fullDDMForm=_fullDDMForms.get(structureId);
  if (fullDDMForm != null) {
    return fullDDMForm;
  }
  try (PreparedStatement ps=connection.prepareStatement("select parentStructureId from " + "DDMStructure where structureId = ?")){
    ps.setLong(1,structureId);
    try (ResultSet rs=ps.executeQuery()){
      if (rs.next()) {
        long parentStructureId=rs.getLong("parentStructureId");
        fullDDMForm=getDDMForm(structureId);
        if (parentStructureId > 0) {
          DDMForm parentDDMForm=getFullDDMForm(parentStructureId);
          List<DDMFormField> ddmFormFields=fullDDMForm.getDDMFormFields();
          ddmFormFields.addAll(parentDDMForm.getDDMFormFields());
        }
        _fullDDMForms.put(structureId,fullDDMForm);
        return fullDDMForm;
      }
    }
     throw new UpgradeException("Unable to find dynamic data mapping structure with ID " + structureId);
  }
 }
