{
  DDMForm copyDDMForm=new DDMForm(ddmForm);
  Map<String,DDMFormField> ddmFormFieldsMap=copyDDMForm.getDDMFormFieldsMap(true);
  for (  DDMFormField ddmFormField : ddmFormFieldsMap.values()) {
    String fieldName=ddmFormField.getName();
    if (isInvalidFieldName(fieldName)) {
      String newFieldName=createNewDDMFormFieldName(fieldName,ddmFormFieldsMap.keySet());
      ddmFormField.setName(newFieldName);
      ddmFormField.setProperty("oldName",fieldName);
    }
    String dataType=ddmFormField.getDataType();
    if (Objects.equals(dataType,"file-upload")) {
      ddmFormField.setDataType("document-library");
      ddmFormField.setType("ddm-documentlibrary");
    }
 else     if (Objects.equals(dataType,"image")) {
      ddmFormField.setFieldNamespace("ddm");
      ddmFormField.setType("ddm-image");
    }
  }
  return copyDDMForm;
}
