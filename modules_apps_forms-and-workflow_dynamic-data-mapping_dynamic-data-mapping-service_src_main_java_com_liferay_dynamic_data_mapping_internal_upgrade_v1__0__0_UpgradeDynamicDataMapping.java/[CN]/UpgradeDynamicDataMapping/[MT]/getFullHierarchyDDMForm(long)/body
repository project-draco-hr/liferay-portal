{
  DDMForm fullHierarchyDDMForm=_fullHierarchyDDMForms.get(structureId);
  if (fullHierarchyDDMForm != null) {
    return fullHierarchyDDMForm;
  }
  try (PreparedStatement ps=connection.prepareStatement("select parentStructureId from " + "DDMStructure where structureId = ?")){
    ps.setLong(1,structureId);
    try (ResultSet rs=ps.executeQuery()){
      if (rs.next()) {
        long parentStructureId=rs.getLong("parentStructureId");
        fullHierarchyDDMForm=getDDMForm(structureId);
        if (parentStructureId > 0) {
          DDMForm parentDDMForm=getFullHierarchyDDMForm(parentStructureId);
          List<DDMFormField> ddmFormFields=fullHierarchyDDMForm.getDDMFormFields();
          ddmFormFields.addAll(parentDDMForm.getDDMFormFields());
        }
        _fullHierarchyDDMForms.put(structureId,fullHierarchyDDMForm);
        return fullHierarchyDDMForm;
      }
    }
     throw new UpgradeException("Unable to find dynamic data mapping structure with ID " + structureId);
  }
 }
