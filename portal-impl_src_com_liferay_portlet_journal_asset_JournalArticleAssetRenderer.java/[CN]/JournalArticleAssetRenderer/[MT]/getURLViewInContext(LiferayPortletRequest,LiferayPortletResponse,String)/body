{
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  if (Validator.isNotNull(_article.getLayoutUuid())) {
    String portletId=(String)liferayPortletRequest.getAttribute(WebKeys.PORTLET_ID);
    PortletPreferences portletSetup=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
    String linkToLayoutUuid=GetterUtil.getString(portletSetup.getValue("portletSetupLinkToLayoutUuid",null));
    if (linkToLayoutUuid.equals(_article.getLayoutUuid())) {
      Group group=themeDisplay.getScopeGroup();
      if (group.getGroupId() != _article.getGroupId()) {
        group=GroupLocalServiceUtil.getGroup(_article.getGroupId());
      }
      String groupFriendlyURL=PortalUtil.getGroupFriendlyURL(group,false,themeDisplay);
      return groupFriendlyURL.concat(JournalArticleConstants.CANONICAL_URL_SEPARATOR).concat(_article.getUrlTitle());
    }
  }
  List<Long> hitLayoutIds=JournalContentSearchLocalServiceUtil.getLayoutIds(layout.getGroupId(),layout.isPrivateLayout(),_article.getArticleId());
  if (!hitLayoutIds.isEmpty()) {
    Long hitLayoutId=hitLayoutIds.get(0);
    Layout hitLayout=LayoutLocalServiceUtil.getLayout(layout.getGroupId(),layout.isPrivateLayout(),hitLayoutId.longValue());
    return PortalUtil.getLayoutURL(hitLayout,themeDisplay);
  }
  return noSuchEntryRedirect;
}
