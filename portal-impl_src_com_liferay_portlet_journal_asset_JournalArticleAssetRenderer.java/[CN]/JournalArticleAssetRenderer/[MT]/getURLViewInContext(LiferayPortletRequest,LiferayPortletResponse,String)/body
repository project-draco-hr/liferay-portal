{
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Group group=themeDisplay.getScopeGroup();
  if (Validator.isNotNull(_article.getLayoutUuid())) {
    if (group.getGroupId() != _article.getGroupId()) {
      group=GroupLocalServiceUtil.getGroup(_article.getGroupId());
    }
    String groupFriendlyURL=PortalUtil.getGroupFriendlyURL(group,false,themeDisplay);
    return groupFriendlyURL.concat(JournalArticleConstants.CANONICAL_URL_SEPARATOR).concat(HtmlUtil.escape(_article.getUrlTitle()));
  }
  Layout layout=themeDisplay.getLayout();
  List<Long> hitLayoutIds=JournalContentSearchLocalServiceUtil.getLayoutIds(layout.getGroupId(),layout.isPrivateLayout(),_article.getArticleId());
  if (!hitLayoutIds.isEmpty()) {
    Long hitLayoutId=hitLayoutIds.get(0);
    Layout hitLayout=LayoutLocalServiceUtil.getLayout(layout.getGroupId(),layout.isPrivateLayout(),hitLayoutId.longValue());
    return PortalUtil.getLayoutURL(hitLayout,themeDisplay);
  }
  return noSuchEntryRedirect;
}
