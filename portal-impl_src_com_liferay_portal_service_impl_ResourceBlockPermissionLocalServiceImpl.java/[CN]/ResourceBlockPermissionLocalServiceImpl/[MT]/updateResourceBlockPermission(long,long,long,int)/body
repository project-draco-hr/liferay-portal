{
  ResourceBlockPermissionPK pk=new ResourceBlockPermissionPK(resourceBlockId,roleId);
  ResourceBlockPermission resourceBlockPermission=resourceBlockPermissionPersistence.fetchByPrimaryKey(pk);
  if (resourceBlockPermission == null) {
    if (actionIdsLong == 0) {
      return;
    }
    resourceBlockPermission=resourceBlockPermissionPersistence.create(pk);
  }
  if (operator == ResourceBlockConstants.OPERATOR_ADD) {
    actionIdsLong|=resourceBlockPermission.getActionIds();
  }
 else   if (operator == ResourceBlockConstants.OPERATOR_REMOVE) {
    actionIdsLong=resourceBlockPermission.getActionIds() & (~actionIdsLong);
  }
  if (actionIdsLong == 0) {
    deleteResourceBlockPermission(resourceBlockPermission);
  }
 else {
    resourceBlockPermission.setActionIds(actionIdsLong);
    updateResourceBlockPermission(resourceBlockPermission);
  }
}
