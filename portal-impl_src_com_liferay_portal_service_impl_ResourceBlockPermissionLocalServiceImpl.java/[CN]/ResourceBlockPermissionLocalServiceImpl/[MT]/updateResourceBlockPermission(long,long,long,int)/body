{
  ResourceBlockPermission resourceBlockPermission=resourceBlockPermissionPersistence.fetchByR_R(resourceBlockId,roleId);
  if (resourceBlockPermission == null) {
    if (actionIdsLong == 0) {
      return;
    }
    long resourceBlockPermissionId=counterLocalService.increment();
    resourceBlockPermission=resourceBlockPermissionPersistence.create(resourceBlockPermissionId);
    resourceBlockPermission.setResourceBlockId(resourceBlockId);
    resourceBlockPermission.setRoleId(roleId);
  }
  if (operator == ResourceBlockConstants.OPERATOR_ADD) {
    actionIdsLong|=resourceBlockPermission.getActionIds();
  }
 else   if (operator == ResourceBlockConstants.OPERATOR_REMOVE) {
    actionIdsLong=resourceBlockPermission.getActionIds() & (~actionIdsLong);
  }
  if (actionIdsLong == 0) {
    deleteResourceBlockPermission(resourceBlockPermission);
  }
 else {
    resourceBlockPermission.setActionIds(actionIdsLong);
    updateResourceBlockPermission(resourceBlockPermission);
  }
}
