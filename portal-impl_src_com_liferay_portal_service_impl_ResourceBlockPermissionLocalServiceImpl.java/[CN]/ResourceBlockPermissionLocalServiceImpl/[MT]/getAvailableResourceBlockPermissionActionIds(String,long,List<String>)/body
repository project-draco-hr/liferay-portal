{
  if (actionIds.isEmpty()) {
    return Collections.emptyMap();
  }
  ResourceBlock resourceBlock=resourceBlockLocalService.getResourceBlock(name,primKey);
  List<ResourceBlockPermission> resourceBlockPermissions=resourceBlockPermissionPersistence.findByResourceBlockId(resourceBlock.getResourceBlockId());
  Map<Long,Set<String>> roleIdsToActionIds=new HashMap<>();
  for (  ResourceBlockPermission resourceBlockPermission : resourceBlockPermissions) {
    Set<String> availableActionIds=new HashSet<>();
    List<String> resourceBlockActionIds=resourceBlockLocalService.getActionIds(name,resourceBlockPermission.getActionIds());
    for (    String actionId : actionIds) {
      if (resourceBlockActionIds.contains(actionId)) {
        availableActionIds.add(actionId);
      }
    }
    if (!availableActionIds.isEmpty()) {
      roleIdsToActionIds.put(resourceBlockPermission.getRoleId(),availableActionIds);
    }
  }
  return roleIdsToActionIds;
}
