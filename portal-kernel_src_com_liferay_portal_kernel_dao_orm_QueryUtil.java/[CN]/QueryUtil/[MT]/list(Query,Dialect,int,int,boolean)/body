{
  if ((start == ALL_POS) && (end == ALL_POS)) {
    return query.list(unmodifiable);
  }
 else {
    if (dialect.supportsLimit()) {
      query.setMaxResults(end - start);
      query.setFirstResult(start);
      return query.list(unmodifiable);
    }
 else {
      List<Object> list=new ArrayList<Object>();
      DB db=DBFactoryUtil.getDB();
      if (!db.isSupportsScrollableResults()) {
        if (_log.isWarnEnabled()) {
          _log.warn("Database does not support scrollable results");
        }
        return list;
      }
      ScrollableResults sr=query.scroll();
      if (sr.first() && sr.scroll(start)) {
        for (int i=start; i < end; i++) {
          Object obj=sr.get(0);
          list.add(obj);
          if (!sr.next()) {
            break;
          }
        }
      }
      if (unmodifiable) {
        return new UnmodifiableList<Object>(list);
      }
 else {
        return list;
      }
    }
  }
}
