{
  if ((total == 0) || (num == 0)) {
    return new ArrayList<Object>();
  }
  if (num >= total) {
    return list(query,dialect,ALL_POS,ALL_POS,true);
  }
  int[] scrollIds=Randomizer.getInstance().nextInt(total,num);
  List<Object> list=new ArrayList<Object>();
  DB db=DBFactoryUtil.getDB();
  if (!db.isSupportsScrollableResults()) {
    if (_log.isWarnEnabled()) {
      _log.warn("Database does not support scrollable results");
    }
    return list;
  }
  ScrollableResults sr=query.scroll();
  for (int i=0; i < scrollIds.length; i++) {
    if (sr.scroll(scrollIds[i])) {
      Object[] array=sr.get();
      if (array.length == 1) {
        list.add(array[0]);
      }
 else {
        list.add(array);
      }
      sr.first();
    }
  }
  if (unmodifiable) {
    return new UnmodifiableList<Object>(list);
  }
 else {
    return list;
  }
}
