{
  if ((total == 0) || (num == 0)) {
    return new ArrayList<Object>();
  }
  if (num >= total) {
    return list(query,dialect,ALL_POS,ALL_POS,true);
  }
  int[] scrollIds=Randomizer.getInstance().nextInt(total,num);
  List<Object> list=new ArrayList<Object>();
  DB db=DBFactoryUtil.getDB();
  if (!db.isSupportsScrollableResults()) {
    return list;
  }
  ScrollableResults sr=query.scroll();
  for (int i=0; i < scrollIds.length; i++) {
    if (sr.scroll(scrollIds[i])) {
      Object obj=sr.get(0);
      list.add(obj);
      sr.first();
    }
  }
  if (unmodifiable) {
    return new UnmodifiableList<Object>(list);
  }
 else {
    return list;
  }
}
