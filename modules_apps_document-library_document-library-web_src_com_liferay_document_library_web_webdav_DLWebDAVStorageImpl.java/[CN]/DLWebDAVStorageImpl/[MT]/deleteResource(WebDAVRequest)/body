{
  try {
    Resource resource=getResource(webDAVRequest);
    if (resource == null) {
      if (webDAVRequest.isAppleDoubleRequest()) {
        return HttpServletResponse.SC_NO_CONTENT;
      }
 else {
        return HttpServletResponse.SC_NOT_FOUND;
      }
    }
    Object model=resource.getModel();
    if (model instanceof Folder) {
      Folder folder=(Folder)model;
      long folderId=folder.getFolderId();
      if ((folder.getModel() instanceof DLFolder) && TrashUtil.isTrashEnabled(folder.getGroupId())) {
        _dlAppService.moveFolderToTrash(folderId);
      }
 else {
        _dlAppService.deleteFolder(folderId);
      }
    }
 else {
      FileEntry fileEntry=(FileEntry)model;
      if (!hasLock(fileEntry,webDAVRequest.getLockUuid()) && (fileEntry.getLock() != null)) {
        return WebDAVUtil.SC_LOCKED;
      }
      long fileEntryId=fileEntry.getFileEntryId();
      if ((fileEntry.getModel() instanceof DLFileEntry) && TrashUtil.isTrashEnabled(fileEntry.getGroupId())) {
        _dlAppService.moveFileEntryToTrash(fileEntryId);
      }
 else {
        _dlAppService.deleteFileEntry(fileEntryId);
      }
    }
    return HttpServletResponse.SC_NO_CONTENT;
  }
 catch (  PrincipalException pe) {
    if (_log.isDebugEnabled()) {
      _log.debug(pe,pe);
    }
    return HttpServletResponse.SC_FORBIDDEN;
  }
catch (  Exception e) {
    throw new WebDAVException(e);
  }
}
