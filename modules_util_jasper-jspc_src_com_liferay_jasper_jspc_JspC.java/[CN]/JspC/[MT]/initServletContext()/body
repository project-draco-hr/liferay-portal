{
  super.initServletContext();
  if (Boolean.getBoolean("jspc.module.web")) {
    final String portalDir=System.getProperty("jspc.portal.dir");
    if ((portalDir == null) || portalDir.isEmpty()) {
      throw new RuntimeException("The ssytem property \"jspc.portal.dir\" is not set");
    }
    try {
      tldLocationsCache=new TldLocationsCache(new JspCServletContext(new PrintWriter(System.out),new URL("file://" + portalDir + "/"))){
        @Override public TldLocation getLocation(        String uri) throws JasperException {
          TldLocation tldLocation=super.getLocation(uri);
          String name=tldLocation.getName();
          if (name.startsWith("/WEB-INF/tld/")) {
            tldLocation=new TldLocation("file://" + portalDir + name);
          }
          return tldLocation;
        }
      }
;
    }
 catch (    MalformedURLException murle) {
      throw new RuntimeException(murle);
    }
  }
 else {
    try {
      WebXml webXml=new WebXml(context);
      if (webXml.getInputSource() != null) {
        return;
      }
    }
 catch (    IOException ioe) {
      throw new RuntimeException(ioe);
    }
    context.setAttribute(Constants.MERGED_WEB_XML,"<web-app version=\"2.4\" />");
    jspConfig=new JspConfig(context);
  }
}
