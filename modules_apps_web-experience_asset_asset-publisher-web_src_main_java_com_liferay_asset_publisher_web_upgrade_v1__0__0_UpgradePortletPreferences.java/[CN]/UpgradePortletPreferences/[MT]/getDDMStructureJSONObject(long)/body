{
  JSONObject ddmStructureJSONObject=_ddmSructureJSONObjects.get(structureId);
  if (ddmStructureJSONObject != null) {
    return ddmStructureJSONObject;
  }
  try (PreparedStatement ps=connection.prepareStatement("select definition from DDMStructure where structureId = ?")){
    ps.setLong(1,structureId);
    try (ResultSet rs=ps.executeQuery()){
      if (rs.next()) {
        String definition=rs.getString("definition");
        ddmStructureJSONObject=JSONFactoryUtil.createJSONObject(definition);
        _ddmSructureJSONObjects.put(structureId,ddmStructureJSONObject);
        return ddmStructureJSONObject;
      }
      throw new UpgradeException("Unable to find dynamic data mapping structure " + structureId);
    }
   }
 }
