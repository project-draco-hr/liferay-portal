{
  PermissionChecker permissionChecker=getPermissionChecker();
  if (!permissionChecker.isGroupAdmin(groupId) && !permissionChecker.isGroupOwner(groupId)) {
    throw new PrincipalException();
  }
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  List<SocialActivityDefinition> activityDefinitions=socialActivitySettingLocalService.getActivityDefinitions(groupId,className);
  Collections.sort(activityDefinitions,new SocialActivityDefinitionNameComparator(LocaleThreadLocal.getThemeDisplayLocale()));
  for (  SocialActivityDefinition activityDefinition : activityDefinitions) {
    JSONObject activityDefinitionJSONObject=JSONFactoryUtil.createJSONObject(JSONFactoryUtil.looseSerialize(activityDefinition));
    JSONArray activityCounterDefinitionsJSONArray=JSONFactoryUtil.createJSONArray();
    for (    SocialActivityCounterDefinition activityCounterDefinition : activityDefinition.getActivityCounterDefinitions()) {
      JSONObject activityCounterDefinitionJSONObject=JSONFactoryUtil.createJSONObject(JSONFactoryUtil.looseSerialize(activityCounterDefinition));
      activityCounterDefinitionsJSONArray.put(activityCounterDefinitionJSONObject);
    }
    activityDefinitionJSONObject.put("counters",activityCounterDefinitionsJSONArray);
    jsonArray.put(activityDefinitionJSONObject);
  }
  return jsonArray;
}
