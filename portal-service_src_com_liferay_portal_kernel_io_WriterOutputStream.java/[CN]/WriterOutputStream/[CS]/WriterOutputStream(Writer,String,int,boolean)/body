{
  if (outputBufferSize <= 0) {
    throw new IllegalArgumentException("Output buffer size " + outputBufferSize + " must be a positive number");
  }
  if (charsetName == null) {
    charsetName=StringPool.DEFAULT_CHARSET_NAME;
  }
  _writer=writer;
  _charsetName=charsetName;
  _charsetDecoder=CharsetDecoderUtil.getCharsetDecoder(charsetName);
  CharsetEncoder charsetEncoder=CharsetEncoderUtil.getCharsetEncoder(charsetName);
  _inputBuffer=ByteBuffer.allocate((int)Math.ceil(charsetEncoder.maxBytesPerChar()));
  _inputBuffer.limit(0);
  _outputBuffer=CharBuffer.allocate(outputBufferSize);
  _autoFlush=autoFlush;
}
