{
  if (!portletDataContext.isPerformDirectBinaryImport()) {
    directBinaryImportThumbnail(portletDataContext,importedFileEntry,fileEntryElement,binPathName,thumbnailIndex);
  }
 else {
    FileVersion fileVersion=fileEntry.getFileVersion();
    File file=doGetThumbnail(fileVersion,thumbnailIndex);
    try {
      InputStream is=new FileInputStream(file);
      FileVersion importedfileVersion=importedFileEntry.getFileVersion();
      String thumbnailFilePath=getThumbnailFilePath(importedfileVersion,getThumbnailType(importedfileVersion),thumbnailIndex);
      addFileToStore(portletDataContext.getCompanyId(),THUMBNAIL_PATH,thumbnailFilePath,is);
    }
 catch (    IOException ioe) {
      throw new SystemException(ioe);
    }
  }
}
