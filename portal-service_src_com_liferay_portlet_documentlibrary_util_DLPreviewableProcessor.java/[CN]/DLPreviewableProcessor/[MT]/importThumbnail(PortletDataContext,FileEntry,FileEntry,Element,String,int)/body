{
  if (!portletDataContext.isPerformDirectBinaryImport()) {
    directBinaryImportThumbnail(portletDataContext,importedFileEntry,fileEntryElement,binPathName,index);
  }
 else {
    FileVersion fileVersion=fileEntry.getFileVersion();
    if (!hasThumbnail(fileVersion,index)) {
      return;
    }
    File file=doGetThumbnail(fileVersion,index);
    try {
      InputStream is=new FileInputStream(file);
      FileVersion importedFileVersion=importedFileEntry.getFileVersion();
      String thumbnailFilePath=getThumbnailFilePath(importedFileVersion,getThumbnailType(importedFileVersion),index);
      addFileToStore(portletDataContext.getCompanyId(),THUMBNAIL_PATH,thumbnailFilePath,is);
    }
 catch (    IOException ioe) {
      throw new SystemException(ioe);
    }
  }
}
