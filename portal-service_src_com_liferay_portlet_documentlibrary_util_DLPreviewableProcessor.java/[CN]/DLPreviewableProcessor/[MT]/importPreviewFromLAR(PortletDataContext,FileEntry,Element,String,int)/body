{
  FileVersion fileVersion=fileEntry.getFileVersion();
  String binPathSegment=null;
  if (fileIndex < 0) {
    binPathSegment=getPreviewType(fileVersion);
  }
 else {
    binPathSegment=Integer.toString(fileIndex + 1);
  }
  String binPath=fileEntryElement.attributeValue("bin-path-preview-" + binPathSegment + "-"+ binPathSuffix);
  InputStream is=portletDataContext.getZipEntryAsInputStream(binPath);
  if (is == null) {
    return;
  }
  String previewFilePath=null;
  if (fileIndex < 0) {
    previewFilePath=getPreviewFilePath(fileVersion,getPreviewType(fileVersion));
  }
 else {
    previewFilePath=getPreviewFilePath(fileVersion,fileIndex + 1);
  }
  addFileToStore(portletDataContext.getCompanyId(),PREVIEW_PATH,previewFilePath,is);
}
