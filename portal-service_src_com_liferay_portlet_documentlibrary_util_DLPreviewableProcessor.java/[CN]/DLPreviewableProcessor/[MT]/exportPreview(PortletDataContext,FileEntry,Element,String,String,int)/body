{
  if (portletDataContext.isPerformDirectBinaryImport()) {
    return;
  }
  String binPathSegment=null;
  if (fileIndex < 0) {
    binPathSegment=previewType;
  }
 else {
    binPathSegment=Integer.toString(fileIndex + 1);
  }
  String binPath=getBinPath(portletDataContext,fileEntry,binPathSegment);
  String binPathName="bin-path-preview-" + binPathSegment + "-"+ binPathSuffix;
  fileEntryElement.addAttribute(binPathName,binPath);
  FileVersion fileVersion=fileEntry.getFileVersion();
  InputStream is=null;
  if (fileIndex < 0) {
    is=doGetPreviewAsStream(fileVersion,previewType);
  }
 else {
    is=doGetPreviewAsStream(fileVersion,fileIndex + 1,previewType);
  }
  exportBinary(portletDataContext,fileEntryElement,fileVersion,is,binPath,binPathName);
}
