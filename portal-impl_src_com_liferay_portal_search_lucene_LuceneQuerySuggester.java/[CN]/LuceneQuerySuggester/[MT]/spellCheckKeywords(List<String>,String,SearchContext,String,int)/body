{
  try {
    Map<String,List<String>> spellCheckResults=new LinkedHashMap<String,List<String>>();
    long companyId=searchContext.getCompanyId();
    float scoringThreshold=searchContext.getScoringThreshold();
    if (scoringThreshold == 0) {
      scoringThreshold=_DEFAULT_SCORING_THRESHOLD;
    }
    IndexSearcher indexSearcher=LuceneHelperUtil.getSearcher(companyId,true);
    List<IndexReader> indexReaders=new ArrayList<IndexReader>();
    if (indexSearcher.maxDoc() > 0) {
      ReaderUtil.gatherSubReaders(indexReaders,indexSearcher.getIndexReader());
    }
    for (    String keyword : keywords) {
      List<String> spellCheckSuggestions=Collections.emptyList();
      if (!SpellCheckerUtil.isValidWord(localizedFieldName,keyword,indexReaders)) {
        int frequency=indexSearcher.docFreq(new Term(localizedFieldName,keyword));
        String[] suggestionsArray=null;
        if (frequency > 0) {
          suggestionsArray=new String[]{keyword};
        }
 else {
          BooleanQuery suggestWordQuery=buildSpellCheckQuery(keyword,languageId);
          RelevancyChecker relevancyChecker=new StringDistanceRelevancyChecker(keyword,scoringThreshold,_stringDistance);
          suggestionsArray=performSearch(indexSearcher,suggestWordQuery,localizedFieldName,relevancyChecker,maxResults);
        }
        spellCheckSuggestions=Arrays.asList(suggestionsArray);
      }
      spellCheckResults.put(keyword,spellCheckSuggestions);
    }
    return spellCheckResults;
  }
 catch (  IOException e) {
    throw new SearchException("Unable to find alternative queries",e);
  }
}
