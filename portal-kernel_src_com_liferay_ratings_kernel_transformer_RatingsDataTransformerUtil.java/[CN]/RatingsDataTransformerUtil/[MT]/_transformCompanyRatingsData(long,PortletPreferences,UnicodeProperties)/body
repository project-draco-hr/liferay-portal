{
  RatingsDataTransformer ratingsDataTransformer=_serviceTracker.getService();
  if (ratingsDataTransformer == null) {
    return;
  }
  Map<String,PortletRatingsDefinitionValues> portletRatingsDefinitionValuesMap=PortletRatingsDefinitionUtil.getPortletRatingsDefinitionValuesMap();
  for (  Map.Entry<String,PortletRatingsDefinitionValues> entry : portletRatingsDefinitionValuesMap.entrySet()) {
    String className=entry.getKey();
    String propertyKey=getPropertyKey(className);
    RatingsType fromRatingsType=RatingsType.parse(oldPortletPreferences.getValue(propertyKey,StringPool.BLANK));
    if (fromRatingsType == null) {
      PortletRatingsDefinitionValues portletRatingsDefinitionValues=entry.getValue();
      fromRatingsType=portletRatingsDefinitionValues.getDefaultRatingsType();
    }
    RatingsType toRatingsType=RatingsType.parse(unicodeProperties.getProperty(propertyKey));
    _transformRatingsData("companyId",companyId,className,fromRatingsType,toRatingsType);
  }
}
