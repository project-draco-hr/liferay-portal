{
  Object testObject=new Object();
  MarkFinalizeAction markFinalizeAction=new MarkFinalizeAction();
  FinalizeManager.register(testObject,markFinalizeAction);
  assertFalse(markFinalizeAction.isMarked());
  testObject=null;
  long startTime=System.currentTimeMillis();
  while ((System.currentTimeMillis() - startTime) < 100) {
    System.gc();
    Thread.sleep(1);
    if (markFinalizeAction.isMarked()) {
      break;
    }
  }
  FinalizeManager.register(new Object(),markFinalizeAction);
  assertTrue(markFinalizeAction.isMarked());
}
