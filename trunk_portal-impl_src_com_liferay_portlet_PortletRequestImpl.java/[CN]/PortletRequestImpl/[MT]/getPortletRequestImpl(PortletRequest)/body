{
  PortletRequestImpl portletRequestImpl=null;
  if (portletRequest instanceof PortletRequestImpl) {
    portletRequestImpl=(PortletRequestImpl)portletRequest;
  }
 else {
    try {
      Method method=portletRequest.getClass().getMethod("getRequest");
      Object obj=method.invoke(portletRequest,(Object[])null);
      portletRequestImpl=getPortletRequestImpl((PortletRequest)obj);
    }
 catch (    Exception e) {
      throw new RuntimeException("Unable to get the portlet request from " + portletRequest.getClass().getName());
    }
  }
  return portletRequestImpl;
}
