{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=_getConnection();
    String sql="SELECT count(*) FROM Map ";
    if ((key != null) && (value != null)) {
      sql+="WHERE key_ = ? AND value_ = ?";
      ps=con.prepareStatement(sql);
      ps.setBytes(1,SerializableUtil.serialize(key));
      ps.setBytes(2,SerializableUtil.serialize(value));
    }
 else     if (key != null) {
      sql+="WHERE key_ = ?";
      ps=con.prepareStatement(sql);
      ps.setBytes(1,SerializableUtil.serialize(key));
    }
 else     if (value != null) {
      sql+="WHERE value_ = ?";
      ps=con.prepareStatement(sql);
      ps.setBytes(1,SerializableUtil.serialize(value));
    }
 else {
      ps=con.prepareStatement(sql);
    }
    rs=ps.executeQuery();
    rs.next();
    return rs.getInt(1);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
 finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
