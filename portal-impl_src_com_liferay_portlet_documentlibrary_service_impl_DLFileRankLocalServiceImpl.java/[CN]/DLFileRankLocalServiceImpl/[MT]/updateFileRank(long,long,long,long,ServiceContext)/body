{
  if (!PropsValues.DL_FILE_RANK_ENABLED) {
    return null;
  }
  DLFileRank dlFileRank=dlFileRankPersistence.fetchByC_U_F(companyId,userId,fileEntryId);
  if (dlFileRank != null) {
    dlFileRank.setCreateDate(serviceContext.getCreateDate(null));
    try {
      dlFileRankPersistence.update(dlFileRank,false);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Failed to update file rank " + dlFileRank.getFileRankId() + " because another thread already updated it");
      }
    }
  }
 else {
    dlFileRank=addFileRank(groupId,companyId,userId,fileEntryId,serviceContext);
  }
  return dlFileRank;
}
