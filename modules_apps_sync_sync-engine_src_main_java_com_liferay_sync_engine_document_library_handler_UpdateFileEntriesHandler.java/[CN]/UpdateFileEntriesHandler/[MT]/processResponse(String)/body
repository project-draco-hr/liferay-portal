{
  Map<String,Handler> handlers=(Map<String,Handler>)getParameterValue("handlers");
  JsonNode rootJsonNode=JSONUtil.readTree(response);
  Iterator<Map.Entry<String,JsonNode>> fields=rootJsonNode.fields();
  while (fields.hasNext()) {
    Map.Entry<String,JsonNode> field=fields.next();
    Handler handler=handlers.remove(field.getKey());
    try {
      JsonNode fieldValue=field.getValue();
      String exception=handler.getException(fieldValue.textValue());
      if (handler.handlePortalException(exception)) {
        continue;
      }
      if (_logger.isTraceEnabled()) {
        Class<?> clazz=handler.getClass();
        _logger.trace("Handling response {} {}",clazz.getSimpleName(),fieldValue.toString());
      }
      handler.processResponse(fieldValue.toString());
    }
 catch (    Exception e) {
      if (!isEventCancelled()) {
        _logger.error(e.getMessage(),e);
      }
    }
 finally {
      handler.removeEvent();
    }
  }
  Path filePath=(Path)getParameterValue("zipFilePath");
  FileUtil.deleteFile(filePath);
}
