{
  if (getAccessControlContext() == null) {
    return doGetTemplate(templateResource,errorTemplateResource,restricted,getHelperUtilities(restricted),false);
  }
  AccessControlContext accessControlContext=getAccessControlContext();
  Map<String,Object> helperUtilities=AccessController.doPrivileged(new DoGetHelperUtilitiesPrivilegedAction(templateContextHelper,getClassLoader(),restricted),accessControlContext);
  Template template=AccessController.doPrivileged(new DoGetSingleTemplatePrivilegedAction(templateResource,errorTemplateResource,restricted,helperUtilities));
  return new PrivilegedTemplateWrapper(accessControlContext,template);
}
