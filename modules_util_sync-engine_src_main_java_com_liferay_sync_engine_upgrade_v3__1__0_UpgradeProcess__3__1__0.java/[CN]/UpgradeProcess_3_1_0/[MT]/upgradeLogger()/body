{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    Path logsFolderPath=Paths.get(PropsValues.SYNC_CONFIGURATION_DIRECTORY,"logs");
    Path archiveFilePath=logsFolderPath.resolve("archive");
    Files.createDirectories(archiveFilePath);
    Path archiveZipFilePath=archiveFilePath.resolve("sync-" + System.currentTimeMillis() + ".log.zip");
    FileOutputStream fileOutputStream=new FileOutputStream(archiveZipFilePath.toFile());
    ZipOutputStream zipOutputStream=new ZipOutputStream(fileOutputStream);
    try (DirectoryStream<Path> filePaths=Files.newDirectoryStream(logsFolderPath)){
      for (      Path filePath : filePaths) {
        if (filePath.equals(archiveFilePath)) {
          continue;
        }
        ZipEntry zipEntry=new ZipEntry(String.valueOf(filePath.getFileName()));
        zipOutputStream.putNextEntry(zipEntry);
        InputStream inputStream=null;
        try {
          inputStream=Files.newInputStream(filePath);
          byte[] bytes=new byte[4096];
          int length=0;
          while ((length=inputStream.read(bytes)) > 0) {
            zipOutputStream.write(bytes,0,length);
          }
          zipOutputStream.closeEntry();
          Files.delete(filePath);
        }
 catch (        Exception e) {
        }
 finally {
          StreamUtil.cleanUp(inputStream);
        }
      }
      zipOutputStream.close();
    }
  finally {
      StreamUtil.cleanUp(zipOutputStream);
    }
    UpgradeUtil.copyLoggerConfiguration();
  }
 }
