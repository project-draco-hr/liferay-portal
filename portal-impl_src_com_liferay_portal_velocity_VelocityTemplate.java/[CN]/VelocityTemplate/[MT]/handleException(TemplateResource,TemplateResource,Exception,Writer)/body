{
  put("exception",exception.getMessage());
  if (templateResource instanceof StringTemplateResource) {
    StringTemplateResource stringTemplateResource=(StringTemplateResource)templateResource;
    put("script",stringTemplateResource.getContent());
  }
  if (exception instanceof ParseErrorException) {
    ParseErrorException pee=(ParseErrorException)exception;
    put("column",pee.getColumnNumber());
    put("line",pee.getLineNumber());
  }
  try {
    processTemplate(errorTemplateResource,writer);
  }
 catch (  Exception e) {
    throw new TemplateException("Unable to process Velocity template " + errorTemplateResource.getTemplateId(),e);
  }
}
