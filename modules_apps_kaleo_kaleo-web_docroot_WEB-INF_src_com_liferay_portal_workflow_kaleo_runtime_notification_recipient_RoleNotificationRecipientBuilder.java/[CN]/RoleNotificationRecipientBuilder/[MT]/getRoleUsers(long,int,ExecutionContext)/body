{
  if (roleType == RoleConstants.TYPE_REGULAR) {
    return UserLocalServiceUtil.getInheritedRoleUsers(roleId,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  }
  List<User> users=new ArrayList<>();
  KaleoInstanceToken kaleoInstanceToken=executionContext.getKaleoInstanceToken();
  List<UserGroupRole> userGroupRoles=UserGroupRoleLocalServiceUtil.getUserGroupRolesByGroupAndRole(kaleoInstanceToken.getGroupId(),roleId);
  for (  UserGroupRole userGroupRole : userGroupRoles) {
    users.add(userGroupRole.getUser());
  }
  List<UserGroupGroupRole> userGroupGroupRoles=UserGroupGroupRoleLocalServiceUtil.getUserGroupGroupRolesByGroupAndRole(kaleoInstanceToken.getGroupId(),roleId);
  for (  UserGroupGroupRole userGroupGroupRole : userGroupGroupRoles) {
    users.addAll(UserLocalServiceUtil.getUserGroupUsers(userGroupGroupRole.getUserGroupId()));
  }
  return users;
}
