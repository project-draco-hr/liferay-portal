{
  _allCategories=MBCategoryServiceUtil.getCategories(scopeGroupId,WorkflowConstants.STATUS_APPROVED);
  _rootCategory=new MBCategoryImpl();
  _rootCategory.setCategoryId(categoryId);
  _categoryTree=new ListTree<MBCategory>(_rootCategory);
  _categoryNodesMap=new HashMap<>();
  Map<Long,List<MBCategory>> categoriesMap=new HashMap<>();
  for (  MBCategory category : _allCategories) {
    Long parentCategoryId=category.getParentCategoryId();
    List<MBCategory> curCategories=categoriesMap.get(parentCategoryId);
    if (curCategories == null) {
      curCategories=new ArrayList<>();
      categoriesMap.put(parentCategoryId,curCategories);
    }
    curCategories.add(category);
  }
  populateCategoryNodesMap(_categoryTree.getRootNode(),categoriesMap);
}
