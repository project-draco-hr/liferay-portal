{
  LayoutTypePortlet sourceLayoutTypePortlet=(LayoutTypePortlet)sourceLayout.getLayoutType();
  List<String> sourcePortletIds=sourceLayoutTypePortlet.getPortletIds();
  for (  String sourcePortletId : sourcePortletIds) {
    PortletPreferences sourcePreferences=PortletPreferencesFactoryUtil.getPortletSetup(sourceLayout,sourcePortletId,null);
    PortletPreferencesImpl sourcePreferencesImpl=(PortletPreferencesImpl)sourcePreferences;
    PortletPreferences targetPreferences=PortletPreferencesFactoryUtil.getPortletSetup(targetLayout,sourcePortletId,null);
    PortletPreferencesImpl targetPreferencesImpl=(PortletPreferencesImpl)targetPreferences;
    PortletPreferencesLocalServiceUtil.updatePreferences(targetPreferencesImpl.getOwnerId(),targetPreferencesImpl.getOwnerType(),targetPreferencesImpl.getPlid(),sourcePortletId,sourcePreferences);
    if ((sourcePreferencesImpl.getOwnerId() != PortletKeys.PREFS_OWNER_ID_DEFAULT) && (sourcePreferencesImpl.getOwnerType() != PortletKeys.PREFS_OWNER_TYPE_LAYOUT)) {
      sourcePreferences=PortletPreferencesFactoryUtil.getLayoutPortletSetup(sourceLayout,sourcePortletId);
      sourcePreferencesImpl=(PortletPreferencesImpl)sourcePreferences;
      targetPreferences=PortletPreferencesFactoryUtil.getLayoutPortletSetup(targetLayout,sourcePortletId);
      targetPreferencesImpl=(PortletPreferencesImpl)targetPreferences;
      PortletPreferencesLocalServiceUtil.updatePreferences(targetPreferencesImpl.getOwnerId(),targetPreferencesImpl.getOwnerType(),targetPreferencesImpl.getPlid(),sourcePortletId,sourcePreferences);
    }
  }
}
