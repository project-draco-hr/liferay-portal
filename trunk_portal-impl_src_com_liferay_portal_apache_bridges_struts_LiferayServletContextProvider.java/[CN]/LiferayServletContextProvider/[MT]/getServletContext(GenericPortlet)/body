{
  PortletContext portletContext=portlet.getPortletContext();
  ServletContext servletContext=(ServletContext)portletContext.getAttribute(JavaConstants.JAVAX_PORTLET_SERVLET_CONTEXT);
  if (servletContext == null) {
    PortletContextImpl portletContextImpl=(PortletContextImpl)portlet.getPortletContext();
    servletContext=portletContextImpl.getServletContext();
  }
  return getServletContext(servletContext);
}
