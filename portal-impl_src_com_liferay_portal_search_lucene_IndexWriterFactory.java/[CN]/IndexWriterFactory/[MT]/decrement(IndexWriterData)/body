{
  if (writerData.getCount() > 0) {
    writerData.setCount(writerData.getCount() - 1);
    if (writerData.getCount() == 0) {
      _writerLookup.remove(writerData.getCompanyId());
      try {
        IndexWriter writer=writerData.getWriter();
        try {
          _optimizeCount++;
          if ((_OPTIMIZE_INTERVAL == 0) || (_optimizeCount >= _OPTIMIZE_INTERVAL)) {
            writer.optimize();
            _optimizeCount=0;
          }
        }
  finally {
          writer.close();
        }
      }
 catch (      Exception e) {
        _log.error(e,e);
      }
 finally {
        releaseLock(writerData.getCompanyId());
      }
    }
  }
}
