{
  Map<String,LayoutTemplate> _themesCustom=_getThemesCustom(themeId);
  List<LayoutTemplate> customLayoutTemplates=new ArrayList<LayoutTemplate>(_portalCustom.size() + _warCustom.size() + _themesCustom.size());
  Iterator<Map.Entry<String,LayoutTemplate>> itr=_portalCustom.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry<String,LayoutTemplate> entry=itr.next();
    String layoutTemplateId=entry.getKey();
    LayoutTemplate layoutTemplate=entry.getValue();
    LayoutTemplate themeCustomLayoutTemplate=_themesCustom.get(layoutTemplateId);
    if (themeCustomLayoutTemplate != null) {
      customLayoutTemplates.add(themeCustomLayoutTemplate);
    }
 else {
      LayoutTemplate warCustomLayoutTemplate=_warCustom.get(layoutTemplateId);
      if (warCustomLayoutTemplate != null) {
        customLayoutTemplates.add(warCustomLayoutTemplate);
      }
 else {
        customLayoutTemplates.add(layoutTemplate);
      }
    }
  }
  itr=_warCustom.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry<String,LayoutTemplate> entry=itr.next();
    String layoutTemplateId=entry.getKey();
    if (!_portalCustom.containsKey(layoutTemplateId) && !_themesCustom.containsKey(layoutTemplateId)) {
      customLayoutTemplates.add(_warCustom.get(layoutTemplateId));
    }
  }
  itr=_themesCustom.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry<String,LayoutTemplate> entry=itr.next();
    String layoutTemplateId=entry.getKey();
    if (!_portalCustom.containsKey(layoutTemplateId) && !_warCustom.containsKey(layoutTemplateId)) {
      customLayoutTemplates.add(_themesCustom.get(layoutTemplateId));
    }
  }
  return customLayoutTemplates;
}
