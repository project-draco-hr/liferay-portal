{
  List<MailMessage> messages=new ArrayList<MailMessage>();
  for (int i=0; i < _smtpServer.getEmailCount(); ++i) {
    MailMessage message=_smtpServer.getMessage(i);
    if (headerName.equals("Body")) {
      String body=message.getBody();
      if (body.equals(headerValue)) {
        messages.add(message);
      }
    }
 else {
      String messageHeaderValue=message.getFirstHeaderValue(headerName);
      if (messageHeaderValue.equals(headerValue)) {
        messages.add(message);
      }
    }
  }
  return messages;
}
