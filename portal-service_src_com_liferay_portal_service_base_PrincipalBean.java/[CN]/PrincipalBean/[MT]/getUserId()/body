{
  String name=PrincipalThreadLocal.getName();
  if (name == null) {
    throw new PrincipalException();
  }
  if (Validator.isNull(name)) {
    throw new PrincipalException("Principal cannot be null");
  }
 else {
    for (int i=0; i < ANONYMOUS_NAMES.length; i++) {
      if (name.equalsIgnoreCase(ANONYMOUS_NAMES[i])) {
        throw new PrincipalException("Principal cannot be " + ANONYMOUS_NAMES[i]);
      }
    }
  }
  return GetterUtil.getLong(name);
}
