{
  try {
    if (GetterUtil.getBoolean(PropsUtil.get(PropsUtil.JCR_INITIALIZE_ON_STARTUP))) {
      JCRFactoryUtil.initialize();
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  PortalInitableUtil.flushInitables();
  _log.debug("Registering hot deploy listeners");
  HotDeployUtil.registerListener(new HotDeployLayoutTemplateListener());
  HotDeployUtil.registerListener(new HotDeployPortletListener());
  HotDeployUtil.registerListener(new HotDeployThemeListener());
  HotDeployUtil.flushEvents();
  try {
    _log.debug("Registering auto deploy directories");
    File deployDir=new File(PrefsPropsUtil.getString(PropsUtil.AUTO_DEPLOY_DEPLOY_DIR));
    File destDir=new File(PrefsPropsUtil.getString(PropsUtil.AUTO_DEPLOY_DEST_DIR));
    long interval=PrefsPropsUtil.getLong(PropsUtil.AUTO_DEPLOY_INTERVAL);
    List autoDeployListeners=new ArrayList();
    autoDeployListeners.add(new AutoDeployLayoutTemplateListener());
    autoDeployListeners.add(new AutoDeployPortletListener());
    autoDeployListeners.add(new AutoDeployThemeListener());
    AutoDeployDir autoDeployDir=new AutoDeployDir("defaultAutoDeployDir",deployDir,destDir,interval,autoDeployListeners);
    AutoDeployUtil.registerDir(autoDeployDir);
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (GetterUtil.getBoolean(PropsUtil.get(PropsUtil.SMTP_SERVER_ENABLED))) {
    int port=GetterUtil.getInteger(PropsUtil.get(PropsUtil.SMTP_SERVER_PORT));
    SMTPServerUtil.setPort(port);
    SMTPServerUtil.start();
  }
}
