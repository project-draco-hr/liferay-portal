{
  final Set<File> files=new TreeSet<>(new FileComparator(dir));
  Files.walkFileTree(dir.toPath(),new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult visitFile(    Path path,    BasicFileAttributes basicFileAttributes) throws IOException {
      files.add(path.toFile());
      return FileVisitResult.CONTINUE;
    }
  }
);
  return files;
}
