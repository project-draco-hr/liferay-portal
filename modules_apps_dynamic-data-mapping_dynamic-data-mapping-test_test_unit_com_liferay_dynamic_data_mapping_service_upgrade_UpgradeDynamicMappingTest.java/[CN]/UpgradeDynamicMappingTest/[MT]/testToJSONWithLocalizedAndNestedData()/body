{
  DDMForm ddmForm=new DDMForm();
  ddmForm.setAvailableLocales(createAvailableLocales(LocaleUtil.US));
  ddmForm.setDefaultLocale(LocaleUtil.US);
  DDMFormField textDDMFormField=new DDMFormField("Text","text");
  textDDMFormField.setDataType("string");
  textDDMFormField.setLocalizable(true);
  textDDMFormField.setRepeatable(true);
  DDMFormField textAreaDDMFormField=new DDMFormField("TextArea","textarea");
  textAreaDDMFormField.setDataType("string");
  textAreaDDMFormField.setLocalizable(true);
  textAreaDDMFormField.setRepeatable(true);
  textDDMFormField.addNestedDDMFormField(textAreaDDMFormField);
  ddmForm.addDDMFormField(textDDMFormField);
  DDMFormValues ddmFormValues=new DDMFormValues(ddmForm);
  ddmFormValues.setAvailableLocales(createAvailableLocales(LocaleUtil.BRAZIL,LocaleUtil.US));
  ddmFormValues.setDefaultLocale(LocaleUtil.US);
  DDMFormFieldValue text1DDMFormFieldValue=createDDMFormFieldValue("srfa","Text",createLocalizedValue("En Text Value 1","Pt Text Value 1",LocaleUtil.US));
  text1DDMFormFieldValue.addNestedDDMFormFieldValue(createDDMFormFieldValue("elcy","TextArea",createLocalizedValue("En Text Area Value 1","Pt Text Area Value 1",LocaleUtil.US)));
  text1DDMFormFieldValue.addNestedDDMFormFieldValue(createDDMFormFieldValue("uxyj","TextArea",createLocalizedValue("En Text Area Value 2","Pt Text Area Value 2",LocaleUtil.US)));
  ddmFormValues.addDDMFormFieldValue(text1DDMFormFieldValue);
  DDMFormFieldValue text2DDMFormFieldValue=createDDMFormFieldValue("ealq","Text",createLocalizedValue("En Text Value 2","Pt Text Value 2",LocaleUtil.US));
  text2DDMFormFieldValue.addNestedDDMFormFieldValue(createDDMFormFieldValue("eepy","TextArea",createLocalizedValue("En Text Area Value 3","Pt Text Area Value 3",LocaleUtil.US)));
  ddmFormValues.addDDMFormFieldValue(text2DDMFormFieldValue);
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("root");
  rootElement.addAttribute("default-locale","en_US");
  rootElement.addAttribute("available-locales","en_US,pt_BR");
  addDynamicElementElement(rootElement,"Text",new String[]{"En Text Value 1","En Text Value 2"},new String[]{"Pt Text Value 1","Pt Text Value 2"});
  addDynamicElementElement(rootElement,"TextArea",new String[]{"En Text Area Value 1","En Text Area Value 2","En Text Area Value 3"},new String[]{"Pt Text Area Value 1","Pt Text Area Value 2","Pt Text Area Value 3"});
  addDynamicElementElement(rootElement,"_fieldsDisplay",new String[]{"Text_INSTANCE_srfa,TextArea_INSTANCE_elcy," + "TextArea_INSTANCE_uxyj,Text_INSTANCE_ealq," + "TextArea_INSTANCE_eepy"});
  String expectedJSON=DDMFormValuesJSONSerializerUtil.serialize(ddmFormValues);
  UpgradeData upgradeData=new UpgradeData();
  DDMFormValues actualDDMFormValues=upgradeData.getDDMFormValues(ddmForm,document.asXML());
  String actualJSON=upgradeData.toJSON(actualDDMFormValues);
  JSONAssert.assertEquals(expectedJSON,actualJSON,false);
}
