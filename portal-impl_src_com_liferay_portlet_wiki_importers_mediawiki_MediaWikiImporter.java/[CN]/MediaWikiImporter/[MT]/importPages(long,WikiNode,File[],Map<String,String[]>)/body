{
  if ((files.length < 1) || (files[0] == null) || (!files[0].exists())) {
    throw new PortalException("The pages file is mandatory");
  }
  File pagesFile=files[0];
  File usersFile=files[1];
  File imagesFile=files[2];
  try {
    Document doc=SAXReaderUtil.read(pagesFile);
    Map<String,String> usersMap=readUsersFile(usersFile);
    Element root=doc.getRootElement();
    List<String> specialNamespaces=readSpecialNamespaces(root);
    processSpecialPages(userId,node,root,specialNamespaces);
    processRegularPages(userId,node,root,specialNamespaces,usersMap,imagesFile,options);
    processImages(userId,node,imagesFile);
    moveFrontPage(userId,node,options);
  }
 catch (  DocumentException de) {
    throw new ImportFilesException("Invalid XML file provided");
  }
catch (  IOException de) {
    throw new ImportFilesException("Error reading the files provided");
  }
catch (  PortalException e) {
    throw e;
  }
catch (  Exception e) {
    throw new PortalException(e);
  }
}
