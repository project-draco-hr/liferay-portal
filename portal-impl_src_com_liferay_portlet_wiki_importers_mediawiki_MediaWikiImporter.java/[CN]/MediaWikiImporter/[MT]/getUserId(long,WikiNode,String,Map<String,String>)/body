{
  User user=null;
  String emailAddress=emailsMap.get(author);
  try {
    if (Validator.isNull(emailAddress)) {
      user=UserLocalServiceUtil.getUserByScreenName(node.getCompanyId(),author.toLowerCase());
    }
 else {
      user=UserLocalServiceUtil.getUserByEmailAddress(node.getCompanyId(),emailAddress);
    }
  }
 catch (  NoSuchUserException e) {
    user=UserLocalServiceUtil.getUserById(userId);
  }
  return user.getUserId();
}
