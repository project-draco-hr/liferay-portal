{
  int count=0;
  try {
    SAXReader saxReader=new SAXReader();
    Document doc=saxReader.read(file);
    Element root=doc.getRootElement();
    List<String> specialNamespaces=_readSpecialNamespaces(root);
    importCategoryPages(userId,node,root);
    Iterator<Element> itr=root.elements("page").iterator();
    while (itr.hasNext()) {
      Element pageEl=itr.next();
      String author=pageEl.element("revision").element("contributor").elementText("username");
      String title=pageEl.elementText("title");
      if (_isSpecialMediaWikiPage(title,specialNamespaces)) {
        continue;
      }
      List<Element> revisionEls=pageEl.elements("revision");
      Element lastRevisionEl=revisionEls.get(revisionEls.size() - 1);
      String content=lastRevisionEl.elementText("text");
      importPage(userId,author,node,title,content);
      count++;
    }
  }
 catch (  DocumentException e) {
    throw new PortalException(e);
  }
  _log.info("Imported " + count + " pages into "+ node.getName());
}
