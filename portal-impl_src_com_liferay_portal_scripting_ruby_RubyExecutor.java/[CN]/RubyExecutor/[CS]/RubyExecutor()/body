{
  _scriptingContainer=new ScriptingContainer(LocalContextScope.THREADSAFE);
  LocalContextProvider localContextProvider=_scriptingContainer.getProvider();
  RubyInstanceConfig rubyInstanceConfig=localContextProvider.getRubyInstanceConfig();
  rubyInstanceConfig.setLoader(PortalClassLoaderUtil.getClassLoader());
  if (PropsValues.SCRIPTING_JRUBY_COMPILE_MODE.equals(_COMPILE_MODE_FORCE)) {
    rubyInstanceConfig.setCompileMode(CompileMode.FORCE);
  }
 else   if (PropsValues.SCRIPTING_JRUBY_COMPILE_MODE.equals(_COMPILE_MODE_JIT)) {
    rubyInstanceConfig.setCompileMode(CompileMode.JIT);
  }
  rubyInstanceConfig.setJitThreshold(PropsValues.SCRIPTING_JRUBY_COMPILE_THRESHOLD);
  _basePath=PropsValues.LIFERAY_LIB_PORTAL_DIR;
  _loadPaths=new ArrayList<String>(PropsValues.SCRIPTING_JRUBY_LOAD_PATHS.length);
  for (  String gemLibPath : PropsValues.SCRIPTING_JRUBY_LOAD_PATHS) {
    _loadPaths.add(gemLibPath);
  }
  _loadPaths.add("file:" + _basePath + "WEB-INF/lib/ruby-gems.jar!/gems/haml-3.0.25/lib");
  rubyInstanceConfig.setLoadPaths(_loadPaths);
  _scriptingContainer.setCurrentDirectory(_basePath);
}
