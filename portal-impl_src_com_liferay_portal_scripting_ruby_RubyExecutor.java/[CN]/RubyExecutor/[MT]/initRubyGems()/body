{
  if (_rubyGemsInitialized) {
    return;
  }
  try {
synchronized (this) {
      if (_rubyGemsInitialized) {
        return;
      }
      ServletContext servletContext=ServletContextPool.get(StringPool.BLANK);
      File rubyGemsJarFile=new File(servletContext.getRealPath("/WEB-INF/lib/ruby-gems.jar"));
      if (!rubyGemsJarFile.exists()) {
        if (_log.isWarnEnabled()) {
          _log.warn(rubyGemsJarFile + " does not exist");
        }
        return;
      }
      String tmpDir=SystemProperties.get(SystemProperties.TMP_DIR);
      File rubyDir=new File(tmpDir + "/liferay/ruby");
      if (!rubyDir.exists() || (rubyDir.lastModified() < rubyGemsJarFile.lastModified())) {
        FileUtil.deltree(rubyDir);
        rubyDir.mkdirs();
        ZipUtil.unzip(rubyGemsJarFile,rubyDir);
        rubyDir.setLastModified(rubyGemsJarFile.lastModified());
      }
      _rubyGemsInitialized=true;
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
