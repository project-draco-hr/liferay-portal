{
  DDMFieldsCounter ddmFieldsCounter=new DDMFieldsCounter();
  for (  Element dynamicElement : dynamicElements) {
    updateDynamicElements(dynamicElement.elements("dynamic-element"));
    String name=dynamicElement.attributeValue("name");
    String type=dynamicElement.attributeValue("type");
    int index=ddmFieldsCounter.get(name);
    dynamicElement.addAttribute("index",String.valueOf(index));
    if (type.equals("image")) {
      updateImageElement(dynamicElement,name,index);
    }
    ddmFieldsCounter.incrementKey(name);
  }
}
