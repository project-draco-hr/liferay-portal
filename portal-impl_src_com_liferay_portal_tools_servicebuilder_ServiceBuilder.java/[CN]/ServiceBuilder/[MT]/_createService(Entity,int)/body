{
  String serviceComments="This is a remote service. Methods of this service are expected to have security checks based on the propagated JAAS credentials because this service can be accessed remotely.";
  JavaClass javaClass=_getJavaClass(_outputPath + "/service/impl/" + entity.getName()+ (sessionType != _SESSION_TYPE_REMOTE ? "Local" : "")+ "ServiceImpl.java");
  JavaMethod[] methods=_getMethods(javaClass);
  if (sessionType == _SESSION_TYPE_LOCAL) {
    if (javaClass.getSuperClass().getValue().endsWith(entity.getName() + "LocalServiceBaseImpl")) {
      JavaClass parentJavaClass=_getJavaClass(_outputPath + "/service/base/" + entity.getName()+ "LocalServiceBaseImpl.java");
      JavaMethod[] parentMethods=parentJavaClass.getMethods();
      JavaMethod[] allMethods=new JavaMethod[parentMethods.length + methods.length];
      ArrayUtil.combine(parentMethods,methods,allMethods);
      methods=allMethods;
    }
    serviceComments="This is a local service. Methods of this service will not have security checks based on the propagated JAAS credentials because this service can only be accessed from within the same VM.";
  }
  Map<String,Object> context=_getContext();
  context.put("entity",entity);
  context.put("methods",methods);
  context.put("sessionTypeName",_getSessionTypeName(sessionType));
  context.put("serviceComments",serviceComments);
  String content=_processTemplate(_tplService,context);
  File ejbFile=new File(_serviceOutputPath + "/service/" + entity.getName()+ _getSessionTypeName(sessionType)+ "Service.java");
  Map<String,Object> jalopySettings=new HashMap<String,Object>();
  jalopySettings.put("keepJavadoc",Boolean.TRUE);
  writeFile(ejbFile,content,_author,jalopySettings);
  if (!_serviceOutputPath.equals(_outputPath)) {
    ejbFile=new File(_outputPath + "/service/" + entity.getName()+ _getSessionTypeName(sessionType)+ "Service.java");
    if (ejbFile.exists()) {
      System.out.println("Relocating " + ejbFile);
      ejbFile.delete();
    }
  }
}
