{
  boolean addDraftAssetEntry=false;
  boolean visible=true;
  if ((recordVersion != null) && !recordVersion.isApproved()) {
    String version=recordVersion.getVersion();
    if (!version.equals(DDLRecordConstants.VERSION_DEFAULT)) {
      int approvedRecordVersionsCount=ddlRecordVersionPersistence.countByR_S(record.getRecordId(),WorkflowConstants.STATUS_APPROVED);
      if (approvedRecordVersionsCount > 0) {
        addDraftAssetEntry=true;
      }
    }
    visible=false;
  }
  DDLRecordSet recordSet=record.getRecordSet();
  DDMStructure ddmStructure=recordSet.getDDMStructure();
  String ddmStructureName=ddmStructure.getName(locale);
  String recordSetName=recordSet.getName(locale);
  String title=LanguageUtil.format(locale,"new-x-for-list-x",new Object[]{ddmStructureName,recordSetName},false);
  if (addDraftAssetEntry) {
    assetEntryLocalService.updateEntry(userId,record.getGroupId(),record.getCreateDate(),record.getModifiedDate(),DDLRecordConstants.getClassName(),recordVersion.getRecordVersionId(),record.getUuid(),0,assetCategoryIds,assetTagNames,false,null,null,null,ContentTypes.TEXT_HTML,title,null,StringPool.BLANK,null,null,0,0,null,false);
  }
 else {
    assetEntryLocalService.updateEntry(userId,record.getGroupId(),record.getCreateDate(),record.getModifiedDate(),DDLRecordConstants.getClassName(),record.getRecordId(),record.getUuid(),0,assetCategoryIds,assetTagNames,visible,null,null,null,ContentTypes.TEXT_HTML,title,null,StringPool.BLANK,null,null,0,0,null,false);
  }
}
