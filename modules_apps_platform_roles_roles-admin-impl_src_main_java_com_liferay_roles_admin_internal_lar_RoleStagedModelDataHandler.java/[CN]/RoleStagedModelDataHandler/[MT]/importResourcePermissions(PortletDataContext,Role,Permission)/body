{
  int scope=permission.getScope();
  if (scope == ResourceConstants.SCOPE_COMPANY) {
    _resourcePermissionService.addResourcePermission(portletDataContext.getCompanyGroupId(),portletDataContext.getCompanyId(),permission.getName(),scope,String.valueOf(portletDataContext.getCompanyId()),importedRole.getRoleId(),permission.getActionId());
  }
 else   if (scope == ResourceConstants.SCOPE_GROUP) {
    long groupId=portletDataContext.getCompanyGroupId();
    long sourceGroupId=GetterUtil.getLong(permission.getPrimKey());
    if (sourceGroupId == portletDataContext.getSourceUserPersonalSiteGroupId()) {
      groupId=portletDataContext.getUserPersonalSiteGroupId();
    }
    _resourcePermissionService.addResourcePermission(groupId,portletDataContext.getCompanyId(),permission.getName(),ResourceConstants.SCOPE_GROUP,String.valueOf(groupId),importedRole.getRoleId(),permission.getActionId());
  }
 else   if (scope == ResourceConstants.SCOPE_GROUP_TEMPLATE) {
    _resourcePermissionService.addResourcePermission(GroupConstants.DEFAULT_PARENT_GROUP_ID,portletDataContext.getCompanyId(),permission.getName(),ResourceConstants.SCOPE_GROUP_TEMPLATE,String.valueOf(GroupConstants.DEFAULT_PARENT_GROUP_ID),importedRole.getRoleId(),permission.getActionId());
  }
 else {
    if (_log.isDebugEnabled()) {
      _log.debug("Individually scoped permissions are not imported");
    }
  }
}
