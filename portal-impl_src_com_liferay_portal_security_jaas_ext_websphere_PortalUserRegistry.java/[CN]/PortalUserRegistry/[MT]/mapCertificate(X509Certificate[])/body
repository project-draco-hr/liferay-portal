{
  if ((certs == null) || (certs.length < 1)) {
    throw new CertificateMapFailedException();
  }
  String name=null;
  try {
    name=certs[0].getSubjectDN().getName();
  }
 catch (  Exception e) {
    throw new CertificateMapNotSupportedException(e);
  }
  if (!isValidUser(name)) {
    throw new CertificateMapFailedException(name);
  }
  return name;
}
