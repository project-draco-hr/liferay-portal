{
  long[] ldapServerIds=StringUtil.split(PrefsPropsUtil.getString(companyId,"ldap.server.ids"),0L);
  for (  long ldapServerId : ldapServerIds) {
    User user=importUser(ldapServerId,companyId,emailAddress,screenName);
    if (user != null) {
      return user;
    }
  }
  for (int ldapServerId=0; ; ldapServerId++) {
    String postfix=_ldapSettings.getPropertyPostfix(ldapServerId);
    String providerUrl=PrefsPropsUtil.getString(companyId,PropsKeys.LDAP_BASE_PROVIDER_URL + postfix);
    if (Validator.isNull(providerUrl)) {
      break;
    }
    User user=importUser(ldapServerId,companyId,emailAddress,screenName);
    if (user != null) {
      return user;
    }
  }
  if (_log.isDebugEnabled()) {
    if (Validator.isNotNull(emailAddress)) {
      _log.debug("User with the email address " + emailAddress + " was not found in any LDAP servers");
    }
 else {
      _log.debug("User with the screen name " + screenName + " was not found in any LDAP servers");
    }
  }
  return null;
}
