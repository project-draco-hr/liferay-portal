{
  LDAPConfiguration ldapCompanyServiceSettings=_ldapConfigurationSettingsUtil.getLDAPConfiguration(companyId);
  if (Validator.equals(ldapCompanyServiceSettings.importUserSyncStrategy(),_USER_SYNC_STRATEGY_UUID)) {
    ServiceContext serviceContext=ldapUser.getServiceContext();
    return UserLocalServiceUtil.fetchUserByUuidAndCompanyId(serviceContext.getUuid(),companyId);
  }
  String authType=PrefsPropsUtil.getString(companyId,PropsKeys.COMPANY_SECURITY_AUTH_TYPE,PropsValues.COMPANY_SECURITY_AUTH_TYPE);
  if (authType.equals(CompanyConstants.AUTH_TYPE_SN) && !ldapUser.isAutoScreenName()) {
    return UserLocalServiceUtil.fetchUserByScreenName(companyId,ldapUser.getScreenName());
  }
  return UserLocalServiceUtil.fetchUserByEmailAddress(companyId,ldapUser.getEmailAddress());
}
