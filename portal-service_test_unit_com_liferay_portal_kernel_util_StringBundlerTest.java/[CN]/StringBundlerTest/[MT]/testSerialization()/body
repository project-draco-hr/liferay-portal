{
  StringBundler sb=new StringBundler();
  sb.append("test1");
  sb.append("test2");
  sb.append("test3");
  UnsyncByteArrayOutputStream unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream();
  ObjectOutputStream objectOutputStream=new ObjectOutputStream(unsyncByteArrayOutputStream);
  objectOutputStream.writeObject(sb);
  objectOutputStream.close();
  byte[] data=unsyncByteArrayOutputStream.toByteArray();
  UnsyncByteArrayInputStream unsyncByteArrayInputStream=new UnsyncByteArrayInputStream(data);
  ObjectInputStream objectInputStream=new ObjectInputStream(unsyncByteArrayInputStream);
  StringBundler cloneSB=(StringBundler)objectInputStream.readObject();
  objectInputStream.close();
  assertEquals(sb.capacity(),cloneSB.capacity());
  assertEquals(sb.index(),cloneSB.index());
  for (int i=0; i < sb.index(); i++) {
    assertEquals(sb.stringAt(i),cloneSB.stringAt(i));
  }
}
