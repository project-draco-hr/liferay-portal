{
  Set<Long> threadIds=new HashSet<Long>();
  List<Document> docs=new ArrayList<Document>();
  List<Float> scores=new ArrayList<Float>();
  for (int i=0; i < hits.getLength(); i++) {
    Document doc=hits.doc(i);
    Long threadId=GetterUtil.getLong(doc.get("threadId"));
    if (!threadIds.contains(threadId)) {
      threadIds.add(threadId);
      docs.add(hits.doc(i));
      scores.add(hits.score(i));
    }
  }
  hits.setLength(docs.size());
  hits.setDocs(docs.toArray(new Document[docs.size()]));
  hits.setScores(scores.toArray(new Float[scores.size()]));
  hits.setSearchTime((float)(System.currentTimeMillis() - hits.getStart()) / Time.SECOND);
}
