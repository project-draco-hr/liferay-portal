{
  MBMessageDisplay mbMessageDisplay=_mbMessageLocalService.getDiscussionMessageDisplay(userId,groupId,className,classPK,WorkflowConstants.STATUS_APPROVED);
  MBThread mbThread=mbMessageDisplay.getThread();
  ServiceContext serviceContext=serviceContextFunction.apply(MBMessage.class.getName());
  MBMessage mbMessage=_mbMessageLocalService.addDiscussionMessage(userId,userName,groupId,className,classPK,mbThread.getThreadId(),mbThread.getRootMessageId(),subject,body,serviceContext);
  return mbMessage.getMessageId();
}
