{
  MBMessageDisplay messageDisplay=_mbMessageLocalService.getDiscussionMessageDisplay(userId,groupId,className,classPK,WorkflowConstants.STATUS_APPROVED);
  MBThread thread=messageDisplay.getThread();
  List<MBMessage> messages=_mbMessageLocalService.getThreadMessages(thread.getThreadId(),WorkflowConstants.STATUS_APPROVED);
  for (  MBMessage message : messages) {
    String messageBody=message.getBody();
    if (messageBody.equals(messageBody)) {
      throw new DuplicateCommentException();
    }
  }
  _mbMessageLocalService.addDiscussionMessage(userId,StringPool.BLANK,groupId,className,classPK,thread.getThreadId(),thread.getRootMessageId(),StringPool.BLANK,body,serviceContext);
}
