{
  try {
    ActionUtil.getMessageModel(req);
    _sendMessage(req,res);
  }
 catch (  Exception e) {
    if (e != null && e instanceof AddressException || e instanceof MailMessageException || e instanceof SendFailedException) {
      req.setAttribute(PageContext.EXCEPTION,e);
      setForward(req,"portlet.mail.error");
    }
 else {
      req.setAttribute(PageContext.EXCEPTION,e);
      setForward(req,Constants.COMMON_ERROR);
    }
  }
}
