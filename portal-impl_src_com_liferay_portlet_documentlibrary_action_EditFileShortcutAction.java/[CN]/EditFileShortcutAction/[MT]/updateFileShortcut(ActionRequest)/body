{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long fileShortcutId=ParamUtil.getLong(actionRequest,"fileShortcutId");
  long groupId=themeDisplay.getScopeGroupId();
  long folderId=ParamUtil.getLong(actionRequest,"folderId");
  long toFolderId=ParamUtil.getLong(actionRequest,"toFolderId");
  String toName=HtmlUtil.unescape(ParamUtil.getString(actionRequest,"toName"));
  ServiceContext serviceContext=ServiceContextFactory.getInstance(DLFileShortcut.class.getName(),actionRequest);
  if (fileShortcutId <= 0) {
    DLFileShortcut fileShortcut=DLFileShortcutServiceUtil.addFileShortcut(groupId,folderId,toFolderId,toName,serviceContext);
    AssetPublisherUtil.addAndStoreSelection(actionRequest,DLFileShortcut.class.getName(),fileShortcut.getFileShortcutId(),-1);
  }
 else {
    DLFileShortcutServiceUtil.updateFileShortcut(fileShortcutId,folderId,toFolderId,toName,serviceContext);
    AssetPublisherUtil.addRecentFolderId(actionRequest,DLFileShortcut.class.getName(),folderId);
  }
}
