{
  SecurityManager securityManager=System.getSecurityManager();
  if (securityManager == null) {
    return;
  }
  ClassLoader classLoader=ClassLoaderUtil.getClassLoader(implClass);
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
  if (paclPolicy == PACLUtil.getPACLPolicy()) {
    return;
  }
  String classLoaderReferenceId="portal";
  if (paclPolicy != null) {
    classLoaderReferenceId=paclPolicy.getServletContextName();
  }
  Permission permission=new PortalRuntimePermission(PACLConstants.PORTAL_RUNTIME_PERMISSION_GET_CLASSLOADER,null,classLoaderReferenceId);
  securityManager.checkPermission(permission);
}
