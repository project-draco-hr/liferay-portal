{
  Map<String,Object> freeMarkerContext=getFreeMarkerContext(pageContext,portletNamespace,namespace,element,locale);
  freeMarkerContext.put("ignoreRepeatable",Boolean.TRUE);
  Map<String,Object> fieldStructure=(Map<String,Object>)freeMarkerContext.get("fieldStructure");
  DDMFieldsCounter ddmFieldsCounter=getFieldsCounter(pageContext,null,portletNamespace,namespace);
  String name=element.attributeValue("name");
  fieldStructure.put("fieldNamespace",PwdGenerator.getPassword(4));
  fieldStructure.put("valueIndex",ddmFieldsCounter.get(name));
  List<Element> dynamicElementElements=element.elements("dynamic-element");
  StringBundler sb=new StringBundler(dynamicElementElements.size());
  for (  Element dynamicElementElement : dynamicElementElements) {
    String type=dynamicElementElement.attributeValue("type");
    if (!type.equals("option")) {
      sb.append(StringPool.BLANK);
    }
 else {
      sb.append(getFieldHTML(pageContext,dynamicElementElement,portletNamespace,namespace,mode,readOnly,locale));
    }
  }
  fieldStructure.put("children",sb.toString());
  return processFTL(pageContext,element,mode,readOnly,freeMarkerContext);
}
