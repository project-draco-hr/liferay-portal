{
  Map<String,Map<String,Object>> fieldsContext=getFieldsContext(pageContext,portletNamespace,namespace);
  String name=dynamicElementElement.attributeValue("name");
  Map<String,Object> fieldContext=fieldsContext.get(name);
  if (fieldContext != null) {
    return fieldContext;
  }
  Document document=dynamicElementElement.getDocument();
  String xml=document.asXML();
  String[] availableLocales=LocalizationUtil.getAvailableLocales(xml);
  String defaultLanguageId=LocalizationUtil.getDefaultLocale(xml);
  String languageId=LocaleUtil.toLanguageId(locale);
  if (!ArrayUtil.contains(availableLocales,languageId)) {
    languageId=defaultLanguageId;
  }
  Element metadataElement=(Element)dynamicElementElement.selectSingleNode("meta-data[@locale='" + languageId + "']");
  fieldContext=new HashMap<String,Object>();
  if (metadataElement != null) {
    for (    Element metadataEntry : metadataElement.elements()) {
      fieldContext.put(metadataEntry.attributeValue("name"),metadataEntry.getText());
    }
  }
  for (  Attribute attribute : dynamicElementElement.attributes()) {
    fieldContext.put(attribute.getName(),attribute.getValue());
  }
  fieldContext.put("fieldNamespace",PwdGenerator.getPassword(4));
  fieldsContext.put(name,fieldContext);
  return fieldContext;
}
