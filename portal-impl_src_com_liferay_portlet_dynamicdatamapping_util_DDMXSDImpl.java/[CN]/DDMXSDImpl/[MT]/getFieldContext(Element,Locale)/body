{
  Document document=dynamicElementElement.getDocument();
  String[] availableLocales=LocalizationUtil.getAvailableLocales(document.asXML());
  String defaultLocale=LocalizationUtil.getDefaultLocale(document.asXML());
  String languageId=LocaleUtil.toLanguageId(locale);
  if (!ArrayUtil.contains(availableLocales,languageId)) {
    languageId=defaultLocale;
  }
  Element metadataElement=(Element)dynamicElementElement.selectSingleNode("meta-data[@locale='" + languageId + "']");
  Map<String,Object> field=new HashMap<String,Object>();
  if (metadataElement != null) {
    for (    Element metadataEntry : metadataElement.elements()) {
      field.put(metadataEntry.attributeValue("name"),metadataEntry.getText());
    }
  }
  for (  Attribute attribute : dynamicElementElement.attributes()) {
    field.put(attribute.getName(),attribute.getValue());
  }
  return field;
}
