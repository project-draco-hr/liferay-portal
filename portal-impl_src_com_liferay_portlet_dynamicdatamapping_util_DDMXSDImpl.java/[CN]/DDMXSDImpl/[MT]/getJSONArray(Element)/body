{
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  Document document=element.getDocument();
  String defaultLocale=LocalizationUtil.getDefaultLocale(document.asXML());
  List<Element> dynamicElementElements=element.elements("dynamic-element");
  for (  Element dynamicElementElement : dynamicElementElements) {
    JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
    JSONObject localizationMapJSONObject=JSONFactoryUtil.createJSONObject();
    for (    Attribute attribute : dynamicElementElement.attributes()) {
      jsonObject.put(attribute.getName(),attribute.getValue());
    }
    String type=jsonObject.getString("type");
    jsonObject.put("id",dynamicElementElement.attributeValue("name"));
    List<Element> metadataElements=dynamicElementElement.elements("meta-data");
    for (    Element metadataElement : metadataElements) {
      if (metadataElement == null) {
        continue;
      }
      String locale=metadataElement.attributeValue("locale");
      JSONObject localeMap=JSONFactoryUtil.createJSONObject();
      for (      Element metadataEntryElement : metadataElement.elements()) {
        String attributeName=metadataEntryElement.attributeValue("name");
        String attributeValue=metadataEntryElement.getText();
        putMetadataValue(localeMap,attributeName,attributeValue,type);
        if (defaultLocale.equals(locale)) {
          putMetadataValue(jsonObject,attributeName,attributeValue,type);
        }
      }
      localizationMapJSONObject.put(locale,localeMap);
    }
    jsonObject.put("localizationMap",localizationMapJSONObject);
    JSONArray hiddenAttributesJSONArray=JSONFactoryUtil.createJSONArray();
    if (type.equals(DDMImpl.TYPE_CHECKBOX)) {
      hiddenAttributesJSONArray.put("required");
    }
    if (type.equals(DDMImpl.TYPE_DDM_FILEUPLOAD)) {
      hiddenAttributesJSONArray.put("predefinedValue");
    }
    hiddenAttributesJSONArray.put("readOnly");
    jsonObject.put("hiddenAttributes",hiddenAttributesJSONArray);
    String key="fields";
    if (type.equals(DDMImpl.TYPE_RADIO) || type.equals(DDMImpl.TYPE_SELECT)) {
      key="options";
    }
    jsonObject.put(key,getJSONArray(dynamicElementElement));
    jsonArray.put(jsonObject);
  }
  return jsonArray;
}
