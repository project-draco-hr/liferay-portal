{
  List imageContents=el.elements("dynamic-content");
  Iterator itr=imageContents.listIterator();
  while (itr.hasNext()) {
    Element dynamicContent=(Element)itr.next();
    String elLanguage=dynamicContent.attributeValue("language-id",StringPool.BLANK);
    if (!elLanguage.equals(StringPool.BLANK)) {
      elLanguage="_" + elLanguage;
    }
    long imageId=JournalArticleImageLocalServiceUtil.getArticleImageId(groupId,articleId,version,elName,elLanguage);
    double oldVersion=MathUtil.format(version - 0.1,1,1);
    long oldImageId=JournalArticleImageLocalServiceUtil.getArticleImageId(groupId,articleId,oldVersion,elName,elLanguage);
    String elContent="/image/journal/article?img_id=" + imageId;
    if (dynamicContent.getText().equals("delete")) {
      dynamicContent.setText(StringPool.BLANK);
      ImageLocalUtil.deleteImage(imageId);
      String defaultElLanguage="";
      if (!Validator.isNotNull(elLanguage)) {
        defaultElLanguage="_" + LocaleUtil.toLanguageId(Locale.getDefault());
      }
      long defaultImageId=JournalArticleImageLocalServiceUtil.getArticleImageId(groupId,articleId,version,elName,defaultElLanguage);
      ImageLocalUtil.deleteImage(defaultImageId);
      continue;
    }
    byte[] bytes=(byte[])images.get(elName + elLanguage);
    if (bytes != null && (bytes.length > 0)) {
      dynamicContent.setText(elContent);
      dynamicContent.addAttribute("id",String.valueOf(imageId));
      ImageLocalUtil.updateImage(imageId,bytes);
      continue;
    }
    if ((version > JournalArticleImpl.DEFAULT_VERSION) && (incrementVersion)) {
      Image oldImage=ImageLocalUtil.getImage(oldImageId);
      if (oldImage != null) {
        dynamicContent.setText(elContent);
        dynamicContent.addAttribute("id",String.valueOf(imageId));
        bytes=oldImage.getTextObj();
        ImageLocalUtil.updateImage(imageId,bytes);
      }
      continue;
    }
    Image image=ImageLocalUtil.getImage(imageId);
    if (image != null) {
      dynamicContent.setText(elContent);
      dynamicContent.addAttribute("id",String.valueOf(imageId));
      continue;
    }
    String defaultElLanguage="";
    if (!Validator.isNotNull(elLanguage)) {
      defaultElLanguage="_" + LocaleUtil.toLanguageId(Locale.getDefault());
    }
    long defaultImageId=JournalArticleImageLocalServiceUtil.getArticleImageId(groupId,articleId,version,elName,defaultElLanguage);
    Image defaultImage=ImageLocalUtil.getImage(defaultImageId);
    if (defaultImage != null) {
      dynamicContent.setText(elContent);
      dynamicContent.addAttribute("id",String.valueOf(imageId));
      bytes=defaultImage.getTextObj();
      ImageLocalUtil.updateImage(imageId,bytes);
      continue;
    }
    dynamicContent.setText(StringPool.BLANK);
  }
}
