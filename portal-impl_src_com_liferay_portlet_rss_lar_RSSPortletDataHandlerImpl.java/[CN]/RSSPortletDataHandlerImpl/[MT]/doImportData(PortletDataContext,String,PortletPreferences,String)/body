{
  if (Validator.isNull(data)) {
    return null;
  }
  Document document=SAXReaderUtil.read(data);
  Element rootElement=document.getRootElement();
  JournalPortletDataHandlerImpl.importReferencedData(portletDataContext,rootElement);
  List<Element> structureElements=rootElement.elements("structure");
  for (  Element structureElement : structureElements) {
    JournalPortletDataHandlerImpl.importStructure(portletDataContext,structureElement);
  }
  List<Element> templateElements=rootElement.elements("template");
  for (  Element templateElement : templateElements) {
    JournalPortletDataHandlerImpl.importTemplate(portletDataContext,templateElement);
  }
  Layout layout=LayoutLocalServiceUtil.getLayout(portletDataContext.getPlid());
  Element footerArticleElement=rootElement.element("footer-article");
  if (footerArticleElement != null) {
    JournalPortletDataHandlerImpl.importArticle(portletDataContext,footerArticleElement);
  }
  String[] footerArticleValues=portletPreferences.getValues("footerArticleValues",new String[]{"0",""});
  String footerArticleId=footerArticleValues[1];
  Map<String,String> articleIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalArticle.class + ".articleId");
  footerArticleId=MapUtil.getString(articleIds,footerArticleId,footerArticleId);
  if (Validator.isNotNull(footerArticleId)) {
    footerArticleId=MapUtil.getString(articleIds,footerArticleId,footerArticleId);
    portletPreferences.setValues("footerArticleValues",new String[]{String.valueOf(portletDataContext.getScopeGroupId()),footerArticleId});
    JournalContentSearchLocalServiceUtil.updateContentSearch(portletDataContext.getScopeGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,footerArticleId,true);
  }
  Element headerArticleElement=rootElement.element("header-article");
  if (headerArticleElement != null) {
    JournalPortletDataHandlerImpl.importArticle(portletDataContext,headerArticleElement);
  }
  String[] headerArticleValues=portletPreferences.getValues("headerArticleValues",new String[]{"0",""});
  String headerArticleId=headerArticleValues[1];
  articleIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalArticle.class + ".articleId");
  headerArticleId=MapUtil.getString(articleIds,headerArticleId,headerArticleId);
  if (Validator.isNotNull(headerArticleId)) {
    headerArticleId=MapUtil.getString(articleIds,headerArticleId,headerArticleId);
    portletPreferences.setValues("headerArticleValues",new String[]{String.valueOf(portletDataContext.getScopeGroupId()),headerArticleId});
    JournalContentSearchLocalServiceUtil.updateContentSearch(portletDataContext.getScopeGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,headerArticleId,true);
  }
  return portletPreferences;
}
