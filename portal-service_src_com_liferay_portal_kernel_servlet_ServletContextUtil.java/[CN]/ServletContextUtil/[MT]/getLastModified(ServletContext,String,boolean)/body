{
  if (cache) {
    Long lastModified=(Long)servletContext.getAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + path);
    if (lastModified != null) {
      return lastModified.longValue();
    }
  }
  long lastModified=0;
  Queue<String> tempPaths=new LinkedList<String>();
  String tempPath=path;
  while (tempPath != null) {
    if (tempPath.endsWith(StringPool.SLASH)) {
      Set<String> s=servletContext.getResourcePaths(tempPath);
      tempPaths.addAll(s);
    }
 else {
      try {
        URL url=servletContext.getResource(tempPath);
        if (url == null) {
          _log.error("Resource URL for " + tempPath + " is null");
        }
 else {
          URLConnection urlConnection=url.openConnection();
          long urlModified=urlConnection.getLastModified();
          if (urlModified > lastModified) {
            lastModified=urlModified;
          }
        }
      }
 catch (      IOException ioe) {
        _log.error(ioe,ioe);
      }
    }
    tempPath=tempPaths.poll();
  }
  if (cache) {
    servletContext.setAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + path,new Long(lastModified));
  }
  return lastModified;
}
