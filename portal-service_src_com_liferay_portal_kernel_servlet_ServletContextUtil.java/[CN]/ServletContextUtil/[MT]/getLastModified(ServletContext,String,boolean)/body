{
  if (cache) {
    Long lastModified=(Long)servletContext.getAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + path);
    if (lastModified != null) {
      return lastModified.longValue();
    }
  }
  long lastModified=0;
  Set<String> paths=null;
  if (path.endsWith(StringPool.SLASH)) {
    paths=servletContext.getResourcePaths(path);
  }
 else {
    paths=new HashSet<String>();
    paths.add(path);
  }
  if ((paths == null) || paths.isEmpty()) {
    if (cache) {
      servletContext.setAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + path,new Long(lastModified));
    }
    return lastModified;
  }
  for (  String curPath : paths) {
    if (curPath.endsWith(StringPool.SLASH)) {
      long curLastModified=getLastModified(servletContext,curPath);
      if (curLastModified > lastModified) {
        lastModified=curLastModified;
      }
    }
 else {
      try {
        URL url=servletContext.getResource(curPath);
        if (url == null) {
          _log.error("Resource URL for " + curPath + " is null");
          continue;
        }
        URLConnection urlConnection=url.openConnection();
        if (urlConnection.getLastModified() > lastModified) {
          lastModified=urlConnection.getLastModified();
        }
      }
 catch (      IOException ioe) {
        _log.error(ioe,ioe);
      }
    }
  }
  if (cache) {
    servletContext.setAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + path,new Long(lastModified));
  }
  return lastModified;
}
