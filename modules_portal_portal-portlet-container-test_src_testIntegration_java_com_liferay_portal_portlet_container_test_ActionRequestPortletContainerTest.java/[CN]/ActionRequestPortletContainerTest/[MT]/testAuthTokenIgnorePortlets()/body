{
  Field field=ReflectionUtil.getDeclaredField(PropsValues.class,"AUTH_TOKEN_IGNORE_PORTLETS");
  Object value=field.get(null);
  try {
    field.set(null,new String[]{TEST_PORTLET_ID});
    AuthTokenWhitelistUtil.resetPortletCSRFWhitelist();
    setUpPortlet(testPortlet,new HashMapDictionary<String,Object>(),TEST_PORTLET_ID);
    HttpServletRequest httpServletRequest=PortletContainerTestUtil.getHttpServletRequest(group,layout);
    PortletURL portletURL=new PortletURLImpl(httpServletRequest,TEST_PORTLET_ID,layout.getPlid(),PortletRequest.ACTION_PHASE);
    Map<String,List<String>> responseMap=PortletContainerTestUtil.request(portletURL.toString());
    Assert.assertEquals("200",PortletContainerTestUtil.getString(responseMap,"code"));
    Assert.assertTrue(testPortlet.isActionCalled());
  }
  finally {
    field.set(null,value);
    AuthTokenWhitelistUtil.resetPortletCSRFWhitelist();
  }
}
