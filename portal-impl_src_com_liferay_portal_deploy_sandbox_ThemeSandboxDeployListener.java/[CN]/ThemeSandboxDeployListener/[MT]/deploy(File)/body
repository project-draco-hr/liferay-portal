{
  try {
    if (!_isEnabled(dir)) {
      return;
    }
    String dirName=dir.getName();
    if (_log.isInfoEnabled()) {
      _log.info("Deploying " + dirName);
    }
    _copyTheme(dir);
    String themeName=_createThemeName(dirName);
    _createPluginPackageProperties(dir,themeName);
    PluginPackage pluginPackage=readPluginPackage(dir);
    String displayName=_createDisplayName(dirName);
    processPluginPackageProperties(dir,displayName,pluginPackage);
    copyJars(dir,pluginPackage);
    copyProperties(dir,pluginPackage);
    copyTlds(dir,pluginPackage);
    copyXmls(dir,displayName,pluginPackage);
    updateWebXml(new File(dir,"WEB-INF/web.xml"),dir,displayName,pluginPackage);
    _createContextXml(dir);
  }
 catch (  Exception e) {
    throw new SandboxDeployException(e);
  }
}
