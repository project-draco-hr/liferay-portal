{
  try {
    String exporterType=ParamUtil.get(req,"exporter_type",ABUtil.IE_OUTLOOK);
    Exporter exporter=null;
    if (exporterType.equals(ABUtil.IE_OUTLOOK)) {
      exporter=new OutlookExporter();
    }
 else     if (exporterType.equals(ABUtil.IE_YAHOO)) {
      exporter=new YahooExporter();
    }
    if (exporter != null) {
      exporter.setContacts((ABContact[])ABContactServiceUtil.getContacts().toArray(new ABContact[0]));
      String fileName=exporter.getFileName();
      byte[] byteArray=exporter.getData();
      ServletResponseUtil.sendFile(res,fileName,byteArray);
    }
    return null;
  }
 catch (  Exception e) {
    req.setAttribute(PageContext.EXCEPTION,e);
    return mapping.findForward(Constants.COMMON_ERROR);
  }
}
