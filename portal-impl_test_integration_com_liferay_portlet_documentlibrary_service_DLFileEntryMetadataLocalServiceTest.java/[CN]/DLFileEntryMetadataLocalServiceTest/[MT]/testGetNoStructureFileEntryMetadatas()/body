{
  try {
    DLFileVersion dlFileVersion=_dlFileEntry.getFileVersion();
    DLFileEntryMetadata dlFileEntryMetadata=DLFileEntryMetadataLocalServiceUtil.fetchFileEntryMetadata(_ddmStructure.getStructureId(),dlFileVersion.getFileVersionId());
    DDMStructureLocalServiceUtil.deleteDDMStructure(_ddmStructure);
    List<DLFileEntryMetadata> dlFileEntryMetadatas=DLFileEntryMetadataLocalServiceUtil.getNoStructureFileEntryMetadatas();
    Assert.assertEquals(1,dlFileEntryMetadatas.size());
    Assert.assertEquals(dlFileEntryMetadata,dlFileEntryMetadatas.get(0));
  }
  finally {
    if (_ddmStructure != null) {
      DDMStructureLocalServiceUtil.addDDMStructure(_ddmStructure);
    }
  }
}
