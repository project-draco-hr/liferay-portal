{
  Locale locale=null;
  PortletConfig configPortletConfig=null;
  if (pageContext == null) {
    return null;
  }
  HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (themeDisplay != null) {
    locale=themeDisplay.getLocale();
  }
 else {
    locale=request.getLocale();
    if (!isAvailableLocale(locale)) {
      locale=LocaleUtil.getDefault();
    }
  }
  configPortletConfig=(PortletConfig)request.getAttribute(JavaConstants.JAVAX_PORTLET_CONFIG);
  if (configPortletConfig != null) {
    ResourceBundle configResourceBundle=configPortletConfig.getResourceBundle(locale);
    return configResourceBundle;
  }
  return null;
}
