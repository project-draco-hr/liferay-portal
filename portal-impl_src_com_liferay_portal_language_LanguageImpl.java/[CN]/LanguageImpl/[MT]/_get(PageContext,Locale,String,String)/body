{
  if (key == null) {
    return null;
  }
  String value=null;
  if (pageContext != null) {
    HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    locale=themeDisplay.getLocale();
    PortletConfig portletConfig=(PortletConfig)request.getAttribute(JavaConstants.JAVAX_PORTLET_CONFIG);
    if (portletConfig != null) {
      ResourceBundle resourceBundle=portletConfig.getResourceBundle(locale);
      try {
        value=resourceBundle.getString(key);
      }
 catch (      MissingResourceException mre) {
      }
      if (((value == null) || (value.equals(defaultValue))) && (portletConfig.getPortletName().equals(PortletKeys.PORTLET_CONFIGURATION))) {
        try {
          value=_getPortletConfigurationValue(pageContext,locale,key);
        }
 catch (        MissingResourceException mre) {
        }
      }
    }
  }
  if ((value == null) || value.equals(defaultValue)) {
    if (LanguageResources.isInitializing()) {
      ResourceBundle resourceBundle=ResourceBundle.getBundle("content/Language",locale);
      try {
        value=resourceBundle.getString(key);
      }
 catch (      MissingResourceException mre) {
      }
    }
 else {
      value=LanguageResources.getMessage(locale,key);
    }
  }
  if ((value == null) || value.equals(defaultValue)) {
    if (key.endsWith(StringPool.CLOSE_BRACKET)) {
      int pos=key.lastIndexOf(StringPool.OPEN_BRACKET);
      if (pos != -1) {
        key=key.substring(0,pos);
        return _get(pageContext,locale,key,defaultValue);
      }
    }
  }
  if (value == null) {
    value=defaultValue;
  }
  return value;
}
