{
  ServiceContext serviceContext=getInstance(request);
  String[] groupPermissions=PortalUtil.getGroupPermissions(request,className);
  String[] guestPermissions=PortalUtil.getGuestPermissions(request,className);
  if (groupPermissions != null) {
    serviceContext.setGroupPermissions(groupPermissions);
  }
  if (guestPermissions != null) {
    serviceContext.setGuestPermissions(guestPermissions);
  }
  Map<String,Serializable> expandoBridgeAttributes=PortalUtil.getExpandoBridgeAttributes(ExpandoBridgeFactoryUtil.getExpandoBridge(serviceContext.getCompanyId(),className),request);
  serviceContext.setExpandoBridgeAttributes(expandoBridgeAttributes);
  return serviceContext;
}
