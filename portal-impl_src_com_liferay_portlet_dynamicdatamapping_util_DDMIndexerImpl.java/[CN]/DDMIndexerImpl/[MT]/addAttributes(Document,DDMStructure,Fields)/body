{
  Iterator<Field> itr=fields.iterator();
  while (itr.hasNext()) {
    Field field=itr.next();
    try {
      String indexType=ddmStructure.getFieldProperty(field.getName(),"indexType");
      if (Validator.isNull(indexType)) {
        continue;
      }
      String name=encodeName(ddmStructure.getStructureId(),field.getName());
      Serializable value=field.getValue();
      if (value instanceof Boolean) {
        document.addKeyword(name,(Boolean)value);
      }
 else       if (value instanceof Date) {
        document.addDate(name,(Date)value);
      }
 else       if (value instanceof Double) {
        document.addKeyword(name,(Double)value);
      }
 else       if (value instanceof Integer) {
        document.addKeyword(name,(Integer)value);
      }
 else {
        String valueString=String.valueOf(value);
        if (indexType.equals("keyword")) {
          document.addKeyword(name,valueString);
        }
 else {
          document.addText(name,valueString);
        }
      }
    }
 catch (    StructureFieldException e) {
    }
  }
}
