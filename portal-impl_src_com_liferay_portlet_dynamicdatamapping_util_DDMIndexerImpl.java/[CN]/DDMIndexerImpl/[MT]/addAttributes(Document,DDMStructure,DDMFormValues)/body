{
  long groupId=GetterUtil.getLong(document.get(com.liferay.portal.kernel.search.Field.GROUP_ID));
  Locale[] locales=LanguageUtil.getAvailableLocales(groupId);
  Fields fields=toFields(ddmStructure,ddmFormValues);
  for (  Field field : fields) {
    try {
      String indexType=ddmStructure.getFieldProperty(field.getName(),"indexType");
      if (Validator.isNull(indexType)) {
        continue;
      }
      for (      Locale locale : locales) {
        String name=encodeName(ddmStructure.getStructureId(),field.getName(),locale);
        Serializable value=field.getValue(locale);
        if (value instanceof BigDecimal) {
          document.addNumber(name,(BigDecimal)value);
        }
 else         if (value instanceof BigDecimal[]) {
          document.addNumber(name,(BigDecimal[])value);
        }
 else         if (value instanceof Boolean) {
          document.addKeyword(name,(Boolean)value);
        }
 else         if (value instanceof Boolean[]) {
          document.addKeyword(name,(Boolean[])value);
        }
 else         if (value instanceof Date) {
          document.addDate(name,(Date)value);
        }
 else         if (value instanceof Date[]) {
          document.addDate(name,(Date[])value);
        }
 else         if (value instanceof Double) {
          document.addNumber(name,(Double)value);
        }
 else         if (value instanceof Double[]) {
          document.addNumber(name,(Double[])value);
        }
 else         if (value instanceof Integer) {
          document.addNumber(name,(Integer)value);
        }
 else         if (value instanceof Integer[]) {
          document.addNumber(name,(Integer[])value);
        }
 else         if (value instanceof Long) {
          document.addNumber(name,(Long)value);
        }
 else         if (value instanceof Long[]) {
          document.addNumber(name,(Long[])value);
        }
 else         if (value instanceof Float) {
          document.addNumber(name,(Float)value);
        }
 else         if (value instanceof Float[]) {
          document.addNumber(name,(Float[])value);
        }
 else         if (value instanceof Number[]) {
          document.addNumber(name,(Number[])value);
        }
 else         if (value instanceof Object[]) {
          String[] valuesString=ArrayUtil.toStringArray((Object[])value);
          if (indexType.equals("keyword")) {
            document.addKeyword(name,valuesString);
          }
 else {
            document.addText(name,valuesString);
          }
        }
 else {
          String valueString=String.valueOf(value);
          String type=field.getType();
          if (type.equals(DDMImpl.TYPE_RADIO) || type.equals(DDMImpl.TYPE_SELECT)) {
            JSONArray jsonArray=JSONFactoryUtil.createJSONArray(valueString);
            String[] stringArray=ArrayUtil.toStringArray(jsonArray);
            if (indexType.equals("keyword")) {
              document.addKeyword(name,stringArray);
            }
 else {
              document.addText(name,stringArray);
            }
          }
 else {
            if (type.equals(DDMImpl.TYPE_DDM_TEXT_HTML)) {
              valueString=HtmlUtil.extractText(valueString);
            }
            if (indexType.equals("keyword")) {
              document.addKeyword(name,valueString);
            }
 else {
              document.addText(name,valueString);
            }
          }
        }
      }
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
}
