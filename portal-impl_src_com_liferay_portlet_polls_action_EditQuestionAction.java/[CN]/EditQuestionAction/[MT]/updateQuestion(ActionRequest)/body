{
  long questionId=ParamUtil.getLong(actionRequest,"questionId");
  Map<Locale,String> localeTitlesMap=LocalizationUtil.getLocalizedParameter(actionRequest,"title");
  Map<Locale,String> localeDescriptionsMap=LocalizationUtil.getLocalizedParameter(actionRequest,"description");
  int expirationDateMonth=ParamUtil.getInteger(actionRequest,"expirationDateMonth");
  int expirationDateDay=ParamUtil.getInteger(actionRequest,"expirationDateDay");
  int expirationDateYear=ParamUtil.getInteger(actionRequest,"expirationDateYear");
  int expirationDateHour=ParamUtil.getInteger(actionRequest,"expirationDateHour");
  int expirationDateMinute=ParamUtil.getInteger(actionRequest,"expirationDateMinute");
  int expirationDateAmPm=ParamUtil.getInteger(actionRequest,"expirationDateAmPm");
  boolean neverExpire=ParamUtil.getBoolean(actionRequest,"neverExpire");
  if (expirationDateAmPm == Calendar.PM) {
    expirationDateHour+=12;
  }
  List<PollsChoice> choices=new ArrayList<PollsChoice>();
  Enumeration<String> enu=actionRequest.getParameterNames();
  List<String> parametersRead=new ArrayList<String>();
  while (enu.hasMoreElements()) {
    String param=enu.nextElement();
    if (param.startsWith(CHOICE_DESCRIPTION_PREFIX)) {
      try {
        String id=param.substring(CHOICE_DESCRIPTION_PREFIX.length(),param.indexOf(StringPool.UNDERLINE));
        if (parametersRead.contains(id)) {
          continue;
        }
        String choiceName=ParamUtil.getString(actionRequest,CHOICE_NAME_PREFIX + id);
        Map<Locale,String> localeChoiceDescriptionsMap=LocalizationUtil.getLocalizedParameter(actionRequest,CHOICE_DESCRIPTION_PREFIX + id);
        PollsChoice choice=PollsChoiceUtil.create(0);
        choice.setName(choiceName);
        setLocalizedAttributes(choice,localeChoiceDescriptionsMap);
        choices.add(choice);
        parametersRead.add(id);
      }
 catch (      Exception e) {
      }
    }
  }
  ServiceContext serviceContext=ServiceContextFactory.getInstance(BookmarksEntry.class.getName(),actionRequest);
  if (questionId <= 0) {
    PollsQuestionServiceUtil.addQuestion(localeTitlesMap,localeDescriptionsMap,expirationDateMonth,expirationDateDay,expirationDateYear,expirationDateHour,expirationDateMinute,neverExpire,choices,serviceContext);
  }
 else {
    PollsQuestionServiceUtil.updateQuestion(questionId,localeTitlesMap,localeDescriptionsMap,expirationDateMonth,expirationDateDay,expirationDateYear,expirationDateHour,expirationDateMinute,neverExpire,choices,serviceContext);
  }
}
