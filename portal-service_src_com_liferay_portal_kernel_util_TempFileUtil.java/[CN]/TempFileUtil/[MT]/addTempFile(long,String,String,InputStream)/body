{
  File file=null;
  if (inputStream instanceof ByteArrayFileInputStream) {
    ByteArrayFileInputStream byteArrayFileInputStream=(ByteArrayFileInputStream)inputStream;
    file=byteArrayFileInputStream.getFile();
    DLStoreUtil.validate(fileName,true,file);
  }
 else {
    DLStoreUtil.validate(fileName,true,inputStream);
  }
  File tempFile=getTempFile(userId,fileName,tempPathName);
  if (file != null) {
    FileUtil.copyFile(file,tempFile);
  }
 else {
    FileUtil.write(tempFile,inputStream);
  }
  return fileName;
}
