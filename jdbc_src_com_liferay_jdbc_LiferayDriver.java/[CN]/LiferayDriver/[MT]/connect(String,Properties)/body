{
  if (_driver == null) {
    _log.fine("Driver is null");
    try {
      _log.fine("Url " + url);
      int x=url.indexOf(":");
      int y=url.indexOf(":",x + 1);
      String jdbcType=url.substring(x + 1,y);
      _log.fine("Type " + jdbcType);
      if (jdbcType.equals("db2")) {
        _db2=true;
      }
      String driverClassName=_getJDBCProperties().getProperty(jdbcType);
      _log.fine("Class name " + jdbcType);
      Class driverClass=Class.forName(driverClassName);
      _driver=(Driver)driverClass.newInstance();
    }
 catch (    Exception e) {
      throw new SQLException(e.getMessage());
    }
  }
 else {
    _log.fine("Driver is not null");
  }
  Connection con=_driver.connect(url,props);
  _log.fine("Connecting " + con);
  return new LiferayConnection(con,_db2);
}
