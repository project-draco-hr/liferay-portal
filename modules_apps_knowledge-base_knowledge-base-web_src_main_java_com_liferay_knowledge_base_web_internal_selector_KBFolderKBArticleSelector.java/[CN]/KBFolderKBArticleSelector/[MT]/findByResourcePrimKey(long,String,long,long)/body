{
  KBFolder ancestorKBFolder=_rootKBFolder;
  if (ancestorResourcePrimKey != KBFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    ancestorKBFolder=_kbFolderLocalService.fetchKBFolder(ancestorResourcePrimKey);
    if (ancestorKBFolder == null) {
      return new KBArticleSelection(null,false);
    }
  }
  KBArticle kbArticle=_kbArticleLocalService.fetchLatestKBArticle(resourcePrimKey,WorkflowConstants.STATUS_APPROVED);
  if ((kbArticle == null) || !isDescendant(kbArticle,ancestorKBFolder)) {
    KBArticleSelection kbArticleSelection=findFirstKBArticle(groupId,ancestorKBFolder,preferredKBFolderUrlTitle);
    if (resourcePrimKey == 0) {
      kbArticleSelection.setExactMatch(true);
    }
    return kbArticleSelection;
  }
  return new KBArticleSelection(kbArticle,true);
}
