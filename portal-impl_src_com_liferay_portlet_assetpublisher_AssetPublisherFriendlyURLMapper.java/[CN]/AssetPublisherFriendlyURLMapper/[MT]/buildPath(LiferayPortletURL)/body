{
  String friendlyURLPath=null;
  String strutsAction=GetterUtil.getString(portletURL.getParameter("struts_action"));
  WindowState windowState=portletURL.getWindowState();
  if ((strutsAction.equals("/asset_publisher/view_content")) && ((windowState == null) || (!windowState.equals(LiferayWindowState.EXCLUSIVE) && !windowState.equals(LiferayWindowState.POP_UP)))) {
    String portletId=portletURL.getPortletId();
    String assetEntryId=portletURL.getParameter("assetEntryId");
    String type=GetterUtil.getString(portletURL.getParameter("type"),"content");
    long groupId=GetterUtil.getLong(portletURL.getParameter("groupId"));
    String urlTitle=portletURL.getParameter("urlTitle");
    if (Validator.isNotNull(portletId) && Validator.isNotNull(assetEntryId)) {
      if (portletId.equals(_PORTLET_DEFAULT_INSTANCE)) {
        portletId=_PORTLET_ID;
      }
      int pos=portletId.indexOf(PortletConstants.INSTANCE_SEPARATOR);
      String instanceId=null;
      if (pos > 0) {
        instanceId=portletId.substring(pos + 10);
      }
 else {
        instanceId=portletId;
      }
      friendlyURLPath="/asset_publisher/" + instanceId + StringPool.SLASH+ type+ StringPool.SLASH;
      if (Validator.isNotNull(urlTitle)) {
        friendlyURLPath+=urlTitle;
        portletURL.addParameterIncludedInPath("urlTitle");
        if (groupId > 0) {
          friendlyURLPath+=StringPool.SLASH + groupId;
          portletURL.addParameterIncludedInPath("groupId");
        }
      }
 else {
        friendlyURLPath+="id/" + assetEntryId;
      }
      portletURL.addParameterIncludedInPath("type");
      portletURL.addParameterIncludedInPath("assetEntryId");
    }
  }
 else   if (windowState.equals(WindowState.MAXIMIZED)) {
    friendlyURLPath+=StringPool.SLASH + windowState;
  }
  if (Validator.isNotNull(friendlyURLPath)) {
    portletURL.addParameterIncludedInPath("p_p_id");
    portletURL.addParameterIncludedInPath("struts_action");
  }
  return friendlyURLPath;
}
