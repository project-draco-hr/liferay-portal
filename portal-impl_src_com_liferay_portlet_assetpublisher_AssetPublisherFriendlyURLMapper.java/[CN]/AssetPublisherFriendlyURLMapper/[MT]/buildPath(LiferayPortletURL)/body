{
  String friendlyURLPath=null;
  String strutsAction=GetterUtil.getString(portletURL.getParameter("struts_action"));
  WindowState windowState=portletURL.getWindowState();
  if ((strutsAction.equals("/asset_publisher/view_content")) && ((windowState == null) || (!windowState.equals(LiferayWindowState.EXCLUSIVE)))) {
    String portletId=portletURL.getPortletId();
    String assetId=portletURL.getParameter("assetId");
    String type=GetterUtil.getString(portletURL.getParameter("type"),"content");
    String urlTitle=portletURL.getParameter("urlTitle");
    if (Validator.isNotNull(portletId) && Validator.isNotNull(assetId)) {
      if (portletId.equals(_PORTLET_DEFAULT_INSTANCE)) {
        portletId=_PORTLET_ID;
      }
      int pos=portletId.indexOf("_INSTANCE_");
      String instanceId=null;
      if (pos > 0) {
        instanceId=portletId.substring(pos + 10);
      }
 else {
        instanceId=portletId;
      }
      friendlyURLPath="/asset_publisher/" + instanceId + StringPool.SLASH+ type+ StringPool.SLASH;
      if (Validator.isNotNull(urlTitle)) {
        friendlyURLPath+=urlTitle;
        portletURL.addParameterIncludedInPath("urlTitle");
      }
 else {
        friendlyURLPath+="id/" + assetId;
      }
      portletURL.addParameterIncludedInPath("type");
      portletURL.addParameterIncludedInPath("assetId");
    }
  }
  if (Validator.isNotNull(friendlyURLPath)) {
    portletURL.addParameterIncludedInPath("p_p_id");
    portletURL.addParameterIncludedInPath("struts_action");
  }
  return friendlyURLPath;
}
