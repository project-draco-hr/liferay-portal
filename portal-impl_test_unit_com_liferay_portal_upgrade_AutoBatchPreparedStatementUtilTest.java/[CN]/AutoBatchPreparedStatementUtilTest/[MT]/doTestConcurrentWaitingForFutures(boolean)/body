{
  TestNoticeableFuture<Void> testNoticeableFuture=new TestNoticeableFuture<>();
  ConnectionInvocationHandler connectionInvocationHandler=new ConnectionInvocationHandler(new PreparedStatementInvocationHandler(supportBatchUpdates));
  try (PreparedStatement preparedStatement=AutoBatchPreparedStatementUtil.concurrentAutoBatch((Connection)ProxyUtil.newProxyInstance(ClassLoader.getSystemClassLoader(),new Class<?>[]{Connection.class},connectionInvocationHandler),StringPool.BLANK)){
    Set<Future<Void>> futures=new HashSet<>();
    futures.add(testNoticeableFuture);
    InvocationHandler invocationHandler=ProxyUtil.getInvocationHandler(preparedStatement);
    ReflectionTestUtil.setFieldValue(invocationHandler,"_futures",futures);
  }
   Assert.assertTrue(testNoticeableFuture.hasCalledGet());
}
