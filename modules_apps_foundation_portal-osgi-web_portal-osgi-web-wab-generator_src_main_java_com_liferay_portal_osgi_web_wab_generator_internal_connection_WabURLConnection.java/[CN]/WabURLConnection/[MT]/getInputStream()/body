{
  URL url=getURL();
  String query=url.getQuery();
  Map<String,String[]> parameters=HttpUtil.getParameterMap(query);
  if (!parameters.containsKey("Web-ContextPath")) {
    throw new IllegalArgumentException("The parameter map does not contain the required parameter " + "Web-ContextPath");
  }
  File file=transferToTempFile(new URL(url.getPath()));
  _wabGenerator.generate(_classLoader,file,parameters);
  try {
    WabProcessor wabProcessor=new WabProcessor(_classLoader,file,parameters);
    File processedFile=wabProcessor.getProcessedFile();
    return new FileInputStream(processedFile);
  }
  finally {
    FileUtil.deltree(file.getParentFile());
  }
}
