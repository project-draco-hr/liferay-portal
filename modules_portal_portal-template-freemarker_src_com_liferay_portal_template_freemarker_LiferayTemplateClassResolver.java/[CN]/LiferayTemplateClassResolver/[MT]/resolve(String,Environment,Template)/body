{
  if (className.equals(ObjectConstructor.class.getName())) {
    throw new TemplateException("Instantiating " + className + " is not allowed in the "+ "template for security reasons",environment);
  }
  for (  String restrictedClassName : _freemarkerEngineConfiguration.getRestrictedClasses()) {
    if (className.equals(restrictedClassName)) {
      throw new TemplateException("Instantiating " + className + " is not allowed in the "+ "template for security reasons",environment);
    }
  }
  for (  String restrictedPackageName : _freemarkerEngineConfiguration.getRestrictedPackages()) {
    if (className.startsWith(restrictedPackageName)) {
      throw new TemplateException("Instantiating " + className + " is not allowed in the "+ "template for security reasons",environment);
    }
  }
  try {
    return Class.forName(className,true,ClassLoaderUtil.getContextClassLoader());
  }
 catch (  Exception e) {
    throw new TemplateException(e,environment);
  }
}
