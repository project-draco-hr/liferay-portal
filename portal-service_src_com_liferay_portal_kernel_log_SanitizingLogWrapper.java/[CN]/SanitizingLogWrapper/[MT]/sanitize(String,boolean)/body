{
  if (!_LOG_SANITIZING_ENABLED) {
    return message;
  }
  if (message == null) {
    return null;
  }
  boolean sanitized=false;
  char[] characters=message.toCharArray();
  for (int i=0; i < characters.length; i++) {
    int codePoint=characters[i];
    if ((codePoint >= 0) && (codePoint < _logMessageWhitelist.length) && (_logMessageWhitelist[codePoint] == 0)) {
      characters[i]=_LOG_SANITIZING_REPLACEMENT;
      sanitized=true;
    }
  }
  if (sanitized) {
    String result=new String(characters).concat(_SANITIZED);
    if (_LOG_SANITIZING_ESCAPE_HTML_ENABLED) {
      return HtmlUtil.escape(result);
    }
    return result;
  }
  if (returnNull) {
    return null;
  }
  return message;
}
