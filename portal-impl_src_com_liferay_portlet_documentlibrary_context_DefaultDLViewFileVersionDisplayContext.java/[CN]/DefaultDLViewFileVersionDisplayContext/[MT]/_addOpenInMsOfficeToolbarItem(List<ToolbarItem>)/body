{
  if (!isOpenInMsOfficeButtonVisible()) {
    return;
  }
  String webDavURL=DLUtil.getWebDavURL(_themeDisplay,_fileEntry.getFolder(),_fileEntry,PropsValues.DL_FILE_ENTRY_OPEN_IN_MS_OFFICE_MANUAL_CHECK_IN_REQUIRED);
  LiferayPortletResponse liferayPortletResponse=_getLiferayPortletResponse();
  String namespace=liferayPortletResponse.getNamespace();
  StringBundler sb=new StringBundler(4);
  sb.append(namespace);
  sb.append("openDocument('");
  sb.append(webDavURL);
  sb.append("');");
  _addJavascriptToolbarItem(toolbarItems,DLToolbarItemKeys.OPEN_IN_MS_OFFICE,"icon-file-alt",UnicodeLanguageUtil.get(_request,"open-in-ms-office"),sb.toString());
}
