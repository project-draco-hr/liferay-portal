{
  if (!isOpenInMsOfficeButtonVisible()) {
    return;
  }
  JavascriptMenuItem javaScriptMenuItem=new JavascriptMenuItem();
  javaScriptMenuItem.setIconCssClass("icon-file-alt");
  javaScriptMenuItem.setKey(DLMenuItemKeys.OPEN_IN_MS_OFFICE);
  Map<String,String> context=new HashMap<String,String>();
  LiferayPortletResponse liferayPortletResponse=getLiferayPortletResponse();
  context.put("errorMessage",UnicodeLanguageUtil.get(_request,"cannot-open-the-requested-document-due-to-the-following-" + "reason"));
  context.put("namespace",liferayPortletResponse.getNamespace());
  String javaScript=_processFreeMarkerTemplate("/com/liferay/portlet/documentlibrary/context/dependencies" + "open_in_ms_office_js.ftl",context);
  javaScriptMenuItem.setJavascript(javaScript);
  javaScriptMenuItem.setMessage("open-in-ms-office");
  String webDavURL=DLUtil.getWebDavURL(_themeDisplay,_fileEntry.getFolder(),_fileEntry,PropsValues.DL_FILE_ENTRY_OPEN_IN_MS_OFFICE_MANUAL_CHECK_IN_REQUIRED,true);
  String onClick=liferayPortletResponse.getNamespace() + "openDocument('" + webDavURL+ "');";
  javaScriptMenuItem.setOnClick(onClick);
  menuItems.add(javaScriptMenuItem);
}
