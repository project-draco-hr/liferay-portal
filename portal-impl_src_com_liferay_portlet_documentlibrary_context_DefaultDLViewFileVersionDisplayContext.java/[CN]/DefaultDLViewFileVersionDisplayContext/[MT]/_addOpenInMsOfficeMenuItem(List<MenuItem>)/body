{
  if (!isOpenInMsOfficeButtonVisible()) {
    return;
  }
  LiferayPortletResponse liferayPortletResponse=_getLiferayPortletResponse();
  String webDavURL=DLUtil.getWebDavURL(_themeDisplay,_fileEntry.getFolder(),_fileEntry,PropsValues.DL_FILE_ENTRY_OPEN_IN_MS_OFFICE_MANUAL_CHECK_IN_REQUIRED,true);
  String onClick=liferayPortletResponse.getNamespace() + "openDocument('" + webDavURL+ "');";
  JavascriptMenuItem javascriptMenuItem=_addJavascriptUIItem(new JavascriptMenuItem(),menuItems,DLUIItemKeys.OPEN_IN_MS_OFFICE,"icon-file-alt","open-in-ms-office",onClick);
  Map<String,String> context=new HashMap<>();
  context.put("errorMessage",UnicodeLanguageUtil.get(_request,"cannot-open-the-requested-document-due-to-the-following-" + "reason"));
  context.put("namespace",liferayPortletResponse.getNamespace());
  String javaScript=_processFreeMarkerTemplate("/com/liferay/portlet/documentlibrary/context/dependencies" + "open_in_ms_office_js.ftl",context);
  javascriptMenuItem.setJavascript(javaScript);
}
