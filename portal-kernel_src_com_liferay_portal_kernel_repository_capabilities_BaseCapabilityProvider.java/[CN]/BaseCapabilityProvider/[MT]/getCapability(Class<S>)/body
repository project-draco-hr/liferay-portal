{
  if (_exportedCapabilityClasses.contains(capabilityClass)) {
    Capability capability=getInternalCapability(capabilityClass);
    if (capability == null) {
      throw new IllegalArgumentException(String.format("Capability %s is not supported by provider %s",capabilityClass.getName(),getProviderKey()));
    }
    return (S)capability;
  }
  throw new IllegalArgumentException(String.format("Capability %s is not exported by provider %s",capabilityClass.getName(),getProviderKey()));
}
