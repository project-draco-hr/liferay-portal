{
  if (_log.isDebugEnabled()) {
    _log.debug("Remove " + portletId + " from layout "+ plid);
  }
  try {
    Layout layout=_layoutLocalService.getLayout(plid);
    PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.getPortletSetup(layout,portletId,StringPool.BLANK);
    String articleId=portletPreferences.getValue("articleId",null);
    if (Validator.isNull(articleId)) {
      return;
    }
    _journalContentSearchLocalService.deleteArticleContentSearch(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,articleId);
    String[] runtimePortletIds=getRuntimePortletIds(layout.getCompanyId(),layout.getGroupId(),articleId);
    if (runtimePortletIds.length > 0) {
      _portletLocalService.deletePortlets(layout.getCompanyId(),runtimePortletIds,layout.getPlid());
    }
  }
 catch (  Exception e) {
    throw new PortletLayoutListenerException(e);
  }
}
