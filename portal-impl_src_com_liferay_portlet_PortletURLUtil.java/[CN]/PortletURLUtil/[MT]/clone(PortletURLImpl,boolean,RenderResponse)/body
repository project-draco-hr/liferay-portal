{
  PortletURLImpl newURLImpl=null;
  if (action) {
    newURLImpl=(PortletURLImpl)res.createActionURL();
  }
 else {
    newURLImpl=(PortletURLImpl)res.createRenderURL();
  }
  newURLImpl.setPortletName(portletURLImpl.getPortletName());
  WindowState windowState=portletURLImpl.getWindowState();
  if (windowState != null) {
    newURLImpl.setWindowState(windowState);
  }
  PortletMode portletMode=portletURLImpl.getPortletMode();
  if (portletMode != null) {
    newURLImpl.setPortletMode(portletMode);
  }
  newURLImpl.setParameters(portletURLImpl.getParameterMap());
  return newURLImpl;
}
