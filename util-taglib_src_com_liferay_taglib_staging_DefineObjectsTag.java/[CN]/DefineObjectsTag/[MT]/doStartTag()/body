{
  HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(request,"groupId");
  Group group=GroupLocalServiceUtil.fetchGroup(groupId);
  if (group == null) {
    group=(Group)request.getAttribute(WebKeys.GROUP);
  }
  if (group == null) {
    group=themeDisplay.getScopeGroup();
  }
  if (group == null) {
    return SKIP_BODY;
  }
  long liveGroupId=group.getGroupId();
  long stagingGroupId=group.getGroupId();
  Group liveGroup=group;
  Group stagingGroup=group;
  if (!group.isStagedRemotely()) {
    if (group.isStagingGroup()) {
      liveGroup=group.getLiveGroup();
      liveGroupId=liveGroup.getGroupId();
    }
    if (group.hasStagingGroup()) {
      stagingGroup=group.getStagingGroup();
      stagingGroupId=stagingGroup.getGroupId();
    }
  }
  pageContext.setAttribute("group",group);
  pageContext.setAttribute("groupId",groupId);
  pageContext.setAttribute("liveGroup",liveGroup);
  pageContext.setAttribute("liveGroupId",liveGroupId);
  pageContext.setAttribute("stagingGroup",stagingGroup);
  pageContext.setAttribute("stagingGroupId",stagingGroupId);
  pageContext.setAttribute("privateLayout",ParamUtil.getBoolean(request,"privateLayout"));
  return SKIP_BODY;
}
