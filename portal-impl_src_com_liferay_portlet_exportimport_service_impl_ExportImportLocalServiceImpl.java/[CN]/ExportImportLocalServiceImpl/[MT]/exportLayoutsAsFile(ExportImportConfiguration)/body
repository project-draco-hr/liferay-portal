{
  try {
    LayoutExporter layoutExporter=LayoutExporter.getInstance();
    Map<String,Serializable> settingsMap=exportImportConfiguration.getSettingsMap();
    long sourceGroupId=MapUtil.getLong(settingsMap,"sourceGroupId");
    boolean privateLayout=MapUtil.getBoolean(settingsMap,"privateLayout");
    long[] layoutIds=GetterUtil.getLongValues(settingsMap.get("layoutIds"));
    Map<String,String[]> parameterMap=(Map<String,String[]>)settingsMap.get("parameterMap");
    DateRange dateRange=ExportImportDateUtil.getDateRange(exportImportConfiguration);
    return layoutExporter.exportLayoutsAsFile(sourceGroupId,privateLayout,layoutIds,parameterMap,dateRange.getStartDate(),dateRange.getEndDate());
  }
 catch (  PortalException pe) {
    throw pe;
  }
catch (  SystemException se) {
    throw se;
  }
catch (  Exception e) {
    throw new SystemException(e);
  }
}
