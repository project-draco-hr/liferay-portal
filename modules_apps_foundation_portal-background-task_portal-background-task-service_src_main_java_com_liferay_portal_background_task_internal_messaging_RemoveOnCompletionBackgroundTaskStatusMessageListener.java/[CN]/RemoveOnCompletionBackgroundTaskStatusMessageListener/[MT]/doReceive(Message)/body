{
  long backgroundTaskId=(Long)message.get(BackgroundTaskConstants.BACKGROUND_TASK_ID);
  BackgroundTask backgroundTask=_backgroundTaskManager.fetchBackgroundTask(backgroundTaskId);
  if (backgroundTask == null) {
    return;
  }
  Map<String,Serializable> taskContextMap=backgroundTask.getTaskContextMap();
  boolean deleteOnCompetion=GetterUtil.getBoolean(taskContextMap.get(BackgroundTaskContextMapConstants.DELETE_ON_SUCCESS));
  if (!deleteOnCompetion) {
    return;
  }
  int status=GetterUtil.getInteger(message.get("status"),-1);
  if (status == -1) {
    return;
  }
  if (status == BackgroundTaskConstants.STATUS_SUCCESSFUL) {
    if (_log.isInfoEnabled()) {
      _log.info("Deleting background task " + backgroundTask.toString());
    }
    _backgroundTaskManager.deleteBackgroundTask(backgroundTaskId);
  }
}
