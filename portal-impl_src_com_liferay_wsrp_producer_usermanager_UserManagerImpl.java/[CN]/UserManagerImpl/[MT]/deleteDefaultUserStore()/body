{
  try {
    Company company=_getWSRPCompany();
    Organization organization=_getOrganization(company.getCompanyId(),_producer.getProducerKey());
    if (organization != null) {
      List<Organization> organizations=new ArrayList<Organization>();
      organizations.add(organization);
      List<Organization> subOrganizations=OrganizationLocalServiceUtil.getSuborganizations(organizations);
      for (      Organization org : subOrganizations) {
        deleteConsumerUserStore(org.getName());
      }
      List<User> users=UserLocalServiceUtil.getOrganizationUsers(organization.getOrganizationId());
      for (      User user : users) {
        if (user.getPrimaryKey() != _getAuthlessUser().getPrimaryKey()) {
          UserLocalServiceUtil.deleteUser(user);
        }
      }
      OrganizationLocalServiceUtil.deleteOrganization(organization.getOrganizationId());
    }
  }
 catch (  Exception ex) {
    _log.error(ex,ex);
    throw new ProducerException(ex);
  }
}
