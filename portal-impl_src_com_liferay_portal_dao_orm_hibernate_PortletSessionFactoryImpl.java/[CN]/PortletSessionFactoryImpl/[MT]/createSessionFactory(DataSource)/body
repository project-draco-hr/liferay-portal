{
  PortletHibernateConfiguration portletHibernateConfiguration=new PortletHibernateConfiguration(getSessionFactoryClassLoader(),dataSource);
  portletHibernateConfiguration.setDataSource(dataSource);
  SessionFactory sessionFactory=null;
  try {
    sessionFactory=portletHibernateConfiguration.buildSessionFactory();
  }
 catch (  Exception e) {
    _log.error(e,e);
    return null;
  }
  return sessionFactory;
}
