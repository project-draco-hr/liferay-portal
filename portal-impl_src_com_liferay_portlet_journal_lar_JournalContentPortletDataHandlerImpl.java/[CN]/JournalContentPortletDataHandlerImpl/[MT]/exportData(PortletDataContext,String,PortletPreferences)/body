{
  try {
    String articleId=prefs.getValue("article-id",null);
    if (articleId == null) {
      if (_log.isWarnEnabled()) {
        _log.warn("No article id found in preferences of portlet " + portletId);
      }
      return StringPool.BLANK;
    }
    long articleGroupId=GetterUtil.getLong(prefs.getValue("group-id",StringPool.BLANK));
    if (articleGroupId <= 0) {
      if (_log.isWarnEnabled()) {
        _log.warn("No group id found in preferences of portlet " + portletId);
      }
      return StringPool.BLANK;
    }
    JournalArticle article=null;
    try {
      article=JournalArticleLocalServiceUtil.getLatestArticle(articleGroupId,articleId);
    }
 catch (    NoSuchArticleException nsae) {
      if (_log.isWarnEnabled()) {
        _log.warn(nsae);
      }
    }
    if (article == null) {
      return StringPool.BLANK;
    }
    XStream xStream=new XStream();
    Document doc=DocumentHelper.createDocument();
    Element root=doc.addElement("journal-content");
    List content=root.content();
    if (!context.addPrimaryKey(JournalArticle.class,article.getPrimaryKeyObj())) {
      JournalPortletDataHandlerImpl.exportArticle(context,article);
      String xml=xStream.toXML(article);
      Document tempDoc=PortalUtil.readDocumentFromXML(xml);
      content.add(tempDoc.getRootElement().createCopy());
    }
    String structureId=article.getStructureId();
    if (Validator.isNotNull(structureId)) {
      JournalStructure structure=JournalStructureUtil.findByG_S(article.getGroupId(),structureId);
      if (!context.addPrimaryKey(JournalStructure.class,article.getPrimaryKeyObj())) {
        JournalPortletDataHandlerImpl.exportStructure(structure);
        String xml=xStream.toXML(structure);
        Document tempDoc=PortalUtil.readDocumentFromXML(xml);
        content.add(tempDoc.getRootElement().createCopy());
      }
    }
    String templateId=article.getTemplateId();
    if (Validator.isNotNull(templateId)) {
      JournalTemplate template=JournalTemplateUtil.findByG_T(article.getGroupId(),templateId);
      if (!context.addPrimaryKey(JournalTemplate.class,template.getPrimaryKeyObj())) {
        JournalPortletDataHandlerImpl.exportTemplate(context,template);
        String xml=xStream.toXML(template);
        Document tempDoc=PortalUtil.readDocumentFromXML(xml);
        content.add(tempDoc.getRootElement().createCopy());
      }
    }
    return doc.asXML();
  }
 catch (  Exception e) {
    throw new PortletDataException(e);
  }
}
