{
  try {
    String articleId=preferences.getValue("article-id",null);
    if (articleId == null) {
      if (_log.isWarnEnabled()) {
        _log.warn("No article id found in preferences of portlet " + portletId);
      }
      return StringPool.BLANK;
    }
    long articleGroupId=GetterUtil.getLong(preferences.getValue("group-id",StringPool.BLANK));
    if (articleGroupId <= 0) {
      if (_log.isWarnEnabled()) {
        _log.warn("No group id found in preferences of portlet " + portletId);
      }
      return StringPool.BLANK;
    }
    JournalArticle article=null;
    try {
      article=JournalArticleLocalServiceUtil.getLatestArticle(articleGroupId,articleId);
    }
 catch (    NoSuchArticleException nsae) {
      if (_log.isWarnEnabled()) {
        _log.warn(nsae);
      }
    }
    if (article == null) {
      return StringPool.BLANK;
    }
    Document doc=SAXReaderUtil.createDocument();
    Element root=doc.addElement("journal-content-data");
    Element dlFoldersEl=root.addElement("dl-folders");
    Element dlFilesEl=root.addElement("dl-file-entries");
    Element dlFileRanksEl=root.addElement("dl-file-ranks");
    Element igFoldersEl=root.addElement("ig-folders");
    Element igImagesEl=root.addElement("ig-images");
    JournalPortletDataHandlerImpl.exportArticle(context,root,dlFoldersEl,dlFilesEl,dlFileRanksEl,igFoldersEl,igImagesEl,article);
    String structureId=article.getStructureId();
    if (Validator.isNotNull(structureId)) {
      JournalStructure structure=JournalStructureUtil.findByG_S(article.getGroupId(),structureId);
      JournalPortletDataHandlerImpl.exportStructure(context,root,structure);
    }
    String templateId=article.getTemplateId();
    if (Validator.isNotNull(templateId)) {
      JournalTemplate template=JournalTemplateUtil.findByG_T(article.getGroupId(),templateId);
      JournalPortletDataHandlerImpl.exportTemplate(context,root,dlFoldersEl,dlFilesEl,dlFileRanksEl,igFoldersEl,igImagesEl,template);
    }
    return doc.formattedString();
  }
 catch (  Exception e) {
    throw new PortletDataException(e);
  }
}
