{
  portletDataContext.importPermissions("com.liferay.portlet.journal",portletDataContext.getSourceGroupId(),portletDataContext.getScopeGroupId());
  if (Validator.isNull(data)) {
    return null;
  }
  Document document=SAXReaderUtil.read(data);
  Element rootElement=document.getRootElement();
  Element dlFoldersElement=rootElement.element("dl-folders");
  List<Element> dlFolderElements=Collections.emptyList();
  if (dlFoldersElement != null) {
    dlFolderElements=dlFoldersElement.elements("folder");
  }
  for (  Element folderElement : dlFolderElements) {
    DLPortletDataHandlerImpl.importFolder(portletDataContext,folderElement);
  }
  Element dlFileEntriesElement=rootElement.element("dl-file-entries");
  List<Element> dlFileEntryElements=Collections.emptyList();
  if (dlFileEntriesElement != null) {
    dlFileEntryElements=dlFileEntriesElement.elements("file-entry");
  }
  for (  Element fileEntryElement : dlFileEntryElements) {
    DLPortletDataHandlerImpl.importFileEntry(portletDataContext,fileEntryElement);
  }
  Element dlFileRanksElement=rootElement.element("dl-file-ranks");
  List<Element> dlFileRankElements=Collections.emptyList();
  if (dlFileRanksElement != null) {
    dlFileRankElements=dlFileRanksElement.elements("file-rank");
  }
  for (  Element fileRankElement : dlFileRankElements) {
    DLPortletDataHandlerImpl.importFileRank(portletDataContext,fileRankElement);
  }
  Element igFoldersElement=rootElement.element("ig-folders");
  List<Element> igFolderElements=Collections.emptyList();
  if (igFoldersElement != null) {
    igFolderElements=igFoldersElement.elements("folder");
  }
  for (  Element folderElement : igFolderElements) {
    IGPortletDataHandlerImpl.importFolder(portletDataContext,folderElement);
  }
  Element igImagesElement=rootElement.element("ig-images");
  List<Element> igImageElements=Collections.emptyList();
  if (igImagesElement != null) {
    igImageElements=igImagesElement.elements("image");
  }
  for (  Element imageElement : igImageElements) {
    IGPortletDataHandlerImpl.importImage(portletDataContext,imageElement);
  }
  Element structureElement=rootElement.element("structure");
  if (structureElement != null) {
    JournalPortletDataHandlerImpl.importStructure(portletDataContext,structureElement);
  }
  Element templateElement=rootElement.element("template");
  if (templateElement != null) {
    JournalPortletDataHandlerImpl.importTemplate(portletDataContext,templateElement);
  }
  Element articleElement=rootElement.element("article");
  if (articleElement != null) {
    JournalPortletDataHandlerImpl.importArticle(portletDataContext,articleElement);
  }
  String articleId=portletPreferences.getValue("articleId",null);
  if (Validator.isNotNull(articleId)) {
    Map<String,String> articleIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalArticle.class);
    articleId=MapUtil.getString(articleIds,articleId,articleId);
    portletPreferences.setValue("groupId",String.valueOf(portletDataContext.getScopeGroupId()));
    portletPreferences.setValue("articleId",articleId);
    Layout layout=LayoutLocalServiceUtil.getLayout(portletDataContext.getPlid());
    JournalContentSearchLocalServiceUtil.updateContentSearch(portletDataContext.getScopeGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,articleId,true);
  }
  String templateId=portletPreferences.getValue("templateId",null);
  if (Validator.isNotNull(templateId)) {
    Map<String,String> templateIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalTemplate.class);
    templateId=MapUtil.getString(templateIds,templateId,templateId);
    portletPreferences.setValue("templateId",templateId);
  }
  return portletPreferences;
}
