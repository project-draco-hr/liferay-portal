{
  portletDataContext.importPermissions("com.liferay.portlet.journal",portletDataContext.getSourceGroupId(),portletDataContext.getScopeGroupId());
  if (Validator.isNull(data)) {
    return null;
  }
  Document document=SAXReaderUtil.read(data);
  Element rootElement=document.getRootElement();
  JournalPortletDataHandlerImpl.importReferencedData(portletDataContext,rootElement);
  Element structureElement=rootElement.element("structure");
  if (structureElement != null) {
    JournalPortletDataHandlerImpl.importStructure(portletDataContext,structureElement);
  }
  Element templateElement=rootElement.element("template");
  if (templateElement != null) {
    JournalPortletDataHandlerImpl.importTemplate(portletDataContext,templateElement);
  }
  Element articleElement=rootElement.element("article");
  if (articleElement != null) {
    JournalPortletDataHandlerImpl.importArticle(portletDataContext,articleElement);
  }
  String articleId=portletPreferences.getValue("articleId",null);
  if (Validator.isNotNull(articleId)) {
    Map<String,String> articleIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalArticle.class);
    articleId=MapUtil.getString(articleIds,articleId,articleId);
    String importedArticleGroupId=articleElement.attributeValue("imported-article-group-id");
    if (Validator.isNull(importedArticleGroupId)) {
      importedArticleGroupId=String.valueOf(portletDataContext.getScopeGroupId());
    }
    portletPreferences.setValue("groupId",importedArticleGroupId);
    portletPreferences.setValue("articleId",articleId);
    Layout layout=LayoutLocalServiceUtil.getLayout(portletDataContext.getPlid());
    JournalContentSearchLocalServiceUtil.updateContentSearch(portletDataContext.getScopeGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,articleId,true);
  }
  String templateId=portletPreferences.getValue("templateId",null);
  if (Validator.isNotNull(templateId)) {
    Map<String,String> templateIds=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(JournalTemplate.class);
    templateId=MapUtil.getString(templateIds,templateId,templateId);
    portletPreferences.setValue("templateId",templateId);
  }
  return portletPreferences;
}
