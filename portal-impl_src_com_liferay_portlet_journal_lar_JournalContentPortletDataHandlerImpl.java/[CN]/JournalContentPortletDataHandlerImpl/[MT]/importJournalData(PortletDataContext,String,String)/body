{
  if (Validator.isNull(data)) {
    return;
  }
  JournalCreationStrategy creationStrategy=JournalCreationStrategyFactory.getInstance();
  XStream xStream=new XStream();
  Document doc=PortalUtil.readDocumentFromXML(data);
  Element root=doc.getRootElement();
  Element el=root.element(JournalArticleImpl.class.getName());
  Document tempDoc=DocumentHelper.createDocument();
  tempDoc.content().add(el.createCopy());
  JournalArticle article=(JournalArticle)xStream.fromXML(XMLFormatter.toString(tempDoc));
  article.setGroupId(context.getGroupId());
  JournalArticle oldArticle=null;
  try {
    oldArticle=JournalArticleLocalServiceUtil.getLatestArticle(context.getGroupId(),article.getArticleId());
  }
 catch (  NoSuchArticleException nsae) {
  }
  if (oldArticle == null) {
    article.setNew(true);
    article.setId(CounterLocalServiceUtil.increment());
    long authorId=creationStrategy.getAuthorUserId(context.getCompanyId(),context.getGroupId(),article);
    if (authorId > 0) {
      article.setUserId(authorId);
      article.setUserName(creationStrategy.getAuthorUserName(context.getCompanyId(),context.getGroupId(),article));
    }
    long approvedById=creationStrategy.getApprovalUserId(context.getCompanyId(),context.getGroupId(),article);
    if (approvedById > 0) {
      article.setApprovedByUserId(approvedById);
      article.setApprovedByUserName(creationStrategy.getApprovalUserName(context.getCompanyId(),context.getGroupId(),article));
      article.setApproved(true);
    }
 else {
      article.setApprovedByUserId(0);
      article.setApprovedByUserName(null);
      article.setApproved(false);
    }
    String newContent=creationStrategy.getTransformedContent(context.getCompanyId(),context.getGroupId(),article);
    if (newContent != null) {
      article.setContent(newContent);
    }
    article=JournalArticleUtil.update(article);
    boolean addCommunityPermissions=creationStrategy.addCommunityPermissions(context.getCompanyId(),context.getGroupId(),article);
    boolean addGuestPermissions=creationStrategy.addGuestPermissions(context.getCompanyId(),context.getGroupId(),article);
    JournalArticleLocalServiceUtil.addArticleResources(article,addCommunityPermissions,addGuestPermissions);
  }
 else {
  }
  el=root.element(JournalStructureImpl.class.getName());
  if (el != null) {
    tempDoc=DocumentHelper.createDocument();
    tempDoc.content().add(el.createCopy());
    JournalStructure structure=(JournalStructure)xStream.fromXML(XMLFormatter.toString(tempDoc));
    structure.setGroupId(context.getGroupId());
    if (JournalStructureUtil.fetchByG_S(context.getGroupId(),structure.getStructureId()) == null) {
      structure.setNew(true);
      structure.setId(CounterLocalServiceUtil.increment());
      long authorId=creationStrategy.getAuthorUserId(context.getCompanyId(),context.getGroupId(),structure);
      if (authorId > 0) {
        structure.setUserId(authorId);
        structure.setUserName(creationStrategy.getAuthorUserName(context.getCompanyId(),context.getGroupId(),structure));
      }
      structure=JournalStructureUtil.update(structure);
      boolean addCommunityPermissions=creationStrategy.addCommunityPermissions(context.getCompanyId(),context.getGroupId(),structure);
      boolean addGuestPermissions=creationStrategy.addGuestPermissions(context.getCompanyId(),context.getGroupId(),structure);
      JournalStructureLocalServiceUtil.addStructureResources(structure,addCommunityPermissions,addGuestPermissions);
    }
 else {
    }
  }
  el=root.element(JournalTemplateImpl.class.getName());
  if (el != null) {
    tempDoc=DocumentHelper.createDocument();
    tempDoc.content().add(el.createCopy());
    JournalTemplate template=(JournalTemplate)xStream.fromXML(XMLFormatter.toString(tempDoc));
    template.setGroupId(context.getGroupId());
    if (JournalTemplateUtil.fetchByG_T(context.getGroupId(),template.getTemplateId()) == null) {
      template.setNew(true);
      template.setId(CounterLocalServiceUtil.increment());
      long authorId=creationStrategy.getAuthorUserId(context.getCompanyId(),context.getGroupId(),template);
      if (authorId > 0) {
        template.setUserId(authorId);
        template.setUserName(creationStrategy.getAuthorUserName(context.getCompanyId(),context.getGroupId(),template));
      }
      template=JournalTemplateUtil.update(template);
      boolean addCommunityPermissions=creationStrategy.addCommunityPermissions(context.getCompanyId(),context.getGroupId(),template);
      boolean addGuestPermissions=creationStrategy.addGuestPermissions(context.getCompanyId(),context.getGroupId(),template);
      JournalTemplateLocalServiceUtil.addTemplateResources(template,addCommunityPermissions,addGuestPermissions);
    }
 else {
    }
  }
}
