{
  try {
    context.importPermissions("com.liferay.portlet.journal",context.getSourceGroupId(),context.getGroupId());
    if (Validator.isNull(data)) {
      return null;
    }
    Document doc=SAXReaderUtil.read(data);
    Element root=doc.getRootElement();
    Element dlFoldersEl=root.element("dl-folders");
    List<Element> dlFolderEls=Collections.EMPTY_LIST;
    if (dlFoldersEl != null) {
      dlFolderEls=dlFoldersEl.elements("folder");
    }
    for (    Element folderEl : dlFolderEls) {
      DLPortletDataHandlerImpl.importFolder(context,folderEl);
    }
    Element dlFileEntriesEl=root.element("dl-file-entries");
    List<Element> dlFileEntryEls=Collections.EMPTY_LIST;
    if (dlFileEntriesEl != null) {
      dlFileEntryEls=dlFileEntriesEl.elements("file-entry");
    }
    for (    Element fileEntryEl : dlFileEntryEls) {
      DLPortletDataHandlerImpl.importFileEntry(context,fileEntryEl);
    }
    Element dlFileRanksEl=root.element("dl-file-ranks");
    List<Element> dlFileRankEls=Collections.EMPTY_LIST;
    if (dlFileRanksEl != null) {
      dlFileRankEls=dlFileRanksEl.elements("file-rank");
    }
    for (    Element fileRankEl : dlFileRankEls) {
      DLPortletDataHandlerImpl.importFileRank(context,fileRankEl);
    }
    Element igFoldersEl=root.element("ig-folders");
    List<Element> igFolderEls=Collections.EMPTY_LIST;
    if (igFoldersEl != null) {
      igFolderEls=igFoldersEl.elements("folder");
    }
    for (    Element folderEl : igFolderEls) {
      IGPortletDataHandlerImpl.importFolder(context,folderEl);
    }
    Element igImagesEl=root.element("ig-images");
    List<Element> igImageEls=Collections.EMPTY_LIST;
    if (igImagesEl != null) {
      igImageEls=igImagesEl.elements("image");
    }
    for (    Element imageEl : igImageEls) {
      IGPortletDataHandlerImpl.importImage(context,imageEl);
    }
    Element structureEl=root.element("structure");
    if (structureEl != null) {
      JournalPortletDataHandlerImpl.importStructure(context,structureEl);
    }
    Element templateEl=root.element("template");
    if (templateEl != null) {
      JournalPortletDataHandlerImpl.importTemplate(context,templateEl);
    }
    Element articleEl=root.element("article");
    if (articleEl != null) {
      JournalPortletDataHandlerImpl.importArticle(context,articleEl);
    }
    String articleId=preferences.getValue("article-id",StringPool.BLANK);
    if (Validator.isNotNull(articleId)) {
      Map<String,String> articleIds=(Map<String,String>)context.getNewPrimaryKeysMap(JournalArticle.class);
      articleId=MapUtil.getString(articleIds,articleId,articleId);
      preferences.setValue("group-id",String.valueOf(context.getGroupId()));
      preferences.setValue("article-id",articleId);
      Layout layout=LayoutLocalServiceUtil.getLayout(context.getPlid());
      JournalContentSearchLocalServiceUtil.updateContentSearch(context.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),portletId,articleId,true);
    }
    return preferences;
  }
 catch (  Exception e) {
    throw new PortletDataException(e);
  }
}
