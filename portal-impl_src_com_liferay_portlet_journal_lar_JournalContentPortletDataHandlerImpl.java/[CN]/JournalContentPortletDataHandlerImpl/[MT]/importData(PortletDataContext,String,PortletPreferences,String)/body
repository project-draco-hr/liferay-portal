{
  try {
    if (Validator.isNull(data)) {
      return null;
    }
    XStream xStream=new XStream();
    Document doc=PortalUtil.readDocumentFromXML(data);
    Element root=doc.getRootElement();
    Element el=root.element(JournalStructureImpl.class.getName());
    Document tempDoc=DocumentHelper.createDocument();
    Map<String,String> structureIds=context.getNewPrimaryKeysMap(JournalStructure.class);
    if (el != null) {
      tempDoc.content().add(el.createCopy());
      JournalStructure structure=(JournalStructure)xStream.fromXML(tempDoc.asXML());
      JournalPortletDataHandlerImpl.importStructure(context,structureIds,structure);
    }
    el=root.element(JournalTemplateImpl.class.getName());
    Map<String,String> templateIds=context.getNewPrimaryKeysMap(JournalTemplate.class);
    if (el != null) {
      tempDoc=DocumentHelper.createDocument();
      tempDoc.content().add(el.createCopy());
      JournalTemplate template=(JournalTemplate)xStream.fromXML(tempDoc.asXML());
      JournalPortletDataHandlerImpl.importTemplate(context,structureIds,templateIds,template);
    }
    el=root.element(JournalArticleImpl.class.getName());
    Map<String,String> articleIds=context.getNewPrimaryKeysMap(JournalArticle.class);
    if (el != null) {
      tempDoc=DocumentHelper.createDocument();
      tempDoc.content().add(el.createCopy());
      JournalArticle article=(JournalArticle)xStream.fromXML(tempDoc.asXML());
      JournalPortletDataHandlerImpl.importArticle(context,structureIds,templateIds,articleIds,article);
    }
    String articleId=prefs.getValue("article-id",StringPool.BLANK);
    if (Validator.isNotNull(articleId)) {
      articleId=MapUtil.getString(articleIds,articleId,articleId);
      prefs.setValue("group-id",String.valueOf(context.getGroupId()));
      prefs.setValue("article-id",articleId);
    }
    return prefs;
  }
 catch (  Exception e) {
    throw new PortletDataException(e);
  }
}
