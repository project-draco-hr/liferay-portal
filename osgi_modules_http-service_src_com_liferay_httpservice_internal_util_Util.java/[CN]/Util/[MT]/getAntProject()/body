{
  Project project=new Project();
  DefaultLogger logger=new DefaultLogger(){
    @Override public void messageLogged(    BuildEvent event){
      int priority=event.getPriority();
      if (priority <= msgOutputLevel) {
        StringBundler sb=new StringBundler();
        try {
          UnsyncBufferedReader unsyncBufferedReader=new UnsyncBufferedReader(new UnsyncStringReader(event.getMessage()));
          String line=unsyncBufferedReader.readLine();
          boolean first=true;
          while (line != null) {
            if (!first) {
              sb.append(StringUtils.LINE_SEP);
            }
            first=false;
            sb.append("  ");
            sb.append(line);
            line=unsyncBufferedReader.readLine();
          }
        }
 catch (        IOException ioe) {
        }
        String msg=sb.toString();
        if (priority != Project.MSG_ERR) {
          printMessage(msg,out,priority);
        }
 else {
          printMessage(msg,err,priority);
        }
        log(msg);
      }
    }
  }
;
  logger.setMessageOutputLevel(Project.MSG_INFO);
  logger.setOutputPrintStream(System.out);
  logger.setErrorPrintStream(System.err);
  project.addBuildListener(logger);
  return project;
}
