{
  User user=userPersistence.findByPrimaryKey(userId);
  long groupId=serviceContext.getScopeGroupId();
  Date now=new Date();
  long discussionId=counterLocalService.increment();
  MBDiscussion discussion=mbDiscussionPersistence.create(discussionId);
  discussion.setUuid(serviceContext.getUuid());
  discussion.setGroupId(groupId);
  discussion.setCompanyId(serviceContext.getCompanyId());
  discussion.setUserId(userId);
  discussion.setUserName(user.getFullName());
  discussion.setCreateDate(serviceContext.getCreateDate(now));
  discussion.setModifiedDate(serviceContext.getModifiedDate(now));
  discussion.setClassNameId(classNameId);
  discussion.setClassPK(classPK);
  discussion.setThreadId(threadId);
  mbDiscussionPersistence.update(discussion);
  return discussion;
}
