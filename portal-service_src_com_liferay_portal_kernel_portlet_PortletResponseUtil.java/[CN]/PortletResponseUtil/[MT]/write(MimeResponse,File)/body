{
  FileInputStream fileInputStream=new FileInputStream(file);
  try (FileChannel fileChannel=fileInputStream.getChannel()){
    int contentLength=(int)fileChannel.size();
    if (mimeResponse instanceof ResourceResponse) {
      ResourceResponse resourceResponse=(ResourceResponse)mimeResponse;
      resourceResponse.setContentLength(contentLength);
    }
    fileChannel.transferTo(0,contentLength,Channels.newChannel(mimeResponse.getPortletOutputStream()));
  }
 }
