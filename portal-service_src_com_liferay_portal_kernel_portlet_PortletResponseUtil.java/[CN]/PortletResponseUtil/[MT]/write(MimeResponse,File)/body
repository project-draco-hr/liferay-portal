{
  FileInputStream fileInputStream=new FileInputStream(file);
  try (FileChannel fileChannel=fileInputStream.getChannel()){
    long contentLength=fileChannel.size();
    if (mimeResponse instanceof ResourceResponse) {
      ResourceResponse resourceResponse=(ResourceResponse)mimeResponse;
      setContentLength(resourceResponse,contentLength);
    }
    fileChannel.transferTo(0,contentLength,Channels.newChannel(mimeResponse.getPortletOutputStream()));
  }
 }
