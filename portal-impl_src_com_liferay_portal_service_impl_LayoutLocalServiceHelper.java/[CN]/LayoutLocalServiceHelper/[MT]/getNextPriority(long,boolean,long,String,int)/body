{
  try {
    int priority=defaultPriority;
    if (priority < 0) {
      Layout layout=layoutPersistence.findByG_P_P_First(groupId,privateLayout,parentLayoutId,new LayoutPriorityComparator(false));
      priority=layout.getPriority() + 1;
    }
    if ((priority < _PRIORITY_BUFFER) && Validator.isNull(sourcePrototypeLayoutUuid)) {
      LayoutSet layoutSet=layoutSetPersistence.fetchByG_P(groupId,privateLayout);
      if (Validator.isNotNull(layoutSet.getLayoutSetPrototypeUuid()) && layoutSet.isLayoutSetPrototypeLinkEnabled()) {
        priority=priority + _PRIORITY_BUFFER;
      }
    }
    return priority;
  }
 catch (  NoSuchLayoutException nsle) {
    return 0;
  }
}
