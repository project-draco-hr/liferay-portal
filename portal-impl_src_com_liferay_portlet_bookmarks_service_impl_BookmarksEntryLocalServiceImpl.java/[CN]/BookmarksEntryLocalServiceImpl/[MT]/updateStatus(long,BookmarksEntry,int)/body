{
  User user=userPersistence.findByPrimaryKey(userId);
  int oldStatus=entry.getStatus();
  entry.setStatus(status);
  entry.setStatusByUserId(userId);
  entry.setStatusByUserName(user.getScreenName());
  entry.setStatusDate(new Date());
  bookmarksEntryPersistence.update(entry);
  JSONObject extraDataJSONObject=JSONFactoryUtil.createJSONObject();
  extraDataJSONObject.put("title",entry.getName());
  if (status == WorkflowConstants.STATUS_APPROVED) {
    assetEntryLocalService.updateVisible(BookmarksEntry.class.getName(),entry.getEntryId(),true);
    socialActivityLocalService.addActivity(userId,entry.getGroupId(),BookmarksEntry.class.getName(),entry.getEntryId(),SocialActivityConstants.TYPE_RESTORE_FROM_TRASH,extraDataJSONObject.toString(),0);
  }
 else   if (status == WorkflowConstants.STATUS_IN_TRASH) {
    assetEntryLocalService.updateVisible(BookmarksEntry.class.getName(),entry.getEntryId(),false);
    socialActivityLocalService.addActivity(userId,entry.getGroupId(),BookmarksEntry.class.getName(),entry.getEntryId(),SocialActivityConstants.TYPE_MOVE_TO_TRASH,extraDataJSONObject.toString(),0);
  }
  if (oldStatus == WorkflowConstants.STATUS_IN_TRASH) {
    trashEntryLocalService.deleteEntry(BookmarksEntry.class.getName(),entry.getEntryId());
  }
 else   if (status == WorkflowConstants.STATUS_IN_TRASH) {
    trashEntryLocalService.addTrashEntry(userId,entry.getGroupId(),BookmarksEntry.class.getName(),entry.getEntryId(),entry.getUuid(),null,oldStatus,null,null);
  }
  return entry;
}
