{
  IndexCommit indexCommit=null;
  String segmentsFileName=null;
  commitLock.lock();
  try {
    indexWriter.commit();
    indexCommit=_lastIndexCommit;
    segmentsFileName=indexCommit.getSegmentsFileName();
    _segmentsFileNames.add(segmentsFileName);
  }
  finally {
    commitLock.unlock();
  }
  try {
    IndexCommitSerializationUtil.serializeIndex(indexCommit,outputStream);
  }
  finally {
    _segmentsFileNames.remove(segmentsFileName);
  }
}
