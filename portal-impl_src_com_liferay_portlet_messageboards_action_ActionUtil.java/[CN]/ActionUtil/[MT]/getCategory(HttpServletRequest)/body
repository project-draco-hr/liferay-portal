{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  String topLink=ParamUtil.getString(request,"topLink");
  if (topLink.equals("banned-users") && !MBPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.BAN_USER)) {
    throw new PrincipalException();
  }
  MBBanLocalServiceUtil.checkBan(themeDisplay.getScopeGroupId(),themeDisplay.getUserId());
  long categoryId=ParamUtil.getLong(request,"mbCategoryId");
  MBCategory category=null;
  if ((categoryId > 0) && (categoryId != MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID)) {
    category=MBCategoryServiceUtil.getCategory(categoryId);
  }
 else {
    MBPermission.check(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.VIEW);
  }
  request.setAttribute(WebKeys.MESSAGE_BOARDS_CATEGORY,category);
}
