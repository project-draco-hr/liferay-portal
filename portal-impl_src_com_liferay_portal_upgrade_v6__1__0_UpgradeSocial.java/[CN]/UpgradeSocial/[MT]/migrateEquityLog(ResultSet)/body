{
  long assetEntryId=rs.getLong("assetEntryId");
  long[] assetEntryArray=getAssetEntryArray(assetEntryId);
  if (assetEntryArray == null) {
    return;
  }
  String actionId=rs.getString("actionId");
  if (actionId.equals(ActionKeys.SUBSCRIBE)) {
    long classNameId=assetEntryArray[3];
    String className=PortalUtil.getClassName(classNameId);
    if (className.equals(MBThread.class.getName())) {
      long classPK=assetEntryArray[4];
      long mbThreadRootMessageId=getMBThreadRootMessageId(classPK);
      if (mbThreadRootMessageId == -1) {
        return;
      }
      assetEntryArray=getAssetEntryArray(MBMessage.class.getName(),mbThreadRootMessageId);
      if (assetEntryArray == null) {
        return;
      }
    }
  }
  long classNameId=PortalUtil.getClassNameId("com.liferay.portal.model.User");
  long classPK=rs.getLong("userId");
  String name=SocialActivityCounterConstants.NAME_PARTICIPATION;
  int ownerType=SocialActivityCounterConstants.TYPE_ACTOR;
  int actionDate=rs.getInt("actionDate");
  Date actionDateDate=SocialCounterPeriodUtil.getDate(actionDate - 365);
  int startPeriod=SocialCounterPeriodUtil.getStartPeriod(actionDateDate.getTime());
  int endPeriod=SocialCounterPeriodUtil.getEndPeriod(actionDateDate.getTime());
  if (endPeriod == SocialCounterPeriodUtil.getEndPeriod()) {
    endPeriod=SocialActivityCounterConstants.END_PERIOD_UNDEFINED;
  }
  int type=rs.getInt("type_");
  int value=rs.getInt("value");
  long groupId=assetEntryArray[0];
  long companyId=assetEntryArray[1];
  if (type == 1) {
    long userId=assetEntryArray[2];
    name=SocialActivityCounterConstants.NAME_CONTRIBUTION;
    ownerType=SocialActivityCounterConstants.TYPE_CREATOR;
    updateActivityCounter(increment(),groupId,companyId,classNameId,userId,name,ownerType,startPeriod,endPeriod,value);
    classNameId=assetEntryArray[3];
    classPK=assetEntryArray[4];
    name=SocialActivityCounterConstants.NAME_POPULARITY;
    ownerType=SocialActivityCounterConstants.TYPE_ASSET;
  }
  long equityLogId=rs.getLong("equityLogId");
  updateActivityCounter(equityLogId,groupId,companyId,classNameId,classPK,name,ownerType,startPeriod,endPeriod,value);
}
