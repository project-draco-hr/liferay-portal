{
  Map<String,Field> declaredFieldsMap=getDeclaredFields(targetClass);
  BeanAnalyzer beanAnalyzer=BeanAnalyzer.analyze(targetClass);
  for (  BeanProperty beanProperty : beanAnalyzer.getProperties()) {
    String beanName=beanProperty.getName();
    String capitalBeanName=null;
    Object beanValue=values.get(beanName);
    if (beanValue == null) {
      capitalBeanName=Character.toUpperCase(beanName.charAt(0)) + beanName.substring(1);
      beanValue=values.get(capitalBeanName);
    }
    if ((beanValue != null) && !validateDeclaredField(declaredFieldsMap,beanName)) {
      if (capitalBeanName != null) {
        beanName=capitalBeanName;
      }
      if (_log.isDebugEnabled()) {
        _log.debug("Removing field: " + beanName + " for security reasons.");
      }
      values.remove(beanName);
    }
  }
}
