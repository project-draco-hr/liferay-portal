{
  if (!_X_FRAME_OPTIONS_ENABLED) {
    return;
  }
  if (_X_FRAME_OPTIONS_WHITELIST.size() > 0) {
    String requestURI=request.getRequestURI();
    for (int i=0; i < 256; i++) {
      String ruleURLKey=i + ".url";
      if (!_X_FRAME_OPTIONS_WHITELIST.containsKey(ruleURLKey)) {
        continue;
      }
      String urlPrefix=StringUtil.trim(_X_FRAME_OPTIONS_WHITELIST.getProperty(ruleURLKey));
      if (!requestURI.startsWith(urlPrefix)) {
        continue;
      }
      String value=StringUtil.trim(_X_FRAME_OPTIONS_WHITELIST.getProperty(i + ".value"));
      if (Validator.isNotNull(value)) {
        setHeader(HttpHeaders.X_FRAME_OPTIONS,value);
      }
      return;
    }
  }
  super.setHeader(HttpHeaders.X_FRAME_OPTIONS,"DENY");
}
