{
  String resourceID=GetterUtil.getString(resourceRequest.getResourceID());
  HttpServletRequest request=PortalUtil.getHttpServletRequest(resourceRequest);
  HttpServletResponse response=PortalUtil.getHttpServletResponse(resourceResponse);
  if (resourceID.equals("compareVersions")) {
    ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
    long groupId=ParamUtil.getLong(resourceRequest,"groupId");
    String articleId=ParamUtil.getString(resourceRequest,"articleId");
    double sourceVersion=ParamUtil.getDouble(resourceRequest,"filterSourceVersion");
    double targetVersion=ParamUtil.getDouble(resourceRequest,"filterTargetVersion");
    String languageId=ParamUtil.getString(resourceRequest,"languageId");
    String diffHtmlResults=null;
    try {
      diffHtmlResults=JournalUtil.diffHtml(groupId,articleId,sourceVersion,targetVersion,languageId,new PortletRequestModel(resourceRequest,resourceResponse),themeDisplay);
    }
 catch (    CompareVersionsException cve) {
      resourceRequest.setAttribute(WebKeys.DIFF_VERSION,cve.getVersion());
    }
catch (    Exception e) {
      try {
        PortalUtil.sendError(e,request,response);
      }
 catch (      ServletException se) {
      }
    }
    resourceRequest.setAttribute(WebKeys.DIFF_HTML_RESULTS,diffHtmlResults);
    PortletSession portletSession=resourceRequest.getPortletSession();
    PortletContext portletContext=portletSession.getPortletContext();
    PortletRequestDispatcher portletRequestDispatcher=portletContext.getRequestDispatcher("/compare_versions_diff_html.jsp");
    portletRequestDispatcher.include(resourceRequest,resourceResponse);
  }
 else {
    super.serveResource(resourceRequest,resourceResponse);
  }
}
