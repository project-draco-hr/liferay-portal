{
  StringMaker sm=new StringMaker();
  List hitLayoutIds=JournalContentSearchLocalServiceUtil.getLayoutIds(layout.getGroupId(),layout.isPrivateLayout(),article.getArticleId());
  if (hitLayoutIds.size() > 0) {
    Long hitLayoutId=(Long)hitLayoutIds.get(0);
    Layout hitLayout=LayoutLocalServiceUtil.getLayout(layout.getGroupId(),layout.isPrivateLayout(),hitLayoutId.longValue());
    return themeDisplay.getURLPortal() + PortalUtil.getLayoutURL(hitLayout,themeDisplay);
  }
 else   if (Validator.isNotNull(feed.getTargetLayoutFriendlyUrl())) {
    sm.append(themeDisplay.getURLPortal());
    sm.append(feed.getTargetLayoutFriendlyUrl());
  }
 else {
    sm.append(themeDisplay.getURLPortal());
    sm.append(PortalUtil.getLayoutFriendlyURL(layout,themeDisplay));
  }
  sm.append("/journal_content/");
  if (Validator.isNotNull(feed.getTargetPortletId())) {
    sm.append(feed.getTargetPortletId());
  }
 else {
    sm.append(PortletKeys.JOURNAL_CONTENT);
  }
  sm.append(StringPool.SLASH);
  sm.append(article.getGroupId());
  sm.append(StringPool.SLASH);
  sm.append(article.getArticleId());
  return sm.toString();
}
