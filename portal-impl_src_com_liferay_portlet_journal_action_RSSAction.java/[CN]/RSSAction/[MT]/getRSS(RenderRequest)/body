{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  JournalFeed feed=null;
  long id=ParamUtil.getLong(req,"id");
  long groupId=ParamUtil.getLong(req,"groupId");
  String feedId=ParamUtil.getString(req,"feedId");
  if (id > 0) {
    feed=JournalFeedLocalServiceUtil.getFeed(id);
  }
 else {
    feed=JournalFeedLocalServiceUtil.getFeed(groupId,feedId);
  }
  String languageId=LanguageUtil.getLanguageId(req);
  long plid=PortalUtil.getPlidFromFriendlyURL(themeDisplay.getCompanyId(),feed.getTargetLayoutFriendlyUrl());
  Layout layout=themeDisplay.getLayout();
  if (plid > 0) {
    try {
      layout=LayoutLocalServiceUtil.getLayout(plid);
    }
 catch (    NoSuchLayoutException nsle) {
    }
  }
  String rss=exportToRSS(feed,languageId,layout,themeDisplay);
  return rss.getBytes(StringPool.UTF8);
}
