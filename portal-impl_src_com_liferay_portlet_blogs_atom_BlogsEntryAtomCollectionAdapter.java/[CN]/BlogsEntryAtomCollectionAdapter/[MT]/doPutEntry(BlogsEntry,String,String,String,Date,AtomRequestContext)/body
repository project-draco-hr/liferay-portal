{
  Calendar cal=Calendar.getInstance();
  cal.setTime(date);
  int displayDateMonth=cal.get(Calendar.MONTH);
  int displayDateDay=cal.get(Calendar.DAY_OF_MONTH);
  int displayDateYear=cal.get(Calendar.YEAR);
  int displayDateHour=cal.get(Calendar.HOUR_OF_DAY);
  int displayDateMinute=cal.get(Calendar.MINUTE);
  String[] trackbacks=StringUtil.split(blogsEntry.getTrackbacks());
  long smallImageId=blogsEntry.getSmallImageId();
  InputStream smallImageFileInputStream=null;
  String smallImageFileName=null;
  try {
    if (smallImageId != 0) {
      Image smallImage=ImageLocalServiceUtil.getImage(smallImageId);
      if (smallImage != null) {
        byte[] smallImageBytes=smallImage.getTextObj();
        smallImageFileInputStream=new ByteArrayInputStream(smallImageBytes);
        smallImageFileName=smallImageId + StringPool.PERIOD + blogsEntry.getSmallImageType();
      }
    }
    ServiceContext serviceContext=new ServiceContext();
    BlogsEntryServiceUtil.updateEntry(blogsEntry.getEntryId(),title,summary,content,displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,blogsEntry.getAllowPingbacks(),blogsEntry.isAllowTrackbacks(),trackbacks,blogsEntry.isSmallImage(),blogsEntry.getSmallImageURL(),smallImageFileInputStream,smallImageFileName,serviceContext);
  }
  finally {
    if (smallImageFileInputStream != null) {
      StreamUtil.cleanUp(smallImageFileInputStream);
    }
  }
}
