{
  Calendar cal=Calendar.getInstance();
  cal.setTime(date);
  int displayDateMonth=cal.get(Calendar.MONTH);
  int displayDateDay=cal.get(Calendar.DAY_OF_MONTH);
  int displayDateYear=cal.get(Calendar.YEAR);
  int displayDateHour=cal.get(Calendar.HOUR_OF_DAY);
  int displayDateMinute=cal.get(Calendar.MINUTE);
  String[] trackbacks=StringUtil.split(blogsEntry.getTrackbacks());
  String smallImageFileName=null;
  InputStream smallImageInputStream=null;
  try {
    long smallImageId=blogsEntry.getSmallImageId();
    if (smallImageId != 0) {
      Image smallImage=ImageLocalServiceUtil.getImage(smallImageId);
      if (smallImage != null) {
        smallImageFileName=smallImageId + StringPool.PERIOD + blogsEntry.getSmallImageType();
        byte[] smallImageBytes=smallImage.getTextObj();
        smallImageInputStream=new ByteArrayInputStream(smallImageBytes);
      }
    }
    ServiceContext serviceContext=new ServiceContext();
    BlogsEntryServiceUtil.updateEntry(blogsEntry.getEntryId(),title,summary,content,displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,blogsEntry.getAllowPingbacks(),blogsEntry.isAllowTrackbacks(),trackbacks,blogsEntry.isSmallImage(),blogsEntry.getSmallImageURL(),smallImageFileName,smallImageInputStream,serviceContext);
  }
  finally {
    StreamUtil.cleanUp(smallImageInputStream);
  }
}
