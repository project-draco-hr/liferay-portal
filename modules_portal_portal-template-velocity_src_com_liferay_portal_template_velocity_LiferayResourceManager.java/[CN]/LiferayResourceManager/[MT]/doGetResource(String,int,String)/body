{
  if (resourceType != ResourceManager.RESOURCE_TEMPLATE) {
    return super.getResource(resourceName,resourceType,encoding);
  }
  TemplateResource templateResource=null;
  if (resourceName.startsWith(TemplateConstants.TEMPLATE_RESOURCE_UUID_PREFIX)) {
    templateResource=TemplateResourceThreadLocal.getTemplateResource(TemplateConstants.LANG_TYPE_VM);
  }
 else {
    templateResource=_templateResourceLoader.getTemplateResource(resourceName);
  }
  if (templateResource == null) {
    throw new ResourceNotFoundException("Unable to find Velocity template with ID " + resourceName);
  }
  Object object=_portalCache.get(templateResource);
  if ((object != null) && (object instanceof Template)) {
    return (Template)object;
  }
  Template template=_createTemplate(templateResource);
  if (_resourceModificationCheckInterval != 0) {
    _portalCache.put(templateResource,template);
  }
  return template;
}
