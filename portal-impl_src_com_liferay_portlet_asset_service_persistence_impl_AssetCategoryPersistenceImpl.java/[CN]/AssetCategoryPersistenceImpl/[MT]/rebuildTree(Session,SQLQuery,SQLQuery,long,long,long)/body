{
  List<Long> categoryIds=selectQuery.list();
  long rightCategoryId=leftCategoryId + 1;
  for (  long categoryId : categoryIds) {
    rightCategoryId=rebuildTree(session,selectQuery,updateQuery,groupId,categoryId,rightCategoryId);
  }
  if (parentCategoryId > 0) {
    QueryPos qPos=QueryPos.getInstance(updateQuery);
    qPos.add(leftCategoryId);
    qPos.add(rightCategoryId);
    qPos.add(parentCategoryId);
    updateQuery.executeUpdate();
  }
  return rightCategoryId + 1;
}
