{
  HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
  try {
    if (Validator.isNull(_position)) {
      ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
      if (themeDisplay.isIsolated() || themeDisplay.isLifecycleResource() || themeDisplay.isStateExclusive()) {
        _position=_POSITION_INLINE;
      }
 else {
        _position=_POSITION_AUTO;
      }
    }
    if (_position.equals(_POSITION_INLINE)) {
      ScriptData scriptData=new ScriptData();
      request.setAttribute(ScriptTag.class.getName(),scriptData);
      scriptData.append(_bodyContentString,_use);
      PortalIncludeUtil.include(pageContext,PAGE);
    }
 else {
      ScriptData scriptData=(ScriptData)request.getAttribute(WebKeys.AUI_SCRIPT_DATA);
      if (scriptData == null) {
        scriptData=new ScriptData();
        request.setAttribute(WebKeys.AUI_SCRIPT_DATA,scriptData);
      }
      scriptData.append(_bodyContentString,_use);
    }
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    throw new JspException(e);
  }
 finally {
    if (_position.equals(_POSITION_INLINE)) {
      request.removeAttribute(ScriptTag.class.getName());
    }
  }
}
