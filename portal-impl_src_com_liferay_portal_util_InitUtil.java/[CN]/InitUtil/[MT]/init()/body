{
  if (_initialized) {
    return;
  }
  StopWatch stopWatch=null;
  if (_PRINT_TIME) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  String userLanguage=SystemProperties.get("user.language");
  String userCountry=SystemProperties.get("user.country");
  String userVariant=SystemProperties.get("user.variant");
  LocaleUtil.setDefault(userLanguage,userCountry,userVariant);
  String userTimeZone=SystemProperties.get("user.timezone");
  TimeZoneUtil.setDefault(userTimeZone);
  try {
    Thread currentThread=Thread.currentThread();
    PortalClassLoaderUtil.setClassLoader(currentThread.getContextClassLoader());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (GetterUtil.getBoolean(SystemProperties.get("log4j.configure.on.startup"),true)) {
    ClassLoader classLoader=InitUtil.class.getClassLoader();
    Log4JUtil.configureLog4J(classLoader);
  }
  try {
    LogFactoryUtil.setLogFactory(new Log4jLogFactoryImpl());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  CacheRegistryUtil.setCacheRegistry(new CacheRegistryImpl());
  ConfigurationFactoryUtil.setConfigurationFactory(new ConfigurationFactoryImpl());
  DataSourceFactoryUtil.setDataSourceFactory(new DataSourceFactoryImpl());
  DBFactoryUtil.setDBFactory(new DBFactoryImpl());
  JavaProps.isJDK5();
  XmlReader.setDefaultEncoding(StringPool.UTF8);
  if (_PRINT_TIME) {
    System.out.println("InitAction takes " + stopWatch.getTime() + " ms");
  }
  _initialized=true;
}
