{
  byte[] saltBytes=new byte[2];
  try {
    if (Validator.isNull(cryptString)) {
      Random randomGenerator=new Random();
      int numSaltChars=saltChars.length;
      StringBuilder sb=new StringBuilder();
      int x=Math.abs(randomGenerator.nextInt()) % numSaltChars;
      int y=Math.abs(randomGenerator.nextInt()) % numSaltChars;
      sb.append(saltChars[x]);
      sb.append(saltChars[y]);
      String salt=sb.toString();
      saltBytes=salt.getBytes(Digester.ENCODING);
    }
 else {
      String salt=cryptString.substring(0,3);
      saltBytes=salt.getBytes(Digester.ENCODING);
    }
  }
 catch (  UnsupportedEncodingException uee) {
    throw new PwdEncryptorException("Unable to extract salt from encrypted password: " + uee.getMessage());
  }
  return saltBytes;
}
