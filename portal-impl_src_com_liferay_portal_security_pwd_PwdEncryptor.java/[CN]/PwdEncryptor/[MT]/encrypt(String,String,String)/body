{
  if (algorithm.equals(TYPE_BCRYPT)) {
    byte[] saltBytes=_getSaltFromBCrypt(currentEncryptedPassword);
    return encodePassword(algorithm,clearTextPassword,saltBytes);
  }
 else   if (algorithm.equals(TYPE_UFC_CRYPT)) {
    byte[] saltBytes=_getSaltFromCrypt(currentEncryptedPassword);
    return encodePassword(algorithm,clearTextPassword,saltBytes);
  }
 else   if (algorithm.equals(TYPE_NONE)) {
    return clearTextPassword;
  }
 else   if (algorithm.equals(TYPE_SSHA)) {
    byte[] saltBytes=_getSaltFromSSHA(currentEncryptedPassword);
    return encodePassword(algorithm,clearTextPassword,saltBytes);
  }
 else {
    return encodePassword(algorithm,clearTextPassword,null);
  }
}
