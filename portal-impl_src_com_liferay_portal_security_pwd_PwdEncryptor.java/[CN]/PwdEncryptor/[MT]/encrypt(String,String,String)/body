{
  if (algorithm.equalsIgnoreCase(TYPE_CRYPT) || algorithm.equalsIgnoreCase(TYPE_CRYPT_REVERSE)) {
    byte[] saltBytes=_getSaltFromReverseCrypt(currentEncPwd);
    return encodePassword(algorithm,clearTextPwd,saltBytes);
  }
  if (algorithm.equalsIgnoreCase(TYPE_CRYPT_NORMAL)) {
    byte[] saltBytes=_getSaltFromNormalCrypt(currentEncPwd);
    return encodePassword(algorithm,clearTextPwd,saltBytes);
  }
 else   if (algorithm.equalsIgnoreCase(TYPE_NONE)) {
    return clearTextPwd;
  }
 else   if (algorithm.equalsIgnoreCase(TYPE_SSHA)) {
    byte[] saltBytes=_getSaltFromSSHA(currentEncPwd);
    return encodePassword(algorithm,clearTextPwd,saltBytes);
  }
 else {
    return encodePassword(algorithm,clearTextPwd,null);
  }
}
