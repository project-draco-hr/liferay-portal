{
  byte[] saltBytes=null;
  try {
    if (Validator.isNull(cryptString)) {
      Random random=new Random();
      int numSaltChars=saltChars.length;
      StringBuilder sb=new StringBuilder();
      int x=random.nextInt(Integer.MAX_VALUE) % numSaltChars;
      int y=random.nextInt(Integer.MAX_VALUE) % numSaltChars;
      sb.append(saltChars[x]);
      sb.append(saltChars[y]);
      String salt=sb.toString();
      saltBytes=salt.getBytes(Digester.ENCODING);
    }
 else {
      String salt=cryptString.substring(0,3);
      saltBytes=salt.getBytes(Digester.ENCODING);
    }
  }
 catch (  UnsupportedEncodingException uee) {
    throw new PwdEncryptorException("Unable to extract salt from encrypted password: " + uee.getMessage());
  }
  return saltBytes;
}
