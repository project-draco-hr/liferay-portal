{
  if (permissionChecker.isCompanyAdmin()) {
    return true;
  }
  String category=portlet.getControlPanelEntryCategory();
  if (category == null) {
    category=StringPool.BLANK;
  }
  if (category.startsWith(PortletCategoryKeys.SITE_ADMINISTRATION)) {
    if (permissionChecker.isGroupAdmin(group.getGroupId()) && !group.isUser()) {
      return true;
    }
  }
  long groupId=group.getGroupId();
  if (category.equals(PortletCategoryKeys.CONTROL_PANEL_APPS) || category.equals(PortletCategoryKeys.CONTROL_PANEL_CONFIGURATION) || category.equals(PortletCategoryKeys.CONTROL_PANEL_USERS)|| category.equals(PortletCategoryKeys.SITES)) {
    groupId=0;
  }
  List<String> actions=ResourceActionsUtil.getResourceActions(portlet.getPortletId());
  if (actions.contains(ActionKeys.ACCESS_IN_CONTROL_PANEL) && PortletPermissionUtil.contains(permissionChecker,groupId,0,portlet.getRootPortletId(),ActionKeys.ACCESS_IN_CONTROL_PANEL,true)) {
    return true;
  }
  return false;
}
