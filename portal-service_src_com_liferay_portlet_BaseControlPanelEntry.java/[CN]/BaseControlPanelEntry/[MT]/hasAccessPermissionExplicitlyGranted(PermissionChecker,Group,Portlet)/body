{
  if (permissionChecker.isCompanyAdmin()) {
    return true;
  }
  String category=portlet.getControlPanelEntryCategory();
  if (category == null) {
    category=StringPool.BLANK;
  }
  if (category.startsWith(PortletCategoryKeys.SITE_ADMINISTRATION)) {
    if (group.isLayout() && !portlet.isScopeable()) {
      return false;
    }
    if (permissionChecker.isGroupAdmin(group.getGroupId()) && !group.isUser()) {
      return true;
    }
  }
  long groupId=group.getGroupId();
  if (category.equals(PortletCategoryKeys.CONFIGURATION) || category.equals(PortletCategoryKeys.MARKETPLACE) || category.equals(PortletCategoryKeys.SERVER)|| category.equals(PortletCategoryKeys.SITES)|| category.equals(PortletCategoryKeys.USERS)) {
    groupId=0;
  }
  List<String> actions=ResourceActionsUtil.getResourceActions(portlet.getPortletId());
  if (actions.contains(ActionKeys.ACCESS_IN_CONTROL_PANEL) && PortletPermissionUtil.contains(permissionChecker,groupId,getDefaultPlid(group,category),portlet.getPortletId(),ActionKeys.ACCESS_IN_CONTROL_PANEL,true)) {
    return true;
  }
  return false;
}
