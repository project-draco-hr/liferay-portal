{
  for (  long companyId : PortalInstances.getCompanyIds()) {
    String fileName=null;
    if (initialize) {
      fileName=SystemProperties.get(SystemProperties.TMP_DIR) + "/temp-init-lucene-" + companyId+ "-"+ System.currentTimeMillis();
      Runtime runtime=Runtime.getRuntime();
      runtime.addShutdownHook(new DeleteFileShutdownHook(fileName));
    }
 else {
      fileName=SystemProperties.get(SystemProperties.TMP_DIR) + "/temp-lucene-" + companyId+ "-"+ System.currentTimeMillis();
    }
    try {
      LuceneHelperUtil.dumpIndex(TestPropsValues.getCompanyId(),new FileOutputStream(fileName));
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
 finally {
      if (initialize) {
        _initLuceneFileNames.put(companyId,fileName);
      }
 else {
        _luceneFileNames.put(companyId,fileName);
      }
    }
  }
}
