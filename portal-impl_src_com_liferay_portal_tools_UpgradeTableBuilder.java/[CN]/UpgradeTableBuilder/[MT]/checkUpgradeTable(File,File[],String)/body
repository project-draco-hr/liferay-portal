{
  boolean currentRelease=version.equals(ReleaseInfo.getVersion());
  if (!currentRelease && !upgradeDir.exists()) {
    return;
  }
  File indexesFile=null;
  if (currentRelease) {
    indexesFile=new File("../sql/indexes.sql");
  }
 else {
    indexesFile=new File(upgradeDir,"indexes.sql");
  }
  for (  File file : files) {
    String fileName=file.getName();
    if (!fileName.endsWith("Table.java")) {
      continue;
    }
    String modelName=fileName.substring(0,fileName.length() - 10);
    File upgradeFile=null;
    if (currentRelease) {
      String upgradeFileName=_findUpgradeFileName(modelName);
      if (upgradeFileName == null) {
        continue;
      }
      upgradeFile=new File("src",upgradeFileName);
    }
 else {
      String modelImplFileName=modelName + "ModelImpl.java";
      upgradeFile=new File(upgradeDir,modelImplFileName);
    }
    if (!upgradeFile.exists()) {
      continue;
    }
    String content=_fileUtil.read(upgradeFile);
    String packagePath="com.liferay.portal.upgrade.v" + StringUtil.replace(version,".","_") + ".util";
    String className=modelName + "Table";
    String author=_getAuthor(fileName);
    String[] addIndexes=_getAddIndexes(indexesFile,modelName);
    content=_getContent(packagePath,className,content,author,addIndexes);
    _fileUtil.write(file,content);
  }
}
