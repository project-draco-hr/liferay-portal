{
  PortalClassLoaderUtil.setClassLoader(MessageDatagramReceiveHandlerTest.class.getClassLoader());
  Message message=new Message();
  String testDestinationName="testDestination";
  message.setDestinationName(testDestinationName);
  String testPayload="testPayload";
  message.setPayload(testPayload);
  Serializer serializer=new Serializer();
  serializer.writeObject(message);
  SystemDataType systemDataType=SystemDataType.MESSAGE;
  Datagram datagram=Datagram.createRequestDatagram(systemDataType.getValue(),serializer.toByteBuffer());
  MessageDatagramReceiveHandler messageDatagramReceiveHandler=new MessageDatagramReceiveHandler();
  messageDatagramReceiveHandler.doReceive(_mockRegistrationReference,datagram);
  Assert.assertEquals(testDestinationName,MessageBusUtilAdvice._destinationNamse);
  Assert.assertNotNull(MessageBusUtilAdvice._message);
  Message recordedMessage=MessageBusUtilAdvice._message;
  Assert.assertEquals(testPayload,recordedMessage.getPayload());
}
