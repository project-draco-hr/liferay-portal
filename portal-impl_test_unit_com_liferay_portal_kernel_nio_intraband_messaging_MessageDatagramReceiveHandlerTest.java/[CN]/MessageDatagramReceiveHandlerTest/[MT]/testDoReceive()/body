{
  PortalClassLoaderUtil.setClassLoader(MessageDatagramReceiveHandlerTest.class.getClassLoader());
  MessageDatagramReceiveHandler messageDatagramReceiveHandler=new MessageDatagramReceiveHandler();
  SystemDataType systemDataType=SystemDataType.MESSAGE;
  Serializer serializer=new Serializer();
  Message message=new Message();
  String destinationName=MessageDatagramReceiveHandlerTest.class.getName();
  message.setDestinationName(destinationName);
  String payload="payload";
  message.setPayload(payload);
  serializer.writeObject(message);
  Datagram datagram=Datagram.createRequestDatagram(systemDataType.getValue(),serializer.toByteBuffer());
  messageDatagramReceiveHandler.doReceive(_mockRegistrationReference,datagram);
  Assert.assertEquals(destinationName,MessageBusUtilAdvice._destinationNamse);
  Assert.assertNotNull(MessageBusUtilAdvice._message);
  Message recordedMessage=MessageBusUtilAdvice._message;
  Assert.assertEquals(payload,recordedMessage.getPayload());
}
