{
  File fileNameDir=getFileNameDir(companyId,repositoryId,fileName);
  File newFileNameDir=getFileNameDir(companyId,repositoryId,newFileName);
  if (newFileNameDir.exists()) {
    throw new DuplicateFileException(newFileName);
  }
  File parentFile=fileNameDir.getParentFile();
  boolean renamed=fileNameDir.renameTo(newFileNameDir);
  if (!renamed) {
    throw new SystemException("File name directory was not renamed from " + fileNameDir.getPath() + " to "+ newFileNameDir.getPath());
  }
  deleteEmptyAncestors(companyId,repositoryId,parentFile);
}
