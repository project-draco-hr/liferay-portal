{
  if ((add == null) || (delimiter == null)) {
    return null;
  }
  if (s == null) {
    s=StringPool.BLANK;
  }
  if (allowDuplicates || !contains(s,add,delimiter)) {
    StringBundler sb=new StringBundler(4);
    sb.append(s);
    if (Validator.isNull(s) || s.endsWith(delimiter)) {
      sb.append(add);
      sb.append(delimiter);
    }
 else {
      sb.append(delimiter);
      sb.append(add);
      sb.append(delimiter);
    }
    s=sb.toString();
  }
  return s;
}
