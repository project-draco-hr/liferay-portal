{
  long companyId=PortalUtil.getCompanyId(actionRequest);
  String pluginId=ParamUtil.getString(actionRequest,"pluginId");
  String pluginType=ParamUtil.getString(actionRequest,"pluginType");
  String[] rolesArray=StringUtil.split(ParamUtil.getString(actionRequest,"roles"),'\n');
  Arrays.sort(rolesArray);
  String roles=StringUtil.merge(rolesArray);
  boolean active=ParamUtil.getBoolean(actionRequest,"active");
  if (pluginType.equals(Plugin.TYPE_PORTLET)) {
    String portletId=pluginId;
    _portletService.updatePortlet(companyId,portletId,StringPool.BLANK,active);
  }
 else {
    _pluginSettingService.updatePluginSetting(companyId,pluginId,pluginType,roles,active);
  }
}
