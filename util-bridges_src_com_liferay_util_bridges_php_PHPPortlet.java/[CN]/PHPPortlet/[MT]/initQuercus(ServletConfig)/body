{
  if (quercusServlet != null) {
    return;
  }
  try {
    SchemeMap schemeMap=Vfs.getDefaultScheme();
    URI rootURI=ServletContextUtil.getRootURI(servletConfig.getServletContext());
    schemeMap.put(rootURI.getScheme(),new ServletContextPath(servletConfig.getServletContext()));
    Path.setDefaultSchemeMap(schemeMap);
    quercusServlet=(HttpServlet)InstanceFactory.newInstance(_QUERCUS_SERVLET);
    Map<String,String> params=new HashMap<String,String>();
    Enumeration<String> enu=servletConfig.getInitParameterNames();
    while (enu.hasMoreElements()) {
      String name=enu.nextElement();
      if (!name.equals("portlet-class")) {
        params.put(name,servletConfig.getInitParameter(name));
      }
    }
    servletConfig=new DynamicServletConfig(servletConfig,params);
    Properties properties=PropsUtil.getProperties(PropsKeys.PORTLET_BRIDGES_PHP_PROPERTIES,true);
    QuercusServlet qs=(QuercusServlet)quercusServlet;
    PhpIni phpIni=qs.createPhpIni();
    for (    Map.Entry<Object,Object> entry : properties.entrySet()) {
      String key=(String)entry.getKey();
      String value=(String)entry.getValue();
      if (_log.isInfoEnabled()) {
        _log.info("Setting php.ini property: " + key + " = "+ value);
      }
      phpIni.setProperty(key,value);
    }
    quercusServlet.init(servletConfig);
  }
 catch (  Exception e) {
    throw new PortletException(e);
  }
}
