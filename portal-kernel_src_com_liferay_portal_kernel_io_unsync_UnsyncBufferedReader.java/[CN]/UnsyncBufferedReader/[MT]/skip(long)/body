{
  if (reader == null) {
    throw new IOException("Reader closed");
  }
  if (n <= 0) {
    return 0;
  }
  long skipped=0;
  long inBufferAvailable=firstInvalidIndex - index;
  if (inBufferAvailable > 0) {
    if (inBufferAvailable < n) {
      skipped=inBufferAvailable;
    }
 else {
      skipped=n;
    }
  }
 else {
    if (markIndex < 0) {
      skipped=reader.skip(n);
    }
 else {
      readUnderlyingReader();
      inBufferAvailable=firstInvalidIndex - index;
      if (inBufferAvailable > 0) {
        if (inBufferAvailable < n) {
          skipped=inBufferAvailable;
        }
 else {
          skipped=n;
        }
      }
    }
  }
  index+=skipped;
  return skipped;
}
