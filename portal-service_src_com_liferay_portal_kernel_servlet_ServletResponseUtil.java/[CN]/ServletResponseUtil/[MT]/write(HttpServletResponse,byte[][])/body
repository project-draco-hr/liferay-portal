{
  try {
    if (!response.isCommitted()) {
      long contentLength=0;
      for (      byte[] bytes : bytesArray) {
        contentLength+=bytes.length;
      }
      response.setHeader(HttpHeaders.CONTENT_LENGTH,String.valueOf(contentLength));
      response.flushBuffer();
      ServletOutputStream servletOutputStream=response.getOutputStream();
      for (      byte[] bytes : bytesArray) {
        servletOutputStream.write(bytes);
      }
    }
  }
 catch (  IOException ioe) {
    if ((ioe instanceof SocketException) || isClientAbortException(ioe)) {
      if (_log.isWarnEnabled()) {
        _log.warn(ioe);
      }
    }
 else {
      throw ioe;
    }
  }
}
