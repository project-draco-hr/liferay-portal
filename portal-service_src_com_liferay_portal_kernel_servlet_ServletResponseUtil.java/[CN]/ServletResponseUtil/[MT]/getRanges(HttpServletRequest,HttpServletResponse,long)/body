{
  String rangeString=request.getHeader(HttpHeaders.RANGE);
  if (Validator.isNull(rangeString)) {
    return Collections.emptyList();
  }
  if (!rangeString.matches(_RANGE_REGEX)) {
    throw new IOException("Range header does not match regular expression");
  }
  List<Range> ranges=new ArrayList<Range>();
  for (  String part : StringUtil.split(rangeString.substring(6))) {
    int index=part.indexOf(StringPool.DASH);
    long start=GetterUtil.getLong(part.substring(0,index),-1);
    long end=GetterUtil.getLong(part.substring(index + 1,part.length()),-1);
    if (start == -1) {
      start=length - end;
      end=length - 1;
    }
 else     if ((end == -1) || (end > length - 1)) {
      end=length - 1;
    }
    if (start > end) {
      throw new IOException("Range start " + start + " is greater than end "+ end);
    }
    Range range=new Range(start,end,length);
    ranges.add(range);
  }
  return ranges;
}
