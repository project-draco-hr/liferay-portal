{
  Bundle bundle=serviceReference.getBundle();
  BundleContext bundleContext=bundle.getBundleContext();
  bundleContext.ungetService(serviceReference);
  StorageType storageType=StorageType.MEMORY_CLUSTERED;
  SchedulerEntry schedulerEntry=schedulerEntryMessageListener.getSchedulerEntry();
  if (schedulerEntry == null) {
    return;
  }
  if (schedulerEntry instanceof StorageTypeAware) {
    StorageTypeAware storageTypeAware=(StorageTypeAware)schedulerEntry;
    storageType=storageTypeAware.getStorageType();
  }
  SchedulerClusterInvokingThreadLocal.setEnabled(false);
  try {
    unschedule(schedulerEntry,storageType);
  }
 catch (  SchedulerException se) {
    _log.error(se,se);
  }
 finally {
    SchedulerClusterInvokingThreadLocal.setEnabled(true);
  }
  ServiceRegistration<MessageListener> messageListenerServiceRegistration=_messageListenerServiceRegistrations.get(schedulerEntry.getEventListenerClass());
  messageListenerServiceRegistration.unregister();
}
