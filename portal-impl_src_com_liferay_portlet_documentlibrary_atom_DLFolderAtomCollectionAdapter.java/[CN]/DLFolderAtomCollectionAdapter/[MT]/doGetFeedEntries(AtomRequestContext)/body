{
  long groupId=0;
  long parentFolderId=atomRequestContext.getLongParameter("parentFolderId");
  if (parentFolderId != 0) {
    DLFolder dlParentFolder=DLFolderServiceUtil.getFolder(parentFolderId);
    groupId=dlParentFolder.getGroupId();
  }
 else {
    groupId=atomRequestContext.getLongParameter("groupId");
  }
  int max=atomRequestContext.getIntParameter("max",SearchContainer.DEFAULT_DELTA);
  int page=atomRequestContext.getIntParameter("page");
  int dlFoldersCount=DLFolderServiceUtil.getFoldersCount(groupId,parentFolderId);
  AtomPager atomPager=new AtomPager(page,dlFoldersCount,max);
  AtomUtil.saveAtomPagerInRequest(atomRequestContext,atomPager);
  return DLFolderServiceUtil.getFolders(groupId,parentFolderId,atomPager.getStart(),atomPager.getEnd() + 1,new EntryNameComparator());
}
