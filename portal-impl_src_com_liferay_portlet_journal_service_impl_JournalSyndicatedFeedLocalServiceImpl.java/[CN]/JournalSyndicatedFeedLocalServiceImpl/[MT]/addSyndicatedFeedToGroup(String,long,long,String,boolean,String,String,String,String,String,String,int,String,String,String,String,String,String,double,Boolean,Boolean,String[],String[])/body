{
  User user=userPersistence.findByPrimaryKey(userId);
  Date now=new Date();
  validate(groupId,feedId,autoFeedId,name,description,structureId,contentField,targetLayoutFriendlyUrl);
  long id=counterLocalService.increment();
  JournalSyndicatedFeed synFeed=journalSyndicatedFeedPersistence.create(id);
  synFeed.setUuid(uuid);
  synFeed.setGroupId(groupId);
  synFeed.setCompanyId(user.getCompanyId());
  synFeed.setUserId(user.getUserId());
  synFeed.setUserName(user.getFullName());
  synFeed.setCreateDate(now);
  synFeed.setModifiedDate(now);
  synFeed.setFeedId(feedId);
  synFeed.setName(name);
  synFeed.setDescription(description);
  synFeed.setType(type);
  synFeed.setStructureId(structureId);
  synFeed.setTemplateId(templateId);
  synFeed.setRendererTemplateId(rendererTemplateId);
  synFeed.setDelta(delta);
  synFeed.setOrderByCol(orderByCol);
  synFeed.setOrderByType(orderByType);
  synFeed.setTargetLayoutFriendlyUrl(targetLayoutFriendlyUrl);
  synFeed.setTargetPortletId(targetPortletId);
  synFeed.setContentField(contentField);
  if (Validator.isNull(feedType)) {
    synFeed.setFeedType(RSSUtil.DEFAULT_TYPE);
    synFeed.setFeedVersion(RSSUtil.DEFAULT_VERSION);
  }
 else {
    synFeed.setFeedType(feedType);
    synFeed.setFeedVersion(feedVersion);
  }
  journalSyndicatedFeedPersistence.update(synFeed);
  if ((addCommunityPermissions != null) && (addGuestPermissions != null)) {
    addSyndicatedFeedResources(synFeed,addCommunityPermissions.booleanValue(),addGuestPermissions.booleanValue());
  }
 else {
    addSyndicatedFeedResources(synFeed,communityPermissions,guestPermissions);
  }
  return synFeed;
}
