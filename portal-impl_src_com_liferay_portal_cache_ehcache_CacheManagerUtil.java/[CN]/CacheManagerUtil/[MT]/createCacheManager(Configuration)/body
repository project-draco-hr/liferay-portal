{
  CacheManager cacheManager=new CacheManager(configuration);
  try {
    ScheduledThreadPoolExecutor scheduledThreadPoolExecutor=(ScheduledThreadPoolExecutor)_STATISTICS_EXECUTOR_FIELD.get(cacheManager);
    BlockingQueue<Runnable> blockingQueue=null;
    if (JavaDetector.isJDK6()) {
      blockingQueue=(BlockingQueue<Runnable>)_WORK_QUEUE_FIELD.get(scheduledThreadPoolExecutor);
      _WORK_QUEUE_FIELD.set(scheduledThreadPoolExecutor,new DelayQueue<RunnableScheduledFuture<?>>(){
        @Override public int remainingCapacity(){
          return 0;
        }
      }
);
    }
    scheduledThreadPoolExecutor.setCorePoolSize(PropsValues.EHCACHE_CACHE_MANAGER_STATISTICS_THREAD_POOL_SIZE);
    if (JavaDetector.isJDK6()) {
      while (scheduledThreadPoolExecutor.getPoolSize() > PropsValues.EHCACHE_CACHE_MANAGER_STATISTICS_THREAD_POOL_SIZE)       ;
      _WORK_QUEUE_FIELD.set(scheduledThreadPoolExecutor,blockingQueue);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return cacheManager;
}
