{
  Registry registry=RegistryUtil.getRegistry();
  PortletConfigurationIconFactory portletConfigurationIconFactory=registry.getService(serviceReference);
  String portletId=(String)serviceReference.getProperty("javax.portlet.name");
  if (Validator.isNull(portletId)) {
    portletId=StringPool.STAR;
  }
  List<PortletConfigurationIconFactory> portletConfigurationIconFactories=_portletConfigurationIconFactoriesMap.get(portletId);
  if (portletConfigurationIconFactories == null) {
    portletConfigurationIconFactories=new ArrayList<>();
    _portletConfigurationIconFactoriesMap.put(portletId,portletConfigurationIconFactories);
  }
  portletConfigurationIconFactories.add(portletConfigurationIconFactory);
  return portletConfigurationIconFactory;
}
