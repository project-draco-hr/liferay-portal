{
  ServiceTestUtil.setUser(authorUser);
  try {
    Folder folder=DLAppServiceUtil.getFolder(_folder.getFolderId());
    Date lastPostDate=folder.getLastPostDate();
    String fileName="OverrideCheckoutTest.txt";
    FileEntry fileEntry=createFileEntry(fileName);
    long fileEntryId=fileEntry.getFileEntryId();
    DLAppServiceUtil.checkOutFileEntry(fileEntryId,_serviceContext);
    ServiceTestUtil.setUser(overriderUser);
    try {
      DLAppServiceUtil.cancelCheckOut(fileEntryId);
      Assert.assertTrue("Should not have succeeded cancel check out",expectOverride);
    }
 catch (    Exception e) {
      Assert.assertFalse("Should not have failed cancel check out " + e,expectOverride);
    }
    if (expectOverride) {
      ServiceTestUtil.setUser(authorUser);
      DLAppServiceUtil.checkOutFileEntry(fileEntryId,_serviceContext);
      updateFileEntry(fileEntryId,fileName);
      ServiceTestUtil.setUser(overriderUser);
    }
    try {
      DLAppServiceUtil.checkInFileEntry(fileEntryId,false,StringPool.NULL,_serviceContext);
      Assert.assertTrue("Should not have succeeded check in",expectOverride);
      folder=DLAppServiceUtil.getFolder(_folder.getFolderId());
      Assert.assertFalse(lastPostDate.after(folder.getLastPostDate()));
      fileEntry=DLAppServiceUtil.getFileEntry(fileEntryId);
      Assert.assertEquals("1.1",fileEntry.getVersion());
    }
 catch (    Exception e) {
      Assert.assertFalse("Should not have failed check in " + e,expectOverride);
    }
  }
  finally {
    ServiceTestUtil.setUser(TestPropsValues.getUser());
  }
}
