{
  int lastPos=_sizes.getPosition(index) + _textTopInset;
  int height=_textFontHeight;
  try {
    Element map=_textComponent.getDocument().getDefaultRootElement();
    int lastChar=map.getElement(index).getEndOffset() - 1;
    Rectangle r=_textComponent.modelToView(lastChar);
    if (r != null) {
      height=(r.y - lastPos) + r.height;
    }
  }
 catch (  BadLocationException ex) {
    ex.printStackTrace();
  }
  return height;
}
