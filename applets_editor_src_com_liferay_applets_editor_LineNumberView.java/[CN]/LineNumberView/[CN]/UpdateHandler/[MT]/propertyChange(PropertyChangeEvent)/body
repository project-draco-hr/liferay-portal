{
  Object oldValue=evt.getOldValue();
  Object newValue=evt.getNewValue();
  String propertyName=evt.getPropertyName();
  if ("document".equals(propertyName)) {
    if (oldValue != null && oldValue instanceof Document) {
      ((Document)oldValue).removeDocumentListener(this);
    }
    if (newValue != null && newValue instanceof Document) {
      ((Document)newValue).addDocumentListener(this);
    }
  }
  updateCachedMetrics();
  viewChanged(0,true);
}
