{
  int size=GetterUtil.getInteger(PropsUtil.get(PropsKeys.MODEL_TREE_REBUILD_QUERY_RESULTS_BATCH_SIZE));
  Deque<Object[]> traces=new LinkedList<Object[]>();
  traces.push(new Object[]{defaultParentPrimaryKey,StringPool.SLASH,0L});
  Object[] trace=null;
  while ((trace=traces.poll()) != null) {
    Long parentPrimaryKey=(Long)trace[0];
    String parentPath=(String)trace[1];
    Long previousPrimaryKey=(Long)trace[2];
    List<? extends TreeModel> treeModels=treeModelFinder.findTreeModels(previousPrimaryKey,companyId,parentPrimaryKey,size);
    if (treeModels.isEmpty()) {
      continue;
    }
    if (treeModels.size() == size) {
      trace[2]=treeModels.get(treeModels.size() - 1);
      traces.push(trace);
    }
    for (    TreeModel treeModel : treeModels) {
      String treePath=parentPath.concat(String.valueOf(treeModel.getPrimaryKeyObj())).concat(StringPool.SLASH);
      treeModel.updateTreePath(treePath);
      traces.push(new Object[]{treeModel.getPrimaryKeyObj(),treePath,0L});
    }
  }
}
