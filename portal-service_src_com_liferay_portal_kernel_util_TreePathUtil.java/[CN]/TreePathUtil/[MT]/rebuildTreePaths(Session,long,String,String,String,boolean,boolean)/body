{
  StringBundler sb=new StringBundler(26);
  sb.append("update ");
  sb.append(tableName);
  sb.append(" set ");
  if (rootParent) {
    sb.append("treePath = '/0/' ");
  }
 else {
    sb.append("treePath = (select ");
    sb.append(parentTableName);
    sb.append(".treePath from ");
    sb.append(parentTableName);
    sb.append(" where ");
    sb.append(parentTableName);
    sb.append(".");
    sb.append(parentPrimaryKeyColumnName);
    sb.append(" = ");
    sb.append(tableName);
    sb.append(".");
    sb.append(parentPrimaryKeyColumnName);
    sb.append(") ");
  }
  sb.append("where (");
  sb.append(tableName);
  sb.append(".companyId = ?) and (");
  sb.append(tableName);
  sb.append(".");
  sb.append(parentPrimaryKeyColumnName);
  if (rootParent) {
    sb.append(" = 0)");
  }
 else {
    sb.append(" != 0)");
  }
  if (statusColumn) {
    sb.append(" and (");
    sb.append(tableName);
    sb.append(".status != ?)");
  }
  SQLQuery sqlQuery=session.createSynchronizedSQLQuery(sb.toString());
  QueryPos qPos=QueryPos.getInstance(sqlQuery);
  qPos.add(companyId);
  if (statusColumn) {
    qPos.add(WorkflowConstants.STATUS_IN_TRASH);
  }
  sqlQuery.executeUpdate();
}
