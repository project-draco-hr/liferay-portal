{
  Activity activity=null;
  String className=socialActivity.getClassName();
  if (className.equals(Activity.class.getName())) {
    activity=getExternalActivity(socialActivity);
  }
 else {
    activity=new ActivityImpl(String.valueOf(socialActivity.getClassPK()),String.valueOf(socialActivity.getUserId()));
    HttpServletRequest request=HttpServletRequestThreadLocal.getHttpServletRequest();
    request.setAttribute(WebKeys.THEME_DISPLAY,themeDisplay);
    ServiceContext serviceContext=ServiceContextFactory.getInstance(request);
    serviceContext.setCompanyId(themeDisplay.getCompanyId());
    serviceContext.setUserId(themeDisplay.getUserId());
    SocialActivityFeedEntry socialActivityFeedEntry=SocialActivityInterpreterLocalServiceUtil.interpret(StringPool.BLANK,socialActivity,serviceContext);
    activity.setBody(socialActivityFeedEntry.getBody());
    activity.setTitle(socialActivityFeedEntry.getTitle());
    activity.setUrl(socialActivityFeedEntry.getLink());
  }
  return activity;
}
