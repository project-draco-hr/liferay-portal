{
  clearInstalledAppsCache();
  App app=appPersistence.findByRemoteAppId(remoteAppId);
  List<Module> modules=modulePersistence.findByAppId(app.getAppId());
  for (  Module module : modules) {
    moduleLocalService.deleteModule(module.getModuleId());
    if (module.isBundle()) {
      BundleUtil.uninstallBundle(module.getBundleSymbolicName(),module.getBundleVersion());
      continue;
    }
    if (hasDependentApp(module)) {
      continue;
    }
    try {
      DeployManagerUtil.undeploy(module.getContextName());
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
}
