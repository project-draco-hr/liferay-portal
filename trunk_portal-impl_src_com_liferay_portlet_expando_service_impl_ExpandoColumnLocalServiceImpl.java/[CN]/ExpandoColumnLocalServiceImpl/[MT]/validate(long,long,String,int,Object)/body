{
  if (Validator.isNull(name)) {
    throw new ColumnNameException();
  }
  ExpandoColumn column=expandoColumnPersistence.fetchByT_N(tableId,name);
  if ((column != null) && (column.getColumnId() != columnId)) {
    throw new DuplicateColumnNameException();
  }
  if ((type != ExpandoColumnConstants.BOOLEAN) && (type != ExpandoColumnConstants.BOOLEAN_ARRAY) && (type != ExpandoColumnConstants.DATE)&& (type != ExpandoColumnConstants.DATE_ARRAY)&& (type != ExpandoColumnConstants.DOUBLE)&& (type != ExpandoColumnConstants.DOUBLE_ARRAY)&& (type != ExpandoColumnConstants.FLOAT)&& (type != ExpandoColumnConstants.FLOAT_ARRAY)&& (type != ExpandoColumnConstants.INTEGER)&& (type != ExpandoColumnConstants.INTEGER_ARRAY)&& (type != ExpandoColumnConstants.LONG)&& (type != ExpandoColumnConstants.LONG_ARRAY)&& (type != ExpandoColumnConstants.SHORT)&& (type != ExpandoColumnConstants.SHORT_ARRAY)&& (type != ExpandoColumnConstants.STRING)&& (type != ExpandoColumnConstants.STRING_ARRAY)) {
    throw new ColumnTypeException();
  }
  ExpandoValue value=new ExpandoValueImpl();
  if (defaultData != null) {
    value.setColumnId(columnId);
    if (type == ExpandoColumnConstants.BOOLEAN) {
      value.setBoolean((Boolean)defaultData);
    }
 else     if (type == ExpandoColumnConstants.BOOLEAN_ARRAY) {
      value.setBooleanArray((boolean[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.DATE) {
      value.setDate((Date)defaultData);
    }
 else     if (type == ExpandoColumnConstants.DATE_ARRAY) {
      value.setDateArray((Date[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.DOUBLE) {
      value.setDouble((Double)defaultData);
    }
 else     if (type == ExpandoColumnConstants.DOUBLE_ARRAY) {
      value.setDoubleArray((double[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.FLOAT) {
      value.setFloat((Float)defaultData);
    }
 else     if (type == ExpandoColumnConstants.FLOAT_ARRAY) {
      value.setFloatArray((float[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.INTEGER) {
      value.setInteger((Integer)defaultData);
    }
 else     if (type == ExpandoColumnConstants.INTEGER_ARRAY) {
      value.setIntegerArray((int[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.LONG) {
      value.setLong((Long)defaultData);
    }
 else     if (type == ExpandoColumnConstants.LONG_ARRAY) {
      value.setLongArray((long[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.SHORT) {
      value.setShort((Short)defaultData);
    }
 else     if (type == ExpandoColumnConstants.SHORT_ARRAY) {
      value.setShortArray((short[])defaultData);
    }
 else     if (type == ExpandoColumnConstants.STRING) {
      value.setString((String)defaultData);
    }
 else     if (type == ExpandoColumnConstants.STRING_ARRAY) {
      value.setStringArray((String[])defaultData);
    }
  }
  return value;
}
