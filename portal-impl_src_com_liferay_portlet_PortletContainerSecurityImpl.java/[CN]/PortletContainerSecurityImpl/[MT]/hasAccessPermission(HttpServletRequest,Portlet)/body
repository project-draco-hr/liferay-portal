{
  Layout layout=(Layout)request.getAttribute(WebKeys.LAYOUT);
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long scopeGroupId=themeDisplay.getScopeGroupId();
  PortletMode portletMode=PortletModeFactory.getPortletMode(ParamUtil.getString(request,"p_p_mode"));
  boolean access=PortletPermissionUtil.hasAccessPermission(permissionChecker,scopeGroupId,layout,portlet,portletMode);
  return access;
}
