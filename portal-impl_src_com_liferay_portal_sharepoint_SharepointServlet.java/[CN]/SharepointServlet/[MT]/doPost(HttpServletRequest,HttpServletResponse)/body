{
  try {
    String uri=request.getRequestURI();
    if (uri.equals("/_vti_bin/shtml.dll/_vti_rpc") || uri.equals("/sharepoint/_vti_bin/_vti_aut/author.dll")) {
      User user=(User)request.getSession().getAttribute(WebKeys.USER);
      SharepointRequest sharepointRequest=new SharepointRequest(request,response,user);
      addParams(request,sharepointRequest);
      Method method=MethodFactory.create(sharepointRequest);
      String rootPath=method.getRootPath(sharepointRequest);
      sharepointRequest.setRootPath(rootPath);
      SharepointStorage storage=getStorage(rootPath);
      sharepointRequest.setSharepointStorage(storage);
      method.process(sharepointRequest);
    }
  }
 catch (  SharepointException se) {
    _log.error(se,se);
  }
}
