{
  WikiNode destinationNode=WikiTestUtil.addNode(_group.getGroupId());
  WikiTestUtil.addPage(TestPropsValues.getUserId(),_group.getGroupId(),_node.getNodeId(),"ParentPage",true);
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId());
  WikiTestUtil.addPage(TestPropsValues.getUserId(),_node.getNodeId(),"DuplicatedTitlePage","content","ParentPage",true,serviceContext);
  WikiTestUtil.addPage(TestPropsValues.getUserId(),_group.getGroupId(),destinationNode.getNodeId(),"DuplicatedTitlePage",true);
  try {
    WikiPageLocalServiceUtil.changeNode(TestPropsValues.getUserId(),_node.getNodeId(),"ParentPage",destinationNode.getNodeId(),serviceContext);
    Assert.fail();
  }
 catch (  NodeChangeException nce) {
    Assert.assertEquals("DuplicatedTitlePage",nce.getPageTitle());
    Assert.assertEquals(destinationNode.getName(),nce.getNodeName());
    Assert.assertEquals(NodeChangeException.DUPLICATE_PAGE,nce.getType());
  }
}
