{
  String source=(String)sourceStringList.get(sourceChangedLine);
  String target=(String)targetStringList.get(targetChangedLine);
  List sourceList=_toList(source);
  List targetList=_toList(target);
  Diff diff=new Diff(sourceList,targetList);
  List differences=diff.diff();
  Iterator itr=differences.iterator();
  int deletedChars=0;
  int addedChars=0;
  while (itr.hasNext() && !aligned) {
    Difference difference=(Difference)itr.next();
    if (difference.getDeletedEnd() != Difference.NONE) {
      deletedChars=deletedChars + (difference.getDeletedEnd() - difference.getDeletedStart() + 1);
    }
    if (difference.getAddedEnd() != Difference.NONE) {
      addedChars=addedChars + (difference.getAddedEnd() - difference.getAddedStart() + 1);
    }
  }
  if ((deletedChars > (sourceList.size() / 2)) || (addedChars > sourceList.size() / 2)) {
    return false;
  }
  itr=differences.iterator();
  boolean sourceChanged=false;
  boolean targetChanged=false;
  while (itr.hasNext()) {
    Difference difference=(Difference)itr.next();
    if (difference.getAddedEnd() == Difference.NONE) {
      _highlight(sourceList,difference.getDeletedStart(),difference.getDeletedEnd(),deletedMarkerStart,deletedMarkerEnd);
      sourceChanged=true;
    }
 else     if (difference.getDeletedEnd() == Difference.NONE) {
      _highlight(targetList,difference.getAddedStart(),difference.getAddedEnd(),addedMarkerStart,addedMarkerEnd);
      targetChanged=true;
    }
 else {
      _highlight(sourceList,difference.getDeletedStart(),difference.getDeletedEnd(),deletedMarkerStart,deletedMarkerEnd);
      sourceChanged=true;
      _highlight(targetList,difference.getAddedStart(),difference.getAddedEnd(),addedMarkerStart,addedMarkerEnd);
      targetChanged=true;
    }
  }
  if (sourceChanged) {
    DiffResult diffResult=new DiffResult(DiffResult.SOURCE,sourceChangedLine,_toString(sourceList));
    results.add(diffResult);
  }
  if (targetChanged) {
    DiffResult diffResult=new DiffResult(DiffResult.TARGET,targetChangedLine,_toString(targetList));
    results.add(diffResult);
  }
  return true;
}
