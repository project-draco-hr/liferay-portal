{
  SyncEngineUtil.fireSyncEngineStateChanged(SyncEngineUtil.SYNC_ENGINE_STATE_STOPPING);
  _logger.info("Stopping {}",PropsValues.SYNC_PRODUCT_NAME);
  for (  long syncAccountId : _syncAccountTasks.keySet()) {
    cancelSyncAccountTasks(syncAccountId);
  }
  _remoteEventsScheduledExecutorService.shutdownNow();
  _executorService.shutdownNow();
  _localEventsScheduledExecutorService.shutdownNow();
  SyncClientUpdater.cancelAutoUpdateChecker();
  SyncAccountPersistence syncAccountPersistence=SyncAccountService.getSyncAccountPersistence();
  ConnectionSource connectionSource=syncAccountPersistence.getConnectionSource();
  connectionSource.closeQuietly();
  SyncEngineUtil.fireSyncEngineStateChanged(SyncEngineUtil.SYNC_ENGINE_STATE_STOPPED);
  _running=false;
}
