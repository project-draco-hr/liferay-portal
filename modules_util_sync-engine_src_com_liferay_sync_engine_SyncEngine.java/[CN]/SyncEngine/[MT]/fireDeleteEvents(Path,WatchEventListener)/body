{
  long startTime=System.currentTimeMillis();
  Files.walkFileTree(filePath,new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult preVisitDirectory(    Path filePath,    BasicFileAttributes basicFileAttributes){
      SyncFile syncFile=SyncFileService.fetchSyncFile(filePath.toString());
      if (syncFile != null) {
        syncFile.setLocalSyncTime(System.currentTimeMillis());
        SyncFileService.update(syncFile);
      }
      return FileVisitResult.CONTINUE;
    }
    @Override public FileVisitResult visitFile(    Path filePath,    BasicFileAttributes basicFileAttributes){
      SyncFile syncFile=SyncFileService.fetchSyncFile(filePath.toString());
      if (syncFile != null) {
        syncFile.setLocalSyncTime(System.currentTimeMillis());
        SyncFileService.update(syncFile);
      }
      return FileVisitResult.CONTINUE;
    }
  }
);
  List<SyncFile> deletedSyncFiles=SyncFileService.findSyncFiles(filePath.toString(),startTime);
  for (  SyncFile deletedSyncFile : deletedSyncFiles) {
    if (deletedSyncFile.getUiEvent() == SyncFile.UI_EVENT_FILE_NAME_TOO_LONG) {
      continue;
    }
    watchEventListener.watchEvent(SyncWatchEvent.EVENT_TYPE_DELETE,Paths.get(deletedSyncFile.getFilePathName()));
  }
}
