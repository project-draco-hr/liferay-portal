{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  String displayStyle=ParamUtil.getString(actionRequest,"displayStyle");
  String bulletStyle=ParamUtil.getString(actionRequest,"bulletStyle");
  String headerType=ParamUtil.getString(actionRequest,"headerType");
  String rootLayoutType=ParamUtil.getString(actionRequest,"rootLayoutType");
  int rootLayoutLevel=ParamUtil.getInteger(actionRequest,"rootLayoutLevel");
  String includedLayouts=ParamUtil.getString(actionRequest,"includedLayouts");
  boolean nestedChildren=ParamUtil.getBoolean(actionRequest,"nestedChildren");
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  PortletPreferences preferences=PortletPreferencesFactoryUtil.getPortletSetup(actionRequest,portletResource);
  preferences.setValue("display-style",displayStyle);
  preferences.setValue("bullet-style",bulletStyle);
  if (displayStyle.equals("[custom]")) {
    preferences.setValue("header-type",headerType);
    preferences.setValue("root-layout-type",rootLayoutType);
    preferences.setValue("root-layout-level",String.valueOf(rootLayoutLevel));
    preferences.setValue("included-layouts",includedLayouts);
    preferences.setValue("nested-children",String.valueOf(nestedChildren));
  }
  preferences.store();
  SessionMessages.add(actionRequest,portletConfig.getPortletName() + ".doConfigure");
}
