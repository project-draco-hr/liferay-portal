{
  StringBundler sb=new StringBundler(8);
  sb.append("select JournalArticle.resourcePrimKey, ");
  sb.append("JournalArticle.type_ from JournalArticle ");
  sb.append("left join JournalArticle tempJournalArticle on ");
  sb.append("(JournalArticle.groupId = tempJournalArticle.groupId) and ");
  sb.append("(JournalArticle.articleId = tempJournalArticle.articleId) ");
  sb.append("and (JournalArticle.version < tempJournalArticle.version) ");
  sb.append("where JournalArticle.companyId = ? and ");
  sb.append("tempJournalArticle.id_ is null");
  try (PreparedStatement ps=connection.prepareStatement(sb.toString())){
    ps.setLong(1,companyId);
    try (ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        long resourcePrimKey=rs.getLong("resourcePrimKey");
        AssetEntry assetEntry=_assetEntryLocalService.fetchEntry(JournalArticle.class.getName(),resourcePrimKey);
        if (assetEntry == null) {
          continue;
        }
        String type=rs.getString("type_");
        long assetCategoryId=journalArticleTypesToAssetCategoryIds.get(type);
        _assetEntryLocalService.addAssetCategoryAssetEntry(assetCategoryId,assetEntry);
      }
    }
   }
 }
