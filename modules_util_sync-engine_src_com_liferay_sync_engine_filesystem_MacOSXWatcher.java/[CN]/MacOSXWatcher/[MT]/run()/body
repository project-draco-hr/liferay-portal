{
  while (true) {
    try {
      WatchKey watchKey=null;
      try {
        watchKey=_watchService.take();
      }
 catch (      Exception e) {
        if (_logger.isTraceEnabled()) {
          _logger.trace(e.getMessage(),e);
        }
        continue;
      }
      List<WatchEvent<?>> watchEvents=watchKey.pollEvents();
      for (int i=0; i < watchEvents.size(); i++) {
        WatchEvent<File> watchEvent=(WatchEvent<File>)watchEvents.get(i);
        WatchEvent.Kind<?> kind=watchEvent.kind();
        File file=watchEvent.context();
        if (file == null) {
          _logger.error(watchEvent.context().getPath());
          continue;
        }
        processWatchEvent(kind.name(),file.toPath());
      }
      if (!watchKey.reset()) {
        if (_logger.isTraceEnabled()) {
          _logger.trace("Unregistered file path {}",getFilePath());
        }
        if (Files.notExists(getFilePath())) {
          processMissingFilePath(getFilePath());
        }
      }
    }
 catch (    Exception e) {
      _logger.error(e.getMessage(),e);
    }
  }
}
