{
  Copy copy=GradleUtil.addTask(project,INIT_BUNDLE_TASK_NAME,Copy.class);
  copy.doFirst(new Action<Task>(){
    @Override public void execute(    Task task){
      Copy copy=(Copy)task;
      project.delete(copy.getDestinationDir());
    }
  }
);
  copy.from(new Callable<FileTree>(){
    @Override public FileTree call() throws Exception {
      File file=bundleConfiguration.getSingleFile();
      String fileName=file.getName();
      if (fileName.endsWith(".tar.gz")) {
        return project.tarTree(file);
      }
 else {
        return project.zipTree(file);
      }
    }
  }
,new Closure<Void>(null){
    @SuppressWarnings("unused") public void doCall(    CopySpec copySpec){
      copySpec.eachFile(new StripPathSegmentsAction(1));
    }
  }
);
  Project rootProject=project.getRootProject();
  copy.from(rootProject.file("configs/common"),rootProject.file("configs/" + workspaceExtension.getEnvironment()));
  copy.into(workspaceExtension.getHomeDir());
  copy.setDescription("Downloads and unzips the bundle into " + workspaceExtension.getHomeDir() + ".");
  copy.setIncludeEmptyDirs(false);
  return copy;
}
