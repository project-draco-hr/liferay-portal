{
  if (_log.isDebugEnabled()) {
    _log.debug("Locating " + name);
  }
  if (name.equals("portletClassLoader")) {
    PortalRuntimePermission.checkGetClassLoader(_paclServletContextName);
  }
  Object bean=null;
  if (name.endsWith(VELOCITY_SUFFIX)) {
    Object velocityBean=_velocityBeans.get(name);
    if (velocityBean == null) {
      String originalName=name.substring(0,name.length() - VELOCITY_SUFFIX.length());
      Object curBean=_applicationContext.getBean(originalName);
      velocityBean=ProxyUtil.newProxyInstance(_classLoader,ReflectionUtil.getInterfaces(curBean,_classLoader),new VelocityBeanHandler(curBean,_classLoader));
      _velocityBeans.put(name,velocityBean);
    }
    bean=velocityBean;
  }
 else {
    bean=_applicationContext.getBean(name);
  }
  if (bean == null) {
    return bean;
  }
  if (bean instanceof DoPrivilegedBean) {
    return bean;
  }
  return _pacl.getBean(bean,_classLoader);
}
