{
  if (_log.isDebugEnabled()) {
    _log.debug("Locating " + name);
  }
  if (name.endsWith(VELOCITY_SUFFIX)) {
    Object bean=_velocityBeans.get(name);
    if (bean == null) {
      String originalName=name.substring(0,name.length() - VELOCITY_SUFFIX.length());
      bean=_applicationContext.getBean(originalName);
      Class<?>[] interfaces=bean.getClass().getInterfaces();
      List<Class<?>> interfacesList=ListUtil.fromArray(interfaces);
      Iterator<Class<?>> itr=interfacesList.iterator();
      while (itr.hasNext()) {
        Class<?> classObj=itr.next();
        try {
          _classLoader.loadClass(classObj.getName());
        }
 catch (        Exception e) {
          itr.remove();
        }
      }
      bean=Proxy.newProxyInstance(_classLoader,interfacesList.toArray(new Class<?>[interfacesList.size()]),new VelocityBeanHandler(bean,_classLoader));
      _velocityBeans.put(name,bean);
    }
    return bean;
  }
 else {
    return _applicationContext.getBean(name);
  }
}
