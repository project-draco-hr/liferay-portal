{
  TestWelder testWelder=new TestWelder();
  testWelder.state=BaseWelder.State.DESTROYED;
  try {
    testWelder.weld(null);
    Assert.fail();
  }
 catch (  IllegalStateException ise) {
    Assert.assertEquals("Can not weld a welder at state DESTROYED",ise.getMessage());
  }
  testWelder.state=BaseWelder.State.CREATED;
  RegistrationReference registrationReference=testWelder.weld(null);
  Assert.assertNull(testWelder._clientRegistrationReference);
  Assert.assertEquals(testWelder._serverRegistrationReference,registrationReference);
  Assert.assertEquals(BaseWelder.State.WELDED,testWelder.state);
  TestWelder newTestWelder=WelderTestUtil.transform(testWelder);
  registrationReference=newTestWelder.weld(null);
  Assert.assertEquals(newTestWelder._clientRegistrationReference,registrationReference);
  Assert.assertNull(newTestWelder._serverRegistrationReference);
  Assert.assertEquals(BaseWelder.State.WELDED,newTestWelder.state);
}
