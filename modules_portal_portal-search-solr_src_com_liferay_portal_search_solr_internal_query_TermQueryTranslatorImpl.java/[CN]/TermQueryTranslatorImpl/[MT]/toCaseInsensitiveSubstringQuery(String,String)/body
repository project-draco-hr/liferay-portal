{
  org.apache.lucene.search.Query query=_parseLuceneQuery(field,value);
  if (query instanceof org.apache.lucene.search.BooleanQuery) {
    return toCaseInsensitiveSubstringQuery((org.apache.lucene.search.BooleanQuery)query);
  }
  if (query instanceof org.apache.lucene.search.TermQuery) {
    return toCaseInsensitiveSubstringQuery((org.apache.lucene.search.TermQuery)query);
  }
  throw new IllegalArgumentException();
}
