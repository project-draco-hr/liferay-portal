{
  Tree foldersTree=new Tree();
  LinkedHashMap<String,Object> groupParams=new LinkedHashMap<String,Object>();
  groupParams.put("usersGroups",new Long(sharepointRequest.getUserId()));
  List<Group> groups=GroupLocalServiceUtil.search(sharepointRequest.getCompanyId(),null,null,groupParams,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  Group userGroup=GroupLocalServiceUtil.getUserGroup(sharepointRequest.getCompanyId(),sharepointRequest.getUserId());
  groups.add(userGroup);
  List<Organization> organizations=OrganizationLocalServiceUtil.getUserOrganizations(sharepointRequest.getUserId());
  for (  Organization organization : organizations) {
    groups.add(organization.getGroup());
  }
  for (  Group group : groups) {
    String path=getGroupPath(group);
    foldersTree.addChild(getFolderTree(path));
  }
  foldersTree.addChild(getFolderTree(StringPool.BLANK));
  return foldersTree;
}
