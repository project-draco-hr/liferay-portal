{
  List<Company> companies=getCompanyLocalService().getCompanies(false);
  for (  Company company : companies) {
    long companyId=company.getCompanyId();
    Dictionary<String,String> dictionary=getPropertyValues(companyId);
    storeSettings(companyId,getSettingsId(),dictionary);
    Set<String> keys=getLegacyPropertyKeys();
    if (_log.isInfoEnabled()) {
      _log.info("Removing preference keys " + keys + " for company "+ companyId);
    }
    getCompanyLocalService().removePreferences(companyId,keys.toArray(new String[keys.size()]));
  }
}
