{
  MBMessageDisplay messageDisplay=MBMessageLocalServiceUtil.getDiscussionMessageDisplay(userId,groupId,className,classPK,WorkflowConstants.STATUS_APPROVED);
  MBThread thread=messageDisplay.getThread();
  long threadId=thread.getThreadId();
  long parentMessageId=thread.getRootMessageId();
  List<MBMessage> messages=MBMessageLocalServiceUtil.getThreadMessages(threadId,WorkflowConstants.STATUS_APPROVED);
  for (  MBMessage message : messages) {
    if (message.getBody().equals(body)) {
      throw new DuplicateCommentException();
    }
  }
  MBMessageLocalServiceUtil.addDiscussionMessage(userId,StringPool.BLANK,groupId,className,classPK,threadId,parentMessageId,StringPool.BLANK,body,serviceContext);
}
