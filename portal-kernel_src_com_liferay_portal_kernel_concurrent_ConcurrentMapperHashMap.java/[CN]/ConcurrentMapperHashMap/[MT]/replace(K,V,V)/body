{
  if (key == null) {
    throw new NullPointerException("Key is null");
  }
  if (oldValue == null) {
    throw new NullPointerException("Old value is null");
  }
  if (newValue == null) {
    throw new NullPointerException("New value is null");
  }
  IK innerKey=mapKeyForQuery(key);
  IV newInnerValue=mapValue(key,newValue);
  IV oldInnerValue=innerConcurrentMap.get(innerKey);
  if ((oldInnerValue == null) || !oldValue.equals(unmapValueForQuery(oldInnerValue))) {
    unmapValue(newInnerValue);
    return false;
  }
  if (innerConcurrentMap.replace(innerKey,oldInnerValue,newInnerValue)) {
    unmapValue(oldInnerValue);
    return true;
  }
  unmapValue(newInnerValue);
  return false;
}
