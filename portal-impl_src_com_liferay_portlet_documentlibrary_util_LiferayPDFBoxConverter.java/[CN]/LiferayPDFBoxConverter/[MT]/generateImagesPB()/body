{
  boolean generatePreview=_generatePreview;
  boolean generateThumbnail=_generateThumbnail;
  PDDocument pdDocument=null;
  try {
    pdDocument=PDDocument.load(_inputFile);
    PDDocumentCatalog pdDocumentCatalog=pdDocument.getDocumentCatalog();
    List<PDPage> pdPages=pdDocumentCatalog.getAllPages();
    for (int i=0; i < pdPages.size(); i++) {
      PDPage pdPage=pdPages.get(i);
      if (generateThumbnail && (i == 0)) {
        _generateImagesPB(pdPage,i,_thumbnailFile,_thumbnailExtension);
      }
      if (!generatePreview) {
        break;
      }
      _generateImagesPB(pdPage,i + 1,_previewFiles[i],_extension);
    }
  }
  finally {
    if (pdDocument != null) {
      pdDocument.close();
    }
  }
}
