{
  try (PDDocument pdDocument=PDDocument.load(_inputFile)){
    PDDocumentCatalog pdDocumentCatalog=pdDocument.getDocumentCatalog();
    List<PDPage> pdPages=pdDocumentCatalog.getAllPages();
    for (int i=0; i < pdPages.size(); i++) {
      PDPage pdPage=pdPages.get(i);
      if (_generateThumbnail && (i == 0)) {
        _generateImagesPB(pdPage,i,_thumbnailFile,_thumbnailExtension);
      }
      if (!_generatePreview) {
        break;
      }
      _generateImagesPB(pdPage,i + 1,_previewFiles[i],_extension);
    }
  }
 }
