{
  ResourceCode resourceCode=resourceCodeLocalService.getResourceCode(companyId,name,scope);
  Resource resource=resourcePersistence.fetchByC_P(resourceCode.getCodeId(),primKey);
  if (resource == null) {
    long resourceId=counterLocalService.increment(Resource.class.getName());
    resource=resourcePersistence.create(resourceId);
    resource.setCodeId(resourceCode.getCodeId());
    resource.setPrimKey(primKey);
    resourcePersistence.update(resource);
  }
  return resource;
}
