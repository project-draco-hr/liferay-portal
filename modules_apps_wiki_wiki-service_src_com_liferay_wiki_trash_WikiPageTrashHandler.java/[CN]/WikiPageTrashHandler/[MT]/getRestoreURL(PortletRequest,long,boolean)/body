{
  String portletId=WikiPortletKeys.WIKI;
  WikiPage page=WikiPageLocalServiceUtil.getLatestPage(classPK,WorkflowConstants.STATUS_ANY,false);
  PortletURL portletURL=null;
  long plid=PortalUtil.getPlidFromPortletId(page.getGroupId(),WikiPortletKeys.WIKI);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    portletId=WikiPortletKeys.WIKI_ADMIN;
    portletURL=PortalUtil.getControlPanelPortletURL(portletRequest,portletId,0,PortletRequest.RENDER_PHASE);
  }
 else {
    portletURL=PortletURLFactoryUtil.create(portletRequest,portletId,plid,PortletRequest.RENDER_PHASE);
  }
  if (isContainerModel) {
    if (portletId.equals(WikiPortletKeys.WIKI)) {
      portletURL.setParameter("struts_action","/wiki/view_all_pages");
    }
 else {
      portletURL.setParameter("struts_action","/wiki_admin/view_all_pages");
    }
  }
 else {
    if (portletId.equals(WikiPortletKeys.WIKI)) {
      portletURL.setParameter("struts_action","/wiki/view");
    }
 else {
      portletURL.setParameter("struts_action","/wiki_admin/view");
    }
  }
  return portletURL;
}
