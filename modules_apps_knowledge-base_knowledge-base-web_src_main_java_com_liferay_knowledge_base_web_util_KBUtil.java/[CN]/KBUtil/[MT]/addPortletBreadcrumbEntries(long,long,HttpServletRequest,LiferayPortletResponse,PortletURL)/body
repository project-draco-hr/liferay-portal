{
  PortletURL currentURL=PortletURLUtil.clone(portletURL,liferayPortletResponse);
  currentURL.setParameter("parentResourceClassNameId",String.valueOf(parentResourceClassNameId));
  currentURL.setParameter("parentResourcePrimKey",String.valueOf(parentResourcePrimKey));
  long kbFolderClassNameId=PortalUtil.getClassNameId(KBFolderConstants.getClassName());
  String mvcPath=ParamUtil.getString(request,"mvcPath");
  if (parentResourcePrimKey == KBFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    if (Validator.isNull(mvcPath) || mvcPath.equals("/admin/view.jsp") || mvcPath.equals("/admin/view_articles.jsp")|| mvcPath.equals("/admin/view_folders.jsp")) {
      currentURL=liferayPortletResponse.createActionURL();
    }
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    PortalUtil.addPortletBreadcrumbEntry(request,themeDisplay.translate("home"),currentURL.toString());
  }
 else   if (parentResourceClassNameId == kbFolderClassNameId) {
    KBFolder kbFolder=KBFolderServiceUtil.getKBFolder(parentResourcePrimKey);
    if (Validator.isNull(mvcPath) || mvcPath.equals("/admin/view_articles.jsp")) {
      currentURL.setParameter("mvcPath","/admin/view_folders.jsp");
    }
    addPortletBreadcrumbEntries(kbFolder.getClassNameId(),kbFolder.getParentKBFolderId(),request,liferayPortletResponse,currentURL);
    PortalUtil.addPortletBreadcrumbEntry(request,kbFolder.getName(),currentURL.toString());
  }
 else {
    KBArticle kbArticle=KBArticleServiceUtil.getLatestKBArticle(parentResourcePrimKey,WorkflowConstants.STATUS_ANY);
    addPortletBreadcrumbEntries(kbArticle.getParentResourceClassNameId(),kbArticle.getParentResourcePrimKey(),request,liferayPortletResponse,currentURL);
    PortalUtil.addPortletBreadcrumbEntry(request,kbArticle.getTitle(),currentURL.toString());
  }
}
