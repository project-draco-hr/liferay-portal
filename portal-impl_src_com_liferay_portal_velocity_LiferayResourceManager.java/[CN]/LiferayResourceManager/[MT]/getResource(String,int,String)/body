{
  if (resourceType != ResourceManager.RESOURCE_TEMPLATE) {
    return super.getResource(resourceName,resourceType,encoding);
  }
  TemplateResource templateResource=null;
  if (resourceName.startsWith(TemplateResource.TEMPLATE_RESOURCE_UUID_PREFIX)) {
    templateResource=TemplateResourceThreadLocal.getTemplateResource(TemplateManager.VELOCITY);
  }
 else {
    templateResource=TemplateResourceLoaderUtil.getTemplateResource(TemplateManager.VELOCITY,resourceName);
  }
  if (templateResource == null) {
    throw new ResourceNotFoundException("Unable to find Velocity template with ID " + resourceName);
  }
  Object object=_portalCache.get(templateResource);
  if ((object != null) && (object instanceof Template)) {
    return (Template)object;
  }
  Template template=_createTemplate(templateResource);
  if (PropsValues.VELOCITY_ENGINE_RESOURCE_MODIFICATION_CHECK_INTERVAL != 0) {
    _portalCache.put(templateResource,template);
  }
  return template;
}
