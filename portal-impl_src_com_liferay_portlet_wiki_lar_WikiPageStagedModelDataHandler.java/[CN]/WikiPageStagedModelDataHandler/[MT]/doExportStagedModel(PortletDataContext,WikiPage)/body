{
  Element pageElement=portletDataContext.getExportDataElement(page);
  StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,page.getNode());
  String content=ExportImportUtil.replaceExportContentReferences(portletDataContext,page,pageElement,page.getContent());
  page.setContent(content);
  if (page.isHead() && portletDataContext.getBooleanParameter(WikiPortletDataHandler.NAMESPACE,"attachments")) {
    for (    FileEntry fileEntry : page.getAttachmentsFileEntries()) {
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,fileEntry);
      portletDataContext.addReferenceElement(page,pageElement,fileEntry,FileEntry.class,PortletDataContext.REFERENCE_TYPE_WEAK,false);
    }
    long folderId=page.getAttachmentsFolderId();
    if (folderId != 0) {
      page.setAttachmentsFolderId(folderId);
    }
  }
  portletDataContext.addClassedModel(pageElement,ExportImportPathUtil.getModelPath(page),page,WikiPortletDataHandler.NAMESPACE);
}
