{
  final Statement statement=super.classBlock(notifier);
  return new Statement(){
    @Override public void evaluate() throws Throwable {
      Thread currentThread=Thread.currentThread();
      Object inheritableThreadLocals=_inheritableThreadLocalsField.get(currentThread);
      if (inheritableThreadLocals != null) {
        _inheritableThreadLocalsField.set(currentThread,_createInheritedMapMethod.invoke(null,inheritableThreadLocals));
      }
      Object threadLocals=_threadLocalsField.get(currentThread);
      _threadLocalsField.set(currentThread,null);
      try {
        statement.evaluate();
      }
  finally {
        _inheritableThreadLocalsField.set(currentThread,inheritableThreadLocals);
        _threadLocalsField.set(currentThread,threadLocals);
      }
    }
  }
;
}
