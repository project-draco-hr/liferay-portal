{
  Servlet servlet=null;
  try {
    Class<?> clazz=Class.forName("com.liferay.portal.servlet.jsp.compiler.JspServlet");
    servlet=(Servlet)clazz.newInstance();
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("No JSP Servlet was deployed for WAB " + contextName + " due to: "+ e.getMessage());
    }
    return null;
  }
  Dictionary<String,Object> properties=new HashMapDictionary<>();
  Dictionary<String,Object> componentProperties=_componentContext.getProperties();
  for (Enumeration<String> keys=componentProperties.keys(); keys.hasMoreElements(); ) {
    String key=keys.nextElement();
    if (!key.startsWith(_JSP_SERVLET_INIT_PARAM_PREFIX)) {
      continue;
    }
    String paramName=_SERVLET_INIT_PARAM_PREFIX + key.substring(_JSP_SERVLET_INIT_PARAM_PREFIX.length());
    properties.put(paramName,componentProperties.get(key));
  }
  properties.put(HttpWhiteboardConstants.HTTP_WHITEBOARD_CONTEXT_SELECT,contextName);
  properties.put(HttpWhiteboardConstants.HTTP_WHITEBOARD_SERVLET_NAME,"jsp");
  properties.put(HttpWhiteboardConstants.HTTP_WHITEBOARD_SERVLET_PATTERN,"*.jsp");
  return bundleContext.registerService(Servlet.class,servlet,properties);
}
