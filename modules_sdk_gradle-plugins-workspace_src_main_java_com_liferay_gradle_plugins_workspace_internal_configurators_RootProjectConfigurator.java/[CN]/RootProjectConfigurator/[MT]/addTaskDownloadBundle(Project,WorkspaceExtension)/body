{
  final Download download=GradleUtil.addTask(project,DOWNLOAD_BUNDLE_TASK_NAME,Download.class);
  File destinationDir=new File(System.getProperty("user.home"),".liferay/bundles");
  destinationDir.mkdirs();
  download.dest(destinationDir);
  download.onlyIfNewer(true);
  download.setDescription("Downloads the Liferay bundle zip file.");
  project.afterEvaluate(new Action<Project>(){
    @Override public void execute(    Project project){
      Object src=download.getSrc();
      if (src != null) {
        if (src instanceof List<?>) {
          List<?> srcList=(List<?>)src;
          if (!srcList.isEmpty()) {
            return;
          }
        }
 else {
          return;
        }
      }
      String bundleUrl=workspaceExtension.getBundleUrl();
      bundleUrl=bundleUrl.replace(" ","%20");
      try {
        download.src(bundleUrl);
      }
 catch (      MalformedURLException murle) {
        throw new GradleException(murle.getMessage(),murle);
      }
    }
  }
);
  return download;
}
