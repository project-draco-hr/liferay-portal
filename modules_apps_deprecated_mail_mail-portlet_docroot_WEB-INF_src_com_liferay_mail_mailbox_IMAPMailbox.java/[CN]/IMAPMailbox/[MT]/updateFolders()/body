{
  if (_log.isDebugEnabled()) {
    _log.debug("Updating folders");
  }
  List<javax.mail.Folder> jxFolders=_imapAccessor.getFolders();
  for (  javax.mail.Folder jxFolder : jxFolders) {
    try {
      FolderLocalServiceUtil.getFolder(account.getAccountId(),jxFolder.getFullName());
    }
 catch (    NoSuchFolderException nsfe) {
      FolderLocalServiceUtil.addFolder(user.getUserId(),account.getAccountId(),jxFolder.getFullName(),jxFolder.getName(),0);
    }
  }
  long draftFolderId=account.getDraftFolderId();
  long inboxFolderId=account.getInboxFolderId();
  long sentFolderId=account.getSentFolderId();
  long trashFolderId=account.getTrashFolderId();
  if (draftFolderId <= 0) {
    draftFolderId=getFolderId("draft");
  }
  if (inboxFolderId <= 0) {
    inboxFolderId=getFolderId("inbox");
  }
  if (sentFolderId <= 0) {
    sentFolderId=getFolderId("sent");
  }
  if (sentFolderId <= 0) {
    sentFolderId=getFolderId("sent-mail");
  }
  if (trashFolderId <= 0) {
    trashFolderId=getFolderId("trash");
  }
  updateFolders(inboxFolderId,draftFolderId,sentFolderId,trashFolderId);
}
