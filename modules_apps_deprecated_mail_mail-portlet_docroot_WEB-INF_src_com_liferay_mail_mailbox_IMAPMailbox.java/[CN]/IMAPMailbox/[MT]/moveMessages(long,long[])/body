{
  for (  long messageId : messageIds) {
    Message message=MessageLocalServiceUtil.getMessage(messageId);
    Account account=AccountLocalServiceUtil.getAccount(message.getAccountId());
    long sourceFolderId=message.getFolderId();
    if ((account.getDraftFolderId() == sourceFolderId) || (account.getSentFolderId() == sourceFolderId)) {
      throw new MailException(MailException.FOLDER_INVALID_DESTINATION);
    }
    _imapAccessor.moveMessages(sourceFolderId,folderId,new long[]{messageId},true);
  }
}
