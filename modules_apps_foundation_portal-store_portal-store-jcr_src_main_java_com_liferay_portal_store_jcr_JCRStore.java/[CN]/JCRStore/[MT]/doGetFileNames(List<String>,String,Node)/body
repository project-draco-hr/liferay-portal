{
  NodeType primaryNodeType=node.getPrimaryNodeType();
  String primaryNodeTypeName=primaryNodeType.getName();
  if (primaryNodeTypeName.equals(JCRConstants.NT_FOLDER)) {
    NodeIterator itr=node.getNodes();
    while (itr.hasNext()) {
      Node curNode=itr.nextNode();
      String subDirName=null;
      if (Validator.isBlank(dirName)) {
        subDirName=curNode.getName();
      }
 else {
        subDirName=dirName + StringPool.SLASH + curNode.getName();
      }
      doGetFileNames(fileNames,subDirName,curNode);
    }
  }
 else   if (primaryNodeTypeName.equals(JCRConstants.NT_FILE)) {
    fileNames.add(dirName);
  }
}
