{
  PortletURL deleteURL=PortalUtil.getControlPanelPortletURL(portletRequest,MBPortletKeys.MESSAGE_BOARDS_ADMIN,PortletRequest.ACTION_PHASE);
  deleteURL.setParameter(ActionRequest.ACTION_NAME,"/message_boards/delete_thread");
  String cmd=Constants.DELETE;
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (isTrashEnabled(themeDisplay.getScopeGroupId())) {
    cmd=Constants.MOVE_TO_TRASH;
  }
  deleteURL.setParameter(Constants.CMD,cmd);
  try {
    MBCategory category=ActionUtil.getCategory(portletRequest);
    PortletURL parentCategoryURL=PortletURLFactoryUtil.create(portletRequest,MBPortletKeys.MESSAGE_BOARDS_ADMIN,themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    long categoryId=getCategoryId(category);
    if (categoryId == MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID) {
      parentCategoryURL.setParameter("mvcRenderCommandName","/message_boards/view");
    }
 else {
      parentCategoryURL.setParameter("mvcRenderCommandName","/message_boards/view_category");
      parentCategoryURL.setParameter("mbCategoryId",String.valueOf(categoryId));
    }
    deleteURL.setParameter("redirect",parentCategoryURL.toString());
    MBMessage message=ActionUtil.getMessage(portletRequest);
    deleteURL.setParameter("threadId",String.valueOf(message.getThreadId()));
  }
 catch (  Exception e) {
    return null;
  }
  return deleteURL.toString();
}
