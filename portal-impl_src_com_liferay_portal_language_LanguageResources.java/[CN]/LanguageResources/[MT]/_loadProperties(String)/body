{
  Properties properties=new Properties();
  boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
  try {
    PortalSecurityManagerThreadLocal.setEnabled(false);
    ClassLoader classLoader=LanguageResources.class.getClassLoader();
    Enumeration<URL> urls=classLoader.getResources(name);
    if (_log.isDebugEnabled() && !urls.hasMoreElements()) {
      _log.debug("No " + name + " has been found");
    }
    while (urls.hasMoreElements()) {
      URL url=urls.nextElement();
      if (_log.isInfoEnabled()) {
        _log.info("Attempting to load " + name);
      }
      if (url != null) {
        InputStream inputStream=url.openStream();
        try {
          Properties urlProps=PropertiesUtil.load(inputStream,StringPool.UTF8);
          for (          String key : urlProps.stringPropertyNames()) {
            properties.setProperty(key,urlProps.getProperty(key));
          }
        }
  finally {
          inputStream.close();
        }
        if (_log.isInfoEnabled()) {
          _log.info("Loading " + url + " with "+ properties.size()+ " values");
        }
      }
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e,e);
    }
  }
 finally {
    PortalSecurityManagerThreadLocal.setEnabled(enabled);
  }
  return properties;
}
