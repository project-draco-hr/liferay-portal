{
  if (buildNumber <= 0) {
    _log.error("Skipping upgrade processes for " + servletContextName + " because \"release.info.build.number\" is not specified");
    return;
  }
  Release release=releaseLocalService.fetchRelease(servletContextName);
  if (release == null) {
    release=releaseLocalService.addRelease(servletContextName,previousBuildNumber);
  }
  if (buildNumber == release.getBuildNumber()) {
    if (_log.isDebugEnabled()) {
      _log.debug("Skipping upgrade processes for " + servletContextName + " because it is already up to date");
    }
  }
 else   if (buildNumber < release.getBuildNumber()) {
    throw new OlderVersionException("Skipping upgrade processes for " + servletContextName + " because you are trying to upgrade with an older version");
  }
 else {
    UpgradeProcessUtil.upgradeProcess(release.getBuildNumber(),upgradeProcesses,indexOnUpgrade);
  }
  releaseLocalService.updateRelease(release.getReleaseId(),release.getSchemaVersion(),buildNumber,null,true);
}
