{
  HttpClientBuilder httpClientBuilder=HttpClientBuilder.create();
  httpClientBuilder.disableAutomaticRetries();
  RequestConfig.Builder builder=RequestConfig.custom();
  builder.setConnectTimeout(connectionTimeout);
  builder.setSocketTimeout(socketTimeout);
  List<Header> headers=new ArrayList<>(2);
  Header syncBuildHeader=new BasicHeader("Sync-Build",String.valueOf(ReleaseInfo.getBuildNumber()));
  headers.add(syncBuildHeader);
  String syncDevice=null;
  if (OSDetector.isApple()) {
    syncDevice="desktop-mac";
  }
 else   if (OSDetector.isLinux()) {
    syncDevice="desktop-linux";
  }
 else   if (OSDetector.isWindows()) {
    syncDevice="desktop-windows";
  }
  Header syncDeviceHeader=new BasicHeader("Sync-Device",syncDevice);
  headers.add(syncDeviceHeader);
  httpClientBuilder.setDefaultHeaders(headers);
  httpClientBuilder.setDefaultRequestConfig(builder.build());
  httpClientBuilder.setMaxConnPerRoute(maxConnections);
  httpClientBuilder.setMaxConnTotal(maxConnections);
  httpClientBuilder.setRedirectStrategy(new LaxRedirectStrategy());
  httpClientBuilder.setRoutePlanner(getHttpRoutePlanner());
  if (trustSelfSigned) {
    try {
      httpClientBuilder.setSSLSocketFactory(_getTrustingSSLSocketFactory());
    }
 catch (    Exception e) {
      _logger.error(e.getMessage(),e);
    }
  }
  return httpClientBuilder;
}
