{
  try {
    validateImageFileExtension(imageFileName);
  }
 catch (  KBArticleImportException kbaie) {
    if (_log.isWarnEnabled()) {
      _log.warn("Unsupported image file suffix used in ZIP file " + imageFileName);
    }
  }
  try {
    return addImageFileEntry(userId,kbArticle,imageFileName,zipReader.getEntryAsInputStream(PortletPropsValues.MARKDOWN_IMPORTER_IMAGE_FOLDER + imageFileName),fileEntriesMap);
  }
 catch (  Exception e) {
    StringBuilder sb=new StringBuilder(4);
    sb.append("Unable to import image file ");
    sb.append(imageFileName);
    sb.append(": ");
    sb.append(e.getLocalizedMessage());
    throw new KBArticleImportException(sb.toString());
  }
}
