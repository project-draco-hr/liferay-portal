{
  boolean create=true;
  if (checkExists) {
    try {
      UserLocalServiceUtil.getUserByEmailAddress(companyId,emailAddress);
      if (updatePassword) {
        UserLocalServiceUtil.updatePassword(userId,password1,password2,passwordReset);
      }
      create=false;
    }
 catch (    NoSuchUserException nsue) {
    }
  }
  if (create) {
    try {
      UserLocalServiceUtil.addUser(creatorUserId,companyId,autoUserId,userId,autoPassword,password1,password2,passwordReset,emailAddress,locale,firstName,middleName,lastName,nickName,prefixId,suffixId,male,birthdayMonth,birthdayDay,birthdayYear,jobTitle,organizationId,locationId,sendEmail);
    }
 catch (    Exception e) {
      _log.error(StackTraceUtil.getStackTrace(e));
    }
  }
}
