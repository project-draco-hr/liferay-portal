{
  try (LoggingTimer loggingTimer=new LoggingTimer();PreparedStatement ps=connection.prepareStatement("select userNotificationEventId, payload from " + "UserNotificationEvent");ResultSet rs=ps.executeQuery()){
    while (rs.next()) {
      long userNotificationEventId=rs.getLong("userNotificationEventId");
      String payload=rs.getString("payload");
      UserNotificationEvent userNotificationEvent=_userNotificationEventLocalService.getUserNotificationEvent(userNotificationEventId);
      userNotificationEvent.setDelivered(true);
      int deliveryType=userNotificationEvent.getDeliveryType();
      if (deliveryType == 0) {
        userNotificationEvent.setDeliveryType(UserNotificationDeliveryConstants.TYPE_WEBSITE);
      }
      JSONObject jsonObject=JSONFactoryUtil.createJSONObject(payload);
      boolean actionRequired=jsonObject.getBoolean("actionRequired");
      jsonObject.remove("actionRequired");
      userNotificationEvent.setPayload(jsonObject.toString());
      if (!userNotificationEvent.isActionRequired()) {
        userNotificationEvent.setActionRequired(actionRequired);
      }
      _userNotificationEventLocalService.updateUserNotificationEvent(userNotificationEvent);
    }
  }
 }
