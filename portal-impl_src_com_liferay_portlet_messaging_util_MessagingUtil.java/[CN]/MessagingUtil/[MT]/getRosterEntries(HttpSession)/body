{
  JSONObject jo=new JSONObject();
  Roster roster=getRoster(ses);
  List rosterList=new ArrayList();
  Iterator rosterEntries=roster.getEntries();
  JSONArray ja=new JSONArray();
  while (rosterEntries.hasNext()) {
    RosterEntry entry=(RosterEntry)rosterEntries.next();
    if (entry.getType() != RosterPacket.ItemType.FROM) {
      rosterList.add(entry);
    }
  }
  if (rosterList.size() > 0) {
    Collections.sort(rosterList,new NameComparator());
    for (int i=0; i < rosterList.size(); i++) {
      JSONObject jEntry=new JSONObject();
      RosterEntry entry=(RosterEntry)rosterList.get(i);
      JSONUtil.put(jEntry,"user",getUserId(entry));
      JSONUtil.put(jEntry,"name",entry.getName());
      JSONUtil.put(jEntry,"status",getPresence(roster.getPresence(entry.getUser())));
      ja.put(jEntry);
    }
  }
  JSONUtil.put(jo,"roster",ja);
  return jo;
}
