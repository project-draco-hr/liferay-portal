{
  String body=content.getHtmlBody();
  for (int i=0; i < rmas.size(); i++) {
    RemoteMailAttachment rma=(RemoteMailAttachment)rmas.get(i);
    if (Validator.isNotNull(rma.getContentId())) {
      String contentId=rma.getContentId();
      if (contentId.startsWith(StringPool.LESS_THAN) && contentId.endsWith(StringPool.GREATER_THAN)) {
        contentId="cid:" + contentId.substring(1,contentId.length() - 1);
      }
      String remotePath=url + "fileName=" + rma.getFilename()+ "&contentPath="+ rma.getContentPath();
      body=StringUtil.replace(body,contentId,remotePath);
      rma.setDirty(true);
    }
  }
  content.setHtmlBody(body);
  for (int i=0; i < content.getSubContent().size(); i++) {
    _replaceContentIds((MailContent)content.getSubContent().get(i),rmas,url);
  }
}
