{
  Set results=new TreeSet(comparator);
  if (Validator.isNotNull(displayTerms.getFolderName())) {
    _search(ses,displayTerms,results);
  }
 else {
    List folders=getFolders(ses);
    for (Iterator itr=folders.iterator(); itr.hasNext(); ) {
      MailFolder mf=(MailFolder)itr.next();
      String resolvedName=_getResolvedFolderName(mf.getName());
      if (resolvedName.equals(MAIL_SPAM_NAME) || resolvedName.equals(MAIL_TRASH_NAME)) {
        continue;
      }
      displayTerms.setFolderName(mf.getName());
      _search(ses,displayTerms,results);
    }
  }
  return results;
}
