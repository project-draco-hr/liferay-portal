{
  try {
    MailSessionLock.lock(ses.getId());
    folderName=_getResolvedFolderName(folderName);
    Store store=_getStore(ses);
    IMAPFolder folder=(IMAPFolder)store.getFolder(folderName);
    folder.open(IMAPFolder.READ_WRITE);
    String curFolderName=_getResolvedFolderName(folder.getName());
    if (folderName.equals(curFolderName)) {
      Message[] messages=folder.getMessages();
      long[] messageIds=new long[messages.length];
      for (int i=0; i < messages.length; i++) {
        messageIds[i]=folder.getUID(messages[i]);
      }
      deleteMessages(ses,messageIds);
    }
  }
 catch (  MessagingException me) {
    throw new FolderException(me);
  }
 finally {
    MailSessionLock.unlock(ses.getId());
  }
}
