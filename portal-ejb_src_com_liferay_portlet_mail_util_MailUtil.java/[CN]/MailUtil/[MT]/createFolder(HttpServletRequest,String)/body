{
  Folder folder=null;
  try {
    MailSessionLock.lock(req);
    Iterator itr=getFolders(req).iterator();
    while (itr.hasNext()) {
      MailFolder mailFolder=(MailFolder)itr.next();
      if (mailFolder.getName().equals(folderName)) {
        throw new FolderException("Folder " + folderName + " already exists");
      }
    }
    Store store=_getStore(req);
    folderName=_getResolvedFolderName(folderName);
    folder=store.getFolder(folderName);
    folder.create(Folder.HOLDS_MESSAGES);
  }
 catch (  MessagingException me) {
    throw new FolderException(me);
  }
 finally {
    try {
      if ((folder != null) && folder.isOpen()) {
        folder.close(false);
      }
    }
 catch (    Exception e) {
    }
    MailSessionLock.unlock(req);
  }
}
