{
  Object[] parts=null;
  try {
    String[] path=RemoteMailAttachment.parsePath(contentPath);
    String folderName=path[0];
    long messageUID=GetterUtil.getLong(path[1]);
    String mimePath=path[2];
    setCurrentFolder(ses,folderName);
    IMAPFolder folder=_getCurrentFolder(ses);
    Message message=folder.getMessageByUID(messageUID);
    parts=_getAttachmentFromPath(message,mimePath);
  }
 catch (  ContentPathException cpe) {
    _log.error("Invalid content path " + contentPath);
    throw cpe;
  }
catch (  IOException ioe) {
    _log.error("Error obtaining attachment from content path " + contentPath);
    throw new ContentException(ioe);
  }
catch (  MessagingException me) {
    _log.error("Error obtaining attachment from content path " + contentPath);
    throw new ContentException(me);
  }
  return parts;
}
