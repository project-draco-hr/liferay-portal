{
  Object[] parts=null;
  try {
    MailSessionLock.getInstance().lock(ses.getId());
    String[] path=RemoteMailAttachment.parsePath(contentPath);
    String folderName=path[0];
    long messageId=GetterUtil.getLong(path[1]);
    String mimePath=path[2];
    IMAPFolder folder=_getFolder(ses,folderName);
    Message message=folder.getMessageByUID(messageId);
    parts=_getAttachmentFromPath(message,mimePath);
  }
 catch (  ContentPathException cpe) {
    throw cpe;
  }
catch (  IOException ioe) {
    throw new ContentException(ioe);
  }
catch (  MessagingException me) {
    throw new ContentException(me);
  }
 finally {
    MailSessionLock.getInstance().unlock(ses.getId());
  }
  return parts;
}
