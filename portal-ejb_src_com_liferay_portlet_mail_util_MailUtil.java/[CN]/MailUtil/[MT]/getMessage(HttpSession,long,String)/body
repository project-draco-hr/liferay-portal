{
  MailMessage mm=null;
  try {
    String contentPath=RemoteMailAttachment.buildContentPath(_getCurrentFolder(ses).getName(),messageUID);
    Message message=_getCurrentFolder(ses).getMessageByUID(messageUID);
    mm=new MailMessage();
    mm.setSubject(message.getSubject());
    mm.setFrom(message.getFrom()[0]);
    mm.setTo(message.getRecipients(RecipientType.TO));
    mm.setCc(message.getRecipients(RecipientType.CC));
    mm.setBcc(message.getRecipients(RecipientType.BCC));
    mm.setSentDate(message.getSentDate());
    mm.setReplyTo(message.getReplyTo());
    mm=_getContent(message,mm,contentPath);
    if (Validator.isNotNull(url)) {
      _replaceContentIds(mm,url);
    }
    _setCurrentMessage(ses,messageUID);
  }
 catch (  MessagingException ex) {
    _log.error("Error trying to get message with UID " + messageUID);
    throw new FolderException(ex);
  }
  return mm;
}
