{
  try {
    folderName=_getResolvedFolderName(folderName);
    IMAPFolder folder=(IMAPFolder)ses.getAttribute(WebKeys.MAIL_FOLDER);
    if (folder != null) {
      String currFolderName=_getResolvedFolderName(folder.getName());
      if (!currFolderName.equals(folderName)) {
        _closeFolder(ses);
        folder=null;
      }
    }
    if (folder == null) {
      Store store=_getStore(ses);
      folder=(IMAPFolder)store.getFolder(folderName);
      folder.open(IMAPFolder.READ_WRITE);
      ses.setAttribute(WebKeys.MAIL_FOLDER,folder);
      ses.removeAttribute(WebKeys.MAIL_MESSAGE_ID);
    }
    return folder;
  }
 catch (  MessagingException me) {
    throw new FolderException(me);
  }
}
