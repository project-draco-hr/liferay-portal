{
  String deployDir=ParamUtil.getString(req,"deployDir");
  String destDir=ParamUtil.getString(req,"destDir");
  long interval=ParamUtil.getLong(req,"interval");
  boolean unpackWar=ParamUtil.getBoolean(req,"unpackWar");
  String jbossPrefix=ParamUtil.getString(req,"jbossPrefix");
  String tomcatLibDir=ParamUtil.getString(req,"tomcatLibDir");
  PortletPreferences prefs=OmniadminUtil.getPreferences();
  prefs.setValue(PropsUtil.AUTO_DEPLOY_DEPLOY_DIR,deployDir);
  prefs.setValue(PropsUtil.AUTO_DEPLOY_DEST_DIR,destDir);
  prefs.setValue(PropsUtil.AUTO_DEPLOY_INTERVAL,String.valueOf(interval));
  prefs.setValue(PropsUtil.AUTO_DEPLOY_UNPACK_WAR,String.valueOf(unpackWar));
  if (Validator.isNotNull(jbossPrefix)) {
    prefs.setValue(PropsUtil.AUTO_DEPLOY_JBOSS_PREFIX,jbossPrefix);
  }
  if (Validator.isNotNull(tomcatLibDir)) {
    prefs.setValue(PropsUtil.AUTO_DEPLOY_TOMCAT_LIB_DIR,tomcatLibDir);
  }
  prefs.store();
  _log.info("Unregistering auto deploy directories");
  AutoDeployUtil.unregisterDir("defaultAutoDeployDir");
  _log.info("Registering auto deploy directories");
  List autoDeployListeners=new ArrayList();
  autoDeployListeners.add(new AutoDeployLayoutTemplateListener());
  autoDeployListeners.add(new AutoDeployPortletListener());
  autoDeployListeners.add(new AutoDeployThemeListener());
  AutoDeployDir autoDeployDir=new AutoDeployDir("defaultAutoDeployDir",new File(deployDir),new File(destDir),interval,autoDeployListeners);
  AutoDeployUtil.registerDir(autoDeployDir);
}
