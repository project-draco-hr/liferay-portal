{
  List<Element> portletElements=permissionsElement.elements("portlet");
  for (  Element portletElement : portletElements) {
    String portletId=portletElement.attributeValue("portlet-id");
    String resourceName=PortletConstants.getRootPortletId(portletId);
    String resourcePrimKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),portletId);
    Portlet portlet=PortletLocalServiceUtil.getPortletById(companyId,resourceName);
    if (portlet == null) {
      if (_log.isDebugEnabled()) {
        _log.debug("Do not import portlet permissions for " + portletId + " because the portlet does not exist");
      }
    }
 else {
      importGroupPermissions(layoutCache,companyId,groupId,resourceName,resourcePrimKey,portletElement,"community-actions",true);
      if (groupId != guestGroup.getGroupId()) {
        importGroupPermissions(layoutCache,companyId,guestGroup.getGroupId(),resourceName,resourcePrimKey,portletElement,"guest-actions",true);
      }
      if (importUserPermissions) {
        importUserPermissions(layoutCache,companyId,groupId,resourceName,resourcePrimKey,portletElement,true);
      }
      importInheritedPermissions(layoutCache,companyId,resourceName,resourcePrimKey,portletElement,"organization",true);
      importInheritedPermissions(layoutCache,companyId,resourceName,resourcePrimKey,portletElement,"user-group",true);
    }
  }
}
