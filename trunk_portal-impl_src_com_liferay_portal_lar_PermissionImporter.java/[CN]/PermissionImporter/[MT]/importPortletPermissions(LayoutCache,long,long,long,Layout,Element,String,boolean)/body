{
  Element permissionsElement=portletElement.element("permissions");
  if (permissionsElement != null) {
    String resourceName=PortletConstants.getRootPortletId(portletId);
    String resourcePrimKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),portletId);
    if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 5) {
      importPermissions_5(layoutCache,companyId,groupId,userId,resourceName,resourcePrimKey,permissionsElement,true);
    }
 else     if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
      importPermissions_6(layoutCache,companyId,groupId,userId,resourceName,resourcePrimKey,permissionsElement,true);
    }
 else {
      Group guestGroup=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.GUEST);
      importPortletPermissions_1to4(layoutCache,companyId,groupId,guestGroup,layout,permissionsElement,importUserPermissions);
    }
  }
  Element rolesElement=portletElement.element("roles");
  if ((PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM < 5) && (rolesElement != null)) {
    importPortletRoles(layoutCache,companyId,groupId,portletElement);
    importPortletRoles(layoutCache,companyId,groupId,portletId,rolesElement);
  }
}
