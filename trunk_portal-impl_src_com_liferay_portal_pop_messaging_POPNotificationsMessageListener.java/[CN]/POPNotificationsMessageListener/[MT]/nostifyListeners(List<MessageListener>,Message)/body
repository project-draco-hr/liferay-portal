{
  String from=getEmailAddress(message.getFrom());
  String recipient=getEmailAddress(message.getRecipients(RecipientType.TO));
  if (_log.isDebugEnabled()) {
    _log.debug("From " + from);
    _log.debug("Recipient " + recipient);
  }
  Iterator<MessageListener> itr=listeners.iterator();
  while (itr.hasNext()) {
    MessageListener messageListener=itr.next();
    try {
      if (messageListener.accept(from,recipient,message)) {
        messageListener.deliver(from,recipient,message);
      }
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
}
