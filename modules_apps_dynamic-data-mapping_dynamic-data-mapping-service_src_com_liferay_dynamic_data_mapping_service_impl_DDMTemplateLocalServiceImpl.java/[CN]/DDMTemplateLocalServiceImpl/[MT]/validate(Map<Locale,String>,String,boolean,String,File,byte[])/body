{
  validate(nameMap,script);
  String[] imageExtensions=PrefsPropsUtil.getStringArray(DDMServiceConfigurationKeys.DYNAMIC_DATA_MAPPING_IMAGE_EXTENSIONS,StringPool.COMMA);
  if (!smallImage || Validator.isNotNull(smallImageURL) || (smallImageFile == null)|| (smallImageBytes == null)) {
    return;
  }
  String smallImageName=smallImageFile.getName();
  boolean validSmallImageExtension=false;
  for (  String imageExtension : imageExtensions) {
    if (StringPool.STAR.equals(imageExtension) || StringUtil.endsWith(smallImageName,imageExtension)) {
      validSmallImageExtension=true;
      break;
    }
  }
  if (!validSmallImageExtension) {
    throw new TemplateSmallImageNameException(smallImageName);
  }
  long smallImageMaxSize=PrefsPropsUtil.getLong(DDMServiceConfigurationKeys.DYNAMIC_DATA_MAPPING_IMAGE_SMALL_MAX_SIZE);
  if ((smallImageMaxSize > 0) && (smallImageBytes.length > smallImageMaxSize)) {
    throw new TemplateSmallImageSizeException("Image " + smallImageName + " has "+ smallImageBytes.length+ " bytes and exceeds the maximum size of "+ smallImageMaxSize);
  }
}
