{
  validate(nameMap,script);
  String[] imageExtensions=DDMServiceConfigurationUtil.getArray(DDMServiceConfigurationKeys.DYNAMIC_DATA_MAPPING_IMAGE_EXTENSIONS);
  if (!smallImage || Validator.isNotNull(smallImageURL) || (smallImageFile == null)|| (smallImageBytes == null)) {
    return;
  }
  String smallImageName=smallImageFile.getName();
  boolean validSmallImageExtension=false;
  for (  String imageExtension : imageExtensions) {
    if (StringPool.STAR.equals(imageExtension) || StringUtil.endsWith(smallImageName,imageExtension)) {
      validSmallImageExtension=true;
      break;
    }
  }
  if (!validSmallImageExtension) {
    throw new TemplateSmallImageNameException(smallImageName);
  }
  String smallImageMaxSizeKey=DDMServiceConfigurationKeys.DYNAMIC_DATA_MAPPING_IMAGE_SMALL_MAX_SIZE;
  long smallImageMaxSize=GetterUtil.getLong(DDMServiceConfigurationUtil.get(smallImageMaxSizeKey),0L);
  if ((smallImageMaxSize > 0) && (smallImageBytes.length > smallImageMaxSize)) {
    throw new TemplateSmallImageSizeException("Image " + smallImageName + " has "+ smallImageBytes.length+ " bytes and exceeds the maximum size of "+ smallImageMaxSize);
  }
}
