{
  System.out.print("Executing commands: ");
  for (  String command : commands) {
    System.out.println(command);
  }
  Runtime runtime=Runtime.getRuntime();
  String[] bashCommands=new String[3];
  bashCommands[0]="/bin/sh";
  bashCommands[1]="-c";
  String commandTerminator=";";
  if (exitOnFirstFail) {
    commandTerminator="&&";
  }
  StringBuffer sb=new StringBuffer();
  for (  String command : commands) {
    sb.append(command);
    sb.append(commandTerminator);
    sb.append(" ");
  }
  sb.append("echo Finished executing Bash commands.\n");
  bashCommands[2]=sb.toString();
  Process process=runtime.exec(bashCommands);
  System.out.println("Output stream: " + readInputStream(process.getInputStream()));
  int returnCode=process.waitFor();
  if (returnCode != 0) {
    System.out.println("Error stream: " + readInputStream(process.getErrorStream()));
  }
  return process;
}
