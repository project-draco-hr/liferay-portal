{
  List<Group> parentGroups=new ArrayList<Group>();
  parentGroups.add(group);
  LinkedHashMap<String,Object> groupParams=new LinkedHashMap<String,Object>();
  groupParams.put("groupsTree",parentGroups);
  groupParams.put("site",Boolean.TRUE);
  groupParams.put("type",GroupConstants.TYPE_SITE_LIMITED_TO_PARENT_SITE_MEMBERS);
  List<Group> children=GroupLocalServiceUtil.search(group.getCompanyId(),null,StringPool.BLANK,groupParams,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  List<Group> filteredChildren=ListUtil.copy(children);
  for (  Group child : children) {
    for (    Group ancestor : child.getAncestors()) {
      if ((ancestor.getGroupId() != group.getGroupId()) && !ancestor.isLimitedToParentSiteMembers()) {
        filteredChildren.remove(child);
        break;
      }
    }
  }
  return filteredChildren;
}
