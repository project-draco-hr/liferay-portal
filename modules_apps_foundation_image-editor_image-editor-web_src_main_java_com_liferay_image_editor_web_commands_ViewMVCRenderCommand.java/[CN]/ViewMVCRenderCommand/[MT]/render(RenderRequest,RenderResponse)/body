{
  Template template=getTemplate(renderRequest);
  List<Map<String,Object>> toolsContexts=new ArrayList<>();
  Map<String,Map<String,Object>> featuresProperties=_featureTracker.getFeaturesProperties();
  HttpServletRequest httpServletRequest=PortalUtil.getHttpServletRequest(renderRequest);
  for (  String featureName : featuresProperties.keySet()) {
    Map<String,Object> context=new HashMap<>();
    Map<String,Object> properties=featuresProperties.get(featureName);
    String controls=GetterUtil.getString(properties.get("com.liferay.image.editor.tool.controls"));
    String icon=GetterUtil.getString(properties.get("com.liferay.image.editor.tool.icon"));
    String name=GetterUtil.getString(properties.get("com.liferay.image.editor.tool.name"));
    context.put("controls",controls);
    context.put("icon",icon);
    context.put("name",name);
    context.put("hasDropdown",false);
    ImageEditorFeature feature=_featureTracker.getFeature(featureName);
    feature.prepareContext(context,httpServletRequest);
    toolsContexts.add(context);
  }
  template.put("image","http://localhost:8080/documents/20233/0/214H.jpg/44f148f9-adee-9020-dbc5-61c112d0bc26?t=1460307134146");
  template.put("tools",toolsContexts);
  return "ImageEditor";
}
