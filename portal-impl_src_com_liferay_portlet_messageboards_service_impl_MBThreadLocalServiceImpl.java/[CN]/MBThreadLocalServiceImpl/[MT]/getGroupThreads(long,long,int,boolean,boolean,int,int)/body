{
  if (userId <= 0) {
    if (status == WorkflowConstants.STATUS_ANY) {
      return mbThreadPersistence.findByG_NotC(groupId,-1,start,end);
    }
 else {
      return mbThreadPersistence.findByG_NotC_S(groupId,-1,status,start,end);
    }
  }
 else {
    if (subscribed) {
      return mbThreadFinder.findByS_G_U_S(groupId,userId,status,start,end);
    }
 else {
      List<Long> threadIds=null;
      if (includeAnonymous) {
        threadIds=mbMessageFinder.findByG_U_S(groupId,userId,status,start,end);
      }
 else {
        threadIds=mbMessageFinder.findByG_U_A_S(groupId,userId,false,status,start,end);
      }
      List<MBThread> threads=new ArrayList<MBThread>(threadIds.size());
      for (      long threadId : threadIds) {
        MBThread thread=mbThreadPersistence.findByPrimaryKey(threadId);
        threads.add(thread);
      }
      return threads;
    }
  }
}
