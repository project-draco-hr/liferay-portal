{
  long folderId=message.getAttachmentsFolderId();
  if (folderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    Folder newThreadFolder=newThread.addAttachmentsFolder();
    long newThreadFolderId=newThreadFolder.getFolderId();
    PortletFileRepositoryUtil.movePortletFolder(message.getUserId(),folderId,newThreadFolderId,serviceContext);
  }
  List<MBMessage> childMessages=mbMessagePersistence.findByT_P(message.getThreadId(),message.getMessageId());
  for (  MBMessage childMessage : childMessages) {
    moveAttachmentsFolders(childMessage,newThread,serviceContext);
  }
}
