{
  Properties properties=new Properties();
  Class<?> clazz=expectedResult.getClass();
  PQLValue pqlValue=new PQLValue(pql);
  Object actualResult=pqlValue.getPQLResult(properties);
  if (!clazz.isInstance(actualResult)) {
    throw new Exception(pql + " should be of type: " + clazz.getName());
  }
  if (!actualResult.equals(expectedResult)) {
    StringBuilder sb=new StringBuilder();
    sb.append("Mismatched PQL result within the following PQL:\n");
    sb.append(pql);
    sb.append("\n* Actual:   ");
    sb.append(actualResult);
    sb.append("\n* Expected: ");
    sb.append(expectedResult);
    throw new Exception(sb.toString());
  }
}
