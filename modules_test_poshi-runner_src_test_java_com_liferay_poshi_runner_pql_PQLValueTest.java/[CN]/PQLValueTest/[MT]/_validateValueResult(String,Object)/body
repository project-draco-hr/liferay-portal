{
  Properties properties=new Properties();
  Class clazz=expected.getClass();
  PQLValue pqlValue=new PQLValue(pql);
  Object actual=pqlValue.getValue(properties);
  if (!clazz.isInstance(actual)) {
    throw new Exception(pql + " should be of type '" + clazz.getName()+ "'");
  }
  if (!actual.equals(expected)) {
    StringBuilder sb=new StringBuilder();
    sb.append("Mismatched value within the following PQL:\n");
    sb.append(pql);
    sb.append("\n\n* Actual:   \"");
    sb.append(actual);
    sb.append("\"\n* Expected: \"");
    sb.append(expected);
    sb.append("\"");
    throw new Exception(sb.toString());
  }
}
