{
  try {
    String[] pathArray=webDAVRequest.getPathArray();
    if (pathArray.length == 2) {
      String path=rootPath + webDAVRequest.getPath();
      return new BaseResourceImpl(path,StringPool.BLANK,token);
    }
 else     if (pathArray.length == 3) {
      String type=pathArray[2];
      return toResource(webDAVRequest,type,rootPath,false);
    }
 else     if (pathArray.length == 4) {
      String type=pathArray[2];
      String typeId=pathArray[3];
      if (type.equals(TYPE_STRUCTURES)) {
        try {
          DDMStructure structure=null;
          try {
            structure=DDMStructureLocalServiceUtil.getStructure(GetterUtil.getLong(typeId));
          }
 catch (          NumberFormatException nfe) {
            structure=DDMStructureLocalServiceUtil.getStructure(webDAVRequest.getGroupId(),classNameId,typeId);
          }
          return DDMWebDavUtil.toResource(webDAVRequest,structure,rootPath,false);
        }
 catch (        NoSuchStructureException nsse) {
          return null;
        }
      }
 else       if (type.equals(TYPE_TEMPLATES)) {
        try {
          DDMTemplate template=null;
          try {
            template=DDMTemplateLocalServiceUtil.getTemplate(GetterUtil.getLong(typeId));
          }
 catch (          NumberFormatException nfe) {
            template=DDMTemplateLocalServiceUtil.getTemplate(webDAVRequest.getGroupId(),classNameId,typeId);
          }
          return DDMWebDavUtil.toResource(webDAVRequest,template,rootPath,false);
        }
 catch (        NoSuchTemplateException nste) {
          return null;
        }
      }
    }
    return null;
  }
 catch (  Exception e) {
    throw new WebDAVException(e);
  }
}
