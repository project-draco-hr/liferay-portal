{
  for (  DestinationConfiguration destinationConfiguration : _destinationConfigurations) {
    try {
      PortalMessageBusPermission.checkListen(destinationConfiguration.getDestinationName());
    }
 catch (    SecurityException se) {
      if (_log.isInfoEnabled()) {
        _log.info("Rejecting destination " + destinationConfiguration.getDestinationName());
      }
      continue;
    }
    _destinations.add(DestinationFactoryUtil.createDestination(destinationConfiguration));
  }
  if (_destinations.isEmpty()) {
    return;
  }
  Registry registry=RegistryUtil.getRegistry();
  _destinationServiceRegistrar=registry.getServiceRegistrar(Destination.class);
  for (  Destination destination : _destinations) {
    String destinationName=destination.getName();
    try {
      PortalMessageBusPermission.checkListen(destinationName);
    }
 catch (    SecurityException se) {
      if (_log.isInfoEnabled()) {
        _log.info("Rejecting destination " + destinationName);
      }
      continue;
    }
    Map<String,Object> properties=new HashMap<>();
    properties.put("destination.name",destinationName);
    _destinationServiceRegistrar.registerService(Destination.class,destination,properties);
  }
}
