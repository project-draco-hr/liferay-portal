{
  Frequency frequency=null;
  if (recurrence != null) {
    frequency=recurrence.getFrequency();
  }
  long currentStartTime=editedInstance.getStartTime();
  TimeZone timeZone=editedInstance.getTimeZone();
  if (frequency == Frequency.WEEKLY) {
    CalendarBooking firstInstance=_calendarBookingService.getCalendarBookingInstance(editedInstance.getCalendarBookingId(),0);
    java.util.Calendar currentStartTimeJCalendar=CalendarFactoryUtil.getCalendar(currentStartTime,timeZone);
    java.util.Calendar firstInstanceJCalendar=CalendarFactoryUtil.getCalendar(firstInstance.getStartTime(),timeZone);
    if (!JCalendarUtil.isSameDayOfWeek(currentStartTimeJCalendar,firstInstanceJCalendar)) {
      java.util.Calendar newStartTimeJCalendar=CalendarFactoryUtil.getCalendar(newStartTime,timeZone);
      newStartTimeJCalendar=JCalendarUtil.mergeJCalendar(currentStartTimeJCalendar,newStartTimeJCalendar,timeZone);
      newStartTime=newStartTimeJCalendar.getTimeInMillis();
    }
  }
  return newStartTime - currentStartTime;
}
