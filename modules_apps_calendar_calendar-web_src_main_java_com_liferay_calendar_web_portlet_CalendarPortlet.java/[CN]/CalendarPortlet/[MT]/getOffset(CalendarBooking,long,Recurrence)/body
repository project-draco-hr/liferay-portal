{
  Frequency frequency=null;
  if (recurrence != null) {
    frequency=recurrence.getFrequency();
  }
  if (frequency == Frequency.WEEKLY) {
    CalendarBooking firstInstance=_calendarBookingService.getCalendarBookingInstance(calendarBooking.getCalendarBookingId(),0);
    java.util.Calendar currentInstanceJCalendar=CalendarFactoryUtil.getCalendar(calendarBooking.getStartTime(),calendarBooking.getTimeZone());
    java.util.Calendar startTimeJCalendar=CalendarFactoryUtil.getCalendar(startTime,calendarBooking.getTimeZone());
    java.util.Calendar firstInstanceJCalendar=CalendarFactoryUtil.getCalendar(firstInstance.getStartTime(),calendarBooking.getTimeZone());
    if (!JCalendarUtil.isSameDayOfWeek(currentInstanceJCalendar,firstInstanceJCalendar)) {
      startTimeJCalendar=JCalendarUtil.mergeJCalendar(currentInstanceJCalendar,startTimeJCalendar,calendarBooking.getTimeZone());
      startTime=startTimeJCalendar.getTimeInMillis();
    }
  }
  return startTime - calendarBooking.getStartTime();
}
