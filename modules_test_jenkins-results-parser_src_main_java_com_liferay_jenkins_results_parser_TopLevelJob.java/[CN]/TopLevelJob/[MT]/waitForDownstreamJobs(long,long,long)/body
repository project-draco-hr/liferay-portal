{
  long startTime=System.currentTimeMillis();
  while (true) {
    update();
    System.out.print(getDownstreamJobCount("completed"));
    System.out.print(" Completed / ");
    System.out.print(getDownstreamJobCount("running"));
    System.out.print(" Running / ");
    System.out.print(getDownstreamJobCount("queued"));
    System.out.print(" Queued / ");
    System.out.print(getDownstreamJobCount("starting"));
    System.out.print(" Starting / ");
    System.out.print(getDownstreamJobCount());
    System.out.println(" Total");
    List<DownstreamJob> missingJobs=getDownstreamJobs("missing");
    for (    DownstreamJob missingJob : missingJobs) {
      long time=System.currentTimeMillis();
      if ((time - missingJob.getStatusModifiedTime()) > maxStartTime) {
        throw new TimeoutException("Downstream job disappeared");
      }
    }
    long elapsedTime=System.currentTimeMillis() - startTime;
    if ((elapsedTime > maxStartTime) && (getDownstreamJobCount("starting") > 0)) {
      throw new TimeoutException("Unable to find downstream job");
    }
 else     if ((elapsedTime > maxWaitTime) && (getDownstreamJobCount("completed") < getDownstreamJobCount())) {
      throw new TimeoutException("Downstream job timeout");
    }
 else     if (getDownstreamJobCount("completed") == getDownstreamJobCount()) {
      break;
    }
 else {
      Thread.sleep(sleepTime);
    }
  }
}
