{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  long[] addUserIds=StringUtil.split(ParamUtil.getString(actionRequest,"addUserIds"),0L);
  long[] removeUserIds=StringUtil.split(ParamUtil.getString(actionRequest,"removeUserIds"),0L);
  Group group=GroupServiceUtil.getGroup(groupId);
  if (group.isOrganization()) {
    UserServiceUtil.addOrganizationUsers(group.getOrganizationId(),addUserIds);
    UserServiceUtil.unsetOrganizationUsers(group.getOrganizationId(),removeUserIds);
  }
 else {
    UserServiceUtil.addGroupUsers(groupId,addUserIds);
    UserServiceUtil.unsetGroupUsers(groupId,removeUserIds);
  }
  LiveUsers.joinGroup(themeDisplay.getCompanyId(),groupId,addUserIds);
  LiveUsers.leaveGroup(themeDisplay.getCompanyId(),groupId,removeUserIds);
}
