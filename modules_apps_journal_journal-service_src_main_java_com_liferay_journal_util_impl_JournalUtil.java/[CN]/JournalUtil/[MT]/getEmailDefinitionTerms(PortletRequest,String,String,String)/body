{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String fromAddress=HtmlUtil.escape(emailFromAddress);
  String fromName=HtmlUtil.escape(emailFromName);
  String toAddress=LanguageUtil.get(themeDisplay.getLocale(),"the-address-of-the-email-recipient");
  String toName=LanguageUtil.get(themeDisplay.getLocale(),"the-name-of-the-email-recipient");
  if (emailType.equals("requested")) {
    String tempToName=fromName;
    String tempToAddress=fromAddress;
    fromName=toName;
    fromAddress=toAddress;
    toName=tempToName;
    toAddress=tempToAddress;
  }
  Map<String,String> definitionTerms=new LinkedHashMap<>();
  definitionTerms.put("[$ARTICLE_CONTENT]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content"));
  definitionTerms.put("[$ARTICLE_DIFFS$]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content-compared-with-the-previous-version-web-" + "content"));
  definitionTerms.put("[$ARTICLE_ID$]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content-id"));
  definitionTerms.put("[$ARTICLE_TITLE$]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content-title"));
  definitionTerms.put("[$ARTICLE_URL$]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content-url"));
  definitionTerms.put("[$ARTICLE_VERSION$]",LanguageUtil.get(themeDisplay.getLocale(),"the-web-content-version"));
  definitionTerms.put("[$FROM_ADDRESS$]",fromAddress);
  definitionTerms.put("[$FROM_NAME$]",fromName);
  Company company=themeDisplay.getCompany();
  definitionTerms.put("[$PORTAL_URL$]",company.getVirtualHostname());
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  definitionTerms.put("[$PORTLET_NAME$]",HtmlUtil.escape(portletDisplay.getTitle()));
  definitionTerms.put("[$TO_ADDRESS$]",toAddress);
  definitionTerms.put("[$TO_NAME$]",toName);
  return definitionTerms;
}
