{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    long classNameId=PortalUtil.getClassNameId(DDMStructure.class.getName());
    StringBundler sb=new StringBundler(6);
    sb.append("select DDMTemplate.templateId, JournalArticle.id_ ");
    sb.append("from JournalArticle inner join DDMTemplate on (");
    sb.append("DDMTemplate.groupId = JournalArticle.groupId and ");
    sb.append("DDMTemplate.templateKey = ");
    sb.append("JournalArticle.ddmTemplateKey and ");
    sb.append("JournalArticle.classNameId != ?)");
    try (PreparedStatement ps=connection.prepareStatement(sb.toString())){
      ps.setLong(1,classNameId);
      try (ResultSet rs=ps.executeQuery()){
        while (rs.next()) {
          long templateId=rs.getLong("templateId");
          long id=rs.getLong("id_");
          _ddmTemplateLinkLocalService.addTemplateLink(classNameId,id,templateId);
        }
      }
     }
   }
 }
