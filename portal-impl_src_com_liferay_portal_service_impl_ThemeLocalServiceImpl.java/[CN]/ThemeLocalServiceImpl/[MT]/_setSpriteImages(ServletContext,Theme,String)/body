{
  Set<String> resourcePaths=servletContext.getResourcePaths(resourcePath);
  if (resourcePaths == null) {
    return;
  }
  List<File> images=new ArrayList<File>(resourcePaths.size());
  for (  String curResourcePath : resourcePaths) {
    if (curResourcePath.endsWith(StringPool.SLASH)) {
      _setSpriteImages(servletContext,theme,curResourcePath);
    }
 else     if (curResourcePath.endsWith(".png")) {
      String realPath=ServletContextUtil.getRealPath(servletContext,curResourcePath);
      if (realPath != null) {
        images.add(new File(realPath));
      }
 else {
        _log.error("Real path for " + curResourcePath + " is null");
      }
    }
  }
  String spriteFileName=".sprite.png";
  String spritePropertiesFileName=".sprite.properties";
  String spritePropertiesRootPath=ServletContextUtil.getRealPath(servletContext,theme.getImagesPath());
  Properties spriteProperties=SpriteProcessorUtil.generate(images,spriteFileName,spritePropertiesFileName,spritePropertiesRootPath,16,16,10 * 1024);
  if (spriteProperties == null) {
    return;
  }
  spriteFileName=resourcePath.substring(theme.getImagesPath().length(),resourcePath.length()) + spriteFileName;
  theme.setSpriteImages(spriteFileName,spriteProperties);
}
