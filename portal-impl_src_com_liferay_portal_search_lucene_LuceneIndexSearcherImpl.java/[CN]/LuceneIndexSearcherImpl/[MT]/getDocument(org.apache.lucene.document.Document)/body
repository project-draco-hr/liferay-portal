{
  DocumentImpl newDocument=new DocumentImpl();
  List<org.apache.lucene.document.Fieldable> oldFieldables=oldDocument.getFields();
  for (  org.apache.lucene.document.Fieldable oldFieldable : oldFieldables) {
    Field newField=null;
    String[] values=oldDocument.getValues(oldFieldable.name());
    if ((values != null) && (values.length > 1)) {
      newField=new Field(oldFieldable.name(),values);
    }
 else {
      newField=new Field(oldFieldable.name(),oldFieldable.stringValue());
    }
    newField.setNumeric(oldFieldable instanceof NumericField);
    newField.setTokenized(oldFieldable.isTokenized());
    newDocument.add(newField);
  }
  return newDocument;
}
