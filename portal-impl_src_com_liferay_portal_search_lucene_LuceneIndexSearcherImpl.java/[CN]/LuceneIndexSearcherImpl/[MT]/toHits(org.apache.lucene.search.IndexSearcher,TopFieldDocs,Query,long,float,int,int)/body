{
  int length=topFieldDocs.totalHits;
  if ((start == QueryUtil.ALL_POS) && (end == QueryUtil.ALL_POS)) {
    start=0;
    end=length;
  }
  String[] queryTerms=getQueryTerms(query);
  Hits hits=new HitsImpl();
  if ((start > -1) && (start <= end)) {
    if (end > length) {
      end=length;
    }
    int subsetTotal=end - start;
    if (subsetTotal > PropsValues.INDEX_SEARCH_LIMIT) {
      subsetTotal=PropsValues.INDEX_SEARCH_LIMIT;
    }
    List<Document> subsetDocs=new ArrayList<Document>(subsetTotal);
    List<String> subsetSnippets=new ArrayList<String>(subsetTotal);
    List<Float> subsetScores=new ArrayList<Float>(subsetTotal);
    for (int i=start; i < end; i++) {
      if (i >= PropsValues.INDEX_SEARCH_LIMIT) {
        break;
      }
      org.apache.lucene.document.Document document=indexSearcher.doc(topFieldDocs.scoreDocs[i].doc);
      Document subsetDocument=getDocument(document);
      subsetDocs.add(subsetDocument);
      String subsetSnippet=getSnippet(document,query,Field.CONTENT);
      subsetSnippets.add(subsetSnippet);
      Float subsetScore=topFieldDocs.scoreDocs[i].score;
      subsetScores.add(subsetScore);
    }
    hits.setStart(startTime);
    hits.setSearchTime(searchTime);
    hits.setQueryTerms(queryTerms);
    hits.setDocs(subsetDocs.toArray(new Document[subsetDocs.size()]));
    hits.setLength(length);
    hits.setSnippets(subsetSnippets.toArray(new String[subsetSnippets.size()]));
    hits.setScores(subsetScores.toArray(new Float[subsetScores.size()]));
  }
  return hits;
}
