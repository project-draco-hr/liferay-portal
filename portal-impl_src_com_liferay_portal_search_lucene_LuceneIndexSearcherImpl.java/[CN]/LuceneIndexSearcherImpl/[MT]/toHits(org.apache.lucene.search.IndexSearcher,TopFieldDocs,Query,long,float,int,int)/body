{
  int length=topFieldDocs.totalHits;
  if ((start == QueryUtil.ALL_POS) && (end == QueryUtil.ALL_POS)) {
    start=0;
    end=length;
  }
  String[] queryTerms=getQueryTerms(query);
  Hits hits=new HitsImpl();
  if ((start > -1) && (start <= end)) {
    if (end > length) {
      end=length;
    }
    int subsetTotal=end - start;
    Document[] subsetDocs=new DocumentImpl[subsetTotal];
    String[] subsetSnippets=new String[subsetTotal];
    float[] subsetScores=new float[subsetTotal];
    int j=0;
    for (int i=start; i < end; i++, j++) {
      org.apache.lucene.document.Document document=indexSearcher.doc(topFieldDocs.scoreDocs[i].doc);
      subsetDocs[j]=getDocument(document);
      subsetSnippets[j]=getSnippet(document,query,Field.CONTENT);
      subsetScores[j]=topFieldDocs.scoreDocs[i].score;
    }
    hits.setStart(startTime);
    hits.setSearchTime(searchTime);
    hits.setQueryTerms(queryTerms);
    hits.setDocs(subsetDocs);
    hits.setLength(length);
    hits.setSnippets(subsetSnippets);
    hits.setScores(subsetScores);
  }
  return hits;
}
