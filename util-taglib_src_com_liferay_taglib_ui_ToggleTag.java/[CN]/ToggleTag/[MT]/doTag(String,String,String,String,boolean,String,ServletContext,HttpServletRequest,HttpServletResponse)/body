{
  String defaultStateValue=defaultOn ? StringPool.BLANK : "none";
  String defaultImage=defaultOn ? onImage : offImage;
  String clickValue=SessionClicks.get(req,id,null);
  if (defaultOn) {
    if ((clickValue != null) && (clickValue.equals("none"))) {
      defaultStateValue="none";
      defaultImage=offImage;
    }
 else {
      defaultStateValue="";
      defaultImage=onImage;
    }
  }
 else {
    if ((clickValue == null) || (clickValue.equals("none"))) {
      defaultStateValue="none";
      defaultImage=offImage;
    }
 else {
      defaultStateValue="";
      defaultImage=onImage;
    }
  }
  if (stateVar == null) {
    stateVar=PwdGenerator.getPassword(PwdGenerator.KEY3,8);
  }
  req.setAttribute("liferay-ui:toggle:id",id);
  req.setAttribute("liferay-ui:toggle:onImage",onImage);
  req.setAttribute("liferay-ui:toggle:offImage",offImage);
  req.setAttribute("liferay-ui:toggle:stateVar",stateVar);
  req.setAttribute("liferay-ui:toggle:defaultStateValue",defaultStateValue);
  req.setAttribute("liferay-ui:toggle:defaultImage",defaultImage);
  RequestDispatcher rd=ctx.getRequestDispatcher(page);
  rd.include(req,res);
}
