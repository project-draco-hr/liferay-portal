{
  try {
    String sourceFilePathName=syncFile.getFilePathName();
    String targetFilePathName=filePath.toString();
    syncFile.setFilePathName(targetFilePathName);
    syncFile.setLocalSyncTime(System.currentTimeMillis());
    syncFile.setName(String.valueOf(filePath.getFileName()));
    syncFile.setParentFolderId(parentFolderId);
    if (!syncFile.isFolder()) {
      return update(syncFile);
    }
    update(syncFile);
    if (syncFile.getTypePK() == 0) {
      return syncFile;
    }
    List<SyncFile> childSyncFiles=_syncFilePersistence.queryForEq("parentFolderId",syncFile.getTypePK());
    for (    SyncFile childSyncFile : childSyncFiles) {
      String childFilePathName=childSyncFile.getFilePathName();
      childFilePathName=childFilePathName.replace(sourceFilePathName,targetFilePathName);
      if (childSyncFile.isFolder()) {
        updateSyncFile(Paths.get(childFilePathName),childSyncFile.getParentFolderId(),childSyncFile);
      }
 else {
        childSyncFile.setFilePathName(childFilePathName);
        update(childSyncFile);
      }
    }
    return syncFile;
  }
 catch (  SQLException sqle) {
    if (_logger.isDebugEnabled()) {
      _logger.debug(sqle.getMessage(),sqle);
    }
    return null;
  }
}
