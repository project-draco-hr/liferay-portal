{
  long plid=GetterUtil.getLong(primKey.substring(0,primKey.indexOf(PortletConstants.LAYOUT_SEPARATOR)));
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  Resource resource=ResourceLocalServiceUtil.addResource(layout.getCompanyId(),modelName,scope,String.valueOf(layout.getGroupId()));
  long portletPermissionCount=getPortletPermissionsCount(actionId,resource.getResourceId(),modelName);
  if (portletPermissionCount == 0) {
    Permission permission=PermissionLocalServiceUtil.getPermission(permissionId);
    permission.setResourceId(resource.getResourceId());
    PermissionLocalServiceUtil.updatePermission(permission);
  }
 else {
    runSQL("delete from Permission_ where permissionId = " + permissionId);
  }
}
