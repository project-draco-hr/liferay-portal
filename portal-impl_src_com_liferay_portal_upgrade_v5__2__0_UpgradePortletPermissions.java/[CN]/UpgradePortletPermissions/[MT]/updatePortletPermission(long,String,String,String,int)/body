{
  long plid=GetterUtil.getLong(primKey.substring(0,primKey.indexOf(PortletConstants.LAYOUT_SEPARATOR)));
  Object[] layout=getLayout(plid);
  if (layout == null) {
    return;
  }
  long groupId=(Long)layout[0];
  long companyId=(Long)layout[1];
  Resource resource=null;
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
    resource=addResource_6(companyId,modelName,scope,String.valueOf(groupId));
  }
 else {
    resource=addResource_1to5(companyId,modelName,scope,String.valueOf(groupId));
  }
  long portletPermissionCount=getPortletPermissionsCount(actionId,resource.getResourceId(),modelName);
  if (portletPermissionCount == 0) {
    runSQL("update Permission_ set resourceId = " + resource.getResourceId() + " where permissionId = "+ permissionId);
  }
 else {
    runSQL("delete from Permission_ where permissionId = " + permissionId);
  }
}
