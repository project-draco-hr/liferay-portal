{
  try {
    long nodeId=ParamUtil.getLong(actionRequest,"nodeId");
    String nodeName=ParamUtil.getString(actionRequest,"nodeName");
    String title=ParamUtil.getString(actionRequest,"title");
    double version=ParamUtil.getDouble(actionRequest,"version");
    String targetExtension=ParamUtil.getString(actionRequest,"targetExtension");
    ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
    PortletURL viewPageURL=new PortletURLImpl((ActionRequestImpl)actionRequest,portletConfig.getPortletName(),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    viewPageURL.setPortletMode(PortletMode.VIEW);
    viewPageURL.setWindowState(WindowState.MAXIMIZED);
    viewPageURL.setParameter("struts_action","/wiki/view");
    viewPageURL.setParameter("nodeName",nodeName);
    viewPageURL.setParameter("title",title);
    PortletURL editPageURL=new PortletURLImpl((ActionRequestImpl)actionRequest,portletConfig.getPortletName(),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    editPageURL.setPortletMode(PortletMode.VIEW);
    editPageURL.setWindowState(WindowState.MAXIMIZED);
    editPageURL.setParameter("struts_action","/wiki/edit_page");
    editPageURL.setParameter("nodeId",String.valueOf(nodeId));
    editPageURL.setParameter("title",title);
    HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
    HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
    getFile(nodeId,title,version,targetExtension,viewPageURL,editPageURL,themeDisplay,request,response);
    setForward(actionRequest,ActionConstants.COMMON_NULL);
  }
 catch (  Exception e) {
    String host=PrefsPropsUtil.getString(PropsKeys.OPENOFFICE_SERVER_HOST);
    if (Validator.isNotNull(host) && !host.equals(_LOCALHOST_IP) && !host.startsWith(_LOCALHOST)) {
      StringBundler sb=new StringBundler(3);
      sb.append("Conversion using a remote OpenOffice instance is ");
      sb.append("not fully supported. Please use a local instance ");
      sb.append("to prevent any limitations and problems.");
      _log.error(sb.toString());
    }
    PortalUtil.sendError(e,actionRequest,actionResponse);
  }
}
