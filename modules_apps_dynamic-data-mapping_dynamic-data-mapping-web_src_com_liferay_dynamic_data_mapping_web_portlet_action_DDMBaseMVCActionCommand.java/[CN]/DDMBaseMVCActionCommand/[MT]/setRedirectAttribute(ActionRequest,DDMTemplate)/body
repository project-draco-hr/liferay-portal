{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String portletNamespace=PortalUtil.getPortletNamespace(themeDisplay.getPpid());
  String oldRedirect=getRedirect(actionRequest);
  String newRedirect=HttpUtil.setParameter(oldRedirect,portletNamespace.concat("classPK"),ParamUtil.getLong(actionRequest,"classPK"));
  boolean saveAndContinue=ParamUtil.getBoolean(actionRequest,"saveAndContinue");
  if (saveAndContinue) {
    newRedirect=getSaveAndContinueRedirect(actionRequest,template,newRedirect);
  }
  actionRequest.setAttribute(WebKeys.REDIRECT,newRedirect);
}
