{
  if (isChecked()) {
    return;
  }
  long companyId=CompanyThreadLocal.getCompanyId();
  List<String> serviceAccessPolicyNames=new ArrayList<>();
  serviceAccessPolicyNames.addAll(getActiveServiceAccessPolicyNames());
  serviceAccessPolicyNames.addAll(getDefaultServiceAccessPolicyNames(companyId));
  serviceAccessPolicyNames.addAll(getSystemServiceAccessPolicyNames(companyId));
  Set<String> allowedServiceSignatures=loadAllowedServiceSignatures(companyId,serviceAccessPolicyNames);
  Class<?> clazz=method.getDeclaringClass();
  checkAccess(allowedServiceSignatures,clazz.getName(),method.getName());
}
