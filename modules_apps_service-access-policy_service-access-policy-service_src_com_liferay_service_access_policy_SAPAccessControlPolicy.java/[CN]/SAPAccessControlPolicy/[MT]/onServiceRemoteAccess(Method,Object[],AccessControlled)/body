{
  if (alreadyChecked()) {
    return;
  }
  long companyId=CompanyThreadLocal.getCompanyId();
  List<String> serviceAccessPolicyNames=getActiveSAPNames();
  List<String> systemSAPNames=getSystemSAPNames(companyId);
  serviceAccessPolicyNames.addAll(systemSAPNames);
  List<String> defaultSAPNames=getDefaultSAPNames(companyId);
  serviceAccessPolicyNames.addAll(defaultSAPNames);
  Set<String> allowedServiceSignatures=loadAllowedServiceSignatures(companyId,serviceAccessPolicyNames);
  Class<?> clazz=method.getDeclaringClass();
  String className=clazz.getName();
  String methodName=method.getName();
  checkAccess(allowedServiceSignatures,className,methodName);
}
