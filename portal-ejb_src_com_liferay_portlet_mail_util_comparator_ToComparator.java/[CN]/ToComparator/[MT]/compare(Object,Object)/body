{
  Message msg1=(Message)obj1;
  Message msg2=(Message)obj2;
  try {
    InternetAddress[] toRecipients1=(InternetAddress[])msg1.getRecipients(Message.RecipientType.TO);
    String to1=null;
    if (toRecipients1 != null) {
      to1=InternetAddress.toString(toRecipients1);
    }
    if (Validator.isNotNull(to1)) {
      to1=to1.toLowerCase();
    }
 else {
      to1="";
    }
    InternetAddress[] toRecipients2=(InternetAddress[])msg2.getRecipients(Message.RecipientType.TO);
    String to2=null;
    if (toRecipients2 != null) {
      to2=InternetAddress.toString(toRecipients2);
    }
    if (Validator.isNotNull(to2)) {
      to2=to2.toLowerCase();
    }
 else {
      to2="";
    }
    if (_asc) {
      return to1.compareTo(to2);
    }
 else {
      return -(to1.compareTo(to2));
    }
  }
 catch (  MessagingException me) {
    me.printStackTrace();
  }
  return 0;
}
