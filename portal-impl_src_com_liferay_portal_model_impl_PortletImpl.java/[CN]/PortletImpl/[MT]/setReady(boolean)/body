{
  _readyMap.put(getRootPortletId(),ready);
  Registry registry=RegistryUtil.getRegistry();
synchronized (_serviceRegistrars) {
    if (ready) {
      ServiceRegistrar<Portlet> serviceRegistrar=registry.getServiceRegistrar(Portlet.class);
      Map<String,Object> properties=new HashMap<>();
      properties.put("javax.portlet.name",getPortletName());
      serviceRegistrar.registerService(Portlet.class,this,properties);
      _serviceRegistrars.put(getRootPortletId(),serviceRegistrar);
    }
 else {
      ServiceRegistrar<Portlet> serviceRegistrar=_serviceRegistrars.remove(getRootPortletId());
      serviceRegistrar.destroy();
    }
  }
}
