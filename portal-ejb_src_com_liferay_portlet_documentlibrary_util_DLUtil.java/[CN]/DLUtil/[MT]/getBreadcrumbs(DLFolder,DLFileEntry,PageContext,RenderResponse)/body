{
  if ((fileEntry != null) && (folder == null)) {
    folder=fileEntry.getFolder();
  }
  PortletURL foldersURL=res.createRenderURL();
  foldersURL.setWindowState(WindowState.MAXIMIZED);
  foldersURL.setParameter("struts_action","/document_library/view");
  String foldersLink="<a href=\"" + foldersURL.toString() + "\">"+ LanguageUtil.get(pageContext,"folders")+ "</a>";
  if (folder == null) {
    return foldersLink;
  }
  String breadcrumbs=StringPool.BLANK;
  if (folder != null) {
    for (int i=0; ; i++) {
      PortletURL portletURL=res.createRenderURL();
      portletURL.setWindowState(WindowState.MAXIMIZED);
      portletURL.setParameter("struts_action","/document_library/view");
      portletURL.setParameter("folderId",folder.getFolderId());
      String folderLink="<a href=\"" + portletURL.toString() + "\">"+ folder.getName()+ "</a>";
      if (i == 0) {
        breadcrumbs=folderLink;
      }
 else {
        breadcrumbs=folderLink + " &raquo; " + breadcrumbs;
      }
      if (folder.isRoot()) {
        break;
      }
      folder=DLFolderLocalServiceUtil.getFolder(folder.getParentFolderId());
    }
  }
  breadcrumbs=foldersLink + " &raquo; " + breadcrumbs;
  if (fileEntry != null) {
    PortletURL fileEntryURL=res.createRenderURL();
    fileEntryURL.setWindowState(WindowState.MAXIMIZED);
    fileEntryURL.setParameter("struts_action","/document_library/edit_file_entry");
    fileEntryURL.setParameter("folderId",fileEntry.getFolderId());
    fileEntryURL.setParameter("name",fileEntry.getName());
    String fileEntryLink="<a href=\"" + fileEntryURL.toString() + "\">"+ fileEntry.getName()+ "</a>";
    breadcrumbs=breadcrumbs + " &raquo; " + fileEntryLink;
  }
  return breadcrumbs;
}
