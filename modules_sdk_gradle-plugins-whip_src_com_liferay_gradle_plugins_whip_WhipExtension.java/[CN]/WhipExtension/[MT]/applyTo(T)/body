{
  WhipTaskExtension whipTaskExtension=GradleUtil.addExtension(task,TASK_EXTENSION_NAME,WhipTaskExtension.class);
  whipTaskExtension.setDataFile(_project.file("test-coverage/whip.dat"));
  whipTaskExtension.setWhipJarFile(new Callable<File>(){
    @Override public File call() throws Exception {
      Configuration configuration=GradleUtil.getConfiguration(_project,WhipPlugin.CONFIGURATION_NAME);
      for (      File file : configuration.getFiles()) {
        String fileName=file.getName();
        if (fileName.startsWith("com.liferay.whip-")) {
          return file;
        }
      }
      return null;
    }
  }
);
  task.doFirst(new Action<Task>(){
    @Override public void execute(    Task task){
      WhipTaskExtension whipTaskExtension=GradleUtil.getExtension(task,WhipTaskExtension.class);
      if (!whipTaskExtension.isEnabled()) {
        return;
      }
      JavaForkOptions javaForkOptions=(JavaForkOptions)task;
      javaForkOptions.jvmArgs(whipTaskExtension.getAsJvmArgs());
      javaForkOptions.systemProperties(whipTaskExtension.getAsSystemProperties());
    }
  }
);
}
