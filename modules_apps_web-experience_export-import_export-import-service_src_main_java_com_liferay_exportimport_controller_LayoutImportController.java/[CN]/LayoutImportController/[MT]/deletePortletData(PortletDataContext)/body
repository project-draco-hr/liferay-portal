{
  Element rootElement=portletDataContext.getImportDataRootElement();
  Element portletsElement=rootElement.element("portlets");
  List<Element> portletElements=portletsElement.elements("portlet");
  Map<Long,Layout> layouts=(Map<Long,Layout>)portletDataContext.getNewPrimaryKeysMap(Layout.class + ".layout");
  if (_log.isDebugEnabled()) {
    if (!portletElements.isEmpty()) {
      _log.debug("Deleting portlet data");
    }
  }
  for (  Element portletElement : portletElements) {
    long layoutId=GetterUtil.getLong(portletElement.attributeValue("layout-id"));
    long plid=LayoutConstants.DEFAULT_PLID;
    Layout layout=layouts.get(layoutId);
    if (layout != null) {
      plid=layout.getPlid();
    }
    portletDataContext.setPlid(plid);
    portletDataContext.setPortletId(portletElement.attributeValue("portlet-id"));
    _portletImportController.deletePortletData(portletDataContext);
  }
}
