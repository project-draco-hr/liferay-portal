{
  try {
    Session session=getSession();
    String versionSeriesId=toFileEntryId(fileEntryId);
    String newFolderObjectId=toFolderId(session,newFolderId);
    Document document=(Document)session.getObject(versionSeriesId);
    validateTitle(session,newFolderId,document.getName());
    String oldFolderObjectId=document.getParents().get(0).getId();
    if (oldFolderObjectId.equals(newFolderObjectId)) {
      return toFileEntry(document);
    }
    document=(Document)document.move(new ObjectIdImpl(oldFolderObjectId),new ObjectIdImpl(newFolderObjectId));
    String newObjectId=document.getVersionSeriesId();
    if (!versionSeriesId.equals(newObjectId)) {
      document=(Document)session.getObject(newObjectId);
      updateMappedId(fileEntryId,document.getVersionSeriesId());
    }
    FileEntry fileEntry=toFileEntry(document);
    document=null;
    return fileEntry;
  }
 catch (  PortalException pe) {
    throw pe;
  }
catch (  SystemException se) {
    throw se;
  }
catch (  Exception e) {
    processException(e);
    throw new RepositoryException(e);
  }
}
