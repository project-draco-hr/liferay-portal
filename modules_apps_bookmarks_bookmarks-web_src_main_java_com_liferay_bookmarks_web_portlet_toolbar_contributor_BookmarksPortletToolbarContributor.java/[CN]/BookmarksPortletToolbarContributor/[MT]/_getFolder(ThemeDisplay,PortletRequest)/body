{
  BookmarksFolder folder=(BookmarksFolder)portletRequest.getAttribute(BookmarksWebKeys.BOOKMARKS_FOLDER);
  if (folder != null) {
    return folder;
  }
  long rootFolderId=BookmarksFolderConstants.DEFAULT_PARENT_FOLDER_ID;
  try {
    BookmarksGroupServiceOverriddenConfiguration bookmarksGroupServiceOverriddenConfiguration=ConfigurationProviderUtil.getConfiguration(BookmarksGroupServiceOverriddenConfiguration.class,new GroupServiceSettingsLocator(themeDisplay.getScopeGroupId(),BookmarksConstants.SERVICE_NAME));
    rootFolderId=bookmarksGroupServiceOverriddenConfiguration.rootFolderId();
  }
 catch (  ConfigurationException ce) {
    _log.error("Unable to obtain bookmarks root folder ID for group " + themeDisplay.getScopeGroupId());
  }
  long folderId=BeanParamUtil.getLong(folder,portletRequest,"folderId",rootFolderId);
  if (folderId != BookmarksFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    try {
      folder=_bookmarksFolderService.getFolder(folderId);
    }
 catch (    NoSuchFolderException nsfe) {
      folder=null;
    }
catch (    PortalException pe) {
      _log.error(pe,pe);
    }
  }
  return folder;
}
