{
  String[] oldValues=jxPreferences.getValues(key,null);
  if (oldValues == null) {
    return;
  }
  Map<Long,Long> primaryKeysMap=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(clazz);
  String[] newValues=new String[oldValues.length];
  for (int i=0; i < oldValues.length; i++) {
    String oldValue=oldValues[i];
    String newValue=oldValue;
    String[] uuids=StringUtil.split(oldValue);
    for (    String uuid : uuids) {
      Long newPrimaryKey=null;
      if (Validator.isNumber(uuid)) {
        long oldPrimaryKey=GetterUtil.getLong(uuid);
        newPrimaryKey=MapUtil.getLong(primaryKeysMap,oldPrimaryKey,oldPrimaryKey);
      }
 else {
        String className=clazz.getName();
        if (className.equals(AssetCategory.class.getName())) {
          AssetCategory category=AssetCategoryUtil.fetchByUUID_G(uuid,groupId);
          if (category != null) {
            newPrimaryKey=category.getCategoryId();
          }
        }
 else         if (className.equals(JournalStructure.class.getName())) {
          JournalStructure structure=JournalStructureUtil.fetchByUUID_G(uuid,groupId);
          if (structure != null) {
            newPrimaryKey=structure.getId();
          }
        }
      }
      if (Validator.isNull(newPrimaryKey)) {
        if (_log.isWarnEnabled()) {
          _log.warn("Unable to get primary key for " + clazz + " with UUID "+ uuid+ " in group "+ groupId);
        }
      }
 else {
        newValue=StringUtil.replace(newValue,uuid,newPrimaryKey.toString());
      }
    }
    newValues[i]=newValue;
  }
  jxPreferences.setValues(key,newValues);
}
