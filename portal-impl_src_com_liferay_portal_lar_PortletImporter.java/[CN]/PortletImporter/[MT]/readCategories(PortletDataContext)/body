{
  try {
    String xml=portletDataContext.getZipEntryAsString(portletDataContext.getSourceRootPath() + "/categories-hierarchy.xml");
    if (xml == null) {
      return;
    }
    Document doc=SAXReaderUtil.read(xml);
    Element root=doc.getRootElement();
    List<Element> vocabularyEls=root.element("vocabularies").elements("vocabulary");
    Map<Long,Long> vocabularyPKs=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(AssetVocabulary.class);
    for (    Element vocabularyEl : vocabularyEls) {
      String path=vocabularyEl.attributeValue("path");
      if (!portletDataContext.isPathNotProcessed(path)) {
        continue;
      }
      AssetVocabulary vocabulary=(AssetVocabulary)portletDataContext.getZipEntryAsObject(path);
      importVocabulary(portletDataContext,vocabularyPKs,vocabularyEl,vocabulary);
    }
    List<Element> categoryEls=root.element("categories").elements("category");
    Map<Long,Long> categoryPKs=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(AssetCategory.class);
    for (    Element categoryEl : categoryEls) {
      String path=categoryEl.attributeValue("path");
      if (!portletDataContext.isPathNotProcessed(path)) {
        continue;
      }
      AssetCategory category=(AssetCategory)portletDataContext.getZipEntryAsObject(path);
      importCategory(portletDataContext,vocabularyPKs,categoryPKs,categoryEl,category);
    }
    List<Element> assets=root.element("assets").elements("asset");
    for (    Element asset : assets) {
      String className=GetterUtil.getString(asset.attributeValue("class-name"));
      long classPK=GetterUtil.getLong(asset.attributeValue("class-pk"));
      String[] assetCategoryUuids=StringUtil.split(GetterUtil.getString(asset.attributeValue("category-uuids")));
      long[] assetCategoryIds=new long[0];
      for (      String assetCategoryUuid : assetCategoryUuids) {
        AssetCategory assetCategory=AssetCategoryUtil.fetchByUUID_G(assetCategoryUuid,portletDataContext.getScopeGroupId());
        if (assetCategory != null) {
          assetCategoryIds=ArrayUtil.append(assetCategoryIds,assetCategory.getCategoryId());
        }
      }
      portletDataContext.addAssetCategories(className,classPK,assetCategoryIds);
    }
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
