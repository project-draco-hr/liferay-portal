{
  long userId=portletDataContext.getUserId(assetVocabulary.getUserUuid());
  long groupId=portletDataContext.getScopeGroupId();
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  serviceContext.setCreateDate(assetVocabulary.getCreateDate());
  serviceContext.setModifiedDate(assetVocabulary.getModifiedDate());
  serviceContext.setScopeGroupId(portletDataContext.getScopeGroupId());
  AssetVocabulary importedAssetVocabulary=null;
  AssetVocabulary existingAssetVocabulary=AssetVocabularyUtil.fetchByG_N(groupId,assetVocabulary.getName());
  Map<Locale,String> titleMap=null;
  if (existingAssetVocabulary == null) {
    serviceContext.setUuid(assetVocabulary.getUuid());
    titleMap=assetVocabulary.getTitleMap();
    if (titleMap == null) {
      titleMap=new HashMap<Locale,String>();
      titleMap.put(LocaleUtil.getDefault(),assetVocabulary.getName());
    }
    importedAssetVocabulary=AssetVocabularyLocalServiceUtil.addVocabulary(userId,assetVocabulary.getTitle(),assetVocabulary.getTitleMap(),assetVocabulary.getDescriptionMap(),assetVocabulary.getSettings(),serviceContext);
  }
 else {
    titleMap=existingAssetVocabulary.getTitleMap();
    if (titleMap == null) {
      titleMap=new HashMap<Locale,String>();
      titleMap.put(LocaleUtil.getDefault(),existingAssetVocabulary.getName());
    }
    importedAssetVocabulary=AssetVocabularyLocalServiceUtil.updateVocabulary(existingAssetVocabulary.getVocabularyId(),assetVocabulary.getTitle(),assetVocabulary.getTitleMap(),assetVocabulary.getDescriptionMap(),assetVocabulary.getSettings(),serviceContext);
  }
  assetVocabularyPKs.put(assetVocabulary.getVocabularyId(),importedAssetVocabulary.getVocabularyId());
  portletDataContext.importPermissions(AssetVocabulary.class,assetVocabulary.getVocabularyId(),importedAssetVocabulary.getVocabularyId());
}
