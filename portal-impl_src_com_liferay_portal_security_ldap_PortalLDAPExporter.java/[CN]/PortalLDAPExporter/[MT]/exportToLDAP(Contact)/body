{
  long companyId=contact.getCompanyId();
  if (!LDAPSettingsUtil.isAuthEnabled(companyId) || !LDAPSettingsUtil.isExportEnabled(companyId)) {
    return;
  }
  User user=UserLocalServiceUtil.getUserByContactId(contact.getContactId());
  long ldapServerId=PortalLDAPUtil.getLdapServerId(companyId,user.getScreenName());
  LdapContext ctx=PortalLDAPUtil.getContext(ldapServerId,companyId);
  try {
    if (ctx == null) {
      return;
    }
    Properties userMappings=LDAPSettingsUtil.getUserMappings(ldapServerId,companyId);
    Binding binding=PortalLDAPUtil.getUser(ldapServerId,contact.getCompanyId(),user.getScreenName());
    Name name=new CompositeName();
    if (binding == null) {
      _getDNName(ldapServerId,companyId,user,userMappings,name);
      LDAPUser ldapUser=(LDAPUser)Class.forName(PropsValues.LDAP_USER_IMPL).newInstance();
      ldapUser.setUser(user,ldapServerId);
      ctx.bind(name,ldapUser);
    }
 else {
      name.add(PortalLDAPUtil.getNameInNamespace(ldapServerId,companyId,binding));
      Modifications mods=Modifications.getInstance();
      mods.addItem(userMappings.getProperty("firstName"),contact.getFirstName());
      String middleNameMapping=userMappings.getProperty("middleName");
      if (Validator.isNotNull(middleNameMapping)) {
        mods.addItem(middleNameMapping,contact.getMiddleName());
      }
      mods.addItem(userMappings.getProperty("lastName"),contact.getLastName());
      String fullNameMapping=userMappings.getProperty("fullName");
      if (Validator.isNotNull(fullNameMapping)) {
        mods.addItem(fullNameMapping,contact.getFullName());
      }
      String jobTitleMapping=userMappings.getProperty("jobTitle");
      if (Validator.isNotNull(jobTitleMapping)) {
        mods.addItem(jobTitleMapping,contact.getJobTitle());
      }
      ModificationItem[] modItems=mods.getItems();
      ctx.modifyAttributes(name,modItems);
    }
  }
 catch (  Exception e) {
    throw e;
  }
 finally {
    if (ctx != null) {
      ctx.close();
    }
  }
}
