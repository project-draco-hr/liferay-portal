{
  List<BreadcrumbEntry> portletBreadcrumbEntries=BreadcrumbUtil.getPortletBreadcrumbEntries(request);
  for (  BreadcrumbEntry portletBreadcrumbEntry : portletBreadcrumbEntries) {
    if (!_showCurrentGroup) {
      String siteGroupName=themeDisplay.getSiteGroupName();
      if (siteGroupName.equals(portletBreadcrumbEntry.getTitle())) {
        continue;
      }
    }
    if (!_showCurrentPortlet) {
      PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
      String portletTitle=PortalUtil.getPortletTitle(portletDisplay.getId(),themeDisplay.getUser());
      if (portletTitle.equals(portletBreadcrumbEntry.getTitle())) {
        continue;
      }
    }
    sb.append("<li>");
    if (Validator.isNotNull(portletBreadcrumbEntry.getURL())) {
      sb.append("<a href=\"");
      sb.append(HtmlUtil.escape(portletBreadcrumbEntry.getURL()));
      sb.append("\"");
      sb.append(AUIUtil.buildData(portletBreadcrumbEntry.getData()));
      sb.append(StringPool.GREATER_THAN);
      sb.append(HtmlUtil.escape(portletBreadcrumbEntry.getTitle()));
      sb.append("</a>");
    }
 else {
      sb.append(HtmlUtil.escape(portletBreadcrumbEntry.getTitle()));
    }
    sb.append("<span class=\"divider\">/</span></li>");
  }
}
