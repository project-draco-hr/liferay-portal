{
  Message[] jxMessages=messageCountEvent.getMessages();
  Folder jxFolder=null;
  try {
    jxFolder=_imapAccessor.openFolder(jxMessages[0].getFolder());
    com.liferay.mail.model.Folder folder=FolderLocalServiceUtil.getFolder(_account.getAccountId(),jxFolder.getFullName());
    long[] remoteMessageIds=_imapAccessor.getMessageUIDs(jxFolder,jxMessages);
    for (    long remoteMessageId : remoteMessageIds) {
      com.liferay.mail.model.Message message=MessageLocalServiceUtil.getMessage(folder.getFolderId(),remoteMessageId);
      MessageLocalServiceUtil.deleteMessage(message.getMessageId());
    }
  }
 catch (  Exception e) {
    _log.error("Unable to delete messages",e);
  }
 finally {
    try {
      _imapAccessor.closeFolder(jxFolder,false);
    }
 catch (    MailException me) {
      _log.error(me);
    }
  }
}
