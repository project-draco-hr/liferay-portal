{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(ResourcePermission.class);
  dynamicQuery.add(RestrictionsFactoryUtil.eq("name",Organization.class.getName()));
  List<ResourcePermission> resourcePermissions=ResourcePermissionLocalServiceUtil.dynamicQuery(dynamicQuery);
  for (  ResourcePermission resourcePermission : resourcePermissions) {
    ResourcePermission groupResourcePermission=null;
    try {
      groupResourcePermission=ResourcePermissionLocalServiceUtil.getResourcePermission(resourcePermission.getCompanyId(),Group.class.getName(),resourcePermission.getScope(),resourcePermission.getPrimKey(),resourcePermission.getRoleId());
    }
 catch (    Exception e) {
      ResourcePermissionLocalServiceUtil.setResourcePermissions(resourcePermission.getCompanyId(),Group.class.getName(),resourcePermission.getScope(),resourcePermission.getPrimKey(),resourcePermission.getRoleId(),new String[0]);
      groupResourcePermission=ResourcePermissionLocalServiceUtil.getResourcePermission(resourcePermission.getCompanyId(),Group.class.getName(),resourcePermission.getScope(),resourcePermission.getPrimKey(),resourcePermission.getRoleId());
    }
    long organizationActions=resourcePermission.getActionIds();
    long groupActions=groupResourcePermission.getActionIds();
    for (    Object[] actionIdToMask : _ORGANIZATION_ACTION_IDS_TO_MASKS) {
      long organizationActionMask=(Long)actionIdToMask[1];
      long groupActionMask=(Long)actionIdToMask[2];
      if ((organizationActions & organizationActionMask) == organizationActionMask) {
        organizationActions=organizationActions & (~organizationActionMask);
        groupActions=groupActions | groupActionMask;
      }
    }
    try {
      resourcePermission.resetOriginalValues();
      resourcePermission.setActionIds(organizationActions);
      ResourcePermissionLocalServiceUtil.updateResourcePermission(resourcePermission,false);
      groupResourcePermission.resetOriginalValues();
      groupResourcePermission.setActionIds(groupActions);
      ResourcePermissionLocalServiceUtil.updateResourcePermission(groupResourcePermission,false);
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
}
