{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(ResourceCode.class);
  dynamicQuery.add(RestrictionsFactoryUtil.eq("name",Organization.class.getName()));
  List<ResourceCode> resouceCodes=ResourceCodeLocalServiceUtil.dynamicQuery(dynamicQuery);
  for (  ResourceCode resourceCode : resouceCodes) {
    dynamicQuery=DynamicQueryFactoryUtil.forClass(Resource.class);
    dynamicQuery.add(RestrictionsFactoryUtil.eq("codeId",resourceCode.getCodeId()));
    List<Resource> resources=ResourceLocalServiceUtil.dynamicQuery(dynamicQuery);
    for (    Resource resource : resources) {
      dynamicQuery=DynamicQueryFactoryUtil.forClass(Permission.class);
      dynamicQuery.add(RestrictionsFactoryUtil.eq("resourceId",resource.getResourceId()));
      List<Permission> permissions=PermissionLocalServiceUtil.dynamicQuery(dynamicQuery);
      processPermissions(resource,permissions);
    }
  }
}
