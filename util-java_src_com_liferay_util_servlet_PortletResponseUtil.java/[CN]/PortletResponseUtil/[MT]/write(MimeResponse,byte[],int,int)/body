{
  if (!mimeResponse.isCommitted()) {
    if (contentLength == 0) {
      contentLength=bytes.length;
    }
    if (mimeResponse instanceof ResourceResponse) {
      ResourceResponse resourceResponse=(ResourceResponse)mimeResponse;
      resourceResponse.setContentLength(contentLength);
    }
    OutputStream outputStream=mimeResponse.getPortletOutputStream();
    outputStream.write(bytes,offset,contentLength);
  }
}
