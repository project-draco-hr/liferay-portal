{
  StringBundler sb=new StringBundler(5);
  sb.append(resourceName);
  sb.append(StringPool.PIPE);
  sb.append(scope);
  sb.append(StringPool.PIPE);
  sb.append(resourcePrimKey);
  String key=sb.toString();
  Resource resource=resourcesMap.get(key);
  if (resource == null) {
    try {
      resource=ResourceLocalServiceUtil.getResource(companyId,resourceName,scope,resourcePrimKey);
    }
 catch (    NoSuchResourceException nsre) {
      ResourceLocalServiceUtil.addResources(companyId,groupId,0,resourceName,resourcePrimKey,portletActions,true,true);
      resource=ResourceLocalServiceUtil.getResource(companyId,resourceName,scope,resourcePrimKey);
    }
    resourcesMap.put(key,resource);
  }
  return resource;
}
