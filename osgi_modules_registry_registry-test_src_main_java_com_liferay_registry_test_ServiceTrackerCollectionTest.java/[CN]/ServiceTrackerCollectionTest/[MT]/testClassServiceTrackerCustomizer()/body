{
  AtomicInteger counter=new AtomicInteger();
  ServiceTrackerCustomizer<InterfaceOne,InterfaceOne> serviceTrackerCustomizer=new MockServiceTrackerCustomizer(counter);
  ServiceTrackerList<InterfaceOne> serviceTrackerList=ServiceTrackerCollections.list(InterfaceOne.class,serviceTrackerCustomizer);
  Assert.assertEquals(0,serviceTrackerList.size());
  Registry registry=RegistryUtil.getRegistry();
  InterfaceOne a=getInstance();
  ServiceRegistration<InterfaceOne> serviceRegistrationA=registry.registerService(InterfaceOne.class,a);
  Assert.assertNotNull(serviceRegistrationA);
  InterfaceOne b=getInstance();
  serviceTrackerList.add(b);
  Assert.assertEquals(2,serviceTrackerList.size());
  for (  InterfaceOne interfaceOne : serviceTrackerList) {
    Assert.assertNotNull(interfaceOne);
  }
  Assert.assertEquals(2,counter.intValue());
  serviceRegistrationA.unregister();
  Assert.assertEquals(1,serviceTrackerList.size());
  Assert.assertEquals(3,counter.intValue());
  serviceTrackerList.remove(b);
  Assert.assertEquals(0,serviceTrackerList.size());
  Assert.assertEquals(4,counter.intValue());
}
