{
  Portlet portlet=ActionUtil.getPortlet(actionRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Settings portletInstanceSettings=SettingsFactoryUtil.getSettings(new PortletInstanceSettingsLocator(themeDisplay.getLayout(),portlet.getPortletId()));
  ModifiableSettings portletInstanceModifiableSettings=portletInstanceSettings.getModifiableSettings();
  String name=ParamUtil.getString(actionRequest,"name");
  ArchivedSettings archivedSettings=SettingsFactoryUtil.getPortletInstanceArchivedSettings(themeDisplay.getSiteGroupId(),portlet.getRootPortletId(),name);
  portletInstanceModifiableSettings.reset();
  portletInstanceModifiableSettings.setValues(archivedSettings);
  portletInstanceModifiableSettings.store();
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  SessionMessages.add(actionRequest,PortalUtil.getPortletId(actionRequest) + SessionMessages.KEY_SUFFIX_REFRESH_PORTLET,portletResource);
}
