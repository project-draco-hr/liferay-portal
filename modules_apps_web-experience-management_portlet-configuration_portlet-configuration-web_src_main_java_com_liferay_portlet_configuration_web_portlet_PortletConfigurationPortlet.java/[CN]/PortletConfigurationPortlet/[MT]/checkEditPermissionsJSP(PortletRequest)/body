{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  String modelResource=ParamUtil.getString(request,"modelResource");
  long resourceGroupId=ParamUtil.getLong(request,"resourceGroupId",themeDisplay.getScopeGroupId());
  if (Validator.isNotNull(modelResource)) {
    String resourcePrimKey=ParamUtil.getString(request,"resourcePrimKey");
    _permissionService.checkPermission(resourceGroupId,modelResource,resourcePrimKey);
    return;
  }
  String portletResource=ParamUtil.getString(request,"portletResource");
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  Layout layout=PortletConfigurationLayoutUtil.getLayout(themeDisplay);
  _portletPermission.check(permissionChecker,resourceGroupId,layout,portletResource,ActionKeys.PERMISSIONS);
}
