{
  RenderedImage renderedImage=pdPage.convertToImage(BufferedImage.TYPE_INT_RGB,PropsValues.DL_FILE_ENTRY_THUMBNAIL_DPI);
  if (height != 0) {
    renderedImage=ImageProcessorUtil.scale(renderedImage,width,height);
  }
 else {
    renderedImage=ImageProcessorUtil.scale(renderedImage,width);
  }
  if (thumbnail) {
    File file=_getThumbnailFile(id);
    file.createNewFile();
    ImageIO.write(renderedImage,THUMBNAIL_TYPE,new FileOutputStream(file));
  }
 else {
    File file=_getPreviewFile(id,index);
    file.createNewFile();
    ImageIO.write(renderedImage,PREVIEW_TYPE,new FileOutputStream(file));
  }
}
