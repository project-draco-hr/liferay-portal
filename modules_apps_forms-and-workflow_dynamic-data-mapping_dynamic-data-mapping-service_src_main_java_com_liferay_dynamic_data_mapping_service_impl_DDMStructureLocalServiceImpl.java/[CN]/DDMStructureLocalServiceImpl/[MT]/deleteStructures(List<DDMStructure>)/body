{
  if (ListUtil.isEmpty(structures)) {
    return Collections.emptySet();
  }
  Set<Long> deletedStructureIds=new HashSet<>();
  for (  DDMStructure structure : structures) {
    if (deletedStructureIds.contains(structure.getStructureId())) {
      continue;
    }
    if (!GroupThreadLocal.isDeleteInProcess()) {
      List<DDMStructure> childDDMStructures=ddmStructurePersistence.findByParentStructureId(structure.getStructureId());
      deletedStructureIds.addAll(deleteStructures(childDDMStructures));
    }
    ddmStructureLocalService.deleteStructure(structure);
    deletedStructureIds.add(structure.getStructureId());
  }
  return deletedStructureIds;
}
