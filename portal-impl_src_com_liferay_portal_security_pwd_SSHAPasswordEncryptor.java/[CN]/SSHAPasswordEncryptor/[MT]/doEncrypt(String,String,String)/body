{
  byte[] saltBytes=getSaltBytes(currentEncryptedPassword);
  try {
    byte[] clearTextPasswordBytes=clearTextPassword.getBytes(Digester.ENCODING);
    byte[] pwdPlusSalt=new byte[clearTextPasswordBytes.length + saltBytes.length];
    System.arraycopy(clearTextPasswordBytes,0,pwdPlusSalt,0,clearTextPasswordBytes.length);
    System.arraycopy(saltBytes,0,pwdPlusSalt,clearTextPasswordBytes.length,saltBytes.length);
    MessageDigest sha1Digest=MessageDigest.getInstance("SHA-1");
    byte[] pwdPlusSaltHash=sha1Digest.digest(pwdPlusSalt);
    byte[] digestPlusSalt=new byte[pwdPlusSaltHash.length + saltBytes.length];
    System.arraycopy(pwdPlusSaltHash,0,digestPlusSalt,0,pwdPlusSaltHash.length);
    System.arraycopy(saltBytes,0,digestPlusSalt,pwdPlusSaltHash.length,saltBytes.length);
    return Base64.encode(digestPlusSalt);
  }
 catch (  NoSuchAlgorithmException nsae) {
    throw new PwdEncryptorException(nsae.getMessage());
  }
catch (  UnsupportedEncodingException uee) {
    throw new PwdEncryptorException(uee.getMessage());
  }
}
