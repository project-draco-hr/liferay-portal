{
  byte[] saltBytes=getSaltBytes(encryptedPassword);
  try {
    MessageDigest messageDigest=MessageDigest.getInstance("SHA-1");
    byte[] plainTextPasswordBytes=plainTextPassword.getBytes(Digester.ENCODING);
    byte[] messageDigestBytes=messageDigest.digest(ArrayUtil.append(plainTextPasswordBytes,saltBytes));
    return Base64.encode(ArrayUtil.append(messageDigestBytes,saltBytes));
  }
 catch (  NoSuchAlgorithmException nsae) {
    throw new PwdEncryptorException(nsae.getMessage(),nsae);
  }
catch (  UnsupportedEncodingException uee) {
    throw new PwdEncryptorException(uee.getMessage(),uee);
  }
}
