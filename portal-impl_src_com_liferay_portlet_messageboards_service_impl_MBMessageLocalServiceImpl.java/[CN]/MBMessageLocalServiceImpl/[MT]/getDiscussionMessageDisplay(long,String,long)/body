{
  long classNameId=PortalUtil.getClassNameId(className);
  MBMessage message=null;
  try {
    MBDiscussion discussion=mbDiscussionPersistence.findByC_C(classNameId,classPK);
    List messages=mbMessagePersistence.findByT_P(discussion.getThreadId(),MBMessageImpl.DEFAULT_PARENT_MESSAGE_ID);
    message=(MBMessage)messages.get(0);
  }
 catch (  NoSuchDiscussionException nsde) {
    String subject=String.valueOf(classPK);
    String body=subject;
    message=addDiscussionMessage(userId,subject,body);
    long discussionId=counterLocalService.increment();
    MBDiscussion discussion=mbDiscussionPersistence.create(discussionId);
    discussion.setClassNameId(classNameId);
    discussion.setClassPK(classPK);
    discussion.setThreadId(message.getThreadId());
    mbDiscussionPersistence.update(discussion);
  }
  return getMessageDisplay(message);
}
