{
  if (Validator.isNull(subject)) {
    if (Validator.isNotNull(body)) {
      int pos=Math.min(body.length(),50);
      subject=body.substring(0,pos) + "...";
    }
 else {
      throw new MessageBodyException();
    }
  }
  List<ObjectValuePair<String,InputStream>> inputStreamOVPs=Collections.emptyList();
  List<String> existingFiles=new ArrayList<String>();
  double priority=0.0;
  boolean allowPingbacks=false;
  serviceContext.setAttribute("className",className);
  serviceContext.setAttribute("classPK",String.valueOf(classPK));
  return updateMessage(userId,messageId,subject,body,inputStreamOVPs,existingFiles,priority,allowPingbacks,serviceContext);
}
