{
  long categoryId=CompanyImpl.SYSTEM;
  if (Validator.isNull(subject)) {
    subject="N/A";
  }
  List files=new ArrayList();
  boolean anonymous=false;
  double priority=0.0;
  String[] tagsEntries=null;
  PortletPreferences prefs=null;
  boolean addCommunityPermissions=true;
  boolean addGuestPermissions=true;
  mbCategoryLocalService.getSystemCategory();
  MBMessage message=addMessage(userId,categoryId,threadId,parentMessageId,subject,body,files,anonymous,priority,tagsEntries,prefs,addCommunityPermissions,addGuestPermissions);
  if ((className.equals(BlogsEntry.class.getName())) && (themeDisplay != null)) {
    try {
      sendBlogsCommentsEmail(userId,classPK,message,themeDisplay);
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
  return message;
}
