{
  HtmlPolicyBuilder htmlPolicyBuilder=new HtmlPolicyBuilder();
  htmlPolicyBuilder.allowStandardUrlProtocols();
  for (  String allowedContentElement : _allowedContentElementAttributes.keySet()) {
    String[] allowedContentAttributes=_allowedContentElementAttributes.get(allowedContentElement);
    if (allowedContentAttributes != null) {
      htmlPolicyBuilder.allowAttributes(allowedContentAttributes).onElements(allowedContentElement);
    }
    htmlPolicyBuilder.allowElements(allowedContentElement);
  }
  PolicyFactory policyFactory=htmlPolicyBuilder.toFactory();
  return policyFactory.sanitize(html);
}
