{
  long classNameId=classNameLocalService.getClassNameId(className);
  MBMessage message=null;
  MBDiscussion discussion=mbDiscussionPersistence.fetchByC_C(classNameId,classPK);
  if (discussion != null) {
    message=mbMessagePersistence.findByT_P_First(discussion.getThreadId(),MBMessageConstants.DEFAULT_PARENT_MESSAGE_ID,null);
  }
 else {
    boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
    WorkflowThreadLocal.setEnabled(false);
    try {
      String subject=String.valueOf(classPK);
      message=addDiscussionMessage(userId,null,groupId,className,classPK,0,MBMessageConstants.DEFAULT_PARENT_MESSAGE_ID,subject,subject,new ServiceContext());
    }
 catch (    SystemException se) {
      if (_log.isWarnEnabled()) {
        _log.warn("Add failed, fetch {threadId=0, parentMessageId=" + MBMessageConstants.DEFAULT_PARENT_MESSAGE_ID + "}");
      }
      message=mbMessagePersistence.fetchByT_P_First(0,MBMessageConstants.DEFAULT_PARENT_MESSAGE_ID,null);
      if (message == null) {
        throw se;
      }
    }
 finally {
      WorkflowThreadLocal.setEnabled(workflowEnabled);
    }
  }
  return getMessageDisplay(userId,message,status,MBThreadConstants.THREAD_VIEW_COMBINATION,false);
}
