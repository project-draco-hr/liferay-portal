{
  long companyId=message.getCompanyId();
  if (!PrefsPropsUtil.getBoolean(companyId,PropsKeys.BLOGS_EMAIL_COMMENTS_ADDED_ENABLED)) {
    return;
  }
  String layoutFullURL=serviceContext.getLayoutFullURL();
  String blogsEntryURL=layoutFullURL + Portal.FRIENDLY_URL_SEPARATOR + "blogs/"+ entry.getUrlTitle();
  User blogsUser=userPersistence.findByPrimaryKey(entry.getUserId());
  User commentsUser=userPersistence.findByPrimaryKey(userId);
  String fromName=PrefsPropsUtil.getString(companyId,PropsKeys.ADMIN_EMAIL_FROM_NAME);
  String fromAddress=PrefsPropsUtil.getString(companyId,PropsKeys.ADMIN_EMAIL_FROM_ADDRESS);
  String toName=blogsUser.getFullName();
  String toAddress=blogsUser.getEmailAddress();
  String subject=PrefsPropsUtil.getContent(companyId,PropsKeys.BLOGS_EMAIL_COMMENTS_ADDED_SUBJECT);
  String body=PrefsPropsUtil.getContent(companyId,PropsKeys.BLOGS_EMAIL_COMMENTS_ADDED_BODY);
  subject=StringUtil.replace(subject,new String[]{"[$BLOGS_COMMENTS_BODY$]","[$BLOGS_COMMENTS_USER_ADDRESS$]","[$BLOGS_COMMENTS_USER_NAME$]","[$BLOGS_ENTRY_URL$]","[$FROM_ADDRESS$]","[$FROM_NAME$]","[$TO_ADDRESS$]","[$TO_NAME$]"},new String[]{message.getBody(),commentsUser.getEmailAddress(),commentsUser.getFullName(),blogsEntryURL,fromAddress,fromName,toAddress,toName});
  body=StringUtil.replace(body,new String[]{"[$BLOGS_COMMENTS_BODY$]","[$BLOGS_COMMENTS_USER_ADDRESS$]","[$BLOGS_COMMENTS_USER_NAME$]","[$BLOGS_ENTRY_URL$]","[$FROM_ADDRESS$]","[$FROM_NAME$]","[$TO_ADDRESS$]","[$TO_NAME$]"},new String[]{message.getBody(),commentsUser.getEmailAddress(),commentsUser.getFullName(),blogsEntryURL,fromAddress,fromName,toAddress,toName});
  InternetAddress from=new InternetAddress(fromAddress,fromName);
  InternetAddress to=new InternetAddress(toAddress,toName);
  MailMessage mailMessage=new MailMessage(from,to,subject,body,true);
  mailService.sendEmail(mailMessage);
}
