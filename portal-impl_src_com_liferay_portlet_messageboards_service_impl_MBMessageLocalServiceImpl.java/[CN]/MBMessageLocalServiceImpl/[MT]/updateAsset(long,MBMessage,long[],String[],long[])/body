{
  boolean visible=false;
  if ((message.getStatus() == WorkflowConstants.STATUS_APPROVED) && ((message.getClassNameId() == 0) || (message.getParentMessageId() != 0))) {
    visible=true;
  }
  AssetEntry assetEntry=assetEntryLocalService.updateEntry(userId,message.getGroupId(),message.getWorkflowClassName(),message.getMessageId(),message.getUuid(),assetCategoryIds,assetTagNames,visible,null,null,null,null,ContentTypes.TEXT_HTML,message.getSubject(),null,null,null,null,0,0,null,false);
  assetLinkLocalService.updateLinks(userId,assetEntry.getEntryId(),assetLinkEntryIds,AssetLinkConstants.TYPE_RELATED);
}
