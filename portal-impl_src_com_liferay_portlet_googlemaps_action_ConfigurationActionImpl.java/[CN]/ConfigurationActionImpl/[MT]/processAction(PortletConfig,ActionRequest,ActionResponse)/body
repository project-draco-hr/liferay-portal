{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  String mapAddress=ParamUtil.getString(req,"mapAddress");
  boolean mapInputEnabled=ParamUtil.getBoolean(req,"mapInputEnabled");
  String directionsAddress=ParamUtil.getString(req,"directionsAddress");
  boolean directionsInputEnabled=ParamUtil.getBoolean(req,"directionsInputEnabled");
  String height=ParamUtil.getString(req,"height");
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("map-address",mapAddress);
  prefs.setValue("map-input-enabled",String.valueOf(mapInputEnabled));
  prefs.setValue("directions-address",directionsAddress);
  prefs.setValue("directions-input-enabled",String.valueOf(directionsInputEnabled));
  prefs.setValue("height",height);
  prefs.store();
  PortletSession ses=req.getPortletSession();
  ses.removeAttribute(PortalUtil.getPortletNamespace(portletResource) + "mapAddress",PortletSession.APPLICATION_SCOPE);
  ses.removeAttribute(PortalUtil.getPortletNamespace(portletResource) + "directionsAddress",PortletSession.APPLICATION_SCOPE);
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
