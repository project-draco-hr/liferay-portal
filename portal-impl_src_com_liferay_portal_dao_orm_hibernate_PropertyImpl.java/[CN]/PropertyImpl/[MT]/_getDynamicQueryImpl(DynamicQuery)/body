{
  if (subselect instanceof DynamicQueryImpl) {
    return (DynamicQueryImpl)subselect;
  }
  if (ProxyUtil.isProxyClass(subselect.getClass())) {
    DoPrivilegedHandler doPrivilegedHandler=(DoPrivilegedHandler)ProxyUtil.getInvocationHandler(subselect);
    return (DynamicQueryImpl)doPrivilegedHandler.getActualBean();
  }
  throw new IllegalArgumentException(subselect + " can not be converted to " + DynamicQueryImpl.class);
}
