{
  if (Validator.isNull(PropsValues.COMPANY_SECURITY_STRANGERS_URL)) {
    PortletURL createAccountURL=PortletURLFactoryUtil.create(request,PortletKeys.LOGIN,themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    createAccountURL.setWindowState(WindowState.MAXIMIZED);
    createAccountURL.setPortletMode(PortletMode.VIEW);
    createAccountURL.setParameter("saveLastPath","0");
    createAccountURL.setParameter("struts_action","/login/create_account");
    String portalURL=PortalUtil.getPortalURL(request);
    String portalURLSecure=PortalUtil.getPortalURL(request,true);
    String createAccountURLStr=createAccountURL.toString();
    if (PropsValues.COMPANY_SECURITY_AUTH_REQUIRES_HTTPS) {
      createAccountURLStr=StringUtil.replaceFirst(createAccountURL.toString(),portalURL,portalURLSecure);
    }
    return createAccountURLStr;
  }
  try {
    Layout layout=LayoutLocalServiceUtil.getFriendlyURLLayout(themeDisplay.getScopeGroupId(),false,PropsValues.COMPANY_SECURITY_STRANGERS_URL);
    return getLayoutURL(layout,themeDisplay);
  }
 catch (  NoSuchLayoutException nsle) {
  }
  return StringPool.BLANK;
}
