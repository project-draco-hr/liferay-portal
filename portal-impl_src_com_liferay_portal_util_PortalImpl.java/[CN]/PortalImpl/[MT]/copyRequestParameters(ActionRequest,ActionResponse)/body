{
  if (actionResponse instanceof StateAwareResponseImpl) {
    StateAwareResponseImpl stateAwareResponseImpl=(StateAwareResponseImpl)actionResponse;
    if (stateAwareResponseImpl.getRedirectLocation() != null) {
      if (_log.isDebugEnabled()) {
        _log.debug("Cannot copy parameters on a redirected " + "StateAwareResponseImpl");
      }
      return;
    }
  }
  LiferayPortletResponse liferayPortletResponse=getLiferayPortletResponse(actionResponse);
  StateAwareResponse stateAwareResponse=(StateAwareResponse)liferayPortletResponse;
  Map<String,String[]> renderParameters=stateAwareResponse.getRenderParameterMap();
  actionResponse.setRenderParameter("p_p_lifecycle","1");
  Enumeration<String> enu=actionRequest.getParameterNames();
  while (enu.hasMoreElements()) {
    String param=enu.nextElement();
    String[] values=actionRequest.getParameterValues(param);
    if (renderParameters.get(actionResponse.getNamespace() + param) == null) {
      actionResponse.setRenderParameter(param,values);
    }
  }
}
