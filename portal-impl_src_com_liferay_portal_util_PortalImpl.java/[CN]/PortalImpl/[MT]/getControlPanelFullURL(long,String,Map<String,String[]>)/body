{
  StringBundler sb=new StringBundler(6);
  Group group=GroupLocalServiceUtil.getGroup(scopeGroupId);
  Company company=CompanyLocalServiceUtil.getCompany(group.getCompanyId());
  sb.append(getPortalURL(company.getVirtualHostname(),getPortalServerPort(false),false));
  sb.append(getPathFriendlyURLPrivateGroup());
  sb.append(group.getFriendlyURL());
  sb.append(VirtualLayoutConstants.CANONICAL_URL_SEPARATOR);
  sb.append(GroupConstants.CONTROL_PANEL_FRIENDLY_URL);
  sb.append(PropsValues.CONTROL_PANEL_LAYOUT_FRIENDLY_URL);
  if (params != null) {
    params=new HashMap<>(params);
  }
 else {
    params=new HashMap<>();
  }
  params.put("p_p_id",new String[]{ppid});
  params.put("p_p_lifecycle",new String[]{"0"});
  params.put("p_p_state",new String[]{WindowState.MAXIMIZED.toString()});
  params.put("p_p_mode",new String[]{PortletMode.VIEW.toString()});
  sb.append(HttpUtil.parameterMapToString(params,true));
  return sb.toString();
}
