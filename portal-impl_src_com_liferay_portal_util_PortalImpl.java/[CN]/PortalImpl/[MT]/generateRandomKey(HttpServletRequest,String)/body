{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (themeDisplay.isAjax() || themeDisplay.isIsolated() || themeDisplay.isLifecycleResource()|| themeDisplay.isStateExclusive()) {
    return StringUtil.randomId();
  }
 else {
    StringBundler sb=new StringBundler(5);
    sb.append(DeterminateKeyGenerator.generate(input));
    sb.append(StringPool.UNDERLINE);
    sb.append(request.getAttribute(WebKeys.RENDER_PORTLET_COLUMN_ID));
    sb.append(StringPool.UNDERLINE);
    sb.append(request.getAttribute(WebKeys.RENDER_PORTLET_COLUMN_POS));
    return JS.getSafeName(sb.toString());
  }
}
