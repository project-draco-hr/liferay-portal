{
  if (Validator.isNotNull(layoutSet.getVirtualHost())) {
    String portalURL=getPortalURL(layoutSet.getVirtualHost(),themeDisplay.getServerPort(),themeDisplay.isSecure());
    long curLayoutSetId=themeDisplay.getLayout().getLayoutSet().getLayoutSetId();
    if ((layoutSet.getLayoutSetId() != curLayoutSetId) || (portalURL.startsWith(themeDisplay.getURLPortal()))) {
      String layoutSetFriendlyURL=StringPool.BLANK;
      if (themeDisplay.isI18n()) {
        layoutSetFriendlyURL=StringPool.SLASH + themeDisplay.getI18nLanguageId();
      }
      return portalURL + _pathContext + layoutSetFriendlyURL;
    }
  }
  Group group=GroupLocalServiceUtil.getGroup(layoutSet.getGroupId());
  String friendlyURL=null;
  if (layoutSet.isPrivateLayout()) {
    if (group.isUser()) {
      friendlyURL=_PRIVATE_USER_SERVLET_MAPPING;
    }
 else {
      friendlyURL=_PRIVATE_GROUP_SERVLET_MAPPING;
    }
  }
 else {
    friendlyURL=_PUBLIC_GROUP_SERVLET_MAPPING;
  }
  if (themeDisplay.isI18n()) {
    friendlyURL=StringPool.SLASH + themeDisplay.getI18nLanguageId() + friendlyURL;
  }
  return _pathContext + friendlyURL + group.getFriendlyURL();
}
