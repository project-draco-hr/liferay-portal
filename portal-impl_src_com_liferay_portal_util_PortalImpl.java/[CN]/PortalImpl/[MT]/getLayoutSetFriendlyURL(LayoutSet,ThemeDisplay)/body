{
  if (Validator.isNotNull(layoutSet.getVirtualHost())) {
    String portalURL=getPortalURL(layoutSet.getVirtualHost(),themeDisplay.getServerPort(),themeDisplay.isSecure());
    long curLayoutSetId=themeDisplay.getLayout().getLayoutSet().getLayoutSetId();
    if ((layoutSet.getLayoutSetId() != curLayoutSetId) || (portalURL.startsWith(themeDisplay.getURLPortal()))) {
      return portalURL + getPathContext();
    }
  }
  Group group=GroupLocalServiceUtil.getGroup(layoutSet.getGroupId());
  String friendlyURL=null;
  if (layoutSet.isPrivateLayout()) {
    if (group.isUser()) {
      friendlyURL=getPathFriendlyURLPrivateUser();
    }
 else {
      friendlyURL=getPathFriendlyURLPrivateGroup();
    }
  }
 else {
    friendlyURL=getPathFriendlyURLPublic();
  }
  return friendlyURL + group.getFriendlyURL();
}
