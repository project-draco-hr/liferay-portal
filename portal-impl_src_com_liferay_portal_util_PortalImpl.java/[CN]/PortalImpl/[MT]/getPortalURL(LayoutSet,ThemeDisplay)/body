{
  String serverName=themeDisplay.getServerName();
  String virtualHostname=layoutSet.getVirtualHostname();
  if (Validator.isNotNull(virtualHostname)) {
    String domain=themeDisplay.getPortalDomain();
    if (domain.startsWith(virtualHostname)) {
      serverName=virtualHostname;
    }
  }
  return getPortalURL(serverName,themeDisplay.getServerPort(),themeDisplay.isSecure());
}
