{
  boolean secure=request.isSecure();
  if (PropsValues.WEB_SERVER_FORWARD_PROTO_ENABLED) {
    secure=false;
    String forwardedProto=request.getHeader(PropsValues.WEB_SERVER_FORWARD_PROTO_HEADER);
    if (Validator.equals(Http.HTTPS,forwardedProto)) {
      secure=true;
    }
  }
  return secure;
}
