{
  HttpServletRequest httpServletRequest=(HttpServletRequest)portletRequest.getAttribute(PortletServlet.PORTLET_SERVLET_REQUEST);
  if (httpServletRequest != null) {
    return httpServletRequest;
  }
  if (portletRequest instanceof LiferayPortletRequest) {
    LiferayPortletRequest liferayPortletRequest=(LiferayPortletRequest)portletRequest;
    return liferayPortletRequest.getHttpServletRequest();
  }
  PortletRequestImpl portletRequestImpl=PortletRequestImpl.getPortletRequestImpl(portletRequest);
  return portletRequestImpl.getHttpServletRequest();
}
