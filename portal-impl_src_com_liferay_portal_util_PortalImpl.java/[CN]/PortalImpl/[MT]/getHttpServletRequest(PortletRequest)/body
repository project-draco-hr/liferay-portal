{
  if (portletRequest instanceof PortletRequestImpl) {
    PortletRequestImpl portletRequestImpl=(PortletRequestImpl)portletRequest;
    return portletRequestImpl.getHttpServletRequest();
  }
 else   if (portletRequest instanceof PortletRequestWrapper) {
    PortletRequestWrapper portletRequestWrapper=(PortletRequestWrapper)portletRequest;
    return getHttpServletRequest(portletRequestWrapper.getRequest());
  }
  throw new RuntimeException("Unable to get the HTTP servlet request from " + portletRequest.getClass().getName());
}
