{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  String portletBreadcrumbKey=WebKeys.PORTLET_BREADCRUMBS;
  if (Validator.isNotNull(portletDisplay.getId()) && !themeDisplay.isPortletDisplayFocused()) {
    portletBreadcrumbKey=WebKeys.PORTLET_BREADCRUMBS + StringPool.UNDERLINE + portletDisplay.getId();
  }
  List<BreadcrumbEntry> breadcrumbEntries=(List<BreadcrumbEntry>)request.getAttribute(portletBreadcrumbKey);
  if (breadcrumbEntries == null) {
    breadcrumbEntries=new ArrayList<BreadcrumbEntry>();
    request.setAttribute(portletBreadcrumbKey,breadcrumbEntries);
  }
  BreadcrumbEntry breadcrumbEntry=new BreadcrumbEntry();
  breadcrumbEntry.setData(data);
  breadcrumbEntry.setTitle(title);
  breadcrumbEntry.setURL(url);
  breadcrumbEntries.add(breadcrumbEntry);
}
