{
  long scopeGroupId=groupId;
  try {
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    if (group.isLayout()) {
      Layout scopeLayout=LayoutLocalServiceUtil.getLayout(group.getClassPK());
      groupId=scopeLayout.getGroupId();
    }
  }
 catch (  Exception e) {
  }
  long plid=LayoutConstants.DEFAULT_PLID;
  List<Layout> layouts=LayoutLocalServiceUtil.getLayouts(groupId,privateLayout,LayoutConstants.TYPE_PORTLET);
  for (  Layout layout : layouts) {
    LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
    if (layoutTypePortlet.hasPortletId(portletId)) {
      if (getScopeGroupId(layout,portletId) == scopeGroupId) {
        plid=layout.getPlid();
        break;
      }
    }
  }
  return plid;
}
