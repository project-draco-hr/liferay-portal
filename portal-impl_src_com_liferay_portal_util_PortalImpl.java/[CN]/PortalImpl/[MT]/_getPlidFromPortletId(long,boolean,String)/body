{
  long scopeGroupId=groupId;
  try {
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    if (group.isLayout()) {
      Layout scopeLayout=LayoutLocalServiceUtil.getLayout(group.getClassPK());
      groupId=scopeLayout.getGroupId();
    }
  }
 catch (  Exception e) {
  }
  long plid=LayoutConstants.DEFAULT_PLID;
  try {
    List<Layout> layouts=LayoutLocalServiceUtil.getLayouts(groupId,privateLayout,LayoutConstants.TYPE_PORTLET);
    for (    Layout layout : layouts) {
      LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
      if (layoutTypePortlet.hasPortletId(portletId)) {
        if (getScopeGroupId(layout,portletId) == scopeGroupId) {
          plid=layout.getPlid();
          break;
        }
      }
    }
  }
 catch (  SystemException se) {
    if (_log.isWarnEnabled()) {
      _log.warn(se.getMessage());
    }
  }
  return plid;
}
