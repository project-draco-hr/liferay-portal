{
  PortletApp portletApp=portlet.getPortletApp();
  if (portletApp.isWARFile()) {
    PortletBag portletBag=PortletBagPool.get(portlet.getRootPortletId());
    return portletBag.getPreferencesValidatorInstance();
  }
 else {
    PreferencesValidator preferencesValidator=null;
    if (Validator.isNotNull(portlet.getPreferencesValidator())) {
      preferencesValidator=(PreferencesValidator)InstancePool.get(portlet.getPreferencesValidator());
    }
    return preferencesValidator;
  }
}
