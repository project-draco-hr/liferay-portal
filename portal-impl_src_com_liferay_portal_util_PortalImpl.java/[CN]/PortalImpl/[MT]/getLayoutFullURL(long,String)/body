{
  long plid=getPlidFromPortletId(groupId,portletId);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    return null;
  }
  StringBundler sb=new StringBundler(4);
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  if (group.isLayout()) {
    long parentGroupId=group.getParentGroupId();
    if (parentGroupId > 0) {
      group=GroupLocalServiceUtil.getGroup(parentGroupId);
    }
  }
  String virtualHostname=null;
  LayoutSet layoutSet=layout.getLayoutSet();
  if (Validator.isNotNull(layoutSet.getVirtualHostname())) {
    virtualHostname=layoutSet.getVirtualHostname();
  }
 else {
    Company company=CompanyLocalServiceUtil.getCompany(layout.getCompanyId());
    virtualHostname=company.getVirtualHostname();
  }
  String portalURL=getPortalURL(virtualHostname,getPortalPort(),false);
  sb.append(portalURL);
  if (layout.isPrivateLayout()) {
    if (group.isUser()) {
      sb.append(PortalUtil.getPathFriendlyURLPrivateUser());
    }
 else {
      sb.append(PortalUtil.getPathFriendlyURLPrivateGroup());
    }
  }
 else {
    sb.append(PortalUtil.getPathFriendlyURLPublic());
  }
  sb.append(group.getFriendlyURL());
  sb.append(layout.getFriendlyURL());
  return sb.toString();
}
