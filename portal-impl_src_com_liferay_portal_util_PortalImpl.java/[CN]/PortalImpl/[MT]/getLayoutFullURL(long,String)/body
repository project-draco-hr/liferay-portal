{
  long plid=getPlidFromPortletId(groupId,portletId);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    return null;
  }
  StringBundler sb=new StringBundler(4);
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  String virtualHost=null;
  LayoutSet layoutSet=layout.getLayoutSet();
  if (Validator.isNotNull(layoutSet.getVirtualHost())) {
    virtualHost=layoutSet.getVirtualHost();
  }
 else {
    Company company=CompanyLocalServiceUtil.getCompany(layout.getCompanyId());
    virtualHost=company.getVirtualHost();
  }
  String portalURL=getPortalURL(virtualHost,getPortalPort(),false);
  sb.append(portalURL);
  if (layout.isPrivateLayout()) {
    if (group.isUser()) {
      sb.append(PortalUtil.getPathFriendlyURLPrivateUser());
    }
 else {
      sb.append(PortalUtil.getPathFriendlyURLPrivateGroup());
    }
  }
 else {
    sb.append(PortalUtil.getPathFriendlyURLPublic());
  }
  sb.append(group.getFriendlyURL());
  sb.append(layout.getFriendlyURL());
  return sb.toString();
}
