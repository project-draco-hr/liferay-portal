{
  HttpSession session=request.getSession();
  Boolean httpsInitial=(Boolean)session.getAttribute(WebKeys.HTTPS_INITIAL);
  boolean secure=false;
  if ((PropsValues.COMPANY_SECURITY_AUTH_REQUIRES_HTTPS) && (!PropsValues.SESSION_ENABLE_PHISHING_PROTECTION) && (httpsInitial != null)&& (!httpsInitial.booleanValue())) {
    secure=false;
  }
 else {
    secure=request.isSecure();
  }
  return secure;
}
