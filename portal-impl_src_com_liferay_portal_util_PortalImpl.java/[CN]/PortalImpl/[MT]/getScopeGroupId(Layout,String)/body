{
  if (layout == null) {
    return 0;
  }
 else {
    if (Validator.isNotNull(portletId)) {
      try {
        PortletPreferences portletSetup=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
        String scopeType=GetterUtil.getString(portletSetup.getValue("lfr-scope-type",null));
        if (Validator.isNotNull(scopeType)) {
          if (scopeType.equals(GroupConstants.GLOBAL)) {
            Group globalGroup=GroupLocalServiceUtil.getCompanyGroup(layout.getScopeGroup().getCompanyId());
            return globalGroup.getGroupId();
          }
 else {
            String scopeLayoutUuid=GetterUtil.getString(portletSetup.getValue("lfr-scope-layout-uuid",null));
            Layout scopeLayout=LayoutLocalServiceUtil.getLayoutByUuidAndGroupId(scopeLayoutUuid,layout.getGroupId());
            return scopeLayout.getScopeGroup().getGroupId();
          }
        }
      }
 catch (      Exception e) {
      }
    }
    return layout.getGroupId();
  }
}
