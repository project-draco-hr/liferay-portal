{
  Layout layout=null;
  String curFriendlyURL=friendlyURL;
  String queryString=StringPool.BLANK;
  if (Validator.isNull(friendlyURL)) {
    layout=LayoutLocalServiceUtil.fetchFirstLayout(groupId,privateLayout,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID);
    if (layout == null) {
      throw new NoSuchLayoutException("{groupId=" + groupId + ", privateLayout="+ privateLayout+ "}");
    }
  }
 else {
    LayoutQueryStringComposite layoutQueryStringComposite=getPortletFriendlyURLMapperLayoutQueryStringComposite(groupId,privateLayout,friendlyURL,params,requestContext);
    layout=layoutQueryStringComposite.getLayout();
    curFriendlyURL=layoutQueryStringComposite.getFriendlyURL();
    queryString=layoutQueryStringComposite.getQueryString();
  }
  return new LayoutQueryStringComposite(layout,curFriendlyURL,queryString);
}
