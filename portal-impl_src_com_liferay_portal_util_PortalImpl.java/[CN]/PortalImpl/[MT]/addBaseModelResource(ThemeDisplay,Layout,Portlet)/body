{
  String rootPortletId=portlet.getRootPortletId();
  String baseModelResource=ResourceActionsUtil.getPortletBaseModelResource(rootPortletId);
  if (baseModelResource == null) {
    return;
  }
  String primaryKey=String.valueOf(layout.getGroupId());
  try {
    if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
      int count=ResourcePermissionLocalServiceUtil.getResourcePermissionsCount(themeDisplay.getCompanyId(),baseModelResource,ResourceConstants.SCOPE_INDIVIDUAL,primaryKey);
      if (count == 0) {
        throw new NoSuchResourceException();
      }
    }
 else     if (!portlet.isUndeployedPortlet()) {
      ResourceLocalServiceUtil.getResource(themeDisplay.getCompanyId(),baseModelResource,ResourceConstants.SCOPE_INDIVIDUAL,primaryKey);
    }
  }
 catch (  NoSuchResourceException nsre) {
    ResourceLocalServiceUtil.addResources(themeDisplay.getCompanyId(),layout.getGroupId(),0,baseModelResource,primaryKey,false,true,true);
  }
}
