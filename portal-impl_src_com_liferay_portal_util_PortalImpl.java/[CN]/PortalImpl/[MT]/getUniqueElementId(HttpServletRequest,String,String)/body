{
  String uniqueElementId=elementId;
  Set<String> uniqueElementIds=(Set<String>)request.getAttribute(WebKeys.UNIQUE_ELEMENT_IDS);
  if (uniqueElementIds == null) {
    uniqueElementIds=new HashSet<String>();
    request.setAttribute(WebKeys.UNIQUE_ELEMENT_IDS,uniqueElementIds);
  }
 else {
    int i=1;
    while (uniqueElementIds.contains(namespace.concat(uniqueElementId))) {
      if (Validator.isNull(elementId) || elementId.endsWith(StringPool.UNDERLINE)) {
        uniqueElementId=elementId.concat(String.valueOf(i));
      }
 else {
        uniqueElementId=elementId.concat(StringPool.UNDERLINE).concat(String.valueOf(i));
      }
      i++;
    }
  }
  uniqueElementIds.add(namespace.concat(uniqueElementId));
  return uniqueElementId;
}
