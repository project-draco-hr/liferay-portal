{
  long plid=LayoutConstants.DEFAULT_PLID;
  StringBundler sb=new StringBundler(5);
  sb.append(groupId);
  sb.append(StringPool.SPACE);
  sb.append(privateLayout);
  sb.append(StringPool.SPACE);
  sb.append(portletId);
  String key=sb.toString();
  Long plidObj=_plidToPortletIdMap.get(key);
  if (plidObj == null) {
    plid=doGetPlidFromPortletId(groupId,privateLayout,portletId);
    if (plid != LayoutConstants.DEFAULT_PLID) {
      _plidToPortletIdMap.put(key,plid);
    }
  }
 else {
    plid=plidObj.longValue();
    boolean validPlid=false;
    try {
      Layout layout=LayoutLocalServiceUtil.getLayout(plid);
      LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
      if (layoutTypePortlet.hasDefaultScopePortletId(groupId,portletId)) {
        validPlid=true;
      }
    }
 catch (    Exception e) {
    }
    if (!validPlid) {
      _plidToPortletIdMap.remove(key);
      plid=doGetPlidFromPortletId(groupId,privateLayout,portletId);
      if (plid != LayoutConstants.DEFAULT_PLID) {
        _plidToPortletIdMap.put(key,plid);
      }
    }
  }
  return plid;
}
