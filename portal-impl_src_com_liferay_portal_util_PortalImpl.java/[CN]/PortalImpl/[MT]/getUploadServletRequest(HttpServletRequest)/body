{
  HttpServletRequestWrapper requestWrapper=null;
  if (request instanceof HttpServletRequestWrapper) {
    requestWrapper=(HttpServletRequestWrapper)request;
  }
  UploadServletRequest uploadServletRequest=null;
  while (uploadServletRequest == null) {
    if (requestWrapper instanceof UploadServletRequest) {
      uploadServletRequest=(UploadServletRequest)requestWrapper;
    }
 else {
      HttpServletRequest parentRequest=(HttpServletRequest)requestWrapper.getRequest();
      if (!(parentRequest instanceof HttpServletRequestWrapper)) {
        if (ServerDetector.isWebLogic()) {
          parentRequest=new NonSerializableObjectRequestWrapper(parentRequest);
        }
        uploadServletRequest=new UploadServletRequestImpl(parentRequest);
        break;
      }
 else {
        requestWrapper=(HttpServletRequestWrapper)parentRequest;
      }
    }
  }
  return uploadServletRequest;
}
