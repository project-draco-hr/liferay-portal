{
  HttpServletRequestWrapper reqWrapper=null;
  if (req instanceof HttpServletRequestWrapper) {
    reqWrapper=(HttpServletRequestWrapper)req;
  }
  UploadServletRequest uploadReq=null;
  while (uploadReq == null) {
    if (reqWrapper instanceof UploadServletRequest) {
      uploadReq=(UploadServletRequest)reqWrapper;
    }
 else {
      HttpServletRequest httpReq=(HttpServletRequest)reqWrapper.getRequest();
      if (!(httpReq instanceof HttpServletRequestWrapper)) {
        uploadReq=new UploadServletRequestImpl(httpReq);
        break;
      }
 else {
        reqWrapper=(HttpServletRequestWrapper)httpReq;
      }
    }
  }
  return uploadReq;
}
