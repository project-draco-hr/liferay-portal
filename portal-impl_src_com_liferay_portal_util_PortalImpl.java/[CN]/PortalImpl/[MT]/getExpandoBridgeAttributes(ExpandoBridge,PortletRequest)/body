{
  Map<String,Serializable> attributes=new HashMap<String,Serializable>();
  List<String> names=new ArrayList<String>();
  Enumeration<String> enu=portletRequest.getParameterNames();
  while (enu.hasMoreElements()) {
    String param=enu.nextElement();
    if (param.indexOf("ExpandoAttributeName--") != -1) {
      String name=ParamUtil.getString(portletRequest,param);
      names.add(name);
    }
  }
  for (  String name : names) {
    int type=expandoBridge.getAttributeType(name);
    UnicodeProperties properties=expandoBridge.getAttributeProperties(name);
    String displayType=properties.getProperty(ExpandoColumnConstants.PROPERTY_DISPLAY_TYPE);
    Serializable value=getExpandoValue(portletRequest,"ExpandoAttribute--" + name + "--",type,displayType);
    attributes.put(name,value);
  }
  return attributes;
}
