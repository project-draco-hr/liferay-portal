{
  Map<String,String> variables=new HashMap<String,String>();
  variables.put("liferay:groupId",String.valueOf(layout.getGroupId()));
  variables.put("liferay:mainPath",mainPath);
  variables.put("liferay:plid",String.valueOf(layout.getPlid()));
  if (layout instanceof VirtualLayout) {
    variables.put("liferay:pvgid",String.valueOf(layout.getGroupId()));
  }
 else {
    variables.put("liferay:pvgid","0");
  }
  LayoutType layoutType=layout.getLayoutType();
  UnicodeProperties typeSettingsProperties=layoutType.getTypeSettingsProperties();
  variables.putAll(typeSettingsProperties);
  LayoutSettings layoutSettings=LayoutSettings.getInstance(layout);
  return layoutSettings.getURL(variables);
}
