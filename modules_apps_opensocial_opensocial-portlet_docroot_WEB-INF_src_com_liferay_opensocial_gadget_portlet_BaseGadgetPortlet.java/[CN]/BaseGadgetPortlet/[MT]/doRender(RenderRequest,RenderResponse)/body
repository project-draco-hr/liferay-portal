{
  checkExpando(renderRequest,renderResponse);
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),portletDisplay.getId());
  Gadget gadget=getGadget(renderRequest);
  if (gadget == null) {
    return;
  }
  GadgetSpec gadgetSpec=ShindigUtil.getGadgetSpec(gadget.getUrl());
  overrideConfiguration(gadgetSpec,portlet,portletDisplay);
  renderRequest.setAttribute(WebKeys.GADGET,gadget);
  String view=getView(renderRequest,gadgetSpec);
  renderRequest.setAttribute(WebKeys.VIEW,view);
}
