{
  List<Fact<?>> facts=_rulesContextBuilder.buildRulesContext(executionContext);
  RulesResourceRetriever rulesResourceRetriever=new RulesResourceRetriever(new StringResourceRetriever(kaleoCondition.getScript()));
  Query query=Query.createStandardQuery();
  Map<String,?> results=_rulesEngine.execute(rulesResourceRetriever,facts,query);
  String returnValue=(String)results.get(_RETURN_VALUE);
  Map<String,Serializable> resultsWorkflowContext=(Map<String,Serializable>)results.get(WorkflowContextUtil.WORKFLOW_CONTEXT_NAME);
  WorkflowContextUtil.mergeWorkflowContexts(executionContext,resultsWorkflowContext);
  if (returnValue != null) {
    return returnValue;
  }
  throw new IllegalStateException("Conditional did not return value for script " + kaleoCondition.getScript());
}
