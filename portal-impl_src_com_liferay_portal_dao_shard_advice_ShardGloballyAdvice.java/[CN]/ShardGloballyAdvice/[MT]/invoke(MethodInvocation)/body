{
  Object returnValue=null;
  _shardAdvice.setGlobalCall(new Object());
  try {
    if (_log.isInfoEnabled()) {
      _log.info("All shards invoked for " + methodInvocation.toString());
    }
    for (    String shardName : ShardUtil.getAvailableShardNames()) {
      ShardDataSourceTargetSource dataSourceTargetSource=_shardAdvice.getShardDataSourceTargetSource();
      dataSourceTargetSource.setDataSource(shardName);
      ShardSessionFactoryTargetSource shardSessionFactoryTargetSource=_shardAdvice.getShardSessionFactoryTargetSource();
      shardSessionFactoryTargetSource.setSessionFactory(shardName);
      Object value=methodInvocation.proceed();
      if (shardName.equals(ShardUtil.getDefaultShardName())) {
        returnValue=value;
      }
    }
  }
  finally {
    _shardAdvice.setGlobalCall(null);
  }
  return returnValue;
}
