{
  RatingsDataTransformer ratingsDataTransformer=_serviceTracker.getService();
  if (ratingsDataTransformer == null) {
    return;
  }
  Map<String,PortletRatingsDefinitionValues> portletRatingsDefinitionValuesMap=PortletRatingsDefinitionUtil.getPortletRatingsDefinitionValuesMap();
  for (  String className : portletRatingsDefinitionValuesMap.keySet()) {
    String propertyKey=getPropertyKey(className);
    RatingsType fromRatingsType=RatingsType.parse(oldPortletPreferences.getValue(propertyKey,StringPool.BLANK));
    if (fromRatingsType == null) {
      PortletRatingsDefinitionValues portletRatingsDefinitionValues=portletRatingsDefinitionValuesMap.get(className);
      fromRatingsType=portletRatingsDefinitionValues.getDefaultRatingsType();
    }
    RatingsType toRatingsType=RatingsType.parse(unicodeProperties.getProperty(propertyKey));
    _transformRatingsData("companyId",companyId,className,fromRatingsType,toRatingsType);
  }
}
