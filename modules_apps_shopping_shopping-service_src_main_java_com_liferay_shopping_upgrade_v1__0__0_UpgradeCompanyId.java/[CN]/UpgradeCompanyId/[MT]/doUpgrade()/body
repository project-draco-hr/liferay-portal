{
  super.doUpgrade();
  runSQL("alter table ShoppingOrderItem add companyId LONG");
  StringBundler sb=new StringBundler(6);
  sb.append("update ShoppingOrderItem set companyId = (select ");
  sb.append("max(ShoppingItem.companyId) from ShoppingItem where ");
  sb.append("SUBSTR(ShoppingOrderItem.itemId, 0, INSTR('|', ");
  sb.append("ShoppingOrderItem.itemId)) = ");
  sb.append("CAST_TEXT(ShoppingItem.itemId)) where ");
  sb.append("ShoppingOrderItem.itemId like '%|%' ");
  runSQL(sb.toString());
  sb=new StringBundler(5);
  sb.append("update ShoppingOrderItem set companyId = (select ");
  sb.append("max(ShoppingItem.companyId) from ShoppingItem where ");
  sb.append("ShoppingOrderItem.itemId = ");
  sb.append("CAST_TEXT(ShoppingItem.itemId)) where ");
  sb.append("ShoppingOrderItem.itemId not like '%|%' ");
  runSQL(sb.toString());
}
