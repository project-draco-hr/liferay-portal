{
  String authType=GetterUtil.getString(request.getAuthType());
  if (AccessControlUtil.getAccessControlContext() == null) {
    if (authType.equals(HttpServletRequest.BASIC_AUTH) || authType.equals(HttpServletRequest.DIGEST_AUTH)) {
      return;
    }
  }
 else {
    if (!authType.equals("PortalSessionAuthVerifier")) {
      return;
    }
  }
  if (PropsValues.AUTH_TOKEN_CHECK_ENABLED && PropsValues.JSON_SERVICE_AUTH_TOKEN_ENABLED) {
    if (!AuthSettingsUtil.isAccessAllowed(request,_hostsAllowed)) {
      AuthTokenUtil.check(request);
    }
  }
}
