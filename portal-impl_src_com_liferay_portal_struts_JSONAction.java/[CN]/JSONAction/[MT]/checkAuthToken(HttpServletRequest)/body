{
  String authType=GetterUtil.getString(request.getAuthType());
  if (AccessControlUtil.getAccessControlContext() == null) {
    if (authType.equals(HttpServletRequest.BASIC_AUTH) || authType.equals(HttpServletRequest.DIGEST_AUTH)) {
      return;
    }
  }
 else {
    if (!authType.equals(PortalSessionAuthVerifier.AUTH_TYPE)) {
      return;
    }
  }
  if (PropsValues.JSON_SERVICE_AUTH_TOKEN_ENABLED) {
    if (!SSOUtil.isAccessAllowed(request,_hostsAllowed)) {
      AuthTokenUtil.checkCSRFToken(request,getCSRFOrigin(request));
    }
  }
}
