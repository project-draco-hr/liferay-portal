{
  List<User> recipients=new UniqueList<User>();
  List<String> roleNames=new ArrayList<String>();
  Group group=groupLocalService.getGroup(groupId);
  if (group.isCommunity()) {
    roleNames.add(RoleConstants.COMMUNITY_ADMINISTRATOR);
    roleNames.add(RoleConstants.COMMUNITY_OWNER);
  }
  if (group.isCompany()) {
    roleNames.add(RoleConstants.ADMINISTRATOR);
  }
 else   if (group.isOrganization()) {
    roleNames.add(RoleConstants.ORGANIZATION_ADMINISTRATOR);
    roleNames.add(RoleConstants.ORGANIZATION_OWNER);
  }
  for (  String roleName : roleNames) {
    Role role=roleLocalService.getRole(companyId,roleName);
    List<UserGroupRole> userGroupRoles=userGroupRoleLocalService.getUserGroupRolesByGroupAndRole(groupId,role.getRoleId());
    for (    UserGroupRole userGroupRole : userGroupRoles) {
      recipients.add(userGroupRole.getUser());
    }
  }
  if (recipients.isEmpty()) {
    Role role=roleLocalService.getRole(companyId,RoleConstants.ADMINISTRATOR);
    recipients.addAll(userLocalService.getRoleUsers(role.getRoleId()));
  }
  return recipients;
}
