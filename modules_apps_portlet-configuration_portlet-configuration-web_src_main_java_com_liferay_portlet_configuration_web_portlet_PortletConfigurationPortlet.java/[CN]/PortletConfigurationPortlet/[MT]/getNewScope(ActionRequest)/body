{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  String[] scope=StringUtil.split(ParamUtil.getString(actionRequest,"scope"));
  String scopeType=scope[0];
  long scopeGroupId=0;
  String scopeName=null;
  if (Validator.isNull(scopeType)) {
    scopeGroupId=layout.getGroupId();
  }
 else   if (scopeType.equals("company")) {
    scopeGroupId=themeDisplay.getCompanyGroupId();
    scopeName=themeDisplay.translate("global");
  }
 else   if (scopeType.equals("layout")) {
    String scopeLayoutUuid=scope[1];
    Layout scopeLayout=_layoutLocalService.getLayoutByUuidAndGroupId(scopeLayoutUuid,layout.getGroupId(),layout.isPrivateLayout());
    if (!scopeLayout.hasScopeGroup()) {
      Map<Locale,String> nameMap=new HashMap<>();
      String name=String.valueOf(scopeLayout.getPlid());
      nameMap.put(LocaleUtil.getDefault(),name);
      _groupLocalService.addGroup(themeDisplay.getUserId(),GroupConstants.DEFAULT_PARENT_GROUP_ID,Layout.class.getName(),scopeLayout.getPlid(),GroupConstants.DEFAULT_LIVE_GROUP_ID,nameMap,null,0,true,GroupConstants.DEFAULT_MEMBERSHIP_RESTRICTION,null,false,true,null);
    }
    scopeGroupId=scopeLayout.getGroupId();
    scopeName=scopeLayout.getName(themeDisplay.getLocale());
  }
 else {
    throw new IllegalArgumentException("Scope type " + scopeType + " is invalid");
  }
  return new Tuple(scopeGroupId,scopeName);
}
