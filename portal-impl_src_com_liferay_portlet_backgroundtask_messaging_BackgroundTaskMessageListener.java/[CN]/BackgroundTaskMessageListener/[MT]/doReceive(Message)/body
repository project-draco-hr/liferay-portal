{
  long entryId=(Long)message.get("entryId");
  ServiceContext serviceContext=new ServiceContext();
  BTEntryLocalServiceUtil.updateEntry(entryId,null,BTEntryConstants.STATUS_IN_PROGRESS,serviceContext);
  try {
    ClassLoader classLoader=ClassLoaderUtil.getPortalClassLoader();
    BTEntry entry=BTEntryLocalServiceUtil.getBTEntry(entryId);
    String servletContextNames=entry.getServletContextNames();
    if (Validator.isNotNull(servletContextNames)) {
      classLoader=ClassLoaderUtil.getAggregatePluginsClassLoader(StringUtil.split(servletContextNames),false);
    }
    BackgroundTaskExecutor backgroundTaskExecutor=(BackgroundTaskExecutor)InstanceFactory.newInstance(classLoader,entry.getTaskExecutorClassName());
    backgroundTaskExecutor.execute(entry,classLoader);
    BTEntryLocalServiceUtil.updateEntry(entryId,null,BTEntryConstants.STATUS_SUCCESSFUL,serviceContext);
  }
 catch (  Exception e) {
    BTEntryLocalServiceUtil.updateEntry(entryId,null,BTEntryConstants.STATUS_FAILED,serviceContext);
  }
}
