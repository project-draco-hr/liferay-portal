{
  try {
    CalendarNotificationTemplate calendarNotificationTemplate=notificationTemplateContext.getCalendarNotificationTemplate();
    Calendar calendar=CalendarLocalServiceUtil.getCalendar(notificationTemplateContext.getCalendarId());
    User defaultSenderUser=NotificationUtil.getDefaultSenderUser(calendar);
    String fromAddress=NotificationUtil.getTemplatePropertyValue(calendarNotificationTemplate,CalendarNotificationTemplateConstants.PROPERTY_FROM_ADDRESS,defaultSenderUser.getEmailAddress());
    String fromName=NotificationUtil.getTemplatePropertyValue(calendarNotificationTemplate,CalendarNotificationTemplateConstants.PROPERTY_FROM_NAME,defaultSenderUser.getFullName());
    notificationTemplateContext.setFromAddress(fromAddress);
    notificationTemplateContext.setFromName(fromName);
    notificationTemplateContext.setToAddress(notificationRecipient.getEmailAddress());
    notificationTemplateContext.setToName(notificationRecipient.getName());
    String subject=NotificationTemplateRenderer.render(notificationTemplateContext,NotificationField.SUBJECT);
    String body=NotificationTemplateRenderer.render(notificationTemplateContext,NotificationField.BODY);
    sendNotification(notificationTemplateContext.getFromAddress(),notificationTemplateContext.getFromName(),notificationRecipient,subject,body);
  }
 catch (  Exception e) {
    throw new NotificationSenderException(e);
  }
}
