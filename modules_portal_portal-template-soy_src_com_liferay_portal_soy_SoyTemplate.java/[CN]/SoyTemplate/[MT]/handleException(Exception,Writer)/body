{
  if ((exception instanceof Exception)) {
    put("exception",exception.getMessage());
    if (templateResource instanceof StringTemplateResource) {
      StringTemplateResource stringTemplateResource=(StringTemplateResource)templateResource;
      put("script",stringTemplateResource.getContent());
    }
    try {
      processTemplate(errorTemplateResource,writer);
    }
 catch (    Exception e) {
      throw new TemplateException("Unable to process Soy template " + errorTemplateResource.getTemplateId(),e);
    }
  }
 else {
    throw new TemplateException("Unable to process Soy template " + templateResource.getTemplateId(),exception);
  }
}
