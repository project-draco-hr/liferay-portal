{
  ActionableDynamicQuery actionableDynamicQuery=new DLFileVersionActionableDynamicQuery(){
    @Override protected void performAction(    Object object) throws PortalException, SystemException {
      DLFileVersion dlFileVersion=(DLFileVersion)object;
      InputStream inputStream=DLFileEntryLocalServiceUtil.getFileAsStream(dlFileVersion.getUserId(),dlFileVersion.getFileEntryId(),dlFileVersion.getVersion(),false);
      String title=DLUtil.getTitleWithExtension(dlFileVersion.getTitle(),dlFileVersion.getExtension());
      String mimeType=MimeTypesUtil.getContentType(inputStream,title);
      if (mimeType.equals(originalMimeType)) {
        return;
      }
      dlFileVersion.setMimeType(mimeType);
      DLFileVersionLocalServiceUtil.updateDLFileVersion(dlFileVersion);
    }
  }
;
  actionableDynamicQuery.performActions();
}
