{
  String title=dlFileEntry.getTitle();
  String titleExtension=StringPool.BLANK;
  String titleWithoutExtension=dlFileEntry.getTitle();
  if (title.endsWith(StringPool.PERIOD.concat(dlFileEntry.getExtension()))) {
    titleExtension=dlFileEntry.getExtension();
    titleWithoutExtension=FileUtil.stripExtension(title);
  }
  for (int i=1; ; ) {
    String uniqueTitle=titleWithoutExtension + StringPool.UNDERLINE + String.valueOf(i);
    if (Validator.isNotNull(titleExtension)) {
      uniqueTitle=uniqueTitle.concat(StringPool.PERIOD.concat(titleExtension));
    }
    String uniqueFileName=DLUtil.getSanitizedFileName(uniqueTitle,dlFileEntry.getExtension());
    try {
      DLFileEntryLocalServiceUtil.validateFile(dlFileEntry.getGroupId(),dlFileEntry.getFolderId(),dlFileEntry.getFileEntryId(),uniqueFileName,uniqueTitle);
      renameTitle(dlFileEntry,uniqueTitle);
      return;
    }
 catch (    PortalException pe) {
      if (!(pe instanceof DuplicateFolderNameException) && !(pe instanceof DuplicateFileException)) {
        throw pe;
      }
      i++;
    }
  }
}
