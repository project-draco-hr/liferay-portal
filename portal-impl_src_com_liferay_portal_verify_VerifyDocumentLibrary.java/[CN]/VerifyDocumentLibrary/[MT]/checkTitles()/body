{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(DLFileEntry.class);
  Criterion criterion1=RestrictionsFactoryUtil.like("title","%/%");
  Criterion criterion2=RestrictionsFactoryUtil.like("title","%\\\\%");
  dynamicQuery.add(RestrictionsFactoryUtil.or(criterion1,criterion2));
  List<DLFileEntry> dlFileEntries=DLFileEntryLocalServiceUtil.dynamicQuery(dynamicQuery);
  for (  DLFileEntry dlFileEntry : dlFileEntries) {
    TrashEntry trashEntry=TrashEntryLocalServiceUtil.fetchEntry(dlFileEntry.getModelClassName(),dlFileEntry.getFileEntryId());
    if (trashEntry != null) {
      continue;
    }
    String title=dlFileEntry.getTitle();
    String newTitle=title.replace(StringPool.SLASH,StringPool.BLANK);
    newTitle=newTitle.replace(StringPool.BACK_SLASH,StringPool.UNDERLINE);
    dlFileEntry.setTitle(newTitle);
    DLFileEntryLocalServiceUtil.updateDLFileEntry(dlFileEntry);
    DLFileVersion dlFileVersion=dlFileEntry.getFileVersion();
    dlFileVersion.setTitle(newTitle);
    DLFileVersionLocalServiceUtil.updateDLFileVersion(dlFileVersion);
    if (_log.isDebugEnabled()) {
      _log.debug("Invalid document title " + title + "renamed to "+ newTitle);
    }
  }
}
