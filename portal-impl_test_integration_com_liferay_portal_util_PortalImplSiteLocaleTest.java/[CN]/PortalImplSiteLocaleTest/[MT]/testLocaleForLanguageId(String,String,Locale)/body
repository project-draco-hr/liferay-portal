{
  MockServletContext mockServletContext=new MockServletContext(){
  }
;
  mockServletContext.setContextPath(StringPool.BLANK);
  mockServletContext.setServletContextName(StringPool.BLANK);
  MockHttpServletRequest httpServletRequest=createHttpRequest(mockServletContext,i18nLanguageId,pathInfo);
  MockHttpServletResponse httpServletResponse=new MockHttpServletResponse();
  _i18nServlet.init(new MockServletConfig(mockServletContext));
  _i18nServlet.service(httpServletRequest,httpServletResponse);
  httpServletRequest.setCookies(httpServletResponse.getCookies());
  httpServletRequest.setAttribute(WebKeys.LAYOUT,_layout);
  Locale calculatedLocale=_portalImpl.getLocale(httpServletRequest,httpServletResponse,false);
  Assert.assertEquals(expectedLocale,calculatedLocale);
  return httpServletResponse;
}
