{
  MockServletContext mockServletContext=new MockServletContext(){
  }
;
  mockServletContext.setContextPath(StringPool.BLANK);
  mockServletContext.setServletContextName(StringPool.BLANK);
  MockHttpServletRequest mockHttpServletRequest=createHttpRequest(mockServletContext,i18nLanguageId,pathInfo);
  MockHttpServletResponse httpServletResponse=new MockHttpServletResponse();
  _i18nServlet.init(new MockServletConfig(mockServletContext));
  _i18nServlet.service(mockHttpServletRequest,httpServletResponse);
  mockHttpServletRequest.setAttribute(WebKeys.LAYOUT,_layout);
  mockHttpServletRequest.setCookies(httpServletResponse.getCookies());
  Locale actualLocale=_portalImpl.getLocale(mockHttpServletRequest,httpServletResponse,false);
  Assert.assertEquals(expectedLocale,actualLocale);
  return httpServletResponse;
}
