{
  URLConnection urlConnection=url.openConnection();
  String fileName=url.getFile();
  if (urlConnection instanceof JarURLConnection) {
    JarURLConnection jarURLConnection=(JarURLConnection)urlConnection;
    URL jarFileURL=jarURLConnection.getJarFileURL();
    fileName=jarFileURL.getFile();
  }
 else   if ("zip".equals(url.getProtocol())) {
    fileName=url.getFile();
    int index=fileName.indexOf('!');
    if (index > 0) {
      fileName=fileName.substring(0,index);
    }
  }
  return new File(fileName);
}
