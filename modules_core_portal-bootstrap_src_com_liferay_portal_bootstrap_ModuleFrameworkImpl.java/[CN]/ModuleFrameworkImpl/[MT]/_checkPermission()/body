{
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  if (permissionChecker == null) {
    throw new PrincipalException();
  }
  if (!permissionChecker.isOmniadmin()) {
    throw new PrincipalException.MustBeOmniadmin(permissionChecker);
  }
}
