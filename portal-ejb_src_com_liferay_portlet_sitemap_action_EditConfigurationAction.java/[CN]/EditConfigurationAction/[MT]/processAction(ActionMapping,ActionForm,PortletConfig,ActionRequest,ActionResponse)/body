{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  String rootLayoutId=ParamUtil.getString(req,"rootLayoutId");
  String displayDepth=ParamUtil.getString(req,"displayDepth");
  if (Validator.isNull(rootLayoutId)) {
    rootLayoutId=Layout.DEFAULT_PARENT_LAYOUT_ID;
  }
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactory.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("root-layout-id",rootLayoutId);
  prefs.setValue("display-depth",displayDepth);
  prefs.store();
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
