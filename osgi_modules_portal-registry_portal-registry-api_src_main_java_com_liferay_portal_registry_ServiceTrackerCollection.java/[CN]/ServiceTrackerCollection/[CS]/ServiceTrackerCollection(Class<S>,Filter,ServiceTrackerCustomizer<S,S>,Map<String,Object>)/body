{
  _clazz=clazz;
  _filter=filter;
  _properties=Collections.unmodifiableMap(properties);
  _cachedCollection=new CopyOnWriteArrayList<S>();
  if (filter != null) {
    filter=fixFilter(filter,_clazz);
    _serviceTracker=getRegistry().trackServices(filter,new DefaultServiceTrackerCustomizer(serviceTrackerCustomizer));
  }
 else {
    _serviceTracker=getRegistry().trackServices(clazz,new DefaultServiceTrackerCustomizer(serviceTrackerCustomizer));
  }
  _serviceTracker.open();
  _serviceRegistrations=new ConcurrentHashMap<S,ServiceRegistration<S>>();
}
