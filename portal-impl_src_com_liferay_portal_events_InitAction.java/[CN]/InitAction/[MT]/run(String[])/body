{
  StopWatch stopWatch=null;
  if (_PRINT_TIME) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  String userLanguage=SystemProperties.get("user.language");
  String userCountry=SystemProperties.get("user.country");
  String userVariant=SystemProperties.get("user.variant");
  LocaleUtil.setDefault(userLanguage,userCountry,userVariant);
  String userTimeZone=SystemProperties.get("user.timezone");
  TimeZoneUtil.setDefault(userTimeZone);
  try {
    PortalClassLoaderUtil.setClassLoader(Thread.currentThread().getContextClassLoader());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (GetterUtil.getBoolean(SystemProperties.get("log4j.configure.on.startup"),true)) {
    ClassLoader classLoader=getClass().getClassLoader();
    Log4JUtil.configureLog4J(classLoader.getResource("META-INF/portal-log4j.xml"));
    Log4JUtil.configureLog4J(classLoader.getResource("META-INF/portal-log4j-ext.xml"));
  }
  try {
    LogFactoryUtil.setLogFactory(new CommonsLogFactoryImpl());
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  SystemProperties.set(PropsUtil.RESOURCE_REPOSITORIES_ROOT,PropsUtil.get(PropsUtil.RESOURCE_REPOSITORIES_ROOT));
  BeanLocatorUtil.setBeanLocator(new BeanLocatorImpl());
  JavaProps.isJDK5();
  if ((GetterUtil.getBoolean(PropsUtil.get(PropsUtil.PORTAL_CONFIGURATION))) && (ServerDetector.isJBoss() || ServerDetector.isPramati() || ServerDetector.isWebLogic())) {
    PortalConfiguration portalConfig=new PortalConfiguration(Configuration.getConfiguration());
    Configuration.setConfiguration(portalConfig);
  }
  if (_PRINT_TIME) {
    System.out.println("InitAction takes " + stopWatch.getTime() + " ms");
  }
}
