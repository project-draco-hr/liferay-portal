{
  content=content.replaceAll("%28","(");
  content=content.replaceAll("%29",")");
  Pattern p=Pattern.compile("\"/c/portal/\\$link=\\((.*)\\)\"");
  Matcher m=p.matcher(content);
  StringBuffer portletURLSB=new StringBuffer();
  try {
    while (m.find()) {
      String rawPath[]=m.group(1).split("/");
      StringBuffer nodePathSB=new StringBuffer("/app:company_home");
      for (int i=0; i < rawPath.length; i++) {
        if (Validator.isNull(rawPath[i])) {
          continue;
        }
        nodePathSB.append("/cm:").append(rawPath[i]);
      }
      PortletURL portletURL=res.createRenderURL();
      portletURL.setParameter("nodePath",nodePathSB.toString());
      if (maximizeLinks) {
        portletURL.setWindowState(WindowState.MAXIMIZED);
      }
      m.appendReplacement(portletURLSB,"\"" + portletURL.toString() + "\"");
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  m.appendTail(portletURLSB);
  return portletURLSB.toString();
}
