{
  if (throwable instanceof InvocationTargetException) {
    throwable=throwable.getCause();
  }
  JSONObject jsonObject=createJSONObject();
  String throwableMessage=throwable.getMessage();
  if (Validator.isNull(throwableMessage)) {
    throwableMessage=throwable.toString();
  }
  jsonObject.put("exception",throwableMessage);
  jsonObject.put("throwable",throwable.toString());
  JSONObject error=createJSONObject();
  jsonObject.put("error",error);
  error.put("message",throwableMessage);
  error.put("type",ClassUtil.getClassName(throwable));
  Throwable rootCauseThrowable=throwable;
  while (rootCauseThrowable.getCause() != null) {
    rootCauseThrowable=rootCauseThrowable.getCause();
  }
  if (rootCauseThrowable != throwable) {
    JSONObject rootCause=createJSONObject();
    throwableMessage=rootCauseThrowable.getMessage();
    if (Validator.isNull(throwableMessage)) {
      throwableMessage=rootCauseThrowable.toString();
    }
    rootCause.put("message",throwableMessage);
    rootCause.put("type",ClassUtil.getClassName(rootCauseThrowable));
    jsonObject.put("rootCause",rootCause);
  }
  return jsonObject.toString();
}
