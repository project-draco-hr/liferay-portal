{
  String dateString=StringPool.NBSP;
  if (date == null) {
    return sb.append(dateString);
  }
  Date today=new Date();
  Calendar cal=Calendar.getInstance(_timeZone,_locale);
  cal.setTime(today);
  cal.add(Calendar.DATE,-1);
  Date yesterday=cal.getTime();
  Format dateFormatDate=FastDateFormatFactoryUtil.getDate(_locale,_timeZone);
  Format dateFormatDateTime=FastDateFormatFactoryUtil.getDateTime(_locale,_timeZone);
  Format dateFormatTime=FastDateFormatFactoryUtil.getTime(_locale,_timeZone);
  dateString=dateFormatDate.format(date);
  if (dateString.equals(dateFormatDate.format(today))) {
    dateString=_todayString + StringPool.SPACE + dateFormatTime.format(date);
  }
 else   if (dateString.equals(dateFormatDate.format(yesterday))) {
    dateString=_yesterdayString + StringPool.SPACE + dateFormatTime.format(date);
  }
 else {
    dateString=dateFormatDateTime.format(date);
  }
  return sb.append(dateString);
}
