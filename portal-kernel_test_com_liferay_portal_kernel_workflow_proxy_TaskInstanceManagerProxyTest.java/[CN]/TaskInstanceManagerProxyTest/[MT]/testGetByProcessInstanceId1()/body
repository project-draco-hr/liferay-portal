{
  final long testProcessInstanceId=101;
  MessageListener getListener=new MessageListener(){
    public void receive(    Message message){
      TaskInstanceRequest request=(TaskInstanceRequest)message.getPayload();
      assertNotNull(request);
      assertEquals(TaskInstanceRequestType.GET,request.getType());
      assertEquals(testProcessInstanceId,request.getProcessInstanceId());
      assertTrue(request.isGetAll());
      String responseDestination=message.getResponseDestination();
      if (responseDestination != null) {
        message.setPayload(new WorkflowResultContainer<List<TaskInstanceInfo>>(new ArrayList<TaskInstanceInfo>()));
        messageBus.sendMessage(responseDestination,message);
      }
    }
  }
;
  messageBus.registerMessageListener(DestinationNames.WORKFLOW_TASK,getListener);
  List<TaskInstanceInfo> instances=_proxy.getTaskInstanceInfosByProcessInstanceId(testProcessInstanceId);
  assertNotNull(instances);
  assertEquals(0,instances.size());
}
