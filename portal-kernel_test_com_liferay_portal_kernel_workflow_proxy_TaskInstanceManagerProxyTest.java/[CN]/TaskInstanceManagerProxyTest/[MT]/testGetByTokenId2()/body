{
  final long testTokenId=101;
  final boolean finished=true;
  MessageListener getListener=new MessageListener(){
    public void receive(    Message message){
      TaskInstanceRequest request=(TaskInstanceRequest)message.getPayload();
      assertNotNull(request);
      assertEquals(TaskInstanceRequestType.GET,request.getType());
      assertEquals(testTokenId,request.getTokenId());
      assertEquals(finished,request.isFinished());
      assertFalse(request.isGetAll());
      String responseDestination=message.getResponseDestination();
      if (responseDestination != null) {
        message.setPayload(new WorkflowResultContainer<List<TaskInstanceInfo>>(new ArrayList<TaskInstanceInfo>()));
        messageBus.sendMessage(responseDestination,message);
      }
    }
  }
;
  messageBus.registerMessageListener(DestinationNames.WORKFLOW_TASK,getListener);
  List<TaskInstanceInfo> instances=_proxy.getTaskInstanceInfosByTokenId(testTokenId,finished);
  assertNotNull(instances);
  assertEquals(0,instances.size());
}
