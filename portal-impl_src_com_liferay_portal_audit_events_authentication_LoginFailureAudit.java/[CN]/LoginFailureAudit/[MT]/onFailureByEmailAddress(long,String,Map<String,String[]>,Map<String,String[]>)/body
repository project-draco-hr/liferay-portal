{
  try {
    User user=UserLocalServiceUtil.getUserByEmailAddress(companyId,emailAddress);
    long userId=user.getUserId();
    String userName=PortalUtil.getUserName(userId,StringPool.BLANK);
    AuditMessageSenderUtil.send(LoginFailureAuditMessageBuilder.build(companyId,userId,userName,headerMap,LoginFailureAuditMessageBuilder.REASON_EMAIL));
  }
 catch (  Exception e) {
    throw new AuthException(e);
  }
}
