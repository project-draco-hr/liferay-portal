{
  Map<String,Fields> ddmFieldsMap=new HashMap<String,Fields>();
  for (  String key : fieldsMap.keySet()) {
    Fields ddmFields=createDDMFields(metadata,fieldsMap.get(key));
    if (ddmFields.getNames().size() > 0) {
      ddmFieldsMap.put(key,ddmFields);
    }
  }
  return ddmFieldsMap;
}
