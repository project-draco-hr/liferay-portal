{
  if (metadata == null) {
    metadata=new Metadata();
  }
  ParseContext context=new ParseContext();
  context.set(Parser.class,_parser);
  ContentHandler contentHandler=new WriteOutContentHandler(new DummyWriter());
  try {
    _parser.parse(inputStream,contentHandler,metadata,context);
  }
 catch (  Exception e) {
    _log.error("Failed parsing",e);
    throw new IOException(e.getMessage());
  }
  metadata.remove(XMPDM.ABS_PEAK_AUDIO_FILE_PATH.getName());
  metadata.remove(XMPDM.RELATIVE_PEAK_AUDIO_FILE_PATH.getName());
  return metadata;
}
