{
  Metadata metadata=super.extractMetadata(extension,mimeType,file);
  boolean forkProcess=false;
  if (PropsValues.TEXT_EXTRACTION_FORK_PROCESS_ENABLED) {
    if (ArrayUtil.contains(PropsValues.TEXT_EXTRACTION_FORK_PROCESS_MIME_TYPES,mimeType)) {
      forkProcess=true;
    }
  }
  if (forkProcess) {
    ExtractMetadataProcessCallable extractMetadataProcessCallable=new ExtractMetadataProcessCallable(file,metadata,_parser);
    try {
      Future<Metadata> future=ProcessExecutor.execute(ClassPathUtil.getPortalClassPath(),extractMetadataProcessCallable);
      return future.get();
    }
 catch (    Exception e) {
      throw new SystemException(e);
    }
  }
  InputStream inputStream=null;
  try {
    inputStream=new FileInputStream(file);
    return extractMetadata(inputStream,metadata,_parser);
  }
 catch (  IOException ioe) {
    throw new SystemException(ioe);
  }
 finally {
    StreamUtil.cleanUp(inputStream);
  }
}
