{
  ThemeDisplay themeDisplay=(ThemeDisplay)_request.getAttribute(WebKeys.THEME_DISPLAY);
  SearchContainer<Group> searchContainer=getSearchContainer();
  GroupSearchTerms searchTerms=(GroupSearchTerms)searchContainer.getSearchTerms();
  long parentGroupId=getParentGroupId();
  Company company=themeDisplay.getCompany();
  if (!searchTerms.hasSearchTerms() && isFilterManageableGroups() && (parentGroupId <= 0)) {
    return ListUtil.subList(getAllGroups(),searchContainer.getStart(),searchContainer.getEnd());
  }
 else   if (searchTerms.hasSearchTerms()) {
    return GroupLocalServiceUtil.search(company.getCompanyId(),_classNameIds,searchTerms.getKeywords(),getGroupParams(themeDisplay,searchTerms,parentGroupId),searchContainer.getStart(),searchContainer.getEnd(),searchContainer.getOrderByComparator());
  }
 else {
    return GroupLocalServiceUtil.search(company.getCompanyId(),_classNameIds,getGroupId(),searchTerms.getKeywords(),getGroupParams(themeDisplay,searchTerms,parentGroupId),searchContainer.getStart(),searchContainer.getEnd(),searchContainer.getOrderByComparator());
  }
}
