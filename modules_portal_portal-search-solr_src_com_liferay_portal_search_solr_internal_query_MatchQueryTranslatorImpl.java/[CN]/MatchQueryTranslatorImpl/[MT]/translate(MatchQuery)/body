{
  MatchQuery.Type type=matchQuery.getType();
  if ((type == null) || (type == MatchQuery.Type.BOOLEAN)) {
    QueryParser queryParser=new QueryParser(matchQuery.getField(),new KeywordAnalyzer());
    try {
      return queryParser.parse(matchQuery.getValue());
    }
 catch (    ParseException pe) {
      throw new IllegalArgumentException(pe);
    }
  }
  Term term=new Term(matchQuery.getField(),matchQuery.getValue());
  org.apache.lucene.search.Query query=null;
  if (type == MatchQuery.Type.PHRASE) {
    PhraseQuery phraseQuery=new PhraseQuery();
    phraseQuery.add(term);
    if (matchQuery.getSlop() != null) {
      phraseQuery.setSlop(matchQuery.getSlop());
    }
    query=phraseQuery;
  }
 else   if (type == MatchQuery.Type.PHRASE_PREFIX) {
    query=new PrefixQuery(term);
  }
 else {
    query=new TermQuery(term);
  }
  if (!matchQuery.isDefaultBoost()) {
    query.setBoost(matchQuery.getBoost());
  }
  return query;
}
