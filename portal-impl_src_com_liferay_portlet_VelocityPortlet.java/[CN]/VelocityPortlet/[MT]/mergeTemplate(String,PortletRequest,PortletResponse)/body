{
  TemplateResource templateResource=TemplateResourceLoaderUtil.getTemplateResource(TemplateManager.VELOCITY,templateId);
  if (templateResource == null) {
    throw new Exception("Unable to load template resource " + templateId);
  }
  Template template=TemplateManagerUtil.getTemplate(TemplateManager.VELOCITY,templateResource,TemplateContextType.STANDARD);
  prepareTemplate(template,portletRequest,portletResponse);
  mergeTemplate(templateId,template,portletRequest,portletResponse);
}
