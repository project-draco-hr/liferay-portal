{
  String oldPortalPreferences=portalPreferences.getValue(Staging.class.getName(),"ATTRIBUTE_MAP");
  try {
    JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
    JSONArray oldJsonArray=JSONFactoryUtil.createJSONArray(oldPortalPreferences);
    String recentLayoutRevisionIdKey=getRecentLayoutRevisionIdKey(layoutSetBranchId,plid);
    for (int i=0; i < oldJsonArray.length(); i++) {
      JSONObject jsonObject=oldJsonArray.getJSONObject(i);
      if (Validator.isNotNull(jsonObject.getString(recentLayoutRevisionIdKey))) {
        continue;
      }
      jsonArray.put(jsonObject);
    }
    portalPreferences.setValue(Staging.class.getName(),"ATTRIBUTE_MAP",jsonArray.toString());
  }
 catch (  JSONException je) {
    if (_log.isWarnEnabled()) {
      _log.warn("Staging preferences are not in JSON format. " + "Unable to set recent layout branch ID",je);
    }
  }
}
