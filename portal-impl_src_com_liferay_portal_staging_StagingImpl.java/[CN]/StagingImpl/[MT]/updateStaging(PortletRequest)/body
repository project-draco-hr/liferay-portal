{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  long liveGroupId=ParamUtil.getLong(portletRequest,"liveGroupId");
  if (!GroupPermissionUtil.contains(permissionChecker,liveGroupId,ActionKeys.MANAGE_STAGING)) {
    throw new PrincipalException();
  }
  int stagingType=ParamUtil.getInteger(portletRequest,"stagingType");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(portletRequest);
  if (stagingType == StagingConstants.TYPE_NOT_STAGED) {
    disableStaging(portletRequest,liveGroupId);
  }
 else   if (stagingType == StagingConstants.TYPE_LOCAL_STAGING) {
    enableLocalStaging(portletRequest,liveGroupId,serviceContext);
  }
 else   if (stagingType == StagingConstants.TYPE_REMOTE_STAGING) {
    enableRemoteStaging(portletRequest,liveGroupId,serviceContext);
  }
}
