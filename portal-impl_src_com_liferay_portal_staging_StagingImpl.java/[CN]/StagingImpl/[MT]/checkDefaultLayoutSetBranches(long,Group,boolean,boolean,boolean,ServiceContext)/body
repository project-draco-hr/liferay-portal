{
  long targetGroupId=0;
  if (remote) {
    targetGroupId=liveGroup.getGroupId();
  }
 else {
    Group stagingGroup=liveGroup.getStagingGroup();
    if (stagingGroup == null) {
      return;
    }
    targetGroupId=stagingGroup.getGroupId();
  }
  if (branchingPublic) {
    Locale locale=LocaleUtil.getDefault();
    String description=LanguageUtil.format(locale,LayoutSetBranchConstants.MASTER_BRANCH_DESCRIPTION_PUBLIC,liveGroup.getDescriptiveName());
    try {
      LayoutSetBranch layoutSetBranch=LayoutSetBranchLocalServiceUtil.addLayoutSetBranch(userId,targetGroupId,false,LayoutSetBranchConstants.MASTER_BRANCH_NAME,description,true,LayoutSetBranchConstants.ALL_BRANCHES,serviceContext);
      List<LayoutRevision> layoutRevisions=LayoutRevisionLocalServiceUtil.getLayoutRevisions(layoutSetBranch.getLayoutSetBranchId(),false);
      for (      LayoutRevision layoutRevision : layoutRevisions) {
        LayoutRevisionLocalServiceUtil.updateStatus(userId,layoutRevision.getLayoutRevisionId(),WorkflowConstants.STATUS_APPROVED,serviceContext);
      }
    }
 catch (    LayoutSetBranchNameException lsbne) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to create master branch for public layouts",lsbne);
      }
    }
  }
  if (branchingPrivate) {
    Locale locale=LocaleUtil.getDefault();
    String description=LanguageUtil.format(locale,LayoutSetBranchConstants.MASTER_BRANCH_DESCRIPTION_PRIVATE,liveGroup.getDescriptiveName());
    try {
      LayoutSetBranch layoutSetBranch=LayoutSetBranchLocalServiceUtil.addLayoutSetBranch(userId,targetGroupId,true,LayoutSetBranchConstants.MASTER_BRANCH_NAME,description,true,LayoutSetBranchConstants.ALL_BRANCHES,serviceContext);
      List<LayoutRevision> layoutRevisions=LayoutRevisionLocalServiceUtil.getLayoutRevisions(layoutSetBranch.getLayoutSetBranchId(),false);
      for (      LayoutRevision layoutRevision : layoutRevisions) {
        LayoutRevisionLocalServiceUtil.updateStatus(userId,layoutRevision.getLayoutRevisionId(),WorkflowConstants.STATUS_APPROVED,serviceContext);
      }
    }
 catch (    LayoutSetBranchNameException lsbne) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to create master branch for private layouts",lsbne);
      }
    }
  }
}
