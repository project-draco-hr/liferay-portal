{
  String className=properties.getProperty(EhcacheConstants.CACHE_EVENT_LISTENER_FACTORY_CLASS_NAME);
  if (Validator.isNull(className)) {
    return null;
  }
  try {
    CacheEventListenerFactory cacheEventListenerFactory=(CacheEventListenerFactory)InstanceFactory.newInstance(ClassLoaderUtil.getPortalClassLoader(),className);
    CacheEventListener cacheEventListener=cacheEventListenerFactory.createCacheEventListener(properties);
    if (cacheEventListener instanceof CacheReplicator) {
      return (CacheListener<K,V>)new EhcacheCacheReplicatorAdapter<K,Serializable>(cacheEventListener);
    }
    return new EhcacheCacheListenerAdapter<>(cacheEventListener);
  }
 catch (  Exception e) {
    _log.error("Unable to instantiate cache event listener factory " + className,e);
    return null;
  }
}
