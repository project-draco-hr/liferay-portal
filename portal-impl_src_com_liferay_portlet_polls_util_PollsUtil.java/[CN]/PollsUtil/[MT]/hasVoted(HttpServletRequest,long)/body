{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (themeDisplay.isSignedIn()) {
    try {
      PollsVoteLocalServiceUtil.getVote(questionId,themeDisplay.getUserId());
    }
 catch (    NoSuchVoteException nsve) {
      return false;
    }
    return true;
  }
 else {
    HttpSession session=request.getSession();
    Boolean hasVoted=(Boolean)session.getAttribute(PollsQuestion.class.getName() + "." + questionId);
    if ((hasVoted != null) && (hasVoted.booleanValue())) {
      return true;
    }
 else {
      return false;
    }
  }
}
