{
  ServiceTrackerMap<String,TrackedOne> mapServiceTracker=ServiceTrackerMapFactory.createObjectServiceTrackerMap(TrackedOne.class,"(target=*)",new ServiceTrackerMapFactory.PropertyServiceReferenceMapper("target"),new Comparator<ServiceReference<TrackedOne>>(){
    @Override public int compare(    ServiceReference<TrackedOne> o1,    ServiceReference<TrackedOne> o2){
      return -1;
    }
  }
);
  mapServiceTracker.open();
  TrackedOne TrackedOne1=new TrackedOne();
  ServiceRegistration<TrackedOne> sr1=registerDefaultTrackedOne(TrackedOne1);
  TrackedOne TrackedOne2=new TrackedOne();
  ServiceRegistration<TrackedOne> sr2=registerDefaultTrackedOne(TrackedOne2);
  Assert.assertEquals(TrackedOne2,mapServiceTracker.getService("aTarget"));
  sr1.unregister();
  sr2.unregister();
  registerDefaultTrackedOne(TrackedOne2);
  registerDefaultTrackedOne(TrackedOne1);
  Assert.assertEquals(TrackedOne1,mapServiceTracker.getService("aTarget"));
}
