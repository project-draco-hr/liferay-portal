{
  String redirect=ParamUtil.getString(actionRequest,"redirect");
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  boolean privateLayout=ParamUtil.getBoolean(actionRequest,"privateLayout");
  Layout layout=null;
  List<Layout> layouts=LayoutLocalServiceUtil.getLayouts(groupId,privateLayout,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,false,0,1);
  if (layouts.size() > 0) {
    layout=layouts.get(0);
  }
 else {
    long parentLayoutId=LayoutConstants.DEFAULT_PARENT_LAYOUT_ID;
    String name="New Page";
    String title=StringPool.BLANK;
    String description=StringPool.BLANK;
    String type=LayoutConstants.TYPE_PORTLET;
    boolean hidden=false;
    String friendlyURL=StringPool.BLANK;
    boolean locked=false;
    ServiceContext serviceContext=ServiceContextFactory.getInstance(Layout.class.getName(),actionRequest);
    layout=LayoutServiceUtil.addLayout(groupId,privateLayout,parentLayoutId,name,title,description,type,hidden,friendlyURL,locked,serviceContext);
  }
  if (layout != null) {
    String tabs1="public-pages";
    if (privateLayout) {
      tabs1="private-pages";
    }
    HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
    PortletURL portletURL=new PortletURLImpl(request,PortletKeys.LAYOUTS_ADMIN,layout.getPlid(),PortletRequest.RENDER_PHASE);
    portletURL.setWindowState(WindowState.MAXIMIZED);
    portletURL.setPortletMode(PortletMode.VIEW);
    portletURL.setParameter("struts_action","/layouts_admin/edit_layouts");
    portletURL.setParameter("tabs1",tabs1);
    portletURL.setParameter("redirect",redirect);
    portletURL.setParameter("groupId",String.valueOf(groupId));
    actionResponse.sendRedirect(portletURL.toString());
  }
}
