{
  Field field=getDeclaredField("COMPANY_SECURITY_STRANGERS_WITH_MX");
  Object value=field.get(null);
  String name=PrincipalThreadLocal.getName();
  try {
    field.set(null,Boolean.FALSE);
    User user=addUserWithoutPermissions();
    PrincipalThreadLocal.setName(user.getUserId());
    updateUser(user);
    Assert.fail();
  }
 catch (  ReservedUserEmailAddressException rueae) {
  }
 finally {
    field.set(null,value);
    PrincipalThreadLocal.setName(name);
  }
}
