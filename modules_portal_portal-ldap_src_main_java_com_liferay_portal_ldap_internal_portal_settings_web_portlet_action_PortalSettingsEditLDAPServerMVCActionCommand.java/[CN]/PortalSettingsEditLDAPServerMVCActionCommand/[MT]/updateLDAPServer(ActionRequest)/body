{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long ldapServerId=ParamUtil.getLong(actionRequest,"ldapServerId");
  UnicodeProperties properties=PropertiesParamUtil.getProperties(actionRequest,"settings--");
  validateLDAPServerName(ldapServerId,themeDisplay.getCompanyId(),properties);
  validateSearchFilters(actionRequest);
  if (ldapServerId <= 0) {
    properties=addLDAPServer(themeDisplay.getCompanyId(),properties);
  }
  _companyService.updatePreferences(themeDisplay.getCompanyId(),properties);
}
