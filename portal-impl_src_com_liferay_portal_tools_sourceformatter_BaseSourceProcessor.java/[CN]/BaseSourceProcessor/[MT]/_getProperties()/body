{
  String fileName="source-formatter.properties";
  Properties properties=new Properties();
  if (portalSource) {
    ClassLoader classLoader=BaseSourceProcessor.class.getClassLoader();
    properties.load(classLoader.getResourceAsStream("com/liferay/portal/tools/dependencies/" + fileName));
    return properties;
  }
  List<Properties> propertiesList=new ArrayList<Properties>();
  for (int i=0; i <= 2; i++) {
    try {
      InputStream inputStream=new FileInputStream(fileName);
      Properties props=new Properties();
      props.load(inputStream);
      propertiesList.add(stripTopLevelDirectories(props,i));
    }
 catch (    FileNotFoundException fnfe) {
    }
    fileName="../" + fileName;
  }
  if (propertiesList.isEmpty()) {
    return properties;
  }
  properties=propertiesList.get(0);
  if (propertiesList.size() == 1) {
    return properties;
  }
  for (int i=1; i < propertiesList.size(); i++) {
    Properties props=propertiesList.get(i);
    Enumeration<String> enu=(Enumeration<String>)props.propertyNames();
    while (enu.hasMoreElements()) {
      String key=enu.nextElement();
      String value=props.getProperty(key);
      if (Validator.isNull(value)) {
        continue;
      }
      if (properties.containsKey(key)) {
        String existingValue=properties.getProperty(key);
        if (Validator.isNotNull(existingValue)) {
          value=existingValue + StringPool.COMMA + value;
        }
      }
      properties.put(key,value);
    }
  }
  return properties;
}
