{
  String basedir="./";
  String portalPortalProperties=null;
  if (_portalSource) {
    File portalPortalPropertiesFile=new File(basedir + "portal-impl/src/portal.properties");
    portalPortalProperties=_fileUtil.read(portalPortalPropertiesFile);
  }
 else {
    portalPortalProperties=ContentUtil.get("portal.properties");
  }
  DirectoryScanner directoryScanner=new DirectoryScanner();
  directoryScanner.setBasedir(basedir);
  String[] excludes=_excludes;
  if (_portalSource) {
    excludes=ArrayUtil.append(excludes,new String[]{"**\\classes\\**","**\\bin\\**"});
    directoryScanner.setIncludes(new String[]{"**\\portal-ext.properties","**\\portal-legacy-*.properties"});
  }
 else {
    directoryScanner.setIncludes(new String[]{"**\\portal.properties","**\\portal-ext.properties"});
  }
  directoryScanner.setExcludes(excludes);
  List<String> fileNames=_sourceFormatterHelper.scanForFiles(directoryScanner);
  for (  String fileName : fileNames) {
    File file=new File(basedir + fileName);
    fileName=StringUtil.replace(fileName,StringPool.BACK_SLASH,StringPool.SLASH);
    String content=_fileUtil.read(file);
    _formatPortalProperties(fileName,content,portalPortalProperties);
  }
}
