{
  if (LockManagerUtil.isLocked(MBThread.class.getName(),threadId)) {
    StringBundler sb=new StringBundler(5);
    sb.append("Thread is locked for {className=");
    sb.append(MBThread.class.getName());
    sb.append(", threadId=");
    sb.append(threadId);
    sb.append(StringPool.CLOSE_CURLY_BRACE);
    throw new LockedThreadException(sb.toString());
  }
  MBThread thread=mbThreadLocalService.getThread(threadId);
  MBCategoryPermission.check(getPermissionChecker(),thread.getGroupId(),thread.getCategoryId(),ActionKeys.MOVE_THREAD);
  MBCategoryPermission.check(getPermissionChecker(),thread.getGroupId(),categoryId,ActionKeys.MOVE_THREAD);
  return mbThreadLocalService.moveThread(thread.getGroupId(),categoryId,threadId);
}
