{
  if (lockLocalService.isLocked(MBThread.class.getName(),threadId)) {
    throw new ThreadLockedException();
  }
  List<MBMessage> messages=mbMessagePersistence.findByThreadId(threadId);
  for (  MBMessage message : messages) {
    MBMessagePermission.check(getPermissionChecker(),message.getMessageId(),ActionKeys.DELETE);
  }
  mbThreadLocalService.deleteThread(threadId);
}
