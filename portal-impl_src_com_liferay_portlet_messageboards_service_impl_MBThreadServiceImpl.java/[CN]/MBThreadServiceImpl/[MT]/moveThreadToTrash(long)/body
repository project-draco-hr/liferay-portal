{
  if (LockManagerUtil.isLocked(MBThread.class.getName(),threadId)) {
    StringBundler sb=new StringBundler(4);
    sb.append("Thread is locked for class name ");
    sb.append(MBThread.class.getName());
    sb.append(" and class PK ");
    sb.append(threadId);
    throw new LockedThreadException(sb.toString());
  }
  List<MBMessage> messages=mbMessagePersistence.findByThreadId(threadId);
  for (  MBMessage message : messages) {
    MBMessagePermission.check(getPermissionChecker(),message.getMessageId(),ActionKeys.DELETE);
  }
  return mbThreadLocalService.moveThreadToTrash(getUserId(),threadId);
}
