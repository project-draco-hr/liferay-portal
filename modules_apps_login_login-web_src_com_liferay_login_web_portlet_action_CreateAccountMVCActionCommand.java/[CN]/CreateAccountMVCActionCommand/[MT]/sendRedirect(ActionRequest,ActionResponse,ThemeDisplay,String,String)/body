{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
  String redirect=PortalUtil.escapeRedirect(ParamUtil.getString(actionRequest,"redirect"));
  if (Validator.isNotNull(redirect)) {
    HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
    AuthenticatedSessionManagerUtil.login(request,response,login,password,false,null);
  }
 else {
    PortletURL loginURL=LoginUtil.getLoginURL(request,themeDisplay.getPlid());
    loginURL.setParameter("login",login);
    redirect=loginURL.toString();
  }
  actionResponse.sendRedirect(redirect);
}
