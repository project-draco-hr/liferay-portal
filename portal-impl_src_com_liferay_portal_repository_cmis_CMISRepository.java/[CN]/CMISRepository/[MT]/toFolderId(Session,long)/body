{
  RepositoryEntry repositoryEntry=RepositoryEntryUtil.fetchByPrimaryKey(folderId);
  if (repositoryEntry != null) {
    return repositoryEntry.getMappedId();
  }
  DLFolder dlFolder=DLFolderUtil.fetchByPrimaryKey(folderId);
  if (dlFolder == null) {
    throw new NoSuchFolderException("No CMIS folder with {folderId=" + folderId + "}");
  }
 else   if (!dlFolder.isMountPoint()) {
    throw new RepositoryException("CMIS repository should not be used with {folderId=" + folderId + "}");
  }
  RepositoryInfo repositoryInfo=session.getRepositoryInfo();
  String rootFolderId=repositoryInfo.getRootFolderId();
  repositoryEntry=RepositoryEntryUtil.fetchByR_M(getRepositoryId(),rootFolderId);
  if (repositoryEntry == null) {
    repositoryEntry=RepositoryEntryLocalServiceUtil.addRepositoryEntry(dlFolder.getUserId(),getGroupId(),getRepositoryId(),rootFolderId,new ServiceContext());
  }
  return repositoryEntry.getMappedId();
}
