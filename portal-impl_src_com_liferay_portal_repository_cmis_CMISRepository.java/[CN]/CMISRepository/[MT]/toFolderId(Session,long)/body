{
  RepositoryEntry repositoryEntry=RepositoryEntryUtil.fetchByPrimaryKey(folderId);
  if (repositoryEntry != null) {
    return repositoryEntry.getMappedId();
  }
  DLFolder dlFolder=DLFolderUtil.fetchByPrimaryKey(folderId);
  if (dlFolder == null) {
    throw new NoSuchFolderException("No CMIS folder with {folderId=" + folderId + "}");
  }
 else   if (!dlFolder.isMountPoint()) {
    throw new RepositoryException("CMIS repository should not be used with {folderId=" + folderId + "}");
  }
  RepositoryInfo repositoryInfo=session.getRepositoryInfo();
  String rootFolderId=repositoryInfo.getRootFolderId();
  repositoryEntry=RepositoryEntryUtil.fetchByR_M(getRepositoryId(),rootFolderId);
  if (repositoryEntry == null) {
    long repositoryEntryId=counterLocalService.increment();
    repositoryEntry=RepositoryEntryUtil.create(repositoryEntryId);
    repositoryEntry.setGroupId(getGroupId());
    repositoryEntry.setRepositoryId(getRepositoryId());
    repositoryEntry.setMappedId(rootFolderId);
    RepositoryEntryUtil.update(repositoryEntry,false);
  }
  return repositoryEntry.getMappedId();
}
