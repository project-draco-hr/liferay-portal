{
  String parameterKey=CMISAtomPubRepository.REPOSITORY_ID;
  if (isWebServices()) {
    parameterKey=CMISWebServicesRepository.REPOSITORY_ID;
  }
  if (!typeSettingsProperties.containsKey(parameterKey)) {
    org.apache.chemistry.opencmis.client.api.Repository cmisRepository=_sessionFactory.getRepositories(parameters).get(0);
    typeSettingsProperties.setProperty(parameterKey,cmisRepository.getId());
    try {
      Repository repository=RepositoryUtil.findByPrimaryKey(getRepositoryId());
      repository.setTypeSettingsProperties(typeSettingsProperties);
      RepositoryUtil.update(repository,false);
    }
 catch (    Exception e) {
      throw new RepositoryException(e);
    }
  }
  putParameter(parameters,SessionParameter.REPOSITORY_ID,parameterKey);
}
