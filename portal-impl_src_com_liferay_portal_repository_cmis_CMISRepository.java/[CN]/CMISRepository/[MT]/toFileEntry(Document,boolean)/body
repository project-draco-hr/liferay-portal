{
  RepositoryEntry repositoryEntry=null;
  if (isDocumentRetrievableByVersionSeriesId()) {
    repositoryEntry=getRepositoryEntry(document.getVersionSeriesId());
  }
 else {
    repositoryEntry=getRepositoryEntry(document.getId());
  }
  long fileEntryId=repositoryEntry.getRepositoryEntryId();
  String uuid=repositoryEntry.getUuid();
  FileEntry fileEntry=new CMISFileEntry(this,uuid,fileEntryId,document);
  FileVersion fileVersion=null;
  try {
    fileVersion=fileEntry.getFileVersion();
  }
 catch (  Exception e) {
    if (strict) {
      if (e instanceof CmisObjectNotFoundException) {
        throw new NoSuchFileVersionException("No CMIS file version with CMIS file entry {objectId=" + document.getId() + "}",e);
      }
 else       if (e instanceof SystemException) {
        throw (SystemException)e;
      }
 else {
        processException(e);
        throw new RepositoryException(e);
      }
    }
 else {
      _log.error("Unable to update asset",e);
    }
  }
  dlAppHelperLocalService.checkAssetEntry(PrincipalThreadLocal.getUserId(),fileEntry,fileVersion);
  return fileEntry;
}
