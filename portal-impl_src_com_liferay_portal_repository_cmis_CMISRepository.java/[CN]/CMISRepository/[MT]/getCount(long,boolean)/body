{
  try {
    Session session=getSession();
    ObjectId objectId=toFolderId(session,folderId);
    StringBundler sb=new StringBundler(5);
    sb.append("SELECT cmis:objectId FROM ");
    if (fileEntries) {
      sb.append("cmis:document ");
    }
 else {
      sb.append("cmis:folder ");
    }
    sb.append("WHERE IN_FOLDER('");
    sb.append(objectId.getId());
    sb.append("')");
    ItemIterable<QueryResult> results=session.query(sb.toString(),false);
    int count=(int)results.getTotalNumItems();
    if (count < 0) {
      count=0;
      Iterator<QueryResult> iterator=results.iterator();
      while (iterator.hasNext()) {
        iterator.next();
        count++;
      }
    }
    return count;
  }
 catch (  SystemException se) {
    throw se;
  }
catch (  Exception e) {
    throw new RepositoryException(e);
  }
}
