{
  long userId=portletDataContext.getUserId(organization.getUserUuid());
  Map<Long,Long> organizationIds=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(Organization.class);
  long parentOrganizationId=MapUtil.getLong(organizationIds,organization.getParentOrganizationId(),organization.getParentOrganizationId());
  ServiceContext serviceContext=portletDataContext.createServiceContext(organization);
  serviceContext.setUserId(userId);
  Organization existingOrganization=_organizationLocalService.fetchOrganizationByUuidAndCompanyId(organization.getUuid(),portletDataContext.getGroupId());
  if (existingOrganization == null) {
    existingOrganization=_organizationLocalService.fetchOrganization(portletDataContext.getCompanyId(),organization.getName());
  }
  Organization importedOrganization=null;
  if (existingOrganization == null) {
    serviceContext.setUuid(organization.getUuid());
    importedOrganization=_organizationLocalService.addOrganization(userId,parentOrganizationId,organization.getName(),organization.getType(),organization.getRegionId(),organization.getCountryId(),organization.getStatusId(),organization.getComments(),false,serviceContext);
  }
 else {
    importedOrganization=_organizationLocalService.updateOrganization(portletDataContext.getCompanyId(),existingOrganization.getOrganizationId(),parentOrganizationId,organization.getName(),organization.getType(),organization.getRegionId(),organization.getCountryId(),organization.getStatusId(),organization.getComments(),true,null,false,serviceContext);
  }
  importAddresses(portletDataContext,organization,importedOrganization);
  importEmailAddresses(portletDataContext,organization,importedOrganization);
  importOrgLabors(portletDataContext,organization,importedOrganization);
  importPasswordPolicyRel(portletDataContext,organization,importedOrganization);
  importPhones(portletDataContext,organization,importedOrganization);
  importWebsites(portletDataContext,organization,importedOrganization);
  portletDataContext.importClassedModel(organization,importedOrganization);
}
