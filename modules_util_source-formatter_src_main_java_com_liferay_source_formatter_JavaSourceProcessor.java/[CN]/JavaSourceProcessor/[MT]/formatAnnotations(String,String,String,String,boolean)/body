{
  UnsyncBufferedReader unsyncBufferedReader=new UnsyncBufferedReader(new UnsyncStringReader(content));
  String line=null;
  String annotation=StringPool.BLANK;
  String previousAnnotation=StringPool.BLANK;
  while ((line=unsyncBufferedReader.readLine()) != null) {
    if (line.equals(indent + StringPool.CLOSE_CURLY_BRACE)) {
      return content;
    }
    int tabCount=StringUtil.count(line,CharPool.TAB);
    if ((tabCount < indent.length()) && Validator.isNull(annotation)) {
      continue;
    }
    if ((tabCount < indent.length()) || ((tabCount == indent.length()) && !line.startsWith(indent + StringPool.CLOSE_PARENTHESIS))) {
      if (Validator.isNotNull(annotation) && annotation.contains(StringPool.OPEN_PARENTHESIS)) {
        Matcher matcher=_annotationPattern.matcher(annotation);
        if (matcher.find()) {
          String match=matcher.group();
          if ((getLevel(match) == 0) && !match.endsWith("\n)\n") && !match.endsWith("\t)\n")) {
            String tabs=matcher.group(1);
            String replacement=StringUtil.replaceLast(match,")","\n" + tabs + ")");
            return StringUtil.replace(content,match,replacement);
          }
        }
        String newContent=checkAnnotationParameterProperties(content,annotation);
        newContent=checkAnnotationMetaTypeProperties(newContent,annotation);
        newContent=checkAnnotationLineBreaks(newContent,annotation);
        if (!newContent.equals(content)) {
          return formatAnnotations(fileName,javaTermName,newContent,indent,sortAnnotations);
        }
        String newAnnotation=formatAnnotations(fileName,javaTermName,annotation,indent + "\t\t",false);
        if (!newAnnotation.equals(annotation)) {
          return StringUtil.replace(content,annotation,newAnnotation);
        }
        checkAnnotationParameters(fileName,javaTermName,annotation);
      }
      if (sortAnnotations && Validator.isNotNull(previousAnnotation) && (previousAnnotation.compareToIgnoreCase(annotation) > 0)) {
        content=StringUtil.replaceFirst(content,previousAnnotation,annotation);
        content=StringUtil.replaceLast(content,annotation,previousAnnotation);
        return formatAnnotations(fileName,javaTermName,content,indent,sortAnnotations);
      }
      if (line.startsWith(indent + StringPool.AT)) {
        if (Validator.isNotNull(annotation)) {
          previousAnnotation=annotation;
        }
        annotation=line + "\n";
      }
 else {
        annotation=StringPool.BLANK;
        previousAnnotation=StringPool.BLANK;
      }
    }
 else {
      if (Validator.isNull(annotation)) {
        return content;
      }
      annotation+=line + "\n";
    }
  }
  return content;
}
