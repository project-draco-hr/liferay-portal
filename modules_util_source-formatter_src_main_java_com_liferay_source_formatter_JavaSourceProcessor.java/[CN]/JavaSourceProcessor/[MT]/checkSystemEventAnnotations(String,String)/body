{
  if (!portalSource || !fileName.endsWith("PortletDataHandler.java")) {
    return;
  }
  int pos=content.indexOf("setDeletionSystemEventStagedModelTypes");
  if (pos == -1) {
    return;
  }
  String deletionSystemEventStagedModelTypes=content.substring(pos,content.indexOf(");",pos));
  Matcher matcher=_stagedModelTypesPattern.matcher(deletionSystemEventStagedModelTypes);
  while (matcher.find()) {
    String stagedModelTypeClassName=matcher.group(1);
    pos=stagedModelTypeClassName.indexOf(".class");
    if (pos == -1) {
      pos=stagedModelTypeClassName.indexOf("Constants");
    }
    if (pos == -1) {
      return;
    }
    String className=stagedModelTypeClassName.substring(0,pos);
    Pattern packageNamePattern=Pattern.compile("import (com\\.liferay\\.[a-zA-Z\\.]*)\\.model\\." + className + ";");
    Matcher packageNameMatcher=packageNamePattern.matcher(content);
    if (!packageNameMatcher.find()) {
      return;
    }
    StringBundler sb=new StringBundler(5);
    sb.append(fileName.substring(0,fileName.indexOf("/src/") + 5));
    sb.append(StringUtil.replace(packageNameMatcher.group(1),StringPool.PERIOD,StringPool.SLASH));
    sb.append("/service/impl/");
    sb.append(className);
    sb.append("LocalServiceImpl.java");
    String localServiceImplFileName=sb.toString();
    String localServiceImplContent=FileUtil.read(new File(localServiceImplFileName));
    if (localServiceImplContent == null) {
      return;
    }
    if (!localServiceImplContent.contains("@SystemEvent")) {
      processErrorMessage(fileName,"Missing deletion system event: " + localServiceImplFileName);
    }
  }
}
