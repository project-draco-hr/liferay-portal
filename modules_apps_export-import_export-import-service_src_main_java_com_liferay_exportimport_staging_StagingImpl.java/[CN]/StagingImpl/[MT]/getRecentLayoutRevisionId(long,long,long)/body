{
  RecentLayoutRevision recentLayoutRevision=_recentLayoutRevisionLocalService.fetchRecentLayoutRevision(userId,layoutSetBranchId,plid);
  if (recentLayoutRevision != null) {
    return recentLayoutRevision.getLayoutRevisionId();
  }
  long layoutBranchId=getRecentLayoutBranchId(userId,layoutSetBranchId,plid);
  if (layoutBranchId > 0) {
    try {
      _layoutBranchLocalService.getLayoutBranch(layoutBranchId);
    }
 catch (    NoSuchLayoutBranchException nslbe) {
      LayoutBranch layoutBranch=_layoutBranchLocalService.getMasterLayoutBranch(layoutSetBranchId,plid);
      layoutBranchId=layoutBranch.getLayoutBranchId();
    }
  }
 else {
    try {
      LayoutBranch layoutBranch=_layoutBranchLocalService.getMasterLayoutBranch(layoutSetBranchId,plid);
      layoutBranchId=layoutBranch.getLayoutBranchId();
    }
 catch (    NoSuchLayoutBranchException nslbe) {
      return 0;
    }
  }
  if (layoutBranchId > 0) {
    try {
      LayoutRevision layoutRevision=_layoutRevisionLocalService.getLayoutRevision(layoutSetBranchId,layoutBranchId,plid);
      if (layoutRevision != null) {
        return layoutRevision.getLayoutRevisionId();
      }
    }
 catch (    NoSuchLayoutRevisionException nslre) {
    }
  }
  return 0;
}
