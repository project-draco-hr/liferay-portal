{
  Template template=null;
  VelocityContext velocityContext=getVelocityContext(helperUtilities);
  if (templateContextType.equals(TemplateContextType.RESTRICTED)) {
    template=new RestrictedTemplate(new VelocityTemplate(templateResource,errorTemplateResource,velocityContext,_velocityEngine,_templateContextHelper),_templateContextHelper.getRestrictedVariables());
  }
 else   if (templateContextType.equals(TemplateContextType.STANDARD)) {
    template=new VelocityTemplate(templateResource,errorTemplateResource,velocityContext,_velocityEngine,_templateContextHelper);
  }
  return template;
}
