{
  String text=null;
  try {
    Tika tika=new Tika();
    if (PropsValues.TIKA_EXTRACT_FORK_PROCESS_ENABLED) {
      String mimeType=tika.detect(is);
      if (ArrayUtil.contains(PropsValues.TIKA_EXTRACT_FORK_PROCESS_MIME_TYPES,mimeType)) {
        return ProcessExecutor.synchronizeExecute(new TikaExtractTextProcessCallable(getBytes(is)),ClassPathUtil.getPortalClassPath());
      }
    }
    text=tika.parseToString(is);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  if (_log.isInfoEnabled()) {
    if (text == null) {
      _log.info("Text extraction failed for " + fileName);
    }
 else {
      _log.info("Text was extracted for " + fileName);
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Extractor returned text:\n\n" + text);
  }
  if (text == null) {
    text=StringPool.BLANK;
  }
  return text;
}
