{
  String text=null;
  try {
    fileExt=GetterUtil.getString(fileExt).toLowerCase();
    TextExtractor extractor=null;
    String contentType=null;
    String encoding=System.getProperty("encoding");
    if (fileExt.equals(".doc")) {
      extractor=new MsWordTextExtractor();
      contentType="application/vnd.ms-word";
    }
 else     if (fileExt.equals(".htm") || fileExt.equals(".html")) {
      extractor=new JerichoHTMLTextExtractor();
      contentType="text/html";
    }
 else     if (fileExt.equals(".odb") || fileExt.equals(".odf") || fileExt.equals(".odg")|| fileExt.equals(".odp")|| fileExt.equals(".ods")|| fileExt.equals(".odt")) {
      extractor=new OpenOfficeTextExtractor();
      contentType="application/vnd.oasis.opendocument.";
      if (fileExt.equals(".odb")) {
        contentType+="database";
      }
 else       if (fileExt.equals(".odf")) {
        contentType+="formula";
      }
 else       if (fileExt.equals(".odg")) {
        contentType+="graphics";
      }
 else       if (fileExt.equals(".odp")) {
        contentType+="presentation";
      }
 else       if (fileExt.equals(".ods")) {
        contentType+="spreadsheet";
      }
 else       if (fileExt.equals(".odt")) {
        contentType+="text";
      }
    }
 else     if (fileExt.equals(".pdf")) {
      extractor=new PdfTextExtractor();
      contentType="application/pdf";
    }
 else     if (fileExt.equals(".ppt")) {
      extractor=new MsPowerPointTextExtractor();
      contentType="application/vnd.ms-powerpoint";
    }
 else     if (fileExt.equals(".rtf")) {
      extractor=new RTFTextExtractor();
      contentType="application/rtf";
    }
 else     if (fileExt.equals(".txt")) {
      extractor=new PlainTextExtractor();
      contentType="text/plain";
    }
 else     if (fileExt.equals(".xls")) {
      extractor=new MsExcelTextExtractor();
      contentType="application/vnd.ms-excel";
    }
 else     if (fileExt.equals(".xml")) {
      extractor=new XMLTextExtractor();
      contentType="text/xml";
    }
    if (extractor != null) {
      if (_log.isInfoEnabled()) {
        _log.info("Using extractor " + extractor.getClass().getName() + " for extension "+ fileExt);
      }
      StringBuilder sb=new StringBuilder();
      UnsyncBufferedReader reader=new UnsyncBufferedReader(extractor.extractText(is,contentType,encoding));
      int i;
      while ((i=reader.read()) != -1) {
        sb.append((char)i);
      }
      reader.close();
      text=sb.toString();
    }
 else {
      if (_log.isInfoEnabled()) {
        _log.info("No extractor found for extension " + fileExt);
      }
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Extractor returned text:\n\n" + text);
  }
  if (text == null) {
    text=StringPool.BLANK;
  }
  return text;
}
