{
  String text=null;
  try {
    if (!is.markSupported()) {
      is=new BufferedInputStream(is);
    }
    String contentType=MimeTypesUtil.getContentType(is,fileExt);
    Class extractorClass=_textExtractorMap.get(contentType);
    if (extractorClass != null) {
      TextExtractor extractor=(TextExtractor)extractorClass.newInstance();
      if (_log.isInfoEnabled()) {
        _log.info("Using extractor " + extractor.getClass().getName());
      }
      StringBuilder sb=new StringBuilder();
      UnsyncBufferedReader unsyncBufferedReader=new UnsyncBufferedReader(extractor.extractText(is,contentType,null));
      int i;
      while ((i=unsyncBufferedReader.read()) != -1) {
        sb.append((char)i);
      }
      unsyncBufferedReader.close();
      text=sb.toString();
    }
 else {
      if (_log.isInfoEnabled()) {
        _log.info("No extractor found");
      }
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Extractor returned text:\n\n" + text);
  }
  if (text == null) {
    text=StringPool.BLANK;
  }
  return text;
}
