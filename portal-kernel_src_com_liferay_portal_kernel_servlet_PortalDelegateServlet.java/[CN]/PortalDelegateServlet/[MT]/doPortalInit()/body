{
  ServletContext servletContext=servletConfig.getServletContext();
  ClassLoader classLoader=(ClassLoader)servletContext.getAttribute(PluginContextListener.PLUGIN_CLASS_LOADER);
  String servletClass=servletConfig.getInitParameter("servlet-class");
  _subcontext=servletConfig.getInitParameter("sub-context");
  if (_subcontext == null) {
    _subcontext=getServletName();
  }
  servlet=(Servlet)InstanceFactory.newInstance(classLoader,servletClass);
  if (!(servlet instanceof HttpServlet)) {
    throw new IllegalArgumentException("servlet-class is not an instance of " + HttpServlet.class.getName());
  }
  servlet.init(servletConfig);
  PortalDelegatorServlet.addDelegate(_subcontext,(HttpServlet)servlet);
}
