{
  Layout layout=(Layout)request.getAttribute(WebKeys.LAYOUT);
  List<LayoutTypePortlet> layoutTypePortlets=getLayoutTypePortlets(layout);
  for (  LayoutTypePortlet layoutTypePortlet : layoutTypePortlets) {
    List<Portlet> portlets=null;
    try {
      portlets=layoutTypePortlet.getAllPortlets();
    }
 catch (    Exception e) {
      throw new PortletContainerException(e);
    }
    layout=layoutTypePortlet.getLayout();
    for (    Portlet portlet : portlets) {
      for (      Event event : events) {
        javax.xml.namespace.QName qName=event.getQName();
        String namespaceURI=qName.getNamespaceURI();
        String localPart=qName.getLocalPart();
        QName processingQName=portlet.getProcessingEvent(namespaceURI,localPart);
        if (processingQName != null) {
          processEvent(request,response,portlet,layout,event);
        }
 else {
          PortletApp portletApp=portlet.getPortletApp();
          Set<EventDefinition> eventDefinitions=portletApp.getEventDefinitions();
          for (          EventDefinition eventDefinition : eventDefinitions) {
            QName aliasQName=eventDefinition.getAliasQName(namespaceURI,localPart);
            if (aliasQName == null) {
              continue;
            }
            QName eventQName=eventDefinition.getQName();
            processingQName=portlet.getProcessingEvent(eventQName.getNamespaceURI(),eventQName.getLocalPart());
            if (processingQName == null) {
              continue;
            }
            LiferayEvent liferayEvent=(LiferayEvent)event;
            Event aliasedEvent=liferayEvent.clone(qName);
            processEvent(request,response,portlet,layout,aliasedEvent);
          }
        }
      }
    }
  }
}
