{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  boolean onlyShowListed=ParamUtil.getBoolean(req,"showListed");
  int scope=ParamUtil.getInteger(req,"scope");
  String targetPortletId=ParamUtil.getString(req,"targetPortletId");
  String type=ParamUtil.getString(req,"type");
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("show-listed",String.valueOf(onlyShowListed));
  prefs.setValue("scope",String.valueOf(scope));
  prefs.setValue("target-portlet-id",targetPortletId);
  prefs.setValue("type",type);
  prefs.store();
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
