{
  JournalFolder folder=null;
  if (folderId > JournalFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    folder=doUpdateFolder(userId,folderId,parentFolderId,name,description,ddmStructureIds,overrideDDMStructures,mergeWithParentFolder,serviceContext);
  }
  List<ObjectValuePair<Long,String>> workflowDefinitionOVPs=new ArrayList<ObjectValuePair<Long,String>>();
  for (  long ddmStructureId : ddmStructureIds) {
    String workflowDefinition=StringPool.BLANK;
    if (overrideDDMStructures || (folderId == JournalFolderConstants.DEFAULT_PARENT_FOLDER_ID)) {
      workflowDefinition=ParamUtil.getString(serviceContext,"workflowDefinition" + ddmStructureId);
    }
    workflowDefinitionOVPs.add(new ObjectValuePair<Long,String>(ddmStructureId,workflowDefinition));
  }
  workflowDefinitionLinkLocalService.updateWorkflowDefinitionLinks(serviceContext.getUserId(),serviceContext.getCompanyId(),serviceContext.getScopeGroupId(),JournalFolder.class.getName(),folderId,workflowDefinitionOVPs);
  return folder;
}
