{
  User user=userPersistence.findByPrimaryKey(serviceContext.getUserId());
  MDRRuleGroupInstance ruleGroupInstance=mdrRuleGroupInstancePersistence.findByPrimaryKey(ruleGroupInstanceId);
  long actionId=counterLocalService.increment();
  MDRAction action=mdrActionLocalService.createMDRAction(actionId);
  action.setUuid(serviceContext.getUuid());
  action.setGroupId(ruleGroupInstance.getGroupId());
  action.setCompanyId(serviceContext.getCompanyId());
  action.setUserId(serviceContext.getUserId());
  action.setUserName(user.getFullName());
  action.setClassNameId(ruleGroupInstance.getClassNameId());
  action.setClassPK(ruleGroupInstance.getClassPK());
  action.setRuleGroupInstanceId(ruleGroupInstanceId);
  action.setNameMap(nameMap);
  action.setDescriptionMap(descriptionMap);
  action.setType(type);
  action.setTypeSettings(typeSettings);
  action=updateMDRAction(action);
  ruleGroupInstance.setModifiedDate(new Date());
  mdrRuleGroupInstancePersistence.update(ruleGroupInstance);
  return action;
}
