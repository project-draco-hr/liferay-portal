{
  String targetPath=null;
  if (request.getDispatcherType() == DispatcherType.INCLUDE) {
    targetPath=(String)request.getAttribute(RequestDispatcher.INCLUDE_SERVLET_PATH);
    String pathInfo=(String)request.getAttribute(RequestDispatcher.INCLUDE_PATH_INFO);
    if (pathInfo != null) {
      targetPath=targetPath + pathInfo;
    }
  }
 else {
    targetPath=request.getPathInfo();
  }
  if (targetPath == null) {
    return true;
  }
  if (targetPath.indexOf('/') != 0) {
    targetPath='/' + targetPath;
  }
  if (targetPath.startsWith("/META-INF/") || targetPath.startsWith("/OSGI-INF/") || targetPath.startsWith("/OSGI-OPT/")|| targetPath.startsWith("/WEB-INF/")) {
    try {
      ServletContext servletContext=request.getServletContext();
      servletContext.log("[WAB ERROR] Attempt to load illegal path " + targetPath + " in "+ toString());
      response.sendError(HttpServletResponse.SC_FORBIDDEN,targetPath);
    }
 catch (    IOException ioe) {
      response.setStatus(HttpServletResponse.SC_FORBIDDEN);
    }
    return false;
  }
  return true;
}
