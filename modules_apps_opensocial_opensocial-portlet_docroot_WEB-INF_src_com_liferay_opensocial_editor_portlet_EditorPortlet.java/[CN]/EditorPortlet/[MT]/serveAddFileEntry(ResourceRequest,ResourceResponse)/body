{
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long folderId=ParamUtil.getLong(resourceRequest,"folderId");
  Folder folder=DLAppServiceUtil.getFolder(folderId);
  String fileEntryTitle=ParamUtil.getString(resourceRequest,"fileEntryTitle");
  String content=ParamUtil.getString(resourceRequest,"content");
  byte[] bytes=content.getBytes(StringPool.UTF8);
  ServiceContext serviceContext=ServiceContextFactory.getInstance(resourceRequest);
  serviceContext.setAddGroupPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  serviceContext.setAttribute("sourceFileName",fileEntryTitle);
  serviceContext.setScopeGroupId(folder.getGroupId());
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  FileEntry fileEntry=DLAppServiceUtil.addFileEntry(folder.getRepositoryId(),folderId,fileEntryTitle,resourceRequest.getContentType(),fileEntryTitle,StringPool.BLANK,StringPool.BLANK,bytes,serviceContext);
  jsonObject.put("fileEntryId",fileEntry.getFileEntryId());
  String portalURL=PortalUtil.getPortalURL(themeDisplay);
  String fileEntryURL=ShindigUtil.getFileEntryURL(portalURL,fileEntry.getFileEntryId());
  jsonObject.put("fileEntryURL",fileEntryURL);
  writeJSON(resourceRequest,resourceResponse,jsonObject);
}
