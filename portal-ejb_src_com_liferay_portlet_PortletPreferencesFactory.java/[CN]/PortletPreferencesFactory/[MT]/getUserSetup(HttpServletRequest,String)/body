{
  String layoutId=PortletKeys.PREFS_LAYOUT_ID_SHARED;
  String companyId=PortalUtil.getCompanyId(req);
  String userId=PortalUtil.getUserId(req);
  if (userId == null) {
    userId=UserImpl.getDefaultUserId(companyId);
  }
  String ownerId=PortletKeys.PREFS_OWNER_ID_USER + StringPool.PERIOD + userId;
  PortletPreferencesPK pk=new PortletPreferencesPK(portletId,layoutId,ownerId);
  return PortletPreferencesLocalServiceUtil.getPreferences(companyId,pk);
}
