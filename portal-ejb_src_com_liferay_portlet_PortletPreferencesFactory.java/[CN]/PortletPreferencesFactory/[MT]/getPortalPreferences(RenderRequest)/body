{
  RenderRequestImpl reqImpl=null;
  if (req instanceof RenderRequestWrapper) {
    RenderRequestWrapper reqWrapper=(RenderRequestWrapper)req;
    return getPortalPreferences((RenderRequest)reqWrapper.getPortletRequest());
  }
 else {
    reqImpl=(RenderRequestImpl)req;
  }
  return getPortalPreferences(reqImpl.getHttpServletRequest());
}
