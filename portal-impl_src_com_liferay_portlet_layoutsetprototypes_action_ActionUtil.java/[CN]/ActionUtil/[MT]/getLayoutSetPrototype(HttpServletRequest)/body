{
  LayoutSetPrototype layoutSetPrototype=null;
  try {
    long layoutSetPrototypeId=ParamUtil.getLong(request,"layoutSetPrototypeId");
    if (Validator.isNotNull(layoutSetPrototypeId)) {
      layoutSetPrototype=LayoutSetPrototypeServiceUtil.getLayoutSetPrototype(layoutSetPrototypeId);
    }
 else {
      ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
      Group group=themeDisplay.getScopeGroup();
      if (group.isLayoutSetPrototype()) {
        layoutSetPrototype=LayoutSetPrototypeLocalServiceUtil.getLayoutSetPrototype(group.getClassPK());
      }
    }
  }
 catch (  NoSuchLayoutSetPrototypeException nslspe) {
  }
  request.setAttribute(WebKeys.LAYOUT_PROTOTYPE,layoutSetPrototype);
}
