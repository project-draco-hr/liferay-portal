{
  UserThread userThread=userThreadLocalService.getUserThread(getUserId(),mbThreadId);
  MBMessage topMBMessage=MBMessageLocalServiceUtil.getMBMessage(userThread.getTopMBMessageId());
  List<MBMessage> mbMessages=MBMessageLocalServiceUtil.getThreadMessages(mbThreadId,WorkflowConstants.STATUS_ANY,new MessageCreateDateComparator(ascending));
  List<MBMessage> filteredMBMessages=new ArrayList<>();
  for (  MBMessage mbMessage : mbMessages) {
    int compareTo=DateUtil.compareTo(topMBMessage.getCreateDate(),mbMessage.getCreateDate());
    if (compareTo <= 0) {
      filteredMBMessages.add(mbMessage);
    }
  }
  if (filteredMBMessages.isEmpty()) {
    return filteredMBMessages;
  }
 else   if ((start == QueryUtil.ALL_POS) || (end == QueryUtil.ALL_POS)) {
    return filteredMBMessages;
  }
 else   if (end > filteredMBMessages.size()) {
    end=filteredMBMessages.size();
  }
  return filteredMBMessages.subList(start,end);
}
