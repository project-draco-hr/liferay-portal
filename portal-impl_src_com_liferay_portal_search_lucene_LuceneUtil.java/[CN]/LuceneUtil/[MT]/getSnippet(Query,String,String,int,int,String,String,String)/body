{
  SimpleHTMLFormatter formatter=new SimpleHTMLFormatter(preTag,postTag);
  QueryScorer scorer=new QueryScorer(query,field);
  Highlighter highlighter=new Highlighter(formatter,scorer);
  highlighter.setTextFragmenter(new SimpleFragmenter(fragmentLength));
  TokenStream tokenStream=LuceneUtil.getAnalyzer().tokenStream(field,new StringReader(s));
  String snippet=highlighter.getBestFragments(tokenStream,s,maxNumFragments,fragmentSuffix);
  if (Validator.isNotNull(snippet) && !StringUtil.endsWith(snippet,fragmentSuffix)) {
    snippet=snippet + fragmentSuffix;
  }
  return snippet;
}
