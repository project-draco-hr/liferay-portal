{
  Connection con=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    DatabaseMetaData metaData=con.getMetaData();
    rs=metaData.getTables(null,null,tableName,null);
    if (!rs.next()) {
      JdbcTemplate jdbcTemplate=directory.getJdbcTemplate();
      jdbcTemplate.executeUpdate(directory.getTable().sqlCreate());
      Class<?> lockClass=directory.getSettings().getLockClass();
      JdbcLock jdbcLock=null;
      try {
        jdbcLock=(JdbcLock)lockClass.newInstance();
      }
 catch (      Exception e) {
        throw new JdbcStoreException("Failed to create lock class " + lockClass);
      }
      jdbcLock.initializeDatabase(directory);
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Could not create " + tableName);
    }
  }
 finally {
    DataAccess.cleanUp(con,null,rs);
  }
}
