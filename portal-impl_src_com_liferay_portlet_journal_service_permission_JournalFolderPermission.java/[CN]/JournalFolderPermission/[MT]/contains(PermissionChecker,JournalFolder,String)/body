{
  if (actionId.equals(ActionKeys.ADD_FOLDER)) {
    actionId=ActionKeys.ADD_SUBFOLDER;
  }
  Boolean hasPermission=StagingPermissionUtil.hasPermission(permissionChecker,folder.getGroupId(),JournalFolder.class.getName(),folder.getFolderId(),PortletKeys.JOURNAL,actionId);
  if (hasPermission != null) {
    return hasPermission.booleanValue();
  }
  long folderId=folder.getFolderId();
  if (PropsValues.PERMISSIONS_VIEW_DYNAMIC_INHERITANCE) {
    long originalFolderId=folderId;
    try {
      while (folderId != JournalFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
        folder=JournalFolderLocalServiceUtil.getFolder(folderId);
        if (!permissionChecker.hasOwnerPermission(folder.getCompanyId(),JournalFolder.class.getName(),folderId,folder.getUserId(),ActionKeys.VIEW) && !permissionChecker.hasPermission(folder.getGroupId(),JournalFolder.class.getName(),folderId,ActionKeys.VIEW)) {
          return false;
        }
        folderId=folder.getParentFolderId();
      }
    }
 catch (    NoSuchFolderException nsfe) {
      if (!folder.isInTrash()) {
        throw nsfe;
      }
    }
    if (actionId.equals(ActionKeys.VIEW)) {
      return true;
    }
    folderId=originalFolderId;
  }
  try {
    while (folderId != JournalFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
      folder=JournalFolderLocalServiceUtil.getFolder(folderId);
      if (permissionChecker.hasOwnerPermission(folder.getCompanyId(),JournalFolder.class.getName(),folderId,folder.getUserId(),actionId) || permissionChecker.hasPermission(folder.getGroupId(),JournalFolder.class.getName(),folderId,actionId)) {
        return true;
      }
      folderId=folder.getParentFolderId();
    }
  }
 catch (  NoSuchFolderException nsfe) {
    if (!folder.isInTrash()) {
      throw nsfe;
    }
  }
  return false;
}
