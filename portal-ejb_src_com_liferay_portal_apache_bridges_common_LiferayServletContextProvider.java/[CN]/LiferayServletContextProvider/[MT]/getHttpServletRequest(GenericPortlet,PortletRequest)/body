{
  HttpServletRequest httpReq=null;
  if (req instanceof RenderRequestImpl) {
    httpReq=((RenderRequestImpl)req).getHttpServletRequest();
  }
 else {
    httpReq=((ActionRequestImpl)req).getHttpServletRequest();
  }
  Collection filteredParams=getFilteredParams(portlet);
  if (filteredParams.size() == 0) {
    return httpReq;
  }
 else {
    return new ParamFilteringServletRequest(httpReq,filteredParams);
  }
}
