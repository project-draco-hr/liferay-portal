{
  String portletId=portletDataContext.getPortletId();
  long rootFolderId=GetterUtil.getLong(portletPreferences.getValue("rootFolderId",null));
  if (rootFolderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    Folder folder=null;
    try {
      folder=DLAppLocalServiceUtil.getFolder(rootFolderId);
    }
 catch (    PortalException e) {
      String errorMessage="Portlet " + portletId + " refers to an invalid root folder ID "+ rootFolderId;
      if (_log.isErrorEnabled()) {
        _log.error(errorMessage);
      }
      throw new PortletDataException(errorMessage,e);
    }
    StagedModelDataHandlerUtil.exportReferenceStagedModel(portletDataContext,portletId,folder);
  }
  return portletPreferences;
}
