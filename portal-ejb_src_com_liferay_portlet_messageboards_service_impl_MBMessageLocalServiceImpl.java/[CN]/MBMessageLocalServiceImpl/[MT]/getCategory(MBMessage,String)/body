{
  if (!message.getCategoryId().equals(categoryId)) {
    MBCategory oldCategory=MBCategoryUtil.findByPrimaryKey(message.getCategoryId());
    MBCategory newCategory=MBCategoryUtil.fetchByPrimaryKey(categoryId);
    if ((newCategory == null) || (!oldCategory.getGroupId().equals(newCategory.getGroupId()))) {
      categoryId=message.getCategoryId();
    }
  }
  return MBCategoryUtil.findByPrimaryKey(categoryId);
}
