{
  AbstractURLStreamHandlerService abstractURLStreamHandlerService=(AbstractURLStreamHandlerService)_bundleContext.getService(serviceReference);
  try {
    URL wabURL=new URL("webbundle",null,-1,_lpkgURL.toExternalForm() + "?Web-ContextPath=/" + _contextName,abstractURLStreamHandlerService);
    URLConnection urlConnection=abstractURLStreamHandlerService.openConnection(wabURL);
    Bundle newBundle=_bundleContext.installBundle(wabURL.toExternalForm(),urlConnection.getInputStream());
    _lpkgWarBundleRegistry.register(_bundleContext.getBundle(),newBundle);
    BundleStartLevel bundleStartLevel=newBundle.adapt(BundleStartLevel.class);
    bundleStartLevel.setStartLevel(_startLevel);
    newBundle.start();
    return newBundle;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
