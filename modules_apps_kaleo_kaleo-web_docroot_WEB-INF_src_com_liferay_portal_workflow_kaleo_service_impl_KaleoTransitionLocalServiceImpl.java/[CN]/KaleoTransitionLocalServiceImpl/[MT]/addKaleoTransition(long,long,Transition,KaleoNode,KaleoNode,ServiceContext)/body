{
  User user=userPersistence.findByPrimaryKey(serviceContext.getGuestOrUserId());
  Date now=new Date();
  long kaleoTransitionId=counterLocalService.increment();
  KaleoTransition kaleoTransition=kaleoTransitionPersistence.create(kaleoTransitionId);
  kaleoTransition.setCompanyId(user.getCompanyId());
  kaleoTransition.setUserId(user.getUserId());
  kaleoTransition.setUserName(user.getFullName());
  kaleoTransition.setCreateDate(now);
  kaleoTransition.setModifiedDate(now);
  kaleoTransition.setKaleoDefinitionId(kaleoDefinitionId);
  kaleoTransition.setKaleoNodeId(kaleoNodeId);
  kaleoTransition.setName(transition.getName());
  kaleoTransition.setSourceKaleoNodeId(sourceKaleoNode.getKaleoNodeId());
  kaleoTransition.setSourceKaleoNodeName(sourceKaleoNode.getName());
  kaleoTransition.setTargetKaleoNodeId(targetKaleoNode.getKaleoNodeId());
  kaleoTransition.setTargetKaleoNodeName(targetKaleoNode.getName());
  kaleoTransition.setDefaultTransition(transition.isDefault());
  kaleoTransitionPersistence.update(kaleoTransition);
  Timer timer=transition.getTimer();
  if (timer != null) {
    kaleoTimerLocalService.addKaleoTimer(KaleoTransition.class.getName(),kaleoTransitionId,kaleoDefinitionId,timer,serviceContext);
  }
  return kaleoTransition;
}
