{
  PollerRequestResponsePair pollerRequestResponsePair=(PollerRequestResponsePair)message.getPayload();
  PollerRequest pollerRequest=pollerRequestResponsePair.getPollerRequest();
  PollerResponse pollerResponse=pollerRequestResponsePair.getPollerResponse();
  String portletId=pollerRequest.getPortletId();
  PollerProcessor pollerProcessor=PollerProcessorUtil.getPollerProcessor(portletId);
  if (pollerRequest.isReceiveRequest()) {
    pollerResponse.createResponseMessage(message);
    try {
      pollerProcessor.receive(pollerRequest,pollerResponse);
    }
 catch (    PollerException pe) {
      _log.error("Unable to receive poller request " + pollerRequest,pe);
      pollerResponse.setParameter("pollerException",pe.getMessage());
    }
 finally {
      pollerResponse.close();
    }
  }
 else {
    try {
      pollerProcessor.send(pollerRequest);
    }
 catch (    PollerException pe) {
      _log.error("Unable to send poller request " + pollerRequest,pe);
    }
  }
}
