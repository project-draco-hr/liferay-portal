{
  String attributeValue=newAttributeName + "=\"";
  int attribBeginIndex=tag.indexOf(oldAttributeName);
  if (attribBeginIndex != -1) {
    attribBeginIndex+=oldAttributeName.length() + 2;
    int attribEndIndex=tag.indexOf("\"",attribBeginIndex);
    int openJavaIndex=tag.indexOf("<%=",attribBeginIndex);
    if (openJavaIndex != -1 && openJavaIndex < attribEndIndex) {
      attribEndIndex=openJavaIndex + 3 + _getAttributeEndIndex(tag.substring(openJavaIndex + 3,tag.length()));
    }
    attributeValue+=tag.substring(attribBeginIndex,attribEndIndex + 1);
  }
 else {
    attributeValue=null;
  }
  return attributeValue;
}
