{
  StringBuffer url=new StringBuffer();
  url.append(_url);
  if (_url.indexOf("?") == -1) {
    url.append("?");
  }
  Iterator itr=in.getPropertyNames().iterator();
  while (itr.hasNext()) {
    String key=(String)itr.next();
    String value=(String)in.getProperty(key);
    url.append("&");
    url.append(key);
    url.append("=");
    try {
      url.append(URLEncoder.encode(value,"utf-8"));
    }
 catch (    UnsupportedEncodingException uee) {
      throw new MessagingException(uee.getMessage());
    }
  }
  try {
    return Http.URLtoString(url.toString(),true);
  }
 catch (  IOException ioe) {
    throw new MessagingException(ioe.getMessage());
  }
}
