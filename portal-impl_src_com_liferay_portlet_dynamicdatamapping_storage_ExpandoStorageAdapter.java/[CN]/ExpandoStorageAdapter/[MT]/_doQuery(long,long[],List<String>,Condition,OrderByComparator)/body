{
  List<Fields> fieldsList=new ArrayList<Fields>();
  Expression expression=null;
  if (condition != null) {
    expression=_parseExpression(condition);
  }
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getDDMStructure(ddmStructureId);
  for (  long expandoRowId : expandoRowIds) {
    List<ExpandoValue> expandoValues=ExpandoValueLocalServiceUtil.getRowValues(expandoRowId);
    if ((expression == null) || ((expression != null) && _booleanValueOf(expression,expandoValues))) {
      Fields fields=new Fields();
      for (      ExpandoValue expandoValue : expandoValues) {
        ExpandoColumn column=expandoValue.getColumn();
        String fieldName=column.getName();
        String fieldDataType=ddmStructure.getFieldDataType(fieldName);
        Serializable fieldValue=expandoValue.getSerializable();
        if ((fieldNames == null) || ((fieldNames != null) && fieldNames.contains(fieldName))) {
          fields.put(new Field(fieldName,fieldValue,fieldDataType));
        }
      }
      fieldsList.add(fields);
    }
  }
  if (orderByComparator != null) {
    Collections.sort(fieldsList,orderByComparator);
  }
  return fieldsList;
}
