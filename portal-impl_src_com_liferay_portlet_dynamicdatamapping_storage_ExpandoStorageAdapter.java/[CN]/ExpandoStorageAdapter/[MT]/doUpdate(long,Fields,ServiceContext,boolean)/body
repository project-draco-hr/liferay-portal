{
  ExpandoRow row=ExpandoRowLocalServiceUtil.getRow(classPK);
  DDMStorageLink ddmStorageLink=DDMStorageLinkLocalServiceUtil.getClassStorageLink(row.getRowId());
  ExpandoTable table=_getExpandoTable(row.getCompanyId(),ddmStorageLink.getStructureId(),fields);
  List<ExpandoColumn> columns=ExpandoColumnLocalServiceUtil.getColumns(table.getTableId());
  if (!merge) {
    for (    ExpandoColumn column : columns) {
      if (!fields.contains(column.getName())) {
        ExpandoValueLocalServiceUtil.deleteValue(column.getColumnId(),row.getRowId());
      }
    }
  }
  _updateFields(table,row.getClassPK(),fields);
}
