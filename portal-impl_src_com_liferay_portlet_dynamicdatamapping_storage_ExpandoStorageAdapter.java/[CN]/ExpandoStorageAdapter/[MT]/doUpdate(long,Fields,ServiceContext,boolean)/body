{
  ExpandoRow expandoRow=ExpandoRowLocalServiceUtil.getRow(classPK);
  DDMStorageLink ddmStorageLink=DDMStorageLinkLocalServiceUtil.getClassStorageLink(expandoRow.getRowId());
  ExpandoTable expandoTable=_getExpandoTable(expandoRow.getCompanyId(),ddmStorageLink.getStructureId(),fields);
  List<ExpandoColumn> expandoColumns=ExpandoColumnLocalServiceUtil.getColumns(expandoTable.getTableId());
  if (!merge) {
    for (    ExpandoColumn expandoColumn : expandoColumns) {
      if (!fields.contains(expandoColumn.getName())) {
        ExpandoValueLocalServiceUtil.deleteValue(expandoColumn.getColumnId(),expandoRow.getRowId());
      }
    }
  }
  _updateFields(expandoTable,expandoRow.getClassPK(),fields);
}
