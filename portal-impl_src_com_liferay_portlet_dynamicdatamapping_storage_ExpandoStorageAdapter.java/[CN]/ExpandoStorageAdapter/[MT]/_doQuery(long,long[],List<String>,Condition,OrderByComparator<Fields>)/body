{
  List<Fields> fieldsList=new ArrayList<Fields>();
  Expression expression=null;
  if (condition != null) {
    expression=_parseExpression(condition);
  }
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getStructure(ddmStructureId);
  for (  long expandoRowId : expandoRowIds) {
    List<ExpandoValue> expandoValues=ExpandoValueLocalServiceUtil.getRowValues(expandoRowId);
    if ((expression == null) || ((expression != null) && _booleanValueOf(expression,expandoValues))) {
      Fields fields=new Fields();
      for (      ExpandoValue expandoValue : expandoValues) {
        ExpandoColumn column=expandoValue.getColumn();
        String fieldName=column.getName();
        if (ddmStructure.hasField(fieldName) && ((fieldNames == null) || ((fieldNames != null) && fieldNames.contains(fieldName)))) {
          Field field=new Field();
          field.setDefaultLocale(expandoValue.getDefaultLocale());
          field.setDDMStructureId(ddmStructureId);
          field.setName(fieldName);
          String fieldType=ddmStructure.getFieldDataType(fieldName);
          Map<Locale,List<Serializable>> valuesMap=_getValuesMap(column.getType(),fieldType,expandoValue.getSerializable());
          field.setValuesMap(valuesMap);
          fields.put(field);
        }
      }
      fieldsList.add(fields);
    }
  }
  if (orderByComparator != null) {
    Collections.sort(fieldsList,orderByComparator);
  }
  return fieldsList;
}
