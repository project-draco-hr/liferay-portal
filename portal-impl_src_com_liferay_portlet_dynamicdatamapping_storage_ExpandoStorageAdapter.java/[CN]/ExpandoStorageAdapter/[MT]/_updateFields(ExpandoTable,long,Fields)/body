{
  Iterator<Field> itr=fields.iterator(true);
  while (itr.hasNext()) {
    Field field=itr.next();
    Map<Locale,?> dataMap=null;
    if (field.isRepeatable()) {
      Map<Locale,String[]> stringArrayMap=new HashMap<Locale,String[]>();
      for (      Locale locale : field.getAvailableLocales()) {
        Serializable value=field.getValue(locale);
        if (value instanceof Date[]) {
          Date[] dates=(Date[])value;
          String[] values=new String[dates.length];
          for (int i=0; i < dates.length; i++) {
            values[i]=String.valueOf(dates[i].getTime());
          }
          stringArrayMap.put(locale,values);
        }
 else {
          String[] values=_toStringArray(field.getDataType(),(Serializable[])value);
          stringArrayMap.put(locale,values);
        }
      }
      dataMap=stringArrayMap;
    }
 else {
      Map<Locale,String> stringMap=new HashMap<Locale,String>();
      for (      Locale locale : field.getAvailableLocales()) {
        Serializable value=field.getValue(locale);
        if (FieldConstants.isNumericType(field.getDataType()) && (value == null)) {
          value=_NUMERIC_NULL_VALUE;
        }
 else         if (value instanceof Date) {
          Date date=(Date)value;
          value=date.getTime();
        }
        stringMap.put(locale,String.valueOf(value));
      }
      dataMap=stringMap;
    }
    ExpandoValueLocalServiceUtil.addValue(expandoTable.getCompanyId(),ExpandoStorageAdapter.class.getName(),expandoTable.getName(),field.getName(),classPK,dataMap,field.getDefaultLocale());
  }
}
