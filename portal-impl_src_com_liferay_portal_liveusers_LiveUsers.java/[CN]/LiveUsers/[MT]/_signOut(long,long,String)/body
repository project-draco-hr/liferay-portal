{
  List<UserTracker> userTrackers=_getUserTrackers(companyId,userId);
  if ((userTrackers == null) || (userTrackers.size() <= 1)) {
    _updateGroupStatus(companyId,userId,false);
  }
  Map<String,UserTracker> sessionUsers=_getSessionUsers(companyId);
  UserTracker userTracker=sessionUsers.remove(sessionId);
  if (userTracker == null) {
    return;
  }
  try {
    UserTrackerLocalServiceUtil.addUserTracker(userTracker.getCompanyId(),userTracker.getUserId(),userTracker.getModifiedDate(),sessionId,userTracker.getRemoteAddr(),userTracker.getRemoteHost(),userTracker.getUserAgent(),userTracker.getPaths());
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e.getMessage());
    }
  }
  try {
    HttpSession userTrackerSession=PortalSessionContext.get(sessionId);
    if (userTrackerSession != null) {
      userTrackerSession.invalidate();
    }
  }
 catch (  Exception e) {
  }
  _removeUserTracker(companyId,userId,userTracker);
}
