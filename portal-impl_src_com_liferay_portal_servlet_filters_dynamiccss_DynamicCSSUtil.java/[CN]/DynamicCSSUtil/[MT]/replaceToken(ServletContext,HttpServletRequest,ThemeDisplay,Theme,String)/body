{
  String portalContextPath=PortalUtil.getPathContext();
  String baseURL=portalContextPath;
  String contextPath=ContextPathUtil.getContextPath(servletContext);
  if (!contextPath.equals(portalContextPath)) {
    baseURL=StringPool.SLASH.concat(GetterUtil.getString(servletContext.getServletContextName()));
  }
  if (baseURL.endsWith(StringPool.SLASH)) {
    baseURL=baseURL.substring(0,baseURL.length() - 1);
  }
  parsedContent=StringUtil.replace(parsedContent,new String[]{"@base_url@","@portal_ctx@","@theme_image_path@"},new String[]{baseURL,portalContextPath,_getThemeImagesPath(request,themeDisplay,theme)});
  return parsedContent;
}
