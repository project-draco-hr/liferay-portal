{
  try {
    DataSource dataSource=socialEquityLogPersistence.getDataSource();
    JdbcTemplate jdbc=new JdbcTemplate(dataSource);
    UpdateRanksCallbackHandler handler=new UpdateRanksCallbackHandler(jdbc);
    String sql=CustomSQLUtil.get(_ITERATE_OVER_SOCIAL_EQUITY_USER);
    sql=StringUtil.replace(sql,"[$ACTION_DATE$]",String.valueOf(getEquityDate()));
    jdbc.query(sql,handler);
    handler.flush();
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
