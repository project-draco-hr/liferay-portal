{
  String ddmStructureKey=ParamUtil.getString(actionRequest,"ddmStructureKey");
  PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(actionRequest);
  String[] addMenuFavItems=portalPreferences.getValues(JournalPortletKeys.JOURNAL,"add-menu-fav-items",new String[0]);
  if (addMenuFavItems.length >= _journalWebConfiguration.maxAddMenuItems()) {
    hideDefaultErrorMessage(actionRequest);
    throw new MaxAddMenuFavItemsException();
  }
  portalPreferences.setValues(JournalPortletKeys.JOURNAL,"add-menu-fav-items",ArrayUtil.append(addMenuFavItems,ddmStructureKey));
}
