{
  try {
    String content=null;
    int templatePathIndex=href.indexOf(_GET_TEMPLATE_PATH);
    if (templatePathIndex >= 0) {
      int templateIdIndex=templatePathIndex + _GET_TEMPLATE_PATH.length();
      long companyId=GetterUtil.getLong((String)_tokens.get("company_id"));
      long groupId=GetterUtil.getLong((String)_tokens.get("group_id"));
      String templateId=href.substring(templateIdIndex,href.length());
      content=JournalUtil.getTemplateScript(companyId,groupId,templateId,_tokens,_languageId);
    }
 else {
      content=Http.URLtoString(href);
    }
    return new StreamSource(new StringReader(content));
  }
 catch (  Exception e) {
    _log.error(href + " does not reference a valid template");
    return null;
  }
}
