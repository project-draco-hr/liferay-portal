{
  if (image.getFolderId() != folderId) {
    IGFolder oldFolder=IGFolderUtil.findByPrimaryKey(image.getFolderId());
    IGFolder newFolder=IGFolderUtil.fetchByPrimaryKey(folderId);
    if ((newFolder == null) || (oldFolder.getGroupId() != newFolder.getGroupId())) {
      folderId=image.getFolderId();
    }
  }
  return IGFolderUtil.findByPrimaryKey(folderId);
}
