{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
    if (Validator.isNull(onImage)) {
      onImage=themeDisplay.getPathThemeImages() + "/arrows/01_down.png";
    }
    if (Validator.isNull(offImage)) {
      offImage=themeDisplay.getPathThemeImages() + "/arrows/01_right.png";
    }
    String defaultStateValue=defaultOn ? StringPool.BLANK : "none";
    String defaultImage=defaultOn ? onImage : offImage;
    String clickValue=SessionClicks.get(req,id,null);
    if (defaultOn) {
      if ((clickValue != null) && (clickValue.equals("none"))) {
        defaultStateValue="none";
        defaultImage=offImage;
      }
 else {
        defaultStateValue="";
        defaultImage=onImage;
      }
    }
 else {
      if ((clickValue == null) || (clickValue.equals("none"))) {
        defaultStateValue="none";
        defaultImage=offImage;
      }
 else {
        defaultStateValue="";
        defaultImage=onImage;
      }
    }
    if (stateVar == null) {
      stateVar=PwdGenerator.getPassword(PwdGenerator.KEY3,8);
    }
    req.setAttribute("liferay-ui:toggle:id",id);
    req.setAttribute("liferay-ui:toggle:onImage",onImage);
    req.setAttribute("liferay-ui:toggle:offImage",offImage);
    req.setAttribute("liferay-ui:toggle:stateVar",stateVar);
    req.setAttribute("liferay-ui:toggle:defaultStateValue",defaultStateValue);
    req.setAttribute("liferay-ui:toggle:defaultImage",defaultImage);
    RequestDispatcher rd=ctx.getRequestDispatcher(page);
    rd.include(req,res);
  }
 catch (  Exception e) {
    _log.error(e,e);
    throw new JspException(e);
  }
}
