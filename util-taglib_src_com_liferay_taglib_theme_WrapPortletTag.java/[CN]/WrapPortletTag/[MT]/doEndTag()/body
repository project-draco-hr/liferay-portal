{
  try {
    ServletContext servletContext=getServletContext();
    HttpServletRequest request=getServletRequest();
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    Theme theme=themeDisplay.getTheme();
    PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
    StringBundler bodyContentSB=getBodyContentAsStringBundler();
    portletDisplay.setContent(bodyContentSB.toString());
    ThemeUtil.include(servletContext,request,new PipingServletResponse(pageContext),pageContext,getPage(),theme);
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    throw new JspException(e);
  }
 finally {
    clearParams();
    clearProperties();
  }
}
