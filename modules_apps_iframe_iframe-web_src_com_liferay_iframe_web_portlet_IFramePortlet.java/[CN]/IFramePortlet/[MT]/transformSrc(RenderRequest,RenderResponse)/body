{
  IFrameDisplayContext iFrameDisplayContext=new IFrameDisplayContext(_iFrameConfiguration,renderRequest);
  String src=ParamUtil.getString(renderRequest,"src",iFrameDisplayContext.getSrc());
  if (!iFrameDisplayContext.isAuth()) {
    return src;
  }
  String authType=iFrameDisplayContext.getAuthType();
  if (authType.equals("basic")) {
    String userName=IFrameUtil.getUserName(renderRequest,iFrameDisplayContext.getBasicUserName());
    String password=IFrameUtil.getPassword(renderRequest,iFrameDisplayContext.getBasicPassword());
    int pos=src.indexOf("://");
    String protocol=src.substring(0,pos + 3);
    String url=src.substring(pos + 3);
    src=protocol + userName + ":"+ password+ "@"+ url;
  }
 else {
    ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
    String portletId=PortalUtil.getPortletId(renderRequest);
    PortletURL proxyURL=renderResponse.createRenderURL();
    proxyURL.setParameter("mvcPath","/proxy.jsp");
    proxyURL.setParameter("p_l_id",String.valueOf(themeDisplay.getPlid()));
    proxyURL.setParameter("p_p_id",portletId);
    src=proxyURL.toString();
  }
  return src;
}
