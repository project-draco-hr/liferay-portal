{
  IFrameDisplayContext iFrameDisplayContext=new IFrameDisplayContext(_iFrameConfiguration,PortalUtil.getHttpServletRequest(renderRequest));
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String src=ParamUtil.getString(renderRequest,"src",iFrameDisplayContext.getSrc());
  boolean auth=iFrameDisplayContext.isAuth();
  if (!auth) {
    return src;
  }
  String authType=iFrameDisplayContext.getAuthType();
  if (authType.equals("basic")) {
    String userName=IFrameUtil.getUserName(renderRequest,iFrameDisplayContext.getBasicUserName());
    String password=IFrameUtil.getPassword(renderRequest,iFrameDisplayContext.getBasicPassword());
    int pos=src.indexOf("://");
    String protocol=src.substring(0,pos + 3);
    String url=src.substring(pos + 3);
    src=protocol + userName + ":"+ password+ "@"+ url;
  }
 else {
    String portletId=PortalUtil.getPortletId(renderRequest);
    src="/proxy.jsp?p_l_id=" + themeDisplay.getPlid() + "&p_p_id="+ portletId;
  }
  return src;
}
