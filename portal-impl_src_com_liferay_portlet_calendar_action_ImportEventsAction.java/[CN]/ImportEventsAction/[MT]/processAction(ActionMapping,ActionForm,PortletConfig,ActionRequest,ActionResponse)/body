{
  try {
    UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(actionRequest);
    ServiceContext serviceContext=ServiceContextFactory.getInstance(CalEvent.class.getName(),actionRequest);
    File file=uploadPortletRequest.getFile("file");
    validate(file);
    CalEventServiceUtil.importICal4j(serviceContext.getScopeGroupId(),file);
    sendRedirect(actionRequest,actionResponse);
  }
 catch (  Exception e) {
    if (!(e instanceof ImportEventsException)) {
      _log.error(e,e);
    }
    SessionErrors.add(actionRequest,e.getClass().getName());
    setForward(actionRequest,"portlet.calendar.error");
  }
}
