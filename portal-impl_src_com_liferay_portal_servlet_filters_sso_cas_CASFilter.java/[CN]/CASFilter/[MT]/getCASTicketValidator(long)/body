{
  TicketValidator validator=_casTicketValidators.get(companyId);
  if (validator == null) {
    String serverUrl=PrefsPropsUtil.getString(companyId,PropsKeys.CAS_SERVER_URL,PropsValues.CAS_SERVER_URL);
    String serverName=PrefsPropsUtil.getString(companyId,PropsKeys.CAS_SERVER_NAME,PropsValues.CAS_SERVER_NAME);
    String loginUrl=PrefsPropsUtil.getString(companyId,PropsKeys.CAS_LOGIN_URL,PropsValues.CAS_LOGIN_URL);
    Cas20ProxyTicketValidator cas20ProxyTicketValidator=new Cas20ProxyTicketValidator(serverUrl);
    Map<String,String> parameters=new HashMap<String,String>();
    parameters.put("serverName",serverName);
    parameters.put("casServerUrlPrefix",serverUrl);
    parameters.put("casServerLoginUrl",loginUrl);
    parameters.put("redirectAfterValidation","false");
    cas20ProxyTicketValidator.setCustomParameters(parameters);
    _casTicketValidators.put(companyId,cas20ProxyTicketValidator);
    return cas20ProxyTicketValidator;
  }
  return validator;
}
