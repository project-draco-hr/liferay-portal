{
  Multimap<Set<String>,String> multimap=HashMultimap.create();
  for (  String classCommandName : classCommandNames) {
    String className=PoshiRunnerGetterUtil.getClassNameFromClassCommandName(classCommandName);
    Set<String> properties=new TreeSet<>();
    properties.addAll(_getTestCaseClassProperties(className));
    properties.addAll(_getTestCaseCommandProperties(classCommandName));
    for (Iterator<String> iterator=properties.iterator(); iterator.hasNext(); ) {
      String next=iterator.next();
      if (next.matches(PropsValues.TEST_BATCH_GROUP_IGNORE_REGEX)) {
        iterator.remove();
      }
    }
    multimap.put(properties,classCommandName);
  }
  Map<Integer,List<String>> classCommandNameGroups=new HashMap<>();
  int classCommandNameIndex=0;
  Map<Set<String>,Collection<String>> map=multimap.asMap();
  for (  Set<String> key : map.keySet()) {
    List<String> classCommandNameGroup=new ArrayList(map.get(key));
    Collections.sort(classCommandNameGroup);
    int groupSize=_getAllocatedTestGroupSize(classCommandNameGroup.size());
    List<List<String>> partitions=Lists.partition(classCommandNameGroup,groupSize);
    for (int j=0; j < partitions.size(); j++) {
      classCommandNameGroups.put(classCommandNameIndex,partitions.get(j));
      classCommandNameIndex++;
    }
  }
  return classCommandNameGroups;
}
