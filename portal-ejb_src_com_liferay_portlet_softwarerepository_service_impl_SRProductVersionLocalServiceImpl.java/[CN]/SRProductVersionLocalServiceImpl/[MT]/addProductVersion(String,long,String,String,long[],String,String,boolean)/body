{
  User user=UserUtil.findByPrimaryKey(userId);
  Date now=new Date();
  long productVersionId=CounterLocalServiceUtil.increment(SRProductVersion.class.getName());
  SRProductEntry productEntry=SRProductEntryLocalServiceUtil.getProductEntry(productEntryId);
  SRProductVersion productVersion=SRProductVersionUtil.create(productVersionId);
  productVersion.setUserId(user.getUserId());
  productVersion.setCreateDate(now);
  productVersion.setModifiedDate(now);
  productVersion.setProductEntryId(productEntryId);
  productVersion.setVersion(version);
  productVersion.setChangeLog(changeLog);
  productVersion.setDownloadPageURL(downloadPageURL);
  productVersion.setDirectDownloadURL(directDownloadURL);
  productVersion.setRepoStoreArtifact(repoStoreArtifact);
  SRProductVersionUtil.update(productVersion);
  SRProductVersionUtil.setSRFrameworkVersions(productEntryId,frameworkVersionIds);
  productEntry.setModifiedDate(now);
  SRProductEntryUtil.update(productEntry);
  return productVersion;
}
