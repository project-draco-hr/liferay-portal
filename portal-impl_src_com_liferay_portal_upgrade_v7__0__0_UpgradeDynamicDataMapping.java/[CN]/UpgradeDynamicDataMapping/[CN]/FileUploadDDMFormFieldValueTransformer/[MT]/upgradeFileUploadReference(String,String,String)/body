{
  try {
    long dlFolderId=addDLFolderTree(ddmFormFieldName);
    JSONObject jsonObject=JSONFactoryUtil.createJSONObject(valueString);
    String name=String.valueOf(increment(DLFileEntry.class.getName()));
    String fileName=jsonObject.getString("name");
    String filePath=jsonObject.getString("path");
    long fileEntryId=increment();
    String extension=getExtension(fileName);
    File file=DLStoreUtil.getFile(_companyId,CompanyConstants.SYSTEM,filePath);
    addDLFileEntry(fileEntryUuid,fileEntryId,_groupId,_companyId,_userId,_userName,_createDate,_createDate,0,0,_groupId,dlFolderId,StringPool.BLANK,name,fileName,extension,MimeTypesUtil.getContentType(fileName),fileName,StringPool.BLANK,StringPool.BLANK,DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT,DLFileEntryConstants.VERSION_DEFAULT,file.length(),DLFileEntryConstants.DEFAULT_READ_COUNT,0,0,0,0,false);
    addResourcePermissions(0,increment(),_companyId,DLFileEntry.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,fileEntryId,getRoleId(RoleConstants.OWNER),_userId,getActionIdsLong(_ownerPermissions));
    if (_groupId > 0) {
      addResourcePermissions(0,increment(),_companyId,DLFileEntry.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,fileEntryId,getRoleId(RoleConstants.SITE_MEMBER),0,getActionIdsLong(_groupPermissions));
    }
    addResourcePermissions(0,increment(),_companyId,DLFileEntry.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,fileEntryId,getRoleId(RoleConstants.GUEST),0,getActionIdsLong(_guestPermissions));
    addDLFileVersion(fileEntryUuid,increment(),_groupId,_companyId,_userId,_userName,_createDate,_createDate,_groupId,dlFolderId,fileEntryId,StringPool.BLANK,fileName,extension,MimeTypesUtil.getContentType(fileName),fileName,StringPool.BLANK,StringPool.BLANK,StringPool.BLANK,DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT,DLFileEntryConstants.VERSION_DEFAULT,file.length(),StringPool.BLANK,WorkflowConstants.STATUS_APPROVED,_userId,_userName,_createDate);
    addAssetEntry(increment(),_groupId,_companyId,_userId,_userName,_createDate,_createDate,PortalUtil.getClassNameId(DLFileEntry.class),fileEntryId,fileEntryUuid,DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT,false,null,null,null,null,MimeTypesUtil.getContentType(fileName),fileName,StringPool.BLANK,StringPool.BLANK,null,null,0,0,0,0);
    DLStoreUtil.addFile(_companyId,dlFolderId,name,file);
    return fileEntryUuid;
  }
 catch (  Exception e) {
    throw new UpgradeException(e);
  }
}
