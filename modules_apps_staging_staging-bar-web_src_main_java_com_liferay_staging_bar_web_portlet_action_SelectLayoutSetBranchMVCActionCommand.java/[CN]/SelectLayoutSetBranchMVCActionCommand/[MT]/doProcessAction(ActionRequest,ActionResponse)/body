{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  long layoutSetBranchId=ParamUtil.getLong(actionRequest,"layoutSetBranchId");
  boolean privateLayout=ParamUtil.getBoolean(actionRequest,"privateLayout");
  try {
    LayoutSet layoutSet=_layoutSetLocalService.getLayoutSet(groupId,privateLayout);
    LayoutSetBranch layoutSetBranch=_layoutSetBranchLocalService.getLayoutSetBranch(layoutSetBranchId);
    StagingUtil.setRecentLayoutSetBranchId(request,layoutSet.getLayoutSetId(),layoutSetBranch.getLayoutSetBranchId());
    ActionUtil.addLayoutBranchSessionMessages(actionRequest,actionResponse);
  }
 catch (  Exception e) {
    SessionErrors.add(actionRequest,e.getClass(),e);
    actionResponse.setRenderParameter("mvcPath","/error.jsp");
  }
}
