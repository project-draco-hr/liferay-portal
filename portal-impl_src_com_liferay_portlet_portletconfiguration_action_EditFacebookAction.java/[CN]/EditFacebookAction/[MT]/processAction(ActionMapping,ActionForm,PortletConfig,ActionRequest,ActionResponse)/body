{
  Portlet portlet=null;
  try {
    portlet=getPortlet(req);
  }
 catch (  PrincipalException pe) {
    SessionErrors.add(req,PrincipalException.class.getName());
    setForward(req,"portlet.portlet_configuration.error");
  }
  String portletResource=ParamUtil.getString(req,"portletResource");
  String facebookAppName=ParamUtil.getString(req,"facebookAppName");
  String facebookAPIKey=ParamUtil.getString(req,"facebookAPIKey");
  boolean facebookShowAddAppLink=ParamUtil.getBoolean(req,"facebookShowAddAppLink");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portlet.getPortletId());
  prefs.setValue("lfr-facebook-app-name",facebookAppName);
  prefs.setValue("lfr-facebook-api-key",facebookAPIKey);
  prefs.setValue("lfr-facebook-show-add-app-link",String.valueOf(facebookShowAddAppLink));
  prefs.store();
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
