{
  ProxyFactory.classLoaderProvider=new ProxyFactory.ClassLoaderProvider(){
    public ClassLoader get(    ProxyFactory proxyFactory){
      ClassLoader contextClassLoader=PACLClassLoaderUtil.getContextClassLoader();
      ClassLoader portalClassLoader=PACLClassLoaderUtil.getPortalClassLoader();
      if (contextClassLoader == portalClassLoader) {
        return contextClassLoader;
      }
      return new PreloadClassLoader(contextClassLoader,getPreloadClassLoaderClasses());
    }
  }
;
  setBeanClassLoader(getConfigurationClassLoader());
  return super.buildSessionFactory();
}
