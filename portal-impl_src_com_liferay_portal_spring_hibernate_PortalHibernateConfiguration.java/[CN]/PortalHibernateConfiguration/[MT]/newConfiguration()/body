{
  Configuration configuration=new Configuration();
  try {
    String[] resources=getConfigurationResources();
    for (    String resource : resources) {
      try {
        readResource(configuration,resource);
      }
 catch (      Exception e2) {
        if (_log.isWarnEnabled()) {
          _log.warn(e2,e2);
        }
      }
    }
    configuration.setProperties(PropsUtil.getProperties());
    if (Validator.isNull(PropsValues.HIBERNATE_DIALECT)) {
      String dialect=determineDialect();
      configuration.setProperty("hibernate.dialect",dialect);
    }
    DB db=DBFactoryUtil.getDB();
    if (db.getType().equals(DB.TYPE_HYPERSONIC)) {
    }
    if (_hibernateProperties != null) {
      Set<String> propertyNames=_hibernateProperties.stringPropertyNames();
      for (      String propertyName : propertyNames) {
        String propertyValue=_hibernateProperties.getProperty(propertyName);
        configuration.setProperty(propertyName,propertyValue);
      }
    }
  }
 catch (  Exception e1) {
    _log.error(e1,e1);
  }
  return configuration;
}
