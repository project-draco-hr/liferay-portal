{
  PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(portletRequest);
  PortletPreferences portletPreferences=portletRequest.getPreferences();
  String contentRootPrefix=GetterUtil.getString(portletPreferences.getValue("contentRootPrefix",null));
  String kbFolderURLTitle=getPreferredKBFolderURLTitle(portalPreferences,contentRootPrefix);
  long childKbFolderId=KBFolderConstants.DEFAULT_PARENT_FOLDER_ID;
  if (kbFolderURLTitle == null) {
    List<KBFolder> kbFolders=getAlternateRootKBFolders(groupId,kbFolderId);
    if (!kbFolders.isEmpty()) {
      KBFolder kbFolder=kbFolders.get(0);
      childKbFolderId=kbFolder.getKbFolderId();
    }
  }
 else {
    KBFolder kbFolder=KBFolderServiceUtil.fetchKBFolderByUrlTitle(groupId,kbFolderId,kbFolderURLTitle);
    if (kbFolder != null) {
      childKbFolderId=kbFolder.getKbFolderId();
    }
  }
  return childKbFolderId;
}
