{
  if ((_threadPoolExecutor == null) || _threadPoolExecutor.isShutdown()) {
    ClassLoader classLoader=PortalClassLoaderUtil.getClassLoader();
    if (_rejectedExecutionHandler == null) {
      _rejectedExecutionHandler=createRejectionExecutionHandler();
    }
    ThreadPoolExecutor threadPoolExecutor=new ThreadPoolExecutor(_workersCoreSize,_workersMaxSize,60L,TimeUnit.SECONDS,false,_maximumQueueSize,_rejectedExecutionHandler,new NamedThreadFactory(getName(),Thread.NORM_PRIORITY,classLoader),new ThreadPoolHandlerAdapter());
    ThreadPoolExecutor oldThreadPoolExecutor=PortalExecutorManagerUtil.registerPortalExecutor(getName(),threadPoolExecutor);
    if (oldThreadPoolExecutor != null) {
      if (_log.isWarnEnabled()) {
        _log.warn("Abort creating new ThreadPool for Destination : " + getName() + ", reuse previous one.");
      }
      threadPoolExecutor.shutdownNow();
      threadPoolExecutor=oldThreadPoolExecutor;
    }
    _threadPoolExecutor=threadPoolExecutor;
  }
}
