{
  String articleId=result.get("articleId");
  JournalArticle article=_journalArticleService.getArticle(groupId,articleId);
  if (Validator.isNotNull(article.getLayoutUuid())) {
    String groupFriendlyURL=PortalUtil.getGroupFriendlyURL(_layoutSetLocalService.getLayoutSet(article.getGroupId(),false),themeDisplay);
    return groupFriendlyURL.concat(JournalArticleConstants.CANONICAL_URL_SEPARATOR).concat(article.getUrlTitle());
  }
  Layout layout=themeDisplay.getLayout();
  List<Long> hitLayoutIds=_journalContentSearchLocalService.getLayoutIds(layout.getGroupId(),layout.isPrivateLayout(),articleId);
  for (  Long hitLayoutId : hitLayoutIds) {
    PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
    if (LayoutPermissionUtil.contains(permissionChecker,layout.getGroupId(),layout.isPrivateLayout(),hitLayoutId,ActionKeys.VIEW)) {
      Layout hitLayout=_layoutLocalService.getLayout(layout.getGroupId(),layout.isPrivateLayout(),hitLayoutId.longValue());
      return PortalUtil.getLayoutURL(hitLayout,themeDisplay);
    }
  }
  String layoutURL=getLayoutURL(themeDisplay,articleId);
  if (layoutURL != null) {
    return layoutURL;
  }
  AssetEntry assetEntry=AssetEntryLocalServiceUtil.fetchEntry(JournalArticle.class.getName(),article.getResourcePrimKey());
  if (assetEntry == null) {
    return null;
  }
  portletURL.setParameter("assetEntryId",String.valueOf(assetEntry.getEntryId()));
  portletURL.setParameter("groupId",String.valueOf(groupId));
  portletURL.setParameter("articleId",articleId);
  return portletURL.toString();
}
