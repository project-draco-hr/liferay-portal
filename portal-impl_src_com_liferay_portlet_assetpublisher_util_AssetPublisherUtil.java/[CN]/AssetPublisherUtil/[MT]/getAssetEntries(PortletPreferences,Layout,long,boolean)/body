{
  AssetEntryQuery assetEntryQuery=getAssetEntryQuery(preferences,new long[]{scopeGroupId});
  boolean anyAssetType=GetterUtil.getBoolean(preferences.getValue("anyAssetType",null),true);
  if (!anyAssetType) {
    long[] availableClassNameIds=AssetRendererFactoryRegistryUtil.getClassNameIds();
    long[] classNameIds=getClassNameIds(preferences,availableClassNameIds);
    assetEntryQuery.setClassNameIds(classNameIds);
  }
  long[] classTypeIds=GetterUtil.getLongValues(preferences.getValues("classTypeIds",null));
  assetEntryQuery.setClassTypeIds(classTypeIds);
  boolean enablePermissions=GetterUtil.getBoolean(preferences.getValue("enablePermissions",null));
  assetEntryQuery.setEnablePermissions(enablePermissions);
  int rssDelta=GetterUtil.getInteger(preferences.getValue("rssDelta","20"));
  assetEntryQuery.setEnd(rssDelta);
  boolean excludeZeroViewCount=GetterUtil.getBoolean(preferences.getValue("excludeZeroViewCount",null));
  assetEntryQuery.setExcludeZeroViewCount(excludeZeroViewCount);
  long[] groupIds=getGroupIds(preferences,scopeGroupId,layout);
  assetEntryQuery.setGroupIds(groupIds);
  boolean showOnlyLayoutAssets=GetterUtil.getBoolean(preferences.getValue("showOnlyLayoutAssets",null));
  if (showOnlyLayoutAssets) {
    assetEntryQuery.setLayout(layout);
  }
  String orderByColumn1=GetterUtil.getString(preferences.getValue("orderByColumn1","modifiedDate"));
  assetEntryQuery.setOrderByCol1(orderByColumn1);
  String orderByColumn2=GetterUtil.getString(preferences.getValue("orderByColumn2","title"));
  assetEntryQuery.setOrderByCol2(orderByColumn2);
  String orderByType1=GetterUtil.getString(preferences.getValue("orderByType1","DESC"));
  assetEntryQuery.setOrderByType1(orderByType1);
  String orderByType2=GetterUtil.getString(preferences.getValue("orderByType2","ASC"));
  assetEntryQuery.setOrderByType2(orderByType2);
  assetEntryQuery.setStart(0);
  List<AssetEntry> assetEntries=null;
  if (checkPermission) {
    assetEntries=AssetEntryServiceUtil.getEntries(assetEntryQuery);
  }
 else {
    assetEntries=AssetEntryLocalServiceUtil.getEntries(assetEntryQuery);
  }
  return assetEntries;
}
