{
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  DDMTemplate template=DDMTemplateLocalServiceUtil.getTemplate(templateId);
  Map<String,Object> contextObjects=new HashMap<String,Object>();
  contextObjects.put(AssetPublisherConstants.ASSET_ENTRIES,assetEntries);
  if (assetEntries.size() == 1) {
    contextObjects.put(AssetPublisherConstants.ASSET_ENTRY,assetEntries.get(0));
  }
  contextObjects.put(AssetPublisherConstants.LOCALE,renderRequest.getLocale());
  contextObjects.put(AssetPublisherConstants.RENDER_REQUEST,renderRequest);
  contextObjects.put(AssetPublisherConstants.RENDER_RESPONSE,renderResponse);
  contextObjects.put(AssetPublisherConstants.TEMPLATE_HELPER,TemplateHelperUtil.getTemplateHelper());
  contextObjects.put(AssetPublisherConstants.TEMPLATE_ID,templateId);
  contextObjects.put(AssetPublisherConstants.THEME_DISPLAY,themeDisplay);
  return _transformer.transform(themeDisplay,contextObjects,template.getScript(),template.getLanguage());
}
