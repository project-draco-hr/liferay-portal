{
  long[] groupIds=new long[]{scopeGroupId};
  boolean defaultScope=GetterUtil.getBoolean(portletPreferences.getValue("defaultScope",null),true);
  if (!defaultScope) {
    String[] scopeIds=portletPreferences.getValues("scopeIds",new String[]{"group" + StringPool.UNDERLINE + scopeGroupId});
    groupIds=new long[scopeIds.length];
    for (int i=0; i < scopeIds.length; i++) {
      try {
        String[] scopeIdFragments=StringUtil.split(scopeIds[i],CharPool.UNDERLINE);
        if (scopeIdFragments[0].equals("Layout")) {
          long scopeIdLayoutId=GetterUtil.getLong(scopeIdFragments[1]);
          Layout scopeIdLayout=LayoutLocalServiceUtil.getLayout(scopeGroupId,layout.isPrivateLayout(),scopeIdLayoutId);
          Group scopeIdGroup=scopeIdLayout.getScopeGroup();
          groupIds[i]=scopeIdGroup.getGroupId();
        }
 else {
          if (scopeIdFragments[1].equals(GroupConstants.DEFAULT)) {
            groupIds[i]=scopeGroupId;
          }
 else {
            long scopeIdGroupId=GetterUtil.getLong(scopeIdFragments[1]);
            groupIds[i]=scopeIdGroupId;
          }
        }
      }
 catch (      Exception e) {
        continue;
      }
    }
  }
  return groupIds;
}
