{
  boolean defaultScope=GetterUtil.getBoolean(portletPreferences.getValue("defaultScope",null),true);
  if (defaultScope) {
    return new long[]{scopeGroupId};
  }
  long defaultScopeId=GetterUtil.getLong(portletPreferences.getValue("defaultScope",null));
  if (defaultScopeId > 0) {
    return new long[]{defaultScopeId};
  }
  String[] scopeIds=portletPreferences.getValues("scopeIds",new String[]{"group" + StringPool.UNDERLINE + scopeGroupId});
  long[] groupIds=new long[scopeIds.length];
  for (int i=0; i < scopeIds.length; i++) {
    try {
      String[] scopeIdFragments=StringUtil.split(scopeIds[i],CharPool.UNDERLINE);
      if (scopeIdFragments[0].equals("Layout")) {
        long scopeIdLayoutId=GetterUtil.getLong(scopeIdFragments[1]);
        Layout scopeIdLayout=LayoutLocalServiceUtil.getLayout(scopeGroupId,layout.isPrivateLayout(),scopeIdLayoutId);
        Group scopeIdGroup=scopeIdLayout.getScopeGroup();
        groupIds[i]=scopeIdGroup.getGroupId();
      }
 else {
        if (scopeIdFragments[1].equals(GroupConstants.DEFAULT)) {
          groupIds[i]=scopeGroupId;
        }
 else {
          long scopeIdGroupId=GetterUtil.getLong(scopeIdFragments[1]);
          groupIds[i]=scopeIdGroupId;
        }
      }
    }
 catch (    Exception e) {
      continue;
    }
  }
  return groupIds;
}
