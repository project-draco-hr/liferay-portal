{
  User user=UserUtil.findByPrimaryKey(userId);
  if (!Validator.isEmailAddress(emailAddress)) {
    throw new UserEmailAddressException();
  }
 else   if (!User.isDefaultUser(userId)) {
    try {
      if (!user.getEmailAddress().equals(emailAddress)) {
        if (UserUtil.findByC_EA(user.getCompanyId(),emailAddress) != null) {
          throw new DuplicateUserEmailAddressException();
        }
      }
    }
 catch (    NoSuchUserException nsue) {
    }
    String[] reservedEmailAddresses=AdminUtil.getReservedEmailAddresses(user.getCompanyId());
    for (int i=0; i < reservedEmailAddresses.length; i++) {
      if (emailAddress.equalsIgnoreCase(reservedEmailAddresses[i])) {
        throw new ReservedUserEmailAddressException();
      }
    }
  }
  if (!User.isDefaultUser(userId)) {
    if (Validator.isNull(firstName)) {
      throw new ContactFirstNameException();
    }
 else     if (Validator.isNull(lastName)) {
      throw new ContactLastNameException();
    }
  }
  if (Validator.isNotNull(smsSn) && !Validator.isEmailAddress(smsSn)) {
    throw new UserSmsException();
  }
}
