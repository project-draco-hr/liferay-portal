{
  userId=userId.trim().toLowerCase();
  if (!GetterUtil.getBoolean(PropsUtil.get(PropsUtil.USERS_DELETE))) {
    throw new RequiredUserException();
  }
  User user=UserUtil.findByPrimaryKey(userId);
  Group group=user.getGroup();
  if (group != null) {
    GroupLocalServiceUtil.deleteGroup(group.getGroupId());
  }
  ImageLocalUtil.remove(userId);
  PortletPreferencesLocalServiceUtil.deleteAllByUser(userId);
  PasswordTrackerLocalServiceUtil.deleteAll(userId);
  UserIdMapperLocalServiceUtil.deleteAll(userId);
  AddressLocalServiceUtil.deleteAll(user.getCompanyId(),User.class.getName(),userId);
  ABContactLocalServiceUtil.deleteAll(userId);
  ABListLocalServiceUtil.deleteAll(userId);
  DLFileRankLocalServiceUtil.deleteFileRanks(userId);
  MBMessageFlagLocalServiceUtil.deleteFlags(userId);
  ShoppingCartLocalServiceUtil.deleteAll(userId);
  ShoppingItemLocalServiceUtil.deleteAll(userId);
  MailServiceUtil.deleteUser(userId);
  ContactLocalServiceUtil.deleteContact(userId);
  UserUtil.remove(userId);
}
