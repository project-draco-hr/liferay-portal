{
  userId=userId.trim().toLowerCase();
  String liferayUserId=userId;
  try {
    PrincipalFinder principalFinder=(PrincipalFinder)InstancePool.get(PropsUtil.get(PropsUtil.PRINCIPAL_FINDER));
    liferayUserId=principalFinder.toLiferay(userId);
  }
 catch (  Exception e) {
  }
  User user=UserUtil.findByPrimaryKey(liferayUserId);
  Company company=CompanyUtil.findByPrimaryKey(user.getCompanyId());
  try {
    return Encryptor.encrypt(company.getKeyObj(),userId);
  }
 catch (  EncryptorException ee) {
    throw new SystemException(ee);
  }
}
