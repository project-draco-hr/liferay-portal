{
  if (!PrefsPropsUtil.getBoolean(user.getCompanyId(),PropsUtil.ADMIN_EMAIL_USER_ADDED_ENABLED)) {
    return;
  }
  try {
    String companyId=user.getCompanyId();
    Company company=CompanyUtil.findByPrimaryKey(companyId);
    String fromName=PrefsPropsUtil.getString(companyId,PropsUtil.ADMIN_EMAIL_FROM_NAME);
    String fromAddress=PrefsPropsUtil.getString(companyId,PropsUtil.ADMIN_EMAIL_FROM_ADDRESS);
    String toName=user.getFullName();
    String toAddress=user.getEmailAddress();
    String subject=PrefsPropsUtil.getString(companyId,PropsUtil.ADMIN_EMAIL_USER_ADDED_SUBJECT);
    String body=PrefsPropsUtil.getString(companyId,PropsUtil.ADMIN_EMAIL_USER_ADDED_BODY);
    subject=StringUtil.replace(subject,new String[]{"[$FROM_ADDRESS$]","[$FROM_NAME$]","[$PORTAL_URL$]","[$TO_ADDRESS$]","[$TO_NAME$]","[$USER_ID$]","[$USER_PASSWORD$]"},new String[]{fromAddress,fromName,company.getPortalURL(),toAddress,toName,user.getUserId(),password});
    body=StringUtil.replace(body,new String[]{"[$FROM_ADDRESS$]","[$FROM_NAME$]","[$PORTAL_URL$]","[$TO_ADDRESS$]","[$TO_NAME$]","[$USER_ID$]","[$USER_PASSWORD$]"},new String[]{fromAddress,fromName,company.getPortalURL(),toAddress,toName,user.getUserId(),password});
    InternetAddress from=new InternetAddress(fromAddress,fromName);
    InternetAddress to=new InternetAddress(toAddress,toName);
    MailMessage message=new MailMessage(from,to,subject,body,true);
    MailServiceUtil.sendEmail(message);
  }
 catch (  IOException ioe) {
    throw new SystemException(ioe);
  }
}
