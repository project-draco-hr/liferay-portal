{
  if (!AdminUtil.getEmailUserAddedEnabled(user.getCompanyId())) {
    return;
  }
  try {
    String companyId=user.getCompanyId();
    Company company=CompanyUtil.findByPrimaryKey(companyId);
    String fromName=AdminUtil.getEmailFromName(companyId);
    String fromAddress=AdminUtil.getEmailFromAddress(companyId);
    String toName=user.getFullName();
    String toAddress=user.getEmailAddress();
    String subject=AdminUtil.getEmailUserAddedSubject(companyId);
    String body=AdminUtil.getEmailUserAddedBody(companyId);
    subject=StringUtil.replace(subject,new String[]{"[$FROM_ADDRESS$]","[$FROM_NAME$]","[$PORTAL_URL$]","[$TO_ADDRESS$]","[$TO_NAME$]","[$USER_ID$]","[$USER_PASSWORD$]"},new String[]{fromAddress,fromName,company.getPortalURL(),toAddress,toName,user.getUserId(),password});
    body=StringUtil.replace(body,new String[]{"[$FROM_ADDRESS$]","[$FROM_NAME$]","[$PORTAL_URL$]","[$TO_ADDRESS$]","[$TO_NAME$]","[$USER_ID$]","[$USER_PASSWORD$]"},new String[]{fromAddress,fromName,company.getPortalURL(),toAddress,toName,user.getUserId(),password});
    InternetAddress from=new InternetAddress(fromAddress,fromName);
    InternetAddress to=new InternetAddress(toAddress,toName);
    MailMessage message=new MailMessage(from,to,subject,body,true);
    MailServiceUtil.sendEmail(message);
  }
 catch (  IOException ioe) {
    throw new SystemException(ioe);
  }
}
