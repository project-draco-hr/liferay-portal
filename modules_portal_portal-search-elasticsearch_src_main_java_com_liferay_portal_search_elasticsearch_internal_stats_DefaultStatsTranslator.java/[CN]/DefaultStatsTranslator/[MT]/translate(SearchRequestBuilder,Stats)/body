{
  if (!stats.isEnabled()) {
    return;
  }
  String field=stats.getField();
  if (stats.isCount()) {
    ValueCountBuilder valueCountBuilder=AggregationBuilders.count(field + "_count");
    valueCountBuilder.field(field);
    searchRequestBuilder.addAggregation(valueCountBuilder);
  }
  if (stats.isMax()) {
    MaxBuilder maxBuilder=AggregationBuilders.max(field + "_max");
    maxBuilder.field(field);
    searchRequestBuilder.addAggregation(maxBuilder);
  }
  if (stats.isMean()) {
    StatsBuilder statsBuilder=AggregationBuilders.stats(field + "_stats");
    statsBuilder.field(field);
    searchRequestBuilder.addAggregation(statsBuilder);
  }
  if (stats.isMin()) {
    MinBuilder minBuilder=AggregationBuilders.min(field + "_min");
    minBuilder.field(field);
    searchRequestBuilder.addAggregation(minBuilder);
  }
  if (stats.isMissing()) {
    MissingBuilder missingBuilder=AggregationBuilders.missing(field + "_missing");
    missingBuilder.field(field);
    searchRequestBuilder.addAggregation(missingBuilder);
  }
  if (stats.isStandardDeviation() || stats.isSumOfSquares()) {
    ExtendedStatsBuilder extendedStatsBuilder=AggregationBuilders.extendedStats(field + "_extendedStats");
    extendedStatsBuilder.field(field);
    searchRequestBuilder.addAggregation(extendedStatsBuilder);
  }
  if (stats.isSum()) {
    SumBuilder sumBuilder=AggregationBuilders.sum(field + "_sum");
    sumBuilder.field(field);
    searchRequestBuilder.addAggregation(sumBuilder);
  }
}
