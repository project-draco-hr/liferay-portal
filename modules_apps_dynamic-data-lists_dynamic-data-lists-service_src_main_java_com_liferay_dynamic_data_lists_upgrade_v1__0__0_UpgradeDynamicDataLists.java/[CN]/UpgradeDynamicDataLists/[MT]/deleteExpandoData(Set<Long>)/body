{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getUpgradeOptimizedConnection();
    ps=con.prepareStatement("select tableId from ExpandoRow where " + getExpandoRowIds(expandoRowIds) + " group by tableId");
    int parameterIndex=1;
    for (    long expandoRowId : expandoRowIds) {
      ps.setLong(parameterIndex++,expandoRowId);
    }
    rs=ps.executeQuery();
    while (rs.next()) {
      long tableId=rs.getLong("tableId");
      runSQL("delete from ExpandoTable where tableId = " + tableId);
      runSQL("delete from ExpandoRow where tableId = " + tableId);
      runSQL("delete from ExpandoColumn where tableId = " + tableId);
      runSQL("delete from ExpandoValue where tableId = " + tableId);
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
