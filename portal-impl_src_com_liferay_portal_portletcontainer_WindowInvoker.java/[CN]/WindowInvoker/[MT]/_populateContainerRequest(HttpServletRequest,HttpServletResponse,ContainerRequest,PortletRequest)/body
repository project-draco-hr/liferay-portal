{
  containerRequest.setRoles(_getRoles(request));
  containerRequest.setUserID(_remoteUser);
  containerRequest.setUserPrincipal(_userPrincipal);
  containerRequest.setLocale(_getLocale(request,portletRequest));
  Map userInfoMap=UserInfoFactory.getUserInfo(_remoteUserId,_portletModel);
  if (_remotePortlet) {
    userInfoMap.remove("user.name.random");
  }
  containerRequest.setUserInfo(userInfoMap);
  containerRequest.setAttribute(WebKeys.THEME_DISPLAY,_getThemeDisplay(portletRequest));
  containerRequest.setAttribute(PortletRequest.CCPP_PROFILE,_getCCPPProfile(request));
  containerRequest.setAttribute(PortletRequestConstants.ESCAPE_XML_VALUE,Boolean.valueOf(PropsValues.PORTLET_URL_ESCAPE_XML));
}
