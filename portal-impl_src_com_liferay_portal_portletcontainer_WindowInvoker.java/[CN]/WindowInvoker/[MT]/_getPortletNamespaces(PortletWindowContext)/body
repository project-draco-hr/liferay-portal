{
  Map<PortletID,List<String>> portletNamespaces=new HashMap<PortletID,List<String>>();
  try {
    List<EntityID> portletEntityIDs=portletWindowContext.getPortletWindows(PortletType.LOCAL,DistributionType.ALL_PORTLETS_ON_PAGE);
    if (portletEntityIDs != null) {
      List<String> namespaces=null;
      for (      EntityID portletEntityID : portletEntityIDs) {
        namespaces=portletNamespaces.get(portletEntityID.getPortletID());
        if (namespaces == null) {
          namespaces=new ArrayList<String>();
          portletNamespaces.put(portletEntityID.getPortletID(),namespaces);
        }
        namespaces.add(PortalUtil.getPortletNamespace(portletEntityID.getPortletWindowName()));
      }
    }
  }
 catch (  PortletWindowContextException ex) {
    _log.warn(ex.toString());
  }
  return portletNamespaces;
}
