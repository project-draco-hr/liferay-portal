{
  String version=ParamUtil.getString(request,"version");
  String prefix=PluginPackageUtil.REPOSITORY_XML_FILENAME_PREFIX + StringPool.DASH;
  String extension=StringPool.PERIOD + PluginPackageUtil.REPOSITORY_XML_FILENAME_EXTENSION;
  if (Validator.isNull(version)) {
    String path=GetterUtil.getString(request.getPathInfo());
    if (Validator.isNotNull(path)) {
      int x=path.indexOf(prefix);
      if (x != -1) {
        version=path.substring(x + prefix.length(),path.indexOf(extension,x));
      }
    }
  }
  if (_log.isDebugEnabled()) {
    if (Validator.isNull(version)) {
      _log.debug("Serving repository for all versions");
    }
 else {
      _log.debug("Serving repository for version " + version);
    }
  }
  return version;
}
