{
  for (  Object object : categoriesAndThreads) {
    if (object instanceof MBThread) {
      MBThread thread=(MBThread)object;
      TrashEntry trashEntry=trashEntryLocalService.fetchEntry(MBThread.class.getName(),thread.getThreadId());
      if (trashEntry != null) {
        continue;
      }
      TrashVersion trashVersion=trashVersionLocalService.fetchVersion(trashEntryId,MBThread.class.getName(),thread.getThreadId());
      int oldStatus=WorkflowConstants.STATUS_APPROVED;
      if (trashVersion != null) {
        oldStatus=trashVersion.getStatus();
      }
      thread.setStatus(oldStatus);
      mbThreadPersistence.update(thread);
      mbThreadLocalService.restoreDependentsFromTrash(user.getUserId(),thread.getThreadId(),trashEntryId);
      if (trashVersion != null) {
        trashVersionLocalService.deleteTrashVersion(trashVersion);
      }
      Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(MBThread.class);
      indexer.reindex(thread);
    }
 else     if (object instanceof MBCategory) {
      MBCategory category=(MBCategory)object;
      TrashEntry trashEntry=trashEntryLocalService.fetchEntry(MBCategory.class.getName(),category.getCategoryId());
      if (trashEntry != null) {
        continue;
      }
      TrashVersion trashVersion=trashVersionLocalService.fetchVersion(trashEntryId,MBCategory.class.getName(),category.getCategoryId());
      int oldStatus=WorkflowConstants.STATUS_APPROVED;
      if (trashVersion != null) {
        oldStatus=trashVersion.getStatus();
      }
      category.setStatus(oldStatus);
      mbCategoryPersistence.update(category);
      restoreDependentFromTrash(user,getCategoriesAndThreads(category.getGroupId(),category.getCategoryId()),trashEntryId);
      if (trashVersion != null) {
        trashVersionLocalService.deleteTrashVersion(trashVersion);
      }
    }
  }
}
