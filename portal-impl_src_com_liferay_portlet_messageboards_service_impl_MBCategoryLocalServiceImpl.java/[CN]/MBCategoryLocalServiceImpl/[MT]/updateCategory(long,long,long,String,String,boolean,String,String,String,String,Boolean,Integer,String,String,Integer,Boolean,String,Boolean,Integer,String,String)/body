{
  validate(name);
  MBCategory category=mbCategoryPersistence.findByPrimaryKey(categoryId);
  parentCategoryId=getParentCategoryId(category,parentCategoryId);
  category.setModifiedDate(new Date());
  category.setParentCategoryId(parentCategoryId);
  category.setName(name);
  category.setDescription(description);
  mbCategoryPersistence.update(category,false);
  if (mergeWithParentCategory && (categoryId != parentCategoryId) && (parentCategoryId != MBCategoryImpl.DEFAULT_PARENT_CATEGORY_ID)) {
    mergeCategories(category,parentCategoryId);
  }
  if (Validator.isNotNull(mailingListAddress) || Validator.isNotNull(mailAddress)) {
    mbMailingLocalService.updateMailing(category.getUserId(),category.getGroupId(),category.getCategoryId(),mailingListAddress,mailAddress,mailInProtocol,mailInServerName,mailInUseSSL,mailInServerPort,mailInUserName,mailInPassword,mailInReadInterval,mailOutConfigured,mailOutServerName,mailOutUseSSL,mailOutServerPort,mailOutUserName,mailOutPassword);
  }
  return category;
}
