{
  StubHttpServletResponse stubHttpServletResponse=new StubHttpServletResponse(){
    @Override public boolean isCommitted(){
      return false;
    }
    @Override public void setCharacterEncoding(    String characterEncoding){
    }
  }
;
  BufferCacheServletResponse bufferCacheServletResponse=new BufferCacheServletResponse(stubHttpServletResponse);
  assertFalse(bufferCacheServletResponse.isByteMode());
  assertFalse(bufferCacheServletResponse.isCharMode());
  bufferCacheServletResponse=new BufferCacheServletResponse(stubHttpServletResponse);
  bufferCacheServletResponse.setByteBuffer(ByteBuffer.wrap(_TEST_BYTES));
  assertTrue(bufferCacheServletResponse.isByteMode());
  assertFalse(bufferCacheServletResponse.isCharMode());
  bufferCacheServletResponse=new BufferCacheServletResponse(stubHttpServletResponse);
  bufferCacheServletResponse.setCharBuffer(CharBuffer.wrap(_TEST_STRING));
  assertFalse(bufferCacheServletResponse.isByteMode());
  assertTrue(bufferCacheServletResponse.isCharMode());
  bufferCacheServletResponse=new BufferCacheServletResponse(stubHttpServletResponse);
  bufferCacheServletResponse.getOutputStream();
  assertTrue(bufferCacheServletResponse.isByteMode());
  assertFalse(bufferCacheServletResponse.isCharMode());
  bufferCacheServletResponse=new BufferCacheServletResponse(stubHttpServletResponse);
  bufferCacheServletResponse.getWriter();
  assertFalse(bufferCacheServletResponse.isByteMode());
  assertTrue(bufferCacheServletResponse.isCharMode());
}
