{
  Session session=null;
  try {
    if (layout.isNew() || layout.isModified()) {
      session=openSession();
      if (layout.isNew()) {
        LayoutHBM layoutHBM=new LayoutHBM();
        layoutHBM.setLayoutId(layout.getLayoutId());
        layoutHBM.setOwnerId(layout.getOwnerId());
        layoutHBM.setCompanyId(layout.getCompanyId());
        layoutHBM.setParentLayoutId(layout.getParentLayoutId());
        layoutHBM.setName(layout.getName());
        layoutHBM.setType(layout.getType());
        layoutHBM.setTypeSettings(layout.getTypeSettings());
        layoutHBM.setHidden(layout.getHidden());
        layoutHBM.setFriendlyURL(layout.getFriendlyURL());
        layoutHBM.setThemeId(layout.getThemeId());
        layoutHBM.setColorSchemeId(layout.getColorSchemeId());
        layoutHBM.setPriority(layout.getPriority());
        session.save(layoutHBM);
        session.flush();
      }
 else {
        LayoutHBM layoutHBM=(LayoutHBM)session.get(LayoutHBM.class,layout.getPrimaryKey());
        if (layoutHBM != null) {
          layoutHBM.setCompanyId(layout.getCompanyId());
          layoutHBM.setParentLayoutId(layout.getParentLayoutId());
          layoutHBM.setName(layout.getName());
          layoutHBM.setType(layout.getType());
          layoutHBM.setTypeSettings(layout.getTypeSettings());
          layoutHBM.setHidden(layout.getHidden());
          layoutHBM.setFriendlyURL(layout.getFriendlyURL());
          layoutHBM.setThemeId(layout.getThemeId());
          layoutHBM.setColorSchemeId(layout.getColorSchemeId());
          layoutHBM.setPriority(layout.getPriority());
          session.flush();
        }
 else {
          layoutHBM=new LayoutHBM();
          layoutHBM.setLayoutId(layout.getLayoutId());
          layoutHBM.setOwnerId(layout.getOwnerId());
          layoutHBM.setCompanyId(layout.getCompanyId());
          layoutHBM.setParentLayoutId(layout.getParentLayoutId());
          layoutHBM.setName(layout.getName());
          layoutHBM.setType(layout.getType());
          layoutHBM.setTypeSettings(layout.getTypeSettings());
          layoutHBM.setHidden(layout.getHidden());
          layoutHBM.setFriendlyURL(layout.getFriendlyURL());
          layoutHBM.setThemeId(layout.getThemeId());
          layoutHBM.setColorSchemeId(layout.getColorSchemeId());
          layoutHBM.setPriority(layout.getPriority());
          session.save(layoutHBM);
          session.flush();
        }
      }
      layout.setNew(false);
      layout.setModified(false);
    }
    return layout;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
