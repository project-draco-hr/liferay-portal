{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection(Constants.DATA_SOURCE);
    ps=con.prepareStatement(_UPGRADE_CATEGORY_1);
    ps.setString(1,Group.DEFAULT_PARENT_GROUP_ID);
    rs=ps.executeQuery();
    while (rs.next()) {
      String groupId=rs.getString("groupId");
      String userId=rs.getString("userId");
      String plid=Layout.PUBLIC + groupId + ".1";
      String parentCategoryId=MBCategory.DEFAULT_PARENT_CATEGORY_ID;
      String name="Default Category";
      String description=name;
      boolean addCommunityPermissions=true;
      boolean addGuestPermissions=true;
      _log.debug("Adding category to group " + groupId);
      MBCategory category=MBCategoryLocalServiceUtil.addCategory(userId,plid,parentCategoryId,name,description,addCommunityPermissions,addGuestPermissions);
      _upgradeCategory(groupId,userId,category.getCategoryId());
    }
  }
 catch (  NoSuchGroupException nsge) {
    _log.error("Upgrade failed because data does not have a valid group id. " + "Manually assign a group id in the database.");
  }
 finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
