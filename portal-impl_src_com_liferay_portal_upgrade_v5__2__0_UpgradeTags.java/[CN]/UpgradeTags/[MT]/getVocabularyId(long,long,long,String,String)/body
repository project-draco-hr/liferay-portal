{
  name=name.trim();
  if (Validator.isNull(name) || ArrayUtil.contains(_DEFAULT_CATEGORY_PROPERTY_VALUES,name)) {
    name=_DEFAULT_TAGS_VOCABULARY;
  }
  String key=groupId + StringPool.UNDERLINE + name;
  Long vocabularyId=_vocabularyIdsMap.get(key);
  if (vocabularyId != null) {
    return vocabularyId.longValue();
  }
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    ps=con.prepareStatement("select vocabularyId from TagsVocabulary where groupId = ? " + "and name = ?");
    ps.setLong(1,groupId);
    ps.setString(2,name);
    rs=ps.executeQuery();
    if (rs.next()) {
      vocabularyId=rs.getLong("vocabularyId");
    }
 else {
      long newVocabularyId=increment();
      vocabularyId=addVocabulary(newVocabularyId,groupId,companyId,userId,userName,name);
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
  _vocabularyIdsMap.put(key,vocabularyId);
  return vocabularyId.longValue();
}
