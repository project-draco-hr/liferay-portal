{
  Folder versioningFolder=getVersioningFolder(companyId,repositoryId,fileName,false);
  if (versioningFolder == null) {
    throw new NoSuchFileException(companyId,repositoryId,fileName,fromVersionLabel);
  }
  Document document=getDocument(versioningFolder,toVersionLabel);
  if (document != null) {
    throw new DuplicateFileException(companyId,repositoryId,fileName,toVersionLabel);
  }
  document=getVersionedDocument(companyId,repositoryId,fileName,fromVersionLabel);
  Map<String,Object> documentProperties=new HashMap<>();
  documentProperties.put(PropertyIds.NAME,toVersionLabel);
  document.updateProperties(documentProperties);
}
