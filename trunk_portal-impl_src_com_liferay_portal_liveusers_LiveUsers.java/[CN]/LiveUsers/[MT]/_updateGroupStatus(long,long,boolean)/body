{
  Map<Long,Set<Long>> liveUsers=_getLiveUsers(companyId);
  LinkedHashMap<String,Object> groupParams=new LinkedHashMap<String,Object>();
  groupParams.put("usersGroups",userId);
  List<Group> groups=GroupLocalServiceUtil.search(companyId,null,null,groupParams,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  Group group : groups) {
    Set<Long> groupUsers=_getGroupUsers(liveUsers,group.getGroupId());
    if (signedIn) {
      groupUsers.add(userId);
    }
 else {
      groupUsers.remove(userId);
    }
  }
  return liveUsers;
}
