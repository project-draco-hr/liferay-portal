{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  String portletId=ParamUtil.getString(actionRequest,"portletId");
  if (!PortletPermissionUtil.contains(permissionChecker,layout,portletId,ActionKeys.CONFIGURATION)) {
    return;
  }
  String languageId=LanguageUtil.getLanguageId(actionRequest);
  String title=ParamUtil.getString(actionRequest,"title");
  PortletPreferences portletSetup=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portletId);
  portletSetup.setValue("portletSetupTitle_" + languageId,title);
  portletSetup.setValue("portletSetupUseCustomTitle","true");
  portletSetup.store();
  PortletSession portletSession=actionRequest.getPortletSession();
  InvokerPortletImpl.clearResponses(portletSession);
}
