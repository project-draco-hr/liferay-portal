{
  if (Validator.isNull(settingsScope) || settingsScope.equals(PortletPreferencesFactoryConstants.SETTINGS_SCOPE_PORTLET_INSTANCE)) {
    return null;
  }
  PortletPreferencesIds portletPreferencesIds=PortletPreferencesFactoryUtil.getPortletPreferencesIds(themeDisplay.getCompanyId(),themeDisplay.getSiteGroupId(),themeDisplay.getPlid(),portletId,settingsScope);
  return PortletPreferencesLocalServiceUtil.getPreferences(portletPreferencesIds);
}
