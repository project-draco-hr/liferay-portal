{
  if (_portalSecurityManagerStrategy != null) {
    return;
  }
  _originalSecurityManager=System.getSecurityManager();
  if (PropsValues.TCK_URL) {
    _portalSecurityManagerStrategy=PortalSecurityManagerStrategy.NONE;
  }
 else {
    _portalSecurityManagerStrategy=PortalSecurityManagerStrategy.parse(PropsValues.PORTAL_SECURITY_MANAGER_STRATEGY);
  }
  if ((_portalSecurityManagerStrategy == PortalSecurityManagerStrategy.LIFERAY) || (_portalSecurityManagerStrategy == PortalSecurityManagerStrategy.SMART)) {
    loadPortalSecurityManager();
    if (_portalSecurityManager == null) {
      _portalSecurityManagerStrategy=PortalSecurityManagerStrategy.DEFAULT;
      if (_log.isInfoEnabled()) {
        _log.info("No portal security manager implementation was " + "located. Continuing with the default security " + "strategy.");
      }
      return;
    }
  }
  if (_portalSecurityManagerStrategy == PortalSecurityManagerStrategy.LIFERAY) {
    System.setSecurityManager((SecurityManager)_portalSecurityManager);
  }
 else   if (_portalSecurityManagerStrategy == PortalSecurityManagerStrategy.NONE) {
    System.setSecurityManager(null);
  }
}
