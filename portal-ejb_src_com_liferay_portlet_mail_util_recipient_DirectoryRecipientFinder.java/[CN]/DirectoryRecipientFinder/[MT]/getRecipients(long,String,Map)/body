{
  SortedSet recipients=new TreeSet();
  data=data.toLowerCase();
  try {
    String optionOrganization=(String)options.get(_OPTION_ORGANIZATION);
    User user=UserLocalServiceUtil.getUserById(userId);
    Organization organization=user.getOrganization();
    LinkedHashMap params=null;
    if ((organization.getOrganizationId() > 0) && (Validator.isNull(optionOrganization) || optionOrganization.equals("my-organization"))) {
      params=new LinkedHashMap();
      params.put("usersOrgs",new Long(organization.getOrganizationId()));
    }
    List results=UserLocalServiceUtil.search(user.getCompanyId(),null,null,null,null,null,true,params,true,0,50,null);
    for (int i=0; i < results.size(); i++) {
      User recipient=(User)results.get(i);
      String str=recipient.getFullName() + StringPool.SPACE + StringPool.LESS_THAN+ recipient.getEmailAddress()+ StringPool.GREATER_THAN;
      if (str.toLowerCase().indexOf(data) != -1) {
        recipients.add(str);
      }
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  return recipients;
}
