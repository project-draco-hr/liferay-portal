{
  IntrabandPortalCacheManager<String,String> intrabandPortalCacheManager=new IntrabandPortalCacheManager<String,String>(_mockRegistrationReference);
  String portalCacheName1="portalCacheName1";
  PortalCache<?,?> portalCache1=intrabandPortalCacheManager.getCache(portalCacheName1);
  String portalCacheName2="portalCacheName2";
  PortalCache<?,?> portalCache2=intrabandPortalCacheManager.getCache(portalCacheName2);
  Map<String,PortalCache<?,?>> portalCaches=getPortalCaches(intrabandPortalCacheManager);
  Assert.assertEquals(2,portalCaches.size());
  Assert.assertSame(portalCache1,portalCaches.get(portalCacheName1));
  Assert.assertSame(portalCache2,portalCaches.get(portalCacheName2));
  intrabandPortalCacheManager.removeCache(portalCacheName1);
  Assert.assertEquals(1,portalCaches.size());
  Assert.assertSame(portalCache2,portalCaches.get(portalCacheName2));
  Datagram datagram=_mockIntraband.getDatagram();
  Assert.assertNotNull(datagram);
  Assert.assertEquals(SystemDataType.PORTAL_CACHE.getValue(),datagram.getType());
  Deserializer deserializer=new Deserializer(datagram.getDataByteBuffer());
  Assert.assertEquals(PortalCacheActionType.REMOVE_CACHE.ordinal(),deserializer.readInt());
  Assert.assertEquals(portalCacheName1,deserializer.readString());
  intrabandPortalCacheManager.clearAll();
  Assert.assertEquals(1,portalCaches.size());
  Assert.assertSame(portalCache2,portalCaches.get(portalCacheName2));
  datagram=_mockIntraband.getDatagram();
  Assert.assertNotNull(datagram);
  Assert.assertEquals(SystemDataType.PORTAL_CACHE.getValue(),datagram.getType());
  deserializer=new Deserializer(datagram.getDataByteBuffer());
  Assert.assertEquals(PortalCacheActionType.CLEAR_ALL.ordinal(),deserializer.readInt());
}
