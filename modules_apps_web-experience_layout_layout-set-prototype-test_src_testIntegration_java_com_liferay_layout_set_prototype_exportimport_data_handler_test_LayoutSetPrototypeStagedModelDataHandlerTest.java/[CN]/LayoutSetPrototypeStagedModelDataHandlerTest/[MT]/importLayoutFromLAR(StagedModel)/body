{
  LayoutSetPrototypeStagedModelDataHandler layoutSetPrototypeStagedModelDataHandler=new LayoutSetPrototypeStagedModelDataHandler();
  String fileName=layoutSetPrototypeStagedModelDataHandler.getLayoutSetPrototypeLARFileName((LayoutSetPrototype)stagedModel);
  String modelPath=ExportImportPathUtil.getModelPath(stagedModel,fileName);
  InputStream inputStream=portletDataContext.getZipEntryAsInputStream(modelPath);
  ZipReader zipReader=ZipReaderFactoryUtil.getZipReader(inputStream);
  Document document=UnsecureSAXReaderUtil.read(zipReader.getEntryAsString("manifest.xml"));
  Element rootElement=document.getRootElement();
  Element layoutElement=rootElement.element("Layout");
  List<Element> elements=layoutElement.elements();
  List<Layout> importedLayouts=new ArrayList<>(elements.size());
  for (  Element element : elements) {
    String layoutPrototypeUuid=element.attributeValue("layout-prototype-uuid");
    if (Validator.isNotNull(layoutPrototypeUuid)) {
      String path=element.attributeValue("path");
      Layout layout=(Layout)portletDataContext.fromXML(zipReader.getEntryAsString(path));
      importedLayouts.add(layout);
    }
  }
  Assert.assertEquals(1,importedLayouts.size());
  try {
    return importedLayouts.get(0);
  }
  finally {
    zipReader.close();
    StreamUtil.cleanUp(inputStream);
  }
}
