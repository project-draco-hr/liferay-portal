{
  String strutsAction=ParamUtil.getString(request,"struts_action");
  long groupId=ParamUtil.getLong(request,"groupId");
  PortletURL portletURL=renderResponse.createRenderURL();
  if (strutsAction.equals("/journal/select_document_library") || strutsAction.equals("/document_library/select_file_entry") || strutsAction.equals("/document_library/select_folder")|| strutsAction.equals("/document_library_display/select_folder")) {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    portletURL.setParameter("struts_action",strutsAction);
    portletURL.setParameter("groupId",String.valueOf(groupId));
    Map<String,Object> data=new HashMap<String,Object>();
    data.put("folder-id",_getDefaultFolderId(request));
    data.put("refresh-folders",Boolean.TRUE.toString());
    if (folder != null) {
      PortalUtil.addPortletBreadcrumbEntry(request,themeDisplay.translate("documents-home"),portletURL.toString(),data);
    }
  }
 else {
    portletURL.setParameter("struts_action","/document_library/view");
  }
  addPortletBreadcrumbEntries(folder,request,portletURL,showGlobally);
}
