{
  String dateString=StringPool.NBSP;
  if (date != null) {
    User user=themeDisplay.getUser();
    Locale locale=themeDisplay.getLocale();
    TimeZone timeZone=themeDisplay.getTimeZone();
    Date today=new Date();
    Calendar cal=Calendar.getInstance(timeZone,locale);
    cal.setTime(today);
    cal.add(Calendar.DATE,-1);
    Date yesterday=cal.getTime();
    DateFormat dateFormatDate=DateFormats.getDate(locale,timeZone);
    DateFormat dateFormatDateTime=DateFormats.getDateTime(locale,timeZone);
    DateFormat dateFormatTime=DateFormats.getTime(locale,timeZone);
    String todayString=dateFormatDate.format(today);
    String yesterdayString=dateFormatDate.format(yesterday);
    dateString=dateFormatDate.format(date);
    if (dateString.equals(todayString)) {
      dateString=LanguageUtil.get(user,"today") + StringPool.SPACE + dateFormatTime.format(date);
    }
 else     if (dateString.equals(yesterdayString)) {
      dateString=LanguageUtil.get(user,"yesterday") + StringPool.SPACE + dateFormatTime.format(date);
    }
 else {
      dateString=dateFormatDateTime.format(date);
    }
  }
  return dateString;
}
