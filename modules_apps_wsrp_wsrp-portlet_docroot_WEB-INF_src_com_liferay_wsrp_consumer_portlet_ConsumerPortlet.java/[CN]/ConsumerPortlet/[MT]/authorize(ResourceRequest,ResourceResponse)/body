{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(resourceRequest);
  HttpServletResponse response=PortalUtil.getHttpServletResponse(resourceResponse);
  String resourceID=GetterUtil.getString(resourceRequest.getResourceID());
  String url=GetterUtil.getString(resourceRequest.getParameter("wsrp-url"));
  String wsrpAuth=GetterUtil.getString(resourceRequest.getParameter("wsrp-auth"));
  StringBundler sb=new StringBundler(4);
  sb.append(resourceID);
  sb.append(url);
  sb.append(PortletPropsValues.SECURE_RESOURCE_URLS_SALT);
  String expectedWsrpAuth=encodeWSRPAuth(resourceRequest,sb.toString());
  if (wsrpAuth.equals(expectedWsrpAuth)) {
    return true;
  }
  sb.append(AuthTokenUtil.getToken(request));
  expectedWsrpAuth=encodeWSRPAuth(resourceRequest,sb.toString());
  if (wsrpAuth.equals(expectedWsrpAuth)) {
    return true;
  }
  response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
  return false;
}
