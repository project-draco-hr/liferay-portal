{
  MBMessageDisplay messageDisplay=MBMessageLocalServiceUtil.getDiscussionMessageDisplay(userId,groupId,className,classPK,WorkflowConstants.STATUS_APPROVED);
  MBThread thread=messageDisplay.getThread();
  long threadId=thread.getThreadId();
  long parentMessageId=thread.getRootMessageId();
  ServiceContext serviceContext=serviceContextFunction.apply(MBMessage.class.getName());
  MBMessage message=MBMessageLocalServiceUtil.addDiscussionMessage(userId,userName,groupId,className,classPK,threadId,parentMessageId,subject,body,serviceContext);
  return message.getMessageId();
}
