{
  if (type.isArray()) {
    Class<?> componentType=type.getComponentType();
    return _formatType(componentType,genericTypes,returnType) + "[]";
  }
  if (type.isPrimitive()) {
    return type.getSimpleName();
  }
  if (type.equals(Boolean.class)) {
    return "boolean";
  }
 else   if (type.equals(Class.class)) {
    if (!returnType) {
      return "string";
    }
  }
 else   if (type.equals(Date.class)) {
    return "long";
  }
 else   if (type.equals(File.class)) {
    if (!returnType) {
      return "file";
    }
 else {
      type=FileData.class;
    }
  }
 else   if (type.equals(Locale.class) || type.equals(String.class) || type.equals(TimeZone.class)) {
    return "string";
  }
 else   if (type.equals(Object.class) || type.equals(Serializable.class)) {
    return "map";
  }
 else   if (ReflectUtil.isTypeOf(type,Number.class)) {
    String typeName=null;
    if (type == Character.class) {
      typeName="char";
    }
 else     if (type == Integer.class) {
      typeName="int";
    }
 else {
      typeName=StringUtil.toLowerCase(type.getSimpleName());
    }
    return typeName;
  }
  String typeName=type.getName();
  if ((type == Collection.class) || ReflectUtil.isTypeOf(type,List.class)) {
    typeName="list";
  }
 else   if (ReflectUtil.isTypeOf(type,Map.class)) {
    typeName="map";
  }
 else {
    if (!_types.contains(type)) {
      _types.add(type);
    }
  }
  if (genericTypes == null) {
    return typeName;
  }
  StringBundler sb=new StringBundler(genericTypes.length * 2 + 1);
  sb.append(StringPool.LESS_THAN);
  for (int i=0; i < genericTypes.length; i++) {
    Class<?> genericType=genericTypes[i];
    if (i != 0) {
      sb.append(StringPool.COMMA);
    }
    if (genericType == null) {
      sb.append(StringPool.STAR);
    }
 else {
      sb.append(_formatType(genericType,null,returnType));
    }
  }
  sb.append(StringPool.GREATER_THAN);
  return typeName + sb.toString();
}
