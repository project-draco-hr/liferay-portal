{
  BatchablePipe<String,Integer> batchablePipe=new BatchablePipe<String,Integer>();
  IncreasableEntry<String,Integer> increasbleEntry1=new IntegerIncreasableEntry("1st",1);
  assertTrue(batchablePipe.put(increasbleEntry1));
  assertTrue(batchablePipe.put(increasbleEntry1));
  assertEquals(increasbleEntry1,batchablePipe.take());
  assertEquals(increasbleEntry1,batchablePipe.take());
  IncreasableEntry<String,Integer> increasbleEntry2=new IntegerIncreasableEntry("2nd",1);
  IncreasableEntry<String,Integer> increasbleEntry3=new IntegerIncreasableEntry("2nd",2);
  assertTrue(batchablePipe.put(increasbleEntry2));
  assertFalse(batchablePipe.put(increasbleEntry3));
  IncreasableEntry<String,Integer> resultIncreasbleEntry=batchablePipe.take();
  assertNotNull(resultIncreasbleEntry);
  assertEquals("2nd",resultIncreasbleEntry.getKey());
  assertEquals(3,(int)resultIncreasbleEntry.getValue());
  assertNull(batchablePipe.take());
  IncreasableEntry<String,Integer> increasbleEntry4=new IntegerIncreasableEntry("3rd",1);
  IncreasableEntry<String,Integer> increasbleEntry5=new IntegerIncreasableEntry("4th",1);
  IncreasableEntry<String,Integer> increasbleEntry6=new IntegerIncreasableEntry("4th",2);
  IncreasableEntry<String,Integer> increasbleEntry7=new IntegerIncreasableEntry("3rd",2);
  IncreasableEntry<String,Integer> increasbleEntry8=new IntegerIncreasableEntry("5th",1);
  assertTrue(batchablePipe.put(increasbleEntry4));
  assertTrue(batchablePipe.put(increasbleEntry5));
  assertFalse(batchablePipe.put(increasbleEntry6));
  assertFalse(batchablePipe.put(increasbleEntry7));
  assertTrue(batchablePipe.put(increasbleEntry8));
  resultIncreasbleEntry=batchablePipe.take();
  assertNotNull(resultIncreasbleEntry);
  assertEquals("3rd",resultIncreasbleEntry.getKey());
  assertEquals(3,(int)resultIncreasbleEntry.getValue());
  resultIncreasbleEntry=batchablePipe.take();
  assertNotNull(resultIncreasbleEntry);
  assertEquals("4th",resultIncreasbleEntry.getKey());
  assertEquals(3,(int)resultIncreasbleEntry.getValue());
  resultIncreasbleEntry=batchablePipe.take();
  assertNotNull(resultIncreasbleEntry);
  assertEquals("5th",resultIncreasbleEntry.getKey());
  assertEquals(1,(int)resultIncreasbleEntry.getValue());
  assertNull(batchablePipe.take());
}
