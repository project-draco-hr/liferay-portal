{
  List<UserNotificationEvent> userNotificationEvents=new ArrayList<UserNotificationEvent>();
  UserNotificationDefinition userNotificationDefinition=UserNotificationManagerUtil.fetchUserNotificationDefinition(portletId,classNameId,notificationType);
  Map<Integer,UserNotificationDeliveryType> userNotificationDeliveryTypes=userNotificationDefinition.getUserNotificationDeliveryTypes();
  for (  Map.Entry<Integer,UserNotificationDeliveryType> entry : userNotificationDeliveryTypes.entrySet()) {
    NotificationEvent notificationEvent=NotificationEventFactoryUtil.createNotificationEvent(System.currentTimeMillis(),portletId,notificationEventJSONObject);
    UserNotificationDeliveryType userNotificationDeliveryType=entry.getValue();
    notificationEvent.setDeliveryType(userNotificationDeliveryType.getType());
    if (!UserNotificationManagerUtil.isDeliver(userId,notificationEvent.getType(),classNameId,notificationType,userNotificationDeliveryType.getType())) {
      continue;
    }
    UserNotificationEvent userNotificationEvent=addUserNotificationEvent(userId,notificationEvent);
    userNotificationEvents.add(userNotificationEvent);
    if (userNotificationDeliveryType.getType() == UserNotificationDeliveryConstants.TYPE_PUSH) {
      sendPushNotitication(userNotificationEvent);
    }
  }
  return userNotificationEvents;
}
