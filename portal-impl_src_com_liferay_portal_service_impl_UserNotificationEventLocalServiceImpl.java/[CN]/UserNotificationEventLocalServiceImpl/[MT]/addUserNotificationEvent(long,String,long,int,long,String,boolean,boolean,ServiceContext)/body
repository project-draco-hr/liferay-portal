{
  User user=userPersistence.findByPrimaryKey(userId);
  long userNotificationEventId=counterLocalService.increment();
  UserNotificationEvent userNotificationEvent=userNotificationEventPersistence.create(userNotificationEventId);
  userNotificationEvent.setUuid(serviceContext.getUuid());
  userNotificationEvent.setCompanyId(user.getCompanyId());
  userNotificationEvent.setUserId(userId);
  userNotificationEvent.setType(type);
  userNotificationEvent.setTimestamp(timestamp);
  userNotificationEvent.setDeliveryType(deliveryType);
  userNotificationEvent.setDeliverBy(deliverBy);
  userNotificationEvent.setDelivered(true);
  userNotificationEvent.setPayload(payload);
  userNotificationEvent.setActionRequired(actionRequired);
  userNotificationEvent.setArchived(archived);
  userNotificationEventPersistence.update(userNotificationEvent);
  return userNotificationEvent;
}
