{
  long[] companyIds=PortalInstances.getCompanyIdsBySQL();
  for (  long companyId : companyIds) {
    UnicodeProperties properties=new UnicodeProperties();
    long[] ldapServerIds=StringUtil.split(PrefsPropsUtil.getString(companyId,"ldap.server.ids"),0L);
    for (    long ldapServerId : ldapServerIds) {
      String postfix=LDAPSettingsUtil.getPropertyPostfix(ldapServerId);
      for (      String key : _LDAP_KEYS) {
        String value=PrefsPropsUtil.getString(companyId,key + postfix,null);
        if (value == null) {
          properties.put(key + postfix,StringPool.BLANK);
        }
      }
    }
    if (!properties.isEmpty()) {
      CompanyLocalServiceUtil.updatePreferences(companyId,properties);
    }
  }
}
