{
  int pos=fileName.indexOf(StringPool.SLASH);
  if (pos != -1) {
    title=fileName.substring(0,pos);
    fileName=fileName.substring(pos + 1);
  }
  WikiPage page=WikiPageServiceUtil.getPage(nodeId,title);
  String path=page.getAttachmentsDir() + "/" + fileName;
  InputStream is=DLLocalServiceUtil.getFileAsStream(page.getCompanyId(),CompanyConstants.SYSTEM,path);
  int contentLength=(int)DLServiceUtil.getFileSize(page.getCompanyId(),CompanyConstants.SYSTEM,path);
  String contentType=MimeTypesUtil.getContentType(fileName);
  ServletResponseUtil.sendFile(request,response,fileName,is,contentLength,contentType);
}
