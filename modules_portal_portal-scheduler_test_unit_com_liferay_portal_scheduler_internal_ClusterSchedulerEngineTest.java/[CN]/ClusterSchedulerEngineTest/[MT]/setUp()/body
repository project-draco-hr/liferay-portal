{
  RegistryUtil.setRegistry(new BasicRegistryImpl());
  Registry registry=RegistryUtil.getRegistry();
  PortalUtil portalUtil=new PortalUtil();
  portalUtil.setPortal(new PortalImpl());
  PortalUUIDUtil portalUUIDUtil=new PortalUUIDUtil();
  portalUUIDUtil.setPortalUUID(new PortalUUIDImpl());
  _mockClusterMasterExecutor=new MockClusterMasterExecutor();
  _mockSchedulerEngine=new MockSchedulerEngine();
  _clusterSchedulerEngine=new ClusterSchedulerEngine(_mockSchedulerEngine);
  _memoryClusteredJobs=ReflectionTestUtil.getFieldValue(_clusterSchedulerEngine,"_memoryClusteredJobs");
  SchedulerEngineHelperImpl schedulerEngineHelperImpl=new SchedulerEngineHelperImpl();
  registry.registerService(SchedulerEngineHelper.class,schedulerEngineHelperImpl);
  schedulerEngineHelperImpl.setSchedulerEngine(_clusterSchedulerEngine);
  Class<? extends ClusterInvokeAcceptor> clusterInvokeAcceptorClass=(Class<? extends ClusterInvokeAcceptor>)Class.forName(SchedulerClusterInvokeAcceptor.class.getName());
  Constructor<? extends ClusterInvokeAcceptor> constructor=clusterInvokeAcceptorClass.getDeclaredConstructor();
  constructor.setAccessible(true);
  _clusterInvokeAcceptor=constructor.newInstance();
}
