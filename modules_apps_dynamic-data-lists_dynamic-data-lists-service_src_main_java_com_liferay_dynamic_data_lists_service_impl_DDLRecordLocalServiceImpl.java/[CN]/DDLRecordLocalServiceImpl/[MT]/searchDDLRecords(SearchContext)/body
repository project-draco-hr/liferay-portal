{
  try {
    Indexer<DDLRecord> indexer=IndexerRegistryUtil.nullSafeGetIndexer(DDLRecord.class);
    Hits hits=indexer.search(searchContext,DDL.SELECTED_FIELD_NAMES);
    List<DDLRecord> records=new ArrayList<>();
    List<Document> documents=hits.toList();
    for (    Document document : documents) {
      long recordId=GetterUtil.getLong(document.get(com.liferay.portal.kernel.search.Field.ENTRY_CLASS_PK));
      try {
        DDLRecord record=getRecord(recordId);
        records.add(record);
      }
 catch (      NoSuchRecordException nsre) {
        if (_log.isWarnEnabled()) {
          _log.warn("DDL record index is stale and contains record " + recordId,nsre);
        }
        long companyId=GetterUtil.getLong(document.get(com.liferay.portal.kernel.search.Field.COMPANY_ID));
        indexer.delete(companyId,document.getUID());
      }
    }
    return new BaseModelSearchResult<>(records,hits.getLength());
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
