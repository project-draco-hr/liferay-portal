{
  String pathInfo=null;
  if (request.getAttribute(RequestDispatcher.INCLUDE_REQUEST_URI) != null) {
    pathInfo=(String)request.getAttribute(RequestDispatcher.INCLUDE_PATH_INFO);
  }
 else {
    pathInfo=request.getPathInfo();
  }
  if (pathInfo == null) {
    return true;
  }
  if (pathInfo.startsWith("/")) {
    pathInfo=pathInfo.substring(1);
  }
  if (pathInfo.startsWith("META-INF/") || pathInfo.startsWith("OSGI-INF/") || pathInfo.startsWith("OSGI-OPT/")|| pathInfo.startsWith("WEB-INF/")) {
    try {
      response.sendError(HttpServletResponse.SC_FORBIDDEN,pathInfo);
    }
 catch (    IOException ioe) {
      response.setStatus(HttpServletResponse.SC_FORBIDDEN);
    }
    return false;
  }
  return true;
}
