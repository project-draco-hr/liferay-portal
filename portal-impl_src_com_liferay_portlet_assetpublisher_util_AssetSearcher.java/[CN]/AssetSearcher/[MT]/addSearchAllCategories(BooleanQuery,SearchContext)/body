{
  if (_assetEntryQuery.getAllCategoryIds().length <= 0) {
    return;
  }
  BooleanQuery categoryIdsQuery=BooleanQueryFactoryUtil.create(searchContext);
  for (  long categoryId : _assetEntryQuery.getAllCategoryIds()) {
    List<Long> treeCategoryIds=new ArrayList<Long>();
    if (PropsValues.ASSET_CATEGORIES_SEARCH_HIERARCHICAL) {
      treeCategoryIds=AssetCategoryLocalServiceUtil.getSubcategoryIds(categoryId);
    }
    if (treeCategoryIds.size() <= 0) {
      treeCategoryIds.add(categoryId);
    }
    BooleanQuery categoryIdQuery=BooleanQueryFactoryUtil.create(searchContext);
    for (    long treeCategoryId : treeCategoryIds) {
      categoryIdQuery.addTerm(Field.ASSET_CATEGORY_IDS,treeCategoryId);
    }
    categoryIdsQuery.add(categoryIdQuery,BooleanClauseOccur.MUST);
  }
  contextQuery.add(categoryIdsQuery,BooleanClauseOccur.MUST);
}
