{
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  long[] anyTagIds=_assetEntryQuery.getAnyTagIds();
  if (anyTagIds.length == 0) {
    return;
  }
  long[] filteredAnyTagIds=AssetUtil.filterTagIds(permissionChecker,anyTagIds);
  if (filteredAnyTagIds.length == 0) {
    contextQuery.addTerm(Field.ASSET_TAG_IDS,"-1",false,BooleanClauseOccur.MUST);
    return;
  }
  BooleanQuery tagIdsQuery=BooleanQueryFactoryUtil.create(searchContext);
  for (  long tagId : anyTagIds) {
    tagIdsQuery.addTerm(Field.ASSET_TAG_IDS,tagId);
  }
  contextQuery.add(tagIdsQuery,BooleanClauseOccur.MUST);
}
