{
  System.setProperty(FinalizeManager.class.getName() + ".thread.enabled",StringPool.FALSE);
  Map<String,Object> map=new WeakValueConcurrentHashMap<String,Object>();
  String testKey="testKey";
  Object testValue=new Object();
  map.put(testKey,testValue);
  GCUtil.gc();
  Assert.assertTrue(map.containsKey(testKey));
  testValue=null;
  GCUtil.gc();
  if (!FinalizeManager.THREAD_ENABLED) {
    FinalizeManager.register(new Object(),new DummyFinalizeAction(),FinalizeManager.WEAK_REFERENCE_FACTORY);
  }
  Assert.assertFalse(map.containsKey(testKey));
}
