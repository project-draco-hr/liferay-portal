{
  MBMailingList mailingList=null;
  try {
    mailingList=MBMailingListLocalServiceUtil.getCategoryMailingList(groupId,categoryId);
  }
 catch (  NoSuchMailingListException nsmle) {
    return;
  }
  if (!mailingList.isActive()) {
    return;
  }
  subscriptionSender.setFrom(mailingList.getOutEmailAddress(),null);
  if (mailingList.isOutCustom()) {
    String protocol=Account.PROTOCOL_SMTP;
    if (mailingList.isOutUseSSL()) {
      protocol=Account.PROTOCOL_SMTPS;
    }
    SMTPAccount smtpAccount=(SMTPAccount)Account.getInstance(protocol,mailingList.getOutServerPort());
    smtpAccount.setHost(mailingList.getOutServerName());
    smtpAccount.setUser(mailingList.getOutUserName());
    smtpAccount.setPassword(mailingList.getOutPassword());
    subscriptionSender.setSMTPAccount(smtpAccount);
  }
  subscriptionSender.setSubject(subject);
  subscriptionSender.notifyRuntimeSubscribers(mailingList.getEmailAddress(),mailingList.getEmailAddress());
}
