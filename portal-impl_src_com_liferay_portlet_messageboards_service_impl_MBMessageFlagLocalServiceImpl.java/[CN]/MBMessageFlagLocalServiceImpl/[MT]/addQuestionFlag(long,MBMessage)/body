{
  User user=userPersistence.findByPrimaryKey(userId);
  if (user.isDefaultUser()) {
    return;
  }
  if (message.getUserId() == userId) {
    MBMessageFlag messageFlag=mbMessageFlagPersistence.fetchByU_M_F(userId,message.getMessageId(),MBMessageFlagImpl.QUESTION_FLAG);
    if (messageFlag == null) {
      long messageFlagId=counterLocalService.increment();
      messageFlag=mbMessageFlagPersistence.create(messageFlagId);
    }
    messageFlag.setUserId(userId);
    messageFlag.setMessageId(message.getMessageId());
    messageFlag.setFlag(MBMessageFlagImpl.QUESTION_FLAG);
    mbMessageFlagPersistence.update(messageFlag,false);
  }
}
