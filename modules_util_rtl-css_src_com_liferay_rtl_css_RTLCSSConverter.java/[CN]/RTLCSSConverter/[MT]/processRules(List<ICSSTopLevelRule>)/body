{
  StringBuilder sb=new StringBuilder();
  for (  ICSSTopLevelRule rule : rules) {
    if (rule instanceof CSSStyleRule) {
      CSSStyleRule styleRule=(CSSStyleRule)rule;
      processRule(styleRule);
    }
 else     if (rule instanceof CSSMediaRule) {
      CSSMediaRule mediaRule=(CSSMediaRule)rule;
      processRules(mediaRule.getAllRules());
    }
    if (rule instanceof CSSUnknownRule) {
      String css=rule.getAsCSSString(_settings,1);
      sb.append(css.replace("@noflip ",""));
    }
 else {
      sb.append(rule.getAsCSSString(_settings,1));
    }
  }
  return sb.toString();
}
