{
  pluginId=PortalUtil.getJsSafePortletId(pluginId);
  PluginSetting pluginSetting=pluginSettingPersistence.fetchByC_I_T(companyId,pluginId,pluginType);
  if (pluginSetting == null) {
    long pluginSettingId=counterLocalService.increment();
    pluginSetting=pluginSettingPersistence.create(pluginSettingId);
    pluginSetting.setCompanyId(companyId);
    pluginSetting.setPluginId(pluginId);
    pluginSetting.setPluginType(pluginType);
  }
  pluginSetting.setRoles(roles);
  pluginSetting.setActive(active);
  pluginSettingPersistence.update(pluginSetting,false);
  return pluginSetting;
}
