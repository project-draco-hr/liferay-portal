{
  List<AssetTag> tags=new ArrayList<AssetTag>();
  for (  String name : names) {
    AssetTag tag=null;
    try {
      tag=getTag(groupId,name);
    }
 catch (    NoSuchTagException nste1) {
      ServiceContext serviceContext=new ServiceContext();
      serviceContext.setAddGroupPermissions(true);
      serviceContext.setAddGuestPermissions(true);
      serviceContext.setScopeGroupId(groupId);
      tag=addTag(userId,name,PropsValues.ASSET_TAG_PROPERTIES_DEFAULT,serviceContext);
      Group group=groupPersistence.findByPrimaryKey(groupId);
      Group companyGroup=groupLocalService.getCompanyGroup(group.getCompanyId());
      try {
        AssetTag companyGroupTag=getTag(companyGroup.getGroupId(),name);
        List<AssetTagProperty> tagProperties=assetTagPropertyLocalService.getTagProperties(companyGroupTag.getTagId());
        for (        AssetTagProperty tagProperty : tagProperties) {
          assetTagPropertyLocalService.addTagProperty(userId,tag.getTagId(),tagProperty.getKey(),tagProperty.getValue());
        }
      }
 catch (      NoSuchTagException nste2) {
      }
    }
    if (tag != null) {
      tags.add(tag);
    }
  }
  return tags;
}
