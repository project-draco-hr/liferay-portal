{
  Locale locale=PortalUtil.getSiteDefaultLocale(groupId);
  String xsd=buildDLRawMetadataXML(RawMetadataProcessorUtil.getFields(),locale);
  Document document=SAXReaderUtil.read(new StringReader(xsd));
  Element rootElement=document.getRootElement();
  List<Element> structureElements=rootElement.elements("structure");
  for (  Element structureElement : structureElements) {
    String name=structureElement.elementText("name");
    String description=structureElement.elementText("description");
    Element structureElementRootElement=structureElement.element("root");
    String structureElementRootXML=structureElementRootElement.asXML();
    DDMStructure ddmStructure=DDMStructureLocalServiceUtil.fetchStructure(groupId,PortalUtil.getClassNameId(RawMetadataProcessor.class),name);
    DDMForm ddmForm=DDMFormXSDDeserializerUtil.deserialize(structureElementRootXML);
    if (ddmStructure != null) {
      ddmStructure.setDDMForm(ddmForm);
      DDMStructureLocalServiceUtil.updateDDMStructure(ddmStructure);
    }
 else {
      Map<Locale,String> nameMap=new HashMap<>();
      nameMap.put(locale,name);
      Map<Locale,String> descriptionMap=new HashMap<>();
      descriptionMap.put(locale,description);
      DDMFormLayout ddmFormLayout=DDMUtil.getDefaultDDMFormLayout(ddmForm);
      DDMStructureLocalServiceUtil.addStructure(userId,groupId,DDMStructureConstants.DEFAULT_PARENT_STRUCTURE_ID,PortalUtil.getClassNameId(RawMetadataProcessor.class),name,nameMap,descriptionMap,ddmForm,ddmFormLayout,StorageType.JSON.toString(),DDMStructureConstants.TYPE_DEFAULT,serviceContext);
    }
  }
}
