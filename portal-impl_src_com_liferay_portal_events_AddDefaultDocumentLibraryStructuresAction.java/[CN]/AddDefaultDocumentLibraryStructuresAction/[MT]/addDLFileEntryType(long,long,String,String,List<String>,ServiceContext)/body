{
  List<Long> ddmStructureIds=new ArrayList<>();
  for (  String ddmStructureName : ddmStructureNames) {
    String ddmStructureKey=ddmStructureName;
    DDMStructure ddmStructure=DDMStructureLocalServiceUtil.fetchStructure(groupId,PortalUtil.getClassNameId(DLFileEntryMetadata.class),ddmStructureKey);
    if (ddmStructure == null) {
      continue;
    }
    ddmStructureIds.add(ddmStructure.getStructureId());
  }
  Locale locale=PortalUtil.getSiteDefaultLocale(groupId);
  String definition=getDynamicDDMStructureDefinition("document-library-structures.xml",languageKey,locale);
  DDMForm ddmForm=DDMFormXSDDeserializerUtil.deserialize(definition);
  serviceContext.setAttribute("ddmForm",ddmForm);
  try {
    DLFileEntryTypeLocalServiceUtil.getFileEntryType(groupId,dlFileEntryTypeKey);
  }
 catch (  NoSuchFileEntryTypeException nsfete) {
    Map<Locale,String> localizationMap=getLocalizationMap(languageKey);
    DLFileEntryTypeLocalServiceUtil.addFileEntryType(userId,groupId,dlFileEntryTypeKey,localizationMap,localizationMap,ArrayUtil.toArray(ddmStructureIds.toArray(new Long[ddmStructureIds.size()])),serviceContext);
  }
}
