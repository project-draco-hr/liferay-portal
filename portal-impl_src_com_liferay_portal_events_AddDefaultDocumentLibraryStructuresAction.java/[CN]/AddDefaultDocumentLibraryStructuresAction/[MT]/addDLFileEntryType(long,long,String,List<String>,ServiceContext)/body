{
  List<Long> ddmStructureIds=new ArrayList<Long>();
  for (  String ddmStructureName : ddmStructureNames) {
    String ddmStructureKey=ddmStructureName;
    DDMStructure ddmStructure=DDMStructureLocalServiceUtil.fetchStructure(groupId,PortalUtil.getClassNameId(DLFileEntryMetadata.class),ddmStructureKey);
    if (ddmStructure == null) {
      continue;
    }
    ddmStructureIds.add(ddmStructure.getStructureId());
  }
  Locale locale=PortalUtil.getSiteDefaultLocale(groupId);
  String definition=getDynamicDDMStructureDefinition("document-library-structures.xml",dlFileEntryTypeKey,locale);
  serviceContext.setAttribute("definition",definition);
  try {
    DLFileEntryTypeLocalServiceUtil.getFileEntryType(groupId,dlFileEntryTypeKey);
  }
 catch (  NoSuchFileEntryTypeException nsfete) {
    Map<Locale,String> localizationMap=getLocalizationMap(dlFileEntryTypeKey);
    DLFileEntryTypeLocalServiceUtil.addFileEntryType(userId,groupId,dlFileEntryTypeKey,localizationMap,localizationMap,ArrayUtil.toArray(ddmStructureIds.toArray(new Long[ddmStructureIds.size()])),serviceContext);
  }
}
