{
  EmbeddedElasticsearchConnection embeddedElasticsearchConnection=new EmbeddedElasticsearchConnection();
  addUnicastSettingsContributor(embeddedElasticsearchConnection);
  preventUnassignedReplicasWithLowSpace(embeddedElasticsearchConnection);
  Props props=Mockito.mock(Props.class);
  Mockito.when(props.get(PropsKeys.LIFERAY_HOME)).thenReturn(_tmpDirName);
  embeddedElasticsearchConnection.setClusterSettingsContext(_clusterSettingsContext);
  embeddedElasticsearchConnection.setProps(props);
  embeddedElasticsearchConnection.activate(_elasticsearchConfigurationProperties);
  embeddedElasticsearchConnection.connect();
  return embeddedElasticsearchConnection;
}
