{
  Client client=_elasticsearchConnection.getClient();
  AdminClient adminClient=client.admin();
  ClusterAdminClient clusterAdminClient=adminClient.cluster();
  ClusterHealthRequestBuilder clusterHealthRequestBuilder=clusterAdminClient.prepareHealth();
  ClusterHealthRequest clusterHealthRequest=clusterHealthRequestBuilder.request();
  clusterHealthRequest.timeout(new TimeValue(10,TimeUnit.MINUTES));
  clusterHealthRequest.waitForActiveShards(healthExpectations.activeShards);
  clusterHealthRequest.waitForNodes(String.valueOf(healthExpectations.numberOfNodes));
  clusterHealthRequest.waitForRelocatingShards(0);
  clusterHealthRequest.waitForStatus(healthExpectations.status);
  ActionFuture<ClusterHealthResponse> health=clusterAdminClient.health(clusterHealthRequest);
  return health.actionGet();
}
