{
  PermissionChecker permissionChecker=getPermissionChecker();
  if (!UsersAdminUtil.hasUpdateEmailAddress(permissionChecker,user)) {
    throw new UserEmailAddressException();
  }
  if (!user.hasCompanyMx() && user.hasCompanyMx(emailAddress)) {
    Company company=companyPersistence.findByPrimaryKey(user.getCompanyId());
    if (!company.isStrangersWithMx()) {
      throw new ReservedUserEmailAddressException();
    }
  }
}
