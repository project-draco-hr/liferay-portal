{
  String xml=null;
  Document doc=DocumentHelper.createDocument();
  Element request=doc.addElement("request");
  DocUtil.add(request,"container-type","portlet");
  DocUtil.add(request,"container-namespace",req.getContextPath());
  DocUtil.add(request,"content-type",req.getResponseContentType());
  DocUtil.add(request,"server-name",req.getServerName());
  DocUtil.add(request,"server-port",req.getServerPort());
  DocUtil.add(request,"secure",req.isSecure());
  DocUtil.add(request,"auth-type",req.getAuthType());
  DocUtil.add(request,"remote-user",req.getRemoteUser());
  DocUtil.add(request,"context-path",req.getContextPath());
  DocUtil.add(request,"locale",req.getLocale());
  DocUtil.add(request,"portlet-mode",req.getPortletMode());
  DocUtil.add(request,"portlet-session-id",req.getRequestedSessionId());
  DocUtil.add(request,"scheme",req.getScheme());
  DocUtil.add(request,"window-state",req.getWindowState());
  if (req instanceof RenderRequest) {
    DocUtil.add(request,"action",Boolean.FALSE);
  }
 else   if (req instanceof ActionRequest) {
    DocUtil.add(request,"action",Boolean.TRUE);
  }
  if (res instanceof RenderResponse) {
    _toXML((RenderResponse)res,request);
  }
  Element parameters=request.addElement("parameters");
  Enumeration enu=req.getParameterNames();
  while (enu.hasMoreElements()) {
    String name=(String)enu.nextElement();
    Element parameter=parameters.addElement("parameter");
    DocUtil.add(parameter,"name",name);
    String[] values=req.getParameterValues(name);
    for (int i=0; i < values.length; i++) {
      DocUtil.add(parameter,"value",values[i]);
    }
  }
  try {
    xml=XMLFormatter.toString(doc);
  }
 catch (  IOException ioe) {
  }
  return xml;
}
