{
  Collection<MailAccount> cachedAccounts=MailCache.getUserAccounts(user.getUserId());
  if (cachedAccounts != null) {
    return cachedAccounts;
  }
  try {
    AccountFinder accountFinder=AccountFinderLocator.getAccountFinderInstance();
    Collection<MailAccount> accounts=accountFinder.findAllAccounts(user,password);
    MailCache.putUserAccounts(user.getUserId(),accounts);
    return accounts;
  }
 catch (  MailAccountsException mae) {
    _log.error("Error trying to get all accounts for user " + user.getUserId(),mae);
    return new ArrayList<MailAccount>();
  }
}
