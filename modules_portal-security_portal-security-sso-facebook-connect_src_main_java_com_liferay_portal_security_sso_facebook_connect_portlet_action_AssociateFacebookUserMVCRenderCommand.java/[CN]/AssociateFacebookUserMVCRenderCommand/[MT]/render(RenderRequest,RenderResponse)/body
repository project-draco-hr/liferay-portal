{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (!_facebookConnect.isEnabled(themeDisplay.getCompanyId())) {
    throw new PortletException(new PrincipalException.MustBeEnabled(themeDisplay.getCompanyId(),FacebookConnect.class.getName()));
  }
  HttpServletRequest httpServletRequest=PortalUtil.getOriginalServletRequest(PortalUtil.getHttpServletRequest(request));
  HttpSession session=httpServletRequest.getSession(true);
  long facebookIncompleteUserId=ParamUtil.getLong(request,"userId");
  if (!Validator.isNull(facebookIncompleteUserId)) {
    User user=_userLocalService.fetchUser(facebookIncompleteUserId);
    return renderUpdateAccount(request,user);
  }
  return "/login.jsp";
}
