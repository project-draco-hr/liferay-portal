{
  System.out.println("Starting " + ReleaseInfo.getReleaseInfo());
  if (_log.isDebugEnabled()) {
    _log.debug("Clear locks");
  }
  try {
    LockLocalServiceUtil.clear();
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Unable to clear locks because Lock table does not exist");
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Add shutdown hook");
  }
  Runtime.getRuntime().addShutdownHook(new Thread(new ShutdownHook()));
  if ((System.getSecurityManager() == null) && (PropsValues.PORTAL_SECURITY_MANAGER_ENABLE)) {
    System.setSecurityManager(new PortalSecurityManager());
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Initialize FreeMarker engine");
  }
  FreeMarkerEngineUtil.init();
  if (_log.isDebugEnabled()) {
    _log.debug("Initialize Velocity engine");
  }
  VelocityEngineUtil.init();
  if (_log.isDebugEnabled()) {
    _log.debug("Upgrade database");
  }
  DBUpgrader.upgrade();
  if (_log.isDebugEnabled()) {
    _log.debug("Initialize message bus");
  }
  MessageBus messageBus=(MessageBus)PortalBeanLocatorUtil.locate(MessageBus.class.getName());
  MessageSender messageSender=(MessageSender)PortalBeanLocatorUtil.locate(MessageSender.class.getName());
  SynchronousMessageSender synchronousMessageSender=(SynchronousMessageSender)PortalBeanLocatorUtil.locate(SynchronousMessageSender.class.getName());
  MessageBusUtil.init(messageBus,messageSender,synchronousMessageSender);
  if (_log.isDebugEnabled()) {
    _log.debug("Initialize scheduler engine");
  }
  SchedulerEngineUtil.init(new SchedulerEngineProxy());
  SchedulerEngineUtil.start();
  if (_log.isDebugEnabled()) {
    _log.debug("Verify database");
  }
  DBUpgrader.verify();
}
