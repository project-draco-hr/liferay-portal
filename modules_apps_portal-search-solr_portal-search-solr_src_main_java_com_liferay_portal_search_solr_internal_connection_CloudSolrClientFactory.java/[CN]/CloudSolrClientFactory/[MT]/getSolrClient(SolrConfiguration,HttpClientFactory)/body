{
  String zkHost=solrConfiguration.zkHost();
  if (Validator.isNull(zkHost)) {
    throw new IllegalStateException("Must configure Zookeeper host");
  }
  HttpClient httpClient=httpClientFactory.createInstance();
  CloudSolrClient cloudSolrClient=new CloudSolrClient(zkHost,httpClient);
  String defaultCollection=solrConfiguration.defaultCollection();
  if (Validator.isNull(defaultCollection)) {
    throw new IllegalStateException("Must configure default collection name");
  }
  cloudSolrClient.setDefaultCollection(defaultCollection);
  return cloudSolrClient;
}
