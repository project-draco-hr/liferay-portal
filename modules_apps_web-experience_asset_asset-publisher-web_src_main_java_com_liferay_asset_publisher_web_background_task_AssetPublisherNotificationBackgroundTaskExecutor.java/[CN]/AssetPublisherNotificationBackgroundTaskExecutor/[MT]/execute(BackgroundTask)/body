{
  BackgroundTaskResult backgroundTaskResult=new BackgroundTaskResult();
  Map<String,Serializable> taskContextMap=backgroundTask.getTaskContextMap();
  List<AssetEntry> assetEntries=(List<AssetEntry>)taskContextMap.get("assetEntries");
  com.liferay.portal.kernel.model.PortletPreferences portletPreferencesModel=(com.liferay.portal.kernel.model.PortletPreferences)taskContextMap.get("portletPreferences");
  notifySubscribers(assetEntries,portletPreferencesModel);
  PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromXML(portletPreferencesModel.getCompanyId(),portletPreferencesModel.getOwnerId(),portletPreferencesModel.getOwnerType(),portletPreferencesModel.getPlid(),portletPreferencesModel.getPortletId(),portletPreferencesModel.getPreferences());
  try {
    portletPreferences.setValues("notifiedAssetEntryIds",StringUtil.split(ListUtil.toString(assetEntries,AssetEntry.ENTRY_ID_ACCESSOR)));
    portletPreferences.store();
    backgroundTaskResult.setStatus(BackgroundTaskConstants.STATUS_SUCCESSFUL);
  }
 catch (  IOException ioe) {
    backgroundTaskResult.setStatus(BackgroundTaskConstants.STATUS_FAILED);
    throw new SystemException(ioe);
  }
catch (  PortletException pe) {
    backgroundTaskResult.setStatus(BackgroundTaskConstants.STATUS_FAILED);
    throw new SystemException(pe);
  }
  return backgroundTaskResult;
}
