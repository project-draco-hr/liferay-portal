{
  if (PropsValues.CAPTCHA_MAX_CHALLENGES > 0) {
    HttpSession session=request.getSession();
    Integer count=(Integer)session.getAttribute(WebKeys.CAPTCHA_COUNT);
    if (count != null && count >= PropsValues.CAPTCHA_MAX_CHALLENGES) {
      throw new CaptchaMaxChallengesExceededException();
    }
    if ((count != null) && (PropsValues.CAPTCHA_MAX_CHALLENGES <= count.intValue())) {
      return false;
    }
 else {
      return true;
    }
  }
 else   if (PropsValues.CAPTCHA_MAX_CHALLENGES < 0) {
    return false;
  }
 else {
    return true;
  }
}
