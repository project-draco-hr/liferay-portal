{
  HttpSession session=request.getSession();
  String captchaText=(String)session.getAttribute(WebKeys.CAPTCHA_TEXT);
  if (captchaText == null) {
    _log.error("CAPTCHA text is null. User " + request.getRemoteUser() + " may be trying to circumvent the CAPTCHA.");
    throw new CaptchaTextException();
  }
  boolean valid=captchaText.equals(ParamUtil.getString(request,"captchaText"));
  if (valid) {
    session.removeAttribute(WebKeys.CAPTCHA_TEXT);
  }
  return valid;
}
