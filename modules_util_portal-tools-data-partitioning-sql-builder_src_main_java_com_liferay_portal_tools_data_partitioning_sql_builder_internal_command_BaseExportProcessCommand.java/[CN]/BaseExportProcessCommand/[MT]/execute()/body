{
  String outputFileName=getOutputFileName();
  File outputFile=new File(exportContext.getOutputDirName(),outputFileName);
  OutputStream outputStream=null;
  if (!exportContext.isWriteFile()) {
    outputStream=new BufferedOutputStream(new FileOutputStream(outputFile));
  }
  for (  String tableName : tableNames) {
    if (exportContext.isWriteFile()) {
      outputFileName=getOutputFileName(tableName);
      outputFile=new File(exportContext.getOutputDirName(),outputFileName);
      outputStream=new BufferedOutputStream(new FileOutputStream(outputFile));
    }
    write(tableName,outputStream);
    outputStream.flush();
    if (exportContext.isWriteFile()) {
      outputStream.close();
    }
  }
  if (!exportContext.isWriteFile()) {
    outputStream.close();
  }
}
