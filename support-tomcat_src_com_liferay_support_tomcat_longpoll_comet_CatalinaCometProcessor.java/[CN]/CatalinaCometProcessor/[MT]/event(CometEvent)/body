{
  CometEvent.EventType type=cometEvent.getEventType();
  if (_log.isDebugEnabled()) {
    _log.debug("Comet event triggered, event type: " + type);
  }
  String sessionId=cometEvent.getHttpServletRequest().getSession().getId();
  try {
    if (type.equals(CometEvent.EventType.BEGIN)) {
      constructCometHandler(sessionId,cometEvent);
    }
 else     if (type.equals(CometEvent.EventType.END) || type.equals(CometEvent.EventType.ERROR)) {
      if (_log.isInfoEnabled()) {
        logCometSessionEventSubType(sessionId,cometEvent.getEventSubType());
      }
      closeConnection(sessionId,cometEvent);
    }
 else     if (type.equals(CometEvent.EventType.READ)) {
      String data=readData(sessionId,cometEvent);
      if (_log.isDebugEnabled()) {
        _log.debug("Read: " + data);
      }
      processData(sessionId,data);
    }
  }
 catch (  Exception e) {
    throw new ServletException(e);
  }
}
