{
  String rootPortletId=PortletConstants.getRootPortletId(portletId);
  Set<String> whitelist=getPortletCSRFWhitelist();
  if (whitelist.contains(rootPortletId)) {
    return true;
  }
  if (Validator.isNotNull(strutsAction)) {
    Set<String> whitelistActions=getPortletCSRFWhitelistActions();
    if (whitelistActions.contains(strutsAction) && isValidStrutsAction(companyId,rootPortletId,strutsAction)) {
      return true;
    }
  }
  return false;
}
