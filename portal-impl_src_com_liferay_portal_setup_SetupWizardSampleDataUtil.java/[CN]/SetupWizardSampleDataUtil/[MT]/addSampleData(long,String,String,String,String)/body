{
  StopWatch stopWatch=new StopWatch();
  stopWatch.start();
  if (_log.isInfoEnabled()) {
    _log.info("Adding sample data");
  }
  Company company=updateCompany(CompanyLocalServiceUtil.getCompanyById(companyId),companyName,LocaleUtil.toLanguageId(LocaleUtil.getDefault()));
  User defaultUser=company.getDefaultUser();
  Account account=company.getAccount();
  Organization organization=OrganizationLocalServiceUtil.addOrganization(defaultUser.getUserId(),OrganizationConstants.DEFAULT_PARENT_ORGANIZATION_ID,account.getLegalName(),true);
  GroupLocalServiceUtil.updateFriendlyURL(organization.getGroupId(),"/main");
  String extranetName=account.getLegalName() + " Extranet";
  Layout extranetLayout=LayoutLocalServiceUtil.addLayout(defaultUser.getUserId(),organization.getGroupId(),false,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,extranetName,null,null,LayoutConstants.TYPE_PORTLET,false,"/extranet",new ServiceContext());
  LayoutLocalServiceUtil.updateLayout(extranetLayout.getGroupId(),false,extranetLayout.getLayoutId(),extranetLayout.getTypeSettings());
  String intranetName=account.getLegalName() + " Intranet";
  Layout intranetLayout=LayoutLocalServiceUtil.addLayout(defaultUser.getUserId(),organization.getGroupId(),true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,intranetName,null,null,LayoutConstants.TYPE_PORTLET,false,"/intranet",new ServiceContext());
  LayoutLocalServiceUtil.updateLayout(intranetLayout.getGroupId(),true,intranetLayout.getLayoutId(),intranetLayout.getTypeSettings());
  User user=UserLocalServiceUtil.fetchUserByEmailAddress(company.getCompanyId(),userEmailAddress);
  ScreenNameGenerator screenNameGenerator=ScreenNameGeneratorFactory.getInstance();
  String screenName=GetterUtil.getString(PropsValues.DEFAULT_ADMIN_EMAIL_ADDRESS_PREFIX,"test");
  try {
    screenName=screenNameGenerator.generate(0,0,userEmailAddress);
  }
 catch (  Exception e) {
  }
  if (user == null) {
    user=UserLocalServiceUtil.addDefaultAdminUser(companyId,screenName,userEmailAddress,LocaleUtil.getDefault(),userFirstName,StringPool.BLANK,userLastName);
  }
 else {
    user.setScreenName(screenName);
    user.setGreeting("Welcome " + userFirstName + " "+ userLastName+ "!");
    user.setFirstName(userFirstName);
    user.setLastName(userLastName);
  }
  user.setPasswordReset(false);
  UserLocalServiceUtil.updateUser(user);
  OrganizationLocalServiceUtil.addUserOrganization(user.getUserId(),organization);
  addOrganizations(companyName,defaultUser,organization);
  if (_log.isInfoEnabled()) {
    _log.info("Finished adding data in " + stopWatch.getTime() + " ms");
  }
}
