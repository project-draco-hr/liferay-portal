{
  InputStream is=null;
  try {
    long eventId=ParamUtil.getLong(req,"eventId");
    File file=CalEventLocalServiceUtil.export(eventId);
    is=new BufferedInputStream(new FileInputStream(file));
    ServletResponseUtil.sendFile(res,file.getName(),is);
    return null;
  }
 catch (  Exception e) {
    req.setAttribute(PageContext.EXCEPTION,e);
    return mapping.findForward(Constants.COMMON_ERROR);
  }
 finally {
    ServletResponseUtil.cleanUp(is);
  }
}
