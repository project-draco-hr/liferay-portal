{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    ps=con.prepareStatement("select lockId, key_ from Lock_ where className = ?");
    ps.setString(1,DLFileEntry.class.getName());
    rs=ps.executeQuery();
    while (rs.next()) {
      long lockId=rs.getLong("lockId");
      String key=rs.getString("key_");
      String[] keyArray=StringUtil.split(key,StringPool.POUND);
      if (keyArray.length != 3) {
        continue;
      }
      long groupId=GetterUtil.getLong(keyArray[0]);
      long folderId=GetterUtil.getLong(keyArray[1]);
      String name=keyArray[2];
      long fileEntryId=getFileEntryId(groupId,folderId,name);
      if (fileEntryId > 0) {
        runSQL("update Lock_ set key_ = " + fileEntryId + " where lockId = "+ lockId);
      }
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
