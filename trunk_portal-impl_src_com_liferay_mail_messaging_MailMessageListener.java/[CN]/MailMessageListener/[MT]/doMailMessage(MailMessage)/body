{
  InternetAddress[] auditTrail=InternetAddress.parse(PropsValues.MAIL_AUDIT_TRAIL);
  if (auditTrail.length > 0) {
    InternetAddress[] bcc=mailMessage.getBCC();
    if (bcc != null) {
      InternetAddress[] allBCC=new InternetAddress[bcc.length + auditTrail.length];
      ArrayUtil.combine(bcc,auditTrail,allBCC);
      mailMessage.setBCC(allBCC);
    }
 else {
      mailMessage.setBCC(auditTrail);
    }
  }
  InternetAddress from=filterInternetAddress(mailMessage.getFrom());
  if (from == null) {
    return;
  }
 else {
    mailMessage.setFrom(from);
  }
  InternetAddress[] to=filterInternetAddresses(mailMessage.getTo());
  mailMessage.setTo(to);
  InternetAddress[] cc=filterInternetAddresses(mailMessage.getCC());
  mailMessage.setCC(cc);
  InternetAddress[] bcc=filterInternetAddresses(mailMessage.getBCC());
  mailMessage.setBCC(bcc);
  InternetAddress[] bulkAddresses=filterInternetAddresses(mailMessage.getBulkAddresses());
  mailMessage.setBulkAddresses(bulkAddresses);
  if (((to != null) && (to.length > 0)) || ((cc != null) && (cc.length > 0)) || ((bcc != null) && (bcc.length > 0))|| ((bulkAddresses != null) && (bulkAddresses.length > 0))) {
    MailEngine.send(mailMessage);
  }
}
