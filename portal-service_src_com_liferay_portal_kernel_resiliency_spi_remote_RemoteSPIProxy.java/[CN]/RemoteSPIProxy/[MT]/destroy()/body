{
  try {
    _spi.destroy();
    _cancelHandlerFuture.get(_spiConfiguration.getShutdownTimeout(),TimeUnit.MILLISECONDS);
  }
 catch (  Exception e) {
    _cancelHandlerFuture.cancel(true);
    if (_log.isWarnEnabled()) {
      _log.warn("Forcibly destroyed SPI " + _spiConfiguration,e);
    }
  }
 finally {
    MPIHelperUtil.unregisterSPI(this);
  }
  _spiAgent.destroy();
}
