{
  StringBuffer sb=new StringBuffer();
  Object[][] columns=getColumns();
  for (int i=0; i < columns.length; i++) {
    boolean last=false;
    if ((i + 1) == columns.length) {
      last=true;
    }
    if (_upgradeColumns[i] == null) {
      appendColumn(sb,rs,(String)columns[i][0],(Integer)columns[i][1],last);
    }
 else {
      try {
        Object oldValue=getValue(rs,(String)columns[i][0],(Integer)columns[i][1]);
        Object newValue=_upgradeColumns[i].getNewValue(oldValue);
        appendColumn(sb,newValue,last);
      }
 catch (      StagnantRowException sre) {
        throw new StagnantRowException("Column '" + columns[i][0] + "' with value '"+ sre.getMessage()+ "'",sre);
      }
    }
  }
  return sb.toString();
}
