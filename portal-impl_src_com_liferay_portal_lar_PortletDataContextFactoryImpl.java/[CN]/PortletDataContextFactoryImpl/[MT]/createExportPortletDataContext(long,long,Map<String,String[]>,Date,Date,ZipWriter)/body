{
  validateDateRange(startDate,endDate);
  PortletDataContext portletDataContext=new PortletDataContextImpl();
  populateGroupIds(companyId,portletDataContext);
  portletDataContext.setCompanyId(companyId);
  portletDataContext.setEndDate(endDate);
  portletDataContext.setGroupId(groupId);
  portletDataContext.setScopeGroupId(groupId);
  portletDataContext.setParameterMap(parameterMap);
  portletDataContext.setStartDate(startDate);
  portletDataContext.setZipWriter(zipWriter);
  return portletDataContext;
}
