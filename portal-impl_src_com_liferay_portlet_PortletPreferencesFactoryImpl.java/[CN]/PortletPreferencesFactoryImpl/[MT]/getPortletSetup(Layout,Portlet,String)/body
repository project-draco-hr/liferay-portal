{
  if (portlet.getPreferencesCompanyWide()) {
    return getPortletSetup(layout,portlet.getPortletId(),false,false,defaultPreferences);
  }
 else {
    if (portlet.getPreferencesOwnedByGroup()) {
      if (portlet.getPreferencesUniquePerLayout()) {
        return getPortletSetup(layout,portlet.getPortletId(),true,true,defaultPreferences);
      }
 else {
        return getPortletSetup(layout,portlet.getPortletId(),false,true,defaultPreferences);
      }
    }
 else {
      return getPortletSetup(layout,portlet.getPortletId(),true,false,defaultPreferences);
    }
  }
}
