{
  int ownerType=0;
  long ownerId=PortletKeys.PREFS_OWNER_ID_DEFAULT;
  if (settingsScope.equals(PortletPreferencesFactoryConstants.SETTINGS_SCOPE_COMPANY)) {
    ownerId=companyId;
    ownerType=PortletKeys.PREFS_OWNER_TYPE_COMPANY;
    plid=PortletKeys.PREFS_PLID_SHARED;
  }
 else   if (settingsScope.equals(PortletPreferencesFactoryConstants.SETTINGS_SCOPE_GROUP)) {
    ownerId=siteGroupId;
    ownerType=PortletKeys.PREFS_OWNER_TYPE_GROUP;
    plid=PortletKeys.PREFS_PLID_SHARED;
  }
 else   if (settingsScope.equals(PortletPreferencesFactoryConstants.SETTINGS_SCOPE_PORTLET_INSTANCE)) {
    ownerId=PortletKeys.PREFS_OWNER_ID_DEFAULT;
    ownerType=PortletKeys.PREFS_OWNER_TYPE_LAYOUT;
    if (PortletConstants.hasUserId(portletId)) {
      ownerId=PortletConstants.getUserId(portletId);
      ownerType=PortletKeys.PREFS_OWNER_TYPE_USER;
    }
  }
  return new PortletPreferencesIds(companyId,ownerId,ownerType,plid,portletId);
}
