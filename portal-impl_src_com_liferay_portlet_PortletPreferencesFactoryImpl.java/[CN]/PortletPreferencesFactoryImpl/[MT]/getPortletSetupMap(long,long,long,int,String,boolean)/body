{
  Map<Long,PortletPreferences> portletSetupMap=new HashMap<Long,PortletPreferences>();
  List<com.liferay.portal.model.PortletPreferences> portletPreferencesList=PortletPreferencesLocalServiceUtil.getPortletPreferences(companyId,groupId,ownerId,ownerType,portletId,privateLayout);
  for (  com.liferay.portal.model.PortletPreferences portletPreferences : portletPreferencesList) {
    PortletPreferences portletSetup=PortletPreferencesLocalServiceUtil.getPreferences(companyId,ownerId,ownerType,portletPreferences.getPlid(),portletId);
    portletSetupMap.put(portletPreferences.getPlid(),portletSetup);
  }
  return portletSetupMap;
}
