{
  long oAuthApplicationId=PrefsPropsUtil.getLong(companyId,PortletPropsKeys.SYNC_OAUTH_APPLICATION_ID,0);
  OAuthApplication oAuthApplication=OAuthApplicationLocalServiceUtil.fetchOAuthApplication(oAuthApplicationId);
  if (oAuthApplication != null) {
    return;
  }
  oAuthApplication=OAuthApplicationLocalServiceUtil.addOAuthApplication(serviceContext.getUserId(),"Liferay Sync",StringPool.BLANK,OAuthApplicationConstants.ACCESS_WRITE,true,"http://liferay-sync","http://liferay-sync",serviceContext);
  ClassLoader classLoader=getClassLoader();
  InputStream inputStream=classLoader.getResourceAsStream("/resources/images/logo.png");
  OAuthApplicationLocalServiceUtil.updateLogo(oAuthApplication.getOAuthApplicationId(),inputStream);
  PortletPreferences portletPreferences=PrefsPropsUtil.getPreferences(companyId);
  try {
    portletPreferences.setValue(PortletPropsKeys.SYNC_OAUTH_APPLICATION_ID,String.valueOf(oAuthApplication.getOAuthApplicationId()));
    portletPreferences.setValue(PortletPropsKeys.SYNC_OAUTH_CONSUMER_KEY,oAuthApplication.getConsumerKey());
    portletPreferences.setValue(PortletPropsKeys.SYNC_OAUTH_CONSUMER_SECRET,oAuthApplication.getConsumerSecret());
    portletPreferences.store();
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
