{
  String templateManagerName=_templateManagerNames.get(notificationTemplateLanguage);
  if (Validator.isNull(templateManagerName)) {
    throw new NotificationMessageGenerationException("Unsupported notification template language " + notificationTemplateLanguage);
  }
  try {
    String templateId=notificationName + kaleoClassName + kaleoClassPK;
    Template template=TemplateManagerUtil.getTemplate(templateManagerName,new StringTemplateResource(templateId,notificationTemplate),false);
    populateContextVariables(template,executionContext);
    StringWriter stringWriter=new StringWriter();
    template.processTemplate(stringWriter);
    return stringWriter.toString();
  }
 catch (  Exception e) {
    throw new NotificationMessageGenerationException("Unable to generate notification message",e);
  }
}
