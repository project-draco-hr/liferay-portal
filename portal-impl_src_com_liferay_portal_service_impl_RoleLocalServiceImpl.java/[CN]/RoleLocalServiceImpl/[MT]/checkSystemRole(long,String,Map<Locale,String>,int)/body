{
  String companyIdHexString=StringUtil.toHexString(companyId);
  String key=companyIdHexString.concat(name);
  Role role=_systemRolesMap.get(key);
  try {
    if (role == null) {
      role=rolePersistence.findByC_N(companyId,name);
    }
    if (!descriptionMap.equals(role.getDescriptionMap())) {
      role.setDescriptionMap(descriptionMap);
      roleLocalService.updateRole(role);
    }
  }
 catch (  NoSuchRoleException nsre) {
    User user=userLocalService.getDefaultUser(companyId);
    PermissionThreadLocal.setAddResource(false);
    try {
      role=roleLocalService.addRole(user.getUserId(),null,0,name,null,descriptionMap,type,null,null);
    }
  finally {
      PermissionThreadLocal.setAddResource(true);
    }
    if (name.equals(RoleConstants.USER)) {
      initPersonalControlPanelPortletsPermissions(role);
    }
  }
  _systemRolesMap.put(key,role);
}
