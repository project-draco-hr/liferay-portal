{
  int assigneesTotal=0;
  Role role=getRole(roleId);
  int type=role.getType();
  if (type == RoleConstants.TYPE_REGULAR) {
    assigneesTotal+=userLocalService.getRoleUsersCount(roleId);
    assigneesTotal+=groupLocalService.getRoleGroupsCount(roleId);
  }
  if (type == RoleConstants.TYPE_SITE) {
    DynamicQuery userGroupGroupRoleQuery=userGroupGroupRoleLocalService.dynamicQuery();
    userGroupGroupRoleQuery.add(PropertyFactoryUtil.forName("primaryKey.roleId").eq(roleId));
    userGroupGroupRoleQuery.setProjection(ProjectionFactoryUtil.countDistinct("primaryKey.userGroupId"));
    Long userGroupGroupRoleCount=(Long)userGroupRoleLocalService.dynamicQuery(userGroupGroupRoleQuery).get(0);
    assigneesTotal+=userGroupGroupRoleCount.intValue();
  }
  if ((type == RoleConstants.TYPE_SITE) || (type == RoleConstants.TYPE_ORGANIZATION)) {
    DynamicQuery userGroupRoleQuery=userGroupRoleLocalService.dynamicQuery();
    userGroupRoleQuery.add(PropertyFactoryUtil.forName("primaryKey.roleId").eq(roleId));
    userGroupRoleQuery.setProjection(ProjectionFactoryUtil.countDistinct("primaryKey.userId"));
    Long userGroupGroupRoleCount=(Long)userGroupRoleLocalService.dynamicQuery(userGroupRoleQuery).get(0);
    assigneesTotal+=userGroupGroupRoleCount.intValue();
  }
  return assigneesTotal;
}
