{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    long workflowTaskId=ParamUtil.getLong(portletRequest,ActionUtil.WORKFLOW_TASK_ID);
    String transitionName=ParamUtil.getString(portletRequest,_TRANSITION_NAME);
    String comment=ParamUtil.getString(portletRequest,_COMMENT);
    WorkflowTaskManagerUtil.completeWorkflowTask(themeDisplay.getCompanyId(),themeDisplay.getUserId(),workflowTaskId,transitionName,comment,null);
    super.doProcessCommand(portletRequest,portletResponse);
  }
 catch (  Exception e) {
    if (e instanceof WorkflowTaskDueDateException) {
      SessionErrors.add(portletRequest,e.getClass());
    }
 else     if (e instanceof PrincipalException || e instanceof WorkflowException) {
      SessionErrors.add(portletRequest,e.getClass());
      PortletSession portletSession=portletRequest.getPortletSession();
      PortletContext portletContext=portletSession.getPortletContext();
      portletContext.getRequestDispatcher(portletResponse.encodeURL("/error.jsp")).include(portletRequest,portletResponse);
    }
 else {
      throw e;
    }
  }
}
