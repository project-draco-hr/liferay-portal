{
  if (collection == null) {
    throw new NullPointerException();
  }
  _takeLock.lock();
  try {
    int size=_count.get();
    Node<E> head=_head;
    int count=0;
    try {
      while (count < size) {
        Node<E> current=head._next;
        collection.add(current._element);
        current._element=null;
        head._next=null;
        head=current;
        ++count;
      }
      return count;
    }
  finally {
      if (count > 0) {
        _head=head;
        _count.getAndAdd(-count);
      }
    }
  }
  finally {
    _takeLock.unlock();
  }
}
