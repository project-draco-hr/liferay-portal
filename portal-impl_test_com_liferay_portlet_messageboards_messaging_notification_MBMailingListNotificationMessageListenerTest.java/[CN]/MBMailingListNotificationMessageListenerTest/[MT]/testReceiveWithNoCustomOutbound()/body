{
  _messageFromMB.put("sourceMailingList",false);
  MBMailingListNotificationMessageListener listener=new MBMailingListNotificationMessageListener(_mockMBMailingListService,new MessageSender(){
    public void send(    String destination,    Message message){
      _toMailService=message;
    }
  }
);
  final MBMailingList mailingListConfig=new MockMBMailingListImpl("mail-list@liferay.com",true,false);
  _mockery.checking(new Expectations(){
{
      one(_mockMBMailingListService).getCategoryMailingList(1);
      will(returnValue(mailingListConfig));
      one(_mockSender).send(with(equal(DestinationNames.MAIL)),with(any(Message.class)));
    }
  }
);
  listener.receive(_messageFromMB);
  assertNotNull(_toMailService);
  MailMessage sentToMailService=(MailMessage)_toMailService.getPayload();
  assertNull(sentToMailService.getSMTPAccount());
  _assertToMailServiceMessage(mailingListConfig,sentToMailService);
}
