{
  IndexAccessor indexAccessor=LuceneHelperUtil.getIndexAccessor(companyId);
  IndexSearcher indexSearcher=null;
  try {
    String localizedFieldName=DocumentImpl.getLocalizedName(languageId,keywordFieldName);
    indexSearcher=LuceneHelperUtil.getSearcher(indexAccessor.getCompanyId(),true);
    List<IndexReader> indexReaders=new ArrayList<IndexReader>();
    if (indexSearcher.maxDoc() > 0) {
      ReaderUtil.gatherSubReaders(indexReaders,indexSearcher.getIndexReader());
    }
    Collection<Document> documents=new ArrayList<Document>();
    DictionaryReader dictionaryReader=new DictionaryReader(inputStream,StringPool.UTF8);
    Iterator<DictionaryEntry> iterator=dictionaryReader.getDictionaryEntriesIterator();
    while (iterator.hasNext()) {
      DictionaryEntry dictionaryEntry=iterator.next();
      String word=dictionaryEntry.getWord();
      boolean validWord=isValidWord(localizedFieldName,word,indexReaders);
      if (!validWord) {
        continue;
      }
      Document document=createDocument(companyId,groupId,languageId,localizedFieldName,word,dictionaryEntry.getWeight(),typeFieldValue,maxNGramLength);
      documents.add(document);
    }
    indexAccessor.addDocuments(documents);
  }
  finally {
    LuceneHelperUtil.cleanUp(indexSearcher);
  }
}
