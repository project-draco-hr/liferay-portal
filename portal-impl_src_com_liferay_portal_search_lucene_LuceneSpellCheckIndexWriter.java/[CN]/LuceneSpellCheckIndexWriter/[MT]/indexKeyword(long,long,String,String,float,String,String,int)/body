{
  IndexAccessor indexAccessor=LuceneHelperUtil.getIndexAccessor(companyId);
  IndexSearcher indexSearcher=null;
  try {
    List<IndexReader> indexReaders=new ArrayList<IndexReader>();
    indexSearcher=LuceneHelperUtil.getSearcher(companyId);
    if (indexSearcher.maxDoc() > 0) {
      ReaderUtil.gatherSubReaders(indexReaders,indexSearcher.getIndexReader());
    }
    String localizedFieldName=DocumentImpl.getLocalizedName(languageId,keywordFieldName);
    boolean validWord=isValidWord(localizedFieldName,keyword,indexReaders);
    if (!validWord) {
      if (_log.isInfoEnabled()) {
        _log.info("Not indexing because keyword " + keyword + " is invalid");
      }
      return;
    }
    Document document=createDocument(companyId,groupId,languageId,localizedFieldName,keyword,weight,typeFieldValue,maxNGramLength);
    indexAccessor.addDocument(document);
  }
  finally {
    try {
      LuceneHelperUtil.releaseSearcher(companyId,indexSearcher);
    }
 catch (    IOException ioe) {
      _log.error("Unable to release searcher",ioe);
    }
  }
}
