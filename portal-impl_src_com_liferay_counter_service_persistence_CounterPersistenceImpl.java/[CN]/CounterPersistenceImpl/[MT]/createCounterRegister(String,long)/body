{
  long rangeMin=-1;
  long rangeMax=-1;
  int rangeSize=getRangeSize(name);
  Connection connection=null;
  PreparedStatement preparedStatement=null;
  ResultSet resultSet=null;
  try {
    connection=getConnection();
    preparedStatement=connection.prepareStatement(_SQL_SELECT_ID_BY_NAME);
    preparedStatement.setString(1,name);
    resultSet=preparedStatement.executeQuery();
    if (resultSet.next()) {
      rangeMin=resultSet.getLong(1);
      if (size > rangeMin) {
        rangeMin=size;
      }
      rangeMax=rangeMin + rangeSize;
      resultSet.close();
      preparedStatement.close();
      preparedStatement=connection.prepareStatement(_SQL_UPDATE_ID_BY_NAME);
      preparedStatement.setLong(1,rangeMax);
      preparedStatement.setString(2,name);
    }
 else {
      rangeMin=_DEFAULT_CURRENT_ID;
      if (size > rangeMin) {
        rangeMin=size;
      }
      rangeMax=rangeMin + rangeSize;
      resultSet.close();
      preparedStatement.close();
      preparedStatement=connection.prepareStatement(_SQL_INSERT);
      preparedStatement.setString(1,name);
      preparedStatement.setLong(2,rangeMax);
    }
    preparedStatement.executeUpdate();
  }
 catch (  Exception e) {
    throw processException(e);
  }
 finally {
    DataAccess.cleanUp(connection,preparedStatement,resultSet);
  }
  return new CounterRegister(name,rangeMin,rangeMax,rangeSize);
}
