{
  List<Template> templates=new ArrayList<Template>();
  MirageTemplateCriteria criteria=(MirageTemplateCriteria)optionalCriteria;
  String query=criteria.getString(MirageTemplateCriteria.QUERY);
  if (query == null) {
    return null;
  }
  try {
    if (query.equals(MirageTemplateCriteria.FIND_BY_G_S)) {
      MirageTemplate mirageTemplate=(MirageTemplate)mirageJournalTemplate;
      JournalTemplate template=mirageTemplate.getTemplate();
      templates=getTemplates(template.getGroupId(),template.getStructureId());
    }
 else     if (query.equals(MirageTemplateCriteria.FIND_BY_G_S_WITH_LIMIT)) {
      MirageTemplate mirageTemplate=(MirageTemplate)mirageJournalTemplate;
      JournalTemplate template=mirageTemplate.getTemplate();
      int start=criteria.getInt(MirageTemplateCriteria.RANGE_START);
      int end=criteria.getInt(MirageTemplateCriteria.RANGE_END);
      templates=getTemplates(template.getGroupId(),template.getStructureId(),start,end);
    }
 else     if (query.equals(MirageTemplateCriteria.FIND_ALL)) {
      templates=getAllTemplates();
    }
 else     if (query.equals(MirageTemplateCriteria.FIND_BY_GROUP_ID)) {
      MirageTemplate mirageTemplate=(MirageTemplate)mirageJournalTemplate;
      JournalTemplate template=mirageTemplate.getTemplate();
      templates=getTemplates(template.getGroupId());
    }
 else     if (query.equals(MirageTemplateCriteria.FIND_BY_GROUP_ID_WITH_LIMIT)) {
      MirageTemplate mirageTemplate=(MirageTemplate)mirageJournalTemplate;
      JournalTemplate template=mirageTemplate.getTemplate();
      int start=criteria.getInt(MirageTemplateCriteria.RANGE_START);
      int end=criteria.getInt(MirageTemplateCriteria.RANGE_END);
      templates=getTemplates(template.getGroupId(),start,end);
    }
 else     if (query.equals(MirageTemplateCriteria.FIND_BY_TEMPLATE_ID)) {
      MirageTemplate mirageTemplate=(MirageTemplate)mirageJournalTemplate;
      JournalTemplate template=mirageTemplate.getTemplate();
      templates=getTemplates(template.getTemplateId());
    }
  }
 catch (  SystemException se) {
    throw new TemplateNotFoundException(se.getMessage(),se.getMessage(),se);
  }
  return templates;
}
