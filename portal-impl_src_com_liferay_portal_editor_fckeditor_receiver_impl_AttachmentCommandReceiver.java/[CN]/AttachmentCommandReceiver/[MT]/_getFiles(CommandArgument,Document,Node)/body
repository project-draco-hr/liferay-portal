{
  Element filesElement=document.createElement("Files");
  rootNode.appendChild(filesElement);
  HttpServletRequest request=commandArgument.getHttpServletRequest();
  long wikiPageResourcePrimKey=ParamUtil.getLong(request,"wikiPageResourcePrimKey");
  WikiPage wikiPage=WikiPageLocalServiceUtil.getPage(wikiPageResourcePrimKey);
  long repositoryId=CompanyConstants.SYSTEM;
  String dirName=wikiPage.getAttachmentsDir();
  String[] fileNames=null;
  try {
    fileNames=DLStoreUtil.getFileNames(wikiPage.getCompanyId(),repositoryId,dirName);
  }
 catch (  NoSuchDirectoryException nsde) {
    DLStoreUtil.addDirectory(wikiPage.getCompanyId(),repositoryId,dirName);
    fileNames=DLStoreUtil.getFileNames(wikiPage.getCompanyId(),repositoryId,dirName);
  }
  for (  String fileName : fileNames) {
    byte[] fileEntry=DLStoreUtil.getFileAsBytes(wikiPage.getCompanyId(),repositoryId,fileName);
    String[] parts=StringUtil.split(fileName,StringPool.SLASH);
    fileName=parts[3];
    Element fileElement=document.createElement("File");
    filesElement.appendChild(fileElement);
    fileElement.setAttribute("name",fileName);
    fileElement.setAttribute("desc",fileName);
    fileElement.setAttribute("size",getSize(fileEntry.length));
    fileElement.setAttribute("url",fileName);
  }
}
