{
  Element filesElement=document.createElement("Files");
  rootNode.appendChild(filesElement);
  HttpServletRequest request=commandArgument.getHttpServletRequest();
  long resourcePK=ParamUtil.getLong(request,"wikiPageResourcePrimKey");
  WikiPage page=WikiPageLocalServiceUtil.getPage(resourcePK);
  long repositoryId=CompanyConstants.SYSTEM;
  String dirName=page.getAttachmentsDir();
  String[] fileNames=null;
  try {
    fileNames=DLStoreUtil.getFileNames(page.getCompanyId(),repositoryId,dirName);
  }
 catch (  NoSuchDirectoryException nsde) {
    DLStoreUtil.addDirectory(page.getCompanyId(),repositoryId,dirName);
    fileNames=DLStoreUtil.getFileNames(page.getCompanyId(),repositoryId,dirName);
  }
  for (  String fileName : fileNames) {
    byte[] fileEntry=DLStoreUtil.getFile(page.getCompanyId(),repositoryId,fileName);
    String[] parts=StringUtil.split(fileName,StringPool.SLASH);
    fileName=parts[3];
    Element fileElement=document.createElement("File");
    filesElement.appendChild(fileElement);
    fileElement.setAttribute("name",fileName);
    fileElement.setAttribute("desc",fileName);
    fileElement.setAttribute("size",getSize(fileEntry.length));
    fileElement.setAttribute("url",fileName);
  }
}
