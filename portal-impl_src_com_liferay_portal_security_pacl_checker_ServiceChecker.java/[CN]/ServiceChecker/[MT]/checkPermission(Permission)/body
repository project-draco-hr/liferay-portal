{
  PortalServicePermission portalServicePermission=(PortalServicePermission)permission;
  String name=portalServicePermission.getName();
  Object object=portalServicePermission.getObject();
  if (name.equals(PORTAL_PERMISSION_DYNAMIC_QUERY)) {
    Class<?> implClass=(Class<?>)object;
    if (!hasDynamicQuery(implClass)) {
      throw new SecurityException("Attempted to create a dynamic query for " + implClass);
    }
  }
 else   if (name.equals(PORTAL_PERMISSION_SERVICE)) {
    Method method=portalServicePermission.getMethod();
    if (!hasService(object,method)) {
      throw new SecurityException("Attempted to invoke " + method);
    }
  }
}
