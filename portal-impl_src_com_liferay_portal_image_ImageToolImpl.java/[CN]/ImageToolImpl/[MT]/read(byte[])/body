{
  RenderedImage renderedImage=null;
  String type=TYPE_NOT_AVAILABLE;
  Enumeration<ImageCodec> enu=ImageCodec.getCodecs();
  while (enu.hasMoreElements()) {
    ImageCodec codec=enu.nextElement();
    if (codec.isFormatRecognized(bytes)) {
      type=codec.getFormatName();
      renderedImage=read(bytes,type);
      break;
    }
  }
  if (type.equals("jpeg")) {
    type=TYPE_JPEG;
  }
  return new ImageBag(renderedImage,type);
}
