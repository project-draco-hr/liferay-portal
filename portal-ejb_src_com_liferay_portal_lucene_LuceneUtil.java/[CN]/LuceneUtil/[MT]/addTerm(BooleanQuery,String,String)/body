{
  if (Validator.isNotNull(text)) {
    Matcher matcher=TERM_END_PATTERN.matcher(text);
    text=matcher.replaceAll("$1*");
    text=text + " " + matcher.replaceAll("$1~");
    text=StringUtil.replace(text,"**","*");
    text=StringUtil.replace(text,"*~","*");
    text=StringUtil.replace(text,"~~","~");
    text=StringUtil.replace(text,"~*","~");
    QueryParser queryParser=new QueryParser(field,LuceneUtil.getAnalyzer());
    try {
      Query query=queryParser.parse(text);
      booleanQuery.add(query,BooleanClause.Occur.SHOULD);
    }
 catch (    ParseException pe) {
      if (_log.isDebugEnabled()) {
        _log.debug("ParseException thrown, reverting to literal search",pe);
      }
      text=KeywordsUtil.escape(text);
      Query query=queryParser.parse(text);
      booleanQuery.add(query,BooleanClause.Occur.SHOULD);
    }
  }
}
