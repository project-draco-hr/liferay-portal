{
  String friendlyURLPath=null;
  String strutsAction=GetterUtil.getString(portletURL.getParameter("struts_action"));
  if (strutsAction.equals("/wiki/view") || strutsAction.equals("/wiki/view_all_pages") || strutsAction.equals("/wiki/view_draft_pages")|| strutsAction.equals("/wiki/view_orphan_pages")|| strutsAction.equals("/wiki/view_recent_changes")) {
    String nodeId=portletURL.getParameter("nodeId");
    String nodeName=portletURL.getParameter("nodeName");
    if (Validator.isNotNull(nodeId) || Validator.isNotNull(nodeName)) {
      StringBundler sb=new StringBundler();
      sb.append(StringPool.SLASH);
      sb.append(_MAPPING);
      sb.append(StringPool.SLASH);
      if (Validator.isNotNull(nodeId)) {
        sb.append(nodeId);
        portletURL.addParameterIncludedInPath("nodeId");
      }
 else       if (Validator.isNotNull(nodeName)) {
        sb.append(nodeName);
        portletURL.addParameterIncludedInPath("nodeName");
      }
      if (strutsAction.equals("/wiki/view")) {
        String title=portletURL.getParameter("title");
        if (Validator.isNotNull(title)) {
          sb.append(StringPool.SLASH);
          sb.append(HttpUtil.encodeURL(title));
          portletURL.addParameterIncludedInPath("title");
        }
      }
 else {
        sb.append(StringPool.SLASH);
        sb.append(strutsAction.substring(11));
      }
      friendlyURLPath=sb.toString();
    }
  }
 else   if (strutsAction.equals("/wiki/view_tagged_pages")) {
    String tag=portletURL.getParameter("tag");
    if (Validator.isNotNull(tag)) {
      StringBundler sb=new StringBundler(6);
      sb.append(StringPool.SLASH);
      sb.append(_MAPPING);
      sb.append(StringPool.SLASH);
      sb.append("tag");
      sb.append(StringPool.SLASH);
      sb.append(HttpUtil.encodeURL(tag));
      portletURL.addParameterIncludedInPath("nodeId");
      portletURL.addParameterIncludedInPath("nodeName");
      portletURL.addParameterIncludedInPath("tag");
      friendlyURLPath=sb.toString();
    }
 else {
      friendlyURLPath=StringPool.BLANK;
    }
  }
  if (Validator.isNotNull(friendlyURLPath)) {
    WindowState windowState=portletURL.getWindowState();
    if (!windowState.equals(WindowState.NORMAL)) {
      friendlyURLPath+=StringPool.SLASH + windowState;
    }
    portletURL.addParameterIncludedInPath("p_p_id");
    portletURL.addParameterIncludedInPath("struts_action");
  }
  return friendlyURLPath;
}
