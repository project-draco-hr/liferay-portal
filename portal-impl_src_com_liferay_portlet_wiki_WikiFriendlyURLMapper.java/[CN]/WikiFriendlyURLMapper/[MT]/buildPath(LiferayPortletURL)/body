{
  String friendlyURLPath=null;
  String strutsAction=GetterUtil.getString(portletURL.getParameter("struts_action"));
  if (strutsAction.equals("/wiki/view") || strutsAction.equals("/wiki/view_all_pages") || strutsAction.equals("/wiki/view_orphan_pages")|| strutsAction.equals("/wiki/view_recent_changes")) {
    String nodeId=portletURL.getParameter("nodeId");
    String nodeName=portletURL.getParameter("nodeName");
    if (Validator.isNotNull(nodeId) || Validator.isNotNull(nodeName)) {
      StringBuilder sb=new StringBuilder();
      sb.append(StringPool.SLASH);
      sb.append(_MAPPING);
      sb.append(StringPool.SLASH);
      if (Validator.isNotNull(nodeId)) {
        sb.append(nodeId);
        portletURL.addParameterIncludedInPath("nodeId");
      }
 else       if (Validator.isNotNull(nodeName)) {
        sb.append(nodeName);
        portletURL.addParameterIncludedInPath("nodeName");
      }
      if (strutsAction.equals("/wiki/view")) {
        String title=portletURL.getParameter("title");
        if (Validator.isNotNull(title)) {
          sb.append(StringPool.SLASH);
          sb.append(HttpUtil.encodeURL(title));
          portletURL.addParameterIncludedInPath("title");
          WindowState windowState=portletURL.getWindowState();
          if (!windowState.equals(WindowState.NORMAL)) {
            sb.append(StringPool.SLASH);
            sb.append(windowState);
          }
        }
      }
 else {
        sb.append(StringPool.SLASH);
        sb.append(strutsAction.substring(11));
      }
      friendlyURLPath=sb.toString();
    }
  }
 else   if (strutsAction.equals("/wiki/view_tagged_pages")) {
    boolean folksonomy=GetterUtil.getBoolean(portletURL.getParameter("folksonomy"));
    String tag=portletURL.getParameter("tag");
    StringBuilder sb=new StringBuilder();
    if (Validator.isNotNull(tag)) {
      sb.append(StringPool.SLASH);
      sb.append(_MAPPING);
      sb.append(StringPool.SLASH);
      if (folksonomy) {
        sb.append("tag");
      }
 else {
        sb.append("category");
      }
      sb.append(StringPool.SLASH);
      sb.append(HttpUtil.encodeURL(tag));
      portletURL.addParameterIncludedInPath("nodeId");
      portletURL.addParameterIncludedInPath("nodeName");
      portletURL.addParameterIncludedInPath("tag");
    }
    friendlyURLPath=sb.toString();
  }
  if (Validator.isNotNull(friendlyURLPath)) {
    portletURL.addParameterIncludedInPath("p_p_id");
    portletURL.addParameterIncludedInPath("struts_action");
  }
  return friendlyURLPath;
}
