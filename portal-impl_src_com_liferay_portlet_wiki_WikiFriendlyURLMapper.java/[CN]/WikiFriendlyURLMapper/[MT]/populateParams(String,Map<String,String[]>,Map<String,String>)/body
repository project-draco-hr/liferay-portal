{
  addParam(params,prpIdentifiers,"p_p_id",_PORTLET_ID);
  addParam(params,prpIdentifiers,"p_p_lifecycle","0");
  addParam(params,prpIdentifiers,"p_p_mode",PortletMode.VIEW);
  addParam(params,prpIdentifiers,"struts_action","/wiki/view");
  int x=friendlyURLPath.indexOf(StringPool.SLASH,1);
  String[] urlFragments=StringUtil.split(friendlyURLPath.substring(x + 1),StringPool.SLASH);
  if (urlFragments.length >= 1) {
    String urlFragment0=urlFragments[0];
    if (urlFragment0.equals("category") || urlFragment0.equals("tag")) {
      if (urlFragments.length >= 2) {
        addParam(params,prpIdentifiers,"struts_action","/wiki/view_tagged_pages");
        String tag=HttpUtil.decodeURL(urlFragments[1]);
        boolean folksonomy=TagsEntryConstants.FOLKSONOMY_TAG;
        if (urlFragment0.equals("category")) {
          folksonomy=TagsEntryConstants.FOLKSONOMY_CATEGORY;
        }
        addParam(params,prpIdentifiers,"tag",tag);
        addParam(params,prpIdentifiers,"folksonomy",folksonomy);
      }
    }
 else {
      if (Validator.isNumber(urlFragment0)) {
        addParam(params,prpIdentifiers,"nodeId",urlFragment0);
      }
 else {
        addParam(params,prpIdentifiers,"nodeName",urlFragment0);
      }
      if (urlFragments.length >= 2) {
        String urlFragments1=HttpUtil.decodeURL(urlFragments[1]);
        if (urlFragments1.equals("all_pages") || urlFragments1.equals("orphan_pages") || urlFragments1.equals("recent_changes")) {
          addParam(params,prpIdentifiers,"struts_action","/wiki/view_" + urlFragments1);
        }
 else {
          addParam(params,prpIdentifiers,"title",urlFragments1);
          if (urlFragments.length >= 3) {
            String windowState=urlFragments[2];
            addParam(params,prpIdentifiers,"p_p_state",windowState);
          }
        }
      }
    }
  }
}
