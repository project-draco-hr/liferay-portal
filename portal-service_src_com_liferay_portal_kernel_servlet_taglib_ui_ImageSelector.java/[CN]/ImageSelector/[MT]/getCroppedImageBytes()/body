{
  if (!isCroppedImage()) {
    return null;
  }
  FileEntry fileEntry=PortletFileRepositoryUtil.getPortletFileEntry(_imageId);
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject(_imageCropRegion);
  int height=jsonObject.getInt("height");
  int width=jsonObject.getInt("width");
  int x=jsonObject.getInt("x");
  int y=jsonObject.getInt("y");
  if ((x > 0) || (y > 0) || (width > 0)|| (height > 0)) {
    ImageBag imageBag=ImageToolUtil.read(fileEntry.getContentStream());
    RenderedImage renderedImage=imageBag.getRenderedImage();
    renderedImage=ImageToolUtil.crop(renderedImage,height,width,x,y);
    return ImageToolUtil.getBytes(renderedImage,imageBag.getType());
  }
  return null;
}
