{
  String[] tableNames=_sqlQueryTableNamesCache.get(sql);
  if (tableNames != null) {
    return tableNames;
  }
  Statement statement=null;
  try {
    statement=_jSqlParser.parse(new UnsyncStringReader(sql));
  }
 catch (  JSQLParserException jsqlpe) {
    _log.error("Unable to parse SQL: " + sql,jsqlpe);
  }
  if ((statement == null) || !(statement instanceof Select)) {
    tableNames=new String[0];
    _sqlQueryTableNamesCache.put(sql,tableNames);
    return tableNames;
  }
  TablesNamesFinder tablesNamesFinder=new TablesNamesFinder();
  List<String> tableNameList=tablesNamesFinder.getTableList((Select)statement);
  tableNames=tableNameList.toArray(new String[tableNameList.size()]);
  _sqlQueryTableNamesCache.put(sql,tableNames);
  return tableNames;
}
