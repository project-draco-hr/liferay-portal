{
  String[] tableNames=_portalCache.get(sql);
  if (tableNames != null) {
    return tableNames;
  }
  String lowerCaseSQL=StringUtil.toLowerCase(sql);
  Set<String> tableNameSet=new HashSet<String>();
  int index=0;
  while ((index=lowerCaseSQL.indexOf(" from ",index)) != -1) {
    index+=6;
    int[] indexes=_getTableNameIndexes(lowerCaseSQL,index);
    if (indexes != null) {
      tableNameSet.add(sql.substring(indexes[0],indexes[1]));
    }
  }
  index=0;
  while ((index=lowerCaseSQL.indexOf(" join ",index)) != -1) {
    index+=6;
    int[] indexes=_getTableNameIndexes(lowerCaseSQL,index);
    if (indexes != null) {
      tableNameSet.add(sql.substring(indexes[0],indexes[1]));
    }
  }
  tableNames=tableNameSet.toArray(new String[tableNameSet.size()]);
  _portalCache.put(sql,tableNames);
  return tableNames;
}
