{
  Map portletsPool=_getPortletsPool(companyId);
  List portlets=ListUtil.fromCollection(portletsPool.values());
  if (!showSystem || !showPortal) {
    Iterator itr=portlets.iterator();
    while (itr.hasNext()) {
      Portlet portlet=(Portlet)itr.next();
      if (showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
      }
 else       if (!showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
        itr.remove();
      }
 else       if (!showSystem && portlet.isSystem()) {
        itr.remove();
      }
    }
  }
  return portlets;
}
