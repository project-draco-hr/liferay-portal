{
  FileEntry tempFileEntry=TempFileEntryUtil.addTempFileEntry(_group.getGroupId(),_user.getUserId(),_TEMP_FOLDER_NAME,"image.jpg",_getInputStream(),ContentTypes.IMAGE_JPEG);
  BlogsEntry entry=BlogsTestUtil.addEntry(_group,true);
  String tempfileEntryLink=_getTempFileEntryLink(tempFileEntry);
  String initialContent=RandomTestUtil.randomString(50) + StringPool.SPACE + tempfileEntryLink+ StringPool.SPACE+ RandomTestUtil.randomString(50);
  List<FileEntry> tempFileEntries=new ArrayList<>();
  tempFileEntries.add(tempFileEntry);
  List<BlogsEntryAttachmentFileEntryReference> blogsEntryAttachmentFileEntryReferences=_blogsEntryAttachmentFileEntryHelper.addBlogsEntryAttachmentFileEntries(_group.getGroupId(),_user.getUserId(),entry.getEntryId(),tempFileEntries);
  String content=_blogsEntryAttachmentFileEntryHelper.updateContent(initialContent,blogsEntryAttachmentFileEntryReferences);
  Assert.assertNotEquals(initialContent,content);
  Assert.assertFalse(content.contains(tempfileEntryLink));
  Assert.assertEquals(1,blogsEntryAttachmentFileEntryReferences.size());
  for (  BlogsEntryAttachmentFileEntryReference blogsEntryAttachmentFileEntryReference : blogsEntryAttachmentFileEntryReferences) {
    FileEntry fileEntry=blogsEntryAttachmentFileEntryReference.getBlogsEntryAttachmentFileEntry();
    Assert.assertTrue(content.contains(PortletFileRepositoryUtil.getPortletFileEntryURL(null,fileEntry,StringPool.BLANK)));
  }
}
