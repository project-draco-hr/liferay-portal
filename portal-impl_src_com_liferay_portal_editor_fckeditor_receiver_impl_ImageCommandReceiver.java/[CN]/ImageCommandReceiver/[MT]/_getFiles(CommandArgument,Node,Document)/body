{
  Element filesEl=doc.createElement("Files");
  root.appendChild(filesEl);
  if (!arg.getCurrentGroupName().equals("")) {
    Group group=GroupServiceUtil.getGroup(arg.getCompanyId(),arg.getCurrentGroupName());
    IGFolder folder=_getFolder(group.getGroupId(),arg.getCurrentFolder());
    List images=IGImageLocalServiceUtil.getImages(folder.getFolderId());
    for (int i=0; i < images.size(); i++) {
      IGImage image=(IGImage)images.get(i);
      long largeImageId=image.getLargeImageId();
      Image portalImage=ImageLocalUtil.getImageOrDefault(largeImageId);
      Element fileEl=doc.createElement("File");
      filesEl.appendChild(fileEl);
      fileEl.setAttribute("name",String.valueOf(image.getImageId()));
      fileEl.setAttribute("desc",image.getDescription());
      fileEl.setAttribute("size",getSize(portalImage.getSize()));
      StringMaker url=new StringMaker();
      ThemeDisplay themeDisplay=arg.getThemeDisplay();
      url.append(themeDisplay.getPathContext());
      url.append("/image/image_gallery?img_id=");
      url.append(largeImageId);
      url.append("&t=");
      url.append(ImageServletToken.getToken(largeImageId));
      fileEl.setAttribute("url",url.toString());
    }
  }
}
