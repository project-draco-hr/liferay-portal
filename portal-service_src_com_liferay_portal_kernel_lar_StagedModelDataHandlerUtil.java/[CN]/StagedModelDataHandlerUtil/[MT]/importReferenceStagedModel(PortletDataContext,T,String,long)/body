{
  Element referenceElement=portletDataContext.getReferenceElement(referrerStagedModel,stagedModelClassName,classPK);
  if (referenceElement == null) {
    return;
  }
  boolean missing=GetterUtil.getBoolean(referenceElement.attributeValue("missing"));
  StagedModelDataHandler<?> stagedModelDataHandler=StagedModelDataHandlerRegistryUtil.getStagedModelDataHandler(stagedModelClassName);
  ClassLoader classLoader=portletDataContext.getClassLoader();
  try {
    Class<?> clazz=stagedModelDataHandler.getClass();
    portletDataContext.setClassLoader(clazz.getClassLoader());
    if (missing) {
      stagedModelDataHandler.importMissingReference(portletDataContext,referenceElement);
      return;
    }
    importStagedModel(portletDataContext,referenceElement);
  }
  finally {
    portletDataContext.setClassLoader(classLoader);
  }
}
