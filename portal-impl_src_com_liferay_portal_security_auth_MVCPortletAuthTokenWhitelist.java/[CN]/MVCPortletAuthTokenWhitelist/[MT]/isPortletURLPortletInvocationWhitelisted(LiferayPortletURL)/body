{
  String portletId=liferayPortletURL.getPortletId();
  String lifecycle=liferayPortletURL.getLifecycle();
  if (lifecycle.equals(PortletRequest.ACTION_PHASE)) {
    return isActionInvocationWhitelisted(liferayPortletURL,portletId);
  }
 else   if (lifecycle.equals(PortletRequest.RENDER_PHASE)) {
    return isRenderInvocationWhitelisted(liferayPortletURL,portletId);
  }
 else   if (lifecycle.equals(PortletRequest.RESOURCE_PHASE)) {
    return isResourceInvocationWhitelisted(liferayPortletURL,portletId);
  }
  return false;
}
