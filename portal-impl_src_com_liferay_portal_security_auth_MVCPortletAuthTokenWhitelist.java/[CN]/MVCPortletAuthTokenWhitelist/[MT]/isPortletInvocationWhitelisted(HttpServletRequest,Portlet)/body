{
  String portletId=portlet.getPortletId();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (themeDisplay.isLifecycleAction()) {
    return isActionInvocationWhitelisted(request,portletId);
  }
 else   if (themeDisplay.isLifecycleRender()) {
    return isRenderInvocationWhitelisted(request,portletId);
  }
 else   if (themeDisplay.isLifecycleResource()) {
    return isResourceInvocationWhitelisted(request,portletId);
  }
  return false;
}
