{
  Tree foldersTree=new Tree();
  String parentFolderPath=sharepointRequest.getRootPath();
  long groupId=getGroupId(parentFolderPath);
  long defaultParentFolderId=DLFolderImpl.DEFAULT_PARENT_FOLDER_ID;
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,defaultParentFolderId);
  List<DLFolder> folders=DLFolderServiceUtil.getFolders(groupId,parentFolderId);
  for (  DLFolder folder : folders) {
    foldersTree.addChild(getFolderTree(folder,parentFolderPath));
  }
  foldersTree.addChild(getFolderTree(parentFolderPath));
  return foldersTree;
}
