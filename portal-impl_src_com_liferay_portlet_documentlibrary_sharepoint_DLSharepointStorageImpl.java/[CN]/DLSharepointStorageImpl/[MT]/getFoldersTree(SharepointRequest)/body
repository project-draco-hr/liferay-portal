{
  Tree foldersTree=new Tree();
  String parentFolderPath=sharepointRequest.getRootPath();
  long groupId=SharepointUtil.getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  List<Folder> folders=DLAppServiceUtil.getFolders(groupId,parentFolderId,false);
  for (  Folder folder : folders) {
    foldersTree.addChild(getFolderTree(folder,parentFolderPath));
  }
  foldersTree.addChild(getFolderTree(parentFolderPath));
  return foldersTree;
}
