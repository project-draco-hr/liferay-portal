{
  Tree documentsTree=new Tree();
  String parentFolderPath=sharepointRequest.getRootPath();
  long groupId=SharepointUtil.getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  if (parentFolderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    List<DLFileEntry> fileEntries=DLFileEntryLocalServiceUtil.getFileEntries(groupId,parentFolderId);
    for (    DLFileEntry fileEntry : fileEntries) {
      documentsTree.addChild(getFileEntryTree(fileEntry,parentFolderPath));
    }
  }
  return documentsTree;
}
