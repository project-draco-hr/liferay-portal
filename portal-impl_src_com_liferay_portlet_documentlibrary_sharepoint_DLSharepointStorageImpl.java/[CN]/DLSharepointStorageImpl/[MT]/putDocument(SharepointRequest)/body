{
  HttpServletRequest request=sharepointRequest.getHttpServletRequest();
  String documentPath=sharepointRequest.getRootPath();
  String parentFolderPath=getParentFolderPath(documentPath);
  long groupId=SharepointUtil.getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  String title=getResourceName(documentPath);
  String description=StringPool.BLANK;
  String changeLog=StringPool.BLANK;
  long contentLength=sharepointRequest.getBytes().length;
  InputStream is=new UnsyncByteArrayInputStream(sharepointRequest.getBytes());
  String contentType=GetterUtil.get(request.getHeader(HttpHeaders.CONTENT_TYPE),ContentTypes.APPLICATION_OCTET_STREAM);
  String extension=FileUtil.getExtension(title);
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  if (contentType.equals(ContentTypes.APPLICATION_OCTET_STREAM)) {
    contentType=MimeTypesUtil.getContentType(is,title);
  }
  serviceContext.setAttribute("contentType",contentType);
  serviceContext.setAttribute("extension",extension);
  try {
    FileEntry fileEntry=getFileEntry(sharepointRequest);
    long fileEntryId=fileEntry.getFileEntryId();
    description=fileEntry.getDescription();
    String[] assetTagNames=AssetTagLocalServiceUtil.getTagNames(FileEntry.class.getName(),fileEntry.getFileEntryId());
    serviceContext.setAssetTagNames(assetTagNames);
    DLAppServiceUtil.updateFileEntry(fileEntryId,title,title,description,changeLog,false,is,contentLength,serviceContext);
  }
 catch (  NoSuchFileEntryException nsfee) {
    DLAppServiceUtil.addFileEntry(groupId,parentFolderId,title,description,changeLog,is,contentLength,serviceContext);
  }
}
