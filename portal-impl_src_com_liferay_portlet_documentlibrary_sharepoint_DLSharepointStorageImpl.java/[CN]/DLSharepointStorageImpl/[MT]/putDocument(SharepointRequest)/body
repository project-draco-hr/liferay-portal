{
  String documentPath=sharepointRequest.getRootPath();
  String parentFolderPath=getParentFolderPath(documentPath);
  long groupId=getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderImpl.DEFAULT_PARENT_FOLDER_ID);
  String name=getResourceName(documentPath);
  String title=name;
  String description=StringPool.BLANK;
  String[] tagsEntries=null;
  String extraSettings=StringPool.BLANK;
  boolean addCommunityPermissions=true;
  boolean addGuestPermissions=true;
  try {
    DLFileEntry entry=getFileEntry(sharepointRequest);
    name=entry.getName();
    description=entry.getDescription();
    tagsEntries=TagsEntryLocalServiceUtil.getEntryNames(DLFileEntry.class.getName(),entry.getFileEntryId());
    extraSettings=entry.getExtraSettings();
    DLFileEntryServiceUtil.updateFileEntry(parentFolderId,parentFolderId,name,title,title,description,tagsEntries,extraSettings,sharepointRequest.getBytes());
  }
 catch (  NoSuchFileEntryException nsfee) {
    File file=FileUtil.createTempFile(FileUtil.getExtension(name));
    FileUtil.write(file,sharepointRequest.getBytes());
    DLFileEntryServiceUtil.addFileEntry(parentFolderId,name,title,description,tagsEntries,extraSettings,file,addCommunityPermissions,addGuestPermissions);
  }
}
