{
  String documentPath=sharepointRequest.getRootPath();
  String parentFolderPath=getParentFolderPath(documentPath);
  long groupId=SharepointUtil.getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  String name=getResourceName(documentPath);
  String title=name;
  String description=StringPool.BLANK;
  String versionDescription=StringPool.BLANK;
  String extraSettings=StringPool.BLANK;
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  try {
    DLFileEntry fileEntry=getFileEntry(sharepointRequest);
    name=fileEntry.getName();
    description=fileEntry.getDescription();
    extraSettings=fileEntry.getExtraSettings();
    String[] assetTagNames=AssetTagLocalServiceUtil.getTagNames(DLFileEntry.class.getName(),fileEntry.getFileEntryId());
    serviceContext.setAssetTagNames(assetTagNames);
    DLFileEntryServiceUtil.updateFileEntry(groupId,parentFolderId,parentFolderId,name,title,title,description,versionDescription,false,extraSettings,sharepointRequest.getBytes(),serviceContext);
  }
 catch (  NoSuchFileEntryException nsfee) {
    File file=FileUtil.createTempFile(FileUtil.getExtension(name));
    FileUtil.write(file,sharepointRequest.getBytes());
    DLFileEntryServiceUtil.addFileEntry(groupId,parentFolderId,name,title,description,versionDescription,extraSettings,file,serviceContext);
  }
}
