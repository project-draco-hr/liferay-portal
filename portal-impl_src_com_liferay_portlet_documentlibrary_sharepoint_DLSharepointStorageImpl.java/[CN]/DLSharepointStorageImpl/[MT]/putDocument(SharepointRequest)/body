{
  String documentPath=sharepointRequest.getRootPath();
  String parentFolderPath=getParentFolderPath(documentPath);
  long groupId=SharepointUtil.getGroupId(parentFolderPath);
  long parentFolderId=getLastFolderId(groupId,parentFolderPath,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  String title=getResourceName(documentPath);
  String description=StringPool.BLANK;
  String changeLog=StringPool.BLANK;
  String extraSettings=StringPool.BLANK;
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  try {
    FileEntry fileEntry=getFileEntry(sharepointRequest);
    long fileEntryId=fileEntry.getFileEntryId();
    description=fileEntry.getDescription();
    extraSettings=fileEntry.getExtraSettings();
    String[] assetTagNames=AssetTagLocalServiceUtil.getTagNames(FileEntry.class.getName(),fileEntry.getFileEntryId());
    serviceContext.setAssetTagNames(assetTagNames);
    DLAppServiceUtil.updateFileEntry(fileEntryId,title,title,description,changeLog,false,extraSettings,sharepointRequest.getBytes(),serviceContext);
  }
 catch (  NoSuchFileEntryException nsfee) {
    File file=FileUtil.createTempFile(FileUtil.getExtension(title));
    FileUtil.write(file,sharepointRequest.getBytes());
    DLAppServiceUtil.addFileEntry(groupId,parentFolderId,title,description,changeLog,extraSettings,file,serviceContext);
  }
}
