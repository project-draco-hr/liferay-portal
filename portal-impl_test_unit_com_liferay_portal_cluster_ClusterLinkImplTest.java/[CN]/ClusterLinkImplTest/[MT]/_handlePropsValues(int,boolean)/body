{
  if (channelCount == 0) {
    Field propsUtilInstance=ReflectionUtil.getDeclaredField(PropsUtil.class,"_instance");
    Object propsUtil=propsUtilInstance.get(null);
    Field configuration=ReflectionUtil.getDeclaredField(PropsUtil.class,"_configuration");
    configuration.set(propsUtil,new MockConfigurationImpl(PropsUtil.class.getClassLoader(),PropsFiles.PORTAL));
  }
 else {
    Properties transportProperties=PropsUtil.getProperties(PropsKeys.CLUSTER_LINK_CHANNEL_PROPERTIES_TRANSPORT,true);
    for (int i=transportProperties.size(); i < channelCount; i++) {
      PropsUtil.set(PropsKeys.CLUSTER_LINK_CHANNEL_PROPERTIES_TRANSPORT + CharPool.POUND + i,"udp.xml");
    }
  }
  PropsUtil.set(PropsKeys.CLUSTER_LINK_ENABLED,String.valueOf(enableClusterLink));
}
