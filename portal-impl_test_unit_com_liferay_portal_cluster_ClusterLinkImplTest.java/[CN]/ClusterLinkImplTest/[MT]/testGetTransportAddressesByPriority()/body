{
  TransportationConfigurationAdvice.setChannelCount(2);
  ClusterLinkImpl clusterLinkImpl1=null;
  ClusterLinkImpl clusterLinkImpl2=null;
  try {
    clusterLinkImpl1=getClusterLinkImpl();
    clusterLinkImpl2=getClusterLinkImpl();
    List<JChannel> jChannels1=getJChannels(clusterLinkImpl1);
    List<JChannel> jChannels2=getJChannels(clusterLinkImpl2);
    Assert.assertEquals(2,jChannels1.size());
    Assert.assertEquals(2,jChannels2.size());
    List<Address> addresses1=clusterLinkImpl1.getTransportAddresses(Priority.LEVEL1);
    List<Address> addresses2=clusterLinkImpl1.getTransportAddresses(Priority.LEVEL6);
    Assert.assertEquals(2,addresses1.size());
    Assert.assertEquals(2,addresses2.size());
    Assert.assertTrue(addresses1.contains(new AddressImpl(jChannels1.get(0).getAddress())));
    Assert.assertTrue(addresses1.contains(new AddressImpl(jChannels2.get(0).getAddress())));
    Assert.assertTrue(addresses2.contains(new AddressImpl(jChannels1.get(1).getAddress())));
    Assert.assertTrue(addresses2.contains(new AddressImpl(jChannels2.get(1).getAddress())));
  }
  finally {
    if (clusterLinkImpl1 != null) {
      clusterLinkImpl1.destroy();
    }
    if (clusterLinkImpl2 != null) {
      clusterLinkImpl2.destroy();
    }
  }
}
