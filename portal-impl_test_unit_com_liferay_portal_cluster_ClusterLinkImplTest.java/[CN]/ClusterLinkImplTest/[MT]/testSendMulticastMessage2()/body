{
  TransportationConfigurationAdvice.setChannelCount(1);
  ClusterLinkImpl clusterLinkImpl1=_getClusterLinkImpl();
  ClusterLinkImpl clusterLinkImpl2=_getClusterLinkImpl();
  ClusterLinkImpl clusterLinkImpl3=_getClusterLinkImpl();
  List<JChannel> jChannels1=_getJChannels(clusterLinkImpl1);
  List<JChannel> jChannels2=_getJChannels(clusterLinkImpl2);
  List<JChannel> jChannels3=_getJChannels(clusterLinkImpl3);
  TestReceiver testReceiver1=_getTestReceiver(jChannels1,0);
  TestReceiver testReceiver2=_getTestReceiver(jChannels2,0);
  TestReceiver testReceiver3=_getTestReceiver(jChannels3,0);
  Message message=_createMessage();
  clusterLinkImpl1.sendMulticastMessage(message,Priority.LEVEL1);
  String localMessage1=testReceiver1.waitLocalMessage();
  String remoteMessage1=testReceiver1.waitRemoteMessage();
  String localMessage2=testReceiver2.waitLocalMessage();
  String remoteMessage2=testReceiver2.waitRemoteMessage();
  String localMessage3=testReceiver3.waitLocalMessage();
  String remoteMessage3=testReceiver3.waitRemoteMessage();
  String messageKey=(String)message.getPayload();
  assertEquals(messageKey,localMessage1);
  assertNull(remoteMessage1);
  assertNull(localMessage2);
  assertEquals(messageKey,remoteMessage2);
  assertNull(localMessage3);
  assertEquals(messageKey,remoteMessage3);
  clusterLinkImpl1.destroy();
  clusterLinkImpl2.destroy();
  clusterLinkImpl3.destroy();
}
