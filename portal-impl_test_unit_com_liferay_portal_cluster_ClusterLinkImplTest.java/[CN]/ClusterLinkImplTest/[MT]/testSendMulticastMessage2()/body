{
  Callable<Void> callable=new Callable<Void>(){
    public Void call() throws Exception {
      ClusterLinkImpl clusterLinkImpl1=_getClusterLinkImpl(1,true);
      ClusterLinkImpl clusterLinkImpl2=_getClusterLinkImpl(1,true);
      ClusterLinkImpl clusterLinkImpl3=_getClusterLinkImpl(1,true);
      List<JChannel> channelList1=_getChannelList(clusterLinkImpl1);
      List<JChannel> channelList2=_getChannelList(clusterLinkImpl2);
      List<JChannel> channelList3=_getChannelList(clusterLinkImpl3);
      TestReceiver testReceiver1=(TestReceiver)channelList1.get(0).getReceiver();
      TestReceiver testReceiver2=(TestReceiver)channelList2.get(0).getReceiver();
      TestReceiver testReceiver3=(TestReceiver)channelList3.get(0).getReceiver();
      Message message=_createMessage();
      clusterLinkImpl1.sendMulticastMessage(message,Priority.LEVEL1);
      String localMessage1=testReceiver1.waitLocalMessage();
      String remoteMessage1=testReceiver1.waitRemoteMessage();
      String localMessage2=testReceiver2.waitLocalMessage();
      String remoteMessage2=testReceiver2.waitRemoteMessage();
      String localMessage3=testReceiver3.waitLocalMessage();
      String remoteMessage3=testReceiver3.waitRemoteMessage();
      String messageKey=(String)message.getPayload();
      assertEquals(messageKey,localMessage1);
      assertNull(remoteMessage1);
      assertNull(localMessage2);
      assertEquals(messageKey,remoteMessage2);
      assertNull(localMessage3);
      assertEquals(messageKey,remoteMessage3);
      clusterLinkImpl1.destroy();
      clusterLinkImpl2.destroy();
      clusterLinkImpl3.destroy();
      return null;
    }
  }
;
  runInNewClassLoader((Class<? extends Callable<Void>>)callable.getClass());
}
