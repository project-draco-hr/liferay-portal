{
  Callable<Void> callable=new Callable<Void>(){
    public Void call() throws Exception {
      ClusterLinkImpl clusterLinkImpl=_getClusterLinkImpl(2,true);
      List<JChannel> jChannels=_getJChannels(clusterLinkImpl);
      assertEquals(2,jChannels.size());
      JChannel jChannel=jChannels.get(0);
      assertTrue(jChannel.isOpen());
      jChannel=jChannels.get(1);
      assertTrue(jChannel.isOpen());
      clusterLinkImpl.destroy();
      jChannels=_getJChannels(clusterLinkImpl);
      assertEquals(2,jChannels.size());
      jChannel=jChannels.get(0);
      assertFalse(jChannel.isOpen());
      jChannel=jChannels.get(1);
      assertFalse(jChannel.isOpen());
      return null;
    }
  }
;
  runInNewClassLoader((Class<? extends Callable<Void>>)callable.getClass());
}
