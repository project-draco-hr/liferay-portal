{
  String path=null;
  if (request.getDispatcherType() == DispatcherType.INCLUDE) {
    path=(String)request.getAttribute(RequestDispatcher.INCLUDE_SERVLET_PATH);
    String pathInfo=(String)request.getAttribute(RequestDispatcher.INCLUDE_PATH_INFO);
    if (pathInfo != null) {
      path=path + pathInfo;
    }
  }
 else {
    path=request.getPathInfo();
  }
  if (path == null) {
    return true;
  }
  if (path.indexOf('/') != 0) {
    path='/' + path;
  }
  if (path.startsWith("/META-INF/") || path.startsWith("/OSGI-INF/") || path.startsWith("/OSGI-OPT/")|| path.startsWith("/WEB-INF/")) {
    try {
      ServletContext servletContext=request.getServletContext();
      servletContext.log("[WAB ERROR] Attempt to load illegal path " + path + " in "+ toString());
      response.sendError(HttpServletResponse.SC_FORBIDDEN,path);
    }
 catch (    IOException ioe) {
      response.setStatus(HttpServletResponse.SC_FORBIDDEN);
    }
    return false;
  }
  return true;
}
