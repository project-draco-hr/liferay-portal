{
  pluginId=PortalUtil.getJsSafePortletName(pluginId);
  PluginSetting pluginSetting=PluginSettingUtil.fetchByC_I_T(companyId,pluginId,pluginType);
  if (pluginSetting == null) {
    long pluginSettingId=counterLocalService.increment();
    pluginSetting=PluginSettingUtil.create(pluginSettingId);
    pluginSetting.setCompanyId(companyId);
    pluginSetting.setPluginId(pluginId);
    pluginSetting.setPluginType(pluginType);
  }
  pluginSetting.setRoles(roles);
  pluginSetting.setActive(active);
  PluginSettingUtil.update(pluginSetting);
  return pluginSetting;
}
