{
  if (checkPermission && !PluginSettingLocalServiceUtil.hasPermission(userId,newLayoutTemplateId,LayoutTemplateImpl.PLUGIN_TYPE)) {
    return;
  }
  String oldLayoutTemplateId=getLayoutTemplateId();
  getTypeSettingsProperties().setProperty(LAYOUT_TEMPLATE_ID,newLayoutTemplateId);
  if (Validator.isNull(oldLayoutTemplateId)) {
    return;
  }
  String themeId=null;
  try {
    themeId=getLayout().getTheme().getThemeId();
  }
 catch (  Exception e) {
    _log.error(e);
  }
  LayoutTemplate oldLayoutTemplate=LayoutTemplateLocalUtil.getLayoutTemplate(oldLayoutTemplateId,false,themeId);
  if (oldLayoutTemplate == null) {
    return;
  }
  LayoutTemplate newLayoutTemplate=LayoutTemplateLocalUtil.getLayoutTemplate(newLayoutTemplateId,false,themeId);
  List oldColumns=oldLayoutTemplate.getColumns();
  List newColumns=newLayoutTemplate.getColumns();
  reorganizePortlets(newColumns,oldColumns);
}
