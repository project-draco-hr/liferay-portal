{
  Portlet portlet=PortletLocalServiceUtil.getPortletById(getLayout().getCompanyId(),portletId);
  if (portlet == null) {
    return;
  }
  if (portlet.getRootPortletId().equals(PortletKeys.NESTED_PORTLETS)) {
    Properties props=getTypeSettingsProperties();
    Iterator itr=props.keySet().iterator();
    while (itr.hasNext()) {
      String key=(String)itr.next();
      if (key.startsWith(portlet.getPortletId())) {
        String portletIds=props.getProperty(key);
        String[] portletIdsArray=StringUtil.split(portletIds);
        for (int i=0; i < portletIdsArray.length; i++) {
          onRemoveFromLayout(portletIdsArray[i]);
        }
      }
    }
    removeNestedColumns(portletId);
  }
  deletePortletSetup(portletId);
  if (_enablePortletLayoutListener) {
    PortletLayoutListener portletLayoutListener=portlet.getPortletLayoutListener();
    long plid=getLayout().getPlid();
    if ((portletLayoutListener != null)) {
      portletLayoutListener.onRemoveFromLayout(portletId,plid);
    }
  }
}
