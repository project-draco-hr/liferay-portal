{
  Layout layout=getLayout();
  Portlet portlet=PortletLocalServiceUtil.getPortletById(getCompanyId(),sourcePortletId);
  String sourcePortletPrimaryKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),sourcePortletId);
  List<ResourcePermission> resourcePermissions=ResourcePermissionLocalServiceUtil.getResourcePermissions(portlet.getCompanyId(),portlet.getPortletName(),PortletKeys.PREFS_OWNER_TYPE_USER,sourcePortletPrimaryKey);
  for (  ResourcePermission resourcePermission : resourcePermissions) {
    String targetPortletPrimaryKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),targetPortletId);
    resourcePermission.setPrimKey(targetPortletPrimaryKey);
    resourcePermission.setMvccVersion(0);
    resourcePermission.setResourcePermissionId(CounterLocalServiceUtil.increment());
    ResourcePermissionLocalServiceUtil.addResourcePermission(resourcePermission);
  }
}
