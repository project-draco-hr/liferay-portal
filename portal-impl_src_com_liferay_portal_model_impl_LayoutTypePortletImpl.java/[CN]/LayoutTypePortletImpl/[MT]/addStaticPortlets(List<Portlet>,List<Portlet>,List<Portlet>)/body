{
  if (startPortlets == null) {
    startPortlets=new ArrayList<>();
  }
  if (endPortlets == null) {
    endPortlets=new ArrayList<>();
  }
  if (startPortlets.isEmpty() && endPortlets.isEmpty()) {
    return portlets;
  }
  List<Portlet> list=new ArrayList<>(portlets.size() + startPortlets.size() + endPortlets.size());
  if (!startPortlets.isEmpty()) {
    list.addAll(startPortlets);
  }
  for (int i=0; i < portlets.size(); i++) {
    Portlet portlet=portlets.get(i);
    if (!startPortlets.contains(portlet) && !endPortlets.contains(portlet)) {
      list.add(portlet);
    }
  }
  if (!endPortlets.isEmpty()) {
    list.addAll(endPortlets);
  }
  return list;
}
