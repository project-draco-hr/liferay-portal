{
  String nestedLayoutTemplateIds=GetterUtil.getString(getTypeSettingsProperties().getProperty(NESTED_LAYOUT_TEMPLATE_IDS));
  if (nestedLayoutTemplateIds.indexOf(portletId + NESTED_LAYOUT_TEMPLATE_SEPARATOR + template.getLayoutTemplateId()) == -1) {
    if (nestedLayoutTemplateIds.indexOf(portletId + NESTED_LAYOUT_TEMPLATE_SEPARATOR) > -1) {
      nestedLayoutTemplateIds=StringUtils.replace(nestedLayoutTemplateIds,portletId + NESTED_LAYOUT_TEMPLATE_SEPARATOR + ".*?,",",");
    }
    if (nestedLayoutTemplateIds.length() != 0) {
      nestedLayoutTemplateIds+=StringPool.COMMA;
    }
    nestedLayoutTemplateIds+=portletId + NESTED_LAYOUT_TEMPLATE_SEPARATOR + template.getLayoutTemplateId();
    getTypeSettingsProperties().setProperty(NESTED_LAYOUT_TEMPLATE_IDS,nestedLayoutTemplateIds);
  }
}
