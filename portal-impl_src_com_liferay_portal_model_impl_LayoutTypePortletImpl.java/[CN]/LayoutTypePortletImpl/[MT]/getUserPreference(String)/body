{
  String value=StringPool.BLANK;
  if (!hasUserPreferences()) {
    return value;
  }
  value=_portalPreferences.getValue(CustomizedPages.namespacePlid(getPlid()),key,StringPool.NULL);
  if (!value.equals(StringPool.NULL)) {
    return value;
  }
  if (hasSourcePrototypeLayout()) {
    value=getSourcePrototypeLayoutProperty(key);
  }
 else {
    value=getTypeSettingsProperties().getProperty(key);
  }
  if (Validator.isNull(value)) {
    return value;
  }
  String[] portletIds=StringUtil.split(value);
  String[] newPortletIds=new String[portletIds.length];
  for (int i=0; i < portletIds.length; i++) {
    if (portletIds[i].contains(PortletConstants.INSTANCE_SEPARATOR)) {
      String rootPortletId=PortletConstants.getRootPortletId(portletIds[i]);
      newPortletIds[i]=rootPortletId + getFullInstanceSeparator();
      copyPreferences(portletIds[i],newPortletIds[i]);
    }
 else {
      newPortletIds[i]=portletIds[i];
    }
  }
  value=StringUtil.merge(newPortletIds);
  setUserPreference(key,value);
  return value;
}
