{
  AuthVerifierResult authVerifierResult=new AuthVerifierResult();
  HttpServletRequest request=accessControlContext.getRequest();
  String uri=(String)request.getAttribute(WebKeys.INVOKER_FILTER_URI);
  if (uri.startsWith("/download/")) {
    String contextPath=request.getContextPath();
    if (!contextPath.equals("/o/sync")) {
      return authVerifierResult;
    }
  }
  try {
    String[] credentials=getCredentials(request,accessControlContext.getResponse());
    if (credentials != null) {
      authVerifierResult.setPassword(credentials[1]);
      authVerifierResult.setState(AuthVerifierResult.State.SUCCESS);
      authVerifierResult.setUserId(GetterUtil.getLong(credentials[0]));
    }
 else {
      Map<String,Object> settings=accessControlContext.getSettings();
      settings.remove("basic_auth");
    }
    return authVerifierResult;
  }
 catch (  Exception e) {
    throw new AuthException(e);
  }
}
