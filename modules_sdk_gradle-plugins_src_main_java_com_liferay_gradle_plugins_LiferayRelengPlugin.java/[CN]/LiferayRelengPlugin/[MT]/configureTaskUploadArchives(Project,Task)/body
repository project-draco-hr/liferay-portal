{
  Task uploadArchivesTask=GradleUtil.getTask(project,BasePlugin.UPLOAD_ARCHIVES_TASK_NAME);
  Spec<Task> releaseProjectSpec=new Spec<Task>(){
    @Override public boolean isSatisfiedBy(    Task task){
      Project project=task.getProject();
      if (GradleUtil.hasStartParameterTask(project,task.getName())) {
        return true;
      }
      String version=String.valueOf(project.getVersion());
      if (!version.endsWith(GradleUtil.SNAPSHOT_VERSION_SUFFIX)) {
        return true;
      }
      return false;
    }
  }
;
  uploadArchivesTask.dependsOn(recordArtifactTask);
  recordArtifactTask.onlyIf(releaseProjectSpec);
}
