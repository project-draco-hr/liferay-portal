{
  List<MessageListener> clpMessageListeners=(List<MessageListener>)servletContext.getAttribute(WebKeys.CLP_MESSAGE_LISTENERS);
  if (clpMessageListeners != null) {
    return;
  }
  clpMessageListeners=new ArrayList<MessageListener>();
  Set<String> classNames=ServletContextUtil.getClassNames(servletContext);
  for (  String className : classNames) {
    if (className.endsWith(".ClpMessageListener")) {
      Class<?> clpMessageListenerClass=portletClassLoader.loadClass(className);
      MessageListener clpMessageListener=(MessageListener)clpMessageListenerClass.newInstance();
      Field servletContextNameField=clpMessageListenerClass.getField("SERVLET_CONTEXT_NAME");
      String clpServletContextName=servletContextNameField.get(clpMessageListener).toString();
      if (clpServletContextName.equals(servletContext.getServletContextName())) {
        continue;
      }
      clpMessageListeners.add(clpMessageListener);
      MessageBusUtil.registerMessageListener(DestinationNames.HOT_DEPLOY,clpMessageListener);
    }
  }
  servletContext.setAttribute(WebKeys.CLP_MESSAGE_LISTENERS,clpMessageListeners);
}
