{
  _indexSearcherManager=new IndexSearcherManager(_directory);
  IndexSearcher indexSearcher=_indexSearcherManager.acquire();
  IndexReader indexReader=indexSearcher.getIndexReader();
  int referenceCount=indexReader.getRefCount();
  _indexSearcherManager.close();
  Assert.assertEquals(referenceCount - 1,indexReader.getRefCount());
  try {
    _indexSearcherManager.acquire();
    Assert.fail();
  }
 catch (  AlreadyClosedException ace) {
    Assert.assertEquals("Index searcher manager is closed",ace.getMessage());
  }
  _indexSearcherManager.invalidate();
  try {
    _indexSearcherManager.acquire();
    Assert.fail();
  }
 catch (  AlreadyClosedException ace) {
    Assert.assertEquals("Index searcher manager is closed",ace.getMessage());
  }
}
