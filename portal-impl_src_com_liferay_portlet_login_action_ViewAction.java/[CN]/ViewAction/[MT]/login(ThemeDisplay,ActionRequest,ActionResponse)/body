{
  HttpServletRequest httpReq=PortalUtil.getHttpServletRequest(req);
  HttpServletResponse httpRes=PortalUtil.getHttpServletResponse(res);
  String login=ParamUtil.getString(req,"login");
  String password=ParamUtil.getString(req,"password");
  boolean rememberMe=ParamUtil.getBoolean(req,"rememberMe");
  LoginAction.login(httpReq,httpRes,login,password,rememberMe);
  if (PropsValues.PORTAL_JAAS_ENABLE) {
    res.sendRedirect(themeDisplay.getPathMain() + "/portal/protected");
  }
 else {
    String redirect=ParamUtil.getString(req,"redirect");
    if (Validator.isNotNull(redirect)) {
      res.sendRedirect(redirect);
    }
 else {
      res.sendRedirect(themeDisplay.getPathMain());
    }
  }
}
