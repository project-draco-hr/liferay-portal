{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Company company=themeDisplay.getCompany();
  if (!company.isSendPassword()) {
    return;
  }
  if (PropsValues.CAPTCHA_CHECK_PORTAL_SEND_PASSWORD) {
    CaptchaUtil.check(actionRequest);
  }
  String emailAddress=ParamUtil.getString(actionRequest,"emailAddress");
  HttpServletRequest httpReq=PortalUtil.getHttpServletRequest(actionRequest);
  String remoteAddr=httpReq.getRemoteAddr();
  String remoteHost=httpReq.getRemoteHost();
  String userAgent=httpReq.getHeader(HttpHeaders.USER_AGENT);
  UserLocalServiceUtil.sendPassword(PortalUtil.getCompanyId(actionRequest),emailAddress,remoteAddr,remoteHost,userAgent);
  SessionMessages.add(actionRequest,"request_processed",emailAddress);
}
