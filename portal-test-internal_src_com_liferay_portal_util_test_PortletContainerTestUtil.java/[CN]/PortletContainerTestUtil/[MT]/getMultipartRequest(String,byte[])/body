{
  MockMultipartHttpServletRequest mockMultipartHttpServletRequest=new MockMultipartHttpServletRequest();
  mockMultipartHttpServletRequest.setContentType("multipart/form-data;boundary=" + System.currentTimeMillis());
  mockMultipartHttpServletRequest.addFile(new MockMultipartFile(fileNameParameter,bytes));
  mockMultipartHttpServletRequest.setCharacterEncoding("UTF-8");
  mockMultipartHttpServletRequest.setContent(bytes);
  MockHttpSession mockHttpSession=new MockHttpSession();
  mockHttpSession.setAttribute(ProgressTracker.PERCENT,new Object());
  mockMultipartHttpServletRequest.setSession(mockHttpSession);
  ServletFileUpload servletFileUpload=new ServletFileUpload(new LiferayFileItemFactory(UploadServletRequestImpl.getTempDir()));
  servletFileUpload.setSizeMax(PrefsPropsUtil.getLong(PropsKeys.UPLOAD_SERVLET_REQUEST_IMPL_MAX_SIZE));
  servletFileUpload.setHeaderEncoding(StringPool.UTF8);
  return new LiferayServletRequest(mockMultipartHttpServletRequest);
}
