{
  MockMultipartHttpServletRequest mockMultipartHttpServletRequest=new MockMultipartHttpServletRequest();
  mockMultipartHttpServletRequest.setContentType("multipart/form-data;boundary=" + new Date().getTime());
  InputStream inputStream=clazz.getResourceAsStream(dependency);
  MockMultipartFile multipartFile=new MockMultipartFile("attachment",inputStream);
  mockMultipartHttpServletRequest.addFile(multipartFile);
  mockMultipartHttpServletRequest.setCharacterEncoding("UTF-8");
  inputStream=clazz.getResourceAsStream(dependency);
  byte[] bytes=toByteArray(inputStream);
  mockMultipartHttpServletRequest.setContent(bytes);
  MockHttpSession mockHttpSession=new MockHttpSession();
  mockHttpSession.setAttribute(ProgressTracker.PERCENT,new Object());
  mockMultipartHttpServletRequest.setSession(mockHttpSession);
  ServletFileUpload servletFileUpload=new ServletFileUpload(new LiferayFileItemFactory(UploadServletRequestImpl.getTempDir()));
  servletFileUpload.setSizeMax(PrefsPropsUtil.getLong(PropsKeys.UPLOAD_SERVLET_REQUEST_IMPL_MAX_SIZE));
  servletFileUpload.setHeaderEncoding(StandardCharsets.UTF_8.displayName());
  LiferayServletRequest liferayServletRequest=new LiferayServletRequest(mockMultipartHttpServletRequest);
  return liferayServletRequest;
}
