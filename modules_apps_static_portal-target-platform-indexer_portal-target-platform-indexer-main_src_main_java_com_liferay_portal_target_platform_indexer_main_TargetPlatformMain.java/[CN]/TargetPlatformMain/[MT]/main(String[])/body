{
  String liferayHome=System.getProperty("liferay.home");
  if (liferayHome == null) {
    System.err.println("== -Dliferay.home must point to a valid directory");
    return;
  }
  BytesURLSupport.init();
  String indexesFileName=System.getProperty("indexes.file",liferayHome + "/osgi/" + Indexer.DIR_NAME_TARGET_PLATFORM+ "/target-platform-indexes-"+ System.currentTimeMillis()+ ".zip");
  String moduleFrameworkStaticDirName=System.getProperty("module.framework.static.dir",liferayHome.concat("/osgi/static"));
  String moduleFrameworkModulesDirName=System.getProperty("module.framework.modules.dir",liferayHome.concat("/osgi/modules"));
  String moduleFrameworkPortalDirName=System.getProperty("module.framework.portal.dir",liferayHome.concat("/osgi/portal"));
  String moduleFrameworkMarketplaceDir=System.getProperty("module.framework.marketplace.dir",liferayHome.concat("/osgi/marketplace"));
  List<URI> uris=_index(indexesFileName,moduleFrameworkStaticDirName,moduleFrameworkModulesDirName,moduleFrameworkPortalDirName,moduleFrameworkMarketplaceDir);
  if (_validate(uris)) {
    String integrityPropertiesFileName=System.getProperty("integrity.properties",liferayHome + "/osgi/" + Indexer.DIR_NAME_TARGET_PLATFORM+ "/integrity.properties");
    _updateIntegrityProperties(uris,Paths.get(integrityPropertiesFileName));
  }
}
