{
  try {
    portletDataContext.importPortletPermissions(WikiResourcePermissionChecker.RESOURCE_NAME);
  }
 catch (  PortalException pe) {
    throw new PortletDataException("Unable to import portlet permissions",pe);
  }
  long nodeId=GetterUtil.getLong(portletPreferences.getValue("nodeId",StringPool.BLANK));
  if (nodeId > 0) {
    Map<Long,Long> nodeIds=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(WikiNode.class);
    nodeId=MapUtil.getLong(nodeIds,nodeId,nodeId);
    try {
      portletPreferences.setValue("nodeId",String.valueOf(nodeId));
    }
 catch (    ReadOnlyException roe) {
      throw new PortletDataException("Unable to update portlet preferences during import",roe);
    }
  }
  return portletPreferences;
}
