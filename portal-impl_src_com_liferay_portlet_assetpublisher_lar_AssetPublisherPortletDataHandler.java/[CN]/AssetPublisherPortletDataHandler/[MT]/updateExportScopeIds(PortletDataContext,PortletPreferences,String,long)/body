{
  String[] oldValues=portletPreferences.getValues(key,null);
  if (oldValues == null) {
    return;
  }
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  String companyGroupScopeId=AssetPublisher.SCOPE_ID_GROUP_PREFIX + portletDataContext.getCompanyGroupId();
  String[] newValues=new String[oldValues.length];
  for (int i=0; i < oldValues.length; i++) {
    String oldValue=oldValues[i];
    if (oldValue.startsWith(AssetPublisher.SCOPE_ID_GROUP_PREFIX)) {
      newValues[i]=StringUtil.replace(oldValue,companyGroupScopeId,"[$COMPANY_GROUP_SCOPE_ID$]");
    }
 else     if (oldValue.startsWith(AssetPublisher.SCOPE_ID_LAYOUT_PREFIX)) {
      String scopeIdSuffix=oldValue.substring(AssetPublisher.SCOPE_ID_LAYOUT_PREFIX.length());
      long scopeIdLayoutId=GetterUtil.getLong(scopeIdSuffix);
      Layout scopeIdLayout=LayoutLocalServiceUtil.getLayout(layout.getGroupId(),layout.isPrivateLayout(),scopeIdLayoutId);
      newValues[i]=AssetPublisher.SCOPE_ID_LAYOUT_UUID_PREFIX + scopeIdLayout.getUuid();
    }
 else {
      newValues[i]=oldValue;
    }
  }
  portletPreferences.setValues(key,newValues);
}
