{
  Document document=SAXReaderUtil.read(xml);
  Element rootElement=document.getRootElement();
  String rootPortletId=rootElement.attributeValue("name");
  String instanceId=rootElement.attributeValue("instance");
  String queryString=rootElement.attributeValue("queryString");
  String portletId=rootPortletId;
  if (Validator.isNotNull(instanceId)) {
    portletId+=PortletConstants.INSTANCE_SEPARATOR + instanceId;
  }
  BufferCacheServletResponse bufferCacheServletResponse=new BufferCacheServletResponse(_response);
  HttpServletRequest request=DynamicServletRequest.addQueryString(_request,queryString);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),portletId);
  PortletContainerUtil.render(request,bufferCacheServletResponse,portlet);
  return bufferCacheServletResponse.getString();
}
