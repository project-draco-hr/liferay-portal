{
  ActionableDynamicQuery groupActionableDynamicQuery=GroupLocalServiceUtil.getActionableDynamicQuery();
  groupActionableDynamicQuery.setAddCriteriaMethod(new ActionableDynamicQuery.AddCriteriaMethod(){
    @Override public void addCriteria(    DynamicQuery dynamicQuery){
      Property property=PropertyFactoryUtil.forName("site");
      dynamicQuery.add(property.eq(true));
    }
  }
);
  groupActionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod<Group>(){
    @Override public void performAction(    Group group) throws PortalException {
      verifyPolicy(group);
      ActionableDynamicQuery userGroupRoleActionableDynamicQuery=UserGroupRoleLocalServiceUtil.getActionableDynamicQuery();
      userGroupRoleActionableDynamicQuery.setGroupId(group.getGroupId());
      userGroupRoleActionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod<UserGroupRole>(){
        @Override public void performAction(        UserGroupRole userGroupRole) throws PortalException {
          verifyPolicy(userGroupRole.getRole());
        }
      }
);
      userGroupRoleActionableDynamicQuery.performActions();
    }
  }
);
  groupActionableDynamicQuery.performActions();
}
