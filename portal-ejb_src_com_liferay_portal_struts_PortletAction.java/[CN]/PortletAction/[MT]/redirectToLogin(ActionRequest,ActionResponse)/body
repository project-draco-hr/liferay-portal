{
  if (req.getRemoteUser() == null) {
    HttpServletRequest httpReq=PortalUtil.getHttpServletRequest(req);
    SessionErrors.add(httpReq,PrincipalException.class.getName());
    String mainPath=(String)httpReq.getAttribute(WebKeys.MAIN_PATH);
    res.sendRedirect(mainPath + "/portal/login");
    return true;
  }
 else {
    return false;
  }
}
