{
  if (req.getRemoteUser() == null) {
    HttpServletRequest httpReq=((ActionRequestImpl)req).getHttpServletRequest();
    SessionErrors.add(httpReq,PrincipalException.class.getName());
    String mainPath=(String)httpReq.getAttribute(WebKeys.MAIN_PATH);
    res.sendRedirect(mainPath + "/portal/login");
    return true;
  }
 else {
    return false;
  }
}
