{
  ServletContext servletContext=event.getServletContext();
  String servletContextName=servletContext.getServletContextName();
  if (_log.isDebugEnabled()) {
    _log.debug("Invoking undeploy for " + servletContextName);
  }
  for (Iterator<String> it=_vars.keySet().iterator(); it.hasNext(); ) {
    String path=it.next();
    if (path.startsWith(servletContextName)) {
      String[] pathElements=StringUtil.split(path,"/");
      SocialActivityDefinition activityDefinition=SocialActivitiesUtil.getSocialActivityDefinition(pathElements[1],GetterUtil.getInteger(pathElements[2]));
      if (activityDefinition != null) {
        Object obj=_vars.get(path);
        if (obj instanceof SocialActivityCounterDefinition) {
          activityDefinition.getCounters().remove((SocialActivityCounterDefinition)obj);
        }
 else         if (obj instanceof SocialAchievement) {
          activityDefinition.getAchievements().remove((SocialAchievement)obj);
        }
 else         if (obj instanceof SocialActivityDefinition) {
          SocialActivitiesUtil.removeSocialActivityDefinition(activityDefinition);
        }
      }
      it.remove();
    }
  }
  if (_log.isInfoEnabled()) {
    _log.info("Social plugins for " + servletContextName + " was unregistered");
  }
}
