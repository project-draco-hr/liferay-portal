{
  String companyId=themeDisplay.getCompanyId();
  String userId=themeDisplay.getUserId();
  DLFileEntryPermission.check(themeDisplay.getPermissionChecker(),folderId,name,ActionKeys.VIEW);
  InputStream is=null;
  if (version > 0) {
    is=DLFileEntryLocalServiceUtil.getFileAsStream(companyId,userId,folderId,name,version);
  }
 else {
    is=DLFileEntryLocalServiceUtil.getFileAsStream(companyId,userId,folderId,name);
  }
  ServletResponseUtil.sendFile(res,name,is);
}
