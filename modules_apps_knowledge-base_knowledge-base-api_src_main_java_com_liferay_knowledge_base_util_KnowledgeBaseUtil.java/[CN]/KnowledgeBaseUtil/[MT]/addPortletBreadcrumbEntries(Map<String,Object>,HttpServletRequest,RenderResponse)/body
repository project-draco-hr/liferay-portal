{
  PortletURL portletURL=renderResponse.createRenderURL();
  for (  Map.Entry<String,Object> entry : parameters.entrySet()) {
    Object value=entry.getValue();
    portletURL.setParameter(entry.getKey(),value.toString());
  }
  long kbFolderClassNameId=PortalUtil.getClassNameId(KBFolderConstants.getClassName());
  long parentResourceClassNameId=(Long)parameters.get("parentResourceClassNameId");
  long parentResourcePrimKey=(Long)parameters.get("parentResourcePrimKey");
  String mvcPath=(String)parameters.get("mvcPath");
  if (parentResourcePrimKey == KBFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    PortalUtil.addPortletBreadcrumbEntry(request,themeDisplay.translate("home"),portletURL.toString());
  }
 else   if (parentResourceClassNameId == kbFolderClassNameId) {
    KBFolder kbFolder=KBFolderServiceUtil.getKBFolder(parentResourcePrimKey);
    addPortletBreadcrumbEntries(kbFolder.getClassNameId(),kbFolder.getParentKBFolderId(),mvcPath,request,renderResponse);
    PortalUtil.addPortletBreadcrumbEntry(request,kbFolder.getName(),portletURL.toString());
  }
 else {
    KBArticle kbArticle=KBArticleServiceUtil.getLatestKBArticle(parentResourcePrimKey,WorkflowConstants.STATUS_ANY);
    addPortletBreadcrumbEntries(kbArticle.getParentResourceClassNameId(),kbArticle.getParentResourcePrimKey(),mvcPath,request,renderResponse);
    PortalUtil.addPortletBreadcrumbEntry(request,kbArticle.getTitle(),portletURL.toString());
  }
}
