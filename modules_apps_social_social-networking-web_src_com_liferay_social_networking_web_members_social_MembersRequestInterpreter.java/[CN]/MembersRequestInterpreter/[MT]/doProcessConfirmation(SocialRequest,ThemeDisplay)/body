{
  try {
    String className=request.getClassName();
    if (className.equals(Group.class.getName())) {
      _userLocalService.addGroupUsers(request.getClassPK(),new long[]{request.getUserId()});
    }
 else {
      _userLocalService.addOrganizationUsers(request.getClassPK(),new long[]{request.getUserId()});
    }
    _socialActivityLocalService.addActivity(request.getUserId(),0,className,request.getClassPK(),MembersActivityKeys.ADD_MEMBER,StringPool.BLANK,0);
    processDuplicateRequestsFromUser(request,SocialRequestConstants.STATUS_PENDING);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  return true;
}
