{
  Session session=null;
  try {
    if (userGroup.isNew() || userGroup.isModified()) {
      session=openSession();
      if (userGroup.isNew()) {
        UserGroupHBM userGroupHBM=new UserGroupHBM();
        userGroupHBM.setUserGroupId(userGroup.getUserGroupId());
        userGroupHBM.setCompanyId(userGroup.getCompanyId());
        userGroupHBM.setParentUserGroupId(userGroup.getParentUserGroupId());
        userGroupHBM.setName(userGroup.getName());
        userGroupHBM.setDescription(userGroup.getDescription());
        userGroupHBM.setUsers(new HashSet());
        session.save(userGroupHBM);
        session.flush();
      }
 else {
        UserGroupHBM userGroupHBM=(UserGroupHBM)session.get(UserGroupHBM.class,userGroup.getPrimaryKey());
        if (userGroupHBM != null) {
          userGroupHBM.setCompanyId(userGroup.getCompanyId());
          userGroupHBM.setParentUserGroupId(userGroup.getParentUserGroupId());
          userGroupHBM.setName(userGroup.getName());
          userGroupHBM.setDescription(userGroup.getDescription());
          session.flush();
        }
 else {
          userGroupHBM=new UserGroupHBM();
          userGroupHBM.setUserGroupId(userGroup.getUserGroupId());
          userGroupHBM.setCompanyId(userGroup.getCompanyId());
          userGroupHBM.setParentUserGroupId(userGroup.getParentUserGroupId());
          userGroupHBM.setName(userGroup.getName());
          userGroupHBM.setDescription(userGroup.getDescription());
          session.save(userGroupHBM);
          session.flush();
        }
      }
      userGroup.setNew(false);
      userGroup.setModified(false);
    }
    return userGroup;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
