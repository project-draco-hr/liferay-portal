{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  if (!RoleLocalServiceUtil.hasUserRole(themeDisplay.getUserId(),themeDisplay.getCompanyId(),RoleImpl.ADMINISTRATOR,true)) {
    return StringPool.BLANK;
  }
  List<User> users=UserLocalServiceUtil.search(themeDisplay.getCompanyId(),null,Boolean.TRUE,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  StringMaker sm=new StringMaker(users.size() * 50);
  for (  User user : users) {
    sm.append(user.getFullName());
    sm.append(StringPool.COMMA);
    sm.append(user.getEmailAddress());
    sm.append(StringPool.NEW_LINE);
  }
  return sm.toString();
}
