{
  if (!validate(keyStorePath,keyStoreType,keyStorePassword)) {
    return null;
  }
  String passwordDigestString=getDigestString(keyStorePassword);
  KeyStore keyStore=_keyStores.get(keyStorePath + keyStoreType + passwordDigestString);
  if (keyStore != null) {
    return keyStore;
  }
  keyStore=KeyStore.getInstance(keyStoreType);
  InputStream inputStream=null;
  int index=keyStorePath.indexOf("classpath:");
  if (index != -1) {
    Class<?> clazz=KeyStoreFactory.class;
    inputStream=clazz.getResourceAsStream(keyStorePath.substring(index + 10));
  }
 else {
    inputStream=new FileInputStream(keyStorePath);
  }
  try {
    keyStore.load(inputStream,keyStorePassword.toCharArray());
  }
  finally {
    inputStream.close();
  }
  _keyStores.put(keyStorePath + keyStoreType + passwordDigestString,keyStore);
  return keyStore;
}
