{
  Message message=messagePersistence.findByPrimaryKey(messageId);
  message.setModifiedDate(new Date());
  message.setFolderId(folderId);
  message.setSender(sender);
  message.setTo(to);
  message.setCc(cc);
  message.setBcc(bcc);
  message.setSentDate(sentDate);
  message.setSubject(subject);
  message.setPreview(getPreview(body));
  message.setBody(getBody(body));
  message.setFlags(flags);
  message.setSize(getSize(messageId,body));
  message.setRemoteMessageId(remoteMessageId);
  messagePersistence.update(message);
  Indexer<Message> indexer=IndexerRegistryUtil.getIndexer(Message.class);
  indexer.reindex(message);
  return message;
}
