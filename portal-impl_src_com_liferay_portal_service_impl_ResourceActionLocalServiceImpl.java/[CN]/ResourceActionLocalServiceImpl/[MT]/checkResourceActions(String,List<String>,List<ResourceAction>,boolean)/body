{
  long lastBitwiseValue=1;
  if (!resourceActions.isEmpty()) {
    ResourceAction resourceAction=resourceActions.get(resourceActions.size() - 1);
    lastBitwiseValue=resourceAction.getBitwiseValue();
  }
  List<ResourceAction> newResourceActions=new ArrayList<ResourceAction>();
  int lastBitwiseLogValue=MathUtil.base2Log(lastBitwiseValue);
  for (  String actionId : actionIds) {
    String key=encodeKey(name,actionId);
    ResourceAction resourceAction=_resourceActions.get(key);
    if (resourceAction != null) {
      continue;
    }
    resourceAction=resourceActionPersistence.fetchByN_A(name,actionId);
    if (resourceAction != null) {
      _resourceActions.put(key,resourceAction);
      continue;
    }
    long bitwiseValue=1;
    if (!actionId.equals(ActionKeys.VIEW)) {
      bitwiseValue=MathUtil.base2Pow(++lastBitwiseLogValue);
    }
    long resourceActionId=counterLocalService.increment(ResourceAction.class.getName());
    resourceAction=resourceActionPersistence.create(resourceActionId);
    resourceAction.setName(name);
    resourceAction.setActionId(actionId);
    resourceAction.setBitwiseValue(bitwiseValue);
    resourceActionPersistence.update(resourceAction);
    _resourceActions.put(key,resourceAction);
    newResourceActions.add(resourceAction);
  }
  if (addDefaultActions) {
    List<String> groupDefaultActions=ResourceActionsUtil.getModelResourceGroupDefaultActions(name);
    List<String> guestDefaultActions=ResourceActionsUtil.getModelResourceGuestDefaultActions(name);
    long siteMemberBitwiseValue=0;
    long guestBitwiseValue=0;
    long ownerBitwiseValue=0;
    for (    ResourceAction resourceAction : newResourceActions) {
      String actionId=resourceAction.getActionId();
      if (groupDefaultActions.contains(actionId)) {
        siteMemberBitwiseValue|=resourceAction.getBitwiseValue();
      }
      if (guestDefaultActions.contains(actionId)) {
        guestBitwiseValue|=resourceAction.getBitwiseValue();
      }
      ownerBitwiseValue|=resourceAction.getBitwiseValue();
    }
    if (siteMemberBitwiseValue > 0) {
      resourcePermissionLocalService.addResourcePermissions(name,RoleConstants.SITE_MEMBER,ResourceConstants.SCOPE_INDIVIDUAL,siteMemberBitwiseValue);
    }
    if (guestBitwiseValue > 0) {
      resourcePermissionLocalService.addResourcePermissions(name,RoleConstants.GUEST,ResourceConstants.SCOPE_INDIVIDUAL,guestBitwiseValue);
    }
    if (ownerBitwiseValue > 0) {
      resourcePermissionLocalService.addResourcePermissions(name,RoleConstants.OWNER,ResourceConstants.SCOPE_INDIVIDUAL,ownerBitwiseValue);
    }
  }
}
