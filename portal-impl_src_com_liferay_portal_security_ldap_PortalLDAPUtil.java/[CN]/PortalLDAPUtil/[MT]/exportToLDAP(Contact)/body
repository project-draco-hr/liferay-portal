{
  long companyId=contact.getCompanyId();
  if (!isAuthEnabled(companyId) || !isExportEnabled(companyId)) {
    return;
  }
  LdapContext ctx=getContext(companyId);
  if (ctx == null) {
    return;
  }
  User user=UserLocalServiceUtil.getUserById(companyId,contact.getUserId());
  Properties userMappings=getUserMappings(companyId);
  Binding binding=getUser(contact.getCompanyId(),user.getScreenName());
  String name=StringPool.BLANK;
  if (Validator.isNull(binding)) {
    name=userMappings.getProperty("screenName") + StringPool.EQUAL + user.getScreenName()+ StringPool.COMMA+ getUsersDN(companyId);
    LDAPUser ldapUser=(LDAPUser)Class.forName(PropsUtil.get(PropsUtil.LDAP_USER_IMPL)).newInstance();
    ldapUser.setUser(user);
    ctx.bind(name,ldapUser);
  }
 else {
    name=getNameInNamespace(companyId,binding);
    Modifications mods=Modifications.getInstance();
    mods.addItem(userMappings.getProperty("firstName"),contact.getFirstName());
    mods.addItem(userMappings.getProperty("lastName"),contact.getLastName());
    ModificationItem[] modItems=mods.getItems();
    ctx.modifyAttributes(name,modItems);
  }
  ctx.close();
}
