{
  Properties env=new Properties();
  env.put(Context.INITIAL_CONTEXT_FACTORY,PrefsPropsUtil.getString(companyId,PropsKeys.LDAP_FACTORY_INITIAL));
  env.put(Context.PROVIDER_URL,providerURL);
  env.put(Context.SECURITY_PRINCIPAL,pricipal);
  env.put(Context.SECURITY_CREDENTIALS,credentials);
  env.put(Context.REFERRAL,PrefsPropsUtil.getString(companyId,PropsKeys.LDAP_REFERRAL));
  env.put("com.sun.jndi.ldap.connect.pool","true");
  env.put("com.sun.jndi.ldap.connect.pool.maxsize","50");
  env.put("com.sun.jndi.ldap.connect.pool.timeout","10000");
  LogUtil.debug(_log,env);
  LdapContext ctx=null;
  try {
    ctx=new InitialLdapContext(env,null);
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Failed to bind to the LDAP server");
    }
    if (_log.isDebugEnabled()) {
      _log.debug(e);
    }
  }
  return ctx;
}
