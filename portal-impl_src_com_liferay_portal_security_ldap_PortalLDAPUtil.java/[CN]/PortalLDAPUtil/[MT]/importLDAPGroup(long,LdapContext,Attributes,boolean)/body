{
  Properties groupMappings=getGroupMappings(companyId);
  LogUtil.debug(_log,groupMappings);
  String name=LDAPUtil.getAttributeValue(attrs,groupMappings.getProperty(PortalLDAPUtil.GROUP_MAPPING_GROUP_NAME)).toLowerCase();
  String description=LDAPUtil.getAttributeValue(attrs,groupMappings.getProperty(PortalLDAPUtil.GROUP_MAPPING_DESCRIPTION));
  long creatorUserId=UserLocalServiceUtil.getDefaultUserId(companyId);
  UserGroup userGroup=null;
  try {
    userGroup=UserGroupLocalServiceUtil.getUserGroup(companyId,name);
    UserGroupLocalServiceUtil.updateUserGroup(companyId,userGroup.getUserGroupId(),name,description);
  }
 catch (  NoSuchUserGroupException nsuge) {
    userGroup=UserGroupLocalServiceUtil.addUserGroup(creatorUserId,companyId,name,description);
  }
  if (importGroupMembership && (userGroup != null)) {
    Attribute attr=attrs.get(groupMappings.getProperty(PortalLDAPUtil.GROUP_MAPPING_USER));
    if (attr != null) {
      _importUsersAndMembershipFromLDAPGroup(companyId,ctx,userGroup.getUserGroupId(),attr);
    }
  }
  return userGroup;
}
