{
  UserLocalServiceUtil.clearUserGroupUsers(userGroupId);
  for (int i=0; i < attr.size(); i++) {
    String fullUserDN=(String)attr.get(i);
    Attributes userAttrs=null;
    try {
      userAttrs=getUserAttributes(companyId,ctx,fullUserDN);
    }
 catch (    NameNotFoundException nnfe) {
      _log.error("LDAP user not found with fullUserDN " + fullUserDN);
      _log.error(nnfe,nnfe);
      continue;
    }
    User user=importLDAPUser(companyId,ctx,userAttrs,StringPool.BLANK,false);
    if (user != null) {
      if (_log.isDebugEnabled()) {
        _log.debug("Adding " + user.getUserId() + " to group "+ userGroupId);
      }
      UserLocalServiceUtil.addUserGroupUsers(userGroupId,new long[]{user.getUserId()});
    }
  }
}
