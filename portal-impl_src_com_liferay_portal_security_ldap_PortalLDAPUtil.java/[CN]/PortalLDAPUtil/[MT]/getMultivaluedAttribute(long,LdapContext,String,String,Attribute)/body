{
  if (attribute.size() > 0) {
    return attribute;
  }
  String[] attributeIds={_getNextRange(attribute.getID())};
  while (true) {
    List<SearchResult> searchResults=new ArrayList<SearchResult>();
    searchLDAP(companyId,ldapContext,new byte[0],0,baseDN,filter,attributeIds,searchResults);
    if (searchResults.size() != 1) {
      break;
    }
    SearchResult searchResult=searchResults.get(0);
    Attributes attributes=searchResult.getAttributes();
    if (attributes.size() != 1) {
      break;
    }
    Attribute curAttribute=null;
    NamingEnumeration<? extends Attribute> enu=null;
    try {
      enu=attributes.getAll();
      if (!enu.hasMoreElements()) {
        break;
      }
      curAttribute=enu.nextElement();
    }
  finally {
      if (enu != null) {
        enu.close();
      }
    }
    for (int i=0; i < curAttribute.size(); i++) {
      attribute.add(curAttribute.get(i));
    }
    if (StringUtil.endsWith(curAttribute.getID(),StringPool.STAR) || (curAttribute.size() < PropsValues.LDAP_RANGE_SIZE)) {
      break;
    }
    attributeIds[0]=_getNextRange(attributeIds[0]);
  }
  return attribute;
}
