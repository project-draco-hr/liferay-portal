{
  Name fullDN=new CompositeName().add(fullDistinguishedName);
  Attributes attributes;
  if (attributeIds == null) {
    attributes=ctx.getAttributes(fullDN);
    NamingEnumeration<? extends Attribute> enu=ctx.getAttributes(fullDN,_AUDIT_ATTRIBUTE_NAMES).getAll();
    while (enu.hasMoreElements()) {
      attributes.put(enu.nextElement());
    }
    enu.close();
  }
 else {
    int attributeCount=attributeIds.length + _AUDIT_ATTRIBUTE_NAMES.length;
    String[] allAttributeIds=new String[attributeCount];
    System.arraycopy(attributeIds,0,allAttributeIds,0,attributeIds.length);
    System.arraycopy(_AUDIT_ATTRIBUTE_NAMES,0,allAttributeIds,attributeIds.length,_AUDIT_ATTRIBUTE_NAMES.length);
    attributes=ctx.getAttributes(fullDN,allAttributeIds);
  }
  return attributes;
}
