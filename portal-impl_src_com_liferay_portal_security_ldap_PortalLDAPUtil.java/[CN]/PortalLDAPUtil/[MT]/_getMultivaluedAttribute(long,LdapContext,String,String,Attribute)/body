{
  if (attribute.size() > 0) {
    return attribute;
  }
  String[] attributeIds={_getNextRange(attribute.getID())};
  while (true) {
    List<SearchResult> results=_searchLDAP(companyId,ctx,0,baseDN,filter,attributeIds);
    if (results.size() != 1) {
      break;
    }
    SearchResult result=results.get(0);
    Attributes attributes=result.getAttributes();
    if (attributes.size() != 1) {
      break;
    }
    NamingEnumeration<? extends Attribute> enu=attributes.getAll();
    if (!enu.hasMoreElements()) {
      break;
    }
    Attribute curAttribute=enu.nextElement();
    for (int i=0; i < curAttribute.size(); i++) {
      attribute.add(curAttribute.get(i));
    }
    if (StringUtil.endsWith(curAttribute.getID(),StringPool.STAR) || (curAttribute.size() < PropsValues.LDAP_RANGE_SIZE)) {
      break;
    }
    attributeIds[0]=_getNextRange(attributeIds[0]);
  }
  return attribute;
}
