{
  long companyId=user.getCompanyId();
  if (!isAuthEnabled(companyId) || !isExportEnabled(companyId)) {
    return;
  }
  long ldapServerId=getLdapServerId(companyId,user.getScreenName());
  LdapContext ctx=getContext(ldapServerId,companyId);
  try {
    if (ctx == null) {
      return;
    }
    Properties userMappings=getUserMappings(ldapServerId,companyId);
    Binding binding=getUser(ldapServerId,user.getCompanyId(),user.getScreenName());
    Name name=new CompositeName();
    if (binding == null) {
      _getDNName(ldapServerId,companyId,user,userMappings,name);
      LDAPUser ldapUser=(LDAPUser)Class.forName(PropsValues.LDAP_USER_IMPL).newInstance();
      ldapUser.setUser(user,ldapServerId);
      ctx.bind(name,ldapUser);
      binding=getUser(ldapServerId,user.getCompanyId(),user.getScreenName());
      name=new CompositeName();
    }
    name.add(getNameInNamespace(ldapServerId,companyId,binding));
    Modifications mods=Modifications.getInstance();
    mods.addItem(userMappings.getProperty("firstName"),user.getFirstName());
    String middleNameMapping=userMappings.getProperty("middleName");
    if (Validator.isNotNull(middleNameMapping)) {
      mods.addItem(middleNameMapping,user.getMiddleName());
    }
    mods.addItem(userMappings.getProperty("lastName"),user.getLastName());
    String fullNameMapping=userMappings.getProperty("fullName");
    if (Validator.isNotNull(fullNameMapping)) {
      mods.addItem(fullNameMapping,user.getFullName());
    }
    if (user.isPasswordModified() && Validator.isNotNull(user.getPasswordUnencrypted())) {
      mods.addItem(userMappings.getProperty("password"),user.getPasswordUnencrypted());
    }
    if (Validator.isNotNull(user.getEmailAddress())) {
      mods.addItem(userMappings.getProperty("emailAddress"),user.getEmailAddress());
    }
    String jobTitleMapping=userMappings.getProperty("jobTitle");
    if (Validator.isNotNull(jobTitleMapping)) {
      mods.addItem(jobTitleMapping,user.getJobTitle());
    }
    ModificationItem[] modItems=mods.getItems();
    ctx.modifyAttributes(name,modItems);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
 finally {
    if (ctx != null) {
      ctx.close();
    }
  }
}
