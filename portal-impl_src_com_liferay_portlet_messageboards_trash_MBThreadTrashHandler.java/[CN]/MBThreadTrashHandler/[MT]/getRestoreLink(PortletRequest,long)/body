{
  MBThread thread=MBThreadLocalServiceUtil.getThread(classPK);
  String portletName=PortletKeys.MESSAGE_BOARDS;
  long plid=PortalUtil.getPlidFromPortletId(thread.getGroupId(),PortletKeys.MESSAGE_BOARDS);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    plid=PortalUtil.getControlPanelPlid(portletRequest);
    portletName=PortletKeys.MESSAGE_BOARDS_ADMIN;
  }
  PortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,portletName,plid,PortletRequest.RENDER_PHASE);
  portletURL.setParameter("struts_action","/message_boards_admin/view");
  portletURL.setParameter("mbCategoryId",String.valueOf(thread.getCategoryId()));
  return portletURL.toString();
}
