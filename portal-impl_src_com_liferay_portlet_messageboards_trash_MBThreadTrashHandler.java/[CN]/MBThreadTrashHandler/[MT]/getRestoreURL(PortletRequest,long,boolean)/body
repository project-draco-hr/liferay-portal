{
  String portletId=PortletKeys.MESSAGE_BOARDS;
  MBThread thread=MBThreadLocalServiceUtil.getThread(classPK);
  long plid=PortalUtil.getPlidFromPortletId(thread.getGroupId(),PortletKeys.MESSAGE_BOARDS);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    portletId=PortletKeys.MESSAGE_BOARDS_ADMIN;
    plid=PortalUtil.getControlPanelPlid(portletRequest);
  }
  PortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,portletId,plid,PortletRequest.RENDER_PHASE);
  if (isContainerModel) {
    if (portletId.equals(PortletKeys.MESSAGE_BOARDS)) {
      portletURL.setParameter("struts_action","/message_boards/view");
    }
 else {
      portletURL.setParameter("struts_action","/message_boards_admin/view");
    }
  }
 else {
    if (portletId.equals(PortletKeys.MESSAGE_BOARDS)) {
      portletURL.setParameter("struts_action","/message_boards/view_message");
    }
 else {
      portletURL.setParameter("struts_action","/message_boards_admin/view_message");
    }
  }
  return portletURL;
}
