{
  int pos=name.indexOf(StringPool.PERIOD);
  if (pos != -1) {
    String referenceId=name.substring(pos + 1);
    if (_classLoaderReferenceIds.contains(referenceId)) {
      return true;
    }
    if (referenceId.equals("portal")) {
      Class<?> callerClass7=Reflection.getCallerClass(7);
      if (callerClass7 == BaseAsyncDestination.class) {
        return true;
      }
    }
    return false;
  }
  Class<?> callerClass6=Reflection.getCallerClass(6);
  Class<?> callerClass7=Reflection.getCallerClass(7);
  if (_log.isDebugEnabled()) {
    _log.debug(callerClass7.getName() + " is attempting to get the class loader via " + callerClass6.getName());
  }
  if ((callerClass7 == CachedIntrospectionResults.class) || (callerClass7 == ClassUtils.class) || (callerClass7.getEnclosingClass() == LocalVariableTableParameterNameDiscoverer.class)) {
    if (_log.isInfoEnabled()) {
      _log.info("Allowing " + callerClass7.getName() + " to get the class loader");
    }
    return true;
  }
  if (callerClass6 == Class.class) {
    if (isTomcatJdbcLeakPrevention(callerClass7)) {
      return true;
    }
  }
 else   if (callerClass6 == ClassLoader.class) {
    Thread currentThread=Thread.currentThread();
    StackTraceElement[] stackTraceElements=currentThread.getStackTrace();
    StackTraceElement stackTraceElement=stackTraceElements[6];
    String methodName=stackTraceElement.getMethodName();
    if (methodName.equals(_METHOD_NAME_GET_SYSTEM_CLASS_LOADER)) {
      if (_log.isInfoEnabled()) {
        _log.info("Allowing " + callerClass7.getName() + " to get the system class loader");
      }
      return true;
    }
  }
 else   if (callerClass6 == Thread.class) {
    ClassLoader contextClassLoader=PACLClassLoaderUtil.getContextClassLoader();
    if (isSharedClassLoader(contextClassLoader) || isLocalClassLoader(contextClassLoader)) {
      if (_log.isInfoEnabled()) {
        _log.info("Allowing " + callerClass7.getName() + " to access the context class loader");
      }
      return true;
    }
  }
  return false;
}
