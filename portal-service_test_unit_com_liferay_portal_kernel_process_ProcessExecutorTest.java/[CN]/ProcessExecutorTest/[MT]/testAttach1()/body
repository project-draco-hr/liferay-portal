{
  ServerSocket serverSocket=_createServerSocket(12342);
  try {
    int port=serverSocket.getLocalPort();
    ProcessExecutor.execute(_classPath,_createArguments(),new AttachParentProcessCallable(AttachChildProcessCallable1.class.getName(),port));
    Socket parentSocket=serverSocket.accept();
    assertTrue(ServerThread.isAlive(parentSocket));
    Socket childSocket=serverSocket.accept();
    assertTrue(ServerThread.isAlive(childSocket));
    ServerThread.exit(parentSocket);
    assertFalse(ServerThread.isAlive(parentSocket));
    for (int i=0; i < 10; i++) {
      Thread.sleep(100);
      assertTrue(ServerThread.isAlive(childSocket));
    }
    ServerThread.exit(childSocket);
    assertFalse(ServerThread.isAlive(childSocket));
  }
  finally {
    serverSocket.close();
  }
}
