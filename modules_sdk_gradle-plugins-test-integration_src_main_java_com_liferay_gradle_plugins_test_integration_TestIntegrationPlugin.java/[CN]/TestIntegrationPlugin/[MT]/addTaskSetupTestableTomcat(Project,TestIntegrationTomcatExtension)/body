{
  final SetupTestableTomcatTask setupTestableTomcatTask=GradleUtil.addTask(project,SETUP_TESTABLE_TOMCAT_TASK_NAME,SetupTestableTomcatTask.class);
  setupTestableTomcatTask.onlyIf(new Spec<Task>(){
    @Override public boolean isSatisfiedBy(    Task task){
      _startedAppServersReentrantLock.lock();
      try {
        if (_startedAppServerBinDirs.contains(setupTestableTomcatTask.getBinDir())) {
          return false;
        }
        return true;
      }
  finally {
        _startedAppServersReentrantLock.unlock();
      }
    }
  }
);
  setupTestableTomcatTask.setDir(new Callable<File>(){
    @Override public File call() throws Exception {
      return testIntegrationTomcatExtension.getDir();
    }
  }
);
  setupTestableTomcatTask.setModuleFrameworkBaseDir(new Callable<File>(){
    @Override public File call() throws Exception {
      return new File(testIntegrationTomcatExtension.getLiferayHome(),"osgi");
    }
  }
);
  configureJmxRemotePortSpec(setupTestableTomcatTask,testIntegrationTomcatExtension);
  configureManagerSpec(setupTestableTomcatTask,testIntegrationTomcatExtension);
  return setupTestableTomcatTask;
}
