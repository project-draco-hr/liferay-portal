{
  InputStream is=DLFileEntryLocalServiceUtil.getFileAsStream(dlFileEntry.getUserId(),dlFileEntry.getFileEntryId(),dlFileEntry.getVersion());
  Map<String,Fields> rawMetadataMap=RawMetadataProcessorUtil.getRawMetadataMap(is);
  List<DDMStructure> ddmStructures=DDMStructureLocalServiceUtil.getClassStructures(PortalUtil.getClassNameId(DLFileEntry.class),QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setUserId(dlFileEntry.getUserId());
  serviceContext.setScopeGroupId(dlFileEntry.getGroupId());
  DLFileVersion dlFileVersion=dlFileEntry.getLatestFileVersion();
  DLDocumentMetadataSetLocalServiceUtil.updateDocumentMetadataSets(dlFileEntry.getCompanyId(),0L,dlFileVersion.getFileVersionId(),rawMetadataMap,ddmStructures,serviceContext);
}
