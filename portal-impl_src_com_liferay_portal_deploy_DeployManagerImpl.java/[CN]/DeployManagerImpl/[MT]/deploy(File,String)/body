{
  if (context == null) {
    String fileName=source.getName();
    int pos=fileName.lastIndexOf(StringPool.PERIOD);
    if (pos > 0) {
      context=fileName.substring(0,pos);
    }
 else {
      context=fileName;
    }
  }
  Deployer deployer=null;
  List<String> jars=new ArrayList<String>();
  if (context.endsWith("-ext")) {
    deployer=getExtDeployer(jars);
  }
 else   if (context.endsWith("-hook")) {
    deployer=getHookDeployer(jars);
  }
 else   if (context.endsWith("-layouttpl")) {
    deployer=getLayoutTemplateDeployer();
  }
 else   if (context.endsWith("-portlet")) {
    deployer=getPortletDeployer(jars);
  }
 else   if (context.endsWith("-theme")) {
    deployer=getThemeDeployer(jars);
  }
 else   if (context.endsWith("-web")) {
    deployer=getWebDeployer(jars);
  }
 else {
    if (_log.isWarnEnabled()) {
      _log.warn("Invalid context " + context);
    }
    return;
  }
  deployer.setAppServerType(ServerDetector.getServerId());
  deployer.setBaseDir(PrefsPropsUtil.getString(PropsKeys.AUTO_DEPLOY_DEPLOY_DIR,PropsValues.AUTO_DEPLOY_DEPLOY_DIR));
  deployer.setDestDir(getDeployDir());
  deployer.setFilePattern(StringPool.BLANK);
  deployer.setJbossPrefix(PrefsPropsUtil.getString(PropsKeys.AUTO_DEPLOY_JBOSS_PREFIX,PropsValues.AUTO_DEPLOY_JBOSS_PREFIX));
  deployer.setTomcatLibDir(PrefsPropsUtil.getString(PropsKeys.AUTO_DEPLOY_TOMCAT_LIB_DIR,PropsValues.AUTO_DEPLOY_TOMCAT_LIB_DIR));
  deployer.setUnpackWar(PrefsPropsUtil.getBoolean(PropsKeys.AUTO_DEPLOY_UNPACK_WAR,PropsValues.AUTO_DEPLOY_UNPACK_WAR));
  deployer.setJars(jars);
  List<String> wars=new ArrayList<String>();
  wars.add(source.getAbsolutePath());
  deployer.setWars(wars);
  deployer.checkArguments();
  deployer.deployFile(source,context);
}
