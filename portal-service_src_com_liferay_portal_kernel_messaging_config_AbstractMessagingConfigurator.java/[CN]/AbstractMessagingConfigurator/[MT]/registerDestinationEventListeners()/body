{
  if (_destinationEventListeners.isEmpty()) {
    return;
  }
  Registry registry=RegistryUtil.getRegistry();
  _destinationEventListenerServiceRegistrar=registry.getServiceRegistrar(DestinationEventListener.class);
  for (  final Map.Entry<String,List<DestinationEventListener>> entry : _destinationEventListeners.entrySet()) {
    final String destinationName=entry.getKey();
    ServiceDependencyManager serviceDependencyManager=new ServiceDependencyManager();
    serviceDependencyManager.addServiceDependencyListener(new ServiceDependencyListener(){
      @Override public void dependenciesFulfilled(){
        Map<String,Object> properties=new HashMap<>();
        properties.put("destination.name",destinationName);
        for (        DestinationEventListener destinationEventListener : entry.getValue()) {
          _destinationEventListenerServiceRegistrar.registerService(DestinationEventListener.class,destinationEventListener,properties);
        }
      }
      @Override public void destroy(){
      }
    }
);
    Filter filter=registry.getFilter("(&(destination.name=" + destinationName + ")(objectClass="+ Destination.class.getName()+ "))");
    serviceDependencyManager.registerDependencies(filter);
  }
}
