{
  Element entryElement=portletDataContext.getExportDataElement(entry);
  if (entry.isSmallImage()) {
    Image smallImage=_imageLocalService.fetchImage(entry.getSmallImageId());
    if ((smallImage != null) && (smallImage.getTextObj() != null)) {
      String smallImagePath=ExportImportPathUtil.getModelPath(entry,smallImage.getImageId() + StringPool.PERIOD + smallImage.getType());
      entryElement.addAttribute("small-image-path",smallImagePath);
      entry.setSmallImageType(smallImage.getType());
      portletDataContext.addZipEntry(smallImagePath,smallImage.getTextObj());
    }
 else {
      if (_log.isWarnEnabled()) {
        StringBundler sb=new StringBundler(4);
        sb.append("Unable to export small image with id ");
        sb.append(entry.getSmallImageId());
        sb.append(" to blog entry ");
        sb.append(entry.getEntryId());
        _log.warn(sb.toString());
      }
      entry.setSmallImage(false);
      entry.setSmallImageId(0);
    }
  }
  if (entry.getSmallImageFileEntryId() != 0) {
    FileEntry fileEntry=PortletFileRepositoryUtil.getPortletFileEntry(entry.getSmallImageFileEntryId());
    StagedModelDataHandlerUtil.exportReferenceStagedModel(portletDataContext,entry,fileEntry,PortletDataContext.REFERENCE_TYPE_WEAK);
  }
  if (entry.getCoverImageFileEntryId() != 0) {
    FileEntry fileEntry=PortletFileRepositoryUtil.getPortletFileEntry(entry.getCoverImageFileEntryId());
    StagedModelDataHandlerUtil.exportReferenceStagedModel(portletDataContext,entry,fileEntry,PortletDataContext.REFERENCE_TYPE_WEAK);
  }
  String content=_blogsEntryExportImportContentProcessor.replaceExportContentReferences(portletDataContext,entry,entry.getContent(),portletDataContext.getBooleanParameter("blogs","referenced-content"),true);
  entry.setContent(content);
  portletDataContext.addClassedModel(entryElement,ExportImportPathUtil.getModelPath(entry),entry);
}
