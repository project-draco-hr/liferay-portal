{
  Map parts=new HashMap();
  Iterator itr=in.getPropertyNames().iterator();
  while (itr.hasNext()) {
    String key=(String)itr.next();
    Object value=(Object)in.getProperty(key);
    if (value instanceof String) {
      parts.put(key,value);
    }
  }
  try {
    return HttpUtil.URLtoString(_url,null,parts,true);
  }
 catch (  IOException ioe) {
    throw new MessagingException(ioe.getMessage());
  }
}
