{
  InternetAddress ia=new InternetAddress();
  String[] parts=entry.split(StringPool.LESS_THAN);
  if (parts.length == 2) {
    String name=parts[0].trim();
    if (name.endsWith(StringPool.QUOTE) || name.endsWith(StringPool.APOSTROPHE)) {
      name=name.substring(0,name.length() - 1);
    }
    if (name.startsWith(StringPool.QUOTE) || name.startsWith(StringPool.APOSTROPHE)) {
      name=name.substring(1);
    }
    String address=parts[1].trim();
    if (address.endsWith(StringPool.GREATER_THAN)) {
      address=address.substring(0,address.length() - 1);
    }
    if (!Validator.isAddress(address)) {
      _log.error("Invalid email address " + address);
      throw new EmailAddressException();
    }
    ia.setAddress(address.trim());
    ia.setPersonal(name.trim());
  }
 else   if (parts.length == 1) {
    if (!Validator.isAddress(parts[0])) {
      _log.error("Invalid email address " + parts[0]);
      throw new EmailAddressException();
    }
    ia.setAddress(parts[0].trim());
  }
 else {
    _log.error("Invalid email address " + entry);
    throw new EmailAddressException();
  }
  return ia;
}
