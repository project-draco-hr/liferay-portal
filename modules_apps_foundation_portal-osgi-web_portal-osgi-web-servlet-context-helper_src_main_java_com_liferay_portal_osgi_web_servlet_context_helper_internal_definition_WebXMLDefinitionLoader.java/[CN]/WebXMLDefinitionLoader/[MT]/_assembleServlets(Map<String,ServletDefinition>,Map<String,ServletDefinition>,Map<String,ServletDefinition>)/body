{
  for (  Entry<String,ServletDefinition> entry : fragmentServlets.entrySet()) {
    String servletName=entry.getKey();
    if (!assembledServlets.containsKey(servletName)) {
      fragmentServlets.put(servletName,entry.getValue());
      continue;
    }
    ServletDefinition webXMLServletDefinition=webXMLServlets.get(servletName);
    ServletDefinition fragmentServletDefinition=entry.getValue();
    Map<String,String> webXMLServletParams=null;
    if (webXMLServletDefinition != null) {
      webXMLServletParams=webXMLServletDefinition.getInitParameters();
    }
    Map<String,String> fragmentServletParams=fragmentServletDefinition.getInitParameters();
    ServletDefinition assembledServletDefinition=assembledServlets.get(servletName);
    Map<String,String> assembledInitParams=assembledServletDefinition.getInitParameters();
    for (    Entry<String,String> initParamEntry : fragmentServletParams.entrySet()) {
      String initParamName=initParamEntry.getKey();
      String initParameterValue=initParamEntry.getValue();
      String assembledInitParameterValue=assembledInitParams.get(initParamName);
      String webXMLInitParameterValue=null;
      if (webXMLServletParams != null) {
        webXMLInitParameterValue=webXMLServletParams.get(initParamName);
      }
      if (Validator.isNull(assembledInitParameterValue)) {
        if ((webXMLInitParameterValue == null) && !Validator.equals(assembledInitParameterValue,initParameterValue)) {
          throw new Exception("Conflicts for " + initParamName + " in servlet "+ servletName);
        }
 else {
          assembledInitParams.put(initParamName,initParameterValue);
        }
      }
    }
    List<String> assembledServletURLPatterns=assembledServletDefinition.getURLPatterns();
    List<String> fragmentServletURLPatterns=fragmentServletDefinition.getURLPatterns();
    for (    String urlPattern : fragmentServletURLPatterns) {
      if (!assembledServletURLPatterns.contains(urlPattern)) {
        assembledServletURLPatterns.add(urlPattern);
      }
    }
    if (Validator.isNull(assembledServletDefinition.getJspFile())) {
      assembledServletDefinition.setJSPFile(fragmentServletDefinition.getJspFile());
    }
  }
}
