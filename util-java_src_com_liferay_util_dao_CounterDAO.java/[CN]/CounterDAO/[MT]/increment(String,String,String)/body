{
  long currentId=0;
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection(location);
    StringMaker query=new StringMaker();
    query.append("SELECT currentId FROM " + tableName + " WHERE name = ?");
    ps=con.prepareStatement(query.toString());
    ps.setString(1,rowName);
    rs=ps.executeQuery();
    while (rs.next()) {
      currentId=rs.getInt(1);
    }
    if (currentId == 0) {
      ps=con.prepareStatement("INSERT INTO " + tableName + " (name, currentId) VALUES (?, ?)");
      ps.setString(1,rowName);
      ps.setLong(2,++currentId);
      ps.executeUpdate();
    }
 else {
      ps=con.prepareStatement("UPDATE " + tableName + " SET currentId = ? WHERE name = ?");
      ps.setLong(1,++currentId);
      ps.setString(2,rowName);
      ps.executeUpdate();
    }
  }
 catch (  Exception e) {
    throw new DataAccessException(e);
  }
 finally {
    DataAccess.cleanUp(con,ps,rs);
  }
  return currentId;
}
