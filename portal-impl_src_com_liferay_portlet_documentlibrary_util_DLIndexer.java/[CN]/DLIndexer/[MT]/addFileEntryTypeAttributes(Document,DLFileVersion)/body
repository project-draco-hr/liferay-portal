{
  DLFileEntryType dlFileEntryType=DLFileEntryTypeLocalServiceUtil.getFileEntryType(dlFileVersion.getFileEntryTypeId());
  List<DDMStructure> ddmStructures=dlFileEntryType.getDDMStructures();
  Group group=GroupLocalServiceUtil.getCompanyGroup(dlFileVersion.getCompanyId());
  DDMStructure tikaRawMetadataStructure=DDMStructureLocalServiceUtil.fetchStructure(group.getGroupId(),"TikaRawMetadata");
  if (tikaRawMetadataStructure != null) {
    ddmStructures=ListUtil.copy(ddmStructures);
    ddmStructures.add(tikaRawMetadataStructure);
  }
  for (  DDMStructure ddmStructure : ddmStructures) {
    Fields fields=null;
    try {
      DLFileEntryMetadata fileEntryMetadata=DLFileEntryMetadataLocalServiceUtil.getFileEntryMetadata(ddmStructure.getStructureId(),dlFileVersion.getFileVersionId());
      fields=StorageEngineUtil.getFields(fileEntryMetadata.getDDMStorageId());
    }
 catch (    Exception e) {
    }
    if (fields != null) {
      DDMIndexerUtil.addAttributes(document,ddmStructure,fields);
    }
  }
}
