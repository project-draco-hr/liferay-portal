{
  Set<DDMStructure> ddmStructuresSet=new TreeSet<DDMStructure>();
  long[] groupIds=searchContext.getGroupIds();
  if ((groupIds != null) && (groupIds.length > 0)) {
    List<DLFileEntryType> dlFileEntryTypes=DLFileEntryTypeLocalServiceUtil.getFileEntryTypes(groupIds);
    for (    DLFileEntryType dlFileEntryType : dlFileEntryTypes) {
      ddmStructuresSet.addAll(dlFileEntryType.getDDMStructures());
    }
  }
  for (  DDMStructure ddmStructure : ddmStructuresSet) {
    addSearchDDMStruture(searchQuery,searchContext,ddmStructure);
  }
  addSearchTerm(searchQuery,searchContext,Field.USER_NAME,true);
  addSearchTerm(searchQuery,searchContext,"extension",true);
  addSearchTerm(searchQuery,searchContext,"fileEntryTypeId",false);
  addSearchTerm(searchQuery,searchContext,"path",true);
  LinkedHashMap<String,Object> params=(LinkedHashMap<String,Object>)searchContext.getAttribute("params");
  if (params != null) {
    String expandoAttributes=(String)params.get("expandoAttributes");
    if (Validator.isNotNull(expandoAttributes)) {
      addSearchExpando(searchQuery,searchContext,expandoAttributes);
    }
  }
}
