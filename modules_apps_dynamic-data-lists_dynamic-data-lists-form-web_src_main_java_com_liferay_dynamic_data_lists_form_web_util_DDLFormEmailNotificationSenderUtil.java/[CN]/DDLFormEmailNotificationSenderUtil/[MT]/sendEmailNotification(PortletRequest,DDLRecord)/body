{
  try {
    DDLRecordSet recordSet=record.getRecordSet();
    String emailFromAddress=DDLFormEmailNotificationUtil.getEmailFromAddress(recordSet);
    String emailFromName=DDLFormEmailNotificationUtil.getEmailFromName(recordSet);
    String emailToAddress=DDLFormEmailNotificationUtil.getEmailToAddress(recordSet);
    String subject=DDLFormEmailNotificationUtil.getEmailSubject(recordSet);
    InternetAddress fromInternetAddress=new InternetAddress(emailFromAddress,emailFromName);
    String body=getEmailBody(portletRequest,recordSet,record);
    MailMessage mailMessage=new MailMessage(fromInternetAddress,subject,body,true);
    InternetAddress[] toAddresses=InternetAddress.parse(emailToAddress);
    mailMessage.setTo(toAddresses);
    MailServiceUtil.sendEmail(mailMessage);
  }
 catch (  Exception e) {
    _log.error("The form email could not be sent",e);
  }
}
