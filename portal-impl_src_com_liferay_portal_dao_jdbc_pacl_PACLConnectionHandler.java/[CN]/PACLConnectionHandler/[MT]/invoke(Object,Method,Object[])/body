{
  try {
    String methodName=method.getName();
    if (methodName.equals("equals")) {
      if (proxy == arguments[0]) {
        return true;
      }
 else {
        return false;
      }
    }
 else     if (methodName.equals("hashCode")) {
      return System.identityHashCode(proxy);
    }
 else     if (methodName.equals("prepareCall") || methodName.equals("prepareStatement")) {
      String sql=(String)arguments[0];
      if (!_paclPolicy.hasSQL(sql)) {
        throw new SecurityException("Attempted to execute unapproved SQL " + sql);
      }
    }
    boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
    Object returnValue=null;
    try {
      PortalSecurityManagerThreadLocal.setEnabled(false);
      returnValue=method.invoke(_connection,arguments);
    }
  finally {
      PortalSecurityManagerThreadLocal.setEnabled(enabled);
    }
    if (methodName.equals("createStatement") || methodName.equals("prepareCall") || methodName.equals("prepareStatement")) {
      Statement statement=(Statement)returnValue;
      return ProxyUtil.newProxyInstance(_paclPolicy.getClassLoader(),getInterfaces(returnValue.getClass()),new PACLStatementHandler(statement,_paclPolicy));
    }
    return returnValue;
  }
 catch (  InvocationTargetException ite) {
    throw ite.getTargetException();
  }
}
