{
  URL url=bundle.getEntry("liferay-marketplace.properties");
  if (url == null) {
    return null;
  }
  List<Bundle> bundles=new ArrayList<>();
  Enumeration<URL> jarEntries=bundle.findEntries("/","*.jar",false);
  Enumeration<URL> warEntries=bundle.findEntries("/","*.war",false);
  try {
    bundles.addAll(installArtifacts(jarEntries,new JarArtifactInstaller(_bundleContext)));
    bundles.addAll(installArtifacts(warEntries,new WARArtifactInstaller(_bundleContext)));
    for (    Bundle installedBundle : bundles) {
      installedBundle.start();
    }
    _registerAppInMarketplace(url);
  }
 catch (  Exception e) {
    bundles.add(bundle);
    _uninstallBundles(bundles);
    return null;
  }
  _installedLpkgFiles.put(bundle.getBundleId(),bundles);
  return bundle;
}
