{
  if (_log.isDebugEnabled()) {
    _log.debug("Registering hot deploy listeners");
  }
  for (  HotDeployListener hotDeployListener : getHotDeployListeners()) {
    HotDeployUtil.registerListener(hotDeployListener);
  }
  try {
    if (PrefsPropsUtil.getBoolean(PropsKeys.AUTO_DEPLOY_ENABLED,PropsValues.AUTO_DEPLOY_ENABLED)) {
      if (_log.isInfoEnabled()) {
        _log.info("Registering auto deploy directories");
      }
      File deployDir=new File(PrefsPropsUtil.getString(PropsKeys.AUTO_DEPLOY_DEPLOY_DIR,PropsValues.AUTO_DEPLOY_DEPLOY_DIR));
      File destDir=new File(DeployUtil.getAutoDeployDestDir());
      long interval=PrefsPropsUtil.getLong(PropsKeys.AUTO_DEPLOY_INTERVAL,PropsValues.AUTO_DEPLOY_INTERVAL);
      int blacklistThreshold=PrefsPropsUtil.getInteger(PropsKeys.AUTO_DEPLOY_BLACKLIST_THRESHOLD,PropsValues.AUTO_DEPLOY_BLACKLIST_THRESHOLD);
      List<AutoDeployListener> autoDeployListeners=getAutoDeployListeners();
      AutoDeployDir autoDeployDir=new AutoDeployDir("defaultAutoDeployDir",deployDir,destDir,interval,blacklistThreshold,autoDeployListeners);
      AutoDeployUtil.registerDir(autoDeployDir);
    }
 else {
      if (_log.isInfoEnabled()) {
        _log.info("Not registering auto deploy directories");
      }
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  try {
    JCRFactoryUtil.prepare();
    if (GetterUtil.getBoolean(PropsUtil.get(PropsKeys.JCR_INITIALIZE_ON_STARTUP))) {
      JCRFactoryUtil.initialize();
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  CommLink.getInstance();
  try {
    InfrastructureUtil.getDataSource();
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  try {
    if (!ServerDetector.isJOnAS()) {
      InfrastructureUtil.getMailSession();
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e.getMessage());
    }
  }
  if (PropsValues.POP_SERVER_NOTIFICATIONS_ENABLED) {
    POPServerUtil.start();
  }
  try {
    QuartzSchedulerEngineUtil.init();
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  SchedulerEngineUtil.init(new SchedulerEngineImpl());
  populateMessageBus();
}
