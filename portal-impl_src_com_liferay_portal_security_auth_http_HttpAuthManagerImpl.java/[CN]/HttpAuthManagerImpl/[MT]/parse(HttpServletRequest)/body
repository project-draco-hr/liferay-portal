{
  if (request == null) {
    throw new IllegalArgumentException("HttpServletRequest is mandatory");
  }
  String authorizationHeader=request.getHeader(HttpHeaders.AUTHORIZATION);
  if (Validator.isBlank(authorizationHeader)) {
    return null;
  }
  String[] authorizationHeaderParts=authorizationHeader.split("\\s");
  String scheme=authorizationHeaderParts[0];
  if (StringUtil.equalsIgnoreCase(scheme,HttpAuthorizationHeader.SCHEME_BASIC)) {
    return parseBasic(request,authorizationHeader,authorizationHeaderParts);
  }
 else   if (StringUtil.equalsIgnoreCase(scheme,HttpAuthorizationHeader.SCHEME_DIGEST)) {
    return parseDigest(request,authorizationHeader,authorizationHeaderParts);
  }
 else {
    throw new UnsupportedOperationException("Authorization scheme " + scheme + " is not supported");
  }
}
