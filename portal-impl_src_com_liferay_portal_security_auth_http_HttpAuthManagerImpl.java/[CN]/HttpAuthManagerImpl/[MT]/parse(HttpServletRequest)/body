{
  if (httpServletRequest == null) {
    throw new IllegalArgumentException("HTTP servlet request is null");
  }
  String authorization=httpServletRequest.getHeader(HttpHeaders.AUTHORIZATION);
  if (Validator.isBlank(authorization)) {
    return null;
  }
  String[] authorizationParts=authorization.split("\\s");
  String scheme=authorizationParts[0];
  if (StringUtil.equalsIgnoreCase(scheme,HttpAuthorizationHeader.SCHEME_BASIC)) {
    return parseBasic(httpServletRequest,authorization,authorizationParts);
  }
 else   if (StringUtil.equalsIgnoreCase(scheme,HttpAuthorizationHeader.SCHEME_DIGEST)) {
    return parseDigest(httpServletRequest,authorization,authorizationParts);
  }
 else {
    throw new UnsupportedOperationException("Scheme " + scheme);
  }
}
