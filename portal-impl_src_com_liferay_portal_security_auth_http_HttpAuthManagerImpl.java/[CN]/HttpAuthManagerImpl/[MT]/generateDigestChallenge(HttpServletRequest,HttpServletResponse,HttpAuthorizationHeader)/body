{
  long companyId=PortalInstances.getCompanyId(httpServletRequest);
  String remoteAddress=httpServletRequest.getRemoteAddr();
  String nonce=NonceUtil.generate(companyId,remoteAddress);
  httpAuthorizationHeader.setAuthParameter(HttpAuthorizationHeader.AUTH_PARAMETER_NONCE,nonce);
  httpServletResponse.setHeader(HttpHeaders.WWW_AUTHENTICATE,httpAuthorizationHeader.toString());
  httpServletResponse.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
}
