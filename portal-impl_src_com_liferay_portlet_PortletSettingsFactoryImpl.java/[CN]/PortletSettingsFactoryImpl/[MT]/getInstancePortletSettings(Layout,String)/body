{
  PortletPreferences instancePortletPreferences=PortletPreferencesLocalServiceUtil.getPreferences(layout.getCompanyId(),PortletKeys.PREFS_OWNER_ID_DEFAULT,PortletKeys.PREFS_OWNER_TYPE_LAYOUT,layout.getPlid(),portletId);
  InstancePortletSettings instancePortletSettings=new InstancePortletSettings(instancePortletPreferences);
  PortletPreferences sitePortletPreferences=PortletPreferencesLocalServiceUtil.getPreferences(layout.getCompanyId(),layout.getGroupId(),PortletKeys.PREFS_OWNER_TYPE_LAYOUT_DEFAULTS_GROUP,0,portletId);
  instancePortletSettings.setSiteDefaults(sitePortletPreferences);
  PortletPreferences companyPortletPreferences=PortletPreferencesLocalServiceUtil.getPreferences(layout.getCompanyId(),layout.getCompanyId(),PortletKeys.PREFS_OWNER_TYPE_LAYOUT_DEFAULTS_COMPANY,0,portletId);
  instancePortletSettings.setCompanyDefaults(companyPortletPreferences);
  Properties portalProperties=PropsUtil.getProperties(portletId,false);
  instancePortletSettings.setPortalDefaults(portalProperties);
  return instancePortletSettings;
}
