{
  WSRPPortlet portlet=null;
  if (portletKey != null) {
    portlet=_consumerEnv.getPortletRegistry().getPortlet(portletKey);
    if (portlet == null) {
      String parentHandle=GetterUtil.get((String)preferences.get("parent-handle"),(String)preferences.get("portlet-handle"));
      portlet=_createPortlet(portletKey,parentHandle);
      _consumerEnv.getPortletRegistry().addPortlet(portlet);
    }
  }
  return portlet;
}
