{
  UserProfile userProfile=null;
  Map userInfo=(Map)request.getAttribute(PortletRequest.USER_INFO);
  if (userInfo != null) {
    userProfile=new UserProfile();
    PersonName personName=new PersonName();
    personName.setPrefix((String)userInfo.get("user.name.prefix"));
    personName.setGiven((String)userInfo.get("user.name.given"));
    personName.setFamily((String)userInfo.get("user.name.family"));
    personName.setMiddle((String)userInfo.get("user.name.middle"));
    personName.setSuffix((String)userInfo.get("user.name.suffix"));
    personName.setNickname((String)userInfo.get("user.name.nickName"));
    userProfile.setName(personName);
  }
  return userProfile;
}
