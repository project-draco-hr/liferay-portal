{
  long controlPanelPlid=PortalUtil.getControlPanelPlid(_themeDisplay.getCompanyId());
  String portletId=PortletProviderUtil.getPortletId(assetRendererFactory.getClassName(),PortletProvider.ACTION_BROWSE);
  PortletURL portletURL=PortletURLFactoryUtil.create(_request,portletId,controlPanelPlid,PortletRequest.RENDER_PHASE);
  long groupId=_getAssetBrowserGroupId(assetRendererFactory);
  portletURL.setParameter("groupId",String.valueOf(groupId));
  portletURL.setParameter("selectedGroupIds",StringUtil.merge(PortalUtil.getSharedContentSiteGroupIds(_themeDisplay.getCompanyId(),groupId,_themeDisplay.getUserId())));
  if (_assetEntryId > 0) {
    portletURL.setParameter("refererAssetEntryId",String.valueOf(_assetEntryId));
  }
  portletURL.setParameter("typeSelection",assetRendererFactory.getClassName());
  portletURL.setParameter("eventName",getEventName());
  portletURL.setPortletMode(PortletMode.VIEW);
  portletURL.setWindowState(LiferayWindowState.POP_UP);
  return portletURL;
}
