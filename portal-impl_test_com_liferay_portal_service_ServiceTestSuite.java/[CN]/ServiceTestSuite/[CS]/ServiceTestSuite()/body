{
  InitUtil.initWithSpring();
  FileUtil.deltree(PropsValues.RESOURCE_REPOSITORIES_ROOT);
  try {
    JCRFactoryUtil.prepare();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  LuceneUtil.checkLuceneDir(TestPropsValues.COMPANY_ID);
  MessageBus messageBus=(MessageBus)PortalBeanLocatorUtil.locate(MessageBus.class.getName());
  MessageSender messageSender=(MessageSender)PortalBeanLocatorUtil.locate(MessageSender.class.getName());
  MessageBusUtil.init(messageBus,messageSender);
  SchedulerEngine schedulerEngine=(SchedulerEngine)PortalBeanLocatorUtil.locate(SchedulerEngine.class.getName());
  Destination schedulerDestination=new ParallelDestination(DestinationNames.SCHEDULER);
  messageBus.addDestination(schedulerDestination);
  schedulerDestination.register(new SchedulerMessageListener(schedulerEngine));
  SchedulerEngineUtil.init(new SchedulerEngineProxy());
  try {
    SchedulerEngineUtil.start();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  SchedulerEngineUtil.init(new SchedulerEngineProxy());
  LuceneSearchEngineUtil.init();
  SearchEngineUtil.init(new IndexSearcherImpl(),new IndexWriterImpl());
  addTestSuite(BookmarksFolderServiceTest.class);
  addTestSuite(BookmarksEntryServiceTest.class);
  addTestSuite(DLFileEntryServiceTest.class);
  addTestSuite(IGImageServiceTest.class);
  addTestSuite(MBMessageServiceTest.class);
  addTestSuite(SocialRelationLocalServiceTest.class);
  try {
    CompanyLocalServiceUtil.checkCompany(TestPropsValues.COMPANY_WEB_ID);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
