{
  StringBundler sb=new StringBundler(3);
  Exception e=new Exception();
  StackTraceElement[] stackTraceElements=e.getStackTrace();
  StackTraceElement stackTraceElement=stackTraceElements[2];
  String methodName=stackTraceElement.getMethodName();
  if (!methodName.startsWith("read")) {
    return false;
  }
  stackTraceElement=stackTraceElements[3];
  sb.append(stackTraceElement.getClassName());
  sb.append(StringPool.POUND);
  sb.append(stackTraceElement.getMethodName());
  String callerSignature=sb.toString();
  for (  String whitelistSignature : _XML_SECURITY_WHITELIST) {
    if (callerSignature.startsWith(whitelistSignature)) {
      if (_log.isDebugEnabled()) {
        _log.debug("Unsecure SAX reader allowed for " + callerSignature + " based on the \""+ whitelistSignature+ "\" whitelist");
      }
      return true;
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Unsecure SAX reader disallowed for " + callerSignature);
  }
  return false;
}
