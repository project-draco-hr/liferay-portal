{
  StringBundler sb=new StringBundler(3);
  Exception e=new Exception();
  StackTraceElement[] stackTraceElements=e.getStackTrace();
  StackTraceElement stackTraceElement=stackTraceElements[2];
  if (!stackTraceElement.getMethodName().startsWith("read")) {
    return false;
  }
  stackTraceElement=stackTraceElements[3];
  sb.append(stackTraceElement.getClassName());
  sb.append(StringPool.POUND);
  sb.append(stackTraceElement.getMethodName());
  String callerSignature=sb.toString();
  for (  String whitelistSignature : _XML_SECURITY_WHITELIST) {
    if (callerSignature.startsWith(whitelistSignature)) {
      if (_log.isDebugEnabled()) {
        _log.debug("Unsecure SAXReader allowed for " + callerSignature + " based on '"+ whitelistSignature+ "' rule");
      }
      return true;
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Unsecure SAXReader disallowed for " + callerSignature);
  }
  return false;
}
