{
  Element filesElement=document.createElement("Files");
  rootNode.appendChild(filesElement);
  if (Validator.isNull(commandArgument.getCurrentGroupName())) {
    return;
  }
  Group group=commandArgument.getCurrentGroup();
  Folder folder=_getFolder(group.getGroupId(),commandArgument.getCurrentFolder());
  List<FileEntry> fileEntries=DLAppServiceUtil.getFileEntries(folder.getRepositoryId(),folder.getFolderId());
  for (  FileEntry fileEntry : fileEntries) {
    Element fileElement=document.createElement("File");
    filesElement.appendChild(fileElement);
    fileElement.setAttribute("name",fileEntry.getTitle());
    fileElement.setAttribute("desc",fileEntry.getTitle());
    fileElement.setAttribute("size",getSize(fileEntry.getSize()));
    boolean hasImages=ImageProcessor.hasImages(fileEntry.getFileVersion());
    StringBundler sb=null;
    if (hasImages) {
      sb=new StringBundler(7);
      ThemeDisplay themeDisplay=commandArgument.getThemeDisplay();
      sb.append(themeDisplay.getPathImage());
      sb.append("/image_gallery?uuid=");
      sb.append(fileEntry.getUuid());
      sb.append("&groupId=");
      sb.append(folder.getGroupId());
      sb.append("&t=");
      long largeImageId=fileEntry.getLargeImageId();
      sb.append(WebServerServletTokenUtil.getToken(largeImageId));
    }
 else {
      sb=new StringBundler(6);
      sb.append("/documents/");
      sb.append(group.getGroupId());
      sb.append(StringPool.SLASH);
      sb.append(fileEntry.getFolderId());
      sb.append(StringPool.SLASH);
      sb.append(HttpUtil.encodeURL(fileEntry.getTitle()));
    }
    fileElement.setAttribute("url",sb.toString());
  }
}
