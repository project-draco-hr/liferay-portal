{
  Session session=null;
  try {
    if (image.isNew() || image.isModified()) {
      session=openSession();
      if (image.isNew()) {
        Image imageModel=new Image();
        imageModel.setImageId(image.getImageId());
        imageModel.setModifiedDate(image.getModifiedDate());
        imageModel.setText(image.getText());
        session.save(imageModel);
        session.flush();
      }
 else {
        Image imageModel=(Image)session.get(Image.class,image.getPrimaryKey());
        if (imageModel != null) {
          imageModel.setModifiedDate(image.getModifiedDate());
          imageModel.setText(image.getText());
          session.flush();
        }
 else {
          imageModel=new Image();
          imageModel.setImageId(image.getImageId());
          imageModel.setModifiedDate(image.getModifiedDate());
          imageModel.setText(image.getText());
          session.save(imageModel);
          session.flush();
        }
      }
      image.setNew(false);
      image.setModified(false);
    }
    return image;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
