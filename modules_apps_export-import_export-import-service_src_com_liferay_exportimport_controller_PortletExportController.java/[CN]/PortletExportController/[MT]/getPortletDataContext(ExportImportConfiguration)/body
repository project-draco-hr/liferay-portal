{
  Map<String,Serializable> settingsMap=exportImportConfiguration.getSettingsMap();
  long sourcePlid=MapUtil.getLong(settingsMap,"sourcePlid");
  long sourceGroupId=MapUtil.getLong(settingsMap,"sourceGroupId");
  String portletId=MapUtil.getString(settingsMap,"portletId");
  Map<String,String[]> parameterMap=(Map<String,String[]>)settingsMap.get("parameterMap");
  DateRange dateRange=ExportImportDateUtil.getDateRange(exportImportConfiguration);
  Layout layout=_layoutLocalService.getLayout(sourcePlid);
  ZipWriter zipWriter=ExportImportHelperUtil.getPortletZipWriter(portletId);
  PortletDataContext portletDataContext=PortletDataContextFactoryUtil.createExportPortletDataContext(layout.getCompanyId(),sourceGroupId,parameterMap,dateRange.getStartDate(),dateRange.getEndDate(),zipWriter);
  portletDataContext.setOldPlid(sourcePlid);
  portletDataContext.setPlid(sourcePlid);
  portletDataContext.setPortletId(portletId);
  return portletDataContext;
}
