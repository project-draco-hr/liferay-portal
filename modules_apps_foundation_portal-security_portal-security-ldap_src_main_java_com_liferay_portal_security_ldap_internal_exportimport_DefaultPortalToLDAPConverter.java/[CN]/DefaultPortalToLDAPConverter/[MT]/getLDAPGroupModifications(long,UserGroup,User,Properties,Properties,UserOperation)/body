{
  Modifications modifications=Modifications.getInstance();
  String groupDN=getGroupDNName(ldapServerId,userGroup,groupMappings);
  String userDN=getUserDNName(ldapServerId,user,userMappings);
  if (_portalLDAP.isGroupMember(ldapServerId,user.getCompanyId(),groupDN,userDN)) {
    if (userOperation == UserOperation.REMOVE) {
      modifications.addItem(DirContext.REMOVE_ATTRIBUTE,groupMappings.getProperty(GroupConverterKeys.USER),userDN);
    }
  }
 else {
    if (userOperation == UserOperation.ADD) {
      modifications.addItem(DirContext.ADD_ATTRIBUTE,groupMappings.getProperty(GroupConverterKeys.USER),userDN);
    }
  }
  return modifications;
}
