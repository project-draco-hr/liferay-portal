{
  PortletPreferencesImpl preferences=PortletPreferencesSerializer.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  String selectionStyle=preferences.getValue("selection-style",null);
  if (Validator.isNotNull(selectionStyle) && !selectionStyle.equals("dynamic")) {
    String[] assetEntryXmls=preferences.getValues("asset-entry-xml",new String[0]);
    String[] newAssetEntryXmls=getAssetEntryXmls(assetEntryXmls);
    preferences.setValues("asset-entry-xml",newAssetEntryXmls);
  }
  return PortletPreferencesSerializer.toXML(preferences);
}
