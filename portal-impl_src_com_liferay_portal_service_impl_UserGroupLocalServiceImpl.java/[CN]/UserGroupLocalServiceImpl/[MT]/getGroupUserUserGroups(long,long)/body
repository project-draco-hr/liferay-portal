{
  List<Long> groupUserGroupIds=groupPersistence.getUserGroupIds(groupId);
  if (groupUserGroupIds.isEmpty()) {
    return Collections.emptyList();
  }
  List<Long> userUserGroupIds=userPersistence.getUserGroupIds(userId);
  if (userUserGroupIds.isEmpty()) {
    return Collections.emptyList();
  }
  Set<Long> userGroupIds=SetUtil.intersect(groupUserGroupIds,userUserGroupIds);
  if (userGroupIds.isEmpty()) {
    return Collections.emptyList();
  }
  List<UserGroup> userGroups=new ArrayList<UserGroup>(userGroupIds.size());
  for (  Long userGroupId : userGroupIds) {
    userGroups.add(userGroupPersistence.findByPrimaryKey(userGroupId));
  }
  return userGroups;
}
