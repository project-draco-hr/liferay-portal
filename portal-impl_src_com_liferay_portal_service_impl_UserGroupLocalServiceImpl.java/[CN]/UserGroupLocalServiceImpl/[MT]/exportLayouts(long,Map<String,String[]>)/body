{
  File[] files=new File[2];
  UserGroup userGroup=userGroupPersistence.findByPrimaryKey(userGroupId);
  Group group=userGroup.getGroup();
  User user=userLocalService.getUser(GetterUtil.getLong(PrincipalThreadLocal.getName()));
  if (userGroup.hasPrivateLayouts()) {
    Map<String,Serializable> settingsMap=ExportImportConfigurationSettingsMapFactory.buildSettingsMap(user.getUserId(),group.getGroupId(),true,ExportImportHelperUtil.getAllLayoutIds(group.getGroupId(),true),parameterMap,user.getLocale(),user.getTimeZone());
    ExportImportConfiguration exportImportConfiguration=exportImportConfigurationLocalService.addExportImportConfiguration(user.getUserId(),group.getGroupId(),StringPool.BLANK,StringPool.BLANK,ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT,settingsMap,WorkflowConstants.STATUS_DRAFT,new ServiceContext());
    files[0]=layoutLocalService.exportLayoutsAsFile(exportImportConfiguration);
  }
  if (userGroup.hasPublicLayouts()) {
    Map<String,Serializable> settingsMap=ExportImportConfigurationSettingsMapFactory.buildSettingsMap(user.getUserId(),group.getGroupId(),false,ExportImportHelperUtil.getAllLayoutIds(group.getGroupId(),false),parameterMap,user.getLocale(),user.getTimeZone());
    ExportImportConfiguration exportImportConfiguration=exportImportConfigurationLocalService.addExportImportConfiguration(user.getUserId(),group.getGroupId(),StringPool.BLANK,StringPool.BLANK,ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT,settingsMap,WorkflowConstants.STATUS_DRAFT,new ServiceContext());
    files[1]=layoutLocalService.exportLayoutsAsFile(exportImportConfiguration);
  }
  return files;
}
