{
  UserGroup userGroup=userGroupLocalService.getUserGroup(userGroupId);
  User user=userPersistence.findByPrimaryKey(userId);
  Map<String,String[]> parameterMap=getLayoutTemplatesParameters();
  if (userGroup.hasPrivateLayouts()) {
    long sourceGroupId=userGroup.getGroup().getGroupId();
    long targetGroupId=user.getGroup().getGroupId();
    byte[] bytes=layoutLocalService.exportLayouts(sourceGroupId,true,parameterMap,null,null);
    UnsyncByteArrayInputStream bais=new UnsyncByteArrayInputStream(bytes);
    layoutLocalService.importLayouts(userId,targetGroupId,true,parameterMap,bais);
  }
  if (userGroup.hasPublicLayouts()) {
    long sourceGroupId=userGroup.getGroup().getGroupId();
    long targetGroupId=user.getGroup().getGroupId();
    byte[] bytes=layoutLocalService.exportLayouts(sourceGroupId,false,parameterMap,null,null);
    UnsyncByteArrayInputStream bais=new UnsyncByteArrayInputStream(bytes);
    layoutLocalService.importLayouts(userId,targetGroupId,false,parameterMap,bais);
  }
}
