{
  String language=ParamUtil.getString(actionRequest,"language");
  String script=ParamUtil.getString(actionRequest,"script");
  PortletContext portletContext=portletConfig.getPortletContext();
  Map<String,Object> portletObjects=ScriptingUtil.getPortletObjects(portletConfig,portletContext,actionRequest,actionResponse);
  UnsyncByteArrayOutputStream unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream();
  UnsyncPrintWriter unsyncPrintWriter=UnsyncPrintWriterPool.borrow(unsyncByteArrayOutputStream);
  portletObjects.put("out",unsyncPrintWriter);
  try {
    SessionMessages.add(actionRequest,"language",language);
    SessionMessages.add(actionRequest,"script",script);
    ScriptingUtil.exec(null,portletObjects,language,script);
    unsyncPrintWriter.flush();
    SessionMessages.add(actionRequest,"script_output",unsyncByteArrayOutputStream.toString());
  }
 catch (  ScriptingException se) {
    SessionErrors.add(actionRequest,ScriptingException.class.getName(),se);
    _log.error(se.getMessage());
  }
}
