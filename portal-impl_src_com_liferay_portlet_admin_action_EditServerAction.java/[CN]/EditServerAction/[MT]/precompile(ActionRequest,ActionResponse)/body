{
  Set jsps=new TreeSet();
  ServletContext ctx=(ServletContext)req.getAttribute(WebKeys.CTX);
  Document doc=PortalUtil.readDocumentFromStream(ctx.getResourceAsStream("/WEB-INF/struts-config.xml"));
  Element root=doc.getRootElement();
  Iterator itr1=root.element("global-forwards").elements("forward").iterator();
  while (itr1.hasNext()) {
    Element action=(Element)itr1.next();
    String fileName=action.attributeValue("path");
    if ((Validator.isNotNull(fileName)) && (fileName.endsWith(".jsp"))) {
      jsps.add(fileName);
    }
  }
  itr1=root.element("action-mappings").elements("action").iterator();
  while (itr1.hasNext()) {
    Element action=(Element)itr1.next();
    String fileName=action.attributeValue("forward");
    if ((Validator.isNotNull(fileName)) && (fileName.endsWith(".jsp"))) {
      jsps.add(fileName);
    }
 else {
      Iterator itr2=action.elements("forward").iterator();
      while (itr2.hasNext()) {
        Element forward=(Element)itr2.next();
        fileName=forward.attributeValue("path");
        if ((Validator.isNotNull(fileName)) && (fileName.endsWith(".jsp"))) {
          jsps.add(fileName);
        }
      }
    }
  }
  doc=PortalUtil.readDocumentFromStream(ctx.getResourceAsStream("/WEB-INF/tiles-defs.xml"));
  root=doc.getRootElement();
  itr1=root.elements("definition").iterator();
  while (itr1.hasNext()) {
    Element definition=(Element)itr1.next();
    String fileName=definition.attributeValue("path");
    if ((Validator.isNotNull(fileName)) && (fileName.endsWith(".jsp"))) {
      jsps.add(fileName);
    }
 else {
      Iterator itr2=definition.elements("put").iterator();
      while (itr2.hasNext()) {
        Element put=(Element)itr2.next();
        fileName=put.attributeValue("value");
        if ((Validator.isNotNull(fileName)) && (fileName.endsWith(".jsp"))) {
          jsps.add(fileName);
        }
      }
    }
  }
  HttpServletRequest httpReq=PortalUtil.getHttpServletRequest(req);
  HttpServletResponse httpRes=new NullServletResponse(PortalUtil.getHttpServletResponse(res));
  itr1=jsps.iterator();
  while (itr1.hasNext()) {
    try {
      String jsp=StrutsUtil.TEXT_HTML_DIR + itr1.next();
      RequestDispatcher rd=ctx.getRequestDispatcher(jsp);
      if (rd != null) {
        if (_log.isInfoEnabled()) {
          _log.info("Precompiling " + jsp);
        }
        rd.include(httpReq,httpRes);
      }
    }
 catch (    Exception e) {
      _log.debug(e,e);
    }
  }
}
