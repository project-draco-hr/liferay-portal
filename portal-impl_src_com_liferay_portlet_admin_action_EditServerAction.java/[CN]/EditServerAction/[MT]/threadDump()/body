{
  String jvm=System.getProperty("java.vm.name") + " " + System.getProperty("java.vm.version");
  StringBuffer sb=null;
  sb=new StringBuffer("Full thread dump " + jvm + "\n\n");
  Map<Thread,StackTraceElement[]> stackTraces=Thread.getAllStackTraces();
  Iterator<Thread> itr=stackTraces.keySet().iterator();
  while (itr.hasNext()) {
    Thread thread=itr.next();
    StackTraceElement[] elements=stackTraces.get(thread);
    sb.append(StringPool.QUOTE);
    sb.append(thread.getName());
    sb.append(StringPool.QUOTE);
    if (thread.getThreadGroup() != null) {
      sb.append(StringPool.SPACE);
      sb.append(StringPool.OPEN_PARENTHESIS);
      sb.append(thread.getThreadGroup().getName());
      sb.append(StringPool.CLOSE_PARENTHESIS);
    }
    sb.append(", priority=" + thread.getPriority());
    sb.append(", id=" + thread.getId());
    sb.append(", state=" + thread.getState());
    sb.append("\n");
    for (int i=0; i < elements.length; i++) {
      sb.append("\t" + elements[i] + "\n");
    }
    sb.append("\n");
  }
  if (_log.isInfoEnabled()) {
    _log.info(sb.toString());
  }
 else {
    _log.error("Thread dumps require the log level to be at least INFO for " + this.getClass().getName());
  }
}
