{
  String language=ParamUtil.getString(actionRequest,"language");
  String script=ParamUtil.getString(actionRequest,"script");
  PortletConfig portletConfig=(PortletConfig)actionRequest.getAttribute(JavaConstants.JAVAX_PORTLET_CONFIG);
  PortletContext portletContext=portletConfig.getPortletContext();
  Map<String,Object> portletObjects=ScriptingUtil.getPortletObjects(portletConfig,portletContext,actionRequest,actionResponse);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(new StringServletOutputStream(baos));
  portletObjects.put("out",ps);
  try {
    ScriptingUtil.exec(null,portletObjects,language,script);
    SessionMessages.add(actionRequest,"scriptOut",baos.toString());
  }
 catch (  ScriptingException se) {
    SessionErrors.add(actionRequest,ScriptingException.class.getName(),se);
    _log.error(se.getMessage());
  }
}
