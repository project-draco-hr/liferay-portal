{
  Set<String> portletIds=new LinkedHashSet<>();
  for (int index=0; ; ) {
    index=content.indexOf(PortletLogic.OPEN_TAG,index);
    if (index == -1) {
      break;
    }
    int close1=content.indexOf(PortletLogic.CLOSE_1_TAG,index);
    int close2=content.indexOf(PortletLogic.CLOSE_2_TAG,index);
    int closeIndex=-1;
    if ((close2 == -1) || ((close1 != -1) && (close1 < close2))) {
      closeIndex=close1 + PortletLogic.CLOSE_1_TAG.length();
    }
 else {
      closeIndex=close2 + PortletLogic.CLOSE_2_TAG.length();
    }
    if (closeIndex == -1) {
      break;
    }
    portletIds.add(getRuntimePortletId(content.substring(index,closeIndex)));
    index=closeIndex;
  }
  return portletIds;
}
