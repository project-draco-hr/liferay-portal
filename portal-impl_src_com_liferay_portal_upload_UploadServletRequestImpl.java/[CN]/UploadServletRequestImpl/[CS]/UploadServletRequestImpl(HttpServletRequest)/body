{
  super(request);
  _params=new LinkedHashMap<String,LiferayFileItem[]>();
  try {
    ServletFileUpload servletFileUpload=new LiferayFileUpload(new LiferayFileItemFactory(getTempDir()),request);
    servletFileUpload.setSizeMax(PrefsPropsUtil.getLong(PropsKeys.UPLOAD_SERVLET_REQUEST_IMPL_MAX_SIZE));
    _liferayServletRequest=new LiferayServletRequest(request);
    List<LiferayFileItem> liferayFileItemsList=servletFileUpload.parseRequest(_liferayServletRequest);
    for (    LiferayFileItem liferayFileItem : liferayFileItemsList) {
      if (liferayFileItem.isFormField()) {
        liferayFileItem.setString(request.getCharacterEncoding());
      }
      LiferayFileItem[] liferayFileItems=_params.get(liferayFileItem.getFieldName());
      if (liferayFileItems == null) {
        liferayFileItems=new LiferayFileItem[]{liferayFileItem};
      }
 else {
        LiferayFileItem[] newLiferayFileItems=new LiferayFileItem[liferayFileItems.length + 1];
        System.arraycopy(liferayFileItems,0,newLiferayFileItems,0,liferayFileItems.length);
        newLiferayFileItems[newLiferayFileItems.length - 1]=liferayFileItem;
        liferayFileItems=newLiferayFileItems;
      }
      _params.put(liferayFileItem.getFieldName(),liferayFileItems);
    }
  }
 catch (  Exception e) {
    LiferayFileUploadUtil.storeFileUploadException(request,e);
    _log.error(e,e);
  }
}
