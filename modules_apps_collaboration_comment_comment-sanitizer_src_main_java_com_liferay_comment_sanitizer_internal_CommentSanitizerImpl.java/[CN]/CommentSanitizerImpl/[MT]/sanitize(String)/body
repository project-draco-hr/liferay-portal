{
  HtmlPolicyBuilder htmlPolicyBuilder=new HtmlPolicyBuilder();
  htmlPolicyBuilder.allowStandardUrlProtocols();
  Map<String,String[]> attributeNames=_commentAllowedContent.getAttributeNames();
  for (  Map.Entry<String,String[]> entry : attributeNames.entrySet()) {
    String elementName=entry.getKey();
    String[] attributesNames=entry.getValue();
    if (attributesNames != null) {
      HtmlPolicyBuilder.AttributeBuilder attributeBuilder=htmlPolicyBuilder.allowAttributes(attributesNames);
      attributeBuilder.onElements(elementName);
    }
    htmlPolicyBuilder.allowElements(elementName);
  }
  PolicyFactory policyFactory=htmlPolicyBuilder.toFactory();
  return policyFactory.sanitize(html);
}
