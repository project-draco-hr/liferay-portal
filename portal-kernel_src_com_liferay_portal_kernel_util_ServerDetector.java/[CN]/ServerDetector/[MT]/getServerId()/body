{
  ServerDetector sd=_instance;
  if (sd._serverId == null) {
    if (ServerDetector.isGeronimo()) {
      sd._serverId="geronimo";
    }
 else     if (ServerDetector.isGlassfish()) {
      sd._serverId="glassfish";
    }
 else     if (ServerDetector.isJBoss()) {
      sd._serverId="jboss";
    }
 else     if (ServerDetector.isJOnAS()) {
      sd._serverId="jonas";
    }
 else     if (ServerDetector.isOC4J()) {
      sd._serverId="oc4j";
    }
 else     if (ServerDetector.isOrion()) {
      sd._serverId="orion";
    }
 else     if (ServerDetector.isPramati()) {
      sd._serverId="pramati";
    }
 else     if (ServerDetector.isResin()) {
      sd._serverId="resin";
    }
 else     if (ServerDetector.isRexIP()) {
      sd._serverId="rexip";
    }
 else     if (ServerDetector.isSun7()) {
      sd._serverId="sun7";
    }
 else     if (ServerDetector.isSun8()) {
      sd._serverId="sun8";
    }
 else     if (ServerDetector.isWebLogic()) {
      sd._serverId="weblogic";
    }
 else     if (ServerDetector.isWebSphere()) {
      sd._serverId="websphere";
    }
    if (ServerDetector.isJetty()) {
      if (sd._serverId == null) {
        sd._serverId="jetty";
      }
 else {
        sd._serverId+="-jetty";
      }
    }
 else     if (ServerDetector.isTomcat()) {
      if (sd._serverId == null) {
        sd._serverId="tomcat";
      }
 else {
        sd._serverId+="-tomcat";
      }
    }
    if (_log.isInfoEnabled()) {
      _log.info("Detected server " + sd._serverId);
    }
    if (sd._serverId == null) {
      throw new RuntimeException("Server is not supported");
    }
  }
  return sd._serverId;
}
