{
  boolean imageMagickEnabled=ParamUtil.getBoolean(actionRequest,"imageMagickEnabled");
  String imageMagickPath=ParamUtil.getString(actionRequest,"imageMagickPath");
  boolean openOfficeEnabled=ParamUtil.getBoolean(actionRequest,"openOfficeEnabled");
  int openOfficePort=ParamUtil.getInteger(actionRequest,"openOfficePort");
  boolean xugglerEnabled=ParamUtil.getBoolean(actionRequest,"xugglerEnabled");
  portletPreferences.setValue(PropsKeys.IMAGEMAGICK_ENABLED,String.valueOf(imageMagickEnabled));
  portletPreferences.setValue(PropsKeys.IMAGEMAGICK_GLOBAL_SEARCH_PATH,imageMagickPath);
  portletPreferences.setValue(PropsKeys.OPENOFFICE_SERVER_ENABLED,String.valueOf(openOfficeEnabled));
  portletPreferences.setValue(PropsKeys.OPENOFFICE_SERVER_PORT,String.valueOf(openOfficePort));
  portletPreferences.setValue(PropsKeys.XUGGLER_ENABLED,String.valueOf(xugglerEnabled));
  Enumeration<String> enu=actionRequest.getParameterNames();
  while (enu.hasMoreElements()) {
    String name=enu.nextElement();
    if (name.startsWith("imageMagickLimit")) {
      String key=StringUtil.toLowerCase(name.substring(16,name.length()));
      String value=ParamUtil.getString(actionRequest,name);
      portletPreferences.setValue(PropsKeys.IMAGEMAGICK_RESOURCE_LIMIT + key,value);
    }
  }
  portletPreferences.store();
  GhostscriptUtil.reset();
  ImageMagickUtil.reset();
}
