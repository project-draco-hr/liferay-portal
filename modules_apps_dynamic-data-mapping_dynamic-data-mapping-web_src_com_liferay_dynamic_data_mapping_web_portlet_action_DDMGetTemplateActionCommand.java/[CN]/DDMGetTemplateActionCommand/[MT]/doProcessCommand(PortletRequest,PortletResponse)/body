{
  long templateId=ParamUtil.getLong(portletRequest,"templateId");
  DDMTemplate template=_ddmTemplateService.getTemplate(templateId);
  String script=template.getScript();
  String contentType=null;
  String type=template.getType();
  String language=GetterUtil.getString(template.getLanguage(),TemplateConstants.LANG_TYPE_VM);
  if (type.equals(DDMTemplateConstants.TEMPLATE_TYPE_FORM) || language.equals(TemplateConstants.LANG_TYPE_XSL)) {
    contentType=ContentTypes.TEXT_XML_UTF8;
  }
 else {
    contentType=ContentTypes.TEXT_PLAIN_UTF8;
  }
  HttpServletRequest httpServletRequest=PortalUtil.getHttpServletRequest(portletRequest);
  HttpServletResponse httpServletResponse=PortalUtil.getHttpServletResponse(portletResponse);
  ServletResponseUtil.sendFile(httpServletRequest,httpServletResponse,null,script.getBytes(),contentType);
}
