{
  List<Element> elements=ifElement.elements();
  Set<String> elementNames=new HashSet<>();
  boolean hasAllowedIfConditionElementNames=false;
  for (  Element element : elements) {
    String elementName=element.getName();
    elementNames.add(elementName);
    if (ArrayUtil.contains(allowedIfConditionElementNames,elementName)) {
      hasAllowedIfConditionElementNames=true;
    }
    String ifElementName=ifElement.getName();
    if (elementName.equals("and") || elementName.equals("not") || elementName.equals("or")) {
      validateIfElement(fileName,element,allowedBlockChildElementNames,allowedExecuteAttributeNames,allowedExecuteChildElementNames,allowedIfConditionElementNames);
    }
 else     if (elementName.equals("condition")) {
      validateExecuteElement(fileName,element,allowedExecuteAttributeNames,".*(is|Is).+",allowedExecuteChildElementNames);
    }
 else     if (elementName.equals("contains")) {
      validateSimpleElement(fileName,element,new String[]{"string","substring"});
      if (fileName.endsWith(".function")) {
        Pattern pattern=Pattern.compile("\\$\\{(locator|value)[0-9]+\\}");
        List<Attribute> attributes=element.attributes();
        for (        Attribute attribute : attributes) {
          String attributeValue=attribute.getValue();
          Matcher matcher=pattern.matcher(attributeValue);
          if (attributeValue.contains("${") && attributeValue.contains("}") && !matcher.find()) {
            throwValidationException(1006,fileName,element,attribute.getName());
          }
        }
      }
    }
 else     if (elementName.equals("else")) {
      if (ifElementName.equals("while")) {
        throwValidationException(1002,fileName,element,elementName);
      }
      validateBlockElement(fileName,element,allowedBlockChildElementNames,allowedExecuteAttributeNames,allowedExecuteChildElementNames,allowedIfConditionElementNames);
    }
 else     if (elementName.equals("elseif")) {
      if (ifElementName.equals("while")) {
        throwValidationException(1002,fileName,element,elementName);
      }
      validateIfElement(fileName,element,allowedBlockChildElementNames,allowedExecuteAttributeNames,allowedExecuteChildElementNames,allowedIfConditionElementNames);
    }
 else     if (elementName.equals("equals")) {
      validateSimpleElement(fileName,element,new String[]{"arg1","arg2"});
    }
 else     if (elementName.equals("isset")) {
      validateSimpleElement(fileName,element,new String[]{"var"});
    }
 else     if (elementName.equals("then")) {
      validateBlockElement(fileName,element,allowedBlockChildElementNames,allowedExecuteAttributeNames,allowedExecuteChildElementNames,allowedIfConditionElementNames);
    }
 else {
      throwValidationException(1002,fileName,element,elementName);
    }
  }
  if (!hasAllowedIfConditionElementNames) {
    throwValidationException(1001,fileName,ifElement,allowedIfConditionElementNames);
  }
  if (Validator.equals(ifElement.getName(),"and") || Validator.equals(ifElement.getName(),"not") || Validator.equals(ifElement.getName(),"or")) {
    return;
  }
  if (!elementNames.contains("then")) {
    throwValidationException(1001,fileName,ifElement,new String[]{"then"});
  }
}
