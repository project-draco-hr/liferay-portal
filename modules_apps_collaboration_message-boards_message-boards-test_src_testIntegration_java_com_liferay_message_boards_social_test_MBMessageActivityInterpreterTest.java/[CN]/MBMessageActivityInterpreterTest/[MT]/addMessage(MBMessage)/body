{
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(group.getGroupId(),TestPropsValues.getUserId());
  long categoryId=MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID;
  long parentMessageId=MBMessageConstants.DEFAULT_PARENT_MESSAGE_ID;
  long threadId=0;
  if (parentMessage != null) {
    categoryId=parentMessage.getCategoryId();
    parentMessageId=parentMessage.getMessageId();
    threadId=parentMessage.getThreadId();
  }
  return MBMessageLocalServiceUtil.addMessage(TestPropsValues.getUserId(),RandomTestUtil.randomString(),group.getGroupId(),categoryId,threadId,parentMessageId,RandomTestUtil.randomString(),RandomTestUtil.randomString(),MBMessageConstants.DEFAULT_FORMAT,Collections.<ObjectValuePair<String,InputStream>>emptyList(),false,0.0,false,serviceContext);
}
