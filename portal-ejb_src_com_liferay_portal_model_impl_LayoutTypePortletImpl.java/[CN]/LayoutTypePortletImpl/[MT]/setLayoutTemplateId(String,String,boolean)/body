{
  if (checkPermission && !PluginSettingLocalServiceUtil.hasPermission(userId,newLayoutTemplateId,LayoutTemplateImpl.PLUGIN_TYPE)) {
    return;
  }
  String oldLayoutTemplateId=getLayoutTemplateId();
  getTypeSettingsProperties().setProperty(LAYOUT_TEMPLATE_ID,newLayoutTemplateId);
  if (Validator.isNull(oldLayoutTemplateId)) {
    return;
  }
  LayoutTemplate oldLayoutTemplate=LayoutTemplateLocalUtil.getLayoutTemplate(oldLayoutTemplateId,false,null);
  if (oldLayoutTemplate == null) {
    return;
  }
  LayoutTemplate newLayoutTemplate=LayoutTemplateLocalUtil.getLayoutTemplate(newLayoutTemplateId,false,null);
  List oldColumns=oldLayoutTemplate.getColumns();
  List newColumns=newLayoutTemplate.getColumns();
  if (newColumns.size() < oldColumns.size()) {
    String lastNewColumnId=(String)newColumns.get(newColumns.size() - 1);
    String lastNewColumnValue=getTypeSettingsProperties().getProperty(lastNewColumnId);
    for (int i=newColumns.size() - 1; i < oldColumns.size(); i++) {
      String oldColumnId=(String)oldColumns.get(i);
      String oldColumnValue=(String)getTypeSettingsProperties().remove(oldColumnId);
      String[] portletIds=StringUtil.split(oldColumnValue);
      for (int j=0; j < portletIds.length; j++) {
        lastNewColumnValue=StringUtil.add(lastNewColumnValue,portletIds[j]);
      }
    }
    getTypeSettingsProperties().setProperty(lastNewColumnId,lastNewColumnValue);
  }
}
