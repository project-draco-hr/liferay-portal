{
  PortletPreferences preferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  if (portletId.startsWith("101")) {
    updatePreferencesClassPKs(preferences,"anyClassTypeJournalArticleAssetRendererFactory");
    updatePreferencesClassPKs(preferences,"classTypeIds");
    updatePreferencesClassPKs(preferences,"classTypeIdsJournalArticleAssetRendererFactory");
  }
 else   if (portletId.startsWith("56")) {
    String templateId=preferences.getValue("templateId",StringPool.BLANK);
    if (Validator.isNotNull(templateId)) {
      preferences.reset("templateId");
      preferences.setValue("ddmTemplateKey",templateId);
    }
  }
 else   if (portletId.startsWith("62")) {
    String structureId=preferences.getValue("structureId",StringPool.BLANK);
    if (Validator.isNotNull(structureId)) {
      preferences.reset("structureId");
      preferences.setValue("ddmStructureKey",structureId);
    }
  }
  return PortletPreferencesFactoryUtil.toXML(preferences);
}
