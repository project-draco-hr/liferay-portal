{
  String strutsAction=ParamUtil.getString(request,"struts_action");
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (strutsAction.startsWith("/login/facebook_connect") || !_facebookConnect.isEnabled(themeDisplay.getCompanyId())) {
    return;
  }
  String facebookAuthRedirectURL=_facebookConnect.getRedirectURL(themeDisplay.getCompanyId());
  request.setAttribute("facebookAuthRedirectURL",facebookAuthRedirectURL);
  String facebookAuthURL=_facebookConnect.getAuthURL(themeDisplay.getCompanyId());
  request.setAttribute("facebookAuthURL",facebookAuthURL);
  String facebookAppId=_facebookConnect.getAppId(themeDisplay.getCompanyId());
  request.setAttribute("facebookAppId",facebookAppId);
  RequestDispatcher requestDispatcher=_servletContext.getRequestDispatcher(_JSP_PATH);
  try {
    requestDispatcher.include(request,response);
  }
 catch (  ServletException se) {
    if (_log.isErrorEnabled()) {
      _log.error("Unable to include jsp",se);
    }
    throw new IOException("Unable to include jsp",se);
  }
}
