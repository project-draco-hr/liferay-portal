{
  String protocol=mailingListRequest.getInProtocol();
  String host=mailingListRequest.getInServerName();
  int port=mailingListRequest.getInServerPort();
  String user=mailingListRequest.getInUserName();
  String password=mailingListRequest.getInPassword();
  Account account=Account.getInstance(protocol,port);
  account.setHost(host);
  account.setPort(port);
  account.setUser(user);
  account.setPassword(password);
  Session session=MailEngine.getSession(account);
  URLName urlName=new URLName(protocol,host,port,StringPool.BLANK,user,password);
  Store store=session.getStore(urlName);
  store.connect();
  Folder defaultFolder=store.getDefaultFolder();
  Folder[] folders=defaultFolder.list();
  if (folders != null && folders.length == 0) {
    throw new MessagingException("Inbox not found");
  }
  Folder inboxFolder=folders[0];
  inboxFolder.open(Folder.READ_WRITE);
  return inboxFolder;
}
