{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  String emailMessageSubject=ParamUtil.getString(actionRequest,"emailMessageSubject");
  String emailMessageBody=ParamUtil.getString(actionRequest,"emailMessageBody");
  if (Validator.isNull(emailMessageSubject)) {
    SessionErrors.add(actionRequest,"emailMessageSubject");
  }
 else   if (Validator.isNull(emailMessageBody)) {
    SessionErrors.add(actionRequest,"emailMessageBody");
  }
 else {
    String portletResource=ParamUtil.getString(actionRequest,"portletResource");
    PortletPreferences preferences=PortletPreferencesFactoryUtil.getPortletSetup(actionRequest,portletResource);
    preferences.setValue("email-message-subject",emailMessageSubject);
    preferences.setValue("email-message-body",emailMessageBody);
    preferences.store();
    SessionMessages.add(actionRequest,portletConfig.getPortletName() + ".doConfigure");
  }
}
