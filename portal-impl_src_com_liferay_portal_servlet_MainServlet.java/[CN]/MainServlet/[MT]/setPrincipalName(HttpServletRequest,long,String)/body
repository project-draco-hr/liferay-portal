{
  if ((userId == 0) && (remoteUser == null)) {
    try {
      long companyId=PortalUtil.getCompanyId(request);
      Company company=CompanyLocalServiceUtil.getCompany(companyId);
      User user=company.getDefaultUser();
      userId=user.getUserId();
    }
 catch (    Exception e) {
    }
  }
  String name=String.valueOf(userId);
  if (!PropsValues.PORTAL_JAAS_ENABLE) {
    if (remoteUser != null) {
      name=remoteUser;
    }
  }
  PrincipalThreadLocal.setName(name);
}
