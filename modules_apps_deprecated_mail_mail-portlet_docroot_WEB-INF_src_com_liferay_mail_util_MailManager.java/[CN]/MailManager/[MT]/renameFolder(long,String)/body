{
  Folder folder=FolderLocalServiceUtil.getFolder(folderId);
  try {
    Mailbox mailbox=MailboxFactoryUtil.getMailbox(_user.getUserId(),folder.getAccountId(),_passwordRetriever.getPassword(folder.getAccountId()));
    mailbox.renameFolder(folderId,displayName);
    return createJSONResult("success","folder-renamed-successfully");
  }
 catch (  MailException me) {
    if (me.getType() == MailException.FOLDER_RENAME_FAILED) {
      return createJSONResult("failure","cannot-move-messages-to-this-folder");
    }
 else     if (me.getType() == MailException.FOLDER_ALREADY_EXISTS) {
      return createJSONResult("failure","a-folder-with-the-same-name-already-exists");
    }
    _log.error(me,me);
    return createJSONResult("failure","unable-to-rename-folder");
  }
}
