{
  Template template=getTemplate(renderRequest);
  Map<String,Object> capabilitiesContext=new HashMap<>();
  HttpServletRequest httpServletRequest=PortalUtil.getHttpServletRequest(renderRequest);
  String imageEditorURL=ParamUtil.getString(httpServletRequest,"imageEditorURL");
  capabilitiesContext.put("tools",getImageEditorToolsContext(renderRequest));
  ThemeDisplay themeDisplay=(ThemeDisplay)httpServletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  template.put("capabilities",capabilitiesContext);
  template.put("image",imageEditorURL);
  template.put("pathThemeImages",themeDisplay.getPathThemeImages());
  ResourceBundle resourceBundle=_resourceBundleLoader.loadResourceBundle(themeDisplay.getLanguageId());
  Map<String,Object> strings=new HashMap<>();
  for (  String key : resourceBundle.keySet()) {
    strings.put(key,LanguageUtil.get(resourceBundle,key));
  }
  template.put("strings",strings);
  return "ImageEditor";
}
