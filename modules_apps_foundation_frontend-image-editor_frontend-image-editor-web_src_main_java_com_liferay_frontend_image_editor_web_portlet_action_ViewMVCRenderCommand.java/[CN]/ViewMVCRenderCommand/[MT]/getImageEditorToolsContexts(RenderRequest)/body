{
  List<Map<String,Object>> imageEditorToolsContexts=new ArrayList<>();
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  List<ImageEditorCapabilityDescriptor> toolImageEditorCapabilityDescriptors=_imageEditorCapabilityTracker.getImageEditorCapabilityDescriptors("tool");
  if (toolImageEditorCapabilityDescriptors == null) {
    return imageEditorToolsContexts;
  }
  List<List<ImageEditorCapabilityDescriptor>> imageEditorCapabilityDescriptorsList=getImageEditorCapabilityDescriptorsList(toolImageEditorCapabilityDescriptors);
  for (  List<ImageEditorCapabilityDescriptor> imageEditorCapabilityDescriptors : imageEditorCapabilityDescriptorsList) {
    Map<String,Object> context=new HashMap<>();
    List<Map<String,Object>> controls=new ArrayList<>();
    String icon=StringPool.BLANK;
    for (    ImageEditorCapabilityDescriptor imageEditorCapabilityDescriptor : imageEditorCapabilityDescriptors) {
      Map<String,Object> control=new HashMap<>();
      ImageEditorCapability imageEditorCapability=imageEditorCapabilityDescriptor.getImageEditorCapability();
      control.put("label",imageEditorCapability.getLabel(themeDisplay.getLocale()));
      ServletContext servletContext=imageEditorCapability.getServletContext();
      control.put("modulePath",servletContext.getContextPath());
      Map<String,Object> properties=imageEditorCapabilityDescriptor.getProperties();
      String variant=GetterUtil.getString(properties.get("com.liferay.frontend.image.editor.capability." + "controls"));
      control.put("variant",variant);
      HttpServletRequest httpServletRequest=PortalUtil.getHttpServletRequest(renderRequest);
      imageEditorCapability.prepareContext(control,httpServletRequest);
      controls.add(control);
      icon=GetterUtil.getString(properties.get("com.liferay.frontend.image.editor.capability.icon"));
    }
    context.put("controls",controls);
    context.put("icon",icon);
    imageEditorToolsContexts.add(context);
  }
  return imageEditorToolsContexts;
}
