{
  SearchContext searchContext=getSearchContext();
  FacetConfiguration facetConfiguration=getFacetConfiguration();
  JSONObject dataJSONObject=facetConfiguration.getData();
  String[] values=null;
  if (isStatic() && dataJSONObject.has("values")) {
    JSONArray valuesJSONArray=dataJSONObject.getJSONArray("values");
    values=new String[valuesJSONArray.length()];
    for (int i=0; i < valuesJSONArray.length(); i++) {
      values[i]=valuesJSONArray.getString(i);
    }
  }
  String[] valuesParam=StringUtil.split(GetterUtil.getString(searchContext.getAttribute(getFieldId())));
  if (!isStatic() && (valuesParam != null) && (valuesParam.length > 0)) {
    values=valuesParam;
  }
  if (ArrayUtil.isEmpty(values)) {
    return null;
  }
  BooleanFilter facetBooleanFilter=new BooleanFilter();
  for (  String value : values) {
    FacetValueValidator facetValueValidator=getFacetValueValidator();
    if ((searchContext.getUserId() > 0) && !facetValueValidator.check(searchContext,value)) {
      continue;
    }
    TermFilter termFilter=new TermFilter(getFieldName(),value);
    facetBooleanFilter.add(termFilter,BooleanClauseOccur.SHOULD);
  }
  if (!facetBooleanFilter.hasClauses()) {
    return null;
  }
  return BooleanClauseFactoryUtil.createFilter(searchContext,facetBooleanFilter,BooleanClauseOccur.MUST);
}
