{
  PortletURL viewFullContentURL=liferayPortletResponse.createRenderURL();
  viewFullContentURL.setParameter("mvcPath","/view_content.jsp");
  viewFullContentURL.setParameter("assetEntryId",String.valueOf(assetEntry.getEntryId()));
  AssetRendererFactory<?> assetRendererFactory=assetEntry.getAssetRendererFactory();
  AssetRenderer<?> assetRenderer=assetEntry.getAssetRenderer();
  viewFullContentURL.setParameter("type",assetRendererFactory.getType());
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (Validator.isNotNull(assetRenderer.getUrlTitle())) {
    if (assetRenderer.getGroupId() != themeDisplay.getScopeGroupId()) {
      viewFullContentURL.setParameter("groupId",String.valueOf(assetRenderer.getGroupId()));
    }
    viewFullContentURL.setParameter("urlTitle",assetRenderer.getUrlTitle());
  }
  String viewURL=null;
  String currentURL=null;
  if (viewInContext) {
    currentURL=PortalUtil.getCurrentURL(liferayPortletRequest);
    viewFullContentURL.setParameter("redirect",currentURL);
    try {
      String noSuchEntryRedirect=viewFullContentURL.toString();
      viewURL=assetRenderer.getURLViewInContext(liferayPortletRequest,liferayPortletResponse,noSuchEntryRedirect);
      if (Validator.isNotNull(viewURL) && !Validator.equals(viewURL,noSuchEntryRedirect)) {
        viewURL=HttpUtil.setParameter(viewURL,"inheritRedirect",Boolean.TRUE);
        viewURL=HttpUtil.setParameter(viewURL,"redirect",currentURL);
      }
    }
 catch (    Exception e) {
    }
  }
 else {
    PortletURL currentURLObj=PortletURLUtil.getCurrent(liferayPortletRequest,liferayPortletResponse);
    currentURL=currentURLObj.toString();
    viewFullContentURL.setParameter("redirect",currentURL);
  }
  if (Validator.isNull(viewURL)) {
    viewURL=viewFullContentURL.toString();
  }
  return viewURL;
}
