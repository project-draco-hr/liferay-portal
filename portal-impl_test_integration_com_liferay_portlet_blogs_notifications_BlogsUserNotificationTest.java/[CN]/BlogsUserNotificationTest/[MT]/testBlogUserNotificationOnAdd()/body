{
  int initialUserNotificationEventsCount=UserNotificationEventLocalServiceUtil.getUserNotificationEventsCount(_user.getUserId());
  BlogsEntry entry=addBlogsEntry();
  Assert.assertEquals(1,_logRecords.size());
  LogRecord logRecord=_logRecords.get(0);
  Assert.assertEquals("No mail has been sent","Sending email",logRecord.getMessage());
  List<JSONObject> entryUserNotificationEventsJsonObjects=getEntryUserNotificationEventsJsonObjects(_user.getUserId(),entry.getEntryId());
  if (entryUserNotificationEventsJsonObjects.isEmpty()) {
    Assert.fail("userNotification doesn't exists for this entry");
  }
  List<UserNotificationEvent> userNotificationEvents=getUserNotificationEvents(_user.getUserId());
  Assert.assertEquals(initialUserNotificationEventsCount + 1,userNotificationEvents.size());
  Assert.assertEquals(1,entryUserNotificationEventsJsonObjects.size());
  for (  JSONObject jsonObject : entryUserNotificationEventsJsonObjects) {
    Assert.assertEquals(UserNotificationDefinition.NOTIFICATION_TYPE_ADD_ENTRY,jsonObject.getInt("notificationType"));
  }
}
