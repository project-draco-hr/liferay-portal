{
  Iterator itr=blogsCategoryPersistence.findByParentCategoryId(category.getCategoryId()).iterator();
  while (itr.hasNext()) {
    BlogsCategory curCategory=(BlogsCategory)itr.next();
    deleteCategory(curCategory);
  }
  itr=blogsEntryPersistence.findByCategoryId(category.getCategoryId()).iterator();
  while (itr.hasNext()) {
    BlogsEntry entry=(BlogsEntry)itr.next();
    entry.setCategoryId(BlogsCategoryImpl.DEFAULT_PARENT_CATEGORY_ID);
    blogsEntryPersistence.update(entry);
    try {
      String[] tagsEntries=tagsEntryLocalService.getEntryNames(BlogsEntry.class.getName(),entry.getEntryId());
      Indexer.updateEntry(entry.getCompanyId(),entry.getGroupId(),entry.getUserId(),category.getCategoryId(),entry.getEntryId(),entry.getTitle(),entry.getContent(),tagsEntries);
    }
 catch (    IOException ioe) {
      _log.error("Indexing " + entry.getEntryId(),ioe);
    }
  }
  resourceLocalService.deleteResource(category.getCompanyId(),BlogsCategory.class.getName(),ResourceImpl.SCOPE_INDIVIDUAL,category.getCategoryId());
  blogsCategoryPersistence.remove(category.getCategoryId());
}
