{
  if (configurationURL == null) {
    throw new NullPointerException("Configuration path is null");
  }
  Configuration ehcacheConfiguration=ConfigurationFactory.parseConfiguration(configurationURL);
  ehcacheConfiguration.setName(portalCacheManagerName);
  boolean clusterEnabled=GetterUtil.getBoolean(props.get(PropsKeys.CLUSTER_LINK_ENABLED));
  boolean clusterLinkReplicationEnabled=GetterUtil.getBoolean(props.get(PropsKeys.EHCACHE_CLUSTER_LINK_REPLICATION_ENABLED));
  _handlePeerFactoryConfigurations(ehcacheConfiguration.getCacheManagerPeerProviderFactoryConfiguration(),clusterAware,clusterEnabled,clusterLinkReplicationEnabled,props);
  _handlePeerFactoryConfigurations(ehcacheConfiguration.getCacheManagerPeerListenerFactoryConfigurations(),clusterAware,clusterEnabled,clusterLinkReplicationEnabled,props);
  Set<Properties> cacheManagerListenerConfigurations=_getCacheManagerListenerConfigurations(ehcacheConfiguration,props);
  PortalCacheConfiguration defaultPortalCacheConfiguration=_parseCacheConfiguration(ehcacheConfiguration.getDefaultCacheConfiguration(),clusterAware,usingDefault,clusterEnabled,clusterLinkReplicationEnabled,props);
  Set<PortalCacheConfiguration> portalCacheConfigurations=new HashSet<>();
  Map<String,CacheConfiguration> cacheConfigurations=ehcacheConfiguration.getCacheConfigurations();
  for (  Map.Entry<String,CacheConfiguration> entry : cacheConfigurations.entrySet()) {
    portalCacheConfigurations.add(_parseCacheConfiguration(entry.getValue(),clusterAware,usingDefault,clusterEnabled,clusterLinkReplicationEnabled,props));
  }
  PortalCacheManagerConfiguration portalCacheManagerConfiguration=new PortalCacheManagerConfiguration(cacheManagerListenerConfigurations,defaultPortalCacheConfiguration,portalCacheConfigurations);
  return new ObjectValuePair<>(ehcacheConfiguration,portalCacheManagerConfiguration);
}
