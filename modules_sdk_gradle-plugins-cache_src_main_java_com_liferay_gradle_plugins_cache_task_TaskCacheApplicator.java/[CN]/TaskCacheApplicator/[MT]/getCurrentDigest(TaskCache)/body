{
  Clock clock=null;
  if (_logger.isInfoEnabled()) {
    clock=new Clock();
  }
  StringBuilder sb=new StringBuilder();
  SortedSet<File> testFiles=null;
  try {
    testFiles=FileUtil.flattenAndSort(taskCache.getTestFiles());
  }
 catch (  IOException ioe) {
    throw new GradleException("Unable to flatten test files",ioe);
  }
  if (taskCache.isExcludeIgnoredTestFiles()) {
    FileUtil.removeIgnoredFiles(taskCache.getProject(),testFiles);
  }
  for (  File testFile : testFiles) {
    if (!testFile.exists()) {
      continue;
    }
    if (".DS_Store".equals(testFile.getName())) {
      continue;
    }
    sb.append(FileUtil.getDigest(testFile));
    sb.append(_DIGEST_SEPARATOR);
  }
  if (sb.length() == 0) {
    throw new GradleException("At least one test file is required");
  }
  sb.setLength(sb.length() - 1);
  if (_logger.isInfoEnabled() && (clock != null)) {
    _logger.info("Getting the current digest took " + clock.getTimeInMs() + " ms");
  }
  return sb.toString();
}
