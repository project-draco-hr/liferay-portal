{
  TaskContainer taskContainer=project.getTasks();
  taskContainer.withType(Test.class,new Action<Test>(){
    @Override public void execute(    Test test){
      configureTaskTestDefaultCharacterEncoding(test);
      configureTaskTestForkEvery(test);
      configureTaskTestIgnoreFailures(test);
      configureTaskTestJvmArgs(test);
      configureTaskTestWhip(test);
    }
  }
);
  project.afterEvaluate(new Action<Project>(){
    @Override public void execute(    Project project){
      TaskContainer taskContainer=project.getTasks();
      final LiferayExtension liferayExtension=GradleUtil.getExtension(project,LiferayExtension.class);
      taskContainer.withType(Test.class,new Action<Test>(){
        @Override public void execute(        Test test){
          configureTaskTestIncludes(test);
          configureTaskTestSystemProperties(test,liferayExtension);
        }
      }
);
    }
  }
);
}
