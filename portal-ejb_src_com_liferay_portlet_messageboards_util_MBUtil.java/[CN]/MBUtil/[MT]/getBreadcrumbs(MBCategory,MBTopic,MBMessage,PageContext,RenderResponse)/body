{
  if ((message != null) && (topic == null)) {
    topic=MBTopicLocalServiceUtil.getTopic(message.getTopicId());
  }
  if ((topic != null) && (category == null)) {
    category=topic.getCategory();
  }
  PortletURL categoriesURL=res.createRenderURL();
  categoriesURL.setWindowState(WindowState.MAXIMIZED);
  categoriesURL.setParameter("struts_action","/message_boards/view");
  String categoriesLink="<a href=\"" + categoriesURL.toString() + "\">"+ LanguageUtil.get(pageContext,"categories")+ "</a>";
  if (category == null) {
    return categoriesLink;
  }
  String breadcrumbs=StringPool.BLANK;
  if (category != null) {
    for (int i=0; ; i++) {
      PortletURL portletURL=res.createRenderURL();
      portletURL.setWindowState(WindowState.MAXIMIZED);
      portletURL.setParameter("struts_action","/message_boards/view");
      portletURL.setParameter("categoryId",category.getCategoryId());
      String categoryLink="<a href=\"" + portletURL.toString() + "\">"+ category.getName()+ "</a>";
      if (i == 0) {
        breadcrumbs=categoryLink;
      }
 else {
        breadcrumbs=categoryLink + " &raquo; " + breadcrumbs;
      }
      if (category.isRoot()) {
        break;
      }
      category=MBCategoryLocalServiceUtil.getCategory(category.getParentCategoryId());
    }
  }
  breadcrumbs=categoriesLink + " &raquo; " + breadcrumbs;
  if (topic != null) {
    PortletURL topicURL=res.createRenderURL();
    topicURL.setWindowState(WindowState.MAXIMIZED);
    topicURL.setParameter("struts_action","/message_boards/view_topic");
    topicURL.setParameter("topicId",topic.getTopicId());
    String topicLink="<a href=\"" + topicURL.toString() + "\">"+ topic.getName()+ "</a>";
    breadcrumbs=breadcrumbs + " &raquo; " + topicLink;
  }
  if (message != null) {
    PortletURL messageURL=res.createRenderURL();
    messageURL.setWindowState(WindowState.MAXIMIZED);
    messageURL.setParameter("struts_action","/message_boards/view_message");
    messageURL.setParameter("messageId",message.getMessageId());
    messageURL.setParameter("topicId",topic.getTopicId());
    String messageLink="<a href=\"" + messageURL.toString() + "\">"+ message.getSubject()+ "</a>";
    breadcrumbs=breadcrumbs + " &raquo; " + messageLink;
  }
  return breadcrumbs;
}
