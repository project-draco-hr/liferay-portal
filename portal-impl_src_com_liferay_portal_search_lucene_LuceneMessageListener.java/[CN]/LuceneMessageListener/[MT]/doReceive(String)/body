{
  JSONObject jsonObj=new JSONObject(message);
  String responseDestination=jsonObj.optString("lfrResponseDestination");
  String responseId=jsonObj.optString("lfrResponseId");
  jsonObj.remove("lfrResponseDestination");
  jsonObj.remove("lfrResponseId");
  SearchEngineRequest searchEngineRequest=(SearchEngineRequest)JSONUtil.deserialize(message);
  String command=searchEngineRequest.getCommand();
  long companyId=searchEngineRequest.getCompanyId();
  String id=searchEngineRequest.getId();
  Document doc=searchEngineRequest.getDocument();
  if (command.equals(SearchEngineRequest.COMMAND_ADD)) {
    LuceneSearchEngineUtil.addDocument(companyId,doc);
  }
 else   if (command.equals(SearchEngineRequest.COMMAND_DELETE)) {
    LuceneSearchEngineUtil.deleteDocument(companyId,id);
  }
 else   if (command.equals(SearchEngineRequest.COMMAND_DELETE_PORTLET_DOCS)) {
    LuceneSearchEngineUtil.deletePortletDocuments(companyId,id);
  }
 else   if (command.equals(SearchEngineRequest.COMMAND_INDEX_ONLY) && Validator.isNotNull(responseDestination) && Validator.isNotNull(responseId)) {
    doCommandIndexOnly(responseDestination,responseId);
  }
 else   if (command.equals(SearchEngineRequest.COMMAND_SEARCH) && Validator.isNotNull(responseDestination) && Validator.isNotNull(responseId)) {
    doCommandSearch(responseDestination,responseId,searchEngineRequest);
  }
 else   if (command.equals(SearchEngineRequest.COMMAND_UPDATE)) {
    LuceneSearchEngineUtil.updateDocument(companyId,id,doc);
  }
}
