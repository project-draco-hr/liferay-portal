{
  String rootPortletId=getRootPortletId(portletId);
  StringBundler sb=new StringBundler(5);
  sb.append(rootPortletId);
  if (userId <= 0) {
    userId=getUserId(portletId);
  }
  if (userId > 0) {
    sb.append(USER_SEPARATOR);
    sb.append(userId);
  }
  if (Validator.isNull(instanceId)) {
    instanceId=getInstanceId(portletId);
  }
  if (Validator.isNotNull(instanceId)) {
    sb.append(INSTANCE_SEPARATOR);
    sb.append(instanceId);
  }
  return sb.toString();
}
