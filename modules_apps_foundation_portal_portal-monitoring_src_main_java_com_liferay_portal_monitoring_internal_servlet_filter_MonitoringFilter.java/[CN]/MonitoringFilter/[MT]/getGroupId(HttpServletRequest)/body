{
  long groupId=ParamUtil.getLong(request,"groupId");
  if (groupId > 0) {
    return groupId;
  }
  Layout layout=(Layout)request.getAttribute(WebKeys.LAYOUT);
  if (layout != null) {
    return layout.getGroupId();
  }
  long plid=ParamUtil.getLong(request,"p_l_id");
  if ((plid > 0) && (_layoutLocalService != null)) {
    try {
      layout=_layoutLocalService.getLayout(plid);
      groupId=layout.getGroupId();
    }
 catch (    PortalException pe) {
      if (_log.isDebugEnabled()) {
        _log.debug("Unable to retrieve layout " + plid,pe);
      }
    }
  }
  return groupId;
}
