{
  Method method=methodInvocation.getMethod();
  Object[] arguments=methodInvocation.getArguments();
  long plid=(Long)arguments[2];
  String portletId=(String)arguments[3];
  if (portletId.equals(PortletKeys.LIFERAY_PORTAL) || (plid <= 0)) {
    return methodInvocation.proceed();
  }
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  if (!LayoutStagingUtil.isBranchingLayout(layout)) {
    return methodInvocation.proceed();
  }
  LayoutRevision layoutRevision=LayoutStagingUtil.getLayoutRevision(layout);
  arguments[2]=layoutRevision.getLayoutRevisionId();
  return method.invoke(methodInvocation.getThis(),arguments);
}
