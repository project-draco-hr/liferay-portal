{
  LookupService lookupService=_lookupService;
  if (lookupService != null) {
    return lookupService;
  }
  IPGeocoderConfiguration igGeocoderConfiguration=ConfigurableUtil.createConfigurable(IPGeocoderConfiguration.class,_properties);
  String filePath=igGeocoderConfiguration.filePath();
  if ((filePath == null) || filePath.equals("")) {
    filePath=System.getProperty("java.io.tmpdir") + "/liferay/geoip/GeoIPCity.dat";
  }
  try {
    File ipGeocoderFile=getIPGeocoderFile(filePath,igGeocoderConfiguration.fileURL(),false);
    lookupService=new LookupService(ipGeocoderFile,LookupService.GEOIP_MEMORY_CACHE);
    _lookupService=lookupService;
    return lookupService;
  }
 catch (  IOException ioe) {
    _logger.error("Unable to activate Liferay IP Geocoder",ioe);
    throw new RuntimeException("Unable to activate Liferay IP Geocoder",ioe);
  }
}
