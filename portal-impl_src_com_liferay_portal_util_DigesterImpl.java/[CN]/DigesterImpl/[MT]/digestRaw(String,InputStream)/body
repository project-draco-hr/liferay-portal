{
  MessageDigest messageDigest=null;
  try {
    messageDigest=MessageDigest.getInstance(algorithm);
    byte[] buffer=new byte[StreamUtil.BUFFER_SIZE];
    int readBytes=0;
    while ((readBytes=inputStream.read(buffer)) != -1) {
      if (readBytes > 0) {
        messageDigest.update(buffer,0,readBytes);
      }
    }
  }
 catch (  IOException ie) {
    _log.error(ie,ie);
  }
catch (  NoSuchAlgorithmException nsae) {
    _log.error(nsae,nsae);
  }
 finally {
    StreamUtil.cleanUp(inputStream);
  }
  return messageDigest.digest();
}
