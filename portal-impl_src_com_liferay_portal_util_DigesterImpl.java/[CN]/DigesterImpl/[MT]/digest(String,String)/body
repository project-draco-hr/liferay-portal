{
  MessageDigest messageDigest=null;
  try {
    messageDigest=MessageDigest.getInstance(algorithm);
    messageDigest.update(text.getBytes(Digester.ENCODING));
  }
 catch (  NoSuchAlgorithmException nsae) {
    _log.error(nsae,nsae);
  }
catch (  UnsupportedEncodingException uee) {
    _log.error(uee,uee);
  }
  byte[] bytes=messageDigest.digest();
  if (_BASE_64) {
    return Base64.encode(bytes);
  }
 else {
    return new String(Hex.encodeHex(bytes));
  }
}
