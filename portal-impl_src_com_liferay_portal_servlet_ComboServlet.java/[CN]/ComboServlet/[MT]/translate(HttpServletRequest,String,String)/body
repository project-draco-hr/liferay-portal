{
  String languageId=LanguageUtil.getLanguageId(request);
  Locale locale=LocaleUtil.fromLanguageId(languageId);
  ResourceBundle resourceBundle=LanguageResources.getResourceBundle(locale);
  Portlet portlet=PortletLocalServiceUtil.getPortletById(portletId);
  if (portlet != null) {
    PortletConfig portletConfig=PortletConfigFactoryUtil.create(portlet,getServletContext());
    if (portletConfig != null) {
      resourceBundle=new AggregateResourceBundle(portletConfig.getResourceBundle(locale),resourceBundle);
    }
  }
  return LanguageUtil.process(resourceBundle,locale,stringFileContent);
}
