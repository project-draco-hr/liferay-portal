{
  String contextPath=PortalUtil.getPathContext();
  String[] modulePaths=request.getParameterValues("m");
  if ((modulePaths == null) || (modulePaths.length == 0)) {
    response.sendError(HttpServletResponse.SC_BAD_REQUEST);
    return;
  }
  String firstModulePath=modulePaths[0];
  String extension=FileUtil.getExtension(firstModulePath);
  boolean containsCSS=extension.equalsIgnoreCase(_CSS_EXTENSION);
  String p=ParamUtil.getString(request,"p");
  String minifierType=ParamUtil.getString(request,"minifierType");
  int length=modulePaths.length;
  byte[][] bytesArray=new byte[length][];
  if (Validator.isNull(minifierType)) {
    minifierType="js";
    if (containsCSS) {
      minifierType="css";
    }
  }
  for (  String modulePath : modulePaths) {
    byte[] bytes=new byte[0];
    if (Validator.isNotNull(modulePath)) {
      modulePath=StringUtil.replaceFirst(p.concat(modulePath),contextPath,StringPool.BLANK);
      bytes=getFileContent(modulePath,minifierType);
    }
    bytesArray[--length]=bytes;
  }
  String contentType=ContentTypes.TEXT_JAVASCRIPT;
  if (containsCSS) {
    contentType=ContentTypes.TEXT_CSS;
  }
  response.setContentType(contentType);
  ServletResponseUtil.write(response,bytesArray);
}
