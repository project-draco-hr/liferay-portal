{
  String languageId=LanguageUtil.getLanguageId(request);
  Locale locale=LocaleUtil.fromLanguageId(languageId);
  PortletApp portletApp=PortletLocalServiceUtil.getPortletApp(contextPath);
  List<Portlet> portlets=Collections.emptyList();
  if ((portletApp != null) && portletApp.isWARFile()) {
    portlets=portletApp.getPortlets();
  }
  ResourceBundle resourceBundle=LanguageResources.getResourceBundle(locale);
  if (portlets.size() > 0) {
    PortletConfig portletConfig=PortletConfigFactoryUtil.create(portlets.get(0),getServletContext());
    if (portletConfig != null) {
      resourceBundle=new AggregateResourceBundle(portletConfig.getResourceBundle(locale),resourceBundle);
    }
  }
  stringFileContent=LanguageUtil.expandKeys(resourceBundle,locale,stringFileContent);
  return stringFileContent;
}
