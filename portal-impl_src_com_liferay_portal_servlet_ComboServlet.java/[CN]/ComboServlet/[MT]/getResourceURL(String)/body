{
  String portletId=getModulePortletId(modulePath);
  String resourcePath=getResourcePath(modulePath);
  Portlet portlet=PortletLocalServiceUtil.getPortletById(portletId);
  if (portlet.isUndeployedPortlet()) {
    return null;
  }
  PortletApp portletApp=portlet.getPortletApp();
  ServletContext servletContext=portletApp.getServletContext();
  URL url=servletContext.getResource(resourcePath);
  if (url == null) {
    throw new ServletException("Resource " + resourcePath + " does not exist in '"+ portlet.getContextPath()+ "'");
  }
  return url;
}
