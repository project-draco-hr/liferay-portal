{
  String parts[]=cn.split("\\.");
  boolean match=false;
  String firstpart=parts[0];
  if (firstpart.length() > 1) {
    String prefix=firstpart.substring(0,firstpart.length() - 1);
    String suffix=cn.substring(firstpart.length());
    String hostSuffix=hostName.substring(prefix.length());
    match=hostName.startsWith(prefix) && hostSuffix.endsWith(suffix);
  }
 else {
    match=hostName.endsWith(cn.substring(1));
  }
  if (match) {
    match=countDots(hostName) == countDots(cn);
  }
  return match;
}
