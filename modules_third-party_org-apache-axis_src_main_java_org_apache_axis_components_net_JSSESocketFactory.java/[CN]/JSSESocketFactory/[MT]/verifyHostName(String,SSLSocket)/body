{
  if (host == null) {
    throw new IllegalArgumentException("host to verify was null");
  }
  SSLSession session=ssl.getSession();
  if (session == null) {
    InputStream in=ssl.getInputStream();
    in.available();
    session=ssl.getSession();
    if (session == null) {
      ssl.startHandshake();
      session=ssl.getSession();
    }
  }
  Certificate[] certs=session.getPeerCertificates();
  verifyHostName(host.trim().toLowerCase(Locale.US),(X509Certificate)certs[0]);
}
