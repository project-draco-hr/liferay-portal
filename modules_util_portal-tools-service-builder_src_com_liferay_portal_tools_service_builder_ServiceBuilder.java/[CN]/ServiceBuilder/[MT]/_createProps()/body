{
  if (Validator.isNull(_pluginName) && !_osgiModule) {
    return;
  }
  File propsFile=null;
  if (Validator.isNotNull(_resourcesDir)) {
    propsFile=new File(_resourcesDir + "/service.properties");
  }
 else {
    propsFile=new File(_implDir + "/service.properties");
  }
  long buildNumber=1;
  long buildDate=System.currentTimeMillis();
  if (propsFile.exists()) {
    Properties properties=PropertiesUtil.load(FileUtils.readFileToString(propsFile));
    if (!_buildNumberIncrement) {
      buildDate=GetterUtil.getLong(properties.getProperty("build.date"));
      buildNumber=GetterUtil.getLong(properties.getProperty("build.number"));
    }
 else {
      buildNumber=GetterUtil.getLong(properties.getProperty("build.number")) + 1;
    }
  }
  if (!_buildNumberIncrement && (buildNumber < _buildNumber)) {
    buildNumber=_buildNumber;
    buildDate=System.currentTimeMillis();
  }
  Map<String,Object> context=_getContext();
  context.put("buildNumber",buildNumber);
  context.put("currentTimeMillis",buildDate);
  String content=_processTemplate(_tplProps,context);
  writeFileRaw(propsFile,content,_modifiedFileNames);
}
