{
  _extraPackageMap=new TreeMap<String,List<URL>>();
  StringBundler sb=new StringBundler();
  for (  String extraPackage : PropsValues.MODULE_FRAMEWORK_SYSTEM_PACKAGES_EXTRA) {
    sb.append(extraPackage);
    sb.append(StringPool.COMMA);
  }
  List<URL> list=new UniqueList<URL>();
  ClassLoader classLoader=PACLClassLoaderUtil.getPortalClassLoader();
  Enumeration<URL> enumeration=Collections.enumeration(Collections.emptyList());
  try {
    enumeration=classLoader.getResources(MANIFEST_PATH);
  }
 catch (  IOException ie) {
    _log.error(ie,ie);
  }
  while (enumeration.hasMoreElements()) {
    URL url=enumeration.nextElement();
    list.add(url);
  }
  List<String> ignoredFragments=ListUtil.fromArray(PropsValues.MODULE_FRAMEWORK_SYSTEM_BUNDLE_IGNORED_FRAGMENTS);
  for (  URL url : list) {
    _processURL(sb,url,ignoredFragments);
  }
  _extraPackageMap=Collections.unmodifiableMap(_extraPackageMap);
  sb.setIndex(sb.index() - 1);
  if (_log.isTraceEnabled()) {
    _log.trace("The portal's system bundle is exporting the following " + "packages: \n" + sb.toString().replace(",","\n"));
  }
  return sb.toString();
}
