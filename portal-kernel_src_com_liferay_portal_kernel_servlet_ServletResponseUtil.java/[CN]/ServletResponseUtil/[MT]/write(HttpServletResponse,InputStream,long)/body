{
  if (response.isCommitted()) {
    StreamUtil.cleanUp(inputStream);
    return;
  }
  if (contentLength > 0) {
    response.setHeader(HttpHeaders.CONTENT_LENGTH,String.valueOf(contentLength));
  }
  response.flushBuffer();
  StreamUtil.transfer(inputStream,response.getOutputStream());
}
