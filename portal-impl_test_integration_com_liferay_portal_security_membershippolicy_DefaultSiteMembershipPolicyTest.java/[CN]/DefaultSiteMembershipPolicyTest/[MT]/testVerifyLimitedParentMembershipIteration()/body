{
  _group.setMembershipRestriction(GroupConstants.MEMBERSHIP_RESTRICTION_TO_PARENT_SITE_MEMBERS);
  List<Long> userIds=new ArrayList();
  for (int i=0; i < 20; i++) {
    User user=UserTestUtil.addUser();
    GroupLocalServiceUtil.setUserGroups(user.getUserId(),new long[]{_parentGroup.getGroupId(),_group.getGroupId()});
    userIds.add(user.getUserId());
  }
  for (int i=0; i < IndexerInterval.DEFAULT_INTERVAL; i++) {
    User user=UserTestUtil.addUser();
    GroupLocalServiceUtil.setUserGroups(user.getUserId(),new long[]{_group.getGroupId()});
    userIds.add(user.getUserId());
  }
  SiteMembershipPolicy defaultSiteMembershipPolicy=new DefaultSiteMembershipPolicy();
  defaultSiteMembershipPolicy.verifyPolicy(_group);
  Assert.assertEquals(20,UserLocalServiceUtil.getGroupUsersCount(_group.getGroupId()));
  for (  long userId : userIds) {
    UserLocalServiceUtil.deleteUser(userId);
  }
}
