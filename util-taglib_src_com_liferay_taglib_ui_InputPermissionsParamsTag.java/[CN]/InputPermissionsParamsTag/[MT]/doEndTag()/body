{
  try {
    ServletRequest req=pageContext.getRequest();
    RenderResponse res=(RenderResponse)req.getAttribute(JavaConstants.JAVAX_PORTLET_RESPONSE);
    Layout layout=(Layout)req.getAttribute(WebKeys.LAYOUT);
    Group group=layout.getGroup();
    List supportedActions=ResourceActionsUtil.getModelResourceActions(_modelName);
    List communityDefaultActions=ResourceActionsUtil.getModelResourceCommunityDefaultActions(_modelName);
    List guestDefaultActions=ResourceActionsUtil.getModelResourceGuestDefaultActions(_modelName);
    List guestUnsupportedActions=ResourceActionsUtil.getModelResourceGuestUnsupportedActions(_modelName);
    StringMaker sm=new StringMaker();
    for (int i=0; i < supportedActions.size(); i++) {
      String action=(String)supportedActions.get(i);
      boolean communityChecked=communityDefaultActions.contains(action);
      boolean guestChecked=guestDefaultActions.contains(action);
      boolean guestDisabled=guestUnsupportedActions.contains(action);
      if (guestDisabled) {
        guestChecked=false;
      }
      if (group.isCommunity() || group.isOrganization()) {
        if (communityChecked) {
          sm.append(StringPool.AMPERSAND);
          sm.append(res.getNamespace());
          sm.append("communityPermissions=");
          sm.append(action);
        }
      }
      if (guestChecked) {
        sm.append(StringPool.AMPERSAND);
        sm.append(res.getNamespace());
        sm.append("guestPermissions=");
        sm.append(action);
      }
    }
    pageContext.getOut().print(sm.toString());
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    throw new JspException(e);
  }
}
