{
  DocumentRepository documentRepository=capabilityRegistry.getTarget();
  DLFileEntryServiceAdapter dlFileEntryServiceAdapter=null;
  DLFolderServiceAdapter dlFolderServiceAdapter=null;
  if (documentRepository instanceof LocalRepository) {
    dlFileEntryServiceAdapter=new DLFileEntryServiceAdapter(DLFileEntryLocalServiceUtil.getService());
    dlFolderServiceAdapter=new DLFolderServiceAdapter(DLFolderLocalServiceUtil.getService());
  }
 else {
    dlFileEntryServiceAdapter=new DLFileEntryServiceAdapter(DLFileEntryLocalServiceUtil.getService(),DLFileEntryServiceUtil.getService());
    dlFolderServiceAdapter=new DLFolderServiceAdapter(DLFolderLocalServiceUtil.getService(),DLFolderServiceUtil.getService());
  }
  capabilityRegistry.addExportedCapability(BulkOperationCapability.class,new LiferayBulkOperationCapability(documentRepository,dlFileEntryServiceAdapter,dlFolderServiceAdapter));
  capabilityRegistry.addExportedCapability(TemporaryFileEntriesCapability.class,new TemporaryFileEntriesCapabilityImpl(documentRepository));
  capabilityRegistry.addSupportedCapability(WorkflowCapability.class,new MinimalWorkflowCapability());
}
