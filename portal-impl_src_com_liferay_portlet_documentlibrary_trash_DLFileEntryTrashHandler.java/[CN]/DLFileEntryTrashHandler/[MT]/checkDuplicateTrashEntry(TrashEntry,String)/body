{
  DLFileEntry dlFileEntry=getDLFileEntry(trashEntry.getClassPK());
  String restoredTitle=dlFileEntry.getTitle();
  if (Validator.isNotNull(newName)) {
    restoredTitle=newName;
  }
  String originalTitle=restoredTitle;
  if (restoredTitle.indexOf(StringPool.FORWARD_SLASH) > 0) {
    originalTitle=restoredTitle.substring(0,restoredTitle.indexOf(StringPool.FORWARD_SLASH));
  }
  DLFileEntry duplicatedFileEntry=DLFileEntryLocalServiceUtil.fetchFileEntry(dlFileEntry.getGroupId(),dlFileEntry.getFolderId(),originalTitle);
  if (duplicatedFileEntry != null) {
    DuplicateEntryException dee=new DuplicateEntryException();
    dee.setDuplicateEntryId(duplicatedFileEntry.getFileEntryId());
    dee.setOldName(duplicatedFileEntry.getTitle());
    dee.setTrashEntryId(trashEntry.getEntryId());
    throw dee;
  }
}
