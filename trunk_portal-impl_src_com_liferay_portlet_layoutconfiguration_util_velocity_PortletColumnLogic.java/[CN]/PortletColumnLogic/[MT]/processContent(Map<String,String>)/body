{
  LayoutTypePortlet layoutTypePortlet=_themeDisplay.getLayoutTypePortlet();
  String columnId=attributes.get("id");
  List<Portlet> portlets=layoutTypePortlet.getAllPortlets(columnId);
  String columnCssClass="portlet-dropzone";
  if (layoutTypePortlet.isPersonalizable() && layoutTypePortlet.isColumnDisabled(columnId)) {
    columnCssClass+=" portlet-dropzone-disabled";
  }
  if (layoutTypePortlet.isTemplatePersonalizable(columnId) && layoutTypePortlet.isPersonalizable(columnId)) {
    columnCssClass+=" personalizable";
  }
  if (portlets.size() == 0) {
    columnCssClass+=" empty";
  }
  String additionalClassNames=attributes.get("classNames");
  if (Validator.isNotNull(additionalClassNames)) {
    columnCssClass+=" " + additionalClassNames;
  }
  StringBundler sb=new StringBundler();
  sb.append("<div class=\"");
  sb.append(columnCssClass);
  sb.append("\" id=\"layout-column_");
  sb.append(columnId);
  sb.append("\">");
  for (int i=0; i < portlets.size(); i++) {
    Portlet portlet=portlets.get(i);
    String queryString=null;
    Integer columnPos=new Integer(i);
    Integer columnCount=new Integer(portlets.size());
    String path=null;
    if (_parallelRenderEnable) {
      path="/html/portal/load_render_portlet.jsp";
      if (portlet.getRenderWeight() >= 1) {
        _portletsMap.put(portlet,new Object[]{queryString,columnId,columnPos,columnCount});
      }
    }
    String content=RuntimePortletUtil.processPortlet(_servletContext,_request,_response,portlet,queryString,columnId,columnPos,columnCount,path,false);
    sb.append(content);
  }
  sb.append("</div>");
  return sb.toString();
}
