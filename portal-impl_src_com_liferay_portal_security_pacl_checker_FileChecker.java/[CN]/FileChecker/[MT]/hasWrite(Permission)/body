{
  for (  Permission writeFilePermission : _writePermissions) {
    if (writeFilePermission.implies(permission)) {
      return true;
    }
  }
  if (ServerDetector.isResin()) {
    for (int i=7; ; i++) {
      Class<?> callerClass=Reflection.getCallerClass(i);
      if (callerClass == null) {
        return false;
      }
      String callerClassName=callerClass.getName();
      if (callerClassName.equals(_CLASS_NAME_FILE_PATH)) {
        String actualClassLocation=PACLClassUtil.getClassLocation(callerClass);
        String expectedClassLocation=PathUtil.toUnixPath(System.getProperty("resin.home") + "/lib/resin.jar!/");
        return actualClassLocation.contains(expectedClassLocation);
      }
    }
  }
 else   if (ServerDetector.isWebSphere()) {
    if (isJSPCompiler(permission.getName(),FILE_PERMISSION_ACTION_WRITE)) {
      return true;
    }
  }
  return false;
}
