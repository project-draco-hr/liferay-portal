{
  List<Permission> permissions=new CopyOnWriteArrayList<Permission>();
  String value=getProperty(key);
  if (value != null) {
    try {
      value=StringUtil.replace(value,"${auto.deploy.dest.dir}",DeployUtil.getAutoDeployDestDir());
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
    String[] paths=StringUtil.split(value);
    if (value.contains("${comma}")) {
      for (int i=0; i < paths.length; i++) {
        paths[i]=StringUtil.replace(paths[i],"${comma}",StringPool.COMMA);
      }
    }
    for (    String path : paths) {
      addPermission(permissions,path,actions);
    }
  }
  String pathContext=ContextPathUtil.getContextPath(PropsValues.PORTAL_CTX);
  ServletContext servletContext=ServletContextPool.get(pathContext);
  if (!actions.equals(FILE_PERMISSION_ACTION_EXECUTE) && (_workDir != null)) {
    addPermission(permissions,_workDir,actions);
    addPermission(permissions,_workDir + "/-",actions);
    if (servletContext != null) {
      File tempDir=(File)servletContext.getAttribute(JavaConstants.JAVAX_SERVLET_CONTEXT_TEMPDIR);
      String tempDirAbsolutePath=tempDir.getAbsolutePath();
      if (_log.isDebugEnabled()) {
        _log.debug("Temp directory " + tempDirAbsolutePath);
      }
      if (actions.equals(FILE_PERMISSION_ACTION_READ)) {
        addPermission(permissions,tempDirAbsolutePath,actions);
      }
      addPermission(permissions,tempDirAbsolutePath + "/-",actions);
    }
  }
  if (!actions.equals(FILE_PERMISSION_ACTION_READ)) {
    return permissions;
  }
  List<String> paths=new UniqueList<String>();
  try {
    File file=new File(System.getProperty("java.home") + "/lib");
    addCanonicalPaths(paths,file);
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
  }
  paths.add(_globalSharedLibDir + "-");
  paths.add(_rootDir + "-");
  if (!_portalDir.equals(_rootDir)) {
    paths.add(_portalDir);
    paths.add(_portalDir + "html/common/-");
    paths.add(_portalDir + "html/taglib/-");
    paths.add(_portalDir + "localhost/html/common/-");
    paths.add(_portalDir + "localhost/html/taglib/-");
    paths.add(_portalDir + "localhost/WEB-INF/tld/-");
    paths.add(_portalDir + "WEB-INF/classes/java/-");
    paths.add(_portalDir + "WEB-INF/classes/javax/-");
    paths.add(_portalDir + "WEB-INF/classes/org/apache/-");
    paths.add(_portalDir + "WEB-INF/classes/META-INF/services/" + "javax.el.ExpressionFactory");
    paths.add(_portalDir + "WEB-INF/lib/hibernate3.jar");
    paths.add(_portalDir + "WEB-INF/lib/log4j-extras.jar");
    paths.add(_portalDir + "WEB-INF/lib/spring-beans.jar");
    paths.add(_portalDir + "WEB-INF/tld/-");
    paths.add(_portalDir + "WEB-INF/lib/org.springframework.aspects.jar");
  }
  if (ServerDetector.isJBoss()) {
    String jbossHome=System.getProperty("jboss.home.dir");
    paths.add(jbossHome + "/modules/-");
  }
  for (  String path : paths) {
    addPermission(permissions,path,actions);
  }
  return permissions;
}
