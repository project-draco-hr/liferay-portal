{
  for (  Permission readFilePermission : _readPermissions) {
    if (readFilePermission.implies(permission)) {
      return true;
    }
  }
  if (isJSPCompiler(permission.getName(),FILE_PERMISSION_ACTION_READ)) {
    return true;
  }
  for (int i=7; ; i++) {
    Class<?> callerClass=Reflection.getCallerClass(i);
    if (callerClass == null) {
      return false;
    }
    if ((callerClass == DirectServletRegistryImpl.class) || (callerClass == FileAvailabilityUtil.class)) {
      return true;
    }
    if (ClassLoader.class.isAssignableFrom(callerClass)) {
      String callerClassName=callerClass.getName();
      if (!callerClassName.equals(_CLASS_NAME_METHOD_UTIL)) {
        return true;
      }
    }
    if (ServerDetector.isGlassfish()) {
      Class<?> enclosingClass=callerClass.getEnclosingClass();
      if (enclosingClass != null) {
        if ((enclosingClass.getEnclosingClass() == URLClassLoader.class) && CheckerUtil.isAccessControllerDoPrivileged(i + 1)) {
          return true;
        }
      }
    }
 else     if (ServerDetector.isResin()) {
      String callerClassName=callerClass.getName();
      if (callerClassName.equals(_CLASS_NAME_FILE_PATH)) {
        String actualClassLocation=PACLClassUtil.getClassLocation(callerClass);
        String expectedClassLocation=PathUtil.toUnixPath(System.getProperty("resin.home") + "/lib/resin.jar!/");
        return actualClassLocation.contains(expectedClassLocation);
      }
    }
  }
}
