{
  for (  Permission readFilePermission : _readPermissions) {
    if (readFilePermission.implies(permission)) {
      return true;
    }
  }
  for (int i=7; ; i++) {
    Class<?> callerClass=Reflection.getCallerClass(i);
    if (callerClass == null) {
      return false;
    }
    if ((callerClass == DirectServletRegistryImpl.class) || (callerClass == FileAvailabilityUtil.class)) {
      return true;
    }
    if (ClassLoader.class.isAssignableFrom(callerClass)) {
      String callerClassName=callerClass.getName();
      if (!callerClassName.equals(_CLASS_NAME_METHOD_UTIL)) {
        return true;
      }
    }
    if (ServerDetector.isGlassfish()) {
      Class<?> enclosingClass=callerClass.getEnclosingClass();
      if (enclosingClass != null) {
        if (enclosingClass.getEnclosingClass() == URLClassLoader.class) {
          return true;
        }
      }
    }
  }
}
