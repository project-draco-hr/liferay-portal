{
  if (_permissions.implies(permission)) {
    return true;
  }
  int stackIndex=getStackIndex(10,9);
  Class<?> callerClassA=Reflection.getCallerClass(stackIndex);
  Class<?> callerClassB=Reflection.getCallerClass(stackIndex + 1);
  if (callerClassA.equals(File.class) && isTrustedCaller(callerClassB,permission)) {
    return true;
  }
  String name=permission.getName();
  String actions=permission.getActions();
  logSecurityException(_log,"Attempted to " + actions + " on file "+ name);
  return false;
}
