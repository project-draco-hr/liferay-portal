{
  String name=permission.getName();
  String actions=permission.getActions();
  if (actions.equals(FILE_PERMISSION_ACTION_DELETE)) {
    if (!hasDelete(permission)) {
      logSecurityException(_log,"Attempted to delete file " + name);
      return false;
    }
  }
 else   if (actions.equals(FILE_PERMISSION_ACTION_EXECUTE)) {
    if (!hasExecute(permission)) {
      logSecurityException(_log,"Attempted to execute file " + name);
      return false;
    }
  }
 else   if (actions.equals(FILE_PERMISSION_ACTION_READ)) {
    if (PortalSecurityManagerThreadLocal.isCheckReadFile() && !hasRead(permission)) {
      logSecurityException(_log,"Attempted to read file " + name);
      return false;
    }
  }
 else   if (actions.equals(FILE_PERMISSION_ACTION_WRITE)) {
    if (!hasWrite(permission)) {
      logSecurityException(_log,"Attempted to write file " + name);
      return false;
    }
  }
  return true;
}
