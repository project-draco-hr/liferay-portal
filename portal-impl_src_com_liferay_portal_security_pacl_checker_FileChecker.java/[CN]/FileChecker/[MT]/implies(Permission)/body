{
  if (_permissions.implies(permission)) {
    return true;
  }
  int stackIndex=getStackIndex(10,9);
  Class<?> callerClass1=Reflection.getCallerClass(stackIndex);
  Class<?> callerClass2=Reflection.getCallerClass(stackIndex + 1);
  if (callerClass1.equals(File.class) && isTrustedCaller(callerClass2,permission)) {
    return true;
  }
  logSecurityException(_log,"Attempted to " + permission.getActions() + " on file "+ permission.getName());
  return false;
}
