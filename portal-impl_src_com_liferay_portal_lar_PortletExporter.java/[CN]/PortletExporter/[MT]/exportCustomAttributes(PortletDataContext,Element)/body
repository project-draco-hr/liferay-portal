{
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("custom-attributes");
  Map<String,Map<String,Serializable>> customAttributesMap=portletDataContext.getCustomAttributes();
  for (  Map.Entry<String,Map<String,Serializable>> entry : customAttributesMap.entrySet()) {
    String key=entry.getKey();
    Map<String,Serializable> value=entry.getValue();
    int pos=key.indexOf(CharPool.POUND);
    String className=key.substring(0,pos);
    String classPK=key.substring(pos + 1);
    String path=getCustomAttributesPath(portletDataContext,className,classPK);
    Element assetElement=rootElement.addElement("asset");
    assetElement.addAttribute("path",path);
    assetElement.addAttribute("class-name",className);
    assetElement.addAttribute("class-pk",classPK);
    if (portletDataContext.isPathNotProcessed(path)) {
      portletDataContext.addZipEntry(path,value);
    }
  }
  portletDataContext.addZipEntry(portletDataContext.getRootPath() + "/custom-attributes.xml",document.formattedString());
}
