{
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("ratings");
  Map<String,List<RatingsEntry>> ratingsEntriesMap=portletDataContext.getRatingsEntries();
  for (  Map.Entry<String,List<RatingsEntry>> entry : ratingsEntriesMap.entrySet()) {
    String[] ratingsEntryParts=StringUtil.split(entry.getKey(),CharPool.POUND);
    String className=ratingsEntryParts[0];
    String classPK=ratingsEntryParts[1];
    String ratingsEntriesPath=getRatingsEntriesPath(portletDataContext,className,classPK);
    Element assetElement=rootElement.addElement("asset");
    assetElement.addAttribute("path",ratingsEntriesPath);
    assetElement.addAttribute("class-name",className);
    assetElement.addAttribute("class-pk",classPK);
    List<RatingsEntry> ratingsEntries=entry.getValue();
    for (    RatingsEntry ratingsEntry : ratingsEntries) {
      String ratingsEntryPath=getRatingsEntryPath(portletDataContext,className,classPK,ratingsEntry);
      User user=UserLocalServiceUtil.fetchUser(ratingsEntry.getUserId());
      if (user == null) {
        continue;
      }
      portletDataContext.addZipEntry(ratingsEntryPath,ratingsEntry);
      portletDataContext.addReferenceElement(ratingsEntry,assetElement,user,PortletDataContext.REFERENCE_TYPE_WEAK,true);
    }
  }
  portletDataContext.addZipEntry(ExportImportPathUtil.getRootPath(portletDataContext) + "/ratings.xml",document.formattedString());
}
