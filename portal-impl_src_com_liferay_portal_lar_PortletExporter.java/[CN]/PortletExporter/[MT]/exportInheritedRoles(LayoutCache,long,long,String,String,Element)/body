{
  Element entityRolesEl=SAXReaderUtil.createElement(entityName + "-roles");
  Map<String,Long> entityMap=layoutCache.getEntityMap(companyId,entityName);
  Iterator<Map.Entry<String,Long>> itr=entityMap.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry<String,Long> entry=itr.next();
    String name=entry.getKey().toString();
    long entityGroupId=entry.getValue();
    List<Role> entityRoles=layoutCache.getGroupRoles_4(entityGroupId);
    Element entityEl=exportRoles(companyId,resourceName,ResourceConstants.SCOPE_GROUP,String.valueOf(groupId),entityRolesEl,entityName,entityRoles);
    if (entityEl.elements().isEmpty()) {
      entityRolesEl.remove(entityEl);
    }
 else {
      entityEl.addAttribute("name",name);
    }
  }
  if (!entityRolesEl.elements().isEmpty()) {
    parentEl.add(entityRolesEl);
  }
}
