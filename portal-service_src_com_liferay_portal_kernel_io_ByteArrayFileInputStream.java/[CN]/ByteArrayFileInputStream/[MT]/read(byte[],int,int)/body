{
  if (length <= 0) {
    return 0;
  }
  if (fileSize < threshold) {
    initData();
    if (index >= data.length) {
      return -1;
    }
    int read=length;
    if ((index + read) > data.length) {
      read=data.length - index;
    }
    System.arraycopy(data,index,bytes,offset,read);
    index+=read;
    return read;
  }
  initFileInputStream();
  return fileInputStream.read(bytes,offset,length);
}
