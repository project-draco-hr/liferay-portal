{
  boolean exportThemeSettings=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME_REFERENCE);
  if (_log.isDebugEnabled()) {
    _log.debug("Export theme settings " + exportThemeSettings);
  }
  if (exportThemeSettings && !portletDataContext.isPerformDirectBinaryImport() && !layout.isInheritLookAndFeel()) {
    StagedTheme stagedTheme=new StagedThemeImpl(layout.getTheme());
    Element layoutElement=portletDataContext.getExportDataElement(layout);
    portletDataContext.addReferenceElement(layout,layoutElement,stagedTheme,PortletDataContext.REFERENCE_TYPE_DEPENDENCY,true);
  }
}
