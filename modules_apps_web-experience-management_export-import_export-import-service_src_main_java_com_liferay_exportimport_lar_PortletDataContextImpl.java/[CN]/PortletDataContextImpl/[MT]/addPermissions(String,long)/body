{
  if (!MapUtil.getBoolean(_parameterMap,PortletDataHandlerKeys.PERMISSIONS)) {
    return;
  }
  Map<Long,Set<String>> roleIdsToActionIds=ExportImportPermissionUtil.getRoleIdsToActionIds(_companyId,resourceName,resourcePK);
  List<KeyValuePair> permissions=new ArrayList<>();
  for (  Map.Entry<Long,Set<String>> entry : roleIdsToActionIds.entrySet()) {
    long roleId=entry.getKey();
    Set<String> availableActionIds=entry.getValue();
    Role role=RoleLocalServiceUtil.fetchRole(roleId);
    if (role == null) {
      continue;
    }
    String roleName=role.getName();
    if (role.isTeam()) {
      try {
        roleName=ExportImportPermissionUtil.getTeamRoleName(role.getDescriptiveName());
      }
 catch (      PortalException pe) {
        _log.error(pe,pe);
      }
    }
    KeyValuePair permission=new KeyValuePair(roleName,StringUtil.merge(availableActionIds));
    permissions.add(permission);
  }
  if (permissions.isEmpty()) {
    return;
  }
  _permissionsMap.put(getPrimaryKeyString(resourceName,resourcePK),permissions);
}
