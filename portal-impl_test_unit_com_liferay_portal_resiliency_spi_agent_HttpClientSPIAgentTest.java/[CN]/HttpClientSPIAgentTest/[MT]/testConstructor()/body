{
  MockRegistrationReference mockRegistrationReference=new MockRegistrationReference(new MockIntraband());
  HttpClientSPIAgent httpClientSPIAgent=new HttpClientSPIAgent(_spiConfiguration,mockRegistrationReference);
  Assert.assertSame(mockRegistrationReference,httpClientSPIAgent.registrationReference);
  Assert.assertEquals(new InetSocketAddress(InetAddressUtil.getLoopbackInetAddress(),_spiConfiguration.getConnectorPort()),httpClientSPIAgent.socketAddress);
  BlockingQueue<Socket> socketBlockingQueue=httpClientSPIAgent.socketBlockingQueue;
  Assert.assertTrue(socketBlockingQueue.isEmpty());
  Assert.assertEquals(PropsValues.PORTAL_RESILIENCY_SPI_AGENT_CLIENT_POOL_MAX_SIZE,socketBlockingQueue.remainingCapacity());
  String httpRequestContentString="POST " + HttpClientSPIAgent.SPI_AGENT_CONTEXT_PATH + HttpClientSPIAgent.MAPPING_PATTERN+ " HTTP/1.1\r\nHost: localhost:"+ _spiConfiguration.getConnectorPort()+ "\r\n"+ "Content-Length: 8\r\n\r\n";
  Assert.assertArrayEquals(httpRequestContentString.getBytes("US-ASCII"),httpClientSPIAgent.httpServletRequestContent);
}
