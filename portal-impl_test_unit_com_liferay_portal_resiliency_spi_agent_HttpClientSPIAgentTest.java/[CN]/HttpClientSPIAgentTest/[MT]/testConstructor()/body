{
  MockRegistrationReference mockRegistrationReference=new MockRegistrationReference(new MockIntraband());
  HttpClientSPIAgent httpClientSPIAgent=new HttpClientSPIAgent(_spiConfiguration,mockRegistrationReference);
  Assert.assertSame(mockRegistrationReference,httpClientSPIAgent.registrationReference);
  Assert.assertEquals(new InetSocketAddress(InetAddressUtil.getLoopbackInetAddress(),_spiConfiguration.getConnectorPort()),httpClientSPIAgent.socketAddress);
  BlockingQueue<Socket> socketBlockingQueue=httpClientSPIAgent.socketBlockingQueue;
  Assert.assertTrue(socketBlockingQueue.isEmpty());
  Assert.assertEquals(PropsValues.PORTAL_RESILIENCY_SPI_AGENT_CLIENT_POOL_MAX_SIZE,socketBlockingQueue.remainingCapacity());
  StringBundler sb=new StringBundler();
  sb.append("POST ");
  sb.append(HttpClientSPIAgent.SPI_AGENT_CONTEXT_PATH);
  sb.append(HttpClientSPIAgent.MAPPING_PATTERN);
  sb.append(" HTTP/1.1\r\nHost: localhost:");
  sb.append(_spiConfiguration.getConnectorPort());
  sb.append("\r\nContent-Length: 8\r\n\r\n");
  String httpServletRequestContentString=sb.toString();
  Assert.assertArrayEquals(httpServletRequestContentString.getBytes("US-ASCII"),httpClientSPIAgent.httpServletRequestContent);
}
