{
  if (!StagingAdvicesThreadLocal.isEnabled()) {
    return plid;
  }
  LayoutRevision layoutRevision=_getLayoutRevision(plid);
  if (layoutRevision == null) {
    return plid;
  }
  ServiceContext serviceContext=ServiceContextThreadLocal.getServiceContext();
  if (serviceContext == null) {
    return plid;
  }
  boolean exporting=ParamUtil.getBoolean(serviceContext,"exporting");
  if (exporting) {
    return plid;
  }
  if (!MergeLayoutPrototypesThreadLocal.isInProgress()) {
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
  }
  try {
    layoutRevision=layoutRevisionLocalService.updateLayoutRevision(serviceContext.getUserId(),layoutRevision.getLayoutRevisionId(),layoutRevision.getLayoutBranchId(),layoutRevision.getName(),layoutRevision.getTitle(),layoutRevision.getDescription(),layoutRevision.getKeywords(),layoutRevision.getRobots(),layoutRevision.getTypeSettings(),layoutRevision.getIconImage(),layoutRevision.getIconImageId(),layoutRevision.getThemeId(),layoutRevision.getColorSchemeId(),layoutRevision.getCss(),serviceContext);
  }
 catch (  PortalException pe) {
    ReflectionUtil.throwException(pe);
  }
  plid=layoutRevision.getLayoutRevisionId();
  ProxiedLayoutsThreadLocal.clearProxiedLayouts();
  return plid;
}
