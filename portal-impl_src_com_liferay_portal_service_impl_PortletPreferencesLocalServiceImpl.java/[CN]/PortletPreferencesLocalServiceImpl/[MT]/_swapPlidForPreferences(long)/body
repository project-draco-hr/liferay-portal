{
  if (!StagingAdvicesThreadLocal.isEnabled()) {
    return plid;
  }
  LayoutRevision layoutRevision=_getLayoutRevision(plid);
  if (layoutRevision == null) {
    return plid;
  }
  User user=userPersistence.fetchByPrimaryKey(PrincipalThreadLocal.getUserId());
  if ((user == null) || user.isDefaultUser()) {
    return layoutRevision.getLayoutRevisionId();
  }
  try {
    return StagingUtil.getRecentLayoutRevisionId(user,layoutRevision.getLayoutSetBranchId(),layoutRevision.getPlid());
  }
 catch (  PortalException pe) {
    return ReflectionUtil.throwException(pe);
  }
}
