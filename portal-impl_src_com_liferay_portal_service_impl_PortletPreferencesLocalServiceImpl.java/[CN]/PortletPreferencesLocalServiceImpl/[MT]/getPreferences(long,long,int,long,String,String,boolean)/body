{
  DB db=DBFactoryUtil.getDB();
  String dbType=db.getType();
  if (!dbType.equals(DB.TYPE_HYPERSONIC)) {
    return doGetPreferences(companyId,ownerId,ownerType,plid,portletId,defaultPreferences,strict);
  }
  StringBundler sb=new StringBundler(7);
  sb.append(ownerId);
  sb.append(StringPool.POUND);
  sb.append(ownerType);
  sb.append(StringPool.POUND);
  sb.append(plid);
  sb.append(StringPool.POUND);
  sb.append(portletId);
  String groupName=getClass().getName();
  String key=sb.toString();
  Lock lock=LockRegistry.allocateLock(groupName,key);
  lock.lock();
  try {
    return doGetPreferences(companyId,ownerId,ownerType,plid,portletId,defaultPreferences,strict);
  }
  finally {
    lock.unlock();
    LockRegistry.freeLock(groupName,key);
  }
}
