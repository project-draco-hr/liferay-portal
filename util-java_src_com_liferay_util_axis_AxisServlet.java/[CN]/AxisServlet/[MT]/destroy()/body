{
  if (ServerDetector.isWebLogic()) {
    doDestroy();
  }
 else {
    Thread thread=Thread.currentThread();
    ClassLoader classLoader=thread.getContextClassLoader();
    Class<?> clazz=this.getClass();
    thread.setContextClassLoader(clazz.getClassLoader());
    DestroyThread destroyThread=new DestroyThread();
    destroyThread.start();
    try {
      destroyThread.join();
    }
 catch (    InterruptedException ie) {
      throw new RuntimeException(ie);
    }
    Exception e=destroyThread.getException();
    if (e != null) {
      if (e instanceof RuntimeException) {
        throw (RuntimeException)e;
      }
 else {
        throw new RuntimeException(e);
      }
    }
    thread.setContextClassLoader(classLoader);
  }
}
