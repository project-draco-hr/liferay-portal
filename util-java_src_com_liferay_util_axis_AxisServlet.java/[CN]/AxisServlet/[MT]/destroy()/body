{
  if (ServerDetector.isWebLogic()) {
    doDestroy();
  }
 else {
    Thread currentThread=Thread.currentThread();
    ClassLoader contextClassLoader=currentThread.getContextClassLoader();
    Class<?> clazz=getClass();
    currentThread.setContextClassLoader(clazz.getClassLoader());
    try {
      DestroyThread destroyThread=new DestroyThread();
      destroyThread.start();
      try {
        destroyThread.join();
      }
 catch (      InterruptedException ie) {
        throw new RuntimeException(ie);
      }
      Exception e=destroyThread.getException();
      if (e != null) {
        if (e instanceof RuntimeException) {
          throw (RuntimeException)e;
        }
 else {
          throw new RuntimeException(e);
        }
      }
    }
  finally {
      currentThread.setContextClassLoader(contextClassLoader);
    }
  }
}
