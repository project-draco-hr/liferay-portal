{
  try {
    StringMaker sm=new StringMaker();
    HSSFWorkbook workbook=new HSSFWorkbook(in);
    int numOfSheets=workbook.getNumberOfSheets();
    for (int i=0; i < numOfSheets; i++) {
      HSSFSheet sheet=workbook.getSheetAt(i);
      Iterator<HSSFRow> rowIterator=sheet.rowIterator();
      while (rowIterator.hasNext()) {
        HSSFRow row=rowIterator.next();
        Iterator<HSSFCell> cellIterator=row.cellIterator();
        while (cellIterator.hasNext()) {
          HSSFCell cell=cellIterator.next();
          String cellStringValue=null;
          if (cell.getCellType() == 4) {
            boolean booleanValue=cell.getBooleanCellValue();
            cellStringValue=Boolean.toString(booleanValue);
          }
 else           if (cell.getCellType() == 0) {
            double doubleValue=cell.getNumericCellValue();
            cellStringValue=Double.toString(doubleValue);
          }
 else           if (cell.getCellType() == 1) {
            cellStringValue=cell.getRichStringCellValue().getString();
          }
          if (cellStringValue != null) {
            sm.append(cellStringValue);
            sm.append("\t");
          }
        }
        sm.append("\n");
      }
    }
    _text=sm.toString();
  }
 catch (  Exception e) {
    _log.error(e.getMessage());
  }
}
