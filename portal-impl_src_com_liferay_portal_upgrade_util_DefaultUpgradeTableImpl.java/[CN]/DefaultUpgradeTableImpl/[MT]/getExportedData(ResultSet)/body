{
  StringMaker sm=new StringMaker();
  Object[][] columns=getColumns();
  for (int i=0; i < columns.length; i++) {
    boolean last=false;
    if ((i + 1) == columns.length) {
      last=true;
    }
    if (_upgradeColumns[i] == null) {
      appendColumn(sm,rs,(String)columns[i][0],(Integer)columns[i][1],last);
    }
 else {
      try {
        Integer columnType=_upgradeColumns[i].getOldColumnType((Integer)columns[i][1]);
        Object oldValue=getValue(rs,(String)columns[i][0],columnType);
        _upgradeColumns[i].setOldValue(oldValue);
        Object newValue=_upgradeColumns[i].getNewValue(oldValue);
        _upgradeColumns[i].setNewValue(newValue);
        appendColumn(sm,newValue,last);
      }
 catch (      StagnantRowException sre) {
        _upgradeColumns[i].setNewValue(null);
        throw new StagnantRowException("Column " + columns[i][0] + " with value "+ sre.getMessage(),sre);
      }
    }
  }
  return sm.toString();
}
