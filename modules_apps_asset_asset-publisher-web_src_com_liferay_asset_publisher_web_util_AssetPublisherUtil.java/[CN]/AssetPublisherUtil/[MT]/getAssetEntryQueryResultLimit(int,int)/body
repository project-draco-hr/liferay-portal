{
  if (groupTotal > 0) {
    if ((limit > 0) && (limit > groupTotal)) {
      limit-=groupTotal;
    }
 else {
      limit=0;
    }
  }
  return limit;
}
