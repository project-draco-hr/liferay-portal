{
  List<Plugin> visiblePlugins=new ArrayList<Plugin>(plugins.size());
  for (  Plugin plugin : plugins) {
    PluginSetting pluginSetting=PluginSettingLocalServiceUtil.getPluginSetting(companyId,plugin.getPluginId(),plugin.getPluginType());
    if (pluginSetting.isActive() && pluginSetting.hasPermission(userId)) {
      visiblePlugins.add(plugin);
    }
  }
  return visiblePlugins;
}
