{
  File tempDir=new File(System.getProperty("java.io.tmpdir"));
  try {
    ProcessBuilder processBuilder=new ProcessBuilder("ant","direct-deploy","-Dapp.server.deploy.dir=" + tempDir.getAbsolutePath(),"-Dauto.deploy.unpack.war=false");
    Process process=processBuilder.start();
    process.waitFor();
    BufferedReader reader=new BufferedReader(new InputStreamReader(process.getInputStream()));
    String line=reader.readLine();
    while (line != null) {
      _logger.debug(line);
      line=reader.readLine();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  Project project=_getProject();
  File warFile=new File(tempDir.getAbsolutePath(),project.getProperty("plugin.name") + ".war");
  return ShrinkWrap.createFromZipFile(WebArchive.class,warFile);
}
