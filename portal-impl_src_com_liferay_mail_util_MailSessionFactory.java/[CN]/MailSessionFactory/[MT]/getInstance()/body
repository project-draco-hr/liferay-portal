{
  Properties mailProperties=new Properties();
  Properties portalProperties=PropsUtil.getProperties();
  Enumeration<String> enu=(Enumeration<String>)portalProperties.propertyNames();
  while (enu.hasMoreElements()) {
    String key=enu.nextElement();
    if (key.startsWith(_MAIL_SESSION_PREFIX)) {
      String value=portalProperties.getProperty(key);
      mailProperties.setProperty(key.substring(_MAIL_SESSION_PREFIX.length()),value);
    }
  }
  Session session=Session.getInstance(mailProperties);
  if (_log.isDebugEnabled()) {
    session.setDebug(true);
    session.getProperties().list(System.out);
  }
  return session;
}
