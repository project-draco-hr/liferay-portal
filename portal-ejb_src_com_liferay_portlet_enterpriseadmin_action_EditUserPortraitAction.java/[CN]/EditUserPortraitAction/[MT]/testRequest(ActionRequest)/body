{
  boolean isMultiPartContent=PortletFileUpload.isMultipartContent(req);
  if (_log.isInfoEnabled()) {
    if (isMultiPartContent) {
      _log.info("The given request is a multipart request");
    }
 else {
      _log.info("The given request is NOT a multipart request");
    }
  }
  DiskFileItemFactory factory=new DiskFileItemFactory();
  PortletFileUpload upload=new PortletFileUpload(factory);
  List fileItems=upload.parseRequest(req);
  if (_log.isInfoEnabled()) {
    _log.info("Apache commons upload was able to parse " + fileItems.size() + " items");
  }
  for (int i=0; i < fileItems.size(); i++) {
    DiskFileItem fileItem=(DiskFileItem)fileItems.get(i);
    if (_log.isInfoEnabled()) {
      _log.info("Item " + i + " fileItem");
    }
  }
  InputStream in=req.getPortletInputStream();
  if (in != null) {
    ByteArrayOutputStream out=new ByteArrayOutputStream();
    int c=-1;
    try {
      while ((c=in.read()) != -1) {
        out.write(c);
      }
    }
  finally {
      in.close();
    }
    byte[] bytes=out.toByteArray();
    if (_log.isInfoEnabled()) {
      _log.info("Byte array size from the raw input stream is " + bytes.length);
    }
  }
}
