{
  String completeURL=(String)req.getAttribute(WebKeys.CURRENT_URL);
  if (completeURL == null) {
    completeURL=Http.getCompleteURL(req);
    if ((Validator.isNotNull(completeURL)) && (completeURL.indexOf("j_security_check") == -1)) {
      completeURL=completeURL.substring(completeURL.indexOf("://") + 3,completeURL.length());
      completeURL=completeURL.substring(completeURL.indexOf("/"),completeURL.length());
    }
    if (Validator.isNull(completeURL)) {
      completeURL=PortalUtil.getPathMain();
    }
    req.setAttribute(WebKeys.CURRENT_URL,completeURL);
  }
  return completeURL;
}
