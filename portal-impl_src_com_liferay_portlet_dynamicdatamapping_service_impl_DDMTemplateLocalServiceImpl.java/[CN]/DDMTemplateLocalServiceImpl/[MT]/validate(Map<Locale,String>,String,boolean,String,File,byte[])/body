{
  validate(nameMap,script);
  String[] imageExtensions=PrefsPropsUtil.getStringArray(PropsKeys.DYNAMIC_DATA_MAPPING_IMAGE_EXTENSIONS,StringPool.COMMA);
  if (!smallImage || Validator.isNotNull(smallImageURL) || (smallImageFile == null)|| (smallImageBytes == null)) {
    return;
  }
  String smallImageName=smallImageFile.getName();
  if (smallImageName != null) {
    boolean validSmallImageExtension=false;
    for (int i=0; i < imageExtensions.length; i++) {
      if (StringPool.STAR.equals(imageExtensions[i]) || StringUtil.endsWith(smallImageName,imageExtensions[i])) {
        validSmallImageExtension=true;
        break;
      }
    }
    if (!validSmallImageExtension) {
      throw new TemplateSmallImageNameException(smallImageName);
    }
  }
  long smallImageMaxSize=PrefsPropsUtil.getLong(PropsKeys.DYNAMIC_DATA_MAPPING_IMAGE_SMALL_MAX_SIZE);
  if ((smallImageMaxSize > 0) && ((smallImageBytes == null) || (smallImageBytes.length > smallImageMaxSize))) {
    throw new TemplateSmallImageSizeException("Size of Image " + smallImageName + " exceeds maximum. "+ smallImageBytes.length+ " > "+ smallImageMaxSize);
  }
}
