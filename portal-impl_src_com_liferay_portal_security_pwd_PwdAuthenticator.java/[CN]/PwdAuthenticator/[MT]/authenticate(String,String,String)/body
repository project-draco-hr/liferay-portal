{
  String encryptedPasswordToValidate=PwdEncryptor.encrypt(clearTextPassword,encryptedPassword);
  if (encryptedPassword.equals(encryptedPasswordToValidate)) {
    return true;
  }
 else   if (GetterUtil.getBoolean(PropsUtil.get(PropsKeys.AUTH_MAC_ALLOW))) {
    try {
      MessageDigest digester=MessageDigest.getInstance(PropsUtil.get(PropsKeys.AUTH_MAC_ALGORITHM));
      digester.update(login.getBytes("UTF8"));
      String shardKey=PropsUtil.get(PropsKeys.AUTH_MAC_SHARED_KEY);
      encryptedPasswordToValidate=Base64.encode(digester.digest(shardKey.getBytes("UTF8")));
      if (encryptedPassword.equals(encryptedPasswordToValidate)) {
        return true;
      }
 else {
        return false;
      }
    }
 catch (    NoSuchAlgorithmException nsae) {
      throw new SystemException(nsae);
    }
catch (    UnsupportedEncodingException uee) {
      throw new SystemException(uee);
    }
  }
  return false;
}
