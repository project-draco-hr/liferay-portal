{
  BooleanQueryImpl booleanQueryImpl=new BooleanQueryImpl();
  List<String> tokens=_keywordTokenizer.tokenize(keywords);
  List<String> phrases=new ArrayList<>(tokens.size());
  List<String> words=new ArrayList<>(tokens.size());
  for (  String token : tokens) {
    if (StringUtil.startsWith(token,CharPool.QUOTE)) {
      phrases.add(StringUtil.unquote(token));
    }
 else {
      words.add(token);
    }
  }
  for (  String phrase : phrases) {
    booleanQueryImpl.add(createPhraseQuery(field,phrase),BooleanClauseOccur.MUST);
  }
  if (!words.isEmpty()) {
    addSentenceQueries(field,StringUtil.merge(words,StringPool.SPACE),booleanQueryImpl);
  }
  booleanQueryImpl.add(createExactMatchQuery(field,keywords),BooleanClauseOccur.SHOULD);
  return booleanQueryImpl;
}
