{
  try {
    if (matches(className)) {
      InstrumentationAgent.recordInstrumentation(classLoader,className,classfileBuffer);
      ProjectData projectData=ProjectDataUtil.getProjectData();
      ClassWriter classWriter=new ContextAwareClassWriter(ClassWriter.COMPUTE_FRAMES);
      String name=className.replace('/','.');
      ClassVisitor classVisitor=new WhipClassVisitor(projectData.getOrCreateClassData(name),classWriter);
      ClassReader classReader=new ClassReader(classfileBuffer);
synchronized (projectData) {
        classReader.accept(classVisitor,0);
      }
      byte[] data=classWriter.toByteArray();
      dumpInstrumentedClass(classLoader,className,data);
      return data;
    }
  }
 catch (  IOException ioe) {
    ReflectionUtil.throwException(ioe);
  }
  return null;
}
