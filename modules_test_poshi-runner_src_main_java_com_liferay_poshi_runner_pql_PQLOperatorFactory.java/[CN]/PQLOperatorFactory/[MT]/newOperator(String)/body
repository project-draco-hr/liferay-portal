{
  PQLOperator.validateOperator(operator);
  if (operator.equals("AND") || operator.equals("OR")) {
    return new PQLOperator(operator){
      public Object getValue(      PQLEntity pqlEntity1,      PQLEntity pqlEntity2,      Properties properties) throws Exception {
        String operator=getOperator();
        Object value1=pqlEntity1.getValue(properties);
        Object value2=pqlEntity2.getValue(properties);
        if ((value1 == null) || (value2 == null)) {
          throw new Exception("'" + operator + "' operators must be "+ "surrounded by 2 boolean values.");
        }
        if (!(value1 instanceof Boolean) || !(value2 instanceof Boolean)) {
          throw new Exception("'" + operator + "' operators must be "+ "surrounded by 2 boolean values.");
        }
        Boolean booleanValue1=(Boolean)value1;
        Boolean booleanValue2=(Boolean)value2;
        if (operator.equals("AND")) {
          return (booleanValue1 && booleanValue2);
        }
 else         if (operator.equals("OR")) {
          return (booleanValue1 || booleanValue2);
        }
        throw new Exception("Unsupported '" + operator + "' operator.");
      }
    }
;
  }
  throw new Exception("Unsupported '" + operator + "' operator.");
}
