{
  User user=userPersistence.findByPrimaryKey(userId);
  portletIds=transformPortletIds(portletIds);
  Date now=new Date();
  validate(name);
  long wsrpProducerId=CounterLocalServiceUtil.increment();
  WSRPProducer wsrpProducer=wsrpProducerPersistence.create(wsrpProducerId);
  wsrpProducer.setUuid(serviceContext.getUuid());
  wsrpProducer.setGroupId(groupId);
  wsrpProducer.setCompanyId(user.getCompanyId());
  wsrpProducer.setCreateDate(now);
  wsrpProducer.setModifiedDate(now);
  wsrpProducer.setName(name);
  wsrpProducer.setVersion(version);
  wsrpProducer.setPortletIds(portletIds);
  wsrpProducerPersistence.update(wsrpProducer);
  return wsrpProducer;
}
