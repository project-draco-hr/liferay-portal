{
  List referenceList=_mergeReferenceList(entity.getReferenceList());
  StringMaker sm=new StringMaker();
  sm.append("package " + _packagePath + ".service.base;");
  sm.append("import " + _packagePath + ".service."+ entity.getName()+ _getSessionTypeName(sessionType)+ "Service;");
  if (sessionType == _REMOTE) {
    sm.append("import " + _principalBeanPackage + ".PrincipalBean;");
  }
  if (entity.hasColumns()) {
    sm.append("import " + _packagePath + ".service.persistence."+ entity.getName()+ "Util;");
    sm.append("import com.liferay.portal.SystemException;");
    sm.append("import com.liferay.portal.kernel.dao.DynamicQueryInitializer;");
    sm.append("import java.util.List;");
  }
  for (int i=0; i < referenceList.size(); i++) {
    Entity tempEntity=(Entity)referenceList.get(i);
    if (entity.equals(tempEntity)) {
      if ((sessionType == _REMOTE) && tempEntity.hasLocalService()) {
        sm.append("import " + tempEntity.getPackagePath() + ".service."+ tempEntity.getName()+ "LocalService;");
      }
    }
 else {
      if (tempEntity.hasLocalService()) {
        sm.append("import " + tempEntity.getPackagePath() + ".service."+ tempEntity.getName()+ "LocalService;");
      }
      if (tempEntity.hasRemoteService()) {
        sm.append("import " + tempEntity.getPackagePath() + ".service."+ tempEntity.getName()+ "Service;");
      }
    }
  }
  if (sessionType == _REMOTE) {
    sm.append("public abstract class " + entity.getName() + "ServiceBaseImpl extends PrincipalBean implements "+ entity.getName()+ "Service {");
  }
 else {
    sm.append("public abstract class " + entity.getName() + "LocalServiceBaseImpl implements "+ entity.getName()+ "LocalService {");
  }
  if ((sessionType == _LOCAL) && entity.hasColumns()) {
    sm.append("public List dynamicQuery(DynamicQueryInitializer queryInitializer) throws SystemException {");
    sm.append("return " + entity.getName() + "Util.findWithDynamicQuery(queryInitializer);");
    sm.append("}");
    sm.append("public List dynamicQuery(DynamicQueryInitializer queryInitializer, int begin, int end) throws SystemException {");
    sm.append("return " + entity.getName() + "Util.findWithDynamicQuery(queryInitializer, begin, end);");
    sm.append("}");
  }
  for (int i=0; i < referenceList.size(); i++) {
    Entity tempEntity=(Entity)referenceList.get(i);
    if (entity.equals(tempEntity)) {
      if ((sessionType == _REMOTE) && tempEntity.hasLocalService()) {
        sm.append("public " + tempEntity.getName() + "LocalService get"+ tempEntity.getName()+ "LocalService() {");
        sm.append("return " + tempEntity.getVarName() + "LocalService;");
        sm.append("}");
        sm.append("public void set" + tempEntity.getName() + "LocalService("+ tempEntity.getName()+ "LocalService "+ tempEntity.getVarName()+ "LocalService) {");
        sm.append("this." + tempEntity.getVarName() + "LocalService = "+ tempEntity.getVarName()+ "LocalService;");
        sm.append("}");
      }
    }
 else {
      if (tempEntity.hasLocalService()) {
        sm.append("public " + tempEntity.getName() + "LocalService get"+ tempEntity.getName()+ "LocalService() {");
        sm.append("return " + tempEntity.getVarName() + "LocalService;");
        sm.append("}");
        sm.append("public void set" + tempEntity.getName() + "LocalService("+ tempEntity.getName()+ "LocalService "+ tempEntity.getVarName()+ "LocalService) {");
        sm.append("this." + tempEntity.getVarName() + "LocalService = "+ tempEntity.getVarName()+ "LocalService;");
        sm.append("}");
      }
      if (tempEntity.hasRemoteService()) {
        sm.append("public " + tempEntity.getName() + "Service get"+ tempEntity.getName()+ "Service() {");
        sm.append("return " + tempEntity.getVarName() + "Service;");
        sm.append("}");
        sm.append("public void set" + tempEntity.getName() + "Service("+ tempEntity.getName()+ "Service "+ tempEntity.getVarName()+ "Service) {");
        sm.append("this." + tempEntity.getVarName() + "Service = "+ tempEntity.getVarName()+ "Service;");
        sm.append("}");
      }
    }
  }
  for (int i=0; i < referenceList.size(); i++) {
    Entity tempEntity=(Entity)referenceList.get(i);
    if (entity.equals(tempEntity)) {
      if ((sessionType == _REMOTE) && tempEntity.hasLocalService()) {
        sm.append("protected " + tempEntity.getName() + "LocalService "+ tempEntity.getVarName()+ "LocalService;");
      }
    }
 else {
      if (tempEntity.hasLocalService()) {
        sm.append("protected " + tempEntity.getName() + "LocalService "+ tempEntity.getVarName()+ "LocalService;");
      }
      if (tempEntity.hasRemoteService()) {
        sm.append("protected " + tempEntity.getName() + "Service "+ tempEntity.getVarName()+ "Service;");
      }
    }
  }
  sm.append("}");
  File ejbFile=new File(_outputPath + "/service/base/" + entity.getName()+ _getSessionTypeName(sessionType)+ "ServiceBaseImpl.java");
  writeFile(ejbFile,sm.toString());
}
