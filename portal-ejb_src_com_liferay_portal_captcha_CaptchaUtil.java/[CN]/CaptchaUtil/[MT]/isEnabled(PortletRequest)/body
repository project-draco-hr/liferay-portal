{
  int captchaMaxChallenges=GetterUtil.getInteger(PropsUtil.get(PropsUtil.CAPTCHA_MAX_CHALLENGES));
  if (captchaMaxChallenges > 0) {
    PortletSession ses=req.getPortletSession();
    Integer count=(Integer)ses.getAttribute(WebKeys.CAPTCHA_COUNT);
    if ((count != null) && (captchaMaxChallenges <= count.intValue())) {
      return false;
    }
 else {
      return true;
    }
  }
 else   if (captchaMaxChallenges < 0) {
    return false;
  }
 else {
    return true;
  }
}
