{
  if (pos.getDayOfWeek() != candidate.get(Calendar.DAY_OF_WEEK)) {
    return false;
  }
  int position=pos.getDayPosition();
  if (position == 0) {
    return true;
  }
  int field;
switch (frequency) {
case MONTHLY:
    field=Calendar.DAY_OF_MONTH;
  break;
case YEARLY:
if (byMonth != null) {
  field=Calendar.DAY_OF_MONTH;
}
 else {
  field=Calendar.DAY_OF_YEAR;
}
break;
default :
throw new IllegalStateException("byday has a day position " + "in non-MONTHLY or YEARLY recurrence");
}
if (position > 0) {
int day_of_week_in_field=((candidate.get(field) - 1) / 7) + 1;
return (position == day_of_week_in_field);
}
 else {
int negative_day_of_week_in_field=((candidate.getActualMaximum(field) - candidate.get(field)) / 7) + 1;
return (-position == negative_day_of_week_in_field);
}
}
