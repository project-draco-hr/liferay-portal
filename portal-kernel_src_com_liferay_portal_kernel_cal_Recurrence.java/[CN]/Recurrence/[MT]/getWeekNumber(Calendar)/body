{
  Calendar tempCal=(Calendar)cal.clone();
  tempCal.set(Calendar.MILLISECOND,0);
  tempCal.set(Calendar.SECOND,0);
  tempCal.set(Calendar.MINUTE,0);
  tempCal.set(Calendar.HOUR_OF_DAY,0);
  int delta=tempCal.getFirstDayOfWeek() - tempCal.get(Calendar.DAY_OF_WEEK);
  if (delta > 0) {
    delta-=7;
  }
  long weekEpoch=(tempCal.getFirstDayOfWeek() - Calendar.THURSDAY) * 24L * 60* 60* 1000;
  return (tempCal.getTime().getTime() - weekEpoch) / (7 * 24 * 60* 60* 1000);
}
