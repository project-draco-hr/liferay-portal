{
  HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
  IntegerWrapper iconCount=(IntegerWrapper)request.getAttribute("liferay-ui:icon-menu:icon-count");
  request.removeAttribute("liferay-ui:icon-menu:icon-count");
  request.removeAttribute("liferay-ui:icon-menu:id");
  Boolean singleIcon=(Boolean)request.getAttribute("liferay-ui:icon-menu:single-icon");
  request.removeAttribute("liferay-ui:icon-menu:single-icon");
  JspWriter jspWriter=pageContext.getOut();
  if ((iconCount != null) && (iconCount.getValue() >= 1) && ((singleIcon == null) || _showWhenSingleIcon)) {
    if (!FileAvailabilityUtil.isAvailable(pageContext.getServletContext(),getStartPage())) {
      if (_showExpanded) {
        jspWriter.write("<div class=\"lfr-component ");
        jspWriter.write("lfr-menu-list lfr-menu-expanded align-");
        jspWriter.write(_align);
        jspWriter.write(" ");
        jspWriter.print(_cssClass);
        jspWriter.write("\" id=\"");
        jspWriter.write(_id);
        jspWriter.write("\">");
      }
 else {
        String message=_message;
        if (_localizeMessage) {
          message=LanguageUtil.get(pageContext,_message);
        }
        jspWriter.write("<span title=\"");
        jspWriter.write(message);
        jspWriter.write("\"><ul class='lfr-component lfr-actions ");
        jspWriter.write("align-");
        jspWriter.write(_align);
        jspWriter.write(" direction-");
        jspWriter.write(_direction);
        jspWriter.write(" max-display-items-");
        jspWriter.write(String.valueOf(_maxDisplayItems));
        jspWriter.write(" ");
        if (Validator.isNotNull(_cssClass)) {
          jspWriter.print(_cssClass);
        }
        if (_disabled) {
          jspWriter.write(" disabled");
        }
        if (_extended) {
          jspWriter.write(" lfr-extended");
        }
        if (_showArrow) {
          jspWriter.write(" show-arrow");
        }
        jspWriter.write("\' id=\"");
        jspWriter.write(_id);
        jspWriter.write("\">");
        jspWriter.write("<li class=\"lfr-trigger\"><strong>");
        jspWriter.write("<a class=\"nobr\" href=\"javascript:;\" id=\"");
        jspWriter.write(_id);
        jspWriter.write("Button\">");
        if (Validator.isNotNull(_icon)) {
          jspWriter.write("<img alt=\"\" src=\"");
          jspWriter.write(_icon);
          jspWriter.write("\" />");
        }
        jspWriter.write("<span class=\"taglib-text\">");
        jspWriter.write(message);
        jspWriter.write("</span></a></strong>");
        ScriptTag.doTag(null,"liferay-menu","Liferay.Menu.register('" + _id + "');",bodyContent,pageContext);
      }
      jspWriter.write("<ul>");
    }
 else {
      PortalIncludeUtil.include(pageContext,getStartPage());
    }
  }
  writeBodyContent(jspWriter);
  if ((iconCount != null) && (iconCount.getValue() >= 1) && ((singleIcon == null) || _showWhenSingleIcon)) {
    if (!FileAvailabilityUtil.isAvailable(pageContext.getServletContext(),getEndPage())) {
      jspWriter.write("</ul>");
      if (_showExpanded) {
        jspWriter.write("</div>");
        ScriptTag.doTag(null,"liferay-menu","Liferay.Menu.handleFocus('#" + _id + "menu');",bodyContent,pageContext);
      }
 else {
        jspWriter.write("</li></ul></span>");
      }
    }
 else {
      PortalIncludeUtil.include(pageContext,getEndPage());
    }
  }
  request.removeAttribute("liferay-ui:icon-menu:showWhenSingleIcon");
  return EVAL_PAGE;
}
