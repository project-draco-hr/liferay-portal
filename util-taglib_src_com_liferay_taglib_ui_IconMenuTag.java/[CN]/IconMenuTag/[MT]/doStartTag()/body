{
  HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (_direction == null) {
    if (_align.equals("left")) {
      _direction="right";
    }
 else {
      _direction="left";
    }
  }
  if (_icon == null) {
    _icon=themeDisplay.getPathThemeImages() + "/common/tool.png";
  }
  if (Validator.isNull(_id)) {
    String randomKey=PortalUtil.generateRandomKey(request,IconMenuTag.class.getName());
    _id=randomKey + StringPool.UNDERLINE + "menu";
  }
 else {
    PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
    String namespace=portletDisplay.getNamespace();
    _id=namespace.concat(_id);
  }
  request.setAttribute("liferay-ui:icon-menu:icon-count",new IntegerWrapper());
  request.setAttribute("liferay-ui:icon-menu:showWhenSingleIcon",String.valueOf(_showWhenSingleIcon));
  return EVAL_BODY_BUFFERED;
}
