{
  boolean found=false;
  boolean foundSome=false;
  String replaceText=getText(_replaceField.getDocument());
  do {
    found=find(false,SEARCH_HERE);
    if (found) {
      foundSome=true;
      _textPane.replaceSelection(replaceText);
    }
  }
 while (all && found);
  if (all ? foundSome : found) {
    int caret=_textPane.getCaretPosition();
    _textPane.setSelectionStart(caret - replaceText.length());
    _textPane.setSelectionEnd(caret);
    _textPane.requestFocus();
  }
 else {
    _findField.requestFocus();
    getToolkit().beep();
  }
  updateUndoState();
}
