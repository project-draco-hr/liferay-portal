{
  String path=super.processPath(request,response);
  ActionMapping actionMapping=(ActionMapping)moduleConfig.findActionConfig(path);
  Action action=StrutsActionRegistry.getAction(path);
  boolean basicAuthEnabled;
  String lastPath=null;
  try {
    basicAuthEnabled=(Boolean)request.getSession().getAttribute(WebKeys.BASIC_AUTH_ENABLED);
    lastPath=getLastPath(request);
  }
 catch (  NullPointerException npe) {
    basicAuthEnabled=false;
  }
  if ((basicAuthEnabled) && (Validator.isNotNull(lastPath))) {
    request.getSession().removeAttribute(WebKeys.BASIC_AUTH_ENABLED);
    response.sendRedirect(lastPath);
  }
  if ((actionMapping == null) && (action == null)) {
    lastPath=getLastPath(request);
    if (_log.isDebugEnabled()) {
      _log.debug("Last path " + lastPath);
    }
    response.sendRedirect(lastPath);
    return;
  }
  super.process(request,response);
  try {
    if (isPortletPath(path)) {
      cleanUp(request);
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
