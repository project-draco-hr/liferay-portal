{
  HttpSession session=request.getSession();
  Boolean basicAuthEnabled=(Boolean)session.getAttribute(WebKeys.BASIC_AUTH_ENABLED);
  if (basicAuthEnabled != null) {
    session.removeAttribute(WebKeys.BASIC_AUTH_ENABLED);
  }
  String path=super.processPath(request,response);
  ActionMapping actionMapping=(ActionMapping)moduleConfig.findActionConfig(path);
  Action action=StrutsActionRegistryUtil.getAction(path);
  if (((basicAuthEnabled != null) && basicAuthEnabled.booleanValue()) || ((actionMapping == null) && (action == null))) {
    String lastPath=getLastPath(request);
    if (_log.isDebugEnabled()) {
      _log.debug("Last path " + lastPath);
    }
    response.sendRedirect(lastPath);
    return;
  }
  super.process(request,response);
  try {
    if (isPortletPath(path)) {
      cleanUp(request);
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
