{
  Map<String,Object> properties=new Hashtable<String,Object>();
  properties.put("bundle",bundle);
  properties.put("bundle.id",bundle.getBundleId());
  properties.put("bundle.symbolicName",bundle.getSymbolicName());
  properties.put("bundle.version",bundle.getVersion());
  String servletContextName=BundleServletContext.getServletContextName(bundle,true);
  String contextPath=StringPool.SLASH.concat(servletContextName);
  if (collision) {
    properties.put("collision",contextPath);
    List<String> collidedBundleIds=new ArrayList<String>();
    BundleContext bundleContext=bundle.getBundleContext();
    for (    Bundle curBundle : bundleContext.getBundles()) {
      if (curBundle.equals(bundle) || (curBundle.getState() != Bundle.ACTIVE)) {
        continue;
      }
      String curServletContextName=BundleServletContext.getServletContextName(curBundle);
      if ((curServletContextName != null) && curServletContextName.equals(servletContextName)) {
        collidedBundleIds.add(String.valueOf(curBundle.getBundleId()));
      }
    }
    properties.put("collision.bundles",collidedBundleIds);
  }
  properties.put("context.path",contextPath);
  if (exception != null) {
    properties.put("exception",exception);
  }
  properties.put("extender.bundle",_webExtenderBundle);
  properties.put("extender.bundle.id",_webExtenderBundle.getBundleId());
  properties.put("extender.bundle.symbolicName",_webExtenderBundle.getSymbolicName());
  properties.put("extender.bundle.version",_webExtenderBundle.getVersion());
  properties.put("servlet.context.name",servletContextName);
  properties.put("timestamp",System.currentTimeMillis());
  Event event=new Event(eventTopic,properties);
  if (_log.isInfoEnabled()) {
    _log.info(event);
  }
  if (_eventAdmin == null) {
    return;
  }
  _eventAdmin.sendEvent(event);
}
