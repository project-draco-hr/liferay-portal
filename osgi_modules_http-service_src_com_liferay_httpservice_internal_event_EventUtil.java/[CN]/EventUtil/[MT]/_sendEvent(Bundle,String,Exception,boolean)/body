{
  String servletContextName=BundleServletContext.getServletContextName(bundle,true);
  String servletContextPath=StringPool.SLASH.concat(servletContextName);
  Map<String,Object> properties=new Hashtable<String,Object>();
  properties.put("bundle",bundle);
  properties.put("bundle.id",bundle.getBundleId());
  properties.put("bundle.symbolicName",bundle.getSymbolicName());
  properties.put("bundle.version",bundle.getVersion());
  if (collision) {
    properties.put("collision",servletContextPath);
    List<String> collidedIds=new ArrayList<String>();
    for (    Bundle curBundle : bundle.getBundleContext().getBundles()) {
      if (curBundle.equals(bundle) || (curBundle.getState() != Bundle.ACTIVE)) {
        continue;
      }
      String curContextName=BundleServletContext.getServletContextName(curBundle);
      if ((curContextName != null) && curContextName.equals(servletContextName)) {
        collidedIds.add(String.valueOf(curBundle.getBundleId()));
      }
    }
    properties.put("collision.bundles",collidedIds);
  }
  properties.put("context.path",servletContextPath);
  properties.put("extender.bundle",_webExtenderBundle);
  properties.put("extender.bundle.id",_webExtenderBundle.getBundleId());
  properties.put("extender.bundle.symbolicName",_webExtenderBundle.getSymbolicName());
  properties.put("extender.bundle.version",_webExtenderBundle.getVersion());
  if (exception != null) {
    properties.put("exception",exception);
  }
  properties.put("servlet.context.name",servletContextName);
  properties.put("timestamp",System.currentTimeMillis());
  Event event=new Event(eventTopic,properties);
  if (_log.isInfoEnabled()) {
    _log.info(event);
  }
  if (_eventAdmin == null) {
    return;
  }
  _eventAdmin.sendEvent(event);
}
