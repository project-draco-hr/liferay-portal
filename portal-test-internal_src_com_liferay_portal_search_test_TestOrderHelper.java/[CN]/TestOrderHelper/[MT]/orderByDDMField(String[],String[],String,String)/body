{
  DDMStructure ddmStructure=_addStructure(dataType,type);
  DDMTemplate ddmTemplate=_addTemplate(ddmStructure);
  _addSearchableAssets(unsortedValues,ddmStructure,ddmTemplate);
  final AssetEntryQuery assetEntryQuery=_createAssetEntryQuery(ddmStructure);
  final AssetRendererFactory assetRendererFactory=AssetRendererFactoryRegistryUtil.getAssetRendererFactoryByClassName(getSearchableAssetClassName());
  IdempotentRetryAssert.retryAssert(3,TimeUnit.SECONDS,new Callable<Void>(){
    @Override public Void call() throws Exception {
      _assertArrayEquals(sortedValues,assetEntryQuery,assetRendererFactory);
      return null;
    }
  }
);
}
