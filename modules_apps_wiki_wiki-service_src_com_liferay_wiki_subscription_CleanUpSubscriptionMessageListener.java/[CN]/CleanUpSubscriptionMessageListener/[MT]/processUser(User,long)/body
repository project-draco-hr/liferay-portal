{
  List<Group> groups=user.getMySiteGroups(true,QueryUtil.ALL_POS);
  long[] groupIds=getGroupIds(groups);
  List<Subscription> subscriptions=SubscriptionLocalServiceUtil.getUserSubscriptions(user.getUserId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  for (  Subscription subscription : subscriptions) {
    try {
      processSubscription(subscription,groupId,groupIds);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        StringBundler sb=new StringBundler(8);
        sb.append("Subscription was not removed for class name ");
        sb.append(subscription.getClassName());
        sb.append(" with class PK ");
        sb.append(subscription.getClassPK());
        sb.append(" in group ");
        sb.append(groupId);
        sb.append(" for user ");
        sb.append(subscription.getUserId());
        _log.warn(sb.toString());
      }
    }
  }
}
