{
  try {
    runSQL("alter_column_type User_ greeting VARCHAR(255) null");
  }
 catch (  Exception e) {
    UpgradeTable upgradeTable=new DefaultUpgradeTableImpl(UserTable.TABLE_NAME,UserTable.TABLE_COLUMNS);
    upgradeTable.setCreateSQL(UserTable.TABLE_SQL_CREATE);
    upgradeTable.updateTable();
  }
  if (isSupportsUpdateWithInnerJoin()) {
    StringBuilder sb=new StringBuilder();
    sb.append("update User_ inner join Contact_ on ");
    sb.append("Contact_.contactId = User_.contactId set ");
    sb.append("User_.firstName = Contact_.firstName, ");
    sb.append("User_.middleName = Contact_.middleName, ");
    sb.append("User_.lastName = Contact_.lastName, ");
    sb.append("User_.jobTitle = Contact_.jobTitle");
    runSQL(sb.toString());
  }
 else {
    Connection con=null;
    PreparedStatement ps=null;
    ResultSet rs=null;
    try {
      con=DataAccess.getConnection();
      ps=con.prepareStatement("select contactId, firstName, middleName, lastName, " + "jobTitle from Contact_");
      rs=ps.executeQuery();
      while (rs.next()) {
        long contactId=rs.getLong("contactId");
        String firstName=rs.getString("firstName");
        String middleName=rs.getString("middleName");
        String lastName=rs.getString("lastName");
        String jobTitle=rs.getString("jobTitle");
        ps=con.prepareStatement("update User_ set firstName = ?, middleName = ?, " + "lastName = ?, jobTitle = ? where contactId = ?");
        ps.setString(1,firstName);
        ps.setString(2,middleName);
        ps.setString(3,lastName);
        ps.setString(4,jobTitle);
        ps.setLong(5,contactId);
        ps.executeUpdate();
        ps.close();
      }
    }
  finally {
      DataAccess.cleanUp(con,ps,rs);
    }
  }
}
