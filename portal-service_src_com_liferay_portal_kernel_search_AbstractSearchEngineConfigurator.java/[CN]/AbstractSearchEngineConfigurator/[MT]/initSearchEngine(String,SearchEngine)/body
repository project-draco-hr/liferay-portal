{
  SearchEngineRegistration searchEngineRegistration=new SearchEngineRegistration(searchEngineId);
  _searchEngineRegistrations.add(searchEngineRegistration);
  Destination searchReaderDestination=getSearchReaderDestination(_messageBus,searchEngineId,searchEngine);
  searchEngineRegistration.setSearchReaderDestinationName(searchReaderDestination.getName());
  Destination searchWriterDestination=getSearchWriterDestination(_messageBus,searchEngineId,searchEngine);
  searchEngineRegistration.setSearchWriterDestinationName(searchWriterDestination.getName());
  SearchEngine originalSearchEngine=SearchEngineUtil.getSearchEngineSilent(searchEngineId);
  if (originalSearchEngine != null) {
    searchEngineRegistration.setOverride(true);
    searchEngineRegistration.setOriginalSearchEngineProxyWrapper((SearchEngineProxyWrapper)originalSearchEngine);
    savePreviousSearchEngineListeners(searchReaderDestination,searchWriterDestination,searchEngineRegistration);
    _messageBus.removeDestination(searchReaderDestination.getName());
    searchReaderDestination=getSearchReaderDestination(_messageBus,searchEngineId,originalSearchEngine);
    _messageBus.removeDestination(searchWriterDestination.getName());
    searchWriterDestination=getSearchWriterDestination(_messageBus,searchEngineId,originalSearchEngine);
  }
  createSearchEngineListeners(searchEngineId,searchEngine,searchReaderDestination,searchWriterDestination);
  SearchEngineProxyWrapper searchEngineProxyWrapper=new SearchEngineProxyWrapper(searchEngine,getIndexSearcher(),getIndexWriter());
  SearchEngineUtil.setSearchEngine(searchEngineId,searchEngineProxyWrapper);
}
