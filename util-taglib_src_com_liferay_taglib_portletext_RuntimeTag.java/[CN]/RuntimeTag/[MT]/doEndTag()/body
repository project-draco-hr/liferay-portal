{
  try {
    HttpServletRequest req=(HttpServletRequest)pageContext.getRequest();
    Layout layout=(Layout)req.getAttribute(WebKeys.LAYOUT);
    if (layout == null) {
      return EVAL_PAGE;
    }
    ServletContext ctx=(ServletContext)req.getAttribute(WebKeys.CTX);
    HttpServletResponse res=(HttpServletResponse)pageContext.getResponse();
    doTag(_portletName,_queryString,pageContext,ctx,req,res);
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    _log.error(e,e);
    throw new JspException(e);
  }
}
