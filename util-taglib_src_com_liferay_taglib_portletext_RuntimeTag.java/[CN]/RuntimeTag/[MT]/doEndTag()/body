{
  try {
    HttpServletRequest request=(HttpServletRequest)pageContext.getRequest();
    Layout layout=(Layout)request.getAttribute(WebKeys.LAYOUT);
    if (layout == null) {
      return EVAL_PAGE;
    }
    HttpServletResponse response=(HttpServletResponse)pageContext.getResponse();
    doTag(_portletName,_queryString,_defaultPreferences,pageContext,request,response);
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    _log.error(e,e);
    throw new JspException(e);
  }
}
