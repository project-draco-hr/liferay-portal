{
  String portletId=PortletProviderUtil.getPortletId(portletProviderClassName,portletProviderAction);
  if (Validator.isNotNull(portletId)) {
    doTag(portletId,portletInstanceId,queryString,_SETTINGS_SCOPE_DEFAULT,defaultPreferences,pageContext,request,response);
  }
 else {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    Layout layout=themeDisplay.getLayout();
    if (!layout.isTypeControlPanel() && !LayoutPermissionUtil.contains(themeDisplay.getPermissionChecker(),layout,ActionKeys.UPDATE)) {
      return;
    }
    request.setAttribute("liferay-portlet:runtime:portletProviderClassName",portletProviderClassName);
    request.setAttribute("liferay-portlet:runtime:portletProviderAction",portletProviderAction);
    PortalIncludeUtil.include(pageContext,_ERROR_PAGE);
  }
}
