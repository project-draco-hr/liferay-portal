{
  String portletId=PortletProviderUtil.getPortletId(portletProviderClassName,portletProviderAction);
  if (Validator.isNotNull(portletId)) {
    doTag(portletId,instanceId,queryString,_SETTINGS_SCOPE_DEFAULT,defaultPreferences,persistSettings,pageContext,request,response);
  }
 else {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    Layout layout=themeDisplay.getLayout();
    if (!layout.isTypeControlPanel() && !LayoutPermissionUtil.contains(themeDisplay.getPermissionChecker(),layout,ActionKeys.UPDATE)) {
      return;
    }
    String errorMessage=LanguageUtil.format(request,"an-app-that-can-x-x-belongs-here",new Object[]{portletProviderAction.name(),portletProviderClassName},false);
    request.setAttribute("liferay-portlet:runtime:errorMessage",errorMessage);
    PortalIncludeUtil.include(pageContext,_ERROR_PAGE);
  }
}
