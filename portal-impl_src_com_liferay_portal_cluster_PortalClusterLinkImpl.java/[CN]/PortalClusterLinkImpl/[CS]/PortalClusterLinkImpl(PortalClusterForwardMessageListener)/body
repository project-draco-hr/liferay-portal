{
  _portalClusterForwardMessageListener=portalClusterForwardMessageListener;
  _setupSystemProperties();
  _autoDetectBindAddr();
  Properties customProperties=PropsUtil.getProperties(PropsKeys.CLUSTER_LINK_CHANNEL_PROPERTIES,true);
  Set<Object> keySet=customProperties.keySet();
  List<String> customNames=new ArrayList<String>(keySet.size());
  for (  Object key : keySet) {
    customNames.add((String)key);
  }
  Collections.sort(customNames);
  _channelNumber=customNames.size();
  if (_channelNumber <= 0 || _channelNumber > MAX_CHANNEL_NUMBER) {
    throw new IllegalArgumentException("Channel number should between [1 to " + MAX_CHANNEL_NUMBER + "]");
  }
  _channelList=new ArrayList<JChannel>(_channelNumber);
  _localAddressList=new ArrayList<Address>(_channelNumber);
  try {
    for (int i=0; i < _channelNumber; i++) {
      JChannel channel=_createChannel(i,customProperties.getProperty(customNames.get(i)));
      _channelList.add(i,channel);
      _localAddressList.add(channel.getLocalAddress());
    }
  }
 catch (  Exception e) {
    _log.error("Error initializing",e);
  }
}
