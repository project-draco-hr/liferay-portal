{
  SyncAccount syncAccount=SyncAccountService.fetchSyncAccount(syncAccountId);
  if (!moveFile) {
    SyncFile syncFile=SyncFileService.fetchSyncFile(syncAccount.getFilePathName());
    if (syncFile.getSyncFileId() != FileKeyUtil.getFileKey(filePath)) {
      throw new Exception("Target folder is not the moved sync data folder");
    }
  }
  syncAccount.setActive(false);
  SyncAccountService.update(syncAccount);
  if (moveFile) {
    try {
      Files.createDirectories(filePath);
      Files.move(Paths.get(syncAccount.getFilePathName()),filePath,StandardCopyOption.REPLACE_EXISTING);
    }
 catch (    Exception e) {
      syncAccount.setActive(true);
      SyncAccountService.update(syncAccount);
      throw e;
    }
  }
  syncAccount=setFilePathName(syncAccountId,filePath.toString());
  syncAccount.setActive(true);
  syncAccount.setUiEvent(SyncAccount.UI_EVENT_NONE);
  SyncAccountService.update(syncAccount);
}
