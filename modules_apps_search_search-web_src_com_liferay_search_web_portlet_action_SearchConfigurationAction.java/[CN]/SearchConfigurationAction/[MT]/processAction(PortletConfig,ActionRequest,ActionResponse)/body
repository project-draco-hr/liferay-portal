{
  JSONArray newFacetsJSONArray=JSONFactoryUtil.createJSONArray();
  for (  SearchFacet searchFacet : SearchFacetTracker.getSearchFacets()) {
    boolean displayFacet=ParamUtil.getBoolean(actionRequest,searchFacet.getClassName() + "displayFacet");
    double weight=ParamUtil.getDouble(actionRequest,searchFacet.getClassName() + "weight");
    JSONObject facetJSONObject=JSONFactoryUtil.createJSONObject();
    facetJSONObject.put("className",searchFacet.getClassName());
    facetJSONObject.put("data",searchFacet.getJSONData(actionRequest));
    facetJSONObject.put("fieldName",searchFacet.getFieldName());
    facetJSONObject.put("label",searchFacet.getLabel());
    facetJSONObject.put("order",searchFacet.getOrder());
    facetJSONObject.put("id",searchFacet.getId());
    facetJSONObject.put("static",!displayFacet);
    facetJSONObject.put("weight",weight);
    newFacetsJSONArray.put(facetJSONObject);
  }
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  jsonObject.put("facets",newFacetsJSONArray);
  setPreference(actionRequest,"searchConfiguration",jsonObject.toString());
  super.processAction(portletConfig,actionRequest,actionResponse);
}
