{
  LayoutSet layoutSet=layoutSetPersistence.findByG_P(groupId,privateLayout);
  layoutSet=wrapLayoutSet(layoutSet);
  LayoutSetBranch layoutSetBranch=LayoutStagingUtil.getLayoutSetBranch(layoutSet);
  if (layoutSetBranch == null) {
    return target.updateLookAndFeel(groupId,privateLayout,themeId,colorSchemeId,css,wapTheme);
  }
  layoutSetBranch.setModifiedDate(new Date());
  if (Validator.isNull(themeId)) {
    themeId=ThemeImpl.getDefaultRegularThemeId(layoutSetBranch.getCompanyId());
  }
  if (Validator.isNull(colorSchemeId)) {
    colorSchemeId=ColorSchemeImpl.getDefaultRegularColorSchemeId();
  }
  if (wapTheme) {
    layoutSetBranch.setWapThemeId(themeId);
    layoutSetBranch.setWapColorSchemeId(colorSchemeId);
  }
 else {
    layoutSetBranch.setThemeId(themeId);
    layoutSetBranch.setColorSchemeId(colorSchemeId);
    layoutSetBranch.setCss(css);
  }
  layoutSetBranchPersistence.update(layoutSetBranch);
  return layoutSet;
}
