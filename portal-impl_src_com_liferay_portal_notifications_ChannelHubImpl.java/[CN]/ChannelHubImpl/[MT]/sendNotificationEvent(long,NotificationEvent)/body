{
  Channel channel=fetchChannel(userId);
  if (channel != null) {
    channel.sendNotificationEvent(notificationEvent);
    return;
  }
  if (!PropsValues.USER_NOTIFICATION_EVENT_CONFIRMATION_ENABLED || !notificationEvent.isDeliveryRequired()) {
    return;
  }
  try {
    UserNotificationEventLocalServiceUtil.addUserNotificationEvent(userId,notificationEvent);
  }
 catch (  Exception e) {
    throw new ChannelException("Unable to send event",e);
  }
}
