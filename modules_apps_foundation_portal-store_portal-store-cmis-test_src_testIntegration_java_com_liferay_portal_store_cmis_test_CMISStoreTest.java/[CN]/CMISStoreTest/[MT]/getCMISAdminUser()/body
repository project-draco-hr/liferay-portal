{
  User user=UserLocalServiceUtil.fetchUserByScreenName(TestPropsValues.getCompanyId(),ConfigurationAdminBundleActivator.CREDENTIALS_USERNAME);
  if (user != null) {
    return user;
  }
  String password=ConfigurationAdminBundleActivator.CREDENTIALS_PASSWORD;
  String emailAddress=ConfigurationAdminBundleActivator.CREDENTIALS_USERNAME + "@liferay.com";
  user=UserLocalServiceUtil.addUser(TestPropsValues.getUserId(),TestPropsValues.getCompanyId(),false,password,password,false,ConfigurationAdminBundleActivator.CREDENTIALS_USERNAME,emailAddress,0,StringPool.BLANK,LocaleUtil.getDefault(),RandomTestUtil.randomString(),StringPool.BLANK,RandomTestUtil.randomString(),0,0,true,Calendar.JANUARY,1,1970,StringPool.BLANK,new long[]{repositoryId},null,null,null,false,ServiceContextTestUtil.getServiceContext());
  Role role=RoleLocalServiceUtil.getRole(TestPropsValues.getCompanyId(),RoleConstants.ADMINISTRATOR);
  RoleLocalServiceUtil.addUserRole(user.getUserId(),role.getRoleId());
  return user;
}
