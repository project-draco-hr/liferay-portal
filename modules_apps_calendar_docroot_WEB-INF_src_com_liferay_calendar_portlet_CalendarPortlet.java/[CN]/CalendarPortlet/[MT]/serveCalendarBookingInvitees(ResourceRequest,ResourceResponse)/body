{
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long parentCalendarBookingId=ParamUtil.getLong(resourceRequest,"parentCalendarBookingId");
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  List<CalendarBooking> childCalendarBookings=CalendarBookingServiceUtil.getChildCalendarBookings(parentCalendarBookingId);
  Collection<CalendarResource> calendarResources=CalendarUtil.getCalendarResources(childCalendarBookings);
  for (  CalendarResource calendarResource : calendarResources) {
    JSONObject jsonObject=CalendarUtil.toCalendarResourceJSONObject(themeDisplay,calendarResource);
    jsonArray.put(jsonObject);
  }
  writeJSON(resourceRequest,resourceResponse,jsonArray);
}
