{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long userId=themeDisplay.getUserId();
  long groupId=ParamUtil.getLong(portletRequest,"groupId");
  Map<String,Serializable> configurationContextMap=null;
  if (configurationType == ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT) {
    configurationContextMap=doCreateConfigurationContextMap(portletRequest,userId,groupId,true,ExportImportDateUtil.RANGE_ALL);
  }
 else {
    configurationContextMap=doCreateConfigurationContextMap(portletRequest,userId,groupId,false,ExportImportDateUtil.RANGE_FROM_LAST_PUBLISH_DATE);
  }
  String exportImportConfigurationName=ParamUtil.getString(portletRequest,"exportImportConfigurationName");
  String exportImportConfigurationDescription=ParamUtil.getString(portletRequest,"exportImportConfigurationDescription");
  return ExportImportConfigurationLocalServiceUtil.addExportImportConfiguration(userId,groupId,exportImportConfigurationName,exportImportConfigurationDescription,configurationType,configurationContextMap,new ServiceContext());
}
