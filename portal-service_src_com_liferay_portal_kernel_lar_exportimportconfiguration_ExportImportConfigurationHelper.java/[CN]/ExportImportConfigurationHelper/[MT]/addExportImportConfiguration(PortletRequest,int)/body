{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(portletRequest,"groupId");
  Map<String,Serializable> settingsMap=null;
  if (configurationType == ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT) {
    settingsMap=buildSettingsMap(portletRequest,themeDisplay.getUserId(),groupId,true,ExportImportDateUtil.RANGE_ALL);
  }
 else {
    settingsMap=buildSettingsMap(portletRequest,themeDisplay.getUserId(),groupId,false,ExportImportDateUtil.RANGE_FROM_LAST_PUBLISH_DATE);
  }
  String exportImportConfigurationName=ParamUtil.getString(portletRequest,"exportImportConfigurationName");
  String exportImportConfigurationDescription=ParamUtil.getString(portletRequest,"exportImportConfigurationDescription");
  return ExportImportConfigurationLocalServiceUtil.addExportImportConfiguration(themeDisplay.getUserId(),groupId,exportImportConfigurationName,exportImportConfigurationDescription,configurationType,settingsMap,new ServiceContext());
}
