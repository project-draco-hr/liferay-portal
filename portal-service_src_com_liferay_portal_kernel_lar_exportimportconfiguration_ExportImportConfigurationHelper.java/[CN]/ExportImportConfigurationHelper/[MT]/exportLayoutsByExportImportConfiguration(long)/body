{
  ExportImportConfiguration exportImportConfiguration=ExportImportConfigurationLocalServiceUtil.getExportImportConfiguration(configurationId);
  Map<String,Serializable> configurationSettingsMap=exportImportConfiguration.getSettingsMap();
  Map<String,String[]> parameterMap=(Map<String,String[]>)configurationSettingsMap.get("parameterMap");
  String taskName=MapUtil.getString(parameterMap,"exportFileName");
  long groupId=MapUtil.getLong(configurationSettingsMap,"sourceGroupId");
  boolean privateLayout=GetterUtil.getBoolean(configurationSettingsMap.get("privateLayout"));
  Map<Long,Boolean> layoutIdMap=(Map<Long,Boolean>)configurationSettingsMap.get("layoutIdMap");
  long[] layoutIds=ExportImportHelperUtil.getLayoutIds(layoutIdMap);
  DateRange dateRange=ExportImportDateUtil.getDateRange(exportImportConfiguration);
  String fileName=MapUtil.getString(parameterMap,"exportFileName");
  LayoutServiceUtil.exportLayoutsAsFileInBackground(taskName,groupId,privateLayout,layoutIds,parameterMap,dateRange.getStartDate(),dateRange.getEndDate(),fileName);
}
