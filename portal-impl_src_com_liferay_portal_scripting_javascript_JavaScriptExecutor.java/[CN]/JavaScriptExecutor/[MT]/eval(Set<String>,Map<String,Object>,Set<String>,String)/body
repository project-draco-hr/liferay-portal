{
  Script compiledScript=getCompiledScript(script);
  try {
    Context context=Context.enter();
    Scriptable scope=context.initStandardObjects();
    for (    String varName : inputObjects.keySet()) {
      ScriptableObject.putProperty(scope,varName,Context.javaToJS(inputObjects.get(varName),scope));
    }
    if (allowedClasses != null) {
      context.setClassShutter(new JavaScriptClassVisibilityChecker(allowedClasses));
    }
    compiledScript.exec(context,scope);
    if (outputNames == null) {
      return null;
    }
    Map<String,Object> outputObjects=new HashMap<String,Object>();
    for (    String outputName : outputNames) {
      outputObjects.put(outputName,ScriptableObject.getProperty(scope,outputName));
    }
    return outputObjects;
  }
 catch (  Exception e) {
    StringBuilder sb=new StringBuilder();
    sb.append(e.getMessage());
    sb.append("\n\n");
    throw new ScriptingException(sb.toString(),e);
  }
 finally {
    Context.exit();
  }
}
