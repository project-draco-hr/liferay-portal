{
  Element element=parentElement.addElement(elName);
  Map<String,List<String>> resourceRoles=RoleLocalServiceUtil.getResourceRoles(companyId,resourceName,scope,resourcePrimKey);
  for (  Map.Entry<String,List<String>> entry : resourceRoles.entrySet()) {
    String roleName=entry.getKey();
    if (!hasRole(roles,roleName)) {
      continue;
    }
    Element roleElement=element.addElement("role");
    roleElement.addAttribute("name",roleName);
    List<String> actions=entry.getValue();
    for (    String action : actions) {
      Element actionKeyElement=roleElement.addElement("action-key");
      actionKeyElement.addText(action);
      actionKeyElement.addAttribute("scope",String.valueOf(scope));
    }
  }
  return element;
}
