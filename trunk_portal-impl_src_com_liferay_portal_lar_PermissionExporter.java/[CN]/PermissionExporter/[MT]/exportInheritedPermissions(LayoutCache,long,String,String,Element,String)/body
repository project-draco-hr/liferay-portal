{
  Element entityPermissionsElement=SAXReaderUtil.createElement(entityName + "-permissions");
  Map<String,Long> entityMap=layoutCache.getEntityMap(companyId,entityName);
  for (  Map.Entry<String,Long> entry : entityMap.entrySet()) {
    String name=entry.getKey();
    long entityGroupId=entry.getValue();
    Element entityElement=exportGroupPermissions(companyId,entityGroupId,resourceName,resourcePrimKey,entityPermissionsElement,entityName + "-actions");
    if (entityElement.elements().isEmpty()) {
      entityPermissionsElement.remove(entityElement);
    }
 else {
      entityElement.addAttribute("name",name);
    }
  }
  if (!entityPermissionsElement.elements().isEmpty()) {
    parentElement.add(entityPermissionsElement);
  }
}
