{
  Indexer<?> indexer=_indexerRegistry.getIndexer(className);
  if (!indexer.isPermissionAware()) {
    return booleanFilter;
  }
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  User user=permissionChecker.getUser();
  if ((user == null) || (user.getUserId() != userId)) {
    user=_userLocalService.fetchUser(userId);
    if (user == null) {
      return booleanFilter;
    }
    permissionChecker=PermissionCheckerFactoryUtil.create(user);
  }
  if (permissionChecker.getUserBag() == null) {
    return booleanFilter;
  }
  if (permissionChecker.isCompanyAdmin(companyId)) {
    return booleanFilter;
  }
  Set<Role> roles=new HashSet<>();
  Map<Long,List<Role>> usersGroupIdsToRoles=new HashMap<>();
  populate(companyId,userId,permissionChecker,roles,usersGroupIdsToRoles);
  return doGetPermissionFilter_6(companyId,searchGroupIds,userId,permissionChecker,className,booleanFilter,roles,usersGroupIdsToRoles);
}
