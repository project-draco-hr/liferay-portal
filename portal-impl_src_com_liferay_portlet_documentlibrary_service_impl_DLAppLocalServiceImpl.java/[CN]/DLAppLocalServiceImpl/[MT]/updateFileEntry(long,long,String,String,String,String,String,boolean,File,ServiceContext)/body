{
  if ((file == null) || !file.exists() || (file.length() == 0)) {
    return updateFileEntry(userId,fileEntryId,sourceFileName,mimeType,title,description,changeLog,majorVersion,null,0,serviceContext);
  }
  mimeType=DLAppUtil.getMimeType(sourceFileName,mimeType,title,file,null);
  LocalRepository localRepository=getLocalRepository(0,fileEntryId,0);
  FileEntry fileEntry=localRepository.updateFileEntry(userId,fileEntryId,sourceFileName,mimeType,title,description,changeLog,majorVersion,file,serviceContext);
  DLProcessorRegistryUtil.cleanUp(fileEntry.getLatestFileVersion());
  dlAppHelperLocalService.updateFileEntry(userId,fileEntry,null,fileEntry.getFileVersion(),serviceContext);
  return fileEntry;
}
