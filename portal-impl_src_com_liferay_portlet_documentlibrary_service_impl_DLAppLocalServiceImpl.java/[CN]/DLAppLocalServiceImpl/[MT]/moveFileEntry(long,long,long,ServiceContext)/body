{
  SystemEventHierarchyEntryThreadLocal.push(FileEntry.class);
  try {
    LocalRepository fromLocalRepository=repositoryProvider.getFileEntryLocalRepository(fileEntryId);
    LocalRepository toLocalRepository=getFolderLocalRepository(newFolderId,serviceContext.getScopeGroupId());
    if (fromLocalRepository.getRepositoryId() == toLocalRepository.getRepositoryId()) {
      return fromLocalRepository.moveFileEntry(userId,fileEntryId,newFolderId,serviceContext);
    }
    return moveFileEntries(userId,fileEntryId,newFolderId,fromLocalRepository,toLocalRepository,serviceContext);
  }
  finally {
    SystemEventHierarchyEntryThreadLocal.pop(FileEntry.class);
  }
}
