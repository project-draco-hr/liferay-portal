{
  SystemEventHierarchyEntryThreadLocal.push(FileEntry.class);
  try {
    LocalRepository fromLocalRepository=getFileEntryLocalRepository(fileEntryId);
    LocalRepository toLocalRepository=getFolderLocalRepository(newFolderId,serviceContext.getScopeGroupId());
    if (fromLocalRepository.getRepositoryId() == toLocalRepository.getRepositoryId()) {
      FileEntry fileEntry=fromLocalRepository.moveFileEntry(userId,fileEntryId,newFolderId,serviceContext);
      return fileEntry;
    }
    return moveFileEntries(userId,fileEntryId,newFolderId,fromLocalRepository,toLocalRepository,serviceContext);
  }
  finally {
    SystemEventHierarchyEntryThreadLocal.pop(FileEntry.class);
  }
}
