{
  List<IGImage> srcImages=igImageService.getImages(srcFolder.getFolderId());
  for (  IGImage srcImage : srcImages) {
    String name=srcImage.getName();
    String description=srcImage.getDescription();
    File file=null;
    try {
      file=FileUtil.createTempFile(srcImage.getImageType());
      Image image=ImageLocalUtil.getImage(srcImage.getLargeImageId());
      byte[] byteArray=image.getTextObj();
      FileUtil.write(file,byteArray);
    }
 catch (    Exception e) {
      _log.error(e,e);
      continue;
    }
    String contentType=ContentTypeUtil.getContentType(srcImage.getImageType());
    String[] tagsEntries=null;
    igImageService.addImage(destFolder.getFolderId(),name,description,file,contentType,tagsEntries,addCommunityPermissions,addGuestPermissions);
    file.delete();
  }
  long destPlid=layoutLocalService.getDefaultPlid(destFolder.getGroupId());
  List<IGFolder> srcSubfolders=getFolders(srcFolder.getGroupId(),srcFolder.getFolderId());
  for (  IGFolder srcSubfolder : srcSubfolders) {
    String name=srcSubfolder.getName();
    String description=srcSubfolder.getDescription();
    IGFolder destSubfolder=addFolder(destPlid,destFolder.getFolderId(),name,description,addCommunityPermissions,addGuestPermissions);
    copyFolder(srcSubfolder,destSubfolder,addCommunityPermissions,addGuestPermissions);
  }
}
