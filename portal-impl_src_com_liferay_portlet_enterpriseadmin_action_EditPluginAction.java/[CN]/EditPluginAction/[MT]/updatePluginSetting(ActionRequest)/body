{
  long companyId=PortalUtil.getCompanyId(req);
  String pluginId=ParamUtil.getString(req,"pluginId");
  String pluginType=ParamUtil.getString(req,"pluginType");
  String[] rolesArray=StringUtil.split(ParamUtil.getString(req,"roles"),"\n");
  Arrays.sort(rolesArray);
  String roles=StringUtil.merge(rolesArray);
  boolean active=ParamUtil.getBoolean(req,"active");
  if (pluginType.equals(Plugin.TYPE_PORTLET)) {
    String portletId=pluginId;
    PortletServiceUtil.updatePortlet(companyId,portletId,roles,active);
  }
 else {
    PluginSettingServiceUtil.updatePluginSetting(companyId,pluginId,pluginType,roles,active);
  }
}
