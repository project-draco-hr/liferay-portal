{
  StringReader sr=new StringReader("abcdefghi");
  UnsyncBufferedReader ubr=new UnsyncBufferedReader(sr,5);
  assertEquals(5,ubr.buffer.length);
  assertTrue(sr.ready());
  assertTrue(ubr.ready());
  assertEquals('a',ubr.read());
  assertEquals(1,ubr.index);
  assertEquals(5,ubr.firstInvalidIndex);
  char[] buffer=new char[3];
  int number=ubr.read(buffer);
  assertEquals(buffer.length,number);
  assertEquals('b',buffer[0]);
  assertEquals('c',buffer[1]);
  assertEquals('d',buffer[2]);
  assertEquals(4,ubr.index);
  assertEquals(5,ubr.firstInvalidIndex);
  assertEquals('e',ubr.read());
  assertEquals(5,ubr.index);
  assertEquals(5,ubr.firstInvalidIndex);
  number=ubr.read(buffer);
  assertEquals(buffer.length,number);
  assertEquals('f',buffer[0]);
  assertEquals('g',buffer[1]);
  assertEquals('h',buffer[2]);
  assertEquals(3,ubr.index);
  assertEquals(4,ubr.firstInvalidIndex);
  number=ubr.read(buffer);
  assertEquals(1,number);
  assertEquals('i',buffer[0]);
  assertEquals(-1,ubr.read(buffer));
}
