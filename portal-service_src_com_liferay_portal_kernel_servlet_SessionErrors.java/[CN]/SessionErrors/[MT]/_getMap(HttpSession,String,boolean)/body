{
  if (session == null) {
    return null;
  }
  String key=_CLASS_NAME;
  if (portletKey != null) {
    key=portletKey.concat(_CLASS_NAME);
  }
  try {
    Map<String,Object> map=(Map<String,Object>)session.getAttribute(key);
    if ((map == null) && createIfAbsent) {
      map=new LinkedHashMap<>();
      session.setAttribute(key,map);
    }
    return map;
  }
 catch (  IllegalStateException ise) {
    return null;
  }
}
