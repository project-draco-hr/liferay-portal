{
  ServletContext servletContext=hotDeployEvent.getServletContext();
  String servletContextName=servletContext.getServletContextName();
  if (_log.isDebugEnabled()) {
    _log.debug("Invoking undeploy for " + servletContextName);
  }
  PluginPackage pluginPackage=PluginPackageUtil.readPluginPackageServletContext(servletContext);
  if (pluginPackage == null) {
    return;
  }
  hotDeployEvent.setPluginPackage(pluginPackage);
  PluginPackageUtil.unregisterInstalledPluginPackage(pluginPackage);
  ServletContextPool.remove(servletContextName);
  destroyServiceComponent(new ServletServiceContextComponentConfiguration(servletContext),servletContext.getClassLoader());
  unregisterClpMessageListeners(servletContext);
  ServiceRegistrar<PortalCacheConfiguratorSettings> serviceRegistrar=(ServiceRegistrar<PortalCacheConfiguratorSettings>)servletContext.getAttribute(_PORTAL_CACHE_CONFIGURATOR_SETTINGS_SERVICE_REGISTAR);
  if (serviceRegistrar != null) {
    serviceRegistrar.destroy();
  }
  if (_log.isInfoEnabled()) {
    _log.info("Plugin package " + pluginPackage.getModuleId() + " unregistered successfully");
  }
}
