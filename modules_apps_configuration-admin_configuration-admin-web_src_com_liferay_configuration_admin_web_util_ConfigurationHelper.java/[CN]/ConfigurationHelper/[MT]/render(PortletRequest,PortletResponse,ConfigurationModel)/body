{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  DDMForm ddmForm=ConfigurationConverter.convert(configurationModel,configurationModel.getConfiguration(),themeDisplay.getLocale());
  DDMFormFieldRenderingContext ddmFormFieldRenderingContext=new DDMFormFieldRenderingContext();
  ddmFormFieldRenderingContext.setHttpServletRequest(PortalUtil.getHttpServletRequest(portletRequest));
  ddmFormFieldRenderingContext.setHttpServletResponse(PortalUtil.getHttpServletResponse(portletResponse));
  ddmFormFieldRenderingContext.setLocale(themeDisplay.getLocale());
  ddmFormFieldRenderingContext.setPortletNamespace(portletResponse.getNamespace());
  ddmFormFieldRenderingContext.setReadOnly(false);
  String configFieldJSON=DDMFormJSONSerializerUtil.serialize(ddmForm);
  if (_log.isDebugEnabled()) {
    _log.debug("DDMForm: " + configFieldJSON);
  }
  portletRequest.setAttribute("configFieldJSON",configFieldJSON);
  portletRequest.setAttribute("scopeGroupId",themeDisplay.getScopeGroupId());
  portletRequest.setAttribute("plId",themeDisplay.getPlid());
  return DDMFormRendererUtil.render(ddmForm,ddmFormFieldRenderingContext);
}
