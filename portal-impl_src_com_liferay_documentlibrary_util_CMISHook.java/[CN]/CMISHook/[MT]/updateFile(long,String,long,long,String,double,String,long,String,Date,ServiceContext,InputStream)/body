{
  String versionString=Double.toString(versionNumber);
  Entry versioningFolder=getVersioningFolder(companyId,repositoryId,fileName);
  Link link=versioningFolder.getLink(_constants.LINK_DESCENDANTS);
  String descendantsUrl=link.getHref().toString();
  Entry fileEntry=CMISUtil.getEntry(descendantsUrl,versionString,_constants.BASE_TYPE_DOCUMENT);
  if (fileEntry != null) {
    throw new DuplicateFileException();
  }
  fileEntry=CMISUtil.createDocument(descendantsUrl,versionString,is);
  if (sourceFileName == null) {
    Indexer.addFile(companyId,portletId,groupId,repositoryId,fileName,fileEntryId,properties,modifiedDate,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames());
  }
 else {
    Indexer.updateFile(companyId,portletId,groupId,repositoryId,fileName,fileEntryId,properties,modifiedDate,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames());
  }
}
