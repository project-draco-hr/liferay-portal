{
  name=name.trim().toLowerCase();
  validate(name);
  TagsEntry entry=tagsEntryPersistence.findByPrimaryKey(entryId);
  if (!entry.getName().equals(name)) {
    if (hasEntry(entry.getCompanyId(),name)) {
      throw new DuplicateEntryException();
    }
  }
  entry.setModifiedDate(new Date());
  entry.setName(name);
  if (Validator.isNotNull(vocabularyName)) {
    TagsVocabulary vocabulary=tagsVocabularyLocalService.getVocabulary(entry.getCompanyId(),vocabularyName);
    entry.setVocabularyId(vocabulary.getVocabularyId());
  }
 else {
    entry.setParentEntryId(TagsEntryConstants.DEFAULT_VOCABULARY_ID);
  }
  if (Validator.isNotNull(parentEntryName)) {
    TagsEntry parent=getEntry(entry.getCompanyId(),parentEntryName);
    entry.setParentEntryId(parent.getEntryId());
  }
 else {
    entry.setParentEntryId(TagsEntryConstants.DEFAULT_PARENT_ENTRY_ID);
  }
  tagsEntryPersistence.update(entry,false);
  return entry;
}
