{
  virtualHostname=StringUtil.toLowerCase(virtualHostname.trim());
  if (Validator.isNotNull(virtualHostname) && !Validator.isDomain(virtualHostname)) {
    throw new LayoutSetVirtualHostException();
  }
  LayoutSet layoutSet=layoutSetPersistence.findByG_P(groupId,privateLayout);
  if (Validator.isNotNull(virtualHostname)) {
    VirtualHost virtualHost=virtualHostPersistence.fetchByHostname(virtualHostname);
    if (virtualHost == null) {
      virtualHostLocalService.updateVirtualHost(layoutSet.getCompanyId(),layoutSet.getLayoutSetId(),virtualHostname);
    }
 else {
      if ((virtualHost.getCompanyId() != layoutSet.getCompanyId()) || (virtualHost.getLayoutSetId() != layoutSet.getLayoutSetId())) {
        throw new LayoutSetVirtualHostException();
      }
    }
  }
 else {
    try {
      virtualHostPersistence.removeByC_L(layoutSet.getCompanyId(),layoutSet.getLayoutSetId());
    }
 catch (    NoSuchVirtualHostException nsvhe) {
    }
  }
  return layoutSet;
}
