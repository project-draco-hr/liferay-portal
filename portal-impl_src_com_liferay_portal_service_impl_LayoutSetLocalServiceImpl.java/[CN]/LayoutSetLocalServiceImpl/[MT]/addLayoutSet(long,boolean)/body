{
  Group group=groupPersistence.findByPrimaryKey(groupId);
  long layoutSetId=counterLocalService.increment();
  LayoutSet layoutSet=layoutSetPersistence.create(layoutSetId);
  layoutSet.setGroupId(groupId);
  layoutSet.setCompanyId(group.getCompanyId());
  layoutSet.setPrivateLayout(privateLayout);
  if (group.isStagingGroup()) {
    LayoutSet liveLayoutSet=null;
    Group liveGroup=group.getLiveGroup();
    if (privateLayout) {
      liveLayoutSet=liveGroup.getPrivateLayoutSet();
    }
 else {
      liveLayoutSet=liveGroup.getPublicLayoutSet();
    }
    layoutSet.setLogo(liveLayoutSet.getLogo());
    layoutSet.setLogoId(liveLayoutSet.getLogoId());
    layoutSet.setThemeId(liveLayoutSet.getThemeId());
    layoutSet.setColorSchemeId(liveLayoutSet.getColorSchemeId());
    layoutSet.setWapThemeId(liveLayoutSet.getWapThemeId());
    layoutSet.setWapColorSchemeId(liveLayoutSet.getWapColorSchemeId());
    layoutSet.setCss(liveLayoutSet.getCss());
  }
 else {
    layoutSet.setThemeId(ThemeImpl.getDefaultRegularThemeId(group.getCompanyId()));
    layoutSet.setColorSchemeId(ColorSchemeImpl.getDefaultRegularColorSchemeId());
    layoutSet.setWapThemeId(ThemeImpl.getDefaultWapThemeId(group.getCompanyId()));
    layoutSet.setWapColorSchemeId(ColorSchemeImpl.getDefaultWapColorSchemeId());
    layoutSet.setCss(StringPool.BLANK);
  }
  layoutSetPersistence.update(layoutSet,false);
  return layoutSet;
}
