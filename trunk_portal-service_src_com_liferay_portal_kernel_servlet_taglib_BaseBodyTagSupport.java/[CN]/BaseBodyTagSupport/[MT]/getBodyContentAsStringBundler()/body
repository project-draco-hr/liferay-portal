{
  if (!(this instanceof BodyTag)) {
    throw new RuntimeException(getClass().getName() + " must implement " + BodyTag.class.getName());
  }
  BodyContent bodyContent=getBodyContent();
  if (bodyContent instanceof BodyContentWrapper) {
    BodyContentWrapper bodyContentWrapper=(BodyContentWrapper)bodyContent;
    return bodyContentWrapper.getStringBundler();
  }
 else {
    if (ServerDetector.isTomcat() && _log.isWarnEnabled()) {
      _log.warn("BodyContent is not BodyContentWrapper. Check " + "JspFactorySwapper.");
    }
    String bodyContentString=bodyContent.getString();
    if (bodyContentString == null) {
      bodyContentString=StringPool.BLANK;
    }
    return new StringBundler(bodyContentString);
  }
}
