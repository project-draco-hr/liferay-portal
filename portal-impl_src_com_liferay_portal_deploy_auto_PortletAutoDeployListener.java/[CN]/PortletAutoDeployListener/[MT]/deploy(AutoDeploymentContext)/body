{
  File file=autoDeploymentContext.getFile();
  PluginAutoDeployListenerHelper pluginAutoDeployListenerHelper=new PluginAutoDeployListenerHelper(file);
  if (_log.isDebugEnabled()) {
    _log.debug("Invoking deploy for " + file.getPath());
  }
  AutoDeployer autoDeployer=null;
  if (pluginAutoDeployListenerHelper.isMatchingFile("WEB-INF/" + Portal.PORTLET_XML_FILE_NAME_STANDARD)) {
    autoDeployer=_autoDeployer;
  }
 else   if (pluginAutoDeployListenerHelper.isMatchingFile("index_mvc.jsp")) {
    autoDeployer=getMvcDeployer();
  }
 else   if (pluginAutoDeployListenerHelper.isMatchingFile("index.php")) {
    autoDeployer=getPhpDeployer();
  }
 else   if (!pluginAutoDeployListenerHelper.isExtPlugin() && !pluginAutoDeployListenerHelper.isHookPlugin() && !pluginAutoDeployListenerHelper.isMatchingFile("WEB-INF/liferay-layout-templates.xml")&& !pluginAutoDeployListenerHelper.isThemePlugin()&& !pluginAutoDeployListenerHelper.isWebPlugin()&& file.getName().endsWith(".war")) {
    if (_log.isInfoEnabled()) {
      _log.info("Deploying package as a web application");
    }
    autoDeployer=getWaiDeployer();
  }
 else {
    return AutoDeployer.CODE_NOT_APPLICABLE;
  }
  if (_log.isInfoEnabled()) {
    _log.info("Copying portlets for " + file.getPath());
  }
  if (_log.isDebugEnabled()) {
    Class<?> clazz=autoDeployer.getClass();
    _log.debug("Using deployer " + clazz.getName());
  }
  autoDeployer=new ThreadSafeAutoDeployer(autoDeployer);
  int code=autoDeployer.autoDeploy(autoDeploymentContext);
  if ((code == AutoDeployer.CODE_DEFAULT) && _log.isInfoEnabled()) {
    _log.info("Portlets for " + file.getPath() + " copied successfully. "+ "Deployment will start in a few seconds.");
  }
  return code;
}
