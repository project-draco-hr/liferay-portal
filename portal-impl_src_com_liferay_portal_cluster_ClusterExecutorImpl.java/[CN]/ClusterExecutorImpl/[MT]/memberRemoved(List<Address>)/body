{
  List<ClusterNode> departingClusterNodes=new ArrayList<ClusterNode>();
  for (  Address address : departAddresses) {
    ClusterNode clusterNode=getClusterNode(address);
    if (clusterNode == null) {
      continue;
    }
    departingClusterNodes.add(clusterNode);
    _writeLock.lock();
    try {
      if (_clusterNodeIdMap.containsValue(address)) {
        String clusterNodeId=clusterNode.getClusterNodeId();
        _clusterNodeIdMap.remove(clusterNodeId);
        _addressMap.remove(address);
      }
 else {
        _log.error("Information of nodes in cluster is wrong!");
        continue;
      }
    }
  finally {
      _writeLock.unlock();
    }
  }
  if (departingClusterNodes.isEmpty()) {
    return;
  }
  ClusterEvent clusterEvent=ClusterEvent.depart(departingClusterNodes);
  fireClusterEvent(clusterEvent);
}
