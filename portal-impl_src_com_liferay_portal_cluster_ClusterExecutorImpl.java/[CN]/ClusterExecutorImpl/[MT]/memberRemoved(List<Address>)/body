{
  List<ClusterNode> departingClusterNodes=new ArrayList<ClusterNode>();
  for (  Address departAddress : departAddresses) {
    ClusterNode clusterNode=getClusterNode(departAddress);
    if (clusterNode == null) {
      continue;
    }
    departingClusterNodes.add(clusterNode);
    _writeLock.lock();
    try {
      if (_clusterNodeIdMap.containsValue(departAddress)) {
        String clusterNodeId=clusterNode.getClusterNodeId();
        _clusterNodeIdMap.remove(clusterNodeId);
        _addressMap.remove(departAddress);
      }
 else {
        _log.error("Unable to remove address " + departAddress + " from cluster node "+ clusterNode);
        continue;
      }
    }
  finally {
      _writeLock.unlock();
    }
  }
  if (departingClusterNodes.isEmpty()) {
    return;
  }
  ClusterEvent clusterEvent=ClusterEvent.depart(departingClusterNodes);
  fireClusterEvent(clusterEvent);
}
