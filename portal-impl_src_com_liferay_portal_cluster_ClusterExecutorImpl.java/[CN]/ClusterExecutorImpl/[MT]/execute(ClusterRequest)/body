{
  if (!isEnabled()) {
    return null;
  }
  List<Address> addresses=prepareAddresses(clusterRequest);
  Set<String> clusterNodeIds=new HashSet<>();
  for (  Address address : addresses) {
    ClusterNode clusterNode=_liveInstances.get(address);
    clusterNodeIds.add(clusterNode.getClusterNodeId());
  }
  FutureClusterResponses futureClusterResponses=new FutureClusterResponses(clusterNodeIds);
  if (!clusterRequest.isFireAndForget()) {
    String uuid=clusterRequest.getUuid();
    _futureClusterResponses.put(uuid,futureClusterResponses);
  }
  if (addresses.remove(getLocalClusterNodeAddress())) {
    runLocalMethod(clusterRequest,futureClusterResponses);
  }
  if (clusterRequest.isMulticast()) {
    try {
      _controlJChannel.send(null,clusterRequest);
    }
 catch (    Exception e) {
      throw new SystemException("Unable to send multicast request",e);
    }
  }
 else {
    for (    Address address : addresses) {
      org.jgroups.Address jGroupsAddress=(org.jgroups.Address)address.getRealAddress();
      try {
        _controlJChannel.send(jGroupsAddress,clusterRequest);
      }
 catch (      Exception e) {
        throw new SystemException("Unable to send unicast request",e);
      }
    }
  }
  return futureClusterResponses;
}
