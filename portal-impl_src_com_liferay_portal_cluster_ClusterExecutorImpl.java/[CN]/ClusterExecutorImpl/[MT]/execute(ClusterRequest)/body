{
  if (!isEnabled()) {
    return null;
  }
  List<Address> addresses=prepareAddresses(clusterRequest);
  Set<String> clusterNodeIds=new HashSet<>();
  for (  Address address : addresses) {
    ClusterNode clusterNode=_liveInstances.get(address);
    if (clusterNode != null) {
      clusterNodeIds.add(clusterNode.getClusterNodeId());
    }
  }
  FutureClusterResponses futureClusterResponses=new FutureClusterResponses(clusterNodeIds);
  if (!clusterRequest.isFireAndForget()) {
    String uuid=clusterRequest.getUuid();
    _futureClusterResponses.put(uuid,futureClusterResponses);
  }
  if (addresses.remove(_localAddress)) {
    ClusterNodeResponse clusterNodeResponse=executeClusterRequest(clusterRequest);
    if (!clusterRequest.isFireAndForget()) {
      futureClusterResponses.addClusterNodeResponse(clusterNodeResponse);
    }
  }
  if (clusterRequest.isMulticast()) {
    _clusterChannel.sendMulticastMessage(clusterRequest);
  }
 else {
    for (    Address address : addresses) {
      _clusterChannel.sendUnicastMessage(clusterRequest,address);
    }
  }
  return futureClusterResponses;
}
