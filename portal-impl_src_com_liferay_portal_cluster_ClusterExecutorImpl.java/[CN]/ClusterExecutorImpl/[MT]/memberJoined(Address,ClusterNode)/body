{
  _writeLock.lock();
  try {
    boolean hasClusterNode=_clusterNodeIdMap.containsValue(joinAddress);
    boolean hasAddress=_addressMap.containsKey(joinAddress);
    if (hasClusterNode && hasAddress) {
      _addressMap.remove(joinAddress);
      _addressMap.put(joinAddress,clusterNode);
    }
 else     if (!hasClusterNode && !hasAddress) {
      _addressMap.put(joinAddress,clusterNode);
      String clusterNodeId=clusterNode.getClusterNodeId();
      _clusterNodeIdMap.put(clusterNodeId,joinAddress);
      if (getLocalControlAddress().equals(joinAddress)) {
        return;
      }
      ClusterEvent clusterEvent=ClusterEvent.join(clusterNode);
      fireClusterEvent(clusterEvent);
    }
 else {
      _log.error("Information of nodes in cluster is wrong!");
    }
  }
  finally {
    _writeLock.unlock();
  }
}
