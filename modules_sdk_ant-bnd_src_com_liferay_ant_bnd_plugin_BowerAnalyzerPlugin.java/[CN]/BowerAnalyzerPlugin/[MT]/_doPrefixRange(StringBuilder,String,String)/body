{
  Matcher matcher=VERSION_NAMED_PATTERN.matcher(version);
  matcher.matches();
  String major=matcher.group("major");
  String minor=matcher.group("minor");
  String micro=matcher.group("micro");
  String qualifier=matcher.group("qualifier");
  if (prefix.equals("v") || prefix.equals("=")) {
    sb.append("(version=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")");
  }
 else   if (prefix.equals("<")) {
    sb.append("(!(version>=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append("))");
  }
 else   if (prefix.equals("<=")) {
    sb.append("(version<=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")");
  }
 else   if (prefix.equals(">")) {
    sb.append("(&(version>=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")(!(version=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")))");
  }
 else   if (prefix.equals(">=")) {
    sb.append("(version>=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")");
  }
 else   if (prefix.equals("~")) {
    sb.append("(&(version>=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")(!(version>=");
    if (minor != null) {
      int value=Integer.parseInt(minor);
      sb.append(major);
      sb.append(".");
      sb.append(value + 1);
      sb.append(".0");
    }
 else {
      int value=Integer.parseInt(major);
      sb.append(value + 1);
      sb.append(".0.0");
    }
    sb.append(")))");
  }
 else   if (prefix.equals("^")) {
    sb.append("(&(version>=");
    sb.append(_versionString(major,minor,micro,qualifier));
    sb.append(")(!(version>=");
    if (!"0".equals(major) || "x".equalsIgnoreCase(minor) || "*".equals(minor)) {
      int value=Integer.parseInt(major);
      sb.append(value + 1);
      sb.append(".0.0");
    }
 else     if (!"0".equals(minor) || "x".equalsIgnoreCase(micro) || "*".equals(micro)|| (micro == null)) {
      int value=Integer.parseInt(_deSugar(minor));
      sb.append("0.");
      sb.append(value + 1);
      sb.append(".0");
    }
 else {
      int value=Integer.parseInt(_deSugar(micro));
      sb.append("0.0.");
      sb.append(value + 1);
    }
    sb.append(")))");
  }
}
