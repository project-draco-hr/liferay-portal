{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  Group group=GroupLocalServiceUtil.getGroup(themeDisplay.getPortletGroupId());
  User user=themeDisplay.getUser();
  if (group.isUser()) {
    user=UserLocalServiceUtil.getUserById(group.getClassPK());
  }
  if (!UserPermissionUtil.contains(themeDisplay.getPermissionChecker(),user.getUserId(),ActionKeys.UPDATE)) {
    req.setAttribute(WebKeys.PORTLET_DECORATE,Boolean.FALSE);
  }
 else {
    List<SocialRequest> requests=SocialRequestLocalServiceUtil.getReceiverUserRequests(user.getUserId(),SocialRequestConstants.STATUS_PENDING,0,100);
    if (requests.size() == 0) {
      req.setAttribute(WebKeys.PORTLET_DECORATE,Boolean.FALSE);
    }
 else {
      req.setAttribute(WebKeys.SOCIAL_REQUESTS,requests);
    }
  }
  return mapping.findForward("portlet.requests.view");
}
