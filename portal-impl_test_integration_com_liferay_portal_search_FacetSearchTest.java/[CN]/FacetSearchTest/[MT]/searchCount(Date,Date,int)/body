{
  SearchContext searchContext=new SearchContext();
  searchContext.setAttribute("entryClassName",User.class.getName());
  if (startDate != null && endDate != null) {
    searchContext.setAttribute("modified","[" + _dateFormat.format(startDate) + " TO "+ _dateFormat.format(endDate)+ "]");
  }
  searchContext.setCompanyId(TestPropsValues.getCompanyId());
  searchContext.setEnd(QueryUtil.ALL_POS);
  searchContext.setKeywords(_randomLastName);
  searchContext.setStart(QueryUtil.ALL_POS);
  Facet assetEntriesFacet=new AssetEntriesFacet(searchContext);
  assetEntriesFacet.setStatic(true);
  searchContext.addFacet(assetEntriesFacet);
  Facet scopeFacet=new ScopeFacet(searchContext);
  scopeFacet.setStatic(true);
  searchContext.addFacet(scopeFacet);
  List<FacetConfiguration> facetConfigurations=FacetConfigurationUtil.load(_FACET_CONFIGURATIONS);
  for (  FacetConfiguration facetConfiguration : facetConfigurations) {
    Facet facet=FacetFactoryUtil.create(searchContext,facetConfiguration);
    if (facet == null) {
      continue;
    }
    searchContext.addFacet(facet);
  }
  Indexer indexer=FacetedSearcher.getInstance();
  Hits hits=indexer.search(searchContext);
  if (expectedCount > 0) {
    Assert.assertEquals(expectedCount,hits.getLength());
  }
  return hits.getLength();
}
