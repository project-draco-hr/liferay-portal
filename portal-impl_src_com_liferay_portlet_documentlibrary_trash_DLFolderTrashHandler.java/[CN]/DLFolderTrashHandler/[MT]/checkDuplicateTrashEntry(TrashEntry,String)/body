{
  DLFolder dlFolder=getDLFolder(trashEntry.getClassPK());
  String restoredTitle=dlFolder.getName();
  if (Validator.isNotNull(newName)) {
    restoredTitle=newName;
  }
  String originalTitle=TrashUtil.stripTrashNamespace(restoredTitle);
  DLFolder duplicatedFolder=DLFolderLocalServiceUtil.fetchFolder(dlFolder.getGroupId(),dlFolder.getParentFolderId(),originalTitle);
  if (duplicatedFolder != null) {
    DuplicateEntryException dee=new DuplicateEntryException();
    dee.setDuplicateEntryId(duplicatedFolder.getFolderId());
    dee.setOldName(duplicatedFolder.getName());
    dee.setTrashEntryId(trashEntry.getEntryId());
    throw dee;
  }
}
