{
  if (!_fileEntryDisplayContextHelper.isPermissionsButtonVisible()) {
    return;
  }
  String permissionsURL=null;
  try {
    permissionsURL=PermissionsURLTag.doTag(null,DLFileEntryConstants.getClassName(),HtmlUtil.unescape(fileEntry.getTitle()),null,String.valueOf(fileEntry.getFileEntryId()),LiferayWindowState.POP_UP.toString(),null,request);
  }
 catch (  Exception e) {
    throw new SystemException("Unable to create permissions URL",e);
  }
  StringBundler sb=new StringBundler(6);
  sb.append("Liferay.Util.openWindow({");
  sb.append("title: '");
  sb.append(UnicodeLanguageUtil.get(request,"permissions"));
  sb.append("', uri: '");
  sb.append(permissionsURL);
  sb.append("'});");
  _addJavascriptUIItem(new JavascriptToolbarItem(),toolbarItems,"icon-lock",DLUIItemKeys.PERMISSIONS,UnicodeLanguageUtil.get(request,"permissions"),sb.toString());
}
