{
  FileCollection classPath=buildServiceTask.getClasspath();
  if (!classPath.isEmpty()) {
    return;
  }
  List<Object> classPaths=new ArrayList<>();
  Project project=buildServiceTask.getProject();
  classPaths.add(GradleUtil.getConfiguration(project,CONFIGURATION_NAME));
  TaskContainer taskContainer=project.getTasks();
  AbstractCompile compileJavaTask=(AbstractCompile)taskContainer.findByName(JavaPlugin.COMPILE_JAVA_TASK_NAME);
  if (compileJavaTask != null) {
    classPaths.add(compileJavaTask.getDestinationDir());
  }
  Copy processResourcesTask=(Copy)taskContainer.findByName(JavaPlugin.PROCESS_RESOURCES_TASK_NAME);
  if (processResourcesTask != null) {
    classPaths.add(processResourcesTask.getDestinationDir());
  }
  ConfigurationContainer configurationContainer=project.getConfigurations();
  Configuration configuration=configurationContainer.findByName(JavaPlugin.COMPILE_CONFIGURATION_NAME);
  if (configuration != null) {
    classPaths.add(configuration);
  }
  classPath=project.files(classPaths.toArray());
  buildServiceTask.setClasspath(classPath);
}
