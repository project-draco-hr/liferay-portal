{
  Class<?> clazz=destination.getClass();
  if (SPIUtil.isSPI() && !clazz.equals(IntrabandBridgeDestination.class)) {
    destination=new IntrabandBridgeDestination(destination);
  }
  _destinations.put(destination.getName(),destination);
  for (  MessageBusEventListener messageBusEventListener : _messageBusEventListeners) {
    messageBusEventListener.destinationAdded(destination);
  }
  List<MessageListener> messageListeners=_queuedMessageListeners.remove(destination.getName());
  if (ListUtil.isEmpty(messageListeners)) {
    return;
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Registering " + messageListeners.size() + " queued message listeners for destination "+ destination.getName());
  }
  for (  MessageListener messageListener : messageListeners) {
    destination.register(messageListener);
  }
}
