{
  Element foldersElement=document.createElement("Folders");
  rootNode.appendChild(foldersElement);
  if (commandArgument.getCurrentFolder().equals(StringPool.SLASH)) {
    getRootFolders(commandArgument,document,foldersElement);
  }
 else {
    Group group=commandArgument.getCurrentGroup();
    List<Layout> layouts=new ArrayList<Layout>();
    layouts.addAll(LayoutServiceUtil.getLayouts(group.getGroupId(),false,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID));
    layouts.addAll(LayoutServiceUtil.getLayouts(group.getGroupId(),true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID));
    if (("/" + commandArgument.getCurrentGroupName() + "/").equals(commandArgument.getCurrentFolder())) {
      for (      Layout layout : layouts) {
        Element folderElement=document.createElement("Folder");
        foldersElement.appendChild(folderElement);
        folderElement.setAttribute("name","~" + _getLayoutName(layout).replace('/','>'));
      }
    }
 else {
      String layoutName=_getLayoutName(commandArgument.getCurrentFolder());
      Layout layout=null;
      for (int i=0; i < layouts.size(); i++) {
        layout=_getLayout(layoutName,layouts.get(i));
        if (layout != null) {
          break;
        }
      }
      if (layout != null) {
        List<Layout> layoutChildren=layout.getChildren();
        for (int i=0; i < layoutChildren.size(); i++) {
          layout=layoutChildren.get(i);
          Element folderElement=document.createElement("Folder");
          foldersElement.appendChild(folderElement);
          folderElement.setAttribute("name","~" + _getLayoutName(layout).replace('/','>'));
        }
      }
    }
  }
}
