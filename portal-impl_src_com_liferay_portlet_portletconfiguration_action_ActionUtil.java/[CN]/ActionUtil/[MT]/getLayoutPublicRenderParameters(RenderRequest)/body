{
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Set<PublicRenderParameter> layoutPublicRenderParameters=new TreeSet<PublicRenderParameter>(new PublicRenderParameterIdentifierComparator());
  Set<String> prpIdendifiersInLayout=new HashSet<String>();
  LayoutTypePortlet layoutTypePortlet=themeDisplay.getLayoutTypePortlet();
  List<Portlet> layoutPortlets=layoutTypePortlet.getAllPortlets();
  for (  Portlet portletInLayout : layoutPortlets) {
    Set<PublicRenderParameter> publicRenderParameters=portletInLayout.getPublicRenderParameters();
    for (    PublicRenderParameter publicRenderParameter : publicRenderParameters) {
      if (!prpIdendifiersInLayout.contains(publicRenderParameter.getIdentifier())) {
        prpIdendifiersInLayout.add(publicRenderParameter.getIdentifier());
        layoutPublicRenderParameters.add(publicRenderParameter);
      }
    }
  }
  renderRequest.setAttribute(WebKeys.LAYOUT_PUBLIC_RENDER_PARAMETERS,layoutPublicRenderParameters);
}
