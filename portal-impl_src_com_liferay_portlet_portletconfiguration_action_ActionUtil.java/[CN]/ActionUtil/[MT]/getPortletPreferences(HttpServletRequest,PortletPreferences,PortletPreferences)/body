{
  String portletResource=ParamUtil.getString(request,"portletResource");
  if (Validator.isNull(portletResource)) {
    return portletConfigPreferences;
  }
  if (portletPreferences != null) {
    return portletPreferences;
  }
  return PortletPreferencesFactoryUtil.getPortletSetup(request,portletResource);
}
