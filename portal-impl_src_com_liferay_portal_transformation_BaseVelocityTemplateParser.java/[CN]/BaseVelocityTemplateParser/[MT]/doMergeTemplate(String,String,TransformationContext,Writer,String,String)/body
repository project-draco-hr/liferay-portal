{
  VelocityContext velocityContext=(VelocityContext)context;
  boolean load=false;
  try {
    load=VelocityEngineUtil.mergeTemplate(templateId,script,velocityContext,writer);
  }
 catch (  Exception e) {
    if (Validator.isNotNull(errorTemplateId) && Validator.isNotNull(errorTemplateContent)) {
      velocityContext.put("exception",e.getMessage());
      velocityContext.put("script",script);
      if (e instanceof ParseErrorException) {
        ParseErrorException pe=(ParseErrorException)e;
        velocityContext.put("column",new Integer(pe.getColumnNumber()));
        velocityContext.put("line",new Integer(pe.getLineNumber()));
      }
      load=VelocityEngineUtil.mergeTemplate(errorTemplateId,errorTemplateContent,velocityContext,writer);
    }
 else {
      throw e;
    }
  }
  return load;
}
