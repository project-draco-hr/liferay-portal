{
  String portletId=PortletKeys.WIKI;
  WikiPage page=WikiPageLocalServiceUtil.getLatestPage(classPK,WorkflowConstants.STATUS_ANY,false);
  long plid=PortalUtil.getPlidFromPortletId(page.getGroupId(),PortletKeys.WIKI);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    portletId=PortletKeys.WIKI_ADMIN;
    plid=PortalUtil.getControlPanelPlid(portletRequest);
  }
  PortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,portletId,plid,PortletRequest.RENDER_PHASE);
  WikiNode node=page.getNode();
  if (portletId.equals(PortletKeys.WIKI)) {
    portletURL.setParameter("struts_action","/wiki/view_all_pages");
  }
 else {
    portletURL.setParameter("struts_action","/wiki_admin/view_all_pages");
  }
  portletURL.setParameter("nodeId",String.valueOf(node.getNodeId()));
  return portletURL.toString();
}
