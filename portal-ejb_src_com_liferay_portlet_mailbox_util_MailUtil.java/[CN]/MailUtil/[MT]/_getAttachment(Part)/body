{
  MailAttachment ma=new MailAttachment();
  ma.setContentType(part.getContentType());
  ma.setFilename(part.getFileName());
  String[] headers=part.getHeader("Content-id");
  if (headers != null && headers.length > 0) {
    ma.setContentID(headers[0]);
  }
  InputStream in=part.getInputStream();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  byte[] buffer=new byte[8192];
  int count=0;
  while ((count=in.read(buffer)) >= 0) {
    baos.write(buffer,0,count);
  }
  in.close();
  ma.setContent(baos.toByteArray());
  return ma;
}
