{
  for (Iterator itr=getAllFolders(ses).iterator(); itr.hasNext(); ) {
    MailFolder mf=(MailFolder)itr.next();
    if (mf.getName().equals(folderName)) {
      throw new Exception("Folder " + folderName + " already exists");
    }
  }
  Store store=_getStore(ses);
  Folder folder=null;
  try {
    if (!folderName.equals(MAIL_INBOX_NAME) && !folderName.startsWith(MAIL_BOX_STYLE)) {
      folderName=MAIL_BOX_STYLE + folderName;
    }
    folder=store.getFolder(folderName);
    folder.create(Folder.HOLDS_MESSAGES);
  }
  finally {
    if (folder != null && folder.isOpen()) {
      folder.close(false);
    }
  }
}
