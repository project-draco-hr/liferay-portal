{
  int index=GetterUtil.getInteger(StringUtil.split(mimePath.substring(1),StringPool.PERIOD)[0]);
  if (part.getContent() instanceof Multipart) {
    String prefix=Integer.toString(index) + StringPool.PERIOD;
    Multipart mp=(Multipart)part.getContent();
    for (int i=0; i < mp.getCount(); i++) {
      if (index == i) {
        return _getAttachmentFromPath(mp.getBodyPart(i),mimePath.substring(prefix.length()));
      }
    }
    throw new Exception("Error in content path");
  }
 else   if (index != -1) {
    throw new Exception("Error in content path");
  }
  InputStream in=part.getInputStream();
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  byte[] buffer=new byte[8192];
  int count=0;
  while ((count=in.read(buffer)) >= 0) {
    baos.write(buffer,0,count);
  }
  in.close();
  Object[] parts=new Object[]{baos.toByteArray(),part.getContentType()};
  return parts;
}
