{
  if (!oldFolderName.equals(MAIL_INBOX_NAME) && !oldFolderName.startsWith(MAIL_BOX_STYLE)) {
    oldFolderName=MAIL_BOX_STYLE + oldFolderName;
  }
  if (!newFolderName.equals(MAIL_INBOX_NAME) && !newFolderName.startsWith(MAIL_BOX_STYLE)) {
    newFolderName=MAIL_BOX_STYLE + newFolderName;
  }
  for (int i=0; i < DEFAULT_FOLDERS.length; i++) {
    if (DEFAULT_FOLDERS[i].equals(oldFolderName)) {
      throw new Exception("The folder " + oldFolderName + " is a system-defined folder and cannot be changed");
    }
 else     if (DEFAULT_FOLDERS[i].equals(newFolderName)) {
      throw new Exception("The folder " + newFolderName + " is a system-defined folder and cannot be changed");
    }
  }
  Store store=_getStore(ses);
  Folder oldFolder=store.getFolder(oldFolderName);
  Folder newFolder=store.getFolder(newFolderName);
  if (!oldFolder.exists()) {
    throw new Exception("The folder " + oldFolderName + " does not exist in the system");
  }
 else   if (newFolder.exists()) {
    throw new Exception("The folder " + newFolderName + " already exists in the system");
  }
  if (!oldFolder.isOpen()) {
    oldFolder.open(Folder.READ_WRITE);
  }
  oldFolder.renameTo(newFolder);
  if (_getCurrentFolder(ses).getName().equals(oldFolderName)) {
    setCurrentFolder(ses,newFolderName);
  }
}
