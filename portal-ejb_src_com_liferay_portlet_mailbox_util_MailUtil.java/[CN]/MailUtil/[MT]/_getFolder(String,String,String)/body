{
  if (Validator.isNull(folderName)) {
    folderName=MAIL_INBOX_NAME;
  }
  IMAPFolder folder=(IMAPFolder)_folder.get(userId);
  if (folder != null) {
    if (!folder.getName().equals(folderName)) {
      _closeFolder(userId);
      _folder.remove(userId);
      folder=null;
    }
  }
  if (folder == null) {
    folder=(IMAPFolder)_getStore(userId,password).getFolder(folderName);
    folder.open(IMAPFolder.READ_WRITE);
    _folder.put(userId,folder);
  }
  return folder;
}
