{
  Layout layout=themeDisplay.getLayout();
  if (!layout.isTypeControlPanel()) {
    return layout;
  }
  Group scopeGroup=themeDisplay.getScopeGroup();
  if (scopeGroup.isLayout()) {
    layout=_layoutLocalService.getLayout(scopeGroup.getClassPK());
  }
 else   if (!scopeGroup.isCompany()) {
    long defaultPlid=_layoutLocalService.getDefaultPlid(themeDisplay.getSiteGroupId());
    if (defaultPlid > 0) {
      layout=_layoutLocalService.getLayout(defaultPlid);
    }
  }
  return layout;
}
