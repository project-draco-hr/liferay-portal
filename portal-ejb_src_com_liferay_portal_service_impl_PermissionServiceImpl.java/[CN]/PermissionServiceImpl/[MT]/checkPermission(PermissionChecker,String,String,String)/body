{
  if (name.equals(Group.class.getName())) {
    GroupPermission.check(permissionChecker,primKey,ActionKeys.PERMISSIONS);
  }
 else   if (name.equals(Layout.class.getName())) {
    String layoutGroupId=StringUtil.split(primKey,".")[1];
    layoutGroupId=StringUtil.replace(layoutGroupId,"}","");
    GroupPermission.check(permissionChecker,layoutGroupId,ActionKeys.MANAGE_LAYOUTS);
  }
 else   if (name.equals(User.class.getName())) {
    User user=UserLocalServiceUtil.getUserById(primKey);
    UserPermission.check(permissionChecker,primKey,user.getOrganization().getOrganizationId(),user.getLocation().getOrganizationId(),ActionKeys.PERMISSIONS);
  }
 else   if ((primKey != null) && (primKey.indexOf(Portlet.LAYOUT_SEPARATOR) > -1)) {
    if (!permissionChecker.hasPermission(groupId,name,primKey,ActionKeys.CONFIGURATION) && !GroupPermission.contains(permissionChecker,groupId,ActionKeys.MANAGE_LAYOUTS)) {
      throw new PrincipalException();
    }
  }
 else   if (!permissionChecker.hasPermission(groupId,name,primKey,ActionKeys.PERMISSIONS) && !permissionChecker.hasPermission(groupId,name,primKey,ActionKeys.ADD_PERMISSIONS)) {
    throw new PrincipalException();
  }
}
