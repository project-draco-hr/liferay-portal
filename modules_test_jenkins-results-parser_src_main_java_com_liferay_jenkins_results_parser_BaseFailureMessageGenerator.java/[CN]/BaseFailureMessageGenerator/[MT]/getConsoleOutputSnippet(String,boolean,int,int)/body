{
  if ((end - start) > 2500) {
    if (truncateTop) {
      start=end - 2500;
      start=consoleOutput.indexOf("\n",start);
    }
 else {
      end=start + 2500;
      end=consoleOutput.lastIndexOf("\n",end);
    }
  }
  consoleOutput=JenkinsResultsParserUtil.fixMarkdown(consoleOutput.substring(start,end));
  consoleOutput=consoleOutput.replaceFirst("^\\s*\\n","");
  consoleOutput=consoleOutput.replaceFirst("\\n\\s*$","");
  return "<pre><code>" + consoleOutput + "</code></pre>";
}
