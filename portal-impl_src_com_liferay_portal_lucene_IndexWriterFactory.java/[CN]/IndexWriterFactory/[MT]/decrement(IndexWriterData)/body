{
  if (writerData.getCount() > 0) {
    writerData.setCount(writerData.getCount() - 1);
    if (writerData.getCount() == 0) {
      _writerLookup.remove(new Long(writerData.getCompanyId()));
      try {
        IndexWriter writer=writerData.getWriter();
        try {
          writer.optimize();
        }
  finally {
          writer.close();
        }
      }
 catch (      Exception e) {
        _log.error(e,e);
      }
 finally {
        releaseLock(writerData.getCompanyId());
      }
    }
  }
}
