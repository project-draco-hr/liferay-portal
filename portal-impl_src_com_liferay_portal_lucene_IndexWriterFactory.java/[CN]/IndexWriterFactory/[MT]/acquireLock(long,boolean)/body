{
  if (LuceneUtil.INDEX_READ_ONLY) {
    return;
  }
  Semaphore lock=(Semaphore)_lockLookup.get(new Long(companyId));
  if (lock != null) {
    if (needExclusive) {
synchronized (_lockLookup) {
        _needExclusiveLock++;
      }
    }
    try {
      lock.acquire();
    }
  finally {
      if (needExclusive) {
synchronized (_lockLookup) {
          _needExclusiveLock--;
        }
      }
    }
  }
 else {
    if (_log.isWarnEnabled()) {
      _log.warn("IndexWriterFactory lock not found for " + companyId);
    }
  }
}
