{
  Class<?> clazz=getClass();
  String className=clazz.getName();
  ByteBuffer byteBuffer=ByteBuffer.allocate(className.length() + 11);
  byteBuffer.put(SerializationConstants.TC_CLASS);
  byteBuffer.put((byte)1);
  byteBuffer.putInt(0);
  byteBuffer.put((byte)1);
  byteBuffer.putInt(className.length());
  byteBuffer.put(className.getBytes(StringPool.UTF8));
  byteBuffer.flip();
  Deserializer deserializer=new Deserializer(byteBuffer);
  ClassLoaderPool.register(StringPool.BLANK,clazz.getClassLoader());
  try {
    Assert.assertSame(clazz,deserializer.readObject());
  }
  finally {
    ClassLoaderPool.unregister(clazz.getClassLoader());
  }
}
