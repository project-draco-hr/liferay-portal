{
  if (encodedURLString == null) {
    return null;
  }
  if (encodedURLString.length() == 0) {
    return StringPool.BLANK;
  }
  StringBuilder sb=new StringBuilder(encodedURLString.length());
  CharsetDecoder charsetDecoder=null;
  boolean modified=false;
  for (int i=0; i < encodedURLString.length(); i++) {
    char c=encodedURLString.charAt(i);
    if (c == CharPool.PERCENT) {
      ByteBuffer byteBuffer=_getEncodedByteBuffer(encodedURLString,i);
      if (charsetDecoder == null) {
        charsetDecoder=CharsetDecoderUtil.getCharsetDecoder(charsetName);
      }
      CharBuffer charBuffer=null;
      try {
        charBuffer=charsetDecoder.decode(byteBuffer);
      }
 catch (      CharacterCodingException cce) {
        _log.error(cce,cce);
        return StringPool.BLANK;
      }
      sb.append(charBuffer);
      i+=byteBuffer.capacity() * 3 - 1;
    }
 else     if (c == CharPool.PLUS) {
      sb.append(CharPool.SPACE);
      modified=true;
    }
 else {
      sb.append(c);
    }
  }
  if (!modified && (sb.length() == encodedURLString.length())) {
    return encodedURLString;
  }
 else {
    return sb.toString();
  }
}
