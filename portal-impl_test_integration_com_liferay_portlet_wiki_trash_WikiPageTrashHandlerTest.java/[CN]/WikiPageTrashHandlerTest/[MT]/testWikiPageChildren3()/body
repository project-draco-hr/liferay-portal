{
  ServiceContext serviceContext=ServiceTestUtil.getServiceContext(group.getGroupId());
  WikiNode node=(WikiNode)getParentBaseModel(group,serviceContext);
  int initialBaseModelsCount=getNotInTrashBaseModelsCount(node);
  int initialTrashEntriesCount=getTrashEntriesCount(group.getGroupId());
  WikiPage page=(WikiPage)addBaseModel(node,true,serviceContext);
  WikiPage childPage=addChildBaseModel(node.getNodeId(),page.getTitle(),true,serviceContext);
  addChildBaseModel(node.getNodeId(),page.getTitle(),true,serviceContext);
  addChildBaseModel(node.getNodeId(),childPage.getTitle(),true,serviceContext);
  Assert.assertEquals(initialBaseModelsCount + 4,getNotInTrashBaseModelsCount(node));
  Assert.assertEquals(initialTrashEntriesCount,getTrashEntriesCount(group.getGroupId()));
  moveBaseModelToTrash(childPage.getPrimaryKey());
  Assert.assertEquals(initialBaseModelsCount + 2,getNotInTrashBaseModelsCount(node));
  Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount(group.getGroupId()));
  moveBaseModelToTrash(page.getPrimaryKey());
  Assert.assertEquals(initialBaseModelsCount,getNotInTrashBaseModelsCount(node));
  Assert.assertEquals(initialTrashEntriesCount + 2,getTrashEntriesCount(group.getGroupId()));
  TrashHandler trashHandler=TrashHandlerRegistryUtil.getTrashHandler(getBaseModelClassName());
  trashHandler.restoreTrashEntry(TestPropsValues.getUserId(),getTrashEntryClassPK(page));
  Assert.assertEquals(initialBaseModelsCount + 2,getNotInTrashBaseModelsCount(node));
  Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount(group.getGroupId()));
}
