{
  URL[] classPathURLs=null;
  if (classLoader != null) {
    URL servicePropertiesURL=classLoader.getResource("service.properties");
    String servicePropertiesPath=servicePropertiesURL.getPath();
    File classPathFile=null;
    int index=servicePropertiesPath.indexOf("_wl_cls_gen.jar!");
    if (index != -1) {
      String wlclsgenJarPath=servicePropertiesPath.substring(0,index + 15);
      classPathFile=new File(wlclsgenJarPath);
    }
 else {
      File servicePropertiesFile=new File(servicePropertiesPath);
      File webInfDir=servicePropertiesFile.getParentFile();
      classPathFile=webInfDir;
    }
    classPathURLs=new URL[1];
    try {
      classPathURLs[0]=classPathFile.toURL();
    }
 catch (    MalformedURLException murle) {
      _log.error(murle,murle);
    }
  }
 else {
    Thread currentThread=Thread.currentThread();
    classLoader=currentThread.getContextClassLoader();
    File portalImplJarFile=new File(PortalUtil.getPortalLibDir(),"portal-impl.jar");
    if (portalImplJarFile.exists()) {
      classPathURLs=new URL[1];
      try {
        classPathURLs[0]=portalImplJarFile.toURL();
      }
 catch (      MalformedURLException murle) {
        _log.error(murle,murle);
      }
    }
 else {
      classPathURLs=ClassLoaderUtil.getFullClassPath(classLoader);
    }
  }
  _classLoader=classLoader;
  configure(classPathURLs);
}
