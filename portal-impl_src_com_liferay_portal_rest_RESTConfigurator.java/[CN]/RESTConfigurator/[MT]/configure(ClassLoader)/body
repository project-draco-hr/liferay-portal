{
  URL[] classPathURLs=null;
  if (classLoader != null) {
    URL servicePropertiesURL=classLoader.getResource("service.properties");
    File servicePropertiesFile=new File(servicePropertiesURL.getPath());
    File webInfDir=servicePropertiesFile.getParentFile();
    classPathURLs=new URL[1];
    try {
      classPathURLs[0]=webInfDir.toURL();
    }
 catch (    MalformedURLException murle) {
      _log.error(murle,murle);
    }
  }
 else {
    classLoader=Thread.currentThread().getContextClassLoader();
    File portalImplJarFile=new File(PortalUtil.getPortalLibDir(),"portal-impl.jar");
    if (portalImplJarFile.exists()) {
      classPathURLs=new URL[1];
      try {
        classPathURLs[0]=portalImplJarFile.toURL();
      }
 catch (      MalformedURLException murle) {
        _log.error(murle,murle);
      }
    }
 else {
      classPathURLs=ClassLoaderUtil.getFullClassPath(classLoader);
    }
  }
  this._classLoader=classLoader;
  configure(classPathURLs);
}
