{
  String contextRoot=pluginFileName;
  int warIndex=contextRoot.lastIndexOf(".war");
  if (warIndex != -1) {
    contextRoot=contextRoot.substring(0,warIndex);
  }
  if (contextRoot.equals("liferay-portal")) {
    contextRoot=PropsUtil.get(PropsKeys.PORTAL_CTX);
    if (contextRoot.equals(StringPool.SLASH)) {
      contextRoot="";
    }
 else     if (contextRoot.startsWith(StringPool.SLASH)) {
      contextRoot=contextRoot.substring(1);
    }
  }
  return StringPool.SLASH + contextRoot;
}
