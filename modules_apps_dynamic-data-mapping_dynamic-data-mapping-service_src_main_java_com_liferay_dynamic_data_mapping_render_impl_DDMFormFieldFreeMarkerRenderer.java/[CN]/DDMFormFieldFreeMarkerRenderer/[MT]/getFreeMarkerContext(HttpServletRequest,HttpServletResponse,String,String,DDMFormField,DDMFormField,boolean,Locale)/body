{
  Map<String,Object> freeMarkerContext=new HashMap<>();
  Map<String,Object> fieldContext=getFieldContext(request,response,portletNamespace,namespace,ddmFormField,locale);
  Map<String,Object> parentFieldContext=new HashMap<>();
  if (parentDDMFormField != null) {
    parentFieldContext=getFieldContext(request,response,portletNamespace,namespace,parentDDMFormField,locale);
  }
  freeMarkerContext.put("fieldStructure",fieldContext);
  freeMarkerContext.put("namespace",namespace);
  freeMarkerContext.put("parentFieldStructure",parentFieldContext);
  freeMarkerContext.put("portletNamespace",portletNamespace);
  freeMarkerContext.put("requestedLanguageDir",LanguageUtil.get(locale,"lang.dir"));
  freeMarkerContext.put("requestedLocale",locale);
  freeMarkerContext.put("showEmptyFieldLabel",showEmptyFieldLabel);
  return freeMarkerContext;
}
