{
  org.apache.lucene.document.Document luceneDocument=new org.apache.lucene.document.Document();
  Collection<Field> fields=document.getFields().values();
  for (  Field field : fields) {
    String name=field.getName();
    boolean numeric=field.isNumeric();
    Class<? extends Number> numericClass=field.getNumericClass();
    boolean tokenized=field.isTokenized();
    float boost=field.getBoost();
    if (!field.isLocalized()) {
      for (      String value : field.getValues()) {
        if (Validator.isNull(value)) {
          continue;
        }
        _addLuceneFieldable(luceneDocument,name,numeric,numericClass,tokenized,field.isSortable(),boost,value);
      }
    }
 else {
      Map<Locale,String> localizedValues=field.getLocalizedValues();
      for (      Map.Entry<Locale,String> entry : localizedValues.entrySet()) {
        String value=entry.getValue();
        if (Validator.isNull(value)) {
          continue;
        }
        Locale locale=entry.getKey();
        String languageId=LocaleUtil.toLanguageId(locale);
        String defaultLanguageId=LocaleUtil.toLanguageId(LocaleUtil.getDefault());
        if (languageId.equals(defaultLanguageId)) {
          _addLuceneFieldable(luceneDocument,name,numeric,numericClass,field.isSortable(),tokenized,boost,value);
        }
        String localizedName=DocumentImpl.getLocalizedName(locale,name);
        _addLuceneFieldable(luceneDocument,localizedName,numeric,numericClass,field.isSortable(),tokenized,boost,value);
      }
    }
  }
  return luceneDocument;
}
