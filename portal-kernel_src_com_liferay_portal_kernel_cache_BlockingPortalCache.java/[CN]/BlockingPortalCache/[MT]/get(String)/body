{
  Object obj=_portalCache.get(key);
  if (obj != null) {
    return obj;
  }
  CompeteLatch lastCompeteLatch=_competeLatchThreadLocal.get();
  if (lastCompeteLatch != null) {
    lastCompeteLatch.done();
    _competeLatchThreadLocal.set(null);
  }
  CompeteLatch currentCompeteLatch=_competeLatchMap.get(key);
  if (currentCompeteLatch == null) {
    CompeteLatch newCompeteLatch=new CompeteLatch();
    currentCompeteLatch=_competeLatchMap.putIfAbsent(key,newCompeteLatch);
    if (currentCompeteLatch == null) {
      currentCompeteLatch=newCompeteLatch;
    }
  }
  _competeLatchThreadLocal.set(currentCompeteLatch);
  if (!currentCompeteLatch.compete()) {
    currentCompeteLatch.await();
    _competeLatchThreadLocal.set(null);
    obj=_portalCache.get(key);
  }
  return obj;
}
