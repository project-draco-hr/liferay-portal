{
  Collection<ServiceReference<PermissionCheckerFactory>> serviceReferences=_bundleContext.getServiceReferences(PermissionCheckerFactory.class,"(!(component.name=" + StagingPermissionCheckerFactory.class.getName() + "))");
  if (serviceReferences.isEmpty()) {
    return null;
  }
  Iterator<ServiceReference<PermissionCheckerFactory>> iterator=serviceReferences.iterator();
  ServiceReference<PermissionCheckerFactory> serviceReference=iterator.next();
  PermissionCheckerFactory permissionCheckerFactory=_bundleContext.getService(serviceReference);
  try {
    PermissionChecker permissionChecker=permissionCheckerFactory.create(user);
    return new StagingPermissionChecker(permissionChecker);
  }
  finally {
    _bundleContext.ungetService(serviceReference);
  }
}
