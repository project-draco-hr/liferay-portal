{
  if (properties == null) {
    properties=new HashMapDictionary<>();
  }
  properties.put(LDAPConstants.COMPANY_ID,companyId);
  ObjectValuePair<Configuration,T> objectValuePair=_configurations.get(companyId);
  try {
    Configuration configuration=null;
    if (objectValuePair == null) {
      configuration=configurationAdmin.createFactoryConfiguration(getMetatypeId(),StringPool.QUESTION);
    }
 else {
      configuration=objectValuePair.getKey();
    }
    configuration.update(properties);
    if (_log.isDebugEnabled()) {
      _log.debug("Updated configuration " + getMetatypeId() + " for company "+ companyId+ " with properties: "+ properties);
    }
  }
 catch (  IOException ioe) {
    throw new SystemException("Unable to update configuration",ioe);
  }
}
