{
  for (  Pattern restrictedClassPattern : _restrictedClassesPatterns) {
    Matcher restrictedClassMatcher=restrictedClassPattern.matcher(osc.getName());
    if (restrictedClassMatcher.find()) {
      throw new InvalidClassException("Trying to load restricted class: " + osc.getName());
    }
  }
  boolean allowedClass=false;
  for (  Pattern allowedClassPattern : _allowedClassesPatterns) {
    Matcher allowedClassMatcher=allowedClassPattern.matcher(osc.getName());
    if (allowedClassMatcher.find()) {
      allowedClass=true;
      break;
    }
  }
  if (!allowedClass) {
    throw new InvalidClassException("Trying to load restricted class: " + osc.getName());
  }
  return doResolveClass(osc);
}
