{
  boolean isSubstringSearchAlways=false;
  if (_queryPreProcessConfiguration != null) {
    isSubstringSearchAlways=_queryPreProcessConfiguration.isSubstringSearchAlways(field);
  }
  if (!isSubstringSearchAlways) {
    return createQueryForFullTextSearch(field,value);
  }
  KeywordTokenizer keywordTokenizer=getKeywordTokenizer();
  if (!splitKeywords && (keywordTokenizer != null)) {
    splitKeywords=keywordTokenizer.requiresTokenization(value);
  }
  if (splitKeywords && (keywordTokenizer != null)) {
    List<String> tokens=keywordTokenizer.tokenize(value);
    if (tokens.size() == 1) {
      return createQuery(field,tokens.get(0),like,false);
    }
    BooleanQueryImpl booleanQuery=new BooleanQueryImpl();
    for (    String token : tokens) {
      Query tokenQuery=createTokenQuery(field,token);
      booleanQuery.add(tokenQuery,BooleanClauseOccur.SHOULD);
    }
    return booleanQuery;
  }
  return createTokenQuery(field,value);
}
