{
  long nodeId=ParamUtil.getLong(req,"nodeId");
  String title=ParamUtil.getString(req,"title");
  double version=ParamUtil.getDouble(req,"version");
  WikiPage page=null;
  if (nodeId == 0) {
    WikiNode node=(WikiNode)req.getAttribute(WebKeys.WIKI_NODE);
    if (node != null) {
      nodeId=node.getNodeId();
    }
  }
  if (Validator.isNull(title)) {
    title=WikiPageImpl.FRONT_PAGE;
  }
  try {
    page=WikiPageServiceUtil.getPage(nodeId,title,version);
  }
 catch (  NoSuchPageException nspe) {
    if (version == 0) {
      page=WikiPageServiceUtil.addPage(nodeId,title);
    }
  }
  req.setAttribute(WebKeys.WIKI_PAGE,page);
}
