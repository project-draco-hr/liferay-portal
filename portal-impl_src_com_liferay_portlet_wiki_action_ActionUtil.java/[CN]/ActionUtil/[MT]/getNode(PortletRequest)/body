{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(portletRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long nodeId=ParamUtil.getLong(request,"nodeId");
  String nodeName=ParamUtil.getString(request,"nodeName");
  WikiNode node=null;
  try {
    if (nodeId > 0) {
      node=WikiNodeServiceUtil.getNode(nodeId);
    }
 else     if (Validator.isNotNull(nodeName)) {
      node=WikiNodeServiceUtil.getNode(themeDisplay.getScopeGroupId(),nodeName);
    }
    if (node == null) {
      throw new NoSuchNodeException();
    }
  }
 catch (  NoSuchNodeException e) {
    node=ActionUtil.getFirstVisibleNode(portletRequest);
  }
  request.setAttribute(WebKeys.WIKI_NODE,node);
  return node;
}
