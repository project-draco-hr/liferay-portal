{
  String defaultPreferences=RandomTestUtil.randomString();
  PortletPreferencesLocalServiceUtil.addPortletPreferences(TestPropsValues.getCompanyId(),PortletKeys.PREFS_OWNER_ID_DEFAULT,PortletKeys.PREFS_OWNER_TYPE_LAYOUT,layout.getPlid(),_testNonembeddedPortlet.getPortletId(),_testNonembeddedPortlet,defaultPreferences);
  List<PortletPreferences> portletPreferences=PortletPreferencesLocalServiceUtil.getPortletPreferences(layout.getPlid(),_testNonembeddedPortlet.getPortletId());
  Assert.assertEquals(1,portletPreferences.size());
  PortletPreferences embeddedPortletPreference=portletPreferences.get(0);
  Assert.assertEquals(defaultPreferences,embeddedPortletPreference.getPreferences());
}
