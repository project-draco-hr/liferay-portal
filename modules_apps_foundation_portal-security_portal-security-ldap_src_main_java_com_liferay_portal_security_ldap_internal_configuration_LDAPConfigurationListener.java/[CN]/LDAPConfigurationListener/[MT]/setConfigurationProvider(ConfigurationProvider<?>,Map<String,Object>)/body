{
  String factoryPid=MapUtil.getString(properties,"factoryPid");
  if (Validator.isNull(factoryPid)) {
    throw new IllegalArgumentException("No factory PID specified for configuration provider " + configurationProvider);
  }
  _configurationProviders.put(factoryPid,configurationProvider);
  try {
    Configuration[] configurations=_configurationAdmin.listConfigurations("(service.factoryPid=" + factoryPid + ")");
    if (configurations != null) {
      for (      Configuration configuration : configurations) {
        configurationProvider.registerConfiguration(configuration);
      }
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Unable to register configurations",e);
    }
  }
}
