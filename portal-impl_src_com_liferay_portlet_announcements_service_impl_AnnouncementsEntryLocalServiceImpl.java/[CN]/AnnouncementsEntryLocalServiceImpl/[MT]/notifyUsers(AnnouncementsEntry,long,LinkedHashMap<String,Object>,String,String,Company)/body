{
  int total=0;
  if (teamId > 0) {
    total=userLocalService.getTeamUsersCount(teamId);
  }
 else {
    total=userLocalService.searchCount(company.getCompanyId(),null,WorkflowConstants.STATUS_APPROVED,params);
  }
  final IntervalActionProcessor intervalActionProcessor=new IntervalActionProcessor(total);
  intervalActionProcessor.setPerformIntervalActionMethod(new IntervalActionProcessor.PerformIntervalActionMethod(){
    @Override public void performIntervalAction(    int start,    int end) throws PortalException {
      List<User> users=null;
      if (teamId > 0) {
        users=userLocalService.getTeamUsers(teamId,start,end);
      }
 else {
        users=userLocalService.search(company.getCompanyId(),null,WorkflowConstants.STATUS_APPROVED,params,start,end,(OrderByComparator<User>)null);
      }
      notifyUsers(users,entry,company.getLocale(),toAddress,toName);
      intervalActionProcessor.incrementStart(users.size());
    }
  }
);
  intervalActionProcessor.performIntervalActions();
}
