{
  try {
    if (!PropsValues.XUGGLER_ENABLED || _hasVideo(fileEntry)) {
      return;
    }
    String id=DLUtil.getTempFileId(fileEntry.getFileEntryId(),fileEntry.getVersion());
    File previewFile=_getPreviewFile(id);
    if (_isGeneratePreview(id)) {
      File tmpFile=_getVideoTmpFile(id,fileEntry.getExtension());
      try {
        InputStream inputStream=DLFileEntryLocalServiceUtil.getFileAsStream(fileEntry.getUserId(),fileEntry.getFileEntryId(),fileEntry.getVersion(),false);
        FileUtil.write(tmpFile,inputStream);
        _generateVideoXuggler(fileEntry,tmpFile,previewFile,PropsValues.DL_FILE_ENTRY_PREVIEW_VIDEO_HEIGHT,PropsValues.DL_FILE_ENTRY_PREVIEW_VIDEO_WIDTH);
        if (_log.isInfoEnabled()) {
          _log.info("Xuggler generated a preview video for " + id);
        }
      }
  finally {
        FileUtil.delete(tmpFile);
      }
    }
    if (_isGenerateThumbnail(id)) {
      File fileThumbnail=_getThumbnailFile(id);
      fileThumbnail.createNewFile();
      _generateThumbnailXuggler(previewFile,fileThumbnail,PropsValues.DL_FILE_ENTRY_THUMBNAIL_HEIGHT,PropsValues.DL_FILE_ENTRY_THUMBNAIL_WIDTH);
      if (_log.isInfoEnabled()) {
        _log.info("Xuggler generated a thumbnail from video of " + id);
      }
    }
  }
 catch (  NoSuchFileEntryException nsfee) {
  }
catch (  Exception e) {
    _log.error(e,e);
  }
 finally {
    _fileEntries.remove(fileEntry.getFileEntryId());
  }
}
