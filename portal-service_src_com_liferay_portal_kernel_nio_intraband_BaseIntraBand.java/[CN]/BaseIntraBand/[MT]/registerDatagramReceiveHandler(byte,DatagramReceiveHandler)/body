{
  ensureOpen();
  int index=((int)type) & 0xFF;
  DatagramReceiveHandler oldDatagramReceiveHandler=null;
  DatagramReceiveHandler[] datagramReceiveHandlers=null;
  DatagramReceiveHandler[] copyDatagramReceiveHandlers=null;
  do {
    datagramReceiveHandlers=datagramReceiveHandlersReference.get();
    copyDatagramReceiveHandlers=new DatagramReceiveHandler[256];
    System.arraycopy(datagramReceiveHandlers,0,copyDatagramReceiveHandlers,0,256);
    oldDatagramReceiveHandler=copyDatagramReceiveHandlers[index];
    copyDatagramReceiveHandlers[index]=datagramReceiveHandler;
  }
 while (!datagramReceiveHandlersReference.compareAndSet(datagramReceiveHandlers,copyDatagramReceiveHandlers));
  return oldDatagramReceiveHandler;
}
