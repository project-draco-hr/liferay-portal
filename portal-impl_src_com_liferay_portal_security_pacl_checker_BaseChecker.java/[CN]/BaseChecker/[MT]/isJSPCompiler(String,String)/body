{
  for (int i=1; ; i++) {
    Class<?> callerClass=Reflection.getCallerClass(i);
    if (callerClass == null) {
      break;
    }
    String callerClassName=callerClass.getName();
    if (callerClassName.startsWith(_PACKAGE_ORG_APACHE_JASPER_COMPILER) || callerClassName.startsWith(_PACKAGE_ORG_APACHE_JASPER_XMLPARSER) || callerClassName.startsWith(_PACKAGE_ORG_APACHE_NAMING_RESOURCES)|| callerClassName.equals(_ClASS_NAME_JASPER_LOADER)) {
      ClassLoader callerClassLoader=PACLClassLoaderUtil.getClassLoader(callerClass);
      if (callerClassLoader != _commonClassLoader) {
        _log.error("A plugin is hijacking the JSP compiler via " + callerClassName + " to "+ action+ " "+ subject);
        return false;
      }
      if (_log.isDebugEnabled()) {
        _log.debug("Allowing the JSP compiler via " + callerClassName + " to "+ action+ " "+ subject);
      }
      return true;
    }
  }
  return false;
}
