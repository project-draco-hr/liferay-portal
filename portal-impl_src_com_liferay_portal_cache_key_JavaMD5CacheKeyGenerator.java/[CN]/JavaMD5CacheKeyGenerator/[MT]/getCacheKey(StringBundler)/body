{
  if ((_maxLength > -1) && (sb.length() < _maxLength)) {
    return sb.toString();
  }
  try {
    for (int i=0; i < sb.index(); i++) {
      String key=sb.stringAt(i);
      _messageDigest.update(_charsetEncoder.encode(CharBuffer.wrap(key)));
    }
    byte[] bytes=_messageDigest.digest();
    return encodeCacheKey(bytes);
  }
 catch (  Exception e) {
    _log.error(e,e);
    return sb.toString();
  }
}
