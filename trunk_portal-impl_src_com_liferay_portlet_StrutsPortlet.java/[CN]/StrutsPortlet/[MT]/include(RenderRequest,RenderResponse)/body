{
  Map<String,Object> strutsAttributes=null;
  if (_portletConfig.isWARFile()) {
    strutsAttributes=StrutsUtil.removeStrutsAttributes(getPortletContext(),renderRequest);
  }
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  try {
    permissionChecker.setValues(renderRequest);
    PortletRequestProcessor processor=_getPortletRequestProcessor(renderRequest);
    processor.process(renderRequest,renderResponse);
  }
 catch (  ServletException se) {
    throw new PortletException(se);
  }
 finally {
    permissionChecker.resetValues();
    if (_portletConfig.isWARFile()) {
      StrutsUtil.setStrutsAttributes(renderRequest,strutsAttributes);
    }
  }
  if (copyRequestParameters) {
    PortalUtil.clearRequestParameters(renderRequest);
  }
}
