{
  if (keys == null) {
    throw new IllegalArgumentException("Keys must be defined!");
  }
  StringBuilder sb=new StringBuilder(length);
  String fullKey=new StringBundler().append(keys).toString();
  int fullKeyLength=fullKey.length();
  int refreshPeriod=(int)(_MULTIPLIER / Math.log(fullKeyLength));
  long secureLong=0;
  for (int i=0; i < length; i++) {
    if ((i % refreshPeriod) == 0) {
      secureLong=SecureRandomUtil.nextLong();
    }
    int pos=(int)Math.abs(secureLong % fullKeyLength);
    secureLong=secureLong / fullKeyLength;
    sb.append(fullKey.charAt(pos));
  }
  return sb.toString();
}
