{
  if (keys == null) {
    throw new IllegalArgumentException("Keys must be defined!");
  }
  StringBundler fullKeySB=new StringBundler(keys);
  String fullKey=fullKeySB.toString();
  int fullKeyLength=fullKey.length();
  int refreshPeriod=(int)(_MULTIPLIER / Math.log(fullKeyLength));
  long secureLong=0;
  StringBuilder sb=new StringBuilder(length);
  for (int i=0; i < length; i++) {
    if ((i % refreshPeriod) == 0) {
      secureLong=SecureRandomUtil.nextLong();
    }
    int pos=Math.abs((int)(secureLong % fullKeyLength));
    secureLong=secureLong / fullKeyLength;
    sb.append(fullKey.charAt(pos));
  }
  return sb.toString();
}
