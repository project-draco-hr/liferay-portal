{
  if (length < keys.length) {
    length=keys.length;
  }
  StringBuilder sb=new StringBuilder(length);
  Random random=new Random(SecureRandomUtil.nextLong());
  int fullKeyLength=0;
  for (  String key : keys) {
    fullKeyLength+=key.length();
  }
  int reseedPeriod=(int)(_MULTIPLIER / Math.log(fullKeyLength));
  int reseedCounter=0;
  for (  String key : keys) {
    int count=key.length() * length / fullKeyLength;
    if (count == 0) {
      count=1;
    }
    for (int i=0; i < count; i++) {
      if (++reseedCounter > reseedPeriod) {
        reseedCounter=0;
        random.setSeed(SecureRandomUtil.nextLong());
      }
      sb.append(key.charAt(random.nextInt(key.length())));
    }
  }
  for (int i=sb.length(); i < length; i++) {
    String key=keys[random.nextInt(keys.length)];
    sb.append(key.charAt(random.nextInt(key.length())));
  }
  RandomUtil.shuffle(random,sb);
  return sb.toString();
}
