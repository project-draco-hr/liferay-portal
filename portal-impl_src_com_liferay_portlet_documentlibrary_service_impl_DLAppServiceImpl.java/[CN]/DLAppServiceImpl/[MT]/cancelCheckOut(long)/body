{
  Repository repository=getFileEntryRepository(fileEntryId);
  FileEntry fileEntry=repository.getFileEntry(fileEntryId);
  ProcessorCapability processorCapability=new LiferayProcessorCapability();
  processorCapability.cleanUp(fileEntry.getLatestFileVersion());
  FileVersion draftFileVersion=repository.cancelCheckOut(fileEntryId);
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setWorkflowAction(WorkflowConstants.ACTION_PUBLISH);
  dlAppHelperLocalService.cancelCheckOut(getUserId(),fileEntry,null,fileEntry.getFileVersion(),draftFileVersion,serviceContext);
}
