{
  Repository repository=getFileEntryRepository(fileEntryId);
  FileEntry oldFileEntry=repository.getFileEntry(fileEntryId);
  FileVersion oldFileVersion=oldFileEntry.getFileVersion();
  FileEntry fileEntry=repository.updateFileEntry(getUserId(),fileEntryId,sourceFileName,mimeType,title,description,changeLog,majorVersion,is,size,serviceContext);
  if (is != null) {
    ProcessorCapability processorCapability=new LiferayProcessorCapability();
    processorCapability.cleanUp(fileEntry.getLatestFileVersion());
    oldFileVersion=null;
  }
  repository.checkInFileEntry(getUserId(),fileEntryId,majorVersion,changeLog,serviceContext);
  dlAppHelperLocalService.updateFileEntry(getUserId(),fileEntry,oldFileVersion,fileEntry.getFileVersion(),serviceContext);
  return fileEntry;
}
