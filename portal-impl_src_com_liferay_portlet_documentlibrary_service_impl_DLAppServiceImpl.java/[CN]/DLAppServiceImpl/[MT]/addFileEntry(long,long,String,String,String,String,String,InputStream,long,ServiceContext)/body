{
  if (is == null) {
    is=new UnsyncByteArrayInputStream(new byte[0]);
    size=0;
  }
  mimeType=DLAppUtil.getMimeType(sourceFileName,mimeType,title,null,is);
  Repository repository=getRepository(repositoryId);
  FileEntry fileEntry=repository.addFileEntry(folderId,sourceFileName,mimeType,title,description,changeLog,is,size,serviceContext);
  dlAppHelperLocalService.addFileEntry(getUserId(),fileEntry,fileEntry.getFileVersion(),serviceContext);
  return fileEntry;
}
