{
  File tempFile=null;
  if (file == null || !file.exists()) {
    tempFile=FileUtil.createTempFile();
    file=tempFile;
  }
  try {
    Repository repository=getRepository(repositoryId);
    FileEntry fileEntry=repository.addFileEntry(folderId,sourceFileName,mimeType,title,description,changeLog,file,serviceContext);
    DLProcessorRegistryUtil.trigger(fileEntry);
    return fileEntry;
  }
  finally {
    FileUtil.delete(tempFile);
  }
}
