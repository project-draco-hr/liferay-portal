{
  try {
    _mockIntraBand.sendDatagram(null,null,null,null,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("RegistrationReference is null",npe.getMessage());
  }
  RegistrationReference registrationReference=new MockRegistrationReference(_mockIntraBand);
  registrationReference.cancelRegistration();
  try {
    _mockIntraBand.sendDatagram(registrationReference,null,null,null,null);
    Assert.fail();
  }
 catch (  IllegalArgumentException iae) {
    Assert.assertEquals("RegistrationReference is not valid",iae.getMessage());
  }
  registrationReference=new MockRegistrationReference(_mockIntraBand);
  try {
    _mockIntraBand.sendDatagram(registrationReference,null,null,null,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("Datagram is null",npe.getMessage());
  }
  try {
    _mockIntraBand.sendDatagram(registrationReference,Datagram.createRequestDatagram(_type,_dataContent),null,null,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("CompletionType set is null",npe.getMessage());
  }
  try {
    _mockIntraBand.sendDatagram(registrationReference,Datagram.createRequestDatagram(_type,_dataContent),null,EnumSet.noneOf(CompletionHandler.CompletionType.class),null);
    Assert.fail();
  }
 catch (  IllegalArgumentException iae) {
    Assert.assertEquals("CompletionType set is empty",iae.getMessage());
  }
  try {
    _mockIntraBand.sendDatagram(registrationReference,Datagram.createRequestDatagram(_type,_dataContent),null,EnumSet.of(CompletionHandler.CompletionType.SUBMITTED),null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("CompleteHandler is null",npe.getMessage());
  }
  try {
    _mockIntraBand.sendDatagram(registrationReference,Datagram.createRequestDatagram(_type,_dataContent),null,EnumSet.of(CompletionHandler.CompletionType.SUBMITTED),new RecordCompletionHandler<Object>(),1000,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("TimeUnit is null",npe.getMessage());
  }
  Datagram requestDatagram=Datagram.createRequestDatagram(_type,_dataContent);
  _mockIntraBand.sendDatagram(registrationReference,requestDatagram,null,EnumSet.of(CompletionHandler.CompletionType.DELIVERED),new RecordCompletionHandler<Object>(),0,TimeUnit.MILLISECONDS);
  long sequenceId=requestDatagram.getSequenceId();
  Assert.assertEquals(DEFAULT_TIMEOUT,_mockIntraBand.getDatagram().timeout);
  Assert.assertEquals(1,_mockIntraBand.responseWaitingMap.size());
  Assert.assertSame(requestDatagram,_mockIntraBand.responseWaitingMap.remove(sequenceId));
  Assert.assertEquals(1,_mockIntraBand.timeoutMap.size());
  Assert.assertTrue(_mockIntraBand.timeoutMap.values().remove(sequenceId));
  _mockIntraBand.sendDatagram(registrationReference,requestDatagram,null,EnumSet.of(CompletionHandler.CompletionType.REPLIED),new RecordCompletionHandler<Object>(),2,TimeUnit.SECONDS);
  sequenceId=requestDatagram.getSequenceId();
  Assert.assertEquals(2000,_mockIntraBand.getDatagram().timeout);
  Assert.assertEquals(1,_mockIntraBand.responseWaitingMap.size());
  Assert.assertSame(requestDatagram,_mockIntraBand.responseWaitingMap.remove(sequenceId));
  Assert.assertEquals(1,_mockIntraBand.timeoutMap.size());
  Assert.assertTrue(_mockIntraBand.timeoutMap.values().remove(sequenceId));
  _mockIntraBand.sendDatagram(registrationReference,requestDatagram,null,EnumSet.of(CompletionHandler.CompletionType.SUBMITTED),new RecordCompletionHandler<Object>());
  Assert.assertEquals(DEFAULT_TIMEOUT,_mockIntraBand.getDatagram().timeout);
}
