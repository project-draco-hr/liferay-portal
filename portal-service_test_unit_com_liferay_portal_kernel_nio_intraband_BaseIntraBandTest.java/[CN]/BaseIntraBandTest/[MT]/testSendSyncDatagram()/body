{
  try {
    _mockIntraBand.sendSyncDatagram(null,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("Registration reference is null",npe.getMessage());
  }
  RegistrationReference registrationReference=new MockRegistrationReference(_mockIntraBand);
  registrationReference.cancelRegistration();
  try {
    _mockIntraBand.sendSyncDatagram(registrationReference,null);
    Assert.fail();
  }
 catch (  IllegalArgumentException iae) {
    Assert.assertEquals("Registration reference is invalid",iae.getMessage());
  }
  registrationReference=new MockRegistrationReference(_mockIntraBand);
  try {
    _mockIntraBand.sendSyncDatagram(registrationReference,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("Datagram is null",npe.getMessage());
  }
  try {
    _mockIntraBand.sendSyncDatagram(registrationReference,Datagram.createRequestDatagram(_type,_data),1000,null);
    Assert.fail();
  }
 catch (  NullPointerException npe) {
    Assert.assertEquals("Time unit is null",npe.getMessage());
  }
  Datagram requestDatagram=Datagram.createRequestDatagram(_type,_data);
  try {
    _mockIntraBand.sendSyncDatagram(registrationReference,requestDatagram,0,TimeUnit.MILLISECONDS);
    Assert.fail();
  }
 catch (  TimeoutException te) {
    Assert.assertEquals("Result waiting timeout",te.getMessage());
  }
  Assert.assertEquals(_TIMEOUT_DEFAULT,_mockIntraBand.getDatagram().timeout);
  try {
    _mockIntraBand.sendSyncDatagram(registrationReference,requestDatagram,2,TimeUnit.SECONDS);
    Assert.fail();
  }
 catch (  TimeoutException te) {
    Assert.assertEquals("Result waiting timeout",te.getMessage());
  }
  Assert.assertEquals(2000,requestDatagram.timeout);
  final IOException expectedIOException=new IOException("RecordDatagramReceiveHandler");
  IntraBand intraBand=new MockIntraBand(_TIMEOUT_DEFAULT){
    @Override protected void doSendDatagram(    RegistrationReference registrationReference,    Datagram datagram){
      datagram.completionHandler.failed(null,expectedIOException);
    }
  }
;
  try {
    intraBand.sendSyncDatagram(registrationReference,requestDatagram);
    Assert.fail();
  }
 catch (  IOException ioe) {
    Assert.assertSame(expectedIOException,ioe);
  }
  final Datagram expectedDatagram=Datagram.createResponseDatagram(requestDatagram,_data);
  intraBand=new MockIntraBand(_TIMEOUT_DEFAULT){
    @Override protected void doSendDatagram(    RegistrationReference registrationReference,    Datagram datagram){
      datagram.completionHandler.replied(null,expectedDatagram);
    }
  }
;
  Datagram responseDatagram=intraBand.sendSyncDatagram(registrationReference,requestDatagram);
  Assert.assertSame(expectedDatagram,responseDatagram);
  SendSyncDatagramCompletionHandler sendSyncDatagramCompletionHandler=new SendSyncDatagramCompletionHandler();
  sendSyncDatagramCompletionHandler.delivered(null);
  sendSyncDatagramCompletionHandler.submitted(null);
  sendSyncDatagramCompletionHandler.timeouted(null);
}
