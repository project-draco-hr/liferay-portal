{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Map<String,String> definitionTerms=new LinkedHashMap<>();
  definitionTerms.put("[$FROM_ADDRESS$]",HtmlUtil.escape(emailFromAddress));
  definitionTerms.put("[$FROM_NAME$]",HtmlUtil.escape(emailFromName));
  if (showPasswordTerms) {
    definitionTerms.put("[$PASSWORD_RESET_URL$]",LanguageUtil.get(themeDisplay.getLocale(),"the-password-reset-url"));
  }
  Company company=themeDisplay.getCompany();
  definitionTerms.put("[$PORTAL_URL$]",company.getVirtualHostname());
  definitionTerms.put("[$REMOTE_ADDRESS$]",LanguageUtil.get(themeDisplay.getLocale(),"the-browser's-remote-address"));
  definitionTerms.put("[$REMOTE_HOST$]",LanguageUtil.get(themeDisplay.getLocale(),"the-browser's-remote-host"));
  definitionTerms.put("[$TO_ADDRESS$]",LanguageUtil.get(themeDisplay.getLocale(),"the-address-of-the-email-recipient"));
  definitionTerms.put("[$TO_NAME$]",LanguageUtil.get(themeDisplay.getLocale(),"the-name-of-the-email-recipient"));
  definitionTerms.put("[$USER_ID$]",LanguageUtil.get(themeDisplay.getLocale(),"the-user-id"));
  if (showPasswordTerms) {
    definitionTerms.put("[$USER_PASSWORD$]",LanguageUtil.get(themeDisplay.getLocale(),"the-user-password"));
  }
  definitionTerms.put("[$USER_SCREENNAME$]",LanguageUtil.get(themeDisplay.getLocale(),"the-user-screen-name"));
  return definitionTerms;
}
