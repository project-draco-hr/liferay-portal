{
  _eventUtil.sendEvent(bundle,EventUtil.DEPLOYING,null,false);
  String contextPath=WabUtil.getWebContextPath(bundle);
  if (contextPath == null) {
    return;
  }
  BundleContext bundleContext=bundle.getBundleContext();
  if (bundleContext == null) {
    _eventUtil.sendEvent(bundle,EventUtil.FAILED,null,false);
    return;
  }
  try {
    WabBundleProcessor newWabBundleProcessor=new WabBundleProcessor(bundle,contextPath,_logger);
    WabBundleProcessor oldWabBundleProcessor=_wabBundleProcessors.putIfAbsent(bundle,newWabBundleProcessor);
    if (oldWabBundleProcessor != null) {
      _eventUtil.sendEvent(bundle,EventUtil.FAILED,null,false);
      return;
    }
    newWabBundleProcessor.init(_saxParserFactory,_properties);
  }
 catch (  Exception e) {
    _eventUtil.sendEvent(bundle,EventUtil.FAILED,e,false);
  }
}
