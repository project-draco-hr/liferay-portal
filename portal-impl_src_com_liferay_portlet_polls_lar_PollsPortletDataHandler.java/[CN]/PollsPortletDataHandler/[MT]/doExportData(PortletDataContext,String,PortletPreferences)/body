{
  portletDataContext.addPermissions("com.liferay.portlet.polls",portletDataContext.getScopeGroupId());
  Element rootElement=addExportDataRootElement(portletDataContext);
  rootElement.addAttribute("group-id",String.valueOf(portletDataContext.getScopeGroupId()));
  final Element questionsElement=rootElement.addElement("questions");
  ActionableDynamicQuery questionActionableDynamicQuery=new PollsQuestionActionableDynamicQuery(){
    @Override protected void addCriteria(    DynamicQuery dynamicQuery){
      portletDataContext.addDateRangeCriteria(dynamicQuery,"modifiedDate");
    }
    @Override protected void performAction(    Object object) throws PortalException {
      PollsQuestion pollsQuestion=(PollsQuestion)object;
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,new Element[]{questionsElement},pollsQuestion);
    }
  }
;
  questionActionableDynamicQuery.setGroupId(portletDataContext.getGroupId());
  questionActionableDynamicQuery.performActions();
  final Element choicesElement=rootElement.addElement("choices");
  ActionableDynamicQuery choiceActionableDynamicQuery=new PollsChoiceActionableDynamicQuery(){
    @Override protected void addCriteria(    DynamicQuery dynamicQuery){
      portletDataContext.addDateRangeCriteria(dynamicQuery,"modifiedDate");
    }
    @Override protected void performAction(    Object object) throws PortalException {
      PollsChoice pollsChoice=(PollsChoice)object;
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,new Element[]{questionsElement,choicesElement},pollsChoice);
    }
  }
;
  choiceActionableDynamicQuery.setGroupId(portletDataContext.getGroupId());
  choiceActionableDynamicQuery.performActions();
  final Element votesElement=rootElement.addElement("votes");
  if (portletDataContext.getBooleanParameter(PollsPortletDataHandler.NAMESPACE,"votes")) {
    ActionableDynamicQuery voteActionableDynamicQuery=new PollsVoteActionableDynamicQuery(){
      @Override protected void addCriteria(      DynamicQuery dynamicQuery){
        portletDataContext.addDateRangeCriteria(dynamicQuery,"modifiedDate");
      }
      @Override protected void performAction(      Object object) throws PortalException {
        PollsVote pollsVote=(PollsVote)object;
        StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,new Element[]{questionsElement,choicesElement,votesElement},pollsVote);
      }
    }
;
    voteActionableDynamicQuery.setGroupId(portletDataContext.getGroupId());
    voteActionableDynamicQuery.performActions();
  }
  return getExportDataRootElementString(rootElement);
}
