{
  int position=0;
  if (token != null) {
    String tagName=token.getEndTag();
    for (position=_tagsStack.size() - 1; position >= 0; position--) {
      if (_tagsStack.elementAt(position).equals(tagName)) {
        break;
      }
    }
  }
  if (position >= 0) {
    for (int i=_tagsStack.size() - 1; i >= position; i--) {
      _itemsList.add(new BBCodeItem(TOKEN_TAG_END,null,_tagsStack.elementAt(i)));
    }
    _tagsStack.setSize(position);
  }
}
