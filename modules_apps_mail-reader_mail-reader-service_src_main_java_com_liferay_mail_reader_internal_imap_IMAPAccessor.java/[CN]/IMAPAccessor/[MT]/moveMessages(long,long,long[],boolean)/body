{
  Folder sourceJxFolder=null;
  Folder destinationJxFolder=null;
  try {
    sourceJxFolder=openFolder(sourceFolderId);
    sourceJxFolder.addMessageCountListener(new IMAPMessageCountListener(_user,_account,_password));
    destinationJxFolder=openFolder(destinationFolderId);
    destinationJxFolder.addMessageCountListener(new IMAPMessageCountListener(_user,_account,_password));
    List<Message> jxMessages=getMessages(sourceJxFolder,messageIds,deleteMissingMessages);
    for (    Message jxMessage : jxMessages) {
      destinationJxFolder.appendMessages(new Message[]{jxMessage});
      jxMessage.setFlag(Flags.Flag.DELETED,true);
    }
  }
 catch (  MessagingException me) {
    throw new MailException(me);
  }
 finally {
    closeFolder(sourceJxFolder,true);
    closeFolder(destinationJxFolder,false);
  }
}
