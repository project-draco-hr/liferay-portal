{
  SearchContext searchContext=new SearchContext();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  searchContext.setCompanyId(themeDisplay.getCompanyId());
  searchContext.setGroupId(themeDisplay.getScopeGroupId());
  searchContext.setUserId(themeDisplay.getUserId());
  Map<String,Serializable> attributes=new HashMap<String,Serializable>();
  Enumeration<String> enu=request.getParameterNames();
  while (enu.hasMoreElements()) {
    String param=enu.nextElement();
    String[] values=request.getParameterValues(param);
    if ((values != null) && (values.length > 0)) {
      if (values.length == 1) {
        attributes.put(param,values[0]);
      }
 else {
        attributes.put(param,values);
      }
    }
  }
  searchContext.setAttributes(attributes);
  long[] assetCategoryIds=StringUtil.split(ParamUtil.getString(request,"assetCategoryIds"),0L);
  String[] assetTagNames=StringUtil.split(ParamUtil.getString(request,"assetTagNames"));
  searchContext.setAssetCategoryIds(assetCategoryIds);
  searchContext.setAssetTagNames(assetTagNames);
  return searchContext;
}
