{
  long startTime=System.currentTimeMillis();
  while (true) {
    update();
    StringBuilder sb=new StringBuilder();
    sb.append(getDownstreamJobCount("completed"));
    sb.append(" Completed / ");
    sb.append(getDownstreamJobCount("running"));
    sb.append(" Running / ");
    sb.append(getDownstreamJobCount("queued"));
    sb.append(" Queued / ");
    sb.append(getDownstreamJobCount("starting"));
    sb.append(" Starting / ");
    sb.append(_downstreamJobs.size());
    sb.append(" Total");
    System.out.println(sb.toString());
    List<DownstreamBuild> missingDownstreamJobs=getDownstreamJobs("missing");
    for (    DownstreamBuild missingDownstreamJob : missingDownstreamJobs) {
      long time=System.currentTimeMillis();
      if ((time - missingDownstreamJob.statusModifiedTime) > maxStartTime) {
        throw new TimeoutException("Missing downstream job");
      }
    }
    long elapsedTime=System.currentTimeMillis() - startTime;
    if ((elapsedTime > maxStartTime) && (getDownstreamJobCount("starting") > 0)) {
      throw new TimeoutException("Unable to find downstream job");
    }
 else     if ((elapsedTime > maxWaitTime) && (getDownstreamJobCount("completed") < _downstreamJobs.size())) {
      throw new TimeoutException("Timed out downstream job");
    }
 else     if (getDownstreamJobCount("completed") == _downstreamJobs.size()) {
      break;
    }
 else {
      Thread.sleep(sleepTime);
    }
  }
}
