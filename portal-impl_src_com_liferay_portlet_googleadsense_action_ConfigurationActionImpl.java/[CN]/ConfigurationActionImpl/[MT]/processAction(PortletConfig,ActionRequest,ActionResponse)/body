{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  int adFormat=ParamUtil.getInteger(req,"adFormat");
  int adType=ParamUtil.getInteger(req,"adType");
  String adClient=ParamUtil.getString(req,"adClient");
  String adChannel=ParamUtil.getString(req,"adChannel");
  String colorBorder=ParamUtil.getString(req,"colorBorder");
  String colorBg=ParamUtil.getString(req,"colorBg");
  String colorLink=ParamUtil.getString(req,"colorLink");
  String colorText=ParamUtil.getString(req,"colorText");
  String colorUrl=ParamUtil.getString(req,"colorUrl");
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("ad-format",String.valueOf(adFormat));
  prefs.setValue("ad-type",String.valueOf(adType));
  prefs.setValue("ad-client",adClient);
  prefs.setValue("ad-channel",adChannel);
  prefs.setValue("color-border",colorBorder);
  prefs.setValue("color-bg",colorBg);
  prefs.setValue("color-link",colorLink);
  prefs.setValue("color-text",colorText);
  prefs.setValue("color-url",colorUrl);
  prefs.store();
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
