{
  if (System.getProperty("external-properties") == null) {
    System.setProperty("external-properties","portal-test.properties");
  }
  InitUtil.initWithSpring();
  try {
    PortalInstances.addCompanyId(TestPropsValues.getCompanyId());
    PrincipalThreadLocal.setName(TestPropsValues.getUserId());
    User user=UserLocalServiceUtil.getUserById(TestPropsValues.getUserId());
    PermissionChecker permissionChecker=PermissionCheckerFactoryUtil.create(user,true);
    PermissionThreadLocal.setPermissionChecker(permissionChecker);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
