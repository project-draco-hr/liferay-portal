{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  try {
    WikiPage page=ActionUtil.getPage(portletRequest);
    PortletURL portletURL=PortalUtil.getControlPanelPortletURL(portletRequest,WikiPortletKeys.WIKI_ADMIN,PortletRequest.ACTION_PHASE);
    portletURL.setParameter(ActionRequest.ACTION_NAME,"/wiki/edit_page");
    if (isSubscribed(portletRequest,page)) {
      portletURL.setParameter(Constants.CMD,Constants.UNSUBSCRIBE);
    }
 else {
      portletURL.setParameter(Constants.CMD,Constants.SUBSCRIBE);
    }
    portletURL.setParameter("redirect",themeDisplay.getURLCurrent());
    portletURL.setParameter("nodeId",String.valueOf(page.getNodeId()));
    portletURL.setParameter("title",page.getTitle());
    return portletURL.toString();
  }
 catch (  Exception e) {
  }
  return StringPool.BLANK;
}
