{
  Set<String> userAttributes=null;
  try {
    Portlet portlet=_getPortlet(portletName);
    userAttributes=portlet.getPortletApp().getUserAttributes();
  }
 catch (  Exception e) {
    _log.error(e.getMessage(),e);
  }
  if ((userAttributes == null) || userAttributes.isEmpty()) {
    return Collections.EMPTY_LIST;
  }
  ProfileMapManagerImpl profileMapManager=new ProfileMapManagerImpl();
  Map<String,String> portletMap=null;
  try {
    portletMap=profileMapManager.getPortletMap();
  }
 catch (  ProducerException ex) {
    _log.warn(ex.getMessage(),ex);
    return Collections.EMPTY_LIST;
  }
  List<ItemDescription> userProfiles=new ArrayList<ItemDescription>();
  String resourcePrefix=portletName + SEPARATOR + USERINFO_DESCRIPTION+ SEPARATOR;
  int i=0;
  Iterator<String> iterator=userAttributes.iterator();
  while (iterator.hasNext()) {
    String userAttribute=iterator.next();
    String wsrpAttribute=portletMap.get(userAttribute);
    if (wsrpAttribute != null) {
      LocalizedString localizedString=new LocalizedString();
      localizedString.setLang(WSRPUtility.toXMLLang(getDefaultLocale().toString()));
      localizedString.setResourceName(resourcePrefix + userAttribute + SEPARATOR+ i);
      localizedString.setValue(wsrpAttribute);
      ItemDescription itemDescription=new ItemDescription();
      itemDescription.setDescription(localizedString);
      itemDescription.setItemName(wsrpAttribute);
      userProfiles.add(itemDescription);
      i++;
    }
  }
  return userProfiles;
}
