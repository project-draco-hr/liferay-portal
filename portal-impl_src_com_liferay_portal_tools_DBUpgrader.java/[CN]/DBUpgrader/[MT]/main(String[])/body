{
  try {
    StopWatch stopWatch=new StopWatch();
    stopWatch.start();
    InitUtil.initWithSpring(true,false);
    upgrade();
    verify();
    Registry registry=RegistryUtil.getRegistry();
    Map<String,Object> properties=new HashMap<>();
    properties.put("module.service.lifecycle","database.initialized");
    properties.put("service.vendor",ReleaseInfo.getVendor());
    properties.put("service.version",ReleaseInfo.getVersion());
    registry.registerService(ModuleServiceLifecycle.class,new ModuleServiceLifecycle(){
    }
,properties);
    InitUtil.registerContext();
    properties=new HashMap<>();
    properties.put("module.service.lifecycle","portal.initialized");
    properties.put("service.vendor",ReleaseInfo.getVendor());
    properties.put("service.version",ReleaseInfo.getVersion());
    registry.registerService(ModuleServiceLifecycle.class,new ModuleServiceLifecycle(){
    }
,properties);
    System.out.println("\nCompleted Liferay core upgrade and verify processes in " + (stopWatch.getTime() / Time.SECOND) + " seconds");
    System.out.println("Running modules upgrades. Connect to Gogo shell to check " + "the status.");
  }
 catch (  Exception e) {
    e.printStackTrace();
    System.exit(1);
  }
}
