{
  CacheRegistry.setActive(false);
  int buildNumber=ReleaseLocalServiceUtil.getBuildNumberOrCreate();
  if (buildNumber < ReleaseInfo.RELEASE_4_2_1_BUILD_NUMBER) {
    String msg="You must first upgrade to Liferay Portal 4.2.1";
    System.out.println(msg);
    throw new RuntimeException(msg);
  }
  StartupHelperUtil.upgradeProcess(buildNumber);
  ClassNameLocalServiceUtil.checkClassNames();
  ResourceActionsUtil.init();
  ResourceActionLocalServiceUtil.checkResourceActions();
  ResourceCodeLocalServiceUtil.checkResourceCodes();
  _deleteTempImages();
  if (StartupHelperUtil.isUpgraded()) {
    MultiVMPoolUtil.clear();
  }
}
