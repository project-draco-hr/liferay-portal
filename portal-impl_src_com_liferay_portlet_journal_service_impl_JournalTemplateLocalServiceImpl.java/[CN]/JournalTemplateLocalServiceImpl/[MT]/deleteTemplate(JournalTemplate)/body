{
  Group companyGroup=groupLocalService.getCompanyGroup(template.getCompanyId());
  if (template.getGroupId() == companyGroup.getGroupId()) {
    int count=journalArticlePersistence.countByTemplateId(template.getTemplateId());
    if (count > 0) {
      throw new RequiredTemplateException();
    }
  }
 else {
    int count=journalArticlePersistence.countByG_C_T(template.getGroupId(),0,template.getTemplateId());
    if (count > 0) {
      throw new RequiredTemplateException();
    }
  }
  webDAVPropsLocalService.deleteWebDAVProps(JournalTemplate.class.getName(),template.getId());
  imageLocalService.deleteImage(template.getSmallImageId());
  expandoValueLocalService.deleteValues(JournalTemplate.class.getName(),template.getId());
  resourceLocalService.deleteResource(template.getCompanyId(),JournalTemplate.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,template.getId());
  journalArticleLocalService.updateTemplateId(template.getGroupId(),PortalUtil.getClassNameId(JournalStructure.class.getName()),template.getTemplateId(),StringPool.BLANK);
  journalTemplatePersistence.remove(template);
}
