{
  Group companyGroup=groupLocalService.getCompanyGroup(template.getCompanyId());
  if (companyGroup.getGroupId() == template.getGroupId()) {
    if (journalArticlePersistence.countByTemplateId(template.getTemplateId()) > 0) {
      throw new RequiredTemplateException();
    }
  }
 else {
    if (journalArticlePersistence.countByG_C_T(template.getGroupId(),0,template.getTemplateId()) > 0) {
      throw new RequiredTemplateException();
    }
  }
  webDAVPropsLocalService.deleteWebDAVProps(JournalTemplate.class.getName(),template.getId());
  imageLocalService.deleteImage(template.getSmallImageId());
  expandoValueLocalService.deleteValues(JournalTemplate.class.getName(),template.getId());
  resourceLocalService.deleteResource(template.getCompanyId(),JournalTemplate.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,template.getId());
  journalArticleLocalService.updateTemplateId(template.getGroupId(),PortalUtil.getClassNameId(JournalStructure.class.getName()),template.getTemplateId(),StringPool.BLANK);
  journalTemplatePersistence.remove(template);
}
