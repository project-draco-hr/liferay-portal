{
  int articleCount=0;
  JournalMirageTemplate journalMirageTemplate=new JournalMirageTemplate(template);
  OptionalJournalTemplateCriteria criteria=new OptionalJournalTemplateCriteria(OptionalJournalTemplateCriteria.ARTICLE_COUNT_BY_GROUP_AND_TEMPLATE);
  ContentTypeService contentTypeService=MirageServiceFactory.getContentTypeService();
  try {
    articleCount=contentTypeService.getTemplatesCount(null,journalMirageTemplate,criteria);
  }
 catch (  CMSException cmse) {
    _throwSystemException(cmse);
  }
  if (articleCount > 0) {
    throw new RequiredTemplateException();
  }
  imageLocalService.deleteImage(template.getSmallImageId());
  webDAVPropsLocalService.deleteWebDAVProps(JournalTemplate.class.getName(),template.getPrimaryKey());
  resourceLocalService.deleteResource(template.getCompanyId(),JournalTemplate.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,template.getId());
  try {
    contentTypeService.deleteTemplateOfContentType(null,journalMirageTemplate);
  }
 catch (  CMSException cmse) {
    _throwException(cmse);
  }
}
