{
  JournalTemplate template=new JournalTemplateImpl();
  JournalMirageTemplate mirageTemplate=new JournalMirageTemplate(template);
  JournalMirageTemplate.CreationAttributes creationAttributes=mirageTemplate.new CreationAttributes(formatXsl,autoTemplateId,smallFile);
  mirageTemplate.setCreationAttributes(creationAttributes);
  template.setTemplateId(templateId);
  template.setUserId(userId);
  template.setLangType(langType);
  template.setXsl(xsl);
  template.setGroupId(groupId);
  template.setName(name);
  template.setDescription(description);
  template.setSmallImage(smallImage);
  template.setSmallImageURL(smallImageURL);
  template.setUuid(uuid);
  template.setStructureId(structureId);
  template.setCacheable(cacheable);
  ContentTypeService contentTypeService=MirageServiceFactory.getContentTypeService();
  try {
    contentTypeService.addTemplateToContentType(mirageTemplate,null);
  }
 catch (  CMSException cmse) {
    _throwException(cmse);
  }
catch (  ValidationException ve) {
  }
  template=mirageTemplate.getTemplate();
  if ((addCommunityPermissions != null) && (addGuestPermissions != null)) {
    addTemplateResources(template,addCommunityPermissions.booleanValue(),addGuestPermissions.booleanValue());
  }
 else {
    addTemplateResources(template,communityPermissions,guestPermissions);
  }
  return template;
}
