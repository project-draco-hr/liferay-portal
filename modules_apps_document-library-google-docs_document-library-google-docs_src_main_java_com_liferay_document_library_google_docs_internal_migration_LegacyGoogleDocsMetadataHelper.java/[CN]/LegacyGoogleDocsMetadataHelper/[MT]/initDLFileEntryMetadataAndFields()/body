{
  if (_fields != null) {
    return;
  }
  if (_dlFileVersion == null) {
    return;
  }
  _fields=new HashMap<>();
  try {
    _dlFileEntryMetadata=DLFileEntryMetadataLocalServiceUtil.getFileEntryMetadata(_ddmStructure.getStructureId(),_dlFileVersion.getFileVersionId());
    DDMFormValues ddmFormValues=_storageEngine.getDDMFormValues(_dlFileEntryMetadata.getDDMStorageId());
    Fields fields=_ddmFormValuesToFieldsConverter.convert(_ddmStructureLocalService.getDDMStructure(_ddmStructure.getStructureId()),ddmFormValues);
    for (    Field field : fields) {
      _fields.put(field.getName(),field);
    }
  }
 catch (  PortalException pe) {
    throw new SystemException("Unable to load DDM fields for file version " + _dlFileVersion.getFileVersionId(),pe);
  }
}
