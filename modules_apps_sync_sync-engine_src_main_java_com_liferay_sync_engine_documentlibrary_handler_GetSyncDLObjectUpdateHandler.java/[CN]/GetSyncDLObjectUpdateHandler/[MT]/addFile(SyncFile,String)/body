{
  Path filePath=Paths.get(filePathName);
  if (isParentUnsynced(syncFile)) {
    if (syncFile.isFolder()) {
      syncFile.setFilePathName(filePath.toString());
      syncFile.setModifiedTime(0);
      syncFile.setState(SyncFile.STATE_UNSYNCED);
      syncFile.setSyncAccountId(getSyncAccountId());
      syncFile.setUiEvent(SyncFile.UI_EVENT_NONE);
      SyncFileService.update(syncFile);
    }
    return;
  }
  if (Files.exists(filePath) && (syncFile.isFolder() || !FileUtil.isModified(syncFile,filePath))) {
    return;
  }
  syncFile.setFilePathName(filePathName);
  syncFile.setSyncAccountId(getSyncAccountId());
  if (syncFile.isFolder()) {
    Files.createDirectories(filePath);
    syncFile.setState(SyncFile.STATE_SYNCED);
    syncFile.setUiEvent(SyncFile.UI_EVENT_ADDED_REMOTE);
    SyncFileService.update(syncFile);
    FileKeyUtil.writeFileKey(filePath,String.valueOf(syncFile.getSyncFileId()),false);
  }
 else {
    syncFile.setUiEvent(SyncFile.UI_EVENT_DOWNLOADING);
    SyncFileService.update(syncFile);
    downloadFile(syncFile,null,0,false);
  }
}
