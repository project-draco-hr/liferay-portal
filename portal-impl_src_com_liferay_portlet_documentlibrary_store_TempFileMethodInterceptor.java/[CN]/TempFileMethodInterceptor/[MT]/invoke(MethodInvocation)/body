{
  Object result=methodInvocation.proceed();
  if (result instanceof InputStream) {
    InputStream inputStream=(InputStream)result;
    File tempFile=FileUtil.createTempFile(inputStream);
    result=new FileInputStream(tempFile);
    FinalizeManager.register(result,new DeleteFileFinalizeAction(tempFile.getAbsolutePath()),FinalizeManager.PHANTOM_REFERENCE_FACTORY);
  }
  return result;
}
