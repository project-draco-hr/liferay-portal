{
  byte[] data=new byte[8];
  int length=0;
  while (length < 8) {
    int count=inputStream.read(data,length,8 - length);
    if (count < 0) {
      throw new EOFException();
    }
    length+=count;
  }
  long receipt=BigEndianCodec.getLong(data,0);
  ByteBuffer byteBuffer=MailboxUtil.receiveMail(receipt);
  if (byteBuffer == null) {
    throw new IllegalArgumentException("No mail with receipt " + receipt);
  }
  Deserializer deserializer=new Deserializer(byteBuffer);
  ClassLoader contextClassLoader=ClassLoaderUtil.getContextClassLoader();
  try {
    String servletContextName=deserializer.readString();
    ClassLoader classLoader=ClassLoaderPool.getClassLoader(servletContextName);
    ClassLoaderUtil.setContextClassLoader(classLoader);
    return deserializer.readObject();
  }
 catch (  ClassNotFoundException cnfe) {
    throw new IOException(cnfe);
  }
 finally {
    ClassLoaderUtil.setContextClassLoader(contextClassLoader);
  }
}
