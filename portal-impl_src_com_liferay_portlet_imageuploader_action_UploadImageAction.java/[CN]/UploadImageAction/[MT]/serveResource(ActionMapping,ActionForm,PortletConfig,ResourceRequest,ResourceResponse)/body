{
  try {
    String cmd=ParamUtil.getString(resourceRequest,Constants.CMD);
    if (cmd.equals(Constants.GET_TEMP)) {
      FileEntry tempFileEntry=getTempImageFileEntry(resourceRequest);
      InputStream inputStream=tempFileEntry.getContentStream();
      PushbackInputStream pbis=new PushbackInputStream(inputStream,3);
      byte[] magicBytes=new byte[3];
      pbis.read(magicBytes);
      pbis.unread(magicBytes);
      inputStream=pbis;
      if (ArrayUtil.containsAll(_flashMagicBytes[0],magicBytes) || ArrayUtil.containsAll(_flashMagicBytes[1],magicBytes) || ArrayUtil.containsAll(_flashMagicBytes[2],magicBytes)) {
        return;
      }
      serveTempImageFile(resourceResponse,tempFileEntry.getContentStream());
    }
  }
 catch (  NoSuchFileEntryException nsfee) {
  }
catch (  Exception e) {
    _log.error(e);
  }
}
