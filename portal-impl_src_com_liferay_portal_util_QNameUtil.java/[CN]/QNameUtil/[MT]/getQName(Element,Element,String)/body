{
  if ((qNameEl == null) && (nameEl == null)) {
    _log.error("both qname and name elements are null");
    return null;
  }
  if (qNameEl == null) {
    return new QName(defaultNamespace,nameEl.getTextTrim());
  }
  String localPart=qNameEl.getTextTrim();
  List<Namespace> namespaces=qNameEl.declaredNamespaces();
  if (namespaces.size() == 0) {
    _log.error("qname " + localPart + " does not have a namespace");
    return null;
  }
  Namespace namespace=namespaces.get(0);
  String uri=namespace.getURI();
  String prefix=namespace.getPrefix();
  if (localPart.startsWith(prefix + StringPool.COLON)) {
    localPart=localPart.substring(prefix.length() + 1);
  }
 else {
    if (_log.isWarnEnabled()) {
      _log.warn("qname " + localPart + " is not correctly namespaced");
    }
  }
  return new QName(uri,localPart,prefix);
}
