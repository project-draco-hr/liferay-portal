{
  boolean webServerForwardedHostEnabled=PropsValues.WEB_SERVER_FORWARDED_HOST_ENABLED;
  String webServerForwardedHostHeader=PropsValues.WEB_SERVER_FORWARDED_HOST_HEADER;
  try {
    setPropsValuesValue("WEB_SERVER_FORWARDED_HOST_ENABLED",true);
    setPropsValuesValue("WEB_SERVER_FORWARDED_HOST_HEADER","X-Forwarded-Custom-Host");
    MockHttpServletRequest mockHttpServletRequest=new MockHttpServletRequest();
    mockHttpServletRequest.addHeader("X-Forwarded-Custom-Host","forwardedServer");
    mockHttpServletRequest.setServerName("serverName");
    Assert.assertEquals("forwardedServer",_portalImpl.getForwardedHost(mockHttpServletRequest));
  }
  finally {
    setPropsValuesValue("WEB_SERVER_FORWARDED_HOST_ENABLED",webServerForwardedHostEnabled);
    setPropsValuesValue("WEB_SERVER_FORWARDED_HOST_HEADER",webServerForwardedHostHeader);
  }
}
