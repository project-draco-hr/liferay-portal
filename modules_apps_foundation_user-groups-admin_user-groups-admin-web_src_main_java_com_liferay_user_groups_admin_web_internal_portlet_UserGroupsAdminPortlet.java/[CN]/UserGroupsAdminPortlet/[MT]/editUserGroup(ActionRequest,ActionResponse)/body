{
  long userGroupId=ParamUtil.getLong(actionRequest,"userGroupId");
  String name=ParamUtil.getString(actionRequest,"name");
  String description=ParamUtil.getString(actionRequest,"description");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(UserGroup.class.getName(),actionRequest);
  UserGroup userGroup=null;
  try (ProxyModeThreadLocalCloseable proxyModeThreadLocalCloseable=new ProxyModeThreadLocalCloseable()){
    ProxyModeThreadLocal.setForceSync(true);
    if (userGroupId <= 0) {
      userGroup=_userGroupService.addUserGroup(name,description,serviceContext);
    }
 else {
      userGroup=_userGroupService.updateUserGroup(userGroupId,name,description,serviceContext);
    }
  }
   long publicLayoutSetPrototypeId=ParamUtil.getLong(actionRequest,"publicLayoutSetPrototypeId");
  long privateLayoutSetPrototypeId=ParamUtil.getLong(actionRequest,"privateLayoutSetPrototypeId");
  boolean publicLayoutSetPrototypeLinkEnabled=ParamUtil.getBoolean(actionRequest,"publicLayoutSetPrototypeLinkEnabled");
  boolean privateLayoutSetPrototypeLinkEnabled=ParamUtil.getBoolean(actionRequest,"privateLayoutSetPrototypeLinkEnabled");
  if ((privateLayoutSetPrototypeId > 0) || (publicLayoutSetPrototypeId > 0)) {
    SitesUtil.updateLayoutSetPrototypesLinks(userGroup.getGroup(),publicLayoutSetPrototypeId,privateLayoutSetPrototypeId,publicLayoutSetPrototypeLinkEnabled,privateLayoutSetPrototypeLinkEnabled);
  }
}
