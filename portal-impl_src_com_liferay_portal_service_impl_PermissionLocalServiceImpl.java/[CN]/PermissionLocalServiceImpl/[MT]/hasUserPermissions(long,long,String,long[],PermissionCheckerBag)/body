{
  StopWatch stopWatch=null;
  if (_log.isDebugEnabled()) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  int block=1;
  if ((Validator.isNull(actionId)) || (resourceIds == null) || (resourceIds.length == 0)) {
    return false;
  }
  List permissions=permissionFinder.findByA_R(actionId,resourceIds);
  if (permissions.size() == 0) {
    return false;
  }
  long resourceId=resourceIds[0];
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  List userGroups=permissionCheckerBag.getUserGroups();
  List userOrgs=permissionCheckerBag.getUserOrgs();
  List groups=permissionCheckerBag.getGroups();
  List roles=permissionCheckerBag.getRoles();
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 1) {
    return hasUserPermissions_1(userId,actionId,resourceId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 2) {
    return hasUserPermissions_2(userId,actionId,resourceId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 3) {
    return hasUserPermissions_3(userId,actionId,resourceId,permissions,groups,roles,stopWatch,block);
  }
 else   if (PermissionCheckerImpl.USER_CHECK_ALGORITHM == 4) {
    return hasUserPermissions_4(userId,actionId,resourceId,permissions,groups,roles,stopWatch,block);
  }
  return false;
}
