{
  Role fromRole=rolePersistence.findByPrimaryKey(fromRoleId);
  Role toRole=rolePersistence.findByPrimaryKey(toRoleId);
  if (fromRole.getType() != toRole.getType()) {
    throw new PortalException("Role types are mismatched");
  }
 else   if (PortalUtil.isSystemRole(toRole.getName())) {
    throw new PortalException("Cannot move permissions to system role");
  }
 else   if (PortalUtil.isSystemRole(fromRole.getName())) {
    throw new PortalException("Cannot move permissions from system role");
  }
  List<Permission> permissions=getRolePermissions(fromRoleId);
  for (  Permission permission : permissions) {
    rolePersistence.addPermission(toRoleId,permission);
    rolePersistence.removePermission(fromRoleId,permission);
  }
  roleLocalService.deleteRole(fromRoleId);
  PermissionCacheUtil.clearCache();
}
