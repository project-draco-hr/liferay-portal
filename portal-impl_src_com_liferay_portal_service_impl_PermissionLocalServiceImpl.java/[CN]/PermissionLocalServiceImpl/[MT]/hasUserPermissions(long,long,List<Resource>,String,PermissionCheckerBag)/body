{
  StopWatch stopWatch=null;
  if (_log.isDebugEnabled()) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  int block=1;
  if (Validator.isNull(actionId) || resources.isEmpty()) {
    return false;
  }
  long[] resourceIds=null;
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM != 6) {
    resourceIds=new long[resources.size()];
    for (int i=0; i < resources.size(); i++) {
      Resource resource=resources.get(i);
      resourceIds[i]=resource.getResourceId();
    }
  }
  List<Permission> permissions=null;
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM != 6) {
    permissions=permissionFinder.findByA_R(actionId,resourceIds);
    if (permissions.size() == 0) {
      return false;
    }
  }
  long resourceId=0;
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM != 6) {
    resourceId=resourceIds[0];
  }
 else {
    resourceId=resources.get(0).getResourceId();
  }
  logHasUserPermissions(userId,resourceId,actionId,stopWatch,block++);
  List<Group> groups=permissionCheckerBag.getGroups();
  List<Role> roles=permissionCheckerBag.getRoles();
  long[] roleIds=permissionCheckerBag.getRoleIds();
  logHasUserPermissions(userId,resourceId,actionId,stopWatch,block++);
  logHasUserPermissions(userId,resourceId,actionId,stopWatch,block++);
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 1) {
    return hasUserPermissions_1(userId,resourceId,actionId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 2) {
    return hasUserPermissions_2(userId,resourceId,actionId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 3) {
    return hasUserPermissions_3(userId,resourceId,actionId,permissions,groups,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 4) {
    return hasUserPermissions_4(userId,resourceId,actionId,permissions,groups,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 5) {
    return hasUserPermissions_5(userId,resourceId,actionId,permissions,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
    return hasUserPermissions_6(userId,resourceId,resources,actionId,roleIds,stopWatch,block);
  }
  return false;
}
