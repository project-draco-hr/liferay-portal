{
  StopWatch stopWatch=null;
  if (_log.isDebugEnabled()) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  int block=1;
  if ((Validator.isNull(actionId)) || (resourceIds == null) || (resourceIds.length == 0)) {
    return false;
  }
  List<Permission> permissions=null;
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM != 6) {
    permissions=permissionFinder.findByA_R(actionId,resourceIds);
    if (permissions.size() == 0) {
      return false;
    }
  }
  long resourceId=resourceIds[0];
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  List<Group> groups=permissionCheckerBag.getGroups();
  List<Role> roles=permissionCheckerBag.getRoles();
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  logHasUserPermissions(userId,actionId,resourceId,stopWatch,block++);
  if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 1) {
    return hasUserPermissions_1(userId,actionId,resourceId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 2) {
    return hasUserPermissions_2(userId,actionId,resourceId,permissions,groups,groupId,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 3) {
    return hasUserPermissions_3(userId,actionId,resourceId,permissions,groups,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 4) {
    return hasUserPermissions_4(userId,actionId,resourceId,permissions,groups,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 5) {
    return hasUserPermissions_5(userId,actionId,resourceId,permissions,roles,stopWatch,block);
  }
 else   if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
    return hasUserPermissions_6(userId,actionId,name,resourceId,permissions,roles,stopWatch,block);
  }
  return false;
}
