{
  Class<?>[] parameterTypes=method.getParameterTypes();
  Class<?>[] expectedTypes=new Class<?>[]{long.class,int.class,com.liferay.portlet.PortalPreferences.class};
  if (_testThread.get() && method.getName().equals("updatePreferences") && Arrays.equals(parameterTypes,expectedTypes)) {
    if (_synchronize.get()) {
      _cyclicBarrier.await();
      SynchronizedTransactionExecutor.synchronize(true);
      _synchronize.set(false);
    }
  }
  return method.invoke(_target,args);
}
