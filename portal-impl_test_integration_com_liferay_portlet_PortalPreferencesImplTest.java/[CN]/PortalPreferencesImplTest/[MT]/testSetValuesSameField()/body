{
  Thread thread1=new Thread(new Runnable(){
    @Override public void run(){
      PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(PortletKeys.PREFS_OWNER_ID_DEFAULT,true);
      portalPreferences.setValues(_NAMESPACE,_KEY_1,_VALUES_1);
    }
  }
);
  Thread thread2=new Thread(new Runnable(){
    @Override public void run(){
      PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(PortletKeys.PREFS_OWNER_ID_DEFAULT,true);
      portalPreferences.setValues(_NAMESPACE,_KEY_1,_VALUES_2);
    }
  }
);
  try (CaptureAppender captureAppender=Log4JLoggerTestUtil.configureLog4JLogger(DefaultTransactionExecutor.class.getName(),Level.ERROR)){
    doSynchronousUpdate(thread1,thread2,captureAppender);
    PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(PortletKeys.PREFS_OWNER_ID_DEFAULT,true);
    String[] value=portalPreferences.getValues(_NAMESPACE,_KEY_1);
    if (!Arrays.equals(value,_VALUES_1) && !Arrays.equals(value,_VALUES_2)) {
      Assert.fail();
    }
  }
 }
