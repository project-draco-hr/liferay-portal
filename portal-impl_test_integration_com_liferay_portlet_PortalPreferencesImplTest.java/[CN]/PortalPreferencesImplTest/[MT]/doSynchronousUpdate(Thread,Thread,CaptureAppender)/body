{
  SynchronousInvocationHandler.synchronize(true);
  thread1.start();
  thread2.start();
  thread1.join();
  thread2.join();
  SynchronousInvocationHandler.synchronize(false);
  List<LoggingEvent> loggingEvents=captureAppender.getLoggingEvents();
  Assert.assertEquals(1,loggingEvents.size());
  LoggingEvent loggingEvent=loggingEvents.get(0);
  Assert.assertEquals("Application exception overridden by commit exception",loggingEvent.getMessage());
  FinderCacheUtil.clearLocalCache();
  EntityCacheUtil.clearLocalCache();
}
