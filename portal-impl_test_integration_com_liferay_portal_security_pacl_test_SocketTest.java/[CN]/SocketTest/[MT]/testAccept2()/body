{
  try {
    ServerSocket serverSocket=new ServerSocket(4316);
    serverSocket.setSoTimeout(50);
    try {
      Runnable runnable=new Runnable(){
        @Override public void run(){
          Socket socket=new Socket();
          try {
            socket.setSoLinger(true,0);
            socket.bind(new InetSocketAddress("localhost",4321));
            socket.connect(new InetSocketAddress("localhost",4316),10);
          }
 catch (          Exception e) {
            throw new RuntimeException(e);
          }
 finally {
            try {
              socket.close();
            }
 catch (            Exception e) {
              throw new RuntimeException(e);
            }
          }
        }
      }
;
      Thread thread=new Thread(runnable);
      thread.start();
      Socket socket=serverSocket.accept();
      socket.close();
    }
  finally {
      serverSocket.close();
    }
    Assert.fail();
  }
 catch (  SecurityException se) {
  }
}
