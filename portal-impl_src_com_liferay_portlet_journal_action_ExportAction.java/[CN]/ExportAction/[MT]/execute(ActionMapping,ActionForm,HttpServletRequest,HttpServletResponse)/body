{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
    PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
    if (permissionChecker.isOmniadmin()) {
      long siteGroupId=ParamUtil.getLong(req,"siteGroupId",DEFAULT_SITE_GROUP_ID);
      long cmsGroupId=ParamUtil.getLong(req,"cmsGroupId",DEFAULT_CMS_GROUP_ID);
      _primaryKeys.clear();
      _primaryKeyCount=1500;
      ZipWriter zipWriter=new ZipWriter();
      List journalContentSearches=new ArrayList();
      insertDataImage(zipWriter);
      insertDataCMSLayout(siteGroupId,zipWriter,journalContentSearches);
      insertDataCMSContent(cmsGroupId,zipWriter,journalContentSearches);
      String fileName="journal.zip";
      ServletResponseUtil.sendFile(res,fileName,zipWriter.finish());
    }
    return null;
  }
 catch (  Exception e) {
    req.setAttribute(PageContext.EXCEPTION,e);
    return mapping.findForward(ActionConstants.COMMON_ERROR);
  }
}
