{
  DLSyncEvent dlSyncEvent=DLSyncEventLocalServiceUtil.addDLSyncEvent(event,type,typePK);
  final long modifiedTime=dlSyncEvent.getModifiedTime();
  TransactionCommitCallbackRegistryUtil.registerCallback(new Callable<Void>(){
    @Override public Void call() throws Exception {
      Message message=new Message();
      Map<String,Object> values=new HashMap<String,Object>(4);
      values.put("event",event);
      values.put("modifiedTime",modifiedTime);
      values.put("type",type);
      values.put("typePK",typePK);
      message.setValues(values);
      MessageBusUtil.sendMessage(DestinationNames.DOCUMENT_LIBRARY_SYNC_EVENT_PROCESSOR,message);
      return null;
    }
  }
);
}
