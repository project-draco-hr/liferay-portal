{
  if (assetEntry == null) {
    return;
  }
  SocialActivityCounter lastPopularityCounter=fetchLastCounter(assetEntry.getGroupId(),assetEntry.getClassNameId(),assetEntry.getClassPK(),SocialActivityCounterConstants.NAME_POPULARITY,SocialActivityCounterConstants.TYPE_ASSET);
  SocialActivityCounter lastContributionCounter=fetchLastCounter(assetEntry.getGroupId(),PortalUtil.getClassNameId(User.class.getName()),assetEntry.getUserId(),SocialActivityCounterConstants.NAME_CONTRIBUTION,SocialActivityCounterConstants.TYPE_CREATOR);
  if ((lastContributionCounter != null) && (lastPopularityCounter != null)) {
    int startPeriod=SocialCounterPeriodUtil.getStartPeriod();
    if (lastContributionCounter.getStartPeriod() != startPeriod) {
      lastContributionCounter=createNewCounterPeriod(lastContributionCounter);
    }
    lastContributionCounter.setTotalValue(lastContributionCounter.getTotalValue() - lastPopularityCounter.getTotalValue());
    if (lastPopularityCounter.getStartPeriod() == startPeriod) {
      lastContributionCounter.setCurrentValue(lastContributionCounter.getCurrentValue() - lastPopularityCounter.getCurrentValue());
    }
    socialActivityCounterPersistence.update(lastContributionCounter,false);
  }
  deleteActivityCounters(assetEntry.getClassNameId(),assetEntry.getClassPK());
  socialActivityLimitPersistence.removeByC_C(assetEntry.getClassNameId(),assetEntry.getClassPK());
}
