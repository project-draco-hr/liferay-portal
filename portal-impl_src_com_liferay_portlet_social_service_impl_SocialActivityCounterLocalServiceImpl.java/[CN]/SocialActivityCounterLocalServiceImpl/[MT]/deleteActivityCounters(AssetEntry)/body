{
  if (assetEntry == null) {
    return;
  }
  SocialActivityCounter latestContributionActivityCounter=fetchLatestActivityCounter(assetEntry.getGroupId(),PortalUtil.getClassNameId(User.class.getName()),assetEntry.getUserId(),SocialActivityCounterConstants.NAME_CONTRIBUTION,SocialActivityCounterConstants.TYPE_CREATOR);
  SocialActivityCounter latestPopularityActivityCounter=fetchLatestActivityCounter(assetEntry.getGroupId(),assetEntry.getClassNameId(),assetEntry.getClassPK(),SocialActivityCounterConstants.NAME_POPULARITY,SocialActivityCounterConstants.TYPE_ASSET);
  if ((latestContributionActivityCounter != null) && (latestPopularityActivityCounter != null)) {
    int startPeriod=SocialCounterPeriodUtil.getStartPeriod();
    if (latestContributionActivityCounter.getStartPeriod() != startPeriod) {
      latestContributionActivityCounter=addActivityCounter(latestContributionActivityCounter.getGroupId(),latestContributionActivityCounter.getClassNameId(),latestContributionActivityCounter.getClassPK(),latestContributionActivityCounter.getName(),latestContributionActivityCounter.getOwnerType(),0,latestContributionActivityCounter.getTotalValue(),SocialCounterPeriodUtil.getStartPeriod(),SocialActivityCounterConstants.END_PERIOD_UNDEFINED,latestContributionActivityCounter.getActivityCounterId(),SocialActivityCounterConstants.PERIOD_LENGTH_SYSTEM);
    }
    if (latestPopularityActivityCounter.getStartPeriod() == startPeriod) {
      latestContributionActivityCounter.setCurrentValue(latestContributionActivityCounter.getCurrentValue() - latestPopularityActivityCounter.getCurrentValue());
    }
    latestContributionActivityCounter.setTotalValue(latestContributionActivityCounter.getTotalValue() - latestPopularityActivityCounter.getTotalValue());
    socialActivityCounterPersistence.update(latestContributionActivityCounter,false);
  }
  deleteActivityCounters(assetEntry.getClassNameId(),assetEntry.getClassPK());
  socialActivityLimitPersistence.removeByC_C(assetEntry.getClassNameId(),assetEntry.getClassPK());
}
