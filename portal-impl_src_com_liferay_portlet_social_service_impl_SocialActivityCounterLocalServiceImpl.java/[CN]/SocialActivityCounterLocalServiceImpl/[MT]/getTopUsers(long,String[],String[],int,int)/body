{
  List<Tuple> topUsers=new ArrayList<Tuple>();
  List<Long> userIds=SocialActivityCounterFinderUtil.findU_ByG_N(groupId,rankingCounterNames,start,end);
  if (userIds.isEmpty()) {
    return topUsers;
  }
  List<SocialActivityCounter> activityCounters=SocialActivityCounterFinderUtil.findAC_By_G_C_C_N_S_E(groupId,userIds,selectedCounterNames,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  long userId=0;
  Map<String,SocialActivityCounter> counters=null;
  for (  SocialActivityCounter activityCounter : activityCounters) {
    if (userId != activityCounter.getClassPK()) {
      userId=activityCounter.getClassPK();
      counters=new HashMap<String,SocialActivityCounter>();
      topUsers.add(new Tuple(userId,counters));
    }
    counters.put(activityCounter.getName(),activityCounter);
  }
  return topUsers;
}
