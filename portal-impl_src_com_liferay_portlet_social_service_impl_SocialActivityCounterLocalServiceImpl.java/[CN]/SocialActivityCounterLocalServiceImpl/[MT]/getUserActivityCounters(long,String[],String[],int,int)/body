{
  List<Long> userIds=socialActivityCounterFinder.findU_ByG_N(groupId,rankingNames,start,end);
  if (userIds.isEmpty()) {
    return Collections.emptyList();
  }
  List<Tuple> userActivityCounters=new ArrayList<Tuple>();
  List<SocialActivityCounter> activityCounters=SocialActivityCounterFinderUtil.findAC_By_G_C_C_N_S_E(groupId,userIds,selectedNames,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  long userId=0;
  Map<String,SocialActivityCounter> activityCountersMap=null;
  for (  SocialActivityCounter activityCounter : activityCounters) {
    if (userId != activityCounter.getClassPK()) {
      userId=activityCounter.getClassPK();
      activityCountersMap=new HashMap<String,SocialActivityCounter>();
      Tuple userActivityCounter=new Tuple(userId,activityCountersMap);
      userActivityCounters.add(userActivityCounter);
    }
    activityCountersMap.put(activityCounter.getName(),activityCounter);
  }
  return userActivityCounters;
}
