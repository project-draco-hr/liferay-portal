{
  String lockKey=StringUtil.merge(new Object[]{groupId,classNameId,classPK,name,ownerType},StringPool.POUND);
  LockProtectedAction<SocialActivityCounter> lockProtectedAction=new LockProtectedAction<SocialActivityCounter>(SocialActivityCounter.class,lockKey,PropsValues.SOCIAL_ACTIVITY_LOCK_TIMEOUT,PropsValues.SOCIAL_ACTIVITY_LOCK_RETRY_DELAY){
    @Override protected SocialActivityCounter performProtectedAction() throws PortalException, SystemException {
      SocialActivityCounter activityCounter=socialActivityCounterLocalService.addActivityCounter(groupId,classNameId,classPK,name,ownerType,totalValue,previousActivityCounterId,periodLength);
      return activityCounter;
    }
  }
;
  lockProtectedAction.performAction();
  return lockProtectedAction.getReturnValue();
}
