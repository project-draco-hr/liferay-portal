{
  if (!socialActivitySettingLocalService.isEnabled(activity.getGroupId(),activity.getClassNameId())) {
    return;
  }
  User user=userPersistence.findByPrimaryKey(activity.getUserId());
  SocialActivityDefinition activityDefinition=socialActivitySettingLocalService.getActivityDefinition(activity.getGroupId(),activity.getClassName(),activity.getType());
  if ((activityDefinition == null) || (!activityDefinition.isCounterEnabled())) {
    return;
  }
  if (activityDefinition.getActivityProcessor() != null) {
    activityDefinition.getActivityProcessor().processActivity(activity);
  }
  for (  SocialActivityCounterDefinition activityCounterDefinition : activityDefinition.getActivityCounterDefinitions()) {
    if ((activityCounterDefinition.getIncrement() != 0) && (checkLimit(user,activity,activityCounterDefinition))) {
      incrementCounter(activity.getGroupId(),user,activity.getAssetEntry(),activityCounterDefinition);
    }
  }
  for (  SocialAchievement achievement : activityDefinition.getAchievements()) {
    achievement.processActivity(activity);
  }
  incrementCounter(activity.getGroupId(),activity.getClassNameId(),activity.getClassPK(),SocialActivityCounterConstants.NAME_ASSET_ACTIVITY,SocialActivityCounterConstants.TYPE_ASSET,1);
  incrementCounter(activity.getGroupId(),PortalUtil.getClassNameId(User.class.getName()),activity.getUserId(),SocialActivityCounterConstants.NAME_USER_ACTIVITY,SocialActivityCounterConstants.TYPE_ACTOR,1);
}
