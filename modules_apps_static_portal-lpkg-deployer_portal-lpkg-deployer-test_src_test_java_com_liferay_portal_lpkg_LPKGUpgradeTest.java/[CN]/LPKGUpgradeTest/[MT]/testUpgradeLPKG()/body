{
  try (DirectoryStream<Path> directoryStream=Files.newDirectoryStream(Paths.get(System.getProperty("liferay.home"),"/osgi/marketplace"))){
    for (    Path lpkgPath : directoryStream) {
      try (FileSystem fileSystem=FileSystems.newFileSystem(lpkgPath,null)){
        Path path=fileSystem.getPath("liferay-marketplace.properties");
        try (InputStream inputStream=Files.newInputStream(path)){
          String propertiesString=StringUtil.read(inputStream);
          Properties properties=new Properties();
          properties.load(new StringReader(propertiesString));
          String version=properties.getProperty("version");
          Matcher matcher=_pattern.matcher(version);
          if (matcher.matches()) {
            String newVersion=matcher.group(1);
            newVersion=newVersion.concat(String.valueOf(Integer.parseInt(matcher.group(2)) + 1));
            propertiesString=StringUtil.replace(propertiesString,"version=".concat(version),"version=".concat(newVersion));
            Files.write(path,propertiesString.getBytes(),StandardOpenOption.TRUNCATE_EXISTING,StandardOpenOption.WRITE);
          }
        }
       }
     }
  }
 }
