{
  if (_invalid) {
    throw new IllegalStateException();
  }
  if (scope == PortletSession.PORTLET_SCOPE) {
    List<String> attributeNames=new ArrayList<String>();
    String portletScope=getPortletScope(_portletName,_plid);
    int length=portletScope.length();
    Enumeration<String> enu=getHttpSession().getAttributeNames();
    while (enu.hasMoreElements()) {
      String name=enu.nextElement();
      if ((name.length() > length + 1) && (name.charAt(length) == CharPool.QUESTION) && name.startsWith(portletScope)) {
        attributeNames.add(name.substring(length + 1));
      }
    }
    return Collections.enumeration(attributeNames);
  }
 else {
    return getHttpSession().getAttributeNames();
  }
}
