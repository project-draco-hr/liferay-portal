{
  org.jgroups.Address sourceAddress=message.getSrc();
  Channel controlChannel=_clusterExecutorImpl.getControlChannel();
  org.jgroups.Address localAddress=controlChannel.getAddress();
  Object obj=message.getObject();
  if (obj == null) {
    if (_log.isWarnEnabled()) {
      _log.warn("Message content is null");
    }
    return;
  }
  if (localAddress.equals(sourceAddress)) {
    boolean isProcessed=processLocalMessage(obj,sourceAddress);
    if (isProcessed) {
      return;
    }
  }
  JGroupsTask jgroupsTask=new JGroupsTask(obj,sourceAddress,localAddress);
  if (obj instanceof ClusterRequest && ((ClusterRequest)obj).isParallelized()) {
    _parallelThreadPoolExecutor.execute(jgroupsTask);
  }
 else {
    _serialThreadPoolExecutor.execute(jgroupsTask);
  }
}
