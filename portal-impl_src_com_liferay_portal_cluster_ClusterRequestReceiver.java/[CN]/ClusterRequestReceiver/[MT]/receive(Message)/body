{
  org.jgroups.Address sourceAddress=message.getSrc();
  Channel controlChannel=_clusterExecutorImpl.getControlChannel();
  org.jgroups.Address localAddress=controlChannel.getAddress();
  Object obj=message.getObject();
  if (obj == null) {
    if (_log.isWarnEnabled()) {
      _log.warn("Message content is null");
    }
    return;
  }
  if (localAddress.equals(sourceAddress)) {
    boolean isProcessed=processLocalMessage(obj,sourceAddress);
    if (isProcessed) {
      return;
    }
  }
  if (obj instanceof ClusterRequest) {
    ClusterRequest clusterRequest=(ClusterRequest)obj;
    RequestTask requestTask=new RequestTask(clusterRequest,sourceAddress,localAddress);
    if (clusterRequest.isParallelized()) {
      _parallelExecutorService.execute(requestTask);
    }
 else {
      _serialExecutorService.execute(requestTask);
    }
  }
 else   if (obj instanceof ClusterNodeResponse) {
    ClusterNodeResponse clusterNodeResponse=(ClusterNodeResponse)obj;
    processClusterResponse(clusterNodeResponse,sourceAddress,localAddress);
  }
 else   if (_log.isWarnEnabled()) {
    _log.warn("Unable to process message content of type " + obj.getClass());
  }
}
