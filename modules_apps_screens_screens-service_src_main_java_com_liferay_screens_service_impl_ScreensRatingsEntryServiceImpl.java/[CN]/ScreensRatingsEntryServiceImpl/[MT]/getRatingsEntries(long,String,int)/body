{
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  List<RatingsEntry> ratingsEntries=ratingsEntryLocalService.getEntries(className,classPK);
  int[] ratings=new int[stepCount];
  double totalScore=0;
  long userId=getUserId();
  double userScore=-1;
  for (  RatingsEntry ratingsEntry : ratingsEntries) {
    int position=(int)(ratingsEntry.getScore() * stepCount);
    if (position == stepCount) {
      position--;
    }
    ratings[position]++;
    totalScore+=ratingsEntry.getScore();
    if (ratingsEntry.getUserId() == userId) {
      userScore=ratingsEntry.getScore();
    }
  }
  if (ratingsEntries.size() > 0) {
    jsonObject.put("average",totalScore / ratingsEntries.size());
  }
 else {
    jsonObject.put("average",0);
  }
  jsonObject.put("className",className);
  jsonObject.put("classPK",classPK);
  jsonObject.put("ratings",ratings);
  jsonObject.put("totalCount",ratingsEntries.size());
  jsonObject.put("totalScore",totalScore);
  jsonObject.put("userScore",userScore);
  return jsonObject;
}
