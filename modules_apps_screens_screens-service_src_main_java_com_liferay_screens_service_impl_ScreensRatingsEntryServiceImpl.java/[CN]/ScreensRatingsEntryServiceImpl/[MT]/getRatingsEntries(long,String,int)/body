{
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  jsonObject.put("className",className);
  jsonObject.put("classPK",classPK);
  List<RatingsEntry> entries=ratingsEntryLocalService.getEntries(className,classPK);
  int[] ratings=new int[stepCount];
  double totalScore=0;
  long userId=getUserId();
  double userScore=-1;
  for (  RatingsEntry entry : entries) {
    int position=(int)(entry.getScore() * stepCount);
    if (position == stepCount) {
      position--;
    }
    ratings[position]++;
    totalScore+=entry.getScore();
    if (entry.getUserId() == userId) {
      userScore=entry.getScore();
    }
  }
  if (entries.size() > 0) {
    jsonObject.put("average",totalScore / entries.size());
  }
 else {
    jsonObject.put("average",0);
  }
  jsonObject.put("ratings",ratings);
  jsonObject.put("totalCount",entries.size());
  jsonObject.put("totalScore",totalScore);
  jsonObject.put("userScore",userScore);
  return jsonObject;
}
