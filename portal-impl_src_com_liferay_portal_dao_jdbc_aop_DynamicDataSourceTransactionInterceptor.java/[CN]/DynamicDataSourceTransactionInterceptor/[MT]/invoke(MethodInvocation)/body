{
  if (_dynamicDataSourceTargetSource == null) {
    return super.invoke(methodInvocation);
  }
  Class<?> targetClass=null;
  if (methodInvocation.getThis() != null) {
    Object thisObject=methodInvocation.getThis();
    targetClass=thisObject.getClass();
  }
  Method targetMethod=methodInvocation.getMethod();
  TransactionAttributeSource transactionAttributeSource=getTransactionAttributeSource();
  TransactionAttribute transactionAttribute=transactionAttributeSource.getTransactionAttribute(targetMethod,targetClass);
  if ((transactionAttribute != null) && (transactionAttribute.isReadOnly())) {
    _dynamicDataSourceTargetSource.setOperation(Operation.READ);
  }
 else {
    _dynamicDataSourceTargetSource.setOperation(Operation.WRITE);
  }
  _dynamicDataSourceTargetSource.pushMethod(targetClass.getName().concat(StringPool.PERIOD).concat(targetMethod.getName()));
  Object returnValue=null;
  try {
    returnValue=super.invoke(methodInvocation);
  }
  finally {
    _dynamicDataSourceTargetSource.popMethod();
  }
  return returnValue;
}
