{
  try {
    String cmd=ParamUtil.getString(req,Constants.CMD);
    if (!cmd.equals(Constants.UPDATE)) {
      return;
    }
    long nodeId=ParamUtil.getLong(req,"nodeId");
    String title=ParamUtil.getString(req,"title");
    WikiNode node=WikiNodeServiceUtil.getNode(nodeId);
    String portletResource=ParamUtil.getString(req,"portletResource");
    PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource);
    prefs.setValue("node-id",String.valueOf(node.getNodeId()));
    prefs.setValue("title",title);
    prefs.store();
    SessionMessages.add(req,config.getPortletName() + ".doConfigure");
  }
 catch (  NoSuchNodeException nsne) {
    SessionErrors.add(req,nsne.getClass().getName());
  }
}
