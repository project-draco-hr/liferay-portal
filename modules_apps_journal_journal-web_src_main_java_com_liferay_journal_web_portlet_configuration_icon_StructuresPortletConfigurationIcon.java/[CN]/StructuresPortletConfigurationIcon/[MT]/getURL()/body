{
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  Portlet portlet=PortletLocalServiceUtil.getPortletById(portletDisplay.getId());
  PortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,PortletProviderUtil.getPortletId(DDMStructure.class.getName(),PortletProvider.Action.VIEW),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
  portletURL.setParameter("mvcPath","/view.jsp");
  portletURL.setParameter("groupId",String.valueOf(themeDisplay.getScopeGroupId()));
  portletURL.setParameter("redirect",themeDisplay.getURLCurrent());
  portletURL.setParameter("refererPortletName",JournalPortletKeys.JOURNAL);
  portletURL.setParameter("refererWebDAVToken",WebDAVUtil.getStorageToken(portlet));
  portletURL.setParameter("showAncestorScopes",Boolean.TRUE.toString());
  portletURL.setParameter("showManageTemplates",Boolean.TRUE.toString());
  return portletURL.toString();
}
