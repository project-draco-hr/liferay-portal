{
  List<Element> igReferenceElements=parentElement.elements("ig-reference");
  for (  Element igReferenceElement : igReferenceElements) {
    String igReferencePath=igReferenceElement.attributeValue("path");
    IGImage image=null;
    try {
      image=(IGImage)portletDataContext.getZipEntryAsObject(igReferencePath);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e);
      }
    }
    if (image == null) {
      continue;
    }
    image=IGImageUtil.fetchByUUID_G(image.getUuid(),portletDataContext.getGroupId());
    if (image == null) {
      continue;
    }
    String igReference="[$ig-reference=" + igReferencePath + "$]";
    StringBundler sb=new StringBundler(6);
    sb.append("/image/image_gallery?uuid=");
    sb.append(image.getUuid());
    sb.append("&groupId=");
    sb.append(portletDataContext.getScopeGroupId());
    sb.append("&t=");
    sb.append(System.currentTimeMillis());
    content=StringUtil.replace(content,igReference,sb.toString());
  }
  return content;
}
