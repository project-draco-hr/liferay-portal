{
  if (bufferSize == 0)   return;
  flushed=true;
  ensureOpen();
  if (buf.pos == buf.offset)   return;
  initOut();
  out.write(buf.buf,buf.offset,buf.pos - buf.offset);
  buf.pos=buf.offset;
}
