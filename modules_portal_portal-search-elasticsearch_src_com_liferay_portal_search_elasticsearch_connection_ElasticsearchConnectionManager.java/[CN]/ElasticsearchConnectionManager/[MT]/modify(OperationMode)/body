{
  if (Validator.equals(operationMode,_operationMode)) {
    return;
  }
  requirePresent(operationMode);
  ElasticsearchConnection newElasticsearchConnection=_elasticsearchConnections.get(operationMode);
  newElasticsearchConnection.connect();
  if (_operationMode != null) {
    ElasticsearchConnection oldElasticsearchConnection=_elasticsearchConnections.get(_operationMode);
    try {
      oldElasticsearchConnection.close();
    }
 catch (    Exception e) {
      if (_log.isErrorEnabled()) {
        _log.error("Unable to close: " + oldElasticsearchConnection,e);
      }
    }
  }
  _operationMode=operationMode;
}
