{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  long rootLayoutId=ParamUtil.getLong(actionRequest,"rootLayoutId");
  String displayDepth=ParamUtil.getString(actionRequest,"displayDepth");
  boolean includeRootInTree=ParamUtil.getBoolean(actionRequest,"includeRootInTree");
  boolean showCurrentPage=ParamUtil.getBoolean(actionRequest,"showCurrentPage");
  boolean useHtmlTitle=ParamUtil.getBoolean(actionRequest,"useHtmlTitle");
  boolean showHiddenPages=ParamUtil.getBoolean(actionRequest,"showHiddenPages");
  if (rootLayoutId == LayoutConstants.DEFAULT_PARENT_LAYOUT_ID) {
    includeRootInTree=false;
  }
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  PortletPreferences preferences=PortletPreferencesFactoryUtil.getPortletSetup(actionRequest,portletResource);
  preferences.setValue("root-layout-id",String.valueOf(rootLayoutId));
  preferences.setValue("display-depth",displayDepth);
  preferences.setValue("include-root-in-tree",String.valueOf(includeRootInTree));
  preferences.setValue("show-current-page",String.valueOf(showCurrentPage));
  preferences.setValue("use-html-title",String.valueOf(useHtmlTitle));
  preferences.setValue("show-hidden-pages",String.valueOf(showHiddenPages));
  preferences.store();
  SessionMessages.add(actionRequest,portletConfig.getPortletName() + ".doConfigure");
}
