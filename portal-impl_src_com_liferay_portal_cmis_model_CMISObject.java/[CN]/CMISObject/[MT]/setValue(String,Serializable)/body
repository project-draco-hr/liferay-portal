{
  Factory factory=getFactory();
  Element propertiesElement=getFirstChild(_cmisConstants.PROPERTIES);
  if (propertiesElement == null) {
    propertiesElement=factory.newElement(_cmisConstants.PROPERTIES);
    addExtension(propertiesElement);
  }
  Element propertyElement=null;
  if (propertyValue instanceof Date) {
    propertyElement=factory.newElement(_cmisConstants.PROPERTY_TYPE_DATETIME,propertiesElement);
    propertyValue=_dateFormat.format((Date)propertyValue);
  }
 else   if (propertyValue instanceof Double) {
    propertyElement=factory.newElement(_cmisConstants.PROPERTY_TYPE_DECIMAL,propertiesElement);
  }
 else   if (propertyValue instanceof Integer) {
    propertyElement=factory.newElement(_cmisConstants.PROPERTY_TYPE_INTEGER,propertiesElement);
  }
 else   if ((propertyValue.toString()).startsWith("http")) {
    propertyElement=factory.newElement(_cmisConstants.PROPERTY_TYPE_URI,propertiesElement);
  }
 else {
    propertyElement=factory.newElement(_cmisConstants.PROPERTY_TYPE_STRING,propertiesElement);
  }
  propertyElement.setAttributeValue(_cmisConstants.PROPERTY_NAME,propertyName);
  Element valueElement=factory.newElement(_cmisConstants.PROPERTY_VALUE,propertyElement);
  valueElement.setText(propertyValue.toString());
}
