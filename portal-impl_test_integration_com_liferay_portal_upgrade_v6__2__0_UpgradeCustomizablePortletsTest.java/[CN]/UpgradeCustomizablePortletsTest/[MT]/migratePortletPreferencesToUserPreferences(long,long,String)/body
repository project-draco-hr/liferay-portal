{
  String newPortletId=portletId;
  if (_invokeSuper) {
    newPortletId=super.migratePortletPreferencesToUserPreferences(userId,plid,portletId);
    _newPortletIds.add(newPortletId);
    return newPortletId;
  }
  if (!PortletConstants.hasInstanceId(portletId)) {
    _newPortletIds.add(portletId);
    return portletId;
  }
  String instanceId=PortletConstants.getInstanceId(portletId);
  newPortletId=PortletConstants.assemblePortletId(portletId,userId,instanceId);
  _newPortletIds.add(newPortletId);
  return newPortletId;
}
