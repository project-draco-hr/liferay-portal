{
  PortletPreferences portletPreferences=renderRequest.getPreferences();
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String nodeName=ParamUtil.getString(renderRequest,"nodeName");
  if (Validator.isNotNull(nodeName)) {
    return WikiNodeServiceUtil.getNode(themeDisplay.getScopeGroupId(),nodeName);
  }
 else {
    long nodeId=GetterUtil.getLong(portletPreferences.getValue("nodeId",StringPool.BLANK));
    return WikiNodeServiceUtil.getNode(nodeId);
  }
}
