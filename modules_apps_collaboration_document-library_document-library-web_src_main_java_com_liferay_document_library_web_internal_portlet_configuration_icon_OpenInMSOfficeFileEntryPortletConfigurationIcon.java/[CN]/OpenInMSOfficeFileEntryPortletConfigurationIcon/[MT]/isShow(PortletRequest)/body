{
  try {
    HttpServletRequest request=PortalUtil.getHttpServletRequest(portletRequest);
    FileEntry fileEntry=ActionUtil.getFileEntry(portletRequest);
    FileVersion fileVersion=ActionUtil.getFileVersion(portletRequest,fileEntry);
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    ResourceBundle resourceBundle=_resourceBundleLoader.loadResourceBundle(themeDisplay.getLanguageId());
    UIItemsBuilder uiItemsBuilder=new UIItemsBuilder(request,fileVersion,resourceBundle);
    return uiItemsBuilder.isOpenInMsOfficeActionAvailable();
  }
 catch (  Exception e) {
  }
  return false;
}
