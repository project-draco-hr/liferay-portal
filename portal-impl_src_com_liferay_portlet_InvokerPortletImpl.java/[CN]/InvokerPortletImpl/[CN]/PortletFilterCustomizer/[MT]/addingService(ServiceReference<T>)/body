{
  Registry registry=RegistryUtil.getRegistry();
  T portletFilter=registry.getService(serviceReference);
  String filterName=GetterUtil.getString(serviceReference.getProperty("service.pid"),portletFilter.getClass().getName());
  Map<String,String> initParams=new HashMap<String,String>();
  for (  String key : serviceReference.getPropertyKeys()) {
    String value=GetterUtil.getString(serviceReference.getProperty(key));
    initParams.put(key,value);
  }
  FilterConfig filterConfig=new FilterConfigImpl(filterName,_portletContext,initParams);
  try {
    portletFilter.init(filterConfig);
  }
 catch (  PortletException e) {
    _log.error(e,e);
    return null;
  }
  return portletFilter;
}
