{
  copyJars(srcFile);
  copyTlds(srcFile);
  updateGeronimoWebXML(srcFile,displayName);
  File webXML=new File(srcFile + "/WEB-INF/web.xml");
  updateWebXML(webXML,srcFile,displayName);
  if ((deployDir != null) && !baseDir.equals(destDir)) {
    String excludes=StringPool.BLANK;
    if (appServerType.equals("tomcat")) {
      String[] libs=FileUtil.listFiles(tomcatLibDir);
      for (int i=0; i < libs.length; i++) {
        excludes+="**/WEB-INF/lib/" + libs[i] + ",";
      }
    }
    if (!unpackWar || appServerType.equals("websphere")) {
      WarTask.war(srcFile,deployDir,"WEB-INF/web.xml",webXML);
    }
 else {
      excludes+="**/WEB-INF/web.xml";
      CopyTask.copyDirectory(srcFile,deployDir,StringPool.BLANK,excludes,overwrite,true);
      CopyTask.copyDirectory(srcFile,deployDir,"**/WEB-INF/web.xml",StringPool.BLANK,true,false);
      if (appServerType.equals("tomcat")) {
        File deployWebXML=new File(deployDir + "/WEB-INF/web.xml");
        deployWebXML.setLastModified(System.currentTimeMillis() + (Time.SECOND * 6));
      }
    }
  }
}
