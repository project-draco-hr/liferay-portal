{
  try {
    LiferayJSPWikiEngine engine=getEngine(page.getNodeId());
    com.ecyrd.jspwiki.WikiPage jspWikiPage=LiferayPageProvider.toJSPWikiPage(page,engine);
    Collection titles=engine.scanWikiLinks(jspWikiPage,page.getContent());
    Map links=new HashMap();
    Iterator itr=titles.iterator();
    while (itr.hasNext()) {
      String title=(String)itr.next();
      if (title.startsWith("[[")) {
        title=title.substring(2);
      }
 else       if (title.startsWith("[")) {
        title=title.substring(1);
      }
      if (title.endsWith("]]")) {
        title=title.substring(title.length() - 2,title.length());
      }
 else       if (title.startsWith("[")) {
        title=title.substring(title.length() - 1,title.length());
      }
      Boolean existsObj=(Boolean)links.get(title);
      if (existsObj == null) {
        if (WikiPageLocalServiceUtil.getPagesCount(page.getNodeId(),title,true) > 0) {
          existsObj=Boolean.TRUE;
        }
 else {
          existsObj=Boolean.FALSE;
        }
        links.put(title,existsObj);
      }
    }
    return links;
  }
 catch (  SystemException se) {
    throw new PageContentException(se);
  }
catch (  WikiException we) {
    throw new PageContentException(we);
  }
}
