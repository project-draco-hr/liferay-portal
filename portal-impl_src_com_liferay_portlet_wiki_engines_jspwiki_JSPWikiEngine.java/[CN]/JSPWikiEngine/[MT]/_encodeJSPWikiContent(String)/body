{
  StringBundler encodedContent=new StringBundler();
  Matcher commentMatcher=_wikiCommentPattern.matcher(content);
  int start=0;
  int end=0;
  while (commentMatcher.find()) {
    end=commentMatcher.start();
    String oldContent=content.substring(start,end);
    Matcher wikiLinkMatcher=_wikiLinkPattern.matcher(oldContent);
    encodedContent.append(_encodeLink(oldContent,wikiLinkMatcher));
    encodedContent.append(content.substring(commentMatcher.start(),commentMatcher.end()));
    start=commentMatcher.end();
  }
  if (start < content.length()) {
    content=content.substring(start);
    Matcher wikiLinkMatcher=_wikiLinkPattern.matcher(content);
    encodedContent.append(_encodeLink(content,wikiLinkMatcher));
  }
  return encodedContent.toString();
}
