{
  StringBundler encodedContent=new StringBundler();
  Matcher commentMatcher=_wikiCommentPattern.matcher(content);
  Matcher wikiLinkMatcher=null;
  int start=0;
  int end=0;
  String oldContent=StringPool.BLANK;
  String newContent=StringPool.BLANK;
  while (commentMatcher.find()) {
    end=commentMatcher.start();
    oldContent=content.substring(start,end);
    wikiLinkMatcher=_wikiLinkPattern.matcher(oldContent);
    newContent=oldContent;
    newContent=_encodeLink(newContent,wikiLinkMatcher);
    encodedContent.append(newContent);
    encodedContent.append(content.substring(commentMatcher.start(),commentMatcher.end()));
    start=commentMatcher.end();
  }
  if (start != content.length()) {
    oldContent=content.substring(start);
    wikiLinkMatcher=_wikiLinkPattern.matcher(oldContent);
    newContent=oldContent;
    newContent=_encodeLink(newContent,wikiLinkMatcher);
    encodedContent.append(newContent);
  }
  return encodedContent.toString();
}
