{
  try {
    Analyzer analyzer=new LimitTokenCountAnalyzer(_analyzer,luceneConfiguration.analyzerMaxTokens());
    IndexWriterConfig indexWriterConfig=new IndexWriterConfig(_version,analyzer);
    indexWriterConfig.setIndexDeletionPolicy(_dumpIndexDeletionPolicy);
    indexWriterConfig.setMergePolicy(_getMergePolicy());
    indexWriterConfig.setMergeScheduler(_getMergeScheduler());
    indexWriterConfig.setRAMBufferSizeMB(luceneConfiguration.bufferSize());
    _indexWriter=new IndexWriter(getLuceneDir(),indexWriterConfig);
    if (!IndexReader.indexExists(getLuceneDir())) {
      if (_log.isDebugEnabled()) {
        _log.debug("Creating missing index");
      }
      _indexWriter.commit();
    }
  }
 catch (  Exception e) {
    _log.error("Initializing Lucene writer failed for " + _companyId,e);
  }
}
