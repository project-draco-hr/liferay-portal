{
  byte[] cookie=new byte[0];
  while (cookie != null) {
    List<SearchResult> searchResults=new ArrayList<>();
    String userMappingsScreenName=GetterUtil.getString(userMappings.getProperty("screenName"));
    userMappingsScreenName=StringUtil.toLowerCase(userMappingsScreenName);
    cookie=_portalLDAP.getUsers(ldapServerId,companyId,ldapContext,cookie,0,new String[]{userMappingsScreenName},searchResults);
    for (    SearchResult searchResult : searchResults) {
      try {
        Attributes userAttributes=_portalLDAP.getUserAttributes(ldapServerId,companyId,ldapContext,_portalLDAP.getNameInNamespace(ldapServerId,companyId,searchResult));
        User user=importUser(ldapServerId,companyId,userAttributes,userMappings,userExpandoMappings,contactMappings,contactExpandoMappings,StringPool.BLANK,ldapUserIgnoreAttributes);
        importGroups(ldapServerId,companyId,ldapContext,userAttributes,user,userMappings,groupMappings);
      }
 catch (      Exception e) {
        _log.error("Unable to import user " + searchResult,e);
      }
    }
  }
}
