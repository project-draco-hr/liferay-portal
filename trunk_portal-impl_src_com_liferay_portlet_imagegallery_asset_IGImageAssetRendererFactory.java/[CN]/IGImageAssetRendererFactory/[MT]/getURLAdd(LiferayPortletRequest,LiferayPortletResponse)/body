{
  HttpServletRequest request=liferayPortletRequest.getHttpServletRequest();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (!IGPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.ADD_IMAGE)) {
    return null;
  }
  PortletURL portletURL=PortletURLFactoryUtil.create(request,PortletKeys.IMAGE_GALLERY,getControlPanelPlid(themeDisplay),PortletRequest.RENDER_PHASE);
  portletURL.setParameter("struts_action","/image_gallery/edit_image");
  portletURL.setParameter("folderId",String.valueOf(AssetPublisherUtil.getRecentFolderId(liferayPortletRequest,CLASS_NAME)));
  portletURL.setParameter("uploader","classic");
  return portletURL;
}
