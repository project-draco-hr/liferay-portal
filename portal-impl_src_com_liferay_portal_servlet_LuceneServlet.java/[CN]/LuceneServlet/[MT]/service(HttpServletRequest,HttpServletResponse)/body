{
  String pathInfo=GetterUtil.getString(request.getPathInfo());
  if (!pathInfo.equals("/dump")) {
    response.sendError(HttpServletResponse.SC_NOT_FOUND);
    return;
  }
  String transientToken=ParamUtil.getString(request,"transientToken");
  if (Validator.isNull(transientToken)) {
    response.sendError(HttpServletResponse.SC_FORBIDDEN);
    return;
  }
  if (!TransientTokenUtil.checkToken(transientToken)) {
    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);
    return;
  }
  long companyId=ParamUtil.getLong(request,"companyId");
  if (companyId < CompanyConstants.SYSTEM) {
    response.sendError(HttpServletResponse.SC_BAD_REQUEST);
    return;
  }
  if (companyId != CompanyConstants.SYSTEM) {
    try {
      CompanyLocalServiceUtil.getCompanyById(companyId);
    }
 catch (    Exception e) {
      response.sendError(HttpServletResponse.SC_BAD_REQUEST);
      return;
    }
  }
  LuceneHelperUtil.dumpIndex(companyId,response.getOutputStream());
}
