{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Set<String> identifiers=new HashSet<String>();
  Set<PublicRenderParameter> publicRenderParameters=new TreeSet<PublicRenderParameter>(new PublicRenderParameterIdentifierComparator());
  LayoutTypePortlet layoutTypePortlet=themeDisplay.getLayoutTypePortlet();
  List<Portlet> portlets=layoutTypePortlet.getAllPortlets();
  for (  Portlet portlet : portlets) {
    for (    PublicRenderParameter publicRenderParameter : portlet.getPublicRenderParameters()) {
      if (!identifiers.contains(publicRenderParameter.getIdentifier())) {
        identifiers.add(publicRenderParameter.getIdentifier());
        publicRenderParameters.add(publicRenderParameter);
      }
    }
  }
  portletRequest.setAttribute(WebKeys.PUBLIC_RENDER_PARAMETERS,publicRenderParameters);
}
