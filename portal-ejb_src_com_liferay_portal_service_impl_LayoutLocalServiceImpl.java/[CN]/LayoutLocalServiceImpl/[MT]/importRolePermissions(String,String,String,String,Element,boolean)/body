{
  List roleEls=parentEl.elements("role");
  for (int i=0; i < roleEls.size(); i++) {
    Element roleEl=(Element)roleEls.get(i);
    String roleName=roleEl.attributeValue("name");
    Role role=searchRole(companyId,roleName);
    if (role == null) {
      _log.warn("Ignoring permissions for role with name " + roleName);
    }
 else {
      List actions=getActions(roleEl);
      PermissionLocalServiceUtil.setRolePermissions(role.getRoleId(),companyId,resourceName,scope,resourcePrimKey,(String[])actions.toArray(new String[0]));
      if (communityRole) {
        long[] groupIds={GetterUtil.getLong(resourcePrimKey)};
        GroupLocalServiceUtil.addRoleGroups(role.getRoleId(),groupIds);
      }
    }
  }
}
