{
  Theme theme=layoutSet.getTheme();
  ZipWriter zipWriter=new ZipWriter();
  String lookAndFeelXML=ContentUtil.get("com/liferay/portal/dependencies/liferay-look-and-feel.xml.tmpl");
  zipWriter.addEntry("liferay-look-and-feel.xml",lookAndFeelXML);
  String servletContextName=theme.getServletContextName();
  ServletContext ctx=VelocityContextPool.get(servletContextName);
  if (ctx == null) {
    if (_log.isWarnEnabled()) {
      _log.warn("Servlet context not found for theme " + theme.getThemeId());
    }
    return null;
  }
  File cssPath=new File(ctx.getRealPath(theme.getCssPath()));
  exportThemeFiles("css",cssPath,zipWriter);
  File imagesPath=new File(ctx.getRealPath(theme.getImagesPath()));
  exportThemeFiles("images",imagesPath,zipWriter);
  File javaScriptPath=new File(ctx.getRealPath(theme.getJavaScriptPath()));
  exportThemeFiles("javascript",javaScriptPath,zipWriter);
  File templatesPath=new File(ctx.getRealPath(theme.getTemplatesPath()));
  exportThemeFiles("templates",templatesPath,zipWriter);
  return zipWriter.finish();
}
