{
  Iterator itr=parentEl.elements("portlet-preferences").iterator();
  while (itr.hasNext()) {
    Element el=(Element)itr.next();
    String portletId=el.attributeValue("portlet-id");
    String layoutId=el.attributeValue("layout-id");
    String ownerId=el.attributeValue("owner-id");
    String preferences=el.elementText("preferences");
    if (ownerId.startsWith(PortletKeys.PREFS_OWNER_ID_GROUP)) {
      ownerId=PortletKeys.PREFS_OWNER_ID_GROUP + StringPool.PERIOD + layoutSet.getGroupId();
    }
 else     if (ownerId.indexOf(PortletKeys.PREFS_OWNER_ID_USER) != -1) {
      ownerId=layoutSet.getOwnerId() + StringPool.PERIOD + PortletKeys.PREFS_OWNER_ID_USER+ StringPool.PERIOD+ UserImpl.getDefaultUserId(layoutSet.getCompanyId());
    }
 else     if (ownerId.startsWith(LayoutImpl.PUBLIC)) {
      ownerId=LayoutImpl.PUBLIC + layoutSet.getGroupId();
    }
 else     if (ownerId.startsWith(LayoutImpl.PRIVATE)) {
      ownerId=LayoutImpl.PRIVATE + layoutSet.getGroupId();
    }
    PortletPreferencesPK pk=new PortletPreferencesPK(portletId,layoutId,ownerId);
    try {
      PortletPreferencesLocalServiceUtil.deletePortletPreferences(pk);
    }
 catch (    NoSuchPortletPreferencesException nsppe) {
    }
    PortletPreferences prefs=PortletPreferencesUtil.create(pk);
    prefs.setPreferences(preferences);
    PortletPreferencesUtil.update(prefs);
  }
}
