{
  Element entityPermissionsEl=DocumentHelper.createElement(entityName + "-permissions");
  Map entityMap=getEntityMap(companyId,entityName);
  Iterator itr=entityMap.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry entry=(Map.Entry)itr.next();
    String name=entry.getKey().toString();
    long entityGroupId=((Long)entry.getValue()).longValue();
    Element entityEl=exportGroupPermissions(companyId,entityGroupId,resourceName,resourcePrimKey,entityPermissionsEl,entityName + "-actions");
    if (entityEl.elements().isEmpty()) {
      entityPermissionsEl.remove(entityEl);
    }
 else {
      entityEl.addAttribute("name",name);
    }
  }
  if (!entityPermissionsEl.elements().isEmpty()) {
    parentEl.add(entityPermissionsEl);
  }
}
