{
  List childLayouts=LayoutUtil.findByO_P(layout.getOwnerId(),layout.getLayoutId());
  for (int i=0; i < childLayouts.size(); i++) {
    Layout childLayout=(Layout)childLayouts.get(i);
    deleteLayout(childLayout,updateLayoutSet);
  }
  PortletPreferencesLocalServiceUtil.deletePortletPreferences(layout.getLayoutId(),layout.getOwnerId());
  JournalContentSearchLocalServiceUtil.deleteLayoutContentSearches(layout.getLayoutId(),layout.getOwnerId());
  if (updateLayoutSet) {
    LayoutSetLocalServiceUtil.updatePageCount(layout.getOwnerId());
  }
  Iterator itr=ResourceFinder.findByC_P(layout.getCompanyId(),layout.getPlid() + Portlet.LAYOUT_SEPARATOR + "%").iterator();
  while (itr.hasNext()) {
    Resource resource=(Resource)itr.next();
    ResourceLocalServiceUtil.deleteResource(resource);
  }
  ResourceLocalServiceUtil.deleteResource(layout.getCompanyId(),Layout.class.getName(),Resource.TYPE_CLASS,Resource.SCOPE_INDIVIDUAL,layout.getPrimaryKey().toString());
  LayoutUtil.remove(layout.getPrimaryKey());
}
