{
  Element el=parentEl.addElement(elName);
  Map resourceRoles=RoleLocalServiceUtil.getResourceRoles(companyId,resourceName,scope,resourcePrimKey);
  Iterator itr=resourceRoles.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry entry=(Map.Entry)itr.next();
    String roleName=entry.getKey().toString();
    if (hasRole(roles,roleName)) {
      Element roleEl=el.addElement("role");
      roleEl.addAttribute("name",roleName);
      List actions=(List)entry.getValue();
      for (int i=0; i < actions.size(); i++) {
        String action=(String)actions.get(i);
        Element actionKeyEl=roleEl.addElement("action-key");
        actionKeyEl.addText(action);
        actionKeyEl.addAttribute("scope",scope);
      }
    }
  }
  return el;
}
