{
  String sourcePrototypeLayoutUuid=layout.getSourcePrototypeLayoutUuid();
  if (Validator.isNull(sourcePrototypeLayoutUuid)) {
    doMergeLayoutPrototypeLayout(group,layout);
    return;
  }
  LayoutSet layoutSet=layout.getLayoutSet();
  long layoutSetPrototypeId=layoutSet.getLayoutSetPrototypeId();
  if (layoutSetPrototypeId > 0) {
    Group layoutSetPrototypeGroup=GroupLocalServiceUtil.getLayoutSetPrototypeGroup(layout.getCompanyId(),layoutSetPrototypeId);
    Layout sourcePrototypeLayout=LayoutLocalServiceUtil.fetchLayoutByUuidAndGroupId(sourcePrototypeLayoutUuid,layoutSetPrototypeGroup.getGroupId(),true);
    if (sourcePrototypeLayout != null) {
      doMergeLayoutPrototypeLayout(layoutSetPrototypeGroup,sourcePrototypeLayout);
    }
  }
  doMergeLayoutPrototypeLayout(group,layout);
}
