{
  String authorization=request.getHeader("Authorization");
  if (authorization == null) {
    return null;
  }
  StringTokenizer st=new StringTokenizer(authorization);
  if (!st.hasMoreTokens()) {
    return null;
  }
  String basic=st.nextToken();
  if (!StringUtil.equalsIgnoreCase(basic,HttpServletRequest.BASIC_AUTH)) {
    return null;
  }
  String encodedCredentials=st.nextToken();
  if (_log.isDebugEnabled()) {
    _log.debug("Encoded credentials are " + encodedCredentials);
  }
  String decodedCredentials=new String(Base64.decode(encodedCredentials));
  if (_log.isDebugEnabled()) {
    _log.debug("Decoded credentials are " + decodedCredentials);
  }
  int pos=decodedCredentials.indexOf(CharPool.COLON);
  if (pos == -1) {
    return null;
  }
  String login=GetterUtil.getString(decodedCredentials.substring(0,pos));
  String password=decodedCredentials.substring(pos + 1);
  long userId=LoginUtil.getAuthenticatedUserId(request,login,password,null);
  String[] credentials=new String[3];
  credentials[0]=String.valueOf(userId);
  credentials[1]=password;
  credentials[2]=Boolean.TRUE.toString();
  return credentials;
}
