{
  _tmpDirName=tmpDirName;
  _scriptingContainer=new ScriptingContainer(LocalContextScope.THREADSAFE);
  LocalContextProvider localContextProvider=_scriptingContainer.getProvider();
  RubyInstanceConfig rubyInstanceConfig=localContextProvider.getRubyInstanceConfig();
  if (_COMPILE_MODE_FORCE.equals(compileMode)) {
    rubyInstanceConfig.setCompileMode(RubyInstanceConfig.CompileMode.FORCE);
  }
 else   if (_COMPILE_MODE_JIT.equals(compileMode)) {
    rubyInstanceConfig.setCompileMode(RubyInstanceConfig.CompileMode.JIT);
  }
  List<String> loadPaths=new ArrayList<>();
  loadPaths.add("META-INF/jruby.home/lib/ruby/site_ruby/1.8");
  loadPaths.add("META-INF/jruby.home/lib/ruby/site_ruby/shared");
  loadPaths.add("META-INF/jruby.home/lib/ruby/1.8");
  loadPaths.add("gems/chunky_png-1.3.4/lib");
  loadPaths.add("gems/compass-1.0.1/lib");
  loadPaths.add("gems/compass-core-1.0.3/lib");
  loadPaths.add("gems/compass-import-once-1.0.5/lib");
  loadPaths.add("gems/ffi-1.9.10-java/lib");
  loadPaths.add("gems/multi_json-1.11.2/lib");
  loadPaths.add("gems/rb-fsevent-0.9.5/lib");
  loadPaths.add("gems/rb-inotify-0.9.5/lib");
  loadPaths.add("gems/sass-3.4.16/lib");
  rubyInstanceConfig.setLoadPaths(loadPaths);
  rubyInstanceConfig.setJitThreshold(compilerThreshold);
  String rubyScript=null;
  Class<?> clazz=getClass();
  try (InputStream inputStream=clazz.getResourceAsStream("dependencies/main.rb")){
    Scanner scanner=new Scanner(inputStream,"UTF-8");
    scanner.useDelimiter("\\A");
    rubyScript=scanner.next();
  }
   _scriptObject=_scriptingContainer.runScriptlet(rubyScript);
}
