{
  Bundle bundle=FrameworkUtil.getBundle(TestModuleSelfContainedDependencyClosureTest.class);
  BundleContext bundleContext=bundle.getBundleContext();
  Set<Bundle> testBundles=_getTestBundles(bundleContext);
  Bundle systemBundle=bundleContext.getBundle(0);
  FrameworkWiring frameworkWiring=systemBundle.adapt(FrameworkWiring.class);
  for (  Bundle testBundle : testBundles) {
    Collection<Bundle> dependencyClosure=frameworkWiring.getDependencyClosure(Arrays.asList(testBundle));
    Assert.assertTrue("Test bundle " + testBundle + "'s dependency closure is "+ "larger than self contained scope. Self contained scope "+ "is "+ testBundles+ ", dependency closure is "+ dependencyClosure,testBundles.containsAll(dependencyClosure));
  }
}
