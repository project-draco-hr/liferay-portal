{
  if (_scheme.equals(SCHEME_BASIC) && !Validator.isBlank(getAuthParameter(AUTH_PARAMETER_NAME_USERNAME))) {
    String userName=getAuthParameter(AUTH_PARAMETER_NAME_USERNAME);
    String password=getAuthParameter(AUTH_PARAMETER_NAME_PASSWORD);
    String userNameAndPassword=userName + StringPool.COLON + password;
    String encodedUserNameAndPassword=Base64.encode(userNameAndPassword.getBytes());
    return SCHEME_BASIC + StringPool.SPACE + encodedUserNameAndPassword;
  }
  StringBundler sb=new StringBundler(_authParameters.size() * 6 + 2);
  sb.append(_scheme);
  sb.append(StringPool.SPACE);
  for (  Map.Entry<String,String> entry : _authParameters.entrySet()) {
    sb.append(entry.getKey());
    sb.append(StringPool.EQUAL);
    sb.append(StringPool.QUOTE);
    sb.append(entry.getValue());
    sb.append(StringPool.QUOTE);
    sb.append(StringPool.COMMA_AND_SPACE);
  }
  sb.setIndex(sb.index() - 1);
  return sb.toString();
}
