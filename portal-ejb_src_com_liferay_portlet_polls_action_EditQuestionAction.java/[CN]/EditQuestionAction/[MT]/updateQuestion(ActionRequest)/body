{
  Layout layout=(Layout)req.getAttribute(WebKeys.LAYOUT);
  String questionId=ParamUtil.getString(req,"questionId");
  String title=ParamUtil.getString(req,"title");
  String description=ParamUtil.getString(req,"description");
  int expirationDateMonth=ParamUtil.getInteger(req,"expirationDateMonth");
  int expirationDateDay=ParamUtil.getInteger(req,"expirationDateDay");
  int expirationDateYear=ParamUtil.getInteger(req,"expirationDateYear");
  int expirationDateHour=ParamUtil.getInteger(req,"expirationDateHour");
  int expirationDateMinute=ParamUtil.getInteger(req,"expirationDateMinute");
  int expirationDateAmPm=ParamUtil.getInteger(req,"expirationDateAmPm");
  boolean neverExpire=ParamUtil.getBoolean(req,"neverExpire");
  if (expirationDateAmPm == Calendar.PM) {
    expirationDateHour+=12;
  }
  List choices=new ArrayList();
  Enumeration enu=req.getParameterNames();
  while (enu.hasMoreElements()) {
    String param=(String)enu.nextElement();
    if (param.startsWith(CHOICE_DESCRIPTION_PREFIX)) {
      try {
        String id=param.substring(CHOICE_DESCRIPTION_PREFIX.length(),param.length());
        String choiceId=ParamUtil.getString(req,CHOICE_ID_PREFIX + id);
        String choiceDescription=ParamUtil.getString(req,param);
        PollsChoice choice=PollsChoiceUtil.create(new PollsChoicePK(StringPool.BLANK,choiceId));
        choice.setDescription(choiceDescription);
        choices.add(choice);
      }
 catch (      Exception e) {
      }
    }
  }
  boolean addCommunityPermissions=ParamUtil.getBoolean(req,"addCommunityPermissions");
  boolean addGuestPermissions=ParamUtil.getBoolean(req,"addGuestPermissions");
  if (Validator.isNull(questionId)) {
    PollsQuestionServiceUtil.addQuestion(layout.getPlid(),title,description,expirationDateMonth,expirationDateDay,expirationDateYear,expirationDateHour,expirationDateMinute,neverExpire,choices,addCommunityPermissions,addGuestPermissions);
  }
 else {
    PollsQuestionServiceUtil.updateQuestion(questionId,title,description,expirationDateMonth,expirationDateDay,expirationDateYear,expirationDateHour,expirationDateMinute,neverExpire,choices);
  }
}
