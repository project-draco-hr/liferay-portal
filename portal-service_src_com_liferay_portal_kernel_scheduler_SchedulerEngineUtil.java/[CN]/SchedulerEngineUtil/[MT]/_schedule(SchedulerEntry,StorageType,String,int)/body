{
  ClassLoader classLoader=null;
  if ((portletId == null) || (portletId.length() == 0)) {
    classLoader=PortalClassLoaderUtil.getClassLoader();
  }
 else {
    classLoader=PortletClassLoaderUtil.getClassLoader(portletId);
  }
  Trigger trigger=schedulerEntry.getTrigger();
  SchedulerEventMessageListenerWrapper schedulerEventListenerWrapper=new SchedulerEventMessageListenerWrapper();
  schedulerEventListenerWrapper.setJobName(trigger.getJobName());
  schedulerEventListenerWrapper.setGroupName(trigger.getGroupName());
  schedulerEventListenerWrapper.setMessageListener(_getSchedulerEventListener(schedulerEntry,classLoader));
  schedulerEventListenerWrapper.afterPropertiesSet();
  schedulerEntry.setEventListener(schedulerEventListenerWrapper);
  MessageBusUtil.registerMessageListener(DestinationNames.SCHEDULER_DISPATCH,schedulerEventListenerWrapper);
  Message message=new Message();
  message.put(SchedulerEngine.CONTEXT_PATH,schedulerEntry.getContextPath());
  message.put(SchedulerEngine.MESSAGE_LISTENER_UUID,schedulerEventListenerWrapper.getMessageListenerUUID());
  _schedule(trigger,storageType,schedulerEntry.getDescription(),DestinationNames.SCHEDULER_DISPATCH,message,exceptionsMaxSize);
}
