{
  if (_log.isDebugEnabled()) {
    _log.debug("Clearing the mail cache for user " + userId);
  }
  Collection accounts=getUserAccounts(userId);
  if (accounts != null) {
    if (_log.isDebugEnabled()) {
      _log.debug("User has " + accounts.size() + " cached accounts");
    }
    Iterator itr=accounts.iterator();
    while (itr.hasNext()) {
      MailAccount account=(MailAccount)itr.next();
      removeAndCloseStore(userId,account.getName());
    }
    removeUserAccounts(userId);
  }
}
