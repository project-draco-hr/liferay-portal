{
  String sessionId=session.getId();
  if (CompoundSessionIdSplitterUtil.hasSessionDelimiter()) {
    sessionId=CompoundSessionIdSplitterUtil.parseSessionId(sessionId);
  }
  Set<HttpSession> sessions=_sessions.get(sessionId);
  if (sessions == null) {
    sessions=new ConcurrentHashSet<HttpSession>();
    Set<HttpSession> previousSessions=_sessions.putIfAbsent(sessionId,sessions);
    if (previousSessions != null) {
      sessions=previousSessions;
    }
  }
  sessions.add(session);
}
