{
  String sessionId=session.getId();
  Set<HttpSession> portletSessions=_sessions.get(sessionId);
  if (portletSessions == null) {
    portletSessions=new ConcurrentHashSet<HttpSession>();
    Set<HttpSession> oldPortletSessions=_sessions.putIfAbsent(sessionId,portletSessions);
    if (oldPortletSessions != null) {
      portletSessions=oldPortletSessions;
    }
  }
  portletSessions.add(session);
}
