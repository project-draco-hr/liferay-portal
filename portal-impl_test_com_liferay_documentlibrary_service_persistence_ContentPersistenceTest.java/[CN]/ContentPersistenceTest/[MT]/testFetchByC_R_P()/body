{
  Content content1=addContent();
  int size=(int)content1.getSize();
  Blob blob=new OutputBlob(new ByteArrayInputStream(new byte[size]),size);
  long contentId2=content1.getContentId() + 1;
  String version2=content1.getVersion().concat("-2");
  Content content2=new Content(contentId2,content1.getCompanyId(),content1.getPortletId(),content1.getGroupId(),content1.getRepositoryId(),content1.getPath(),version2,blob,size);
  _persistence.update(content2);
  Content existingContent2=_persistence.fetchByC_R_P(content1.getCompanyId(),content1.getRepositoryId(),content1.getPath());
  assertTrue(existingContent2.equals(content2));
  _persistence.remove(existingContent2.getContentId());
  Content existingContent1=_persistence.fetchByC_R_P(content1.getCompanyId(),content1.getRepositoryId(),content1.getPath());
  assertTrue(existingContent1.equals(content1));
  _persistence.remove(existingContent1.getContentId());
  Content missingContent=_persistence.fetchByC_R_P(content1.getCompanyId(),content1.getRepositoryId(),content1.getPath());
  assertNull(missingContent);
}
