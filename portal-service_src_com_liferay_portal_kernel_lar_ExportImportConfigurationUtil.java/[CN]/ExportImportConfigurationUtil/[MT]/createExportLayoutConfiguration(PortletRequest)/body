{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long userId=themeDisplay.getUserId();
  long groupId=ParamUtil.getLong(portletRequest,"groupId");
  boolean privateLayout=ParamUtil.getBoolean(portletRequest,"privateLayout");
  DateRange dateRange=ExportImportHelperUtil.getDateRange(portletRequest,groupId,privateLayout,0,null,"all");
  String exportImportConfigurationName=ParamUtil.getString(portletRequest,"exportImportConfigurationName");
  String exportImportConfigurationDescription=ParamUtil.getString(portletRequest,"exportImportConfigurationDescription");
  Map<String,Serializable> configurationContextMap=ExportImportConfigurationSettingsMapFactory.buildSettingsMap(userId,groupId,privateLayout,null,portletRequest.getParameterMap(),dateRange.getStartDate(),dateRange.getEndDate());
  return ExportImportConfigurationLocalServiceUtil.addExportImportConfiguration(userId,groupId,exportImportConfigurationName,exportImportConfigurationDescription,ExportImportConfigurationConstants.TYPE_EXPORT_LAYOUT,configurationContextMap,new ServiceContext());
}
