{
  String error_message="OPERATION_FAILED";
  String producerId=ParamUtil.getString(actionRequest,AdminPortletConstants.PRODUCERID);
  String propertyName=ParamUtil.getString(actionRequest,"property_name");
  String propertyDesc=ParamUtil.getString(actionRequest,"property_desc");
  int next_action=ProducerPortletAction.GET_REGISTRATION_PROPERTIES;
  try {
    if (Validator.isNull(propertyName) || Validator.isNull(propertyDesc)) {
      error_message="INVALID_PROPERTY_DATA";
      throw new ProducerHandlerException();
    }
    ProducerHandler handler=obtainHandler(actionRequest);
    ProducerBean producerData=handler.getDetails(producerId);
    List regProperties=producerData.getRegistrationPropertyDescriptions();
    if (regProperties == null) {
      regProperties=new ArrayList();
    }
 else {
      for (Iterator<String> iterator=regProperties.iterator(); iterator.hasNext(); ) {
        if (iterator.next().startsWith(propertyName + "=")) {
          error_message="DUPLICATE_PROPERTY_NAME";
          throw new ProducerHandlerException();
        }
      }
    }
    regProperties.add(propertyName + "=" + propertyDesc);
    Map attributeMap=new HashMap();
    attributeMap.put("RegistrationPropertyDescription",regProperties);
    handler.update(producerId,attributeMap);
  }
 catch (  ProducerHandlerException e) {
    actionResponse.setRenderParameter("PRODUCER_ADMIN_ERROR",error_message);
    next_action=ProducerPortletAction.ADD_REGISTRATION_PROPERTY;
  }
  actionResponse.setRenderParameter("action",String.valueOf(next_action));
  actionResponse.setRenderParameter(AdminPortletConstants.PRODUCERID,producerId);
}
