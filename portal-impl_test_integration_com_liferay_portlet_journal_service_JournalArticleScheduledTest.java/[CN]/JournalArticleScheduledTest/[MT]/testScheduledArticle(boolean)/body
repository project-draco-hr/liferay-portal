{
  Group group=GroupTestUtil.addGroup();
  int initialSearchArticlesCount=JournalTestUtil.getSearchArticlesCount(group.getCompanyId(),group.getGroupId());
  Date now=new Date();
  JournalArticle article=addJournalArticle(group.getGroupId(),approved,now);
  AssetEntry assetEntry=AssetEntryLocalServiceUtil.getEntry(JournalArticle.class.getName(),article.getResourcePrimKey());
  if (approved) {
    Assert.assertFalse(article.isApproved());
    Assert.assertTrue(article.isScheduled());
    Assert.assertFalse(assetEntry.isVisible());
  }
 else {
    Assert.assertTrue(article.isDraft());
    Assert.assertFalse(article.isScheduled());
    Assert.assertFalse(assetEntry.isVisible());
  }
  Assert.assertEquals(initialSearchArticlesCount,JournalTestUtil.getSearchArticlesCount(group.getCompanyId(),group.getGroupId()));
  Calendar displayDateCalendar=new GregorianCalendar();
  displayDateCalendar.setTime(new Date(now.getTime() - Time.MINUTE * 5));
  article.setDisplayDate(displayDateCalendar.getTime());
  article=JournalArticleLocalServiceUtil.updateJournalArticle(article);
  JournalArticleLocalServiceUtil.checkArticles();
  article=JournalArticleLocalServiceUtil.getArticle(article.getId());
  assetEntry=AssetEntryLocalServiceUtil.getEntry(JournalArticle.class.getName(),article.getResourcePrimKey());
  if (approved) {
    Assert.assertTrue(article.isApproved());
    Assert.assertFalse(article.isScheduled());
    Assert.assertTrue(assetEntry.isVisible());
    Assert.assertEquals(initialSearchArticlesCount + 1,JournalTestUtil.getSearchArticlesCount(group.getCompanyId(),group.getGroupId()));
  }
 else {
    Assert.assertTrue(article.isDraft());
    Assert.assertFalse(article.isScheduled());
    Assert.assertFalse(assetEntry.isVisible());
    Assert.assertEquals(initialSearchArticlesCount,JournalTestUtil.getSearchArticlesCount(group.getCompanyId(),group.getGroupId()));
  }
  GroupLocalServiceUtil.deleteGroup(group);
}
