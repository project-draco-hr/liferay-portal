{
  MBTreeWalker treeWalker=messageDisplay.getTreeWalker();
  List<MBMessage> messages=treeWalker.getMessages();
  List<RatingsEntry> ratingsEntries=Collections.emptyList();
  List<RatingsStats> ratingsStats=Collections.emptyList();
  if (messages.size() > 1) {
    List<Long> classPKs=new ArrayList<>();
    for (    MBMessage curMessage : messages) {
      if (!curMessage.isRoot()) {
        classPKs.add(curMessage.getMessageId());
      }
    }
    ratingsEntries=_ratingsEntryLocalService.getEntries(userId,CommentConstants.getDiscussionClassName(),classPKs);
    ratingsStats=_ratingsStatsLocalService.getStats(CommentConstants.getDiscussionClassName(),classPKs);
  }
  return new MBDiscussionCommentImpl(treeWalker.getRoot(),treeWalker,ratingsEntries,ratingsStats);
}
