{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  if (layout.isTypeControlPanel()) {
    return false;
  }
  Group group=layout.getGroup();
  if (group.hasStagingGroup() && !group.isStagingGroup()) {
    return false;
  }
  if (!(hasUpdateLayoutPermission(themeDisplay) || hasCustomizePermission(themeDisplay) || hasPortletConfigurationPermission(themeDisplay))) {
    return false;
  }
  return super.hasAccessPermission(request);
}
