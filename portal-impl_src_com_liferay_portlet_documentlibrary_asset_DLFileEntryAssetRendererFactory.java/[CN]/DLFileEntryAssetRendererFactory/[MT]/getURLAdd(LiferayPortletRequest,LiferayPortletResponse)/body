{
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (!DLPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.ADD_DOCUMENT)) {
    return null;
  }
  long classTypeId=GetterUtil.getLong(liferayPortletRequest.getAttribute(WebKeys.ASSET_RENDERER_FACTORY_CLASS_TYPE_ID));
  if ((classTypeId > 0) && !DLFileEntryTypePermission.contains(themeDisplay.getPermissionChecker(),classTypeId,ActionKeys.VIEW)) {
    return null;
  }
  PortletURL portletURL=liferayPortletResponse.createRenderURL(PortletKeys.DOCUMENT_LIBRARY);
  portletURL.setParameter("struts_action","/document_library/edit_file_entry");
  portletURL.setParameter("folderId",String.valueOf(AssetPublisherUtil.getRecentFolderId(liferayPortletRequest,getClassName())));
  return portletURL;
}
