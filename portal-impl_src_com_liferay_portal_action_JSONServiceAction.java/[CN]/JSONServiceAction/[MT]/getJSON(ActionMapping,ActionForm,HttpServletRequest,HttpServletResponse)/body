{
  String className=ParamUtil.getString(request,"serviceClassName");
  String methodName=ParamUtil.getString(request,"serviceMethodName");
  String[] serviceParameters=getStringArrayFromJSON(request,"serviceParameters");
  String[] serviceParameterTypes=getStringArrayFromJSON(request,"serviceParameterTypes");
  if (!isValidRequest(request)) {
    return null;
  }
  Thread currentThread=Thread.currentThread();
  ClassLoader contextClassLoader=currentThread.getContextClassLoader();
  Class<?> clazz=contextClassLoader.loadClass(className);
  Object[] methodAndParameterTypes=getMethodAndParameterTypes(clazz,methodName,serviceParameters,serviceParameterTypes);
  if (methodAndParameterTypes != null) {
    Method method=(Method)methodAndParameterTypes[0];
    Type[] parameterTypes=(Type[])methodAndParameterTypes[1];
    Object[] args=new Object[serviceParameters.length];
    for (int i=0; i < serviceParameters.length; i++) {
      args[i]=getArgValue(request,clazz,methodName,serviceParameters[i],parameterTypes[i]);
    }
    try {
      if (_log.isDebugEnabled()) {
        _log.debug("Invoking " + clazz + " on method "+ method.getName()+ " with args "+ Arrays.toString(args));
      }
      Object returnObj=method.invoke(clazz,args);
      if (returnObj != null) {
        return getReturnValue(returnObj,method.getReturnType());
      }
 else {
        JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
        return jsonObject.toString();
      }
    }
 catch (    Exception e) {
      if (_log.isDebugEnabled()) {
        _log.debug("Invoked " + clazz + " on method "+ method.getName()+ " with args "+ Arrays.toString(args),e);
      }
      JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
      if (e instanceof InvocationTargetException) {
        jsonObject.put("exception",e.getCause().toString());
      }
 else {
        jsonObject.put("exception",e.getMessage());
      }
      return jsonObject.toString();
    }
  }
  return null;
}
