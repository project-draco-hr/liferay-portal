{
  try {
    IndexWriterRequestMessage iwrm=(IndexWriterRequestMessage)JSONUtil.deserialize(message);
    String command=iwrm.getCommand();
    if (command.equals(IndexWriterRequestMessage.ADD)) {
      LuceneSearchEngineUtil.addDocument(iwrm.getCompanyId(),iwrm.getDocument());
    }
 else     if (command.equals(IndexWriterRequestMessage.DELETE)) {
      LuceneSearchEngineUtil.deleteDocument(iwrm.getCompanyId(),iwrm.getId());
    }
 else     if (command.equals(IndexWriterRequestMessage.DELETE_PORTLET_DOCS)) {
      LuceneSearchEngineUtil.deletePortletDocuments(iwrm.getCompanyId(),iwrm.getId());
    }
 else     if (command.equals(IndexWriterRequestMessage.UPDATE)) {
      LuceneSearchEngineUtil.updateDocument(iwrm.getCompanyId(),iwrm.getId(),iwrm.getDocument());
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
