{
  IndexWriterMessage indexWriterMessage=(IndexWriterMessage)JSONUtil.deserialize(message);
  String command=indexWriterMessage.getCommand();
  long companyId=indexWriterMessage.getCompanyId();
  String id=indexWriterMessage.getId();
  Document doc=indexWriterMessage.getDocument();
  if (command.equals(IndexWriterMessage.ADD)) {
    LuceneSearchEngineUtil.addDocument(companyId,doc);
  }
 else   if (command.equals(IndexWriterMessage.DELETE)) {
    LuceneSearchEngineUtil.deleteDocument(companyId,id);
  }
 else   if (command.equals(IndexWriterMessage.DELETE_PORTLET_DOCS)) {
    LuceneSearchEngineUtil.deletePortletDocuments(companyId,id);
  }
 else   if (command.equals(IndexWriterMessage.UPDATE)) {
    LuceneSearchEngineUtil.updateDocument(companyId,id,doc);
  }
}
