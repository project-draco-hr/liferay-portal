{
  try {
    IndexWriterMessage iwm=(IndexWriterMessage)JSONUtil.deserialize(message);
    String command=iwm.getCommand();
    if (command.equals(IndexWriterMessage.ADD)) {
      LuceneSearchEngineUtil.addDocument(iwm.getCompanyId(),iwm.getDocument());
    }
 else     if (command.equals(IndexWriterMessage.DELETE)) {
      LuceneSearchEngineUtil.deleteDocument(iwm.getCompanyId(),iwm.getId());
    }
 else     if (command.equals(IndexWriterMessage.DELETE_PORTLET_DOCS)) {
      LuceneSearchEngineUtil.deletePortletDocuments(iwm.getCompanyId(),iwm.getId());
    }
 else     if (command.equals(IndexWriterMessage.UPDATE)) {
      LuceneSearchEngineUtil.updateDocument(iwm.getCompanyId(),iwm.getId(),iwm.getDocument());
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
