{
  Folder versioningFolder=getVersioningFolder(companyId,repositoryId,fileName,false);
  ObjectId versioningFolderObjectId=new ObjectIdImpl(versioningFolder.getId());
  Map<String,Object> documentProperties=new HashMap<String,Object>();
  String title=String.valueOf(toVersionNumber);
  documentProperties.put(PropertyIds.NAME,title);
  documentProperties.put(PropertyIds.OBJECT_TYPE_ID,BaseTypeId.CMIS_DOCUMENT.value());
  Document document=getVersionedDocument(companyId,repositoryId,fileName,fromVersionNumber);
  document.copy(versioningFolderObjectId,documentProperties,null,document.getPolicies(),null,null,null);
}
