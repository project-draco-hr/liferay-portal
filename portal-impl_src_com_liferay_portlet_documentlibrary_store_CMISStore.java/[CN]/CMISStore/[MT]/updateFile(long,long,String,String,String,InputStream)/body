{
  Folder versioningFolder=getVersioningFolder(companyId,repositoryId,fileName,true);
  String title=String.valueOf(versionNumber);
  Document document=getDocument(versioningFolder,title);
  if (document != null) {
    throw new DuplicateFileException();
  }
  createDocument(versioningFolder,title,is);
}
