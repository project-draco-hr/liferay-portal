{
  Folder versioningFolder=getVersioningFolder(companyId,repositoryId,fileName,false);
  String title=String.valueOf(toVersionNumber);
  Document document=getDocument(versioningFolder,title);
  if (document != null) {
    throw new DuplicateFileException();
  }
  document=getVersionedDocument(companyId,repositoryId,fileName,fromVersionNumber);
  Map<String,Object> documentProperties=new HashMap<String,Object>();
  documentProperties.put(PropertyIds.NAME,title);
  document.updateProperties(documentProperties);
}
