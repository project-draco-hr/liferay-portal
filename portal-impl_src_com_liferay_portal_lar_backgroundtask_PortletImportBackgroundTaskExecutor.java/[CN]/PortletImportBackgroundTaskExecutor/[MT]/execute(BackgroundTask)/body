{
  Map<String,Serializable> taskContextMap=backgroundTask.getTaskContextMap();
  long userId=MapUtil.getLong(taskContextMap,"userId");
  long groupId=MapUtil.getLong(taskContextMap,"groupId");
  StagingUtil.lockGroup(userId,groupId);
  long plid=MapUtil.getLong(taskContextMap,"plid");
  String portletId=MapUtil.getString(taskContextMap,"portletId");
  Map<String,String[]> parameterMap=(Map<String,String[]>)taskContextMap.get("parameterMap");
  List<FileEntry> attachmentsFileEntries=backgroundTask.getAttachmentsFileEntries();
  try {
    for (    FileEntry attachmentsFileEntry : attachmentsFileEntries) {
      LayoutLocalServiceUtil.importPortletInfo(userId,plid,groupId,portletId,parameterMap,attachmentsFileEntry.getContentStream());
    }
  }
  finally {
    StagingUtil.unlockGroup(groupId);
  }
  return BackgroundTaskResult.SUCCESS;
}
