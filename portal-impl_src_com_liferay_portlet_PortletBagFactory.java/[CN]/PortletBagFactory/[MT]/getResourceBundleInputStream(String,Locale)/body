{
  resourceBundleName=resourceBundleName.replace(StringPool.PERIOD,StringPool.SLASH);
  Locale newLocale=locale;
  InputStream inputStream=null;
  while (inputStream == null) {
    locale=newLocale;
    StringBundler sb=new StringBundler(4);
    sb.append(resourceBundleName);
    if (locale != null) {
      String localeName=locale.toString();
      if (localeName.length() > 0) {
        sb.append(StringPool.UNDERLINE);
        sb.append(localeName);
      }
    }
    if (!resourceBundleName.endsWith(".properties")) {
      sb.append(".properties");
    }
    String localizedResourceBundleName=sb.toString();
    if (_log.isInfoEnabled()) {
      _log.info("Attempting to load " + localizedResourceBundleName);
    }
    inputStream=_classLoader.getResourceAsStream(localizedResourceBundleName);
    if (locale == null) {
      break;
    }
    newLocale=LanguageResources.getSuperLocale(locale);
    if (newLocale == null) {
      break;
    }
    if (newLocale.equals(locale)) {
      break;
    }
  }
  return inputStream;
}
