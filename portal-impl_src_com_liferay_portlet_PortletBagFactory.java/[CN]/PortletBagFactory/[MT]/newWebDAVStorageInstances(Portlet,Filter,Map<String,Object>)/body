{
  ServiceTrackerList<WebDAVStorage> webDAVStorageInstances=ServiceTrackerCollections.openList(WebDAVStorage.class,filter,properties);
  if (Validator.isNotNull(portlet.getWebDAVStorageClass())) {
    WebDAVStorage webDAVStorageInstance=(WebDAVStorage)newInstance(WebDAVStorage.class,portlet.getWebDAVStorageClass());
    Map<String,Object> webDAVProperties=new HashMap<>();
    webDAVProperties.put("javax.portlet.name",portlet.getPortletId());
    webDAVProperties.put("webdav.storage.token",portlet.getWebDAVStorageToken());
    webDAVStorageInstances.add(webDAVStorageInstance,webDAVProperties);
  }
  return webDAVStorageInstances;
}
