{
  ServiceTrackerList<PreferencesValidator> preferencesValidatorInstances=getServiceTrackerList(PreferencesValidator.class,filter,properties);
  if (Validator.isNotNull(portlet.getPreferencesValidator())) {
    PreferencesValidator preferencesValidatorInstance=(PreferencesValidator)newInstance(PreferencesValidator.class,portlet.getPreferencesValidator());
    try {
      if (PropsValues.PREFERENCE_VALIDATE_ON_STARTUP) {
        preferencesValidatorInstance.validate(PortletPreferencesFactoryUtil.fromDefaultXML(portlet.getDefaultPreferences()));
      }
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Portlet with the name " + portlet.getPortletId() + " does not have valid default preferences");
      }
    }
    preferencesValidatorInstances.add(preferencesValidatorInstance);
  }
  return preferencesValidatorInstances;
}
