{
  ExportActionableDynamicQuery exportActionableDynamicQuery=_ddlRecordSetLocalService.getExportActionableDynamicQuery(portletDataContext);
  final ActionableDynamicQuery.AddCriteriaMethod addCriteriaMethod=exportActionableDynamicQuery.getAddCriteriaMethod();
  exportActionableDynamicQuery.setAddCriteriaMethod(new ActionableDynamicQuery.AddCriteriaMethod(){
    @Override public void addCriteria(    DynamicQuery dynamicQuery){
      addCriteriaMethod.addCriteria(dynamicQuery);
      Property scopeProperty=PropertyFactoryUtil.forName("scope");
      dynamicQuery.add(scopeProperty.eq(scope));
    }
  }
);
  exportActionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod<DDLRecordSet>(){
    @Override public void performAction(    DDLRecordSet ddlRecordSet) throws PortalException {
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,ddlRecordSet);
      DDMStructure ddmStructure=ddlRecordSet.getDDMStructure();
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,ddmStructure);
      if (scope == DDLRecordSetConstants.SCOPE_DYNAMIC_DATA_LISTS) {
        for (        DDMTemplate ddmTemplate : ddmStructure.getTemplates()) {
          StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,ddmTemplate);
        }
      }
    }
  }
);
  return exportActionableDynamicQuery;
}
