{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long[] oAuthConsumerIds=ParamUtil.getLongValues(actionRequest,"oAuthConsumerId");
  String gadgetKey=ParamUtil.getString(actionRequest,"gadgetKey");
  String[] serviceNames=ParamUtil.getParameterValues(actionRequest,"serviceName");
  String[] consumerKeys=ParamUtil.getParameterValues(actionRequest,"consumerKey");
  String[] consumerSecrets=ParamUtil.getParameterValues(actionRequest,"consumerSecret");
  String[] keyTypes=ParamUtil.getParameterValues(actionRequest,"keyType");
  if ((serviceNames.length == 0) && (keyTypes.length != 0)) {
    serviceNames=new String[]{StringPool.BLANK};
  }
  for (int i=0; i < serviceNames.length; i++) {
    String consumerKey=(String)ArrayUtil.getValue(consumerKeys,i);
    String consumerSecret=(String)ArrayUtil.getValue(consumerSecrets,i);
    if (Validator.isNull(consumerKey)) {
      consumerKey=StringPool.BLANK;
    }
    if (Validator.isNull(consumerSecret)) {
      consumerSecret=StringPool.BLANK;
    }
    if (oAuthConsumerIds[i] <= 0) {
      OAuthConsumerLocalServiceUtil.addOAuthConsumer(themeDisplay.getCompanyId(),gadgetKey,serviceNames[i],consumerKey,consumerSecret,keyTypes[i]);
    }
 else {
      OAuthConsumerLocalServiceUtil.updateOAuthConsumer(oAuthConsumerIds[i],consumerKey,consumerSecret,keyTypes[i],StringPool.BLANK,StringPool.BLANK);
    }
  }
}
