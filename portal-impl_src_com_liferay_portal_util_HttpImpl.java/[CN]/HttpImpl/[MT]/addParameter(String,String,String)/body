{
  if (url == null) {
    return null;
  }
  String array[]=PortalUtil.stripURLAnchor(url,StringPool.POUND);
  url=array[0];
  String anchor=array[1];
  StringBundler sb=new StringBundler(7);
  sb.append(url);
  if (url.indexOf(CharPool.QUESTION) == -1) {
    sb.append(StringPool.QUESTION);
  }
 else   if (!url.endsWith(StringPool.QUESTION) && !url.endsWith(StringPool.AMPERSAND)) {
    sb.append(StringPool.AMPERSAND);
  }
  sb.append(name);
  sb.append(StringPool.EQUAL);
  sb.append(encodeURL(value));
  sb.append(anchor);
  return sb.toString();
}
