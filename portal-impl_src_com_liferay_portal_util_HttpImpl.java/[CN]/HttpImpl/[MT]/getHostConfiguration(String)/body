{
  if (_log.isDebugEnabled()) {
    _log.debug("Location is " + location);
  }
  HostConfiguration hostConfiguration=new HostConfiguration();
  hostConfiguration.setHost(new URI(location,false));
  if (isProxyHost(hostConfiguration.getHost())) {
    hostConfiguration.setProxy(_PROXY_HOST,_PROXY_PORT);
  }
  HttpConnectionManagerParams httpConnectionManagerParams=_httpClient.getHttpConnectionManager().getParams();
  int currentMaxConnectionsPerHost=httpConnectionManagerParams.getMaxConnectionsPerHost(hostConfiguration);
  int maxConnectionsPerHost=GetterUtil.getInteger(PropsUtil.get(_MAX_CONNECTIONS_PER_HOST_KEY,new Filter(hostConfiguration.getHost())));
  if ((maxConnectionsPerHost > 0) && (maxConnectionsPerHost != currentMaxConnectionsPerHost)) {
    httpConnectionManagerParams.setMaxConnectionsPerHost(hostConfiguration,maxConnectionsPerHost);
  }
  int timeout=GetterUtil.getInteger(PropsUtil.get(_TIMEOUT_KEY,new Filter(hostConfiguration.getHost())));
  if (timeout > 0) {
    hostConfiguration.getParams().setIntParameter(HttpConnectionParams.CONNECTION_TIMEOUT,timeout);
    hostConfiguration.getParams().setIntParameter(HttpConnectionParams.SO_TIMEOUT,timeout);
  }
  return hostConfiguration;
}
