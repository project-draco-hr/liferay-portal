{
  String xml=null;
  if (url == null) {
    return null;
  }
  String protocol=StringUtil.toLowerCase(url.getProtocol());
  if (protocol.startsWith(Http.HTTP) || protocol.startsWith(Http.HTTPS)) {
    return URLtoString(url.toString());
  }
  URLConnection urlConnection=url.openConnection();
  if (urlConnection == null) {
    if (_log.isDebugEnabled()) {
      _log.debug("Unable to open a connection to " + url);
    }
    return null;
  }
  try (InputStream inputStream=urlConnection.getInputStream();UnsyncByteArrayOutputStream unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream()){
    byte[] bytes=new byte[512];
    for (int i=inputStream.read(bytes,0,512); i != -1; i=inputStream.read(bytes,0,512)) {
      unsyncByteArrayOutputStream.write(bytes,0,i);
    }
    xml=new String(unsyncByteArrayOutputStream.unsafeGetByteArray(),0,unsyncByteArrayOutputStream.size());
  }
   return xml;
}
