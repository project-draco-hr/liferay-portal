{
  int pos=url.indexOf(StringPool.QUESTION);
  if (pos == -1) {
    return url;
  }
  int anchorPos=url.indexOf(StringPool.POUND);
  String anchor=StringPool.BLANK;
  if (anchorPos != -1) {
    anchor=url.substring(anchorPos);
    url=url.substring(0,anchorPos);
  }
  StringBuilder sb=new StringBuilder();
  sb.append(url.substring(0,pos + 1));
  StringTokenizer st=new StringTokenizer(url.substring(pos + 1,url.length()),StringPool.AMPERSAND);
  while (st.hasMoreTokens()) {
    String token=st.nextToken();
    if (Validator.isNotNull(token)) {
      String[] kvp=StringUtil.split(token,StringPool.EQUAL);
      String key=kvp[0];
      String value=StringPool.BLANK;
      if (kvp.length > 1) {
        value=kvp[1];
      }
      if (!key.equals(name)) {
        sb.append(key);
        sb.append(StringPool.EQUAL);
        sb.append(value);
        sb.append(StringPool.AMPERSAND);
      }
    }
  }
  url=StringUtil.replace(sb.toString(),StringPool.AMPERSAND + StringPool.AMPERSAND,StringPool.AMPERSAND);
  if (url.endsWith(StringPool.AMPERSAND)) {
    url=url.substring(0,url.length() - 1);
  }
  if (url.endsWith(StringPool.QUESTION)) {
    url=url.substring(0,url.length() - 1);
  }
  return url + anchor;
}
