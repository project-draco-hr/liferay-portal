{
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  if (group.isStagingGroup()) {
    group=group.getLiveGroup();
  }
  if (group.isUser()) {
    long userId=group.getClassPK();
    List<Organization> organizations=OrganizationLocalServiceUtil.getUserOrganizations(userId);
    for (    Organization organization : organizations) {
      if (OrganizationPermissionUtil.contains(permissionChecker,organization.getOrganizationId(),ActionKeys.MANAGE_USERS)) {
        return true;
      }
    }
  }
  if (actionId.equals(ActionKeys.ADD_LAYOUT)) {
    LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(groupId,false);
    if (layoutSet.isLayoutSetPrototypeLinkEnabled()) {
      LayoutSetPrototype layoutSetPrototype=LayoutSetPrototypeLocalServiceUtil.getLayoutSetPrototypeByUuid(layoutSet.getLayoutSetPrototypeUuid());
      String allowLayoutAdditions=layoutSetPrototype.getSettingsProperty("allowLayoutAdditions");
      if (Validator.isNotNull(allowLayoutAdditions) && !GetterUtil.getBoolean(allowLayoutAdditions)) {
        return false;
      }
    }
    if (permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.MANAGE_LAYOUTS)) {
      return true;
    }
  }
 else   if ((actionId.equals(ActionKeys.EXPORT_IMPORT_LAYOUTS) || actionId.equals(ActionKeys.EXPORT_IMPORT_PORTLET_INFO)) && permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.PUBLISH_STAGING)) {
    return true;
  }
 else   if (actionId.equals(ActionKeys.VIEW_STAGING) && (permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.MANAGE_LAYOUTS) || permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.MANAGE_STAGING) || permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.PUBLISH_STAGING)|| permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,ActionKeys.UPDATE))) {
    return true;
  }
  return permissionChecker.hasPermission(groupId,Group.class.getName(),groupId,actionId);
}
