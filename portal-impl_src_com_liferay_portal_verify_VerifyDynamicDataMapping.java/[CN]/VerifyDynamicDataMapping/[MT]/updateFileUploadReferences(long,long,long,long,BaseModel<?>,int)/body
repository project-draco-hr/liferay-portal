{
  Map<String,String> fieldValues=new HashMap<String,String>();
  Fields fields=StorageEngineUtil.getFields(storageId);
  for (  Field field : fields) {
    String dataType=field.getDataType();
    if (!dataType.equals("file-upload") || (field.getValue() == null)) {
      continue;
    }
    long primaryKey=GetterUtil.getLong(baseModel.getPrimaryKeyObj());
    Folder folder=addFolder(userId,groupId,primaryKey,field.getName());
    String valueString=String.valueOf(field.getValue());
    JSONObject jsonObject=JSONFactoryUtil.createJSONObject(valueString);
    String filePath=getFileUploadPath(baseModel) + StringPool.SLASH + field.getName();
    FileEntry fileEntry=addFileEntry(companyId,userId,groupId,folder.getFolderId(),jsonObject.getString("name"),filePath,status);
    fieldValues.put(field.getName(),getJSON(fileEntry));
  }
  updateFieldValues(storageId,fieldValues);
}
