{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  if (!permissionChecker.isCompanyAdmin(themeDisplay.getCompanyId())) {
    SessionErrors.add(actionRequest,PrincipalException.class);
    actionResponse.setRenderParameter("mvcPath","/error.jsp");
    return;
  }
  updateBooleanProperties(actionRequest,_ldapAuthConfigurationProvider,themeDisplay.getCompanyId(),LDAPConstants.AUTH_ENABLED,LDAPConstants.AUTH_REQUIRED,LDAPConstants.PASSWORD_POLICY_ENABLED);
  updateBooleanProperties(actionRequest,_ldapExportConfigurationProvider,themeDisplay.getCompanyId(),LDAPConstants.EXPORT_ENABLED);
  updateBooleanProperties(actionRequest,_ldapImportConfigurationProvider,themeDisplay.getCompanyId(),LDAPConstants.IMPORT_ENABLED,LDAPConstants.IMPORT_ON_STARTUP);
}
