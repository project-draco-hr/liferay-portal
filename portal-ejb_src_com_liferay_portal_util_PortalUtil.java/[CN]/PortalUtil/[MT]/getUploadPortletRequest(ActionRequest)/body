{
  ActionRequestImpl actionReq=(ActionRequestImpl)req;
  DynamicServletRequest dynamicReq=(DynamicServletRequest)actionReq.getHttpServletRequest();
  UploadServletRequest uploadReq=null;
  HttpServletRequestWrapper reqWrapper=(HttpServletRequestWrapper)dynamicReq.getRequest();
  while (uploadReq == null) {
    if (reqWrapper instanceof UploadServletRequest) {
      uploadReq=(UploadServletRequest)reqWrapper;
    }
 else {
      reqWrapper=(HttpServletRequestWrapper)reqWrapper.getRequest();
    }
  }
  return new UploadPortletRequest(uploadReq,getPortletNamespace(actionReq.getPortletName()));
}
