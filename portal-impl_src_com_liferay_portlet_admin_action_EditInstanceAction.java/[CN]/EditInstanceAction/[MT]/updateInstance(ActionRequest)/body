{
  long companyId=ParamUtil.getLong(actionRequest,"companyId");
  String webId=ParamUtil.getString(actionRequest,"webId");
  String virtualHost=ParamUtil.getString(actionRequest,"virtualHost");
  String mx=ParamUtil.getString(actionRequest,"mx");
  String shardName=ParamUtil.getString(actionRequest,"shardName",PropsValues.SHARD_DEFAULT_NAME);
  boolean system=false;
  int maxUsers=ParamUtil.getInteger(actionRequest,"maxUsers",0);
  if (companyId <= 0) {
    Company company=CompanyServiceUtil.addCompany(webId,virtualHost,mx,shardName,system,maxUsers);
    ServletContext servletContext=(ServletContext)actionRequest.getAttribute(WebKeys.CTX);
    PortalInstances.initCompany(servletContext,company.getWebId());
    ModelEventMessage modelEventMessage=ModelEventMessage.initialized(company);
    MessageBusUtil.sendMessage(DestinationNames.MODEL_EVENTS,modelEventMessage);
  }
 else {
    CompanyServiceUtil.updateCompany(companyId,virtualHost,mx,maxUsers);
  }
}
