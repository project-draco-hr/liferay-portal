{
  final TaskQueue<Object> taskQueue=new TaskQueue<Object>();
  final Object object=new Object();
  assertTrue(taskQueue.offer(object,new boolean[1]));
  assertSame(object,taskQueue.take());
  Thread takeThread=new Thread(){
    public void run(){
      try {
        for (int i=0; i < 10; i++) {
          assertEquals(i,taskQueue.take());
        }
      }
 catch (      InterruptedException ie) {
        fail();
      }
      try {
        taskQueue.take();
        fail();
      }
 catch (      InterruptedException ie) {
      }
    }
  }
;
  takeThread.start();
  for (int i=0; i < 10; i++) {
    assertTrue(taskQueue.offer(i,new boolean[1]));
  }
  Thread.sleep(TestUtil.SHORT_WAIT);
  takeThread.interrupt();
  takeThread.join();
}
