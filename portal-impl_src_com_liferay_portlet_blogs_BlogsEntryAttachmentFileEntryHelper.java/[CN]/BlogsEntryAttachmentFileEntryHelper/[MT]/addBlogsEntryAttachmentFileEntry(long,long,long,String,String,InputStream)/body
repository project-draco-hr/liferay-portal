{
  Folder folder=BlogsEntryLocalServiceUtil.addAttachmentsFolder(userId,groupId);
  fileName=fileName.replaceAll("\\(\\d+\\)\\.\\w$",StringPool.BLANK);
  FileEntry fileEntry=_fetchPortletFileEntry(groupId,fileName,folder);
  int counterSuffixValue=1;
  while (fileEntry != null) {
    String curfileName=FileUtil.updateFileName(fileName,String.valueOf(counterSuffixValue));
    fileEntry=_fetchPortletFileEntry(groupId,curfileName,folder);
    if (fileEntry == null) {
      fileName=curfileName;
      break;
    }
    counterSuffixValue++;
  }
  return PortletFileRepositoryUtil.addPortletFileEntry(groupId,userId,BlogsEntry.class.getName(),blogsEntryId,BlogsConstants.SERVICE_NAME,folder.getFolderId(),is,fileName,mimeType,true);
}
