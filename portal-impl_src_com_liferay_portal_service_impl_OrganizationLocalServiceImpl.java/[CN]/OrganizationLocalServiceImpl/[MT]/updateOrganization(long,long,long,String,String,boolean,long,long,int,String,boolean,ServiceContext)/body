{
  parentOrganizationId=getParentOrganizationId(companyId,parentOrganizationId);
  recursable=true;
  validate(companyId,organizationId,parentOrganizationId,name,type,countryId,statusId);
  Organization organization=organizationPersistence.findByPrimaryKey(organizationId);
  long oldParentOrganizationId=organization.getParentOrganizationId();
  String oldName=organization.getName();
  organization.setParentOrganizationId(parentOrganizationId);
  String treePath=organization.buildTreePath();
  organization.setTreePath(treePath);
  organization.setName(name);
  organization.setType(type);
  organization.setRecursable(recursable);
  organization.setRegionId(regionId);
  organization.setCountryId(countryId);
  organization.setStatusId(statusId);
  organization.setComments(comments);
  organizationPersistence.update(organization,false);
  Group group=organization.getGroup();
  if (!oldName.equals(name)) {
    groupLocalService.updateGroup(group.getGroupId(),name,group.getDescription(),group.getType(),group.getFriendlyURL(),group.isActive(),null);
  }
  if (group.isSite() != site) {
    groupLocalService.updateSite(group.getGroupId(),site);
  }
  if (serviceContext != null) {
    updateAsset(serviceContext.getUserId(),organization,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames());
  }
  if (serviceContext != null) {
    ExpandoBridge expandoBridge=organization.getExpandoBridge();
    expandoBridge.setAttributes(serviceContext);
  }
  Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(Organization.class);
  if (oldParentOrganizationId != parentOrganizationId) {
    long[] organizationIds=getReindexOrganizationIds(organization);
    indexer.reindex(organizationIds);
  }
 else {
    indexer.reindex(organization);
  }
  return organization;
}
