{
  User user=userPersistence.findByPrimaryKey(userId);
  List<Organization> organizations=ListUtil.copy(userPersistence.getOrganizations(userId));
  Iterator<Organization> iterator=organizations.iterator();
  while (iterator.hasNext()) {
    Organization organization=iterator.next();
    if ((organization.getCompanyId() != user.getCompanyId()) || (organization.getParentOrganization() == null)) {
      iterator.remove();
    }
  }
  if (organizations.isEmpty()) {
    return organizations;
  }
  if (obc == null) {
    obc=new OrganizationNameComparator(true);
  }
  Collections.sort(organizations,obc);
  if ((start != QueryUtil.ALL_POS) || (end != QueryUtil.ALL_POS)) {
    organizations=ListUtil.subList(organizations,start,end);
  }
  return organizations;
}
