{
  List<Organization> organizationsTree=new ArrayList<Organization>();
  organizationsTree.add(organization);
  LinkedHashMap<String,Object> organizationParams=new LinkedHashMap<String,Object>();
  organizationParams.put("organizationsTree",organizationsTree);
  List<Organization> organizations=organizationLocalService.search(organization.getCompanyId(),organizationParams,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  long[] organizationIds=new long[organizations.size()];
  for (int i=0; i < organizations.size(); i++) {
    Organization curOrganization=organizations.get(i);
    StringBundler treePath=OrganizationConstants.buildTreePath(curOrganization);
    curOrganization.setTreePath(treePath.toString());
    organizationPersistence.update(curOrganization,false);
    organizationIds[i]=curOrganization.getOrganizationId();
  }
  if (!ArrayUtil.contains(organizationIds,organization.getOrganizationId())) {
    organizationIds=ArrayUtil.append(organizationIds,organization.getOrganizationId());
  }
  return organizationIds;
}
