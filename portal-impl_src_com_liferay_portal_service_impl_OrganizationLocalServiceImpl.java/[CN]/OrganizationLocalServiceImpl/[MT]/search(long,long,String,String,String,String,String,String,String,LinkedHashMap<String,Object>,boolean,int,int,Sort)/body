{
  try {
    SearchContext searchContext=new SearchContext();
    searchContext.setAndSearch(andSearch);
    Map<String,Serializable> attributes=new HashMap<String,Serializable>();
    attributes.put("city",city);
    attributes.put("country",country);
    attributes.put("name",name);
    attributes.put("params",params);
    if (parentOrganizationId != OrganizationConstants.ANY_PARENT_ORGANIZATION_ID) {
      attributes.put("parentOrganizationId",String.valueOf(parentOrganizationId));
    }
    attributes.put("region",region);
    attributes.put("street",street);
    attributes.put("type",type);
    attributes.put("zip",zip);
    searchContext.setAttributes(attributes);
    searchContext.setCompanyId(companyId);
    searchContext.setEnd(end);
    if (params != null) {
      String keywords=(String)params.remove("keywords");
      if (Validator.isNotNull(keywords)) {
        searchContext.setKeywords(keywords);
      }
    }
    QueryConfig queryConfig=new QueryConfig();
    queryConfig.setHighlightEnabled(false);
    queryConfig.setScoreEnabled(false);
    searchContext.setQueryConfig(queryConfig);
    searchContext.setSorts(new Sort[]{sort});
    searchContext.setStart(start);
    Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(Organization.class);
    return indexer.search(searchContext);
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
