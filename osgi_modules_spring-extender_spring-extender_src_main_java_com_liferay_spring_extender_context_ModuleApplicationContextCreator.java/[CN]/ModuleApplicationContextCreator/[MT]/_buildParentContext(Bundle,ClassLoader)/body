{
  BundleContext bundleContext=bundle.getBundleContext();
  String liferayService=bundleContext.getBundle().getHeaders().get("Liferay-Service");
  if (liferayService == null) {
    return null;
  }
  GenericApplicationContext applicationContext=new GenericApplicationContext();
  XmlBeanDefinitionReader xmlBeanDefinitionReader=new XmlBeanDefinitionReader(applicationContext);
  xmlBeanDefinitionReader.setValidating(false);
  xmlBeanDefinitionReader.setValidationMode(XmlBeanDefinitionReader.VALIDATION_NONE);
  Enumeration<URL> entries=bundle.findEntries("META-INF/spring/parent","*.xml",true);
  applicationContext.setClassLoader(classLoader);
  while (entries.hasMoreElements()) {
    URL xmlBeanDefinitionUrl=entries.nextElement();
    InputStream inputStream=xmlBeanDefinitionUrl.openStream();
    xmlBeanDefinitionReader.loadBeanDefinitions(new InputStreamResource(inputStream));
  }
  applicationContext.refresh();
  return applicationContext;
}
