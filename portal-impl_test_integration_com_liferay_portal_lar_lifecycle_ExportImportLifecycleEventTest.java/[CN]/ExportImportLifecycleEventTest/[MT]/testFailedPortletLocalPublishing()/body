{
  PortletRequestImpl portletRequest=PowerMockito.mock(PortletRequestImpl.class);
  MockHttpServletRequest mockHttpServletRequest=new MockHttpServletRequest();
  mockHttpServletRequest.setAttribute(WebKeys.USER_ID,TestPropsValues.getUserId());
  ThemeDisplay themeDisplay=new ThemeDisplay();
  themeDisplay.setLocale(LocaleUtil.getDefault());
  when(portletRequest.getAttribute(WebKeys.THEME_DISPLAY)).thenReturn(themeDisplay);
  when(portletRequest.getHttpServletRequest()).thenReturn(mockHttpServletRequest);
  try {
    StagingUtil.copyPortlet(portletRequest,_group.getGroupId(),_liveGroup.getGroupId(),0,0,StringPool.BLANK);
  }
 catch (  Throwable t) {
    if (_log.isInfoEnabled()) {
      _log.info(t);
    }
  }
  Assert.assertTrue(_firedExportImportLifecycleEventsMap.containsKey(ExportImportLifecycleConstants.EVENT_PUBLICATION_PORTLET_LOCAL_FAILED));
}
