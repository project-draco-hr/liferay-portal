{
  AuthVerifierResult authVerifierResult=new AuthVerifierResult();
  try {
    String[] credentials=verify(accessControlContext.getRequest());
    if (credentials != null) {
      authVerifierResult.setPassword(credentials[1]);
      authVerifierResult.setState(AuthVerifierResult.State.SUCCESS);
      authVerifierResult.setUserId(Long.valueOf(credentials[0]));
    }
  }
 catch (  AuthException ae) {
    if (_log.isDebugEnabled()) {
      _log.debug(ae);
    }
    HttpServletResponse response=accessControlContext.getResponse();
    try {
      try (ObjectOutputStream objectOutputStream=new ObjectOutputStream(response.getOutputStream())){
        objectOutputStream.writeObject(ae);
        objectOutputStream.flush();
      }
       authVerifierResult.setState(AuthVerifierResult.State.INVALID_CREDENTIALS);
    }
 catch (    IOException ioe) {
      _log.error(ioe,ioe);
      throw ae;
    }
  }
  return authVerifierResult;
}
