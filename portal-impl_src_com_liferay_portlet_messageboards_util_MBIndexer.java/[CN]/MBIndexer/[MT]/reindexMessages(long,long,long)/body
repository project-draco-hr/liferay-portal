{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(MBMessage.class,PortalClassLoaderUtil.getClassLoader());
  Projection minMessageIdProjection=ProjectionFactoryUtil.min("messageId");
  Projection maxMessageIdProjection=ProjectionFactoryUtil.max("messageId");
  ProjectionList projectionList=ProjectionFactoryUtil.projectionList();
  projectionList.add(minMessageIdProjection);
  projectionList.add(maxMessageIdProjection);
  dynamicQuery.setProjection(projectionList);
  addReindexCriteria(dynamicQuery,groupId,categoryId);
  List<Object[]> results=MBMessageLocalServiceUtil.dynamicQuery(dynamicQuery);
  Object[] minAndMaxMessageIds=results.get(0);
  if ((minAndMaxMessageIds[0] == null) || (minAndMaxMessageIds[1] == null)) {
    return;
  }
  long minMessageId=(Long)minAndMaxMessageIds[0];
  long maxMessageId=(Long)minAndMaxMessageIds[1];
  long startMessageId=minMessageId;
  long endMessageId=startMessageId + DEFAULT_INTERVAL;
  while (startMessageId <= maxMessageId) {
    reindexMessages(companyId,groupId,categoryId,startMessageId,endMessageId);
    startMessageId=endMessageId;
    endMessageId+=DEFAULT_INTERVAL;
  }
}
