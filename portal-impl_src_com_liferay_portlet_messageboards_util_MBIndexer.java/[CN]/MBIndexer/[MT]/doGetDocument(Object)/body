{
  MBMessage message=(MBMessage)obj;
  Document document=getBaseModelDocument(PORTLET_ID,message);
  document.addKeyword(Field.CATEGORY_ID,message.getCategoryId());
  document.addText(Field.CONTENT,processContent(message));
  document.addKeyword(Field.ROOT_ENTRY_CLASS_PK,message.getRootMessageId());
  document.addText(Field.TITLE,message.getSubject());
  if (message.isAnonymous()) {
    document.remove(Field.USER_NAME);
  }
  document.addKeyword("threadId",message.getThreadId());
  MBDiscussion discussion=MBDiscussionUtil.fetchByThreadId(message.getThreadId());
  if (discussion != null) {
    document.addKeyword("discussion",true);
  }
 else {
    document.addKeyword("discussion",false);
  }
  return document;
}
