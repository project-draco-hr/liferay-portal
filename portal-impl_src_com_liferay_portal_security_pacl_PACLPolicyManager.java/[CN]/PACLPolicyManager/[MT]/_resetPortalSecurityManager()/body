{
  if (_originalSecurityManager instanceof PortalSecurityManager) {
    return;
  }
  if (!SecurityManagerUtil.isSmart()) {
    return;
  }
  try {
    if (_log.isInfoEnabled()) {
      _log.info("Resetting to the original security manager");
    }
    boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
    try {
      PortalSecurityManagerThreadLocal.setEnabled(false);
      System.setSecurityManager(_originalSecurityManager);
    }
  finally {
      PortalSecurityManagerThreadLocal.setEnabled(enabled);
    }
  }
 catch (  SecurityException se) {
    _log.error("Unable to reset to the original security manager");
    throw se;
  }
}
