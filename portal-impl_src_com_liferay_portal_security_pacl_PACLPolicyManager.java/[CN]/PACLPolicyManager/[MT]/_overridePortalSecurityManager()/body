{
  String portalSecurityManagerStrategy=PropsValues.PORTAL_SECURITY_MANAGER_STRATEGY;
  if (!portalSecurityManagerStrategy.equals("smart")) {
    if (_log.isInfoEnabled()) {
      StringBundler sb=new StringBundler(4);
      sb.append("Plugin security management is not enabled. To ");
      sb.append("enable plugin security management, set the ");
      sb.append("property \"portal.security.manager.strategy\" in ");
      sb.append("portal.properties to \"liferay\" or \"smart\".");
      _log.info(sb.toString());
    }
    return;
  }
  _originalSecurityManager=System.getSecurityManager();
  if (_originalSecurityManager instanceof PortalSecurityManager) {
    return;
  }
  try {
    if (_log.isInfoEnabled()) {
      _log.info("Overriding the current security manager to enable " + "plugin security management");
    }
    ClassLoader classLoader=PortalClassLoaderUtil.getClassLoader();
    PortalSecurityManager portalSecurityManager=new PortalSecurityManager(_originalSecurityManager,classLoader);
    System.setSecurityManager(portalSecurityManager);
  }
 catch (  SecurityException se) {
    _log.error("Unable to override the current security manager. Plugin " + "security management is not enabled.");
    throw se;
  }
}
