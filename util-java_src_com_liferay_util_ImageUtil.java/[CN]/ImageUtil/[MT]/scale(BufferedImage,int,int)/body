{
  int imageHeight=image.getHeight();
  int imageWidth=image.getWidth();
  if (maxHeight == 0) {
    maxHeight=imageHeight;
  }
  if (maxWidth == 0) {
    maxWidth=imageWidth;
  }
  if ((imageHeight <= maxHeight) && (imageWidth <= maxWidth)) {
    return image;
  }
  double factor=0.1;
  int heightDelta=imageHeight - maxHeight;
  int widthDelta=imageWidth - maxWidth;
  if (heightDelta > widthDelta) {
    factor=(double)maxHeight / imageHeight;
  }
 else {
    factor=(double)maxWidth / imageWidth;
  }
  return scale(image,factor);
}
