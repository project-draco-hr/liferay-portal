{
  MBMessage message=mbMessagePersistence.findByPrimaryKey(messageId);
  if (!message.isRoot()) {
    return;
  }
  MBMessageFlag questionMessageFlag=mbMessageFlagPersistence.fetchByU_M_F(message.getUserId(),message.getMessageId(),MBMessageFlagConstants.QUESTION_FLAG);
  MBMessageFlag answerMessageFlag=mbMessageFlagPersistence.fetchByU_M_F(message.getUserId(),message.getMessageId(),MBMessageFlagConstants.ANSWER_FLAG);
  if ((questionMessageFlag == null) && (answerMessageFlag == null)) {
    long messageFlagId=counterLocalService.increment();
    questionMessageFlag=mbMessageFlagPersistence.create(messageFlagId);
    questionMessageFlag.setUserId(message.getUserId());
    questionMessageFlag.setModifiedDate(new Date());
    questionMessageFlag.setThreadId(message.getThreadId());
    questionMessageFlag.setMessageId(message.getMessageId());
    questionMessageFlag.setFlag(MBMessageFlagConstants.QUESTION_FLAG);
    mbMessageFlagPersistence.update(questionMessageFlag,false);
  }
}
