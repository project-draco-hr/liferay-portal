{
  ClassLoader contextClassLoader=Thread.currentThread().getContextClassLoader();
  Object target=methodWrapper.getTarget();
  String className=methodWrapper.getClassName();
  String methodName=methodWrapper.getMethodName();
  Object[] args=methodWrapper.getArgs();
  List<Class<?>> parameterTypes=new ArrayList<Class<?>>();
  for (int i=0; i < args.length; i++) {
    if (args[i] == null) {
      _log.error("Cannot invoke " + className + " "+ methodName+ " on position "+ i+ " because it is null");
    }
    Class<?> argClass=args[i].getClass();
    if (ClassUtil.isSubclass(argClass,PrimitiveWrapper.class)) {
      parameterTypes.add((Class<?>)argClass.getField("TYPE").get(args[i]));
      MethodKey methodKey=new MethodKey(argClass.getName(),"getValue",null);
      Method method=MethodCache.get(methodKey);
      args[i]=method.invoke(args[i],(Object[])null);
    }
 else     if (args[i] instanceof NullWrapper) {
      NullWrapper nullWrapper=(NullWrapper)args[i];
      String wrappedClassName=nullWrapper.getClassName();
      if (wrappedClassName.startsWith(StringPool.OPEN_BRACKET) && wrappedClassName.endsWith(StringPool.SEMICOLON)) {
        wrappedClassName=wrappedClassName.substring(2,wrappedClassName.length() - 1);
        Class<?> wrappedClass=contextClassLoader.loadClass(wrappedClassName);
        parameterTypes.add(Array.newInstance(wrappedClass,0).getClass());
      }
 else {
        Class<?> wrappedClass=contextClassLoader.loadClass(wrappedClassName);
        parameterTypes.add(wrappedClass);
      }
      args[i]=null;
    }
 else {
      parameterTypes.add(argClass);
    }
  }
  Object classObj=contextClassLoader.loadClass(className);
  if ((target == null) && newInstance) {
    classObj=((Class<?>)classObj).newInstance();
  }
  Method method=null;
  try {
    MethodKey methodKey=new MethodKey(methodWrapper.getClassName(),methodWrapper.getMethodName(),parameterTypes.toArray(new Class[parameterTypes.size()]));
    method=MethodCache.get(methodKey);
  }
 catch (  NoSuchMethodException nsme) {
    Method[] methods=null;
    if ((target != null) || (!newInstance)) {
      methods=((Class<?>)classObj).getMethods();
    }
 else {
      methods=classObj.getClass().getMethods();
    }
    for (int i=0; i < methods.length; i++) {
      Class<?>[] methodParameterTypes=methods[i].getParameterTypes();
      String QQ=methods[i].getName();
      if (methods[i].getName().equals(methodName) && methodParameterTypes.length == parameterTypes.size()) {
        boolean correctParams=true;
        for (int j=0; j < parameterTypes.size(); j++) {
          Class<?> a=parameterTypes.get(j);
          Class<?> b=methodParameterTypes[j];
          if (!ClassUtil.isSubclass(a,b)) {
            correctParams=false;
            break;
          }
        }
        if (correctParams) {
          method=methods[i];
          break;
        }
      }
    }
    if (method == null) {
      throw nsme;
    }
  }
  Object returnObj=null;
  if (method != null) {
    if (target != null) {
      returnObj=method.invoke(target,args);
    }
 else {
      returnObj=method.invoke(classObj,args);
    }
  }
  return returnObj;
}
