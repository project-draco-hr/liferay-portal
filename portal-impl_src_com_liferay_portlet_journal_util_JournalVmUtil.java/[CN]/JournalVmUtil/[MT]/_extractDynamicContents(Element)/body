{
  List<TemplateNode> nodes=new ArrayList<TemplateNode>();
  for (  Element el : (List<Element>)parent.elementIterator("dynamic-element")) {
    Element content=el.element("dynamic-content");
    if (content == null) {
      throw new TransformException("Element missing \"dynamic-content\"");
    }
    String name=el.attributeValue("name","");
    if (name.length() == 0) {
      throw new TransformException("Element missing \"name\" attribute");
    }
    String type=el.attributeValue("type","");
    TemplateNode node=new TemplateNode(name,CDATAUtil.strip(content.getText()),type);
    if (el.element("dynamic-element") != null) {
      node.appendChildren(_extractDynamicContents(el));
    }
 else     if (content.element("option") != null) {
      for (      Element option : (List<Element>)content.elementIterator("option")) {
        node.appendOption(CDATAUtil.strip(option.getText()));
      }
    }
    nodes.add(node);
  }
  return nodes;
}
