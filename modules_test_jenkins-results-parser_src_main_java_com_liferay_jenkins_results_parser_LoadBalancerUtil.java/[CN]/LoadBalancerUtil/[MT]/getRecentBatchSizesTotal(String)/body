{
  List<BatchRecord> recentBatchRecords=_recentBatchRecordsMap.get(master);
  if ((recentBatchRecords == null) || recentBatchRecords.isEmpty()) {
    return 0;
  }
  int recentBatchSizesTotal=0;
  List<BatchRecord> oldBatchRecords=new ArrayList<>(recentBatchRecords.size());
  for (  BatchRecord recentBatchRecord : recentBatchRecords) {
    if ((recentBatchRecord.timestamp + _RECENT_BATCH_AGE) > System.currentTimeMillis()) {
      recentBatchSizesTotal+=recentBatchRecord.size;
    }
 else {
      oldBatchRecords.add(recentBatchRecord);
    }
  }
  recentBatchRecords.removeAll(oldBatchRecords);
  return recentBatchSizesTotal;
}
