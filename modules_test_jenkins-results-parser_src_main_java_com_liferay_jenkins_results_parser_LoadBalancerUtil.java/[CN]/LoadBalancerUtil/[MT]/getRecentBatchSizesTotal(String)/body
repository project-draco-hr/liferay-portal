{
  List<BatchSizeRecord> masterRecentBatchSizes=_recentBatchSizesMap.get(master);
  if ((masterRecentBatchSizes == null) || masterRecentBatchSizes.isEmpty()) {
    return 0;
  }
  int recentBatchSizesTotal=0;
  List<BatchSizeRecord> masterRecentBatchSizeEntriesToBeRemoved=new ArrayList<>(masterRecentBatchSizes.size());
  for (  BatchSizeRecord recentBatchSizeRecord : masterRecentBatchSizes) {
    if ((recentBatchSizeRecord.timestamp + recentBatchPeriod) > System.currentTimeMillis()) {
      recentBatchSizesTotal+=recentBatchSizeRecord.size;
    }
 else {
      masterRecentBatchSizeEntriesToBeRemoved.add(recentBatchSizeRecord);
    }
  }
  masterRecentBatchSizes.removeAll(masterRecentBatchSizeEntriesToBeRemoved);
  return recentBatchSizesTotal;
}
