{
  List<BatchSizeRecord> recentBatchSizeRecords=_recentBatchSizeRecordsMap.get(master);
  if ((recentBatchSizeRecords == null) || recentBatchSizeRecords.isEmpty()) {
    return 0;
  }
  int recentBatchSizesTotal=0;
  List<BatchSizeRecord> oldBatchSizeRecords=new ArrayList<>(recentBatchSizeRecords.size());
  for (  BatchSizeRecord recentBatchSizeRecord : recentBatchSizeRecords) {
    if ((recentBatchSizeRecord.timestamp + recentBatchPeriod) > System.currentTimeMillis()) {
      recentBatchSizesTotal+=recentBatchSizeRecord.size;
    }
 else {
      oldBatchSizeRecords.add(recentBatchSizeRecord);
    }
  }
  recentBatchSizeRecords.removeAll(oldBatchSizeRecords);
  return recentBatchSizesTotal;
}
