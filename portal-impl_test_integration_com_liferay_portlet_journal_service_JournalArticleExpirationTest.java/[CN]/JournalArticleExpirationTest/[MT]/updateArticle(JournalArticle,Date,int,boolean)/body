{
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(article.getGroupId());
  if (approved) {
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_PUBLISH);
  }
 else {
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
  }
  Calendar displayDateCalendar=getCalendar(article.getDisplayDate(),when);
  Calendar expirationDateCalendar=getCalendar(expirationDate,when);
  return JournalArticleLocalServiceUtil.updateArticle(TestPropsValues.getUserId(),article.getGroupId(),article.getFolderId(),article.getArticleId(),article.getVersion(),article.getTitleMap(),article.getDescriptionMap(),article.getContent(),article.getDDMStructureKey(),article.getDDMTemplateKey(),article.getLayoutUuid(),displayDateCalendar.get(Calendar.MONTH),displayDateCalendar.get(Calendar.DAY_OF_MONTH),displayDateCalendar.get(Calendar.YEAR),displayDateCalendar.get(Calendar.HOUR_OF_DAY),displayDateCalendar.get(Calendar.MINUTE),expirationDateCalendar.get(Calendar.MONTH),expirationDateCalendar.get(Calendar.DAY_OF_MONTH),expirationDateCalendar.get(Calendar.YEAR),expirationDateCalendar.get(Calendar.HOUR_OF_DAY),expirationDateCalendar.get(Calendar.MINUTE),true,0,0,0,0,0,true,article.getIndexable(),article.isSmallImage(),article.getSmallImageURL(),null,null,null,serviceContext);
}
