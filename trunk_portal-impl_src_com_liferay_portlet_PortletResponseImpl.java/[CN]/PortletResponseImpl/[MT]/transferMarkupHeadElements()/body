{
  List<Element> elements=_markupHeadElements.get(MimeResponse.MARKUP_HEAD_ELEMENT);
  if ((elements == null) || elements.isEmpty()) {
    return;
  }
  HttpServletRequest request=getHttpServletRequest();
  List<String> markupHeadElements=(List<String>)request.getAttribute(MimeResponse.MARKUP_HEAD_ELEMENT);
  if (markupHeadElements == null) {
    markupHeadElements=new ArrayList<String>();
    request.setAttribute(MimeResponse.MARKUP_HEAD_ELEMENT,markupHeadElements);
  }
  for (  Element element : elements) {
    try {
      Writer writer=new UnsyncStringWriter();
      TransformerFactory transformerFactory=TransformerFactory.newInstance();
      Transformer transformer=transformerFactory.newTransformer();
      transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION,"yes");
      transformer.transform(new DOMSource(element),new StreamResult(writer));
      markupHeadElements.add(writer.toString());
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
}
