{
  long groupId=PortalUtil.getPortletGroupId(req);
  String className=ParamUtil.getString(req,"className");
  String classPK=ParamUtil.getString(req,"classPK");
  String messageId=ParamUtil.getString(req,"messageId");
  String threadId=ParamUtil.getString(req,"threadId");
  String parentMessageId=ParamUtil.getString(req,"parentMessageId");
  String subject=ParamUtil.getString(req,"subject");
  String body=ParamUtil.getString(req,"body");
  if (Validator.isNull(messageId)) {
    MBMessageServiceUtil.addDiscussionMessage(groupId,className,classPK,threadId,parentMessageId,subject,body);
  }
 else {
    MBMessageServiceUtil.updateDiscussionMessage(groupId,className,classPK,messageId,subject,body);
  }
}
