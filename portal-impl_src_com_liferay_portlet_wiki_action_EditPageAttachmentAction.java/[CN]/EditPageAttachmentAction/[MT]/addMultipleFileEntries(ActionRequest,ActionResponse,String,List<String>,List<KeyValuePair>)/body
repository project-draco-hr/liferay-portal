{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long nodeId=ParamUtil.getLong(actionRequest,"nodeId");
  String title=ParamUtil.getString(actionRequest,"title");
  File file=null;
  try {
    file=TempFileUtil.getTempFile(themeDisplay.getUserId(),selectedFileName,_TEMP_FOLDER_NAME);
    if (file == null) {
      return;
    }
    byte[] bytes=FileUtil.getBytes(file);
    if ((bytes == null) || (bytes.length == 0)) {
      return;
    }
    WikiPageServiceUtil.addPageAttachment(nodeId,title,selectedFileName,bytes);
    validFileNames.add(selectedFileName);
  }
 catch (  Exception e) {
    String errorMessage=getAddMultipleFileEntriesErrorMessage(themeDisplay,e);
    invalidFileNameKVPs.add(new KeyValuePair(selectedFileName,errorMessage));
  }
 finally {
    FileUtil.delete(file);
  }
}
