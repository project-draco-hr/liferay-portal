{
  long userId=_counter.get();
  if (Validator.isNull(screenName)) {
    screenName=String.valueOf(userId);
  }
  User user=new UserImpl();
  user.setUuid(SequentialUUID.generate());
  user.setUserId(userId);
  user.setCompanyId(_company.getCompanyId());
  user.setCreateDate(newDate());
  user.setModifiedDate(newDate());
  user.setDefaultUser(defaultUser);
  user.setContactId(_counter.get());
  user.setPassword("test");
  user.setPasswordModifiedDate(newDate());
  user.setReminderQueryQuestion("What is your screen name?");
  user.setReminderQueryAnswer(screenName);
  user.setEmailAddress(screenName + "@liferay.com");
  user.setScreenName(screenName);
  user.setLanguageId("en_US");
  user.setGreeting("Welcome " + screenName + StringPool.EXCLAMATION);
  user.setFirstName(firstName);
  user.setLastName(lastName);
  user.setLoginDate(newDate());
  user.setLastLoginDate(newDate());
  user.setLastFailedLoginDate(newDate());
  user.setLockoutDate(newDate());
  user.setAgreedToTermsOfUse(true);
  user.setEmailAddressVerified(true);
  return user;
}
