{
  long classNameId=mbMessage.getClassNameId();
  long classPk=mbMessage.getClassPK();
  int type=0;
  String extraData=null;
  if (classNameId == _classNamesMap.get(WikiPage.class.getName())) {
    extraData="{\"version\":1}";
    type=WikiActivityKeys.ADD_PAGE;
  }
 else   if (classNameId == 0) {
    extraData="{\"title\":\"" + mbMessage.getSubject() + "\"}";
    type=MBActivityKeys.ADD_MESSAGE;
    classNameId=_classNamesMap.get(MBMessage.class.getName());
    classPk=mbMessage.getMessageId();
  }
 else {
    StringBundler sb=new StringBundler(5);
    sb.append("{\"messageId\":\"");
    sb.append(mbMessage.getMessageId());
    sb.append("\", \"title\":");
    sb.append(mbMessage.getSubject());
    sb.append("}");
    extraData=sb.toString();
    type=SocialActivityConstants.TYPE_ADD_COMMENT;
  }
  return newSocialActivity(mbMessage.getGroupId(),classNameId,classPk,type,extraData);
}
