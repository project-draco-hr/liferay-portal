{
  ShoppingCart cart=(ShoppingCart)_cartsPool.remove(sessionId);
  if (cart != null && cart.getItemsSize() > 0) {
    cart=_updateUserCart(userId,cart.getItemIds(),cart.getCouponIds(),cart.getAltShipping(),cart.isInsure());
  }
 else {
    try {
      cart=ShoppingCartUtil.findByPrimaryKey(userId);
    }
 catch (    NoSuchCartException nsce) {
      cart=_emptyUserCart(userId);
    }
  }
  return cart;
}
