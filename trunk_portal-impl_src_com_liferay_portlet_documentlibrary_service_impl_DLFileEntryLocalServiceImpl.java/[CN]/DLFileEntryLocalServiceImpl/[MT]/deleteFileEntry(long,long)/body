{
  boolean hasLock=hasFileEntryLock(userId,fileEntryId);
  if (!hasLock) {
    lockFileEntry(userId,fileEntryId);
  }
  try {
    deleteFileEntry(fileEntryId);
  }
  finally {
    unlockFileEntry(fileEntryId);
  }
}
