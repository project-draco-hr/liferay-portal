{
  ServletContext servletContext=super.getServletContext();
  try {
    if (Validator.isNull(_portletId)) {
      return servletContext;
    }
    HttpServletRequest request=getServletRequest();
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),_portletId);
    if (portlet == null) {
      return servletContext;
    }
    PortletApp portletApp=portlet.getPortletApp();
    if (!portletApp.isWARFile()) {
      return servletContext;
    }
    return PortalUtil.getServletContext(portlet,servletContext);
  }
 catch (  SystemException se) {
    return servletContext;
  }
}
