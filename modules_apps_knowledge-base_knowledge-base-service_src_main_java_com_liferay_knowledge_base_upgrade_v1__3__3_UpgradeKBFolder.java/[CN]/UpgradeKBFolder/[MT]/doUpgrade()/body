{
  Connection con=null;
  try {
    con=DataAccess.getUpgradeOptimizedConnection();
    Map<Long,String> urlTitles=_getInitialUrlTitles(con);
    for (    Map.Entry<Long,String> entry : urlTitles.entrySet()) {
      String uniqueUrlTitle=_findUniqueUrlTitle(con,entry.getValue());
      for (int i=1; uniqueUrlTitle == null; i++) {
        uniqueUrlTitle=_findUniqueUrlTitle(con,entry.getValue() + StringPool.DASH + i);
      }
      _updateKBFolder(con,entry.getKey(),uniqueUrlTitle);
    }
  }
  finally {
    DataAccess.cleanUp(con);
  }
}
