{
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    ps=con.prepareStatement("select kbFolderId, name from KBFolder where " + "(KBFolder.urlTitle is null) or (KBFolder.urlTitle = '')");
    rs=ps.executeQuery();
    Map<Long,String> urlTitles=new HashMap<>();
    while (rs.next()) {
      long kbFolderId=rs.getLong(1);
      String name=rs.getString(2);
      String urlTitle=KnowledgeBaseUtil.getUrlTitle(kbFolderId,name);
      urlTitles.put(kbFolderId,urlTitle);
    }
    return urlTitles;
  }
  finally {
    DataAccess.cleanUp(ps);
    DataAccess.cleanUp(rs);
  }
}
