{
  User user=userPersistence.findByPrimaryKey(serviceContext.getGuestOrUserId());
  KaleoInstanceToken kaleoInstanceToken=kaleoInstanceTokenPersistence.findByPrimaryKey(kaleoInstanceTokenId);
  KaleoTimer kaleoTimer=kaleoTimerPersistence.findByPrimaryKey(kaleoTimerId);
  Date now=new Date();
  long kaleoTimerInstanceTokenId=counterLocalService.increment();
  KaleoTimerInstanceToken kaleoTimerInstanceToken=kaleoTimerInstanceTokenPersistence.create(kaleoTimerInstanceTokenId);
  long groupId=StagingUtil.getLiveGroupId(serviceContext.getScopeGroupId());
  kaleoTimerInstanceToken.setGroupId(groupId);
  kaleoTimerInstanceToken.setCompanyId(user.getCompanyId());
  kaleoTimerInstanceToken.setUserId(user.getUserId());
  kaleoTimerInstanceToken.setUserName(user.getFullName());
  kaleoTimerInstanceToken.setCreateDate(now);
  kaleoTimerInstanceToken.setModifiedDate(now);
  kaleoTimerInstanceToken.setKaleoClassName(kaleoTimer.getKaleoClassName());
  kaleoTimerInstanceToken.setKaleoClassPK(kaleoTimer.getKaleoClassPK());
  kaleoTimerInstanceToken.setKaleoDefinitionId(kaleoInstanceToken.getKaleoDefinitionId());
  kaleoTimerInstanceToken.setKaleoInstanceId(kaleoInstanceToken.getKaleoInstanceId());
  kaleoTimerInstanceToken.setKaleoInstanceTokenId(kaleoInstanceTokenId);
  kaleoTimerInstanceToken.setKaleoTaskInstanceTokenId(kaleoTaskInstanceTokenId);
  kaleoTimerInstanceToken.setKaleoTimerId(kaleoTimerId);
  kaleoTimerInstanceToken.setKaleoTimerName(kaleoTimerName);
  kaleoTimerInstanceToken.setBlocking(kaleoTimer.isBlocking());
  kaleoTimerInstanceToken.setCompleted(false);
  kaleoTimerInstanceToken.setWorkflowContext(WorkflowContextUtil.convert(workflowContext));
  kaleoTimerInstanceTokenPersistence.update(kaleoTimerInstanceToken);
  scheduleTimer(kaleoTimerInstanceToken,kaleoTimer);
  return kaleoTimerInstanceToken;
}
