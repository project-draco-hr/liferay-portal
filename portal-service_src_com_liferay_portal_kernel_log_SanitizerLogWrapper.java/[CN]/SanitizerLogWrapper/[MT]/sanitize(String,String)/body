{
  if (message == null) {
    return null;
  }
  char[] chars=message.toCharArray();
  boolean sanitized=false;
  for (int i=0; i < chars.length; i++) {
    int c=chars[i];
    if ((c >= 0) && (c < _whitelistCharacters.length) && (_whitelistCharacters[c] == 0)) {
      chars[i]=_LOG_SANITIZER_REPLACEMENT_CHARACTER;
      sanitized=true;
    }
  }
  if (sanitized) {
    String sanitizedMessage=new String(chars);
    sanitizedMessage=sanitizedMessage.concat(_SANITIZED);
    if (_LOG_SANITIZER_ESCAPE_HTML_ENABLED) {
      return HtmlUtil.escape(sanitizedMessage);
    }
    return sanitizedMessage;
  }
  return defaultResult;
}
