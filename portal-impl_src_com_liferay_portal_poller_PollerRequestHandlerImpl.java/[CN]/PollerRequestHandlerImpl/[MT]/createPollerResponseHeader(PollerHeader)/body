{
  if (pollerHeader == null) {
    return null;
  }
  boolean suspendPolling=false;
  if (pollerHeader.isStartPolling()) {
    BrowserTrackerLocalServiceUtil.updateBrowserTracker(pollerHeader.getUserId(),pollerHeader.getBrowserKey());
  }
 else {
    BrowserTracker browserTracker=BrowserTrackerLocalServiceUtil.getBrowserTracker(pollerHeader.getUserId(),pollerHeader.getBrowserKey());
    if (browserTracker.getBrowserKey() != pollerHeader.getBrowserKey()) {
      suspendPolling=true;
    }
  }
  JSONObject pollerResponseHeader=JSONFactoryUtil.createJSONObject();
  pollerResponseHeader.put("userId",pollerHeader.getUserId());
  pollerResponseHeader.put("initialRequest",pollerHeader.isInitialRequest());
  pollerResponseHeader.put("suspendPolling",suspendPolling);
  return pollerResponseHeader;
}
