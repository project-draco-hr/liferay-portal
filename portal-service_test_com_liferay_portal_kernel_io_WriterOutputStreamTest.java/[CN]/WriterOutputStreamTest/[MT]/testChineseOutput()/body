{
  Writer writer=new StringWriter();
  OutputStream outputStream=new WriterOutputStream(writer,StringPool.UTF8,true);
  String[] chineseOutput={"??????","??????","??????","?????? ","??????"};
  byte[][] chineseInput={chineseOutput[0].getBytes(),chineseOutput[1].getBytes(),chineseOutput[2].getBytes(),chineseOutput[3].getBytes(),chineseOutput[4].getBytes()};
  String expectedResult=chineseOutput[0];
  outputStream.write(chineseInput[0]);
  assertEquals(expectedResult,writer.toString());
  expectedResult+=chineseOutput[1];
  outputStream.write(chineseInput[1]);
  assertEquals(expectedResult,writer.toString());
  expectedResult+=chineseOutput[2];
  outputStream.write(chineseInput[2]);
  assertEquals(expectedResult,writer.toString());
  expectedResult+=chineseOutput[3];
  outputStream.write(chineseInput[3]);
  assertEquals(expectedResult,writer.toString());
  expectedResult+=chineseOutput[4];
  outputStream.write(chineseInput[4]);
  assertEquals(expectedResult,writer.toString());
  writer=new StringWriter();
  outputStream=new WriterOutputStream(writer,StringPool.UTF8,false);
  outputStream.write(chineseInput[0]);
  assertEquals("",writer.toString());
  outputStream.write(chineseInput[1]);
  assertEquals("",writer.toString());
  outputStream.write(chineseInput[2]);
  assertEquals("",writer.toString());
  outputStream.write(chineseInput[3]);
  assertEquals("",writer.toString());
  outputStream.write(chineseInput[4]);
  assertEquals("",writer.toString());
  outputStream.flush();
  assertEquals(expectedResult,writer.toString());
}
