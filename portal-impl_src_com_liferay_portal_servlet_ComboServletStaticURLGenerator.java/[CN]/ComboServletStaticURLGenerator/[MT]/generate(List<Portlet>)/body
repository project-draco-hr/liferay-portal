{
  List<String> urls=new ArrayList<>();
  StringBundler sb=new StringBundler();
  long timestamp=_timestamp;
  portlets=ListUtil.sort(portlets,_portletNameComparator);
  for (  Portlet portlet : portlets) {
    for (    PortletResourceAccessor portletResourceAccessor : _portletResourceAccessors) {
      List<String> portletResources=portletResourceAccessor.get(portlet);
      for (      String portletResource : portletResources) {
        if (!_predicateFilter.filter(portletResource)) {
          continue;
        }
        String portletResourceURL=portletResource;
        if (!HttpUtil.hasProtocol(portletResource)) {
          portletResourceURL=portlet.getContextPath() + portletResource;
        }
        if (_visitedURLs.contains(portletResourceURL)) {
          continue;
        }
        if (HttpUtil.hasProtocol(portletResource)) {
          urls.add(portletResource);
        }
 else {
          sb.append(StringPool.AMPERSAND);
          if (!portletResourceAccessor.isPortalResource()) {
            sb.append(portlet.getPortletId());
            sb.append(StringPool.COLON);
          }
          sb.append(HtmlUtil.escapeURL(portletResource));
          timestamp=Math.max(timestamp,portlet.getTimestamp());
        }
        _visitedURLs.add(portletResourceURL);
      }
    }
  }
  if (sb.length() > 0) {
    String url=_urlPrefix + sb.toString();
    url=HttpUtil.addParameter(url,"t",timestamp);
    urls.add(url);
  }
  return urls;
}
