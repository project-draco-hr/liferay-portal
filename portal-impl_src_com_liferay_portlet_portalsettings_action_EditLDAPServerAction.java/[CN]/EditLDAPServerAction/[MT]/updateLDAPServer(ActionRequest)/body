{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long ldapServerId=ParamUtil.getLong(actionRequest,"ldapServerId");
  UnicodeProperties properties=PropertiesParamUtil.getProperties(actionRequest,"settings--");
  validateLDAPServerName(ldapServerId,themeDisplay.getCompanyId(),properties);
  String userFilter=ParamUtil.getString(actionRequest,"importUserSearchFilter");
  LDAPUtil.validateFilter(userFilter);
  String groupFilter=ParamUtil.getString(actionRequest,"importGroupSearchFilter");
  LDAPUtil.validateFilter(groupFilter);
  if (ldapServerId <= 0) {
    properties=addLDAPServer(themeDisplay.getCompanyId(),properties);
  }
  CompanyServiceUtil.updatePreferences(themeDisplay.getCompanyId(),properties);
}
