{
  long classNameId=PortalUtil.getClassNameId(className);
  List<SocialEquitySetting> equitySettings=getEquitySettings(groupId,className,equityActionMapping.getActionId());
  for (  SocialEquitySetting equitySetting : equitySettings) {
    if (!equityActionMapping.equals(equitySetting)) {
      equitySetting.update(equityActionMapping);
      if (equitySetting.getPrimaryKey() == 0) {
        Group group=groupLocalService.getGroup(groupId);
        equitySetting.setPrimaryKey(counterLocalService.increment());
        equitySetting.setGroupId(groupId);
        equitySetting.setCompanyId(group.getCompanyId());
        equitySetting.setClassNameId(classNameId);
      }
      socialEquitySettingPersistence.update(equitySetting,false);
    }
  }
  String key=encodeKey(classNameId,equityActionMapping.getActionId());
  _portalCache.remove(key);
}
