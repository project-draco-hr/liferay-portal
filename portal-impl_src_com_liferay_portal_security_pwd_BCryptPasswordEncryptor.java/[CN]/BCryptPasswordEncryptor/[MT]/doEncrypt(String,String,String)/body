{
  try {
    byte[] saltBytes=null;
    if (Validator.isNull(currentEncryptedPassword)) {
      String salt=BCrypt.gensalt();
      saltBytes=salt.getBytes(StringPool.UTF8);
    }
 else {
      String salt=currentEncryptedPassword.substring(0,29);
      saltBytes=salt.getBytes(StringPool.UTF8);
    }
    String salt=new String(saltBytes);
    return BCrypt.hashpw(clearTextPassword,salt);
  }
 catch (  UnsupportedEncodingException uee) {
    throw new PwdEncryptorException("Unable to extract salt from encrypted password: " + uee.getMessage());
  }
}
