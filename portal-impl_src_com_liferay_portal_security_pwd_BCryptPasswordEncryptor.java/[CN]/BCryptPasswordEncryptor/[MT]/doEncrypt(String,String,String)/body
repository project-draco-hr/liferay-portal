{
  String salt=null;
  if (Validator.isNull(encryptedPassword)) {
    int rounds=_ROUNDS;
    Matcher matcher=_pattern.matcher(algorithm);
    if (matcher.matches()) {
      rounds=GetterUtil.getInteger(matcher.group(1),rounds);
    }
    salt=BCrypt.gensalt(rounds);
  }
 else {
    salt=encryptedPassword.substring(0,29);
  }
  return BCrypt.hashpw(plainTextPassword,salt);
}
