{
  if (Validator.isNull(path)) {
    return mainPath;
  }
  if (!path.startsWith(StringPool.SLASH)) {
    return mainPath;
  }
  String friendlyURL=null;
  int pos=path.indexOf(StringPool.SLASH,1);
  if (pos != -1) {
    friendlyURL=path.substring(0,pos);
  }
 else {
    if (path.length() > 1) {
      friendlyURL=path.substring(0,path.length());
    }
  }
  if (Validator.isNull(friendlyURL)) {
    return mainPath;
  }
  String ownerId=null;
  try {
    Group group=GroupLocalServiceUtil.getFriendlyURLGroup(_companyId,friendlyURL);
    if (_private) {
      ownerId=Layout.PRIVATE + group.getGroupId();
    }
 else {
      ownerId=Layout.PUBLIC + group.getGroupId();
    }
  }
 catch (  NoSuchGroupException nsge) {
    return mainPath;
  }
  friendlyURL=null;
  if ((pos != -1) && ((pos + 1) != path.length())) {
    friendlyURL=path.substring(pos,path.length());
  }
  Layout layout=null;
  String queryString=StringPool.BLANK;
  if (Validator.isNull(friendlyURL)) {
    List layouts=LayoutLocalServiceUtil.getLayouts(ownerId,Layout.DEFAULT_PARENT_LAYOUT_ID);
    if (layouts.size() > 0) {
      layout=(Layout)layouts.get(0);
    }
 else {
      throw new NoSuchLayoutException(ownerId + " does not have any layouts");
    }
  }
 else {
    Object[] portletRedirect=getPortletRedirect(ownerId,friendlyURL);
    layout=(Layout)portletRedirect[0];
    queryString=(String)portletRedirect[1];
  }
  String layoutActualURL=PortalUtil.getLayoutActualURL(layout,mainPath);
  if (Validator.isNotNull(queryString)) {
    layoutActualURL=layoutActualURL + queryString;
  }
  return layoutActualURL;
}
