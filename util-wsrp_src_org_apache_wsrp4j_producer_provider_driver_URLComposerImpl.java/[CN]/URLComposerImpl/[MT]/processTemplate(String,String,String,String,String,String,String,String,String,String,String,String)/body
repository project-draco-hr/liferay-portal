{
  String MN="processTemplate";
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.entry(Logger.TRACE_HIGH,MN);
  }
  String replaceToken="";
  while ((template.indexOf(Constants.REPLACE_START) != -1) | (template.indexOf(Constants.REPLACE_END) != -1)) {
    StringBuffer templateBuffer=new StringBuffer(template);
    int left_br=template.indexOf(Constants.REPLACE_START);
    int right_br=template.indexOf(Constants.REPLACE_END) + 1;
    if ((left_br > right_br) | (left_br == -1) | (right_br == -1)) {
      WSRPXHelper.throwX(logger,Logger.ERROR,MN,ErrorCodes.SYNTAX_ERROR_IN_TEMPLATE);
    }
    replaceToken=templateBuffer.substring(left_br + 1,right_br - 1);
    if (replaceToken.equalsIgnoreCase(Constants.URL_TYPE)) {
      if (urlType == null) {
        urlType="";
      }
      templateBuffer.replace(left_br,right_br,urlType);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.PORTLET_MODE)) {
      if (portletMode == null) {
        portletMode="";
      }
      templateBuffer.replace(left_br,right_br,portletMode);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.NAVIGATIONAL_STATE)) {
      if (navigationalState == null) {
        navigationalState="";
      }
      templateBuffer.replace(left_br,right_br,navigationalState);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.INTERACTION_STATE)) {
      if (interactionState == null) {
        interactionState="";
      }
      templateBuffer.replace(left_br,right_br,interactionState);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.WINDOW_STATE)) {
      if (windowState == null) {
        windowState="";
      }
      templateBuffer.replace(left_br,right_br,windowState);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.URL)) {
      if (url == null) {
        url="";
      }
      templateBuffer.replace(left_br,right_br,url);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.REWRITE_RESOURCE)) {
      if (rewriteResource == null) {
        rewriteResource="";
      }
      templateBuffer.replace(left_br,right_br,rewriteResource);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.PORTLET_HANDLE)) {
      if (portletHandle == null) {
        portletHandle="";
      }
      templateBuffer.replace(left_br,right_br,portletHandle);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.USER_CONTEXT_KEY)) {
      if (userContextKey == null) {
        userContextKey="";
      }
      templateBuffer.replace(left_br,right_br,userContextKey);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.PORTLET_INSTANCE_KEY)) {
      if (portletInstanceKey == null) {
        portletInstanceKey="";
      }
      templateBuffer.replace(left_br,right_br,portletInstanceKey);
    }
 else     if (replaceToken.equalsIgnoreCase(Constants.SESSION_ID)) {
      if (sessionID == null) {
        sessionID="";
      }
      templateBuffer.replace(left_br,right_br,sessionID);
    }
 else {
      WSRPXHelper.throwX(logger,Logger.ERROR,MN,ErrorCodes.UNKNOWN_TOKEN_IN_TEMPLATE);
    }
    template=templateBuffer.toString();
  }
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.exit(Logger.TRACE_HIGH,MN);
  }
  return template;
}
