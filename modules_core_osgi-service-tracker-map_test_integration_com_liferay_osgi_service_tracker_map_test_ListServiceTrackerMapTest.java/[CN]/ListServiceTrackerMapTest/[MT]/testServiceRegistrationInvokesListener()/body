{
  final Collection<TrackedOne> trackedOnes=new ArrayList<>();
  ServiceTrackerMapListener<String,TrackedOne,List<TrackedOne>> serviceTrackerMapListener=new ServiceTrackerMapListener<String,TrackedOne,List<TrackedOne>>(){
    @Override public void keyEmitted(    ServiceTrackerMap<String,List<TrackedOne>> map,    String key,    TrackedOne service,    List<TrackedOne> content){
      trackedOnes.add(service);
    }
  }
;
  ServiceTrackerMap<String,List<TrackedOne>> serviceTrackerMap=_createServiceTrackerMap(serviceTrackerMapListener);
  ServiceRegistration<TrackedOne> serviceRegistration=null;
  try {
    serviceRegistration=registerService(new TrackedOne());
    Assert.assertEquals(1,trackedOnes.size());
  }
  finally {
    if (serviceRegistration != null) {
      serviceRegistration.unregister();
    }
    serviceTrackerMap.close();
  }
}
