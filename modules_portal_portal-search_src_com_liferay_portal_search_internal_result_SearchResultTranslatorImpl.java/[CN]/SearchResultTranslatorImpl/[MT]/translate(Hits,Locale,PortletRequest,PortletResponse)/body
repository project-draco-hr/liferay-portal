{
  List<SearchResult> searchResults=new ArrayList<>();
  for (  Document document : hits.getDocs()) {
    try {
      SearchResult searchResult=_searchResultManager.createSearchResult(document);
      int index=searchResults.indexOf(searchResult);
      if (index < 0) {
        searchResults.add(searchResult);
      }
 else {
        searchResult=searchResults.get(index);
      }
      String version=document.get(Field.VERSION);
      if (Validator.isNotNull(version)) {
        searchResult.addVersion(version);
      }
      _searchResultManager.updateSearchResult(searchResult,document,locale,portletRequest,portletResponse);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        long entryClassPK=GetterUtil.getLong(document.get(Field.ENTRY_CLASS_PK));
        _log.warn("Search index is stale and contains entry {" + entryClassPK + "}",e);
      }
    }
  }
  return searchResults;
}
