{
  BufferCacheServletResponse bufferCacheServletResponse=new BufferCacheServletResponse(response);
  processFilter(ETagFilter.class,request,bufferCacheServletResponse,filterChain);
  ByteBuffer byteBuffer=bufferCacheServletResponse.getByteBuffer();
  boolean outputBuffer=true;
  if (isEligibleForEtag(bufferCacheServletResponse.getStatus())) {
    if (ETagUtil.processETag(request,response,byteBuffer)) {
      outputBuffer=false;
    }
  }
  if (outputBuffer) {
    bufferCacheServletResponse.finishResponse();
    bufferCacheServletResponse.outputBuffer();
  }
}
