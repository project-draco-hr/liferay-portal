{
  CacheResponse cacheResponse=new CacheResponse(response,StringPool.UTF8);
  processFilter(ETagFilter.class,request,cacheResponse,filterChain);
  CacheResponseData cacheResponseData=new CacheResponseData(cacheResponse.getData(),cacheResponse.getContentType(),cacheResponse.getHeaders());
  String eTag=Integer.toHexString(Arrays.hashCode(cacheResponse.getData()));
  if (Validator.isNotNull(eTag)) {
    response.setHeader(HttpHeaders.ETAG,eTag);
    String ifNoneMatch=request.getHeader(HttpHeaders.IF_NONE_MATCH);
    if (eTag.equals(ifNoneMatch)) {
      response.setStatus(HttpServletResponse.SC_NOT_MODIFIED);
      return;
    }
  }
  CacheResponseUtil.write(response,cacheResponseData);
}
