{
  RestrictedByteBufferCacheServletResponse restrictedByteBufferCacheServletResponse=new RestrictedByteBufferCacheServletResponse(response,PropsValues.ETAG_CACHE_CAPACITY);
  processFilter(ETagFilter.class,request,restrictedByteBufferCacheServletResponse,filterChain);
  if (!restrictedByteBufferCacheServletResponse.isOverflowed()) {
    ByteBuffer byteBuffer=restrictedByteBufferCacheServletResponse.getByteBuffer();
    if (!isEligibleForEtag(restrictedByteBufferCacheServletResponse.getStatus()) || !ETagUtil.processETag(request,response,byteBuffer)) {
      restrictedByteBufferCacheServletResponse.finishResponse();
      restrictedByteBufferCacheServletResponse.flushCache();
    }
  }
}
