{
  BufferCacheServletResponse bufferCacheServletResponse=new BufferCacheServletResponse(response);
  processFilter(ETagFilter.class,request,bufferCacheServletResponse,filterChain);
  ByteBuffer byteBuffer=bufferCacheServletResponse.getByteBuffer();
  if (isEligibleForEtag(bufferCacheServletResponse.getStatus())) {
    if (!ETagUtil.processETag(request,response,byteBuffer)) {
      bufferCacheServletResponse.finishResponse();
      bufferCacheServletResponse.outputBuffer();
    }
  }
 else {
    bufferCacheServletResponse.finishResponse();
  }
}
