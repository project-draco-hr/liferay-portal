{
  boolean etag=ParamUtil.getBoolean(request,_ETAG,true);
  if (etag) {
    StringServletResponse stringResponse=new StringServletResponse(response);
    processFilter(ETagFilter.class,request,stringResponse,filterChain);
    CacheResponseData cacheResponseData=new CacheResponseData(stringResponse);
    if (!ETagUtil.processETag(request,response,cacheResponseData.getContent(),cacheResponseData.getContentLength())) {
      CacheResponseUtil.write(response,cacheResponseData);
    }
  }
 else {
    processFilter(ETagFilter.class,request,response,filterChain);
  }
}
