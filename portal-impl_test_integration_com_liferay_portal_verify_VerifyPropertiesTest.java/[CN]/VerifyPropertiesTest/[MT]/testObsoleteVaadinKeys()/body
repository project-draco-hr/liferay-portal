{
  String[] originalObsoletePortalKeys=ReflectionTestUtil.getFieldValue(VerifyProperties.class,"_OBSOLETE_PORTAL_VAADIN_KEYS");
  String obsoletePortalKey=getFirstPortalPropertyKey();
  ReflectionTestUtil.setFieldValue(VerifyProperties.class,"_OBSOLETE_PORTAL_VAADIN_KEYS",new String[]{obsoletePortalKey});
  try (CaptureAppender captureAppender=Log4JLoggerTestUtil.configureLog4JLogger(VerifyProperties.class.getName(),Level.ERROR)){
    doVerify();
    List<LoggingEvent> loggingEvents=captureAppender.getLoggingEvents();
    Assert.assertEquals(1,loggingEvents.size());
    LoggingEvent loggingEvent=loggingEvents.get(0);
    Assert.assertEquals("Vaadin framework is not bundled with portal anymore, " + "so portal property \"" + obsoletePortalKey + "\" might "+ "be obsolete. Please refer to Vaadin documentation, how "+ "to configure Vaadin with the portal.",loggingEvent.getMessage());
  }
  finally {
    ReflectionTestUtil.setFieldValue(VerifyProperties.class,"_OBSOLETE_PORTAL_VAADIN_KEYS",originalObsoletePortalKeys);
  }
}
