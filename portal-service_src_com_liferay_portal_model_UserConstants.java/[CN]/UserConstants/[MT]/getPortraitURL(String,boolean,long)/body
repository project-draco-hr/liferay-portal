{
  if (!GetterUtil.getBoolean(PropsUtil.get(PropsKeys.USERS_IMAGE_CHECK_TOKEN))) {
    return getPortraitURL(imagePath,male,portraitId,null);
  }
  if (portraitId <= 0) {
    return getPortraitURL(imagePath,male,0,StringPool.BLANK);
  }
  try {
    User user=UserLocalServiceUtil.fetchUserByPortraitId(portraitId);
    if (user == null) {
      return getPortraitURL(imagePath,male,0,StringPool.BLANK);
    }
    return getPortraitURL(imagePath,male,portraitId,user.getUserUuid());
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn(e,e);
    }
  }
  return StringPool.BLANK;
}
