{
  if (isJSPCompiler(name,action)) {
    return true;
  }
  Class<?> callerClass7=Reflection.getCallerClass(7);
  Class<?> callerClass8=Reflection.getCallerClass(8);
  Class<?> callerClass9=Reflection.getCallerClass(9);
  Class<?> callerClass10=Reflection.getCallerClass(10);
  if ((callerClass7.getEnclosingClass() == Class.class) && (callerClass8 == AccessController.class)) {
    Thread currentThread=Thread.currentThread();
    StackTraceElement[] stackTraceElements=currentThread.getStackTrace();
    StackTraceElement stackTraceElement=stackTraceElements[8];
    String methodName=stackTraceElement.getMethodName();
    if (methodName.equals(_METHOD_NAME_DO_PRIVILEGED)) {
      logReflect(callerClass8,8);
      return true;
    }
  }
  if ((callerClass9.getEnclosingClass() == Thread.class) && (callerClass10 == AccessController.class)) {
    Thread currentThread=Thread.currentThread();
    StackTraceElement[] stackTraceElements=currentThread.getStackTrace();
    StackTraceElement stackTraceElement=stackTraceElements[10];
    String methodName=stackTraceElement.getMethodName();
    if (methodName.equals(_METHOD_NAME_DO_PRIVILEGED)) {
      logReflect(callerClass10,10);
      return true;
    }
  }
  if (callerClass7 == ReflectionUtils.class) {
    logReflect(callerClass7,7);
    return true;
  }
  if (callerClass9 == ReflectionUtils.class) {
    logReflect(callerClass9,9);
    return true;
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Rejecting call stack:");
    for (int i=5; i < 11; i++) {
      _log.debug("Frame " + i + " "+ Reflection.getCallerClass(i));
    }
  }
  return false;
}
