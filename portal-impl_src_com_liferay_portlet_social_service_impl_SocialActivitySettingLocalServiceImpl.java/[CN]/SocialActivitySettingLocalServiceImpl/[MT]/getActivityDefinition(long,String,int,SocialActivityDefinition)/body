{
  SocialActivityDefinition activityDefinition=defaultActivityDefinition.clone();
  List<SocialActivitySetting> activitySettings=getActivitySettings(groupId,className,defaultActivityDefinition.getActivityType());
  for (  SocialActivitySetting activitySetting : activitySettings) {
    String name=activitySetting.getName();
    if (name.equals(SocialActivitySettingConstants.NAME_ENABLED)) {
      activityDefinition.setEnabled(GetterUtil.getBoolean(activitySetting.getValue(),defaultActivityDefinition.isEnabled()));
    }
 else     if (name.equals(SocialActivitySettingConstants.NAME_LOG_ENABLED)) {
      activityDefinition.setLogActivity(GetterUtil.getBoolean(activitySetting.getValue(),defaultActivityDefinition.isLogActivity()));
    }
 else {
      JSONObject jsonObject=null;
      try {
        jsonObject=JSONFactoryUtil.createJSONObject(activitySetting.getValue());
      }
 catch (      Exception e) {
        jsonObject=JSONFactoryUtil.createJSONObject();
      }
      SocialActivityCounterDefinition activityCounterDefinition=activityDefinition.getActivityCounterDefinition(name);
      if (activityCounterDefinition == null) {
        activityCounterDefinition=new SocialActivityCounterDefinition();
        activityCounterDefinition.setName(name);
        activityDefinition.addCounter(activityCounterDefinition);
      }
      activityCounterDefinition.setEnabled(jsonObject.getBoolean("enabled"));
      activityCounterDefinition.setIncrement(jsonObject.getInt("value"));
      activityCounterDefinition.setLimitPeriod(jsonObject.getInt("limitPeriod"));
      activityCounterDefinition.setLimitValue(jsonObject.getInt("limitValue"));
      activityCounterDefinition.setOwnerType(jsonObject.getInt("ownerType"));
    }
  }
  return activityDefinition;
}
