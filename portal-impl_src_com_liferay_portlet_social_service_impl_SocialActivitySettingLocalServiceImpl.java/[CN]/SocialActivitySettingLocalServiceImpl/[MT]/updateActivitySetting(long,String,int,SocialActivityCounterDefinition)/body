{
  long classNameId=PortalUtil.getClassNameId(className);
  SocialActivityDefinition defaultActivityDefinition=SocialConfigurationUtil.getActivityDefinition(className,activityType);
  SocialActivityCounterDefinition defaultActivityCounterDefinition=defaultActivityDefinition.getActivityCounterDefinition(activityCounterDefinition.getName());
  SocialActivitySetting activitySetting=socialActivitySettingPersistence.fetchByG_C_A_N(groupId,classNameId,activityType,activityCounterDefinition.getName());
  if ((defaultActivityCounterDefinition != null) && defaultActivityCounterDefinition.equals(activityCounterDefinition)) {
    if (activitySetting != null) {
      socialActivitySettingPersistence.remove(activitySetting);
    }
    return;
  }
  if (activitySetting != null) {
    activitySetting.setValue(toJSON(activityCounterDefinition));
  }
 else {
    Group group=groupLocalService.getGroup(groupId);
    long activitySettingId=counterLocalService.increment();
    activitySetting=socialActivitySettingPersistence.create(activitySettingId);
    activitySetting.setGroupId(groupId);
    activitySetting.setCompanyId(group.getCompanyId());
    activitySetting.setClassNameId(classNameId);
    activitySetting.setActivityType(activityType);
    activitySetting.setName(activityCounterDefinition.getName());
    activitySetting.setValue(toJSON(activityCounterDefinition));
  }
  socialActivitySettingPersistence.update(activitySetting);
  String key=encodeKey(groupId,className,activityType);
  _activityDefinitions.remove(key);
}
