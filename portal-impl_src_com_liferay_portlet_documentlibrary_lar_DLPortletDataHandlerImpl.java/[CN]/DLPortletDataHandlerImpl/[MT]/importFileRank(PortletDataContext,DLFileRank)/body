{
  long userId=portletDataContext.getUserId(rank.getUserUuid());
  Map<Long,Long> folderPKs=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(DLFolder.class);
  long folderId=MapUtil.getLong(folderPKs,rank.getFolderId(),rank.getFolderId());
  Map<String,String> fileEntryNames=(Map<String,String>)portletDataContext.getNewPrimaryKeysMap(DLFileEntry.class.getName() + ".name");
  String name=fileEntryNames.get(rank.getName());
  if (name == null) {
    name=rank.getName();
  }
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setCreateDate(rank.getCreateDate());
  if ((folderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) && (folderId == rank.getFolderId())) {
    String path=getImportFolderPath(portletDataContext,folderId);
    DLFolder folder=(DLFolder)portletDataContext.getZipEntryAsObject(path);
    importFolder(portletDataContext,folder);
    folderId=MapUtil.getLong(folderPKs,rank.getFolderId(),rank.getFolderId());
  }
  DLFileRankLocalServiceUtil.updateFileRank(portletDataContext.getScopeGroupId(),portletDataContext.getCompanyId(),userId,folderId,name,serviceContext);
}
