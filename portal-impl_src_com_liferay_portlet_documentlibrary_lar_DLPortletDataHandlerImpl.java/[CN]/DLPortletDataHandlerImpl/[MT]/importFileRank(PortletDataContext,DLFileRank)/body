{
  long userId=context.getUserId(rank.getUserUuid());
  Map<Long,Long> folderPKs=(Map<Long,Long>)context.getNewPrimaryKeysMap(DLFolder.class);
  long folderId=MapUtil.getLong(folderPKs,rank.getFolderId(),rank.getFolderId());
  Map<String,String> fileEntryNames=(Map<String,String>)context.getNewPrimaryKeysMap(DLFileEntry.class.getName() + ".name");
  String name=fileEntryNames.get(rank.getName());
  if (name == null) {
    name=rank.getName();
  }
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setCreateDate(rank.getCreateDate());
  if ((folderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) && (folderId == rank.getFolderId())) {
    String path=getImportFolderPath(context,folderId);
    DLFolder folder=(DLFolder)context.getZipEntryAsObject(path);
    importFolder(context,folder);
    folderId=MapUtil.getLong(folderPKs,rank.getFolderId(),rank.getFolderId());
  }
  try {
    DLFolderUtil.findByPrimaryKey(folderId);
    DLFileRankLocalServiceUtil.updateFileRank(context.getGroupId(),context.getCompanyId(),userId,folderId,name,serviceContext);
  }
 catch (  NoSuchFolderException nsfe) {
    _log.error("Could not find the folder for rank " + rank.getFileRankId());
  }
}
