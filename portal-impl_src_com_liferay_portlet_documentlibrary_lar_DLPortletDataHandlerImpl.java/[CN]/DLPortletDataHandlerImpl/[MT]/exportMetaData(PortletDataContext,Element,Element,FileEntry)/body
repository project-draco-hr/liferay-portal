{
  if (!(fileEntry instanceof LiferayFileEntry)) {
    return;
  }
  LiferayFileEntry liferayFileEntry=(LiferayFileEntry)fileEntry;
  DLFileEntry dlFileEntry=liferayFileEntry.getDLFileEntry();
  long fileEntryTypeId=dlFileEntry.getFileEntryTypeId();
  DLFileEntryType dlFileEntryType=DLFileEntryTypeLocalServiceUtil.fetchFileEntryType(fileEntryTypeId);
  if (dlFileEntryType == null) {
    return;
  }
  if (!isFileEntryTypeExportable(portletDataContext.getCompanyId(),dlFileEntryType)) {
    return;
  }
  exportFileEntryType(portletDataContext,fileEntryTypesElement,dlFileEntryType);
  fileEntryElement.addAttribute("fileEntryTypeUuid",dlFileEntryType.getUuid());
  List<DDMStructure> ddmStructures=dlFileEntryType.getDDMStructures();
  for (  DDMStructure ddmStructure : ddmStructures) {
    Element structureFields=fileEntryElement.addElement("structure-fields");
    String path=getFileEntryFileEntryTypeStructureFieldsPath(portletDataContext,fileEntry,dlFileEntryType.getUuid(),ddmStructure.getStructureId());
    structureFields.addAttribute("path",path);
    structureFields.addAttribute("structureUuid",ddmStructure.getUuid());
    FileVersion fileVersion=fileEntry.getFileVersion();
    DLFileEntryMetadata dlFileEntryMetadata=DLFileEntryMetadataLocalServiceUtil.getFileEntryMetadata(ddmStructure.getStructureId(),fileVersion.getFileVersionId());
    Fields fields=StorageEngineUtil.getFields(dlFileEntryMetadata.getDDMStorageId());
    portletDataContext.addZipEntry(path,fields);
  }
}
