{
  long userId=context.getUserId(fileShortcut.getUserUuid());
  long folderId=MapUtil.getLong(folderPKs,fileShortcut.getFolderId(),fileShortcut.getFolderId());
  long toFolderId=MapUtil.getLong(folderPKs,fileShortcut.getToFolderId(),fileShortcut.getToFolderId());
  String toName=MapUtil.getString(fileEntryNames,fileShortcut.getToName(),fileShortcut.getToName());
  boolean addCommunityPermissions=true;
  boolean addGuestPermissions=true;
  try {
    DLFolderUtil.findByPrimaryKey(folderId);
    DLFolderUtil.findByPrimaryKey(toFolderId);
    if (context.getDataStrategy().equals(PortletDataHandlerKeys.DATA_STRATEGY_MIRROR)) {
      try {
        DLFileShortcut existingFileShortcut=DLFileShortcutFinderUtil.findByUuid_G(fileShortcut.getUuid(),context.getGroupId());
        DLFileShortcutLocalServiceUtil.updateFileShortcut(userId,existingFileShortcut.getFileShortcutId(),folderId,toFolderId,toName);
      }
 catch (      NoSuchFileShortcutException nsfse) {
        DLFileShortcutLocalServiceUtil.addFileShortcut(fileShortcut.getUuid(),userId,folderId,toFolderId,toName,addCommunityPermissions,addGuestPermissions);
      }
    }
 else {
      DLFileShortcutLocalServiceUtil.addFileShortcut(userId,folderId,toFolderId,toName,addCommunityPermissions,addGuestPermissions);
    }
  }
 catch (  NoSuchFolderException nsfe) {
    _log.error("Could not find the folder for shortcut " + fileShortcut.getFileShortcutId());
  }
}
