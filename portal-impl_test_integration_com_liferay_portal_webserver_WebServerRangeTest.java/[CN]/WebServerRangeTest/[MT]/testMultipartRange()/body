{
  String[] ranges={"0-9","25-25","30-49","70-79"};
  String rangeHeader="bytes=";
  for (int i=0; i < ranges.length; i++) {
    rangeHeader+=ranges[i];
    if (i != (ranges.length - 1)) {
      rangeHeader+=StringPool.COMMA;
    }
  }
  MockHttpServletResponse response=testRange(rangeHeader);
  String contentType=response.getContentType();
  Assert.assertTrue(contentType.startsWith(_BOUNDARY_PREFACE));
  String boundary=contentType.substring(_BOUNDARY_PREFACE.length());
  String responseBody=response.getContentAsString();
  Assert.assertTrue(responseBody.startsWith("\r\n--" + boundary + "\r\n"));
  Assert.assertTrue(responseBody.endsWith("--" + boundary + "--\r\n"));
  String[] responseBodies=StringUtil.split(responseBody,boundary);
  Assert.assertEquals(ranges.length + 2,responseBodies.length);
  Assert.assertEquals(StringPool.DOUBLE_DASH,responseBodies[0]);
  Assert.assertEquals(StringPool.DOUBLE_DASH,responseBodies[ranges.length + 1]);
  for (int i=0; i < ranges.length; i++) {
    String[] lines=StringUtil.split(responseBodies[i + 1],StringPool.RETURN_NEW_LINE);
    Assert.assertEquals("Content-Type: text/plain",lines[0]);
    Assert.assertEquals("Content-Range: bytes " + ranges[i] + "/80",lines[1]);
    Assert.assertTrue(Validator.isNull(lines[2]));
    String[] rangePair=StringUtil.split(ranges[i],StringPool.DASH);
    int start=GetterUtil.getInteger(rangePair[0]);
    int end=GetterUtil.getInteger(rangePair[1]);
    byte[] bytes=ArrayUtil.subset(_SAMPLE_DATA.getBytes(),start,end + 1);
    Assert.assertArrayEquals(bytes,lines[3].getBytes("UTF-8"));
    Assert.assertEquals(StringPool.DOUBLE_DASH,lines[4]);
  }
}
