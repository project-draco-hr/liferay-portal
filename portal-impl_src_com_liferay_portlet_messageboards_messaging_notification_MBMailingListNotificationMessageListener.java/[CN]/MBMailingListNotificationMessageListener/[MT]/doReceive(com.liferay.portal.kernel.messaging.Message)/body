{
  boolean sourceMailingList=message.getBoolean("sourceMailingList");
  if (sourceMailingList) {
    return;
  }
  String categoryIds=message.getString("categoryIds");
  long threadId=message.getLong("threadId");
  String fromName=message.getString("fromName");
  String fromAddress=message.getString("fromAddress");
  String body=message.getString("body");
  String replyToAddress=message.getString("replyToAddress");
  String mailId=message.getString("mailId");
  String inReplyTo=message.getString("inReplyTo");
  boolean htmlFormat=message.getBoolean("htmlFormat");
  String subject=message.getString("subject") + StringPool.SPACE + mailId;
  if (_log.isInfoEnabled()) {
    _log.info("Sending mailing list notifications for " + "{mailId=" + mailId + ", threadId="+ threadId+ ", categoryIds="+ categoryIds+ "}");
  }
  long[] categoryIdsArray=StringUtil.split(categoryIds,0L);
  for (  long categoryId : categoryIdsArray) {
    MBMailingList mailingList;
    try {
      mailingList=_mbMailingListLocalService.getCategoryMailingList(categoryId);
      if (!mailingList.isActive()) {
        continue;
      }
    }
 catch (    NoSuchMailingListException nsmle) {
      continue;
    }
    notifyMailingList(mailingList,fromAddress,fromName,subject,body,replyToAddress,mailId,inReplyTo,htmlFormat);
  }
  if (_log.isInfoEnabled()) {
    _log.info("Finished notifying mailing lists");
  }
}
