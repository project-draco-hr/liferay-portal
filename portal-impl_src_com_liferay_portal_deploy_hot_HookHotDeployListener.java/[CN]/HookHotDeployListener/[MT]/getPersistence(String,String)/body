{
  int pos=modelName.lastIndexOf(CharPool.PERIOD);
  String entityName=modelName.substring(pos + 1);
  pos=modelName.lastIndexOf(".model.");
  String packagePath=modelName.substring(0,pos);
  String beanName=packagePath + ".service.persistence." + entityName+ "Persistence";
  try {
    return (BasePersistence<?>)PortalBeanLocatorUtil.locate(beanName);
  }
 catch (  BeanLocatorException ble) {
    return (BasePersistence<?>)PortletBeanLocatorUtil.locate(servletContextName,beanName);
  }
}
