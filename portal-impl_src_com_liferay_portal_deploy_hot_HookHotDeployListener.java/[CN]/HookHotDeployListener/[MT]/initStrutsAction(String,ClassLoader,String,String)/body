{
  Registry registry=RegistryUtil.getRegistry();
  Map<Object,ServiceRegistration<?>> serviceRegistrations=getServiceRegistrations(servletContextName);
  Object strutsActionObject=InstanceFactory.newInstance(portletClassLoader,strutsActionClassName);
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("path",strutsActionPath);
  ServiceRegistration<?> serviceRegistration=null;
  if (strutsActionObject instanceof StrutsAction) {
    StrutsAction strutsAction=(StrutsAction)ProxyUtil.newProxyInstance(portletClassLoader,new Class[]{StrutsAction.class},new ClassLoaderBeanHandler(strutsActionObject,portletClassLoader));
    serviceRegistration=registry.registerService(StrutsAction.class,strutsAction,properties);
  }
 else {
    StrutsPortletAction strutsPortletAction=(StrutsPortletAction)ProxyUtil.newProxyInstance(portletClassLoader,new Class[]{StrutsPortletAction.class},new ClassLoaderBeanHandler(strutsActionObject,portletClassLoader));
    serviceRegistration=registry.registerService(StrutsPortletAction.class,strutsPortletAction,properties);
  }
  serviceRegistrations.put(strutsActionClassName,serviceRegistration);
}
