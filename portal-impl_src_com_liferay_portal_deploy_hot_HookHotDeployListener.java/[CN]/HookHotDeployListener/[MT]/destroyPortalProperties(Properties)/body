{
  PropsUtil.removeProperties(portalProperties);
  if (_log.isDebugEnabled() && portalProperties.containsKey(LOCALES)) {
    _log.debug("Portlet locales " + portalProperties.getProperty(LOCALES));
    _log.debug("Original locales " + PropsUtil.get(LOCALES));
    _log.debug("Original locales array length " + PropsUtil.getArray(LOCALES).length);
  }
  resetPortalProperties(portalProperties);
  if (portalProperties.contains(PropsKeys.DL_HOOK_IMPL)) {
    com.liferay.documentlibrary.util.HookFactory.setInstance(null);
  }
  if (portalProperties.contains(PropsKeys.IMAGE_HOOK_IMPL)) {
    com.liferay.portal.image.HookFactory.setInstance(null);
  }
  if (portalProperties.contains(PropsKeys.LDAP_ATTRS_TRANSFORMER_IMPL)) {
    AttributesTransformerFactory.setInstance(null);
  }
  if (portalProperties.contains(PropsKeys.MAIL_HOOK_IMPL)) {
    com.liferay.mail.util.HookFactory.setInstance(null);
  }
  if (portalProperties.contains(PropsKeys.USERS_SCREEN_NAME_GENERATOR)) {
    ScreenNameGeneratorFactory.setInstance(null);
  }
  if (portalProperties.contains(PropsKeys.USERS_SCREEN_NAME_VALIDATOR)) {
    ScreenNameValidatorFactory.setInstance(null);
  }
}
