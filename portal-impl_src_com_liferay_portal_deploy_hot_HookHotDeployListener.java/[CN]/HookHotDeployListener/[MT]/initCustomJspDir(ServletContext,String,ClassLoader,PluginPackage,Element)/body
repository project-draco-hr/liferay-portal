{
  String customJspDir=rootElement.elementText("custom-jsp-dir");
  if (Validator.isNull(customJspDir)) {
    return;
  }
  if (!checkPermission(PACLConstants.PORTAL_HOOK_PERMISSION_CUSTOM_JSP_DIR,portletClassLoader,null,"Rejecting custom JSP directory")) {
    return;
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Custom JSP directory: " + customJspDir);
  }
  boolean customJspGlobal=GetterUtil.getBoolean(rootElement.elementText("custom-jsp-global"),true);
  CustomJspBagRegistryUtil customJspBagRegistryUtil=CustomJspBagRegistryUtil.getInstance();
  CustomJspBag customJspBag=new CustomJspBagImpl(servletContext,customJspDir,customJspGlobal,pluginPackage.getName());
  customJspBagRegistryUtil.register(customJspBag);
}
