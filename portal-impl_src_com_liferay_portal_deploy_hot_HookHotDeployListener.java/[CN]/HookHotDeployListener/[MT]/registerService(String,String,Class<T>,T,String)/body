{
  Registry registry=RegistryUtil.getRegistry();
  Map<String,Object> properties=new HashMap<String,Object>();
  if ((propertyKVPs.length % 2) != 0) {
    throw new IllegalArgumentException("Properties length is not an even number");
  }
  for (int i=0; i < propertyKVPs.length; i+=2) {
    String propertyName=String.valueOf(propertyKVPs[i]);
    Object propertyValue=propertyKVPs[i + 1];
    properties.put(propertyName,propertyValue);
  }
  ServiceRegistration<T> serviceRegistration=registry.registerService(clazz,service,properties);
  Map<Object,ServiceRegistration<?>> serviceRegistrations=getServiceRegistrations(servletContextName);
  serviceRegistrations.put(serviceRegistrationKey,serviceRegistration);
}
