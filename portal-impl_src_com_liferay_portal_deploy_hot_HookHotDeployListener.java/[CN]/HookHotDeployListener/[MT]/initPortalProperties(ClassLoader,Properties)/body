{
  PropsUtil.addProperties(portalProperties);
  if (_log.isDebugEnabled() && portalProperties.containsKey(LOCALES)) {
    _log.debug("Portlet locales " + portalProperties.getProperty(LOCALES));
    _log.debug("Merged locales " + PropsUtil.get(LOCALES));
    _log.debug("Merged locales array length " + PropsUtil.getArray(LOCALES).length);
  }
  resetPortalProperties(portalProperties);
  if (portalProperties.contains(PropsKeys.LDAP_ATTRS_TRANSFORMER_IMPL)) {
    String attributesTransformerClassName=portalProperties.getProperty(PropsKeys.LDAP_ATTRS_TRANSFORMER_IMPL);
    AttributesTransformer attributesTransformer=(AttributesTransformer)portletClassLoader.loadClass(attributesTransformerClassName).newInstance();
    attributesTransformer=(AttributesTransformer)Proxy.newProxyInstance(portletClassLoader,new Class[]{AttributesTransformer.class},new ContextClassLoaderBeanHandler(attributesTransformer,portletClassLoader));
    AttributesTransformerFactory.setInstance(attributesTransformer);
  }
}
