{
  String customJspDir=customJspBag.getCustomJspDir();
  Set<String> customJsps=new HashSet<>();
  for (  String customJsp : customJspBag.getCustomJsps()) {
    String portalJsp=getPortalJspName(customJsp,customJspDir);
    customJsps.add(portalJsp);
  }
  Map<String,String> collidingCustomJsps=new HashMap<>();
  for (  Map.Entry<String,CustomJspBag> entry : _customJspBagsMap.entrySet()) {
    CustomJspBag currentCustomJspBag=(CustomJspBag)entry.getValue();
    if (!currentCustomJspBag.isCustomJspGlobal()) {
      continue;
    }
    String currentServletContextName=(String)entry.getKey();
    String currentCustomJspDir=currentCustomJspBag.getCustomJspDir();
    List<String> currentCustomJsps=currentCustomJspBag.getCustomJsps();
    for (    String currentCustomJsp : currentCustomJsps) {
      String currentPortalJsp=getPortalJspName(currentCustomJsp,currentCustomJspDir);
      if (customJsps.contains(currentPortalJsp)) {
        collidingCustomJsps.put(currentPortalJsp,currentServletContextName);
      }
    }
  }
  if (collidingCustomJsps.isEmpty()) {
    return;
  }
  _log.error(servletContextName + " is colliding with the currently installed " + "hooks");
  if (_log.isDebugEnabled()) {
    Log log=SanitizerLogWrapper.allowCRLF(_log);
    StringBundler sb=new StringBundler(collidingCustomJsps.size() * 4 + 2);
    sb.append("Colliding JSP files in ");
    sb.append(servletContextName);
    sb.append(StringPool.NEW_LINE);
    int i=0;
    for (    Map.Entry<String,String> entry : collidingCustomJsps.entrySet()) {
      sb.append((String)entry.getKey());
      sb.append(" with ");
      sb.append((String)entry.getValue());
      if ((i + 1) < collidingCustomJsps.size()) {
        sb.append(StringPool.NEW_LINE);
      }
      i++;
    }
    log.debug(sb.toString());
  }
  throw new DuplicateCustomJspException();
}
