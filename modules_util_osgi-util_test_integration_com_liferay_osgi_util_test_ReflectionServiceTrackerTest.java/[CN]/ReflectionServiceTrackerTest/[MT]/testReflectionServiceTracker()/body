{
  TestInstance testInstance=new TestInstance();
  ReflectionServiceTracker reflectionServiceTracker=new ReflectionServiceTracker(testInstance);
  Assert.assertNull(testInstance.getTrackedOne());
  Assert.assertNull(testInstance.getTrackedTwo());
  TrackedOne trackedOne=new TrackedOne();
  ServiceRegistration<TrackedOne> sr1=_bundleContext.registerService(TrackedOne.class,trackedOne,null);
  TrackedTwo trackedTwo=new TrackedTwo();
  ServiceRegistration<TrackedTwo> sr2=_bundleContext.registerService(TrackedTwo.class,trackedTwo,null);
  Assert.assertEquals(trackedOne,testInstance.getTrackedOne());
  Assert.assertEquals(trackedTwo,testInstance.getTrackedTwo());
  sr1.unregister();
  sr2.unregister();
  Assert.assertNull(testInstance.getTrackedOne());
  Assert.assertNull(testInstance.getTrackedTwo());
  trackedOne=new TrackedOne();
  sr1=_bundleContext.registerService(TrackedOne.class,trackedOne,new Hashtable<String,Object>(){
{
      put("service.ranking",2);
    }
  }
);
  trackedTwo=new TrackedTwo();
  sr2=_bundleContext.registerService(TrackedTwo.class,trackedTwo,new Hashtable<String,Object>(){
{
      put("service.ranking",2);
    }
  }
);
  TrackedOne trackedOne2=new TrackedOne();
  ServiceRegistration<TrackedOne> sr3=_bundleContext.registerService(TrackedOne.class,trackedOne2,new Hashtable<String,Object>(){
{
      put("service.ranking",1);
    }
  }
);
  TrackedTwo trackedTwo2=new TrackedTwo();
  ServiceRegistration<TrackedTwo> sr4=_bundleContext.registerService(TrackedTwo.class,trackedTwo2,new Hashtable<String,Object>(){
{
      put("service.ranking",1);
    }
  }
);
  Assert.assertEquals(trackedOne,testInstance.getTrackedOne());
  Assert.assertEquals(trackedTwo,testInstance.getTrackedTwo());
  sr1.unregister();
  sr2.unregister();
  Assert.assertEquals(trackedOne2,testInstance.getTrackedOne());
  Assert.assertEquals(trackedTwo2,testInstance.getTrackedTwo());
  sr3.unregister();
  sr4.unregister();
  Assert.assertNull(testInstance.getTrackedOne());
  Assert.assertNull(testInstance.getTrackedTwo());
  reflectionServiceTracker.close();
}
