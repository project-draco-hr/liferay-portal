{
  TestInterface testInterface=new TestInterface();
  ReflectionServiceTracker reflectionServiceTracker=new ReflectionServiceTracker(testInterface);
  TrackedOne trackedOne=new TrackedOne();
  ServiceRegistration<InterfaceOne> sr1=registerServiceWithRanking(_bundleContext,InterfaceOne.class,trackedOne,2);
  TrackedTwo trackedTwo=new TrackedTwo();
  ServiceRegistration<InterfaceTwo> sr2=registerServiceWithRanking(_bundleContext,InterfaceTwo.class,trackedTwo,2);
  TrackedOne trackedOne2=new TrackedOne();
  ServiceRegistration<InterfaceOne> sr3=registerServiceWithRanking(_bundleContext,InterfaceOne.class,trackedOne2,1);
  TrackedTwo trackedTwo2=new TrackedTwo();
  ServiceRegistration<InterfaceTwo> sr4=registerServiceWithRanking(_bundleContext,InterfaceTwo.class,trackedTwo2,1);
  Hashtable<String,Object> properties=new Hashtable<String,Object>();
  properties.put("service.ranking",3);
  sr3.setProperties(properties);
  sr4.setProperties(properties);
  Assert.assertEquals(trackedOne2,testInterface.getTrackedOne());
  Assert.assertEquals(trackedTwo2,testInterface.getTrackedTwo());
  sr1.unregister();
  sr2.unregister();
  sr3.unregister();
  sr4.unregister();
  reflectionServiceTracker.close();
}
