{
  Object workflowDefinitionAttr=renderRequest.getAttribute(WebKeys.WORKFLOW_DEFINITION);
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (Validator.isNull(workflowDefinitionAttr)) {
    String name=ParamUtil.getString(renderRequest,WorkflowDefinitionConstants.NAME);
    int version=ParamUtil.getInteger(renderRequest,WorkflowDefinitionConstants.VERSION);
    List<WorkflowDefinition> workflowDefinitions=WorkflowDefinitionManagerUtil.getWorkflowDefinitions(themeDisplay.getCompanyId(),name,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
    for (    WorkflowDefinition workflowDefinition : workflowDefinitions) {
      if (version == workflowDefinition.getVersion()) {
        renderRequest.setAttribute(WebKeys.WORKFLOW_DEFINITION,workflowDefinition);
        break;
      }
    }
  }
  List<WorkflowDefinition> workflowDefinitions=WorkflowDefinitionManagerUtil.getWorkflowDefinitions(themeDisplay.getCompanyId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  renderRequest.setAttribute(WebKeys.WORKFLOW_DEFINITIONS,workflowDefinitions);
}
