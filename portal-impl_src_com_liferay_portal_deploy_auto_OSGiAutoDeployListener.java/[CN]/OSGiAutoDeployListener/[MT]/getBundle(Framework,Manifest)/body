{
  BundleContext bundleContext=framework.getBundleContext();
  Attributes attributes=manifest.getMainAttributes();
  String bundleSymbolicNameAttribute=attributes.getValue(Constants.BUNDLE_SYMBOLICNAME);
  Map<String,Map<String,String>> bundleSymbolicNamesMap=OSGiHeader.parseHeader(bundleSymbolicNameAttribute);
  Set<String> bundleSymbolicNamesSet=bundleSymbolicNamesMap.keySet();
  Iterator<String> bundleSymbolicNamesIterator=bundleSymbolicNamesSet.iterator();
  String bundleSymbolicName=bundleSymbolicNamesIterator.next();
  String bundleVersionAttribute=attributes.getValue(Constants.BUNDLE_VERSION);
  Version bundleVersion=Version.parseVersion(bundleVersionAttribute);
  for (  Bundle bundle : bundleContext.getBundles()) {
    if (bundleSymbolicName.equals(bundle.getSymbolicName()) && bundleVersion.equals(bundle.getVersion())) {
      return bundle;
    }
  }
  return null;
}
