{
  JSONObject jsonObj=new JSONObject();
  try {
    String userId=PortalUtil.getUserId(req);
    String password=PortalUtil.getUserPassword(req);
    String folderId=ParamUtil.getString(req,"folderId");
    MailUtil.setCurrentFolder(userId,password,folderId);
    SortedSet set=MailUtil.getEnvelopes(userId,new DateComparator(false));
    JSONArray meArray=new JSONArray();
    for (Iterator itr=set.iterator(); itr.hasNext(); ) {
      MailEnvelope me=(MailEnvelope)itr.next();
      JSONObject jMe=new JSONObject();
      jMe.put("id",me.getMsgUID());
      jMe.put("email",me.getRecipient());
      jMe.put("subject",me.getSubject());
      jMe.put("date",me.getDate().toString());
      meArray.put(jMe);
    }
    jsonObj.put("headers",meArray);
  }
 catch (  Exception e) {
  }
  return jsonObj.toString();
}
