{
  JSONObject jsonObj=new JSONObject();
  String folderId=ParamUtil.getString(req,"folderId");
  MailUtil.setCurrentFolder(req.getSession(),folderId);
  SortedSet set=MailUtil.getEnvelopes(req.getSession(),new DateComparator(false));
  JSONArray meArray=new JSONArray();
  for (Iterator itr=set.iterator(); itr.hasNext(); ) {
    MailEnvelope me=(MailEnvelope)itr.next();
    JSONObject jMe=new JSONObject();
    jMe.put("id",me.getMsgUID());
    jMe.put("email",me.getRecipient());
    jMe.put("subject",me.getSubject());
    jMe.put("date",me.getDate().toString());
    meArray.put(jMe);
  }
  jsonObj.put("headers",meArray);
  return jsonObj.toString();
}
