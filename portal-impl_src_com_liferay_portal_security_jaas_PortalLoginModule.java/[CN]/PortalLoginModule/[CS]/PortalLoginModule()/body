{
  if (Validator.isNotNull(PropsValues.PORTAL_JAAS_IMPL)) {
    try {
      _loginModule=(LoginModule)InstanceFactory.newInstance(PropsValues.PORTAL_JAAS_IMPL);
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
  if (_loginModule == null) {
    if (ServerDetector.isJBoss()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.jboss.PortalLoginModule();
    }
 else     if (ServerDetector.isJetty()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.jetty.PortalLoginModule();
    }
 else     if (ServerDetector.isJOnAS()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.jonas.PortalLoginModule();
    }
 else     if (ServerDetector.isResin()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.resin.PortalLoginModule();
    }
 else     if (ServerDetector.isTomcat()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.tomcat.PortalLoginModule();
    }
 else     if (ServerDetector.isWebLogic()) {
      _loginModule=new com.liferay.portal.security.jaas.ext.weblogic.PortalLoginModule();
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug(_loginModule.getClass().getName());
  }
}
