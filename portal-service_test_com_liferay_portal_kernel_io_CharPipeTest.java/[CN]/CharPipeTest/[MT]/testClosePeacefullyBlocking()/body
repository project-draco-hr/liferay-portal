{
  final CharPipe charPipe=new CharPipe();
  Reader reader=charPipe.getReader();
  Thread closeThread=new Thread(){
    public void run(){
      try {
        Thread.sleep(100);
        charPipe.close();
      }
 catch (      Exception e) {
        fail(e.getMessage());
      }
    }
  }
;
  long startTime=System.currentTimeMillis();
  closeThread.start();
  int result=reader.read();
  closeThread.join();
  long duration=System.currentTimeMillis() - startTime;
  assertEquals(-1,result);
  assertTrue(duration > 100);
}
