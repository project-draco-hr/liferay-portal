{
  CharPipe charPipe=new CharPipe(4);
  Reader reader=charPipe.getReader();
  Writer writer=charPipe.getWriter();
  SlowReaderJob slowReaderJob=new SlowReaderJob(reader,4,true,true);
  Thread readerThread=new Thread(slowReaderJob);
  assertTrue(timedWrite(writer,"abcd") < 100);
  readerThread.start();
  for (int i=0; i < 2; i++) {
    assertTrue(timedWrite(writer,"abcdefgh") > 100);
  }
  charPipe.close(true);
  readerThread.join();
  assertFalse(slowReaderJob.isFailed());
}
