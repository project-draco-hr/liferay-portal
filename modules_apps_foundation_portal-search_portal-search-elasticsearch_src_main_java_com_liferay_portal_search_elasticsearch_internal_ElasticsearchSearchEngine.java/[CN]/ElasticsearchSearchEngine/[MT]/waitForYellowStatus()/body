{
  long timeout=30 * Time.SECOND;
  if (PortalRunMode.isTestMode()) {
    timeout=Time.HOUR;
  }
  ClusterHealthResponse clusterHealthResponse=_elasticsearchConnectionManager.getClusterHealthResponse(timeout);
  if (clusterHealthResponse.getStatus() == ClusterHealthStatus.RED) {
    throw new IllegalStateException("Unable to initialize Elasticsearch cluster: " + clusterHealthResponse);
  }
}
