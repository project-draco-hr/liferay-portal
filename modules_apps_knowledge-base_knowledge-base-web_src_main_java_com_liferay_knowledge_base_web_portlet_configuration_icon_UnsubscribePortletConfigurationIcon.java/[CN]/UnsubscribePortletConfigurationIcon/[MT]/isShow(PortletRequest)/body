{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  KBArticle kbArticle=(KBArticle)portletRequest.getAttribute(KBWebKeys.KNOWLEDGE_BASE_KB_ARTICLE);
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  boolean enableKBArticleSubscriptions=GetterUtil.getBoolean(portletRequest.getAttribute("init.jsp-enableKBArticleSubscriptions"));
  User user=themeDisplay.getUser();
  if (enableKBArticleSubscriptions && (kbArticle.isApproved() || !kbArticle.isFirstVersion()) && KBArticlePermission.contains(permissionChecker,kbArticle,KBActionKeys.SUBSCRIBE)&& _subscriptionLocalService.isSubscribed(user.getCompanyId(),user.getUserId(),KBArticle.class.getName(),kbArticle.getResourcePrimKey())) {
    return true;
  }
  return false;
}
