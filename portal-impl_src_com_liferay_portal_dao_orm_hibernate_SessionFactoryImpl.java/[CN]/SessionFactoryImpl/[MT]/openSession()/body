{
  org.hibernate.Session session=null;
  if (PropsValues.SPRING_HIBERNATE_SESSION_DELEGATED) {
    session=_sessionFactoryImplementor.getCurrentSession();
  }
 else {
    session=_sessionFactoryImplementor.openSession();
  }
  if (_log.isDebugEnabled()) {
    SessionInvocationHandler sessionInvocationHandler=(SessionInvocationHandler)Proxy.getInvocationHandler(session);
    org.hibernate.impl.SessionImpl sessionImpl=(org.hibernate.impl.SessionImpl)sessionInvocationHandler.getSession();
    _log.debug("Session is using connection release mode " + sessionImpl.getConnectionReleaseMode());
  }
  return wrapSession(session);
}
