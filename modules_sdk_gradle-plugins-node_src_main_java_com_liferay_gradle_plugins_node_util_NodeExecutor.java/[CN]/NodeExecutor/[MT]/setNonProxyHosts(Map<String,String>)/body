{
  if (environment.containsKey(_NO_PROXY_KEY) || environment.containsKey(_NO_PROXY_KEY.toUpperCase())) {
    if (_logger.isInfoEnabled()) {
      _logger.info("Non-proxy hosts are already set");
    }
    return;
  }
  Set<String> nonProxyHosts=new LinkedHashSet<>();
  String hosts=System.getProperty("http.nonProxyHosts");
  if (Validator.isNotNull(hosts)) {
    nonProxyHosts.addAll(Arrays.asList(hosts.split("\\|")));
  }
  hosts=System.getProperty("https.nonProxyHosts");
  if (Validator.isNotNull(hosts)) {
    nonProxyHosts.addAll(Arrays.asList(hosts.split("\\|")));
  }
  if (nonProxyHosts.isEmpty()) {
    return;
  }
  hosts=CollectionUtils.join(",",nonProxyHosts);
  environment.put(_NO_PROXY_KEY,hosts);
  if (_logger.isInfoEnabled()) {
    _logger.info("Non-proxy hosts set to {}",hosts);
  }
}
