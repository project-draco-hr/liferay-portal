{
  StringBundler sb=new StringBundler();
  int index=marker.getValue() + 1;
  BBCodeItem bbCodeItem=null;
  do {
    bbCodeItem=bbCodeItems.get(index++);
    if ((bbCodeItem.getType() & type) > 0) {
      sb.append(bbCodeItem.getValue());
    }
  }
 while ((bbCodeItem.getType() != BBCodeParser.TYPE_TAG_END) && !tag.equals(bbCodeItem.getValue()));
  if (consume) {
    marker.setValue(index - 1);
  }
  return sb.toString();
}
