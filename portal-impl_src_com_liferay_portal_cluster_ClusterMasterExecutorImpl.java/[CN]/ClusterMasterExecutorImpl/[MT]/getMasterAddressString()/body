{
  String owner=null;
  while (true) {
    try {
      Lock lock=null;
      if (owner == null) {
        lock=LockLocalServiceUtil.lock(_LOCK_CLASS_NAME,_LOCK_CLASS_NAME,_localClusterNodeAddress);
      }
 else {
        lock=LockLocalServiceUtil.lock(_LOCK_CLASS_NAME,_LOCK_CLASS_NAME,owner,_localClusterNodeAddress);
      }
      owner=lock.getOwner();
      Address address=AddressSerializerUtil.deserialize(owner);
      if (_clusterExecutor.isClusterNodeAlive(address)) {
        break;
      }
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to obtain the cluster master token. Trying " + "again.",e);
      }
    }
  }
  boolean master=_localClusterNodeAddress.equals(owner);
  if (master == _master) {
    return owner;
  }
  _master=master;
  if (_enabled) {
    notifyMasterTokenTransitionListeners(master);
  }
  return owner;
}
