{
  Object[] defaultLayout=getDefaultVirtualLayout(request);
  defaultLayout=getViewableLayouts(request,user,permissionChecker,defaultLayout,doAsGroupId,controlPanelCategory);
  if (defaultLayout[1] != null) {
    return defaultLayout;
  }
  if (signedIn) {
    defaultLayout=getDefaultUserPersonalLayout(user);
    if (defaultLayout[0] == null) {
      defaultLayout=getDefaultUserSiteLayout(user);
    }
    defaultLayout=getViewableLayouts(request,user,permissionChecker,defaultLayout,doAsGroupId,controlPanelCategory);
    if (defaultLayout[1] != null) {
      return defaultLayout;
    }
  }
  defaultLayout=getDefaultSiteLayout(user);
  return getViewableLayouts(request,user,permissionChecker,defaultLayout,doAsGroupId,controlPanelCategory);
}
