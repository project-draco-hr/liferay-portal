{
  LayoutComposite defaultLayoutComposite=getDefaultVirtualHostLayoutComposite(request);
  defaultLayoutComposite=getViewableLayoutComposite(request,user,permissionChecker,defaultLayoutComposite,doAsGroupId);
  if (ListUtil.isNotEmpty(defaultLayoutComposite.getLayouts())) {
    return defaultLayoutComposite;
  }
  if (signedIn) {
    defaultLayoutComposite=getDefaultUserPersonalSiteLayoutComposite(user);
    if (defaultLayoutComposite.getLayout() == null) {
      defaultLayoutComposite=getDefaultUserSitesLayoutComposite(user);
    }
    defaultLayoutComposite=getViewableLayoutComposite(request,user,permissionChecker,defaultLayoutComposite,doAsGroupId);
    if (ListUtil.isNotEmpty(defaultLayoutComposite.getLayouts())) {
      return defaultLayoutComposite;
    }
  }
  defaultLayoutComposite=getGuestSiteLayoutComposite(user);
  return getViewableLayoutComposite(request,user,permissionChecker,defaultLayoutComposite,doAsGroupId);
}
