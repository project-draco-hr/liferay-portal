{
  if ((layouts == null) || layouts.isEmpty()) {
    return new Object[]{layout,layouts};
  }
  Group group=layout.getGroup();
  boolean hasUpdateLayoutPermission=false;
  boolean hasViewStagingPermission=(group.isStagingGroup() || group.isStagedRemotely()) && GroupPermissionUtil.contains(permissionChecker,group.getGroupId(),ActionKeys.VIEW_STAGING);
  if (LayoutPermissionUtil.contains(permissionChecker,layout,ActionKeys.VIEW) || hasViewStagingPermission) {
    hasUpdateLayoutPermission=true;
  }
  List<Layout> accessibleLayouts=new ArrayList<Layout>();
  for (int i=0; i < layouts.size(); i++) {
    Layout curLayout=layouts.get(i);
    if (!curLayout.isHidden() && (LayoutPermissionUtil.contains(permissionChecker,curLayout,true,ActionKeys.VIEW) || hasViewStagingPermission)) {
      if (accessibleLayouts.isEmpty() && !hasUpdateLayoutPermission) {
        layout=curLayout;
      }
      accessibleLayouts.add(curLayout);
    }
  }
  if (accessibleLayouts.isEmpty()) {
    layouts=null;
    if (!hasUpdateLayoutPermission) {
      SessionErrors.add(request,LayoutPermissionException.class.getName());
    }
  }
 else {
    layouts=accessibleLayouts;
  }
  return new Object[]{layout,layouts};
}
