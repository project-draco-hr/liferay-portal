{
  Layout layout=null;
  List<Layout> layouts=null;
  LinkedHashMap<String,Object> groupParams=new LinkedHashMap<>();
  groupParams.put("usersGroups",new Long(user.getUserId()));
  List<Group> groups=GroupLocalServiceUtil.search(user.getCompanyId(),null,null,groupParams,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  Group group : groups) {
    layouts=LayoutLocalServiceUtil.getLayouts(group.getGroupId(),true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID);
    if (layouts.isEmpty()) {
      layouts=LayoutLocalServiceUtil.getLayouts(group.getGroupId(),false,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID);
    }
    if (!layouts.isEmpty()) {
      layout=layouts.get(0);
      break;
    }
  }
  return new LayoutComposite(layout,layouts);
}
