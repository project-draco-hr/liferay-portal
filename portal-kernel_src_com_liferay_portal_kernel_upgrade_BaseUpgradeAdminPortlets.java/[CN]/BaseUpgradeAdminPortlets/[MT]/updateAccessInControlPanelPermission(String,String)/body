{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    long bitwiseValue=getBitwiseValue(portletFrom,ActionKeys.ACCESS_IN_CONTROL_PANEL);
    try (PreparedStatement ps=connection.prepareStatement("select * from ResourcePermission where name = ?")){
      ps.setString(1,portletFrom);
      try (ResultSet rs=ps.executeQuery()){
        while (rs.next()) {
          long resourcePermissionId=rs.getLong("resourcePermissionId");
          long actionIds=rs.getLong("actionIds");
          if ((actionIds & bitwiseValue) != 0) {
            actionIds=actionIds & (~bitwiseValue);
            runSQL("update ResourcePermission set actionIds = " + actionIds + " where resourcePermissionId "+ "= "+ resourcePermissionId);
            resourcePermissionId=increment(getResourcePermissionClassName());
            long companyId=rs.getLong("companyId");
            int scope=rs.getInt("scope");
            String primKey=rs.getString("primKey");
            long roleId=rs.getLong("roleId");
            actionIds=rs.getLong("actionIds");
            actionIds|=bitwiseValue;
            addResourcePermission(resourcePermissionId,companyId,portletTo,scope,primKey,roleId,actionIds);
          }
        }
      }
     }
   }
 }
