{
  portletDataContext.importPermissions("com.liferay.portlet.polls",portletDataContext.getSourceGroupId(),portletDataContext.getScopeGroupId());
  Element rootElement=portletDataContext.getImportDataRootElement();
  Element questionsElement=rootElement.element("questions");
  for (  Element questionElement : questionsElement.elements("question")) {
    StagedModelDataHandlerUtil.importStagedModel(portletDataContext,questionElement);
  }
  Element choicesElement=rootElement.element("choices");
  for (  Element choiceElement : choicesElement.elements("choice")) {
    StagedModelDataHandlerUtil.importStagedModel(portletDataContext,choiceElement);
  }
  if (portletDataContext.getBooleanParameter(PollsPortletDataHandler.NAMESPACE,"votes")) {
    Element votesElement=rootElement.element("votes");
    for (    Element voteElement : votesElement.elements("vote")) {
      StagedModelDataHandlerUtil.importStagedModel(portletDataContext,voteElement);
    }
  }
  long questionId=GetterUtil.getLong(portletPreferences.getValue("questionId",StringPool.BLANK));
  if (questionId > 0) {
    Map<Long,Long> questionIds=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(PollsQuestion.class);
    questionId=MapUtil.getLong(questionIds,questionId,questionId);
    portletPreferences.setValue("questionId",String.valueOf(questionId));
  }
  return portletPreferences;
}
