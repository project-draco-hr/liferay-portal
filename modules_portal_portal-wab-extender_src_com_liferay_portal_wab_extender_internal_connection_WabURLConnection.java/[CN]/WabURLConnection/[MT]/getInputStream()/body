{
  URL url=getURL();
  String query=url.getQuery();
  Map<String,String[]> parameters=HttpUtil.getParameterMap(query);
  if (!parameters.containsKey("Web-ContextPath")) {
    throw new IllegalArgumentException("The parameter map does not contain the required parameter " + "Web-ContextPath");
  }
  File file=transferToTempFile(new URL(url.getPath()));
  try {
    WabProcessor wabProcessor=new WabProcessor(_bundleContext,_classLoader,file,parameters);
    wabProcessor.process();
    return wabProcessor.getInputStream();
  }
  finally {
    FileUtil.deltree(file.getParentFile());
  }
}
