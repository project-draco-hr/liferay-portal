{
  if (!PropsValues.BLOGS_PINGBACK_ENABLED) {
    throw new DisabledPingbackException("Pingbacks are disabled");
  }
  validateSource();
  BlogsEntry entry=getBlogsEntry(companyId);
  if (!entry.isAllowPingbacks()) {
    throw new DisabledPingbackException("Pingbacks are disabled");
  }
  long userId=_userLocalService.getDefaultUserId(companyId);
  long groupId=entry.getGroupId();
  String className=BlogsEntry.class.getName();
  long classPK=entry.getEntryId();
  String body="[...] " + getExcerpt() + " [...] [url="+ _sourceURI+ "]"+ LanguageUtil.get(LocaleUtil.getSiteDefault(),"read-more")+ "[/url]";
  ServiceContext serviceContext=buildServiceContext(companyId,groupId,entry.getUrlTitle());
  return _commentManager.addComment(userId,groupId,className,classPK,body,new IdentityServiceContextFunction(serviceContext));
}
