{
  if (_isMonthlyPeriod()) {
    Calendar calendar=new GregorianCalendar();
    calendar.set(Calendar.DATE,1);
    calendar.add(Calendar.MONTH,offset + 1);
    calendar.add(Calendar.DATE,-1);
    calendar.set(Calendar.HOUR_OF_DAY,0);
    calendar.set(Calendar.MINUTE,0);
    calendar.set(Calendar.SECOND,0);
    calendar.set(Calendar.MILLISECOND,0);
    return getActivityDay(calendar);
  }
  return getEndPeriod() - offset * getPeriodLength();
}
