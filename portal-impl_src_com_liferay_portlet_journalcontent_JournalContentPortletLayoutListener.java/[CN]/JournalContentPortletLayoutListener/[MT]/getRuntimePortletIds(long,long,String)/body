{
  JournalArticle journalArticle=null;
  Group companyGroup=GroupLocalServiceUtil.getCompanyGroup(companyId);
  try {
    journalArticle=JournalArticleLocalServiceUtil.getDisplayArticle(scopeGroupId,articleId);
  }
 catch (  NoSuchArticleException nsae) {
  }
  if (journalArticle == null) {
    try {
      journalArticle=JournalArticleLocalServiceUtil.getDisplayArticle(companyGroup.getGroupId(),articleId);
    }
 catch (    NoSuchArticleException nsae) {
      return null;
    }
  }
  List<String> portletIds=getRuntimePortletIds(journalArticle.getContent());
  if (Validator.isNotNull(journalArticle.getTemplateId())) {
    JournalTemplate journalTemplate=null;
    try {
      journalTemplate=JournalTemplateLocalServiceUtil.getTemplate(scopeGroupId,journalArticle.getTemplateId());
    }
 catch (    NoSuchTemplateException nste) {
      journalTemplate=JournalTemplateLocalServiceUtil.getTemplate(companyGroup.getGroupId(),journalArticle.getTemplateId());
    }
    portletIds.addAll(getRuntimePortletIds(journalTemplate.getXsl()));
  }
  return portletIds;
}
