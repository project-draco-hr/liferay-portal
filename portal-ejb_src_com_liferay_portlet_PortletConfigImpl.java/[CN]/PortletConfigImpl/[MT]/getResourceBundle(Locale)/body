{
  if (_resourceBundle == null) {
    String poolId=_portletId;
    ResourceBundle bundle=(ResourceBundle)_bundlePool.get(poolId);
    if (bundle == null) {
      StringBuffer sb=new StringBuffer();
      try {
        sb.append(WebKeys.JAVAX_PORTLET_TITLE);
        sb.append("=");
        sb.append(_portletInfo.getTitle());
        sb.append("\n");
        sb.append(WebKeys.JAVAX_PORTLET_SHORT_TITLE);
        sb.append("=");
        sb.append(_portletInfo.getShortTitle());
        sb.append("\n");
        sb.append(WebKeys.JAVAX_PORTLET_KEYWORDS);
        sb.append("=");
        sb.append(_portletInfo.getKeywords());
        sb.append("\n");
        bundle=new PropertyResourceBundle(new ByteArrayInputStream(sb.toString().getBytes()));
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      _bundlePool.put(poolId,bundle);
    }
    return bundle;
  }
 else {
    String poolId=_portletId + "." + locale.toString();
    ResourceBundle bundle=(ResourceBundle)_bundlePool.get(poolId);
    if (bundle == null) {
      if (!_warFile && _resourceBundle.equals(StrutsResourceBundle.class.getName())) {
        String companyId=(String)_portletCtx.getAttribute(WebKeys.COMPANY_ID);
        bundle=StrutsResourceBundle.getBundle(_portletName,companyId,locale);
      }
 else {
        PortletContextWrapper pcw=PortletContextPool.get(_rootPortletId);
        bundle=pcw.getResourceBundle(locale);
      }
      bundle=new PortletResourceBundle(bundle,_portletInfo);
      _bundlePool.put(poolId,bundle);
    }
    return bundle;
  }
}
