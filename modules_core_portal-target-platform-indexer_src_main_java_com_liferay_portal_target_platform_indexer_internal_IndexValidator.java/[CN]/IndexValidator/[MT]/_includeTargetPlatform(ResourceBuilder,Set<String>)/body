{
  if (!_includeTargetPlatform) {
    return;
  }
  File targetPlatformDir=new File(_moduleFrameworkBaseDir,Indexer.DIR_NAME_TARGET_PLATFORM);
  if (!targetPlatformDir.exists() || !targetPlatformDir.canRead()) {
    System.err.printf("== Cannot read target platform dir %s\n",targetPlatformDir);
    return;
  }
  File[] indexFiles=targetPlatformDir.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      if (name.endsWith(".xml") || name.endsWith(".xml.gz")) {
        return true;
      }
      return false;
    }
  }
);
  for (  File indexFile : indexFiles) {
    URI uri=indexFile.toURI();
    String identity=_getRepositoryIdentity(uri.getPath(),Files.newInputStream(indexFile.toPath()));
    if (identities.contains(identity)) {
      continue;
    }
    identities.add(identity);
    try (XMLResourceParser xmlResourceParser=new XMLResourceParser(uri)){
      List<Resource> resources=xmlResourceParser.parse();
      for (      Resource resource : resources) {
        resourceBuilder.addCapabilities(resource.getCapabilities(null));
      }
    }
   }
}
