{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  User user=themeDisplay.getUser();
  String groupId=ParamUtil.getString(req,"groupId");
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  GroupPermission.check(themeDisplay.getPermissionChecker(),group.getGroupId(),ActionKeys.MANAGE_LAYOUTS);
  if (group.isUser() && group.getClassPK().equals(user.getUserId()) && !user.isLayoutsRequired()) {
    throw new PrincipalException();
  }
}
