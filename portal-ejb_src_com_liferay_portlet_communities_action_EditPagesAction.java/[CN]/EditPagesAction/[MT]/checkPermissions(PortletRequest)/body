{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  User user=themeDisplay.getUser();
  long groupId=ParamUtil.getLong(req,"groupId");
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  GroupPermission.check(themeDisplay.getPermissionChecker(),group.getGroupId(),ActionKeys.MANAGE_LAYOUTS);
  if (group.isUser()) {
    long groupUserId=GetterUtil.getLong(group.getClassPK());
    if ((groupUserId == user.getUserId()) && !user.isLayoutsRequired()) {
      throw new PrincipalException();
    }
  }
}
