{
  if (!rebuildTreeEnabled) {
    return;
  }
  long groupId=assetCategory.getGroupId();
  long lastRightCategoryId=getLastRightCategoryId(groupId,assetCategory.getParentCategoryId());
  long leftCategoryId=2;
  long rightCategoryId=3;
  if (lastRightCategoryId > 0) {
    leftCategoryId=lastRightCategoryId + 1;
    long childrenDistance=assetCategory.getRightCategoryId() - assetCategory.getLeftCategoryId();
    if (childrenDistance > 1) {
      rightCategoryId=leftCategoryId + childrenDistance;
      long diff=leftCategoryId - assetCategory.getLeftCategoryId();
      updateChildrenTree(diff,groupId,childrenCategoryIds);
      expandNoChildrenLeftCategoryId(childrenDistance + 1,groupId,lastRightCategoryId,childrenCategoryIds);
      expandNoChildrenRightCategoryId(childrenDistance + 1,groupId,lastRightCategoryId,childrenCategoryIds);
    }
 else {
      rightCategoryId=lastRightCategoryId + 2;
      expandTreeLeftCategoryId.expand(groupId,lastRightCategoryId);
      expandTreeRightCategoryId.expand(groupId,lastRightCategoryId);
    }
    CacheRegistryUtil.clear(AssetCategoryImpl.class.getName());
    EntityCacheUtil.clearCache(AssetCategoryImpl.class.getName());
    FinderCacheUtil.clearCache(FINDER_CLASS_NAME_ENTITY);
    FinderCacheUtil.clearCache(FINDER_CLASS_NAME_LIST_WITHOUT_PAGINATION);
  }
  assetCategory.setLeftCategoryId(leftCategoryId);
  assetCategory.setRightCategoryId(rightCategoryId);
}
