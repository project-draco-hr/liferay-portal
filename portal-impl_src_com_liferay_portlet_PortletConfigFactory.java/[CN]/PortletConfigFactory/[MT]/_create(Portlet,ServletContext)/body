{
  Map<String,PortletConfig> portletConfigs=_pool.get(portlet.getRootPortletId());
  if (portletConfigs == null) {
    portletConfigs=new ConcurrentHashMap<String,PortletConfig>();
    _pool.put(portlet.getRootPortletId(),portletConfigs);
  }
  PortletConfig portletConfig=portletConfigs.get(portlet.getPortletId());
  if (portletConfig == null) {
    PortletContext portletCtx=PortletContextFactory.create(portlet,ctx);
    portletConfig=new PortletConfigImpl(portlet.getPortletId(),portletCtx,portlet.getInitParams(),portlet.getResourceBundle(),portlet.getPortletInfo());
    portletConfigs.put(portlet.getPortletId(),portletConfig);
  }
  return portletConfig;
}
