{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  Theme theme=themeDisplay.getTheme();
  ColorScheme colorScheme=themeDisplay.getColorScheme();
  String themeId=ParamUtil.getString(req,"themeId");
  String colorSchemeId=ParamUtil.getString(req,"colorSchemeId");
  if ((theme == null) || (colorScheme == null) || (!theme.getThemeId().equals(themeId))|| (!colorScheme.getColorSchemeId().equals(colorSchemeId))) {
    theme=ThemeLocalUtil.getTheme(themeDisplay.getCompanyId(),themeId);
    colorScheme=ThemeLocalUtil.getColorScheme(themeDisplay.getCompanyId(),themeId,colorSchemeId);
    themeDisplay.setLookAndFeel(theme,colorScheme);
    req.setAttribute(WebKeys.THEME,theme);
    req.setAttribute(WebKeys.COLOR_SCHEME,colorScheme);
  }
  res.addHeader(HttpHeaders.CACHE_CONTROL,"max-age=0");
  res.setDateHeader(HttpHeaders.LAST_MODIFIED,System.currentTimeMillis());
  return mapping.findForward("modified.jsp");
}
