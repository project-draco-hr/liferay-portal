{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    try {
      runSQL("alter table DDMTemplate add classNameId LONG");
      runSQL("alter table DDMTemplate add templateKey STRING");
      runSQL("alter_column_name DDMTemplate structureId classPK LONG");
    }
 catch (    SQLException sqle) {
      upgradeTable(DDMTemplateTable.TABLE_NAME,DDMTemplateTable.TABLE_COLUMNS,DDMTemplateTable.TABLE_SQL_CREATE,DDMTemplateTable.TABLE_SQL_ADD_INDEXES);
    }
    long classNameId=PortalUtil.getClassNameId("com.liferay.portlet.dynamicdatamapping.DDMStructure");
    try {
      runSQL("update DDMTemplate set classNameId = " + classNameId);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
 }
