{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long userId=themeDisplay.getUserId();
  long groupId=themeDisplay.getScopeGroupId();
  String[] entries=StringUtil.split(ParamUtil.getString(actionRequest,"entries"));
  String[] notEntries=StringUtil.split(ParamUtil.getString(actionRequest,"notEntries"));
  boolean mergeUrlTags=ParamUtil.getBoolean(actionRequest,"mergeUrlTags");
  boolean andOperator=ParamUtil.getBoolean(actionRequest,"andOperator");
  long classNameId=ParamUtil.getLong(actionRequest,"classNameId");
  String category=ParamUtil.getString(actionRequest,"category");
  String displayStyle=ParamUtil.getString(actionRequest,"displayStyle");
  String orderByColumn1=ParamUtil.getString(actionRequest,"orderByColumn1");
  String orderByColumn2=ParamUtil.getString(actionRequest,"orderByColumn2");
  String orderByType1=ParamUtil.getString(actionRequest,"orderByType1");
  String orderByType2=ParamUtil.getString(actionRequest,"orderByType2");
  boolean excludeZeroViewCount=ParamUtil.getBoolean(actionRequest,"excludeZeroViewCount");
  boolean showQueryLogic=ParamUtil.getBoolean(actionRequest,"showQueryLogic");
  int delta=ParamUtil.getInteger(actionRequest,"delta");
  String paginationType=ParamUtil.getString(actionRequest,"paginationType");
  boolean showAvailableLocales=ParamUtil.getBoolean(actionRequest,"showAvailableLocales");
  boolean enableComments=ParamUtil.getBoolean(actionRequest,"enableComments");
  boolean enableCommentRatings=ParamUtil.getBoolean(actionRequest,"enableCommentRatings");
  boolean enableRatings=ParamUtil.getBoolean(actionRequest,"enableRatings");
  String medatadaFields=ParamUtil.getString(actionRequest,"metadataFields");
  preferences.setValue("selection-style","dynamic");
  preferences.setValues("entries",entries);
  preferences.setValues("not-entries",notEntries);
  preferences.setValue("merge-url-tags",String.valueOf(mergeUrlTags));
  preferences.setValue("and-operator",String.valueOf(andOperator));
  preferences.setValue("class-name-id",String.valueOf(classNameId));
  preferences.setValue("category",category);
  preferences.setValue("display-style",displayStyle);
  preferences.setValue("order-by-column-1",orderByColumn1);
  preferences.setValue("order-by-column-2",orderByColumn2);
  preferences.setValue("order-by-type-1",orderByType1);
  preferences.setValue("order-by-type-2",orderByType2);
  preferences.setValue("exclude-zero-view-count",String.valueOf(excludeZeroViewCount));
  preferences.setValue("show-query-logic",String.valueOf(showQueryLogic));
  preferences.setValue("delta",String.valueOf(delta));
  preferences.setValue("pagination-type",paginationType);
  preferences.setValue("show-available-locales",String.valueOf(showAvailableLocales));
  preferences.setValue("enable-ratings",String.valueOf(enableRatings));
  preferences.setValue("enable-comments",String.valueOf(enableComments));
  preferences.setValue("enable-comment-ratings",String.valueOf(enableCommentRatings));
  preferences.setValue("metadata-fields",medatadaFields);
  TagsEntryLocalServiceUtil.checkEntries(userId,groupId,entries);
  TagsEntryLocalServiceUtil.checkEntries(userId,groupId,notEntries);
}
