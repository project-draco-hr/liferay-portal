{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String[] scopeIds=preferences.getValues("scopeIds",new String[]{AssetPublisher.SCOPE_ID_GROUP_PREFIX + GroupConstants.DEFAULT});
  long selectedGroupId=ParamUtil.getLong(actionRequest,"selectedGroupId");
  Group selectedGroup=GroupLocalServiceUtil.fetchGroup(selectedGroupId);
  String scopeId=AssetPublisherUtil.getScopeId(selectedGroup,themeDisplay.getScopeGroupId());
  checkPermission(actionRequest,scopeId);
  if (!ArrayUtil.contains(scopeIds,scopeId)) {
    scopeIds=ArrayUtil.append(scopeIds,scopeId);
  }
  preferences.setValues("scopeIds",scopeIds);
}
