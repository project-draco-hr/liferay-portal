{
  String smartUpgradeSchemaImplClassName=this.getClass().getName();
  if (_alreadyUpgraded) {
    _log.info("Skipping " + smartUpgradeSchemaImplClassName + " because it has already been executed");
    return;
  }
  _alreadyUpgraded=true;
  try {
    upgradeOnce();
    boolean doUpgrade=false;
    for (int i=0; i < _UPGRADE_PROGRESS_CLASSES.length; i++) {
      String curUpgradeSchemaClassName=_UPGRADE_PROGRESS_CLASSES[i].getName();
      if (doUpgrade) {
        SmartUpgradeSchema upgradeSchema=(SmartUpgradeSchema)InstancePool.get(curUpgradeSchemaClassName);
        if (!upgradeSchema.isAlreadyUpgraded()) {
          _log.info("Automatically executing " + curUpgradeSchemaClassName);
          upgradeSchema.setAlreadyUpgraded(true);
          upgradeSchema.upgradeOnce();
        }
      }
      if (smartUpgradeSchemaImplClassName.equals(curUpgradeSchemaClassName)) {
        doUpgrade=true;
      }
    }
  }
 catch (  Exception e) {
    throw new UpgradeException(e);
  }
}
