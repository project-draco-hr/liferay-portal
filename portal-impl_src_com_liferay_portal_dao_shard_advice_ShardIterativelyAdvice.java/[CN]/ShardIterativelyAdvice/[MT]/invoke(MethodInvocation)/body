{
  Object returnValue=null;
  for (  String shardName : ShardUtil.getAvailableShardNames()) {
    if (_log.isInfoEnabled()) {
      _log.info("Invoking shard " + shardName + " for "+ methodInvocation.toString());
    }
    String currentShardName=ShardUtil.setTargetSource(shardName);
    _shardAdvice.pushCompanyService(shardName);
    try {
      Object value=methodInvocation.proceed();
      if (shardName.equals(ShardUtil.getDefaultShardName())) {
        returnValue=value;
      }
    }
  finally {
      _shardAdvice.popCompanyService();
      ShardUtil.setTargetSource(currentShardName);
      CacheRegistryUtil.clear();
    }
  }
  return returnValue;
}
