{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String factoryPid=ParamUtil.getString(actionRequest,"factoryPid");
  String pid=ParamUtil.getString(actionRequest,"pid",factoryPid);
  if (_log.isDebugEnabled()) {
    _log.debug("Binding attributes for service " + pid);
  }
  ConfigurationModel configurationModel=null;
  Map<String,ConfigurationModel> configurationModels=_configurationModelRetriever.getConfigurationModels(themeDisplay.getLanguageId());
  if (Validator.isNotNull(factoryPid)) {
    configurationModel=configurationModels.get(factoryPid);
  }
 else {
    configurationModel=configurationModels.get(pid);
  }
  Configuration configuration=_configurationModelRetriever.getConfiguration(pid);
  ConfigurationModelToDDMFormConverter configurationModelToDDMFormConverter;
  ResourceBundleLoader resourceBundleLoader=_resourceBundleLoaderProvider.getResourceBundleLoader(configurationModel.getBundleSymbolicName());
  ResourceBundle resourceBundle=resourceBundleLoader.loadResourceBundle(themeDisplay.getLanguageId());
  configurationModelToDDMFormConverter=new ConfigurationModelToDDMFormConverter(configurationModel,themeDisplay.getLocale(),resourceBundle);
  DDMForm ddmForm=configurationModelToDDMFormConverter.getDDMForm();
  DDMFormValues ddmFormValues=getDDMFormValues(actionRequest,ddmForm);
  DDMFormValuesToPropertiesConverter ddmFormValuesToPropertiesConverter=new DDMFormValuesToPropertiesConverter(configurationModel,ddmFormValues,_jsonFactory,themeDisplay.getLocale());
  Dictionary<String,Object> properties=ddmFormValuesToPropertiesConverter.getProperties();
  properties.put(Constants.SERVICE_PID,pid);
  if (Validator.isNotNull(factoryPid)) {
    properties.put(ConfigurationAdmin.SERVICE_FACTORYPID,factoryPid);
  }
  configureTargetService(configurationModel,configuration,properties);
  return true;
}
