{
  for (  Archive<?> auxiliaryArchive : auxiliaryArchives) {
    Node remoteLoadableExtensionNode=auxiliaryArchive.get(_REMOTE_LOADABLE_EXTENSION_FILE);
    if (remoteLoadableExtensionNode == null) {
      continue;
    }
    javaArchive.add(remoteLoadableExtensionNode.getAsset(),_REMOTE_LOADABLE_EXTENSION_FILE);
    String path="extension/" + auxiliaryArchive.getName();
    javaArchive.addAsResource(new ArchiveAsset(auxiliaryArchive,ZipExporter.class),path);
    manifestAssetBuilder.addBundleClassPathFile(path);
    Node manifestNode=auxiliaryArchive.get(JarFile.MANIFEST_NAME);
    if (manifestNode == null) {
      continue;
    }
    Asset manifestAsset=manifestNode.getAsset();
    Manifest manifest=new Manifest(manifestAsset.openStream());
    if (OSGiManifestBuilder.isValidBundleManifest(manifest)) {
      Attributes attributes=manifest.getMainAttributes();
      String value=attributes.getValue("Import-package");
      if (value != null) {
        manifestAssetBuilder.addImports(Arrays.asList(StringUtil.split(value)));
      }
      String bundleActivator=attributes.getValue("Bundle-Activator");
      if (bundleActivator != null) {
        manifestAssetBuilder.addBundleActivator(bundleActivator);
      }
    }
  }
}
