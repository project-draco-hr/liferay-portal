{
  AssetEntryQuery assetEntryQuery=AssetPublisherUtil.getAssetEntryQuery(portletPreferences,groupIds,null,null);
  long[] classNameIds=AssetPublisherUtil.getClassNameIds(portletPreferences,AssetRendererFactoryRegistryUtil.getClassNameIds(companyId,true));
  assetEntryQuery.setClassNameIds(classNameIds);
  long[] classTypeIds=GetterUtil.getLongValues(portletPreferences.getValues("classTypeIds",null));
  assetEntryQuery.setClassTypeIds(classTypeIds);
  assetEntryQuery.setEnablePermissions(false);
  int end=AssetPublisherWebConfigurationValues.DYNAMIC_EXPORT_LIMIT;
  if (end == 0) {
    end=QueryUtil.ALL_POS;
  }
  assetEntryQuery.setEnd(end);
  assetEntryQuery.setExcludeZeroViewCount(false);
  assetEntryQuery.setGroupIds(groupIds);
  boolean showOnlyLayoutAssets=GetterUtil.getBoolean(portletPreferences.getValue("showOnlyLayoutAssets",null));
  if (showOnlyLayoutAssets) {
    assetEntryQuery.setLayout(layout);
  }
  String orderByCol1=GetterUtil.getString(portletPreferences.getValue("orderByColumn1","modifiedDate"));
  assetEntryQuery.setOrderByCol1(orderByCol1);
  String orderByCol2=GetterUtil.getString(portletPreferences.getValue("orderByColumn2","title"));
  assetEntryQuery.setOrderByCol2(orderByCol2);
  String orderByType1=GetterUtil.getString(portletPreferences.getValue("orderByType1","DESC"));
  assetEntryQuery.setOrderByType1(orderByType1);
  String orderByType2=GetterUtil.getString(portletPreferences.getValue("orderByType2","ASC"));
  assetEntryQuery.setOrderByType2(orderByType2);
  int start=0;
  if (end == 0) {
    start=QueryUtil.ALL_POS;
  }
  assetEntryQuery.setStart(start);
  return assetEntryQuery;
}
