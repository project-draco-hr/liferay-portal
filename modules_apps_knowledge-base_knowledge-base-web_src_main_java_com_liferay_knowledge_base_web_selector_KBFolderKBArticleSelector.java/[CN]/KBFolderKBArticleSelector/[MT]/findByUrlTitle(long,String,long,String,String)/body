{
  KBFolder ancestorKBFolder=_rootKBFolder;
  if (ancestorResourcePrimKey != KBFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    ancestorKBFolder=KBFolderLocalServiceUtil.fetchKBFolder(ancestorResourcePrimKey);
    if (ancestorKBFolder == null) {
      return new KBArticleSelection(null,false);
    }
  }
  KBFolder kbFolder=_rootKBFolder;
  if (Validator.isNotNull(kbFolderUrlTitle)) {
    if (kbFolderUrlTitle.equals(ancestorKBFolder.getUrlTitle())) {
      kbFolder=ancestorKBFolder;
    }
 else {
      kbFolder=KBFolderLocalServiceUtil.fetchKBFolderByUrlTitle(groupId,ancestorKBFolder.getKbFolderId(),kbFolderUrlTitle);
    }
  }
  KBArticle kbArticle=KBArticleLocalServiceUtil.fetchKBArticleByUrlTitle(groupId,kbFolder.getKbFolderId(),urlTitle);
  if ((kbArticle == null) || !isDescendant(kbArticle,ancestorKBFolder)) {
    return findClosestMatchingKBArticle(groupId,ancestorKBFolder,preferredKBFolderUrlTitle,kbFolderUrlTitle,urlTitle);
  }
  return new KBArticleSelection(kbArticle,true);
}
