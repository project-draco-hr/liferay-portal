{
  KBFolder kbFolder=null;
  if (Validator.isNotNull(kbFolderUrlTitle)) {
    kbFolder=KBFolderLocalServiceUtil.fetchKBFolderByUrlTitle(groupId,ancestorKBFolder.getKbFolderId(),kbFolderUrlTitle);
  }
  if ((kbFolder == null) && Validator.isNotNull(preferredKBFolderUrlTitle)) {
    kbFolder=KBFolderLocalServiceUtil.fetchKBFolderByUrlTitle(groupId,ancestorKBFolder.getKbFolderId(),preferredKBFolderUrlTitle);
  }
  int kbArticlesCount=KBArticleLocalServiceUtil.getKBArticlesCount(groupId,ancestorKBFolder.getKbFolderId(),WorkflowConstants.STATUS_APPROVED);
  if ((kbFolder == null) && (kbArticlesCount == 0)) {
    kbFolder=KBFolderLocalServiceUtil.fetchFirstChildKBFolder(groupId,ancestorKBFolder.getKbFolderId());
  }
  if (kbFolder == null) {
    return ancestorKBFolder;
  }
  return kbFolder;
}
