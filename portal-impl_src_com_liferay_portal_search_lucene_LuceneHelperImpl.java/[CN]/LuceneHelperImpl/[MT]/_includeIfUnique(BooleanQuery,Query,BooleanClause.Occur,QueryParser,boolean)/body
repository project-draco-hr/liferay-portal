{
  if (query instanceof TermQuery) {
    Set<Term> terms=new HashSet<Term>();
    TermQuery termQuery=(TermQuery)query;
    termQuery.extractTerms(terms);
    float boost=termQuery.getBoost();
    for (    Term term : terms) {
      String termValue=term.text();
      if (like) {
        termValue=termValue.toLowerCase(queryParser.getLocale());
        term=term.createTerm(StringPool.STAR.concat(termValue).concat(StringPool.STAR));
        query=new WildcardQuery(term);
      }
 else {
        query=new TermQuery(term);
      }
      query.setBoost(boost);
      boolean included=false;
      for (      BooleanClause booleanClause : booleanQuery.getClauses()) {
        if (query.equals(booleanClause.getQuery())) {
          included=true;
        }
      }
      if (!included) {
        booleanQuery.add(query,occur);
      }
    }
  }
 else   if (query instanceof BooleanQuery) {
    BooleanQuery curBooleanQuery=(BooleanQuery)query;
    BooleanQuery containerBooleanQuery=new BooleanQuery();
    for (    BooleanClause booleanClause : curBooleanQuery.getClauses()) {
      _includeIfUnique(containerBooleanQuery,booleanClause.getQuery(),booleanClause.getOccur(),queryParser,like);
    }
    if (containerBooleanQuery.getClauses().length > 0) {
      booleanQuery.add(containerBooleanQuery,occur);
    }
  }
 else {
    boolean included=false;
    for (    BooleanClause booleanClause : booleanQuery.getClauses()) {
      if (query.equals(booleanClause.getQuery())) {
        included=true;
      }
    }
    if (!included) {
      booleanQuery.add(query,occur);
    }
  }
}
