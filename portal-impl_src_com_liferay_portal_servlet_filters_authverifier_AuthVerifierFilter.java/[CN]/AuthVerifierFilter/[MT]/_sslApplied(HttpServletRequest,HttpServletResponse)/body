{
  if (!_httpsRequired || request.isSecure()) {
    return false;
  }
  if (_log.isDebugEnabled()) {
    String completeURL=HttpUtil.getCompleteURL(request);
    _log.debug("Securing " + completeURL);
  }
  StringBundler redirectURL=new StringBundler(5);
  redirectURL.append(Http.HTTPS_WITH_SLASH);
  redirectURL.append(request.getServerName());
  redirectURL.append(request.getServletPath());
  String queryString=request.getQueryString();
  if (Validator.isNotNull(queryString)) {
    redirectURL.append(StringPool.QUESTION);
    redirectURL.append(request.getQueryString());
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Redirect to " + redirectURL);
  }
  response.sendRedirect(redirectURL.toString());
  return true;
}
