{
  Boolean attachments=(Boolean)oldValue;
  if (attachments.booleanValue()) {
    Long oldMessageId=(Long)_messageIdColumn.getOldValue();
    String oldCompanyId=(String)_companyIdColumn.getOldValue();
    Long oldThreadId=(Long)_threadIdColumn.getOldValue();
    Long newMessageId=(Long)_messageIdColumn.getNewValue();
    Long newCompanyId=(Long)_companyIdColumn.getNewValue();
    Long newThreadId=(Long)_threadIdColumn.getNewValue();
    String[] fileNames=null;
    try {
      fileNames=DLServiceUtil.getFileNames(oldCompanyId,"system","messageboards/" + oldThreadId + "/"+ oldMessageId);
    }
 catch (    NoSuchDirectoryException nsde) {
    }
    if ((fileNames == null) || (fileNames.length == 0)) {
      return Boolean.FALSE;
    }
    DLServiceUtil.addDirectory(newCompanyId.longValue(),CompanyImpl.SYSTEM,"messageboards/" + newThreadId + "/"+ newMessageId);
    for (int i=0; i < fileNames.length; i++) {
      String fileName=fileNames[i];
      String shortFileName=FileUtil.getShortFileName(fileName);
      InputStream is=null;
      try {
        is=DLLocalServiceUtil.getFileAsStream(oldCompanyId,"system",fileName);
        String dirName="messageboards/" + newThreadId.longValue() + "/"+ newMessageId.longValue();
        DLLocalServiceUtil.addFile(newCompanyId.longValue(),CompanyImpl.SYSTEM_STRING,GroupImpl.DEFAULT_PARENT_GROUP_ID,CompanyImpl.SYSTEM,dirName + "/" + shortFileName,is);
      }
  finally {
        if (is != null) {
          is.close();
        }
      }
    }
  }
  return attachments;
}
