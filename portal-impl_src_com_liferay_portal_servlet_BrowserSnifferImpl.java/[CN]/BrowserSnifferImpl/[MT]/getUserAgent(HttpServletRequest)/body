{
  String userAgent=StringPool.BLANK;
  if (request == null) {
    return userAgent;
  }
  userAgent=String.valueOf(request.getAttribute(HttpHeaders.USER_AGENT));
  if (Validator.isNotNull(userAgent)) {
    return userAgent;
  }
  userAgent=request.getHeader(HttpHeaders.USER_AGENT);
  if (userAgent != null) {
    userAgent=StringUtil.toLowerCase(userAgent);
  }
 else {
    userAgent=StringPool.BLANK;
  }
  request.setAttribute(HttpHeaders.USER_AGENT,userAgent);
  return userAgent;
}
