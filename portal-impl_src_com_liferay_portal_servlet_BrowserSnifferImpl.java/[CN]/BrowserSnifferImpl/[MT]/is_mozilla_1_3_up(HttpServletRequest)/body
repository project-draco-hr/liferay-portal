{
  if (request == null) {
    return false;
  }
  String agent=request.getHeader(HttpHeaders.USER_AGENT);
  if (agent == null) {
    return false;
  }
  agent=agent.toLowerCase();
  if (is_mozilla(request)) {
    int pos=agent.indexOf("gecko/");
    if (pos == -1) {
      return false;
    }
 else {
      String releaseDate=agent.substring(pos + 6,agent.length());
      if (releaseDate.compareTo("20030210") > 0) {
        return true;
      }
    }
  }
  return false;
}
