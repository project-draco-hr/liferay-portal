{
  String version=(String)request.getAttribute(WebKeys.BROWSER_SNIFFER_VERSION);
  if (version != null) {
    return version;
  }
  String userAgent=getUserAgent(request);
  version=parseVersion(userAgent,_versionLeadings,_versionSeparators);
  if (version.isEmpty()) {
    version=parseVersion(userAgent,_revisionLeadings,_revisionSeparators);
  }
  request.setAttribute(WebKeys.BROWSER_SNIFFER_VERSION,version);
  return version;
}
