{
  BooleanClauseOccur booleanClauseOccur=getBooleanClauseOccur(occur);
  if (query instanceof org.apache.lucene.search.TermQuery) {
    org.apache.lucene.search.TermQuery luceneTermQuery=(org.apache.lucene.search.TermQuery)query;
    Term term=luceneTermQuery.getTerm();
    String termValue=term.text();
    TermQuery termQuery=new TermQueryImpl(term.field(),termValue);
    booleanQuery.add(termQuery,getBooleanClauseOccur(occur));
  }
 else   if (query instanceof org.apache.lucene.search.BooleanQuery) {
    org.apache.lucene.search.BooleanQuery curBooleanQuery=(org.apache.lucene.search.BooleanQuery)query;
    BooleanQuery conjunctionQuery=new BooleanQueryImpl();
    BooleanQuery disjunctionQuery=new BooleanQueryImpl();
    for (    org.apache.lucene.search.BooleanClause booleanClause : curBooleanQuery.getClauses()) {
      BooleanClauseOccur curBooleanClauseOccur=getBooleanClauseOccur(booleanClause.getOccur());
      BooleanQuery subbooleanQuery=null;
      if (curBooleanClauseOccur.equals(BooleanClauseOccur.SHOULD)) {
        subbooleanQuery=disjunctionQuery;
      }
 else {
        subbooleanQuery=conjunctionQuery;
      }
      translateQuery(subbooleanQuery,searchContext,booleanClause.getQuery(),booleanClause.getOccur());
    }
    if (conjunctionQuery.hasClauses()) {
      booleanQuery.add(conjunctionQuery,BooleanClauseOccur.MUST);
    }
    if (disjunctionQuery.hasClauses()) {
      booleanQuery.add(disjunctionQuery,BooleanClauseOccur.SHOULD);
    }
  }
 else   if (query instanceof org.apache.lucene.search.FuzzyQuery) {
    org.apache.lucene.search.FuzzyQuery fuzzyQuery=(org.apache.lucene.search.FuzzyQuery)query;
    Term term=fuzzyQuery.getTerm();
    String termValue=term.text().concat(StringPool.STAR);
    WildcardQuery wildcardQuery=new WildcardQueryImpl(term.field(),termValue);
    booleanQuery.add(wildcardQuery,booleanClauseOccur);
  }
 else   if (query instanceof org.apache.lucene.search.PhraseQuery) {
    org.apache.lucene.search.PhraseQuery phraseQuery=(org.apache.lucene.search.PhraseQuery)query;
    Term[] terms=phraseQuery.getTerms();
    StringBundler sb=new StringBundler(terms.length * 2);
    for (    Term term : terms) {
      sb.append(term.text());
      sb.append(StringPool.SPACE);
    }
    TermQuery termQuery=new TermQueryImpl(terms[0].field(),sb.toString().trim());
    booleanQuery.add(termQuery,booleanClauseOccur);
  }
 else   if (query instanceof org.apache.lucene.search.PrefixQuery) {
    org.apache.lucene.search.PrefixQuery prefixQuery=(org.apache.lucene.search.PrefixQuery)query;
    Term prefixTerm=prefixQuery.getPrefix();
    String termValue=prefixTerm.text().concat(StringPool.STAR);
    WildcardQuery wildcardQuery=new WildcardQueryImpl(prefixTerm.field(),termValue);
    booleanQuery.add(wildcardQuery,booleanClauseOccur);
  }
 else   if (query instanceof org.apache.lucene.search.TermRangeQuery) {
    org.apache.lucene.search.TermRangeQuery termRangeQuery=(org.apache.lucene.search.TermRangeQuery)query;
    booleanQuery.addRangeTerm(termRangeQuery.getField(),termRangeQuery.getLowerTerm().utf8ToString(),termRangeQuery.getUpperTerm().utf8ToString());
  }
 else   if (query instanceof org.apache.lucene.search.WildcardQuery) {
    org.apache.lucene.search.WildcardQuery luceneWildcardQuery=(org.apache.lucene.search.WildcardQuery)query;
    Term wildcardTerm=luceneWildcardQuery.getTerm();
    WildcardQuery wildcardQuery=new WildcardQueryImpl(wildcardTerm.field(),wildcardTerm.text());
    booleanQuery.add(wildcardQuery,booleanClauseOccur);
  }
 else {
    if (_log.isWarnEnabled()) {
      _log.warn("Ignoring unknown query type " + query.getClass() + " with query "+ query);
    }
  }
}
