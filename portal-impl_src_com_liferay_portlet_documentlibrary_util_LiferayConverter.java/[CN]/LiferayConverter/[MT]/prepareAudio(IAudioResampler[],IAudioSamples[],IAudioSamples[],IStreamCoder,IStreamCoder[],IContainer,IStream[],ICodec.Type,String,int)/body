{
  IStream outputIStream=outputIContainer.addNewStream(index);
  outputIStreams[index]=outputIStream;
  IStreamCoder outputIStreamCoder=outputIStream.getStreamCoder();
  outputIStreamCoders[index]=outputIStreamCoder;
  int bitRate=inputIStreamCoder.getBitRate();
  if (_log.isInfoEnabled()) {
    _log.info("Original audio bitrate " + bitRate);
  }
  if (bitRate == 0) {
    bitRate=AUDIO_BIT_RATE_DEFAULT;
  }
  if (_log.isInfoEnabled()) {
    _log.info("Modified audio bitrate " + bitRate);
  }
  outputIStreamCoder.setBitRate(bitRate);
  int channels=getAudioEncodingChannels(outputIContainer,inputIStreamCoder.getChannels());
  outputIStreamCoder.setChannels(channels);
  ICodec iCodec=getAudioEncodingICodec(outputIContainer);
  if (iCodec == null) {
    iCodec=ICodec.guessEncodingCodec(null,null,outputURL,null,inputICodecType);
  }
  if (iCodec == null) {
    throw new RuntimeException("Unable to determine " + inputICodecType + " encoder for "+ outputURL);
  }
  outputIStreamCoder.setCodec(iCodec);
  outputIStreamCoder.setGlobalQuality(0);
  outputIStreamCoder.setSampleRate(AUDIO_SAMPLE_RATE_DEFAULT);
  iAudioResamplers[index]=createIAudioResampler(inputIStreamCoder,outputIStreamCoder);
  inputIAudioSamples[index]=IAudioSamples.make(1024,inputIStreamCoder.getChannels());
  outputIAudioSamples[index]=IAudioSamples.make(1024,outputIStreamCoder.getChannels());
}
