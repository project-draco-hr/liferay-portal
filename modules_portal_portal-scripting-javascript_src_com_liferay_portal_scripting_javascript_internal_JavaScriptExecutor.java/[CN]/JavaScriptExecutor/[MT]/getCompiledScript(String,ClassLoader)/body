{
  String key=String.valueOf(script.hashCode());
  Script compiledScript=_portalCache.get(key);
  if (compiledScript != null) {
    return compiledScript;
  }
  try {
    Context context=Context.enter();
    if (ArrayUtil.isNotEmpty(classLoaders)) {
      ClassLoader aggregateClassLoader=AggregateClassLoader.getAggregateClassLoader(getScriptingExecutorClassLoader(),classLoaders);
      context.setApplicationClassLoader(aggregateClassLoader);
    }
    compiledScript=context.compileString(script,"script",0,null);
  }
 catch (  Exception e) {
    throw new ScriptingException(e.getMessage() + "\n\n",e);
  }
 finally {
    Context.exit();
  }
  _portalCache.put(key,compiledScript);
  return compiledScript;
}
