{
  Repository repository=RepositoryLocalServiceUtil.getRepository(groupId,portletId);
  if (repository != null) {
    return repository.getRepositoryId();
  }
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  User defaultUser=UserLocalServiceUtil.getDefaultUser(group.getCompanyId());
  long classNameId=PortalUtil.getClassNameId(LiferayRepository.class.getName());
  UnicodeProperties typeSettingsProperties=new UnicodeProperties(true);
  return RepositoryLocalServiceUtil.addRepository(defaultUser.getUserId(),groupId,classNameId,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID,portletId,StringPool.BLANK,portletId,typeSettingsProperties,true,serviceContext);
}
