{
  int bytesRead=super.read(b,off,len);
  if (bytesRead > 0) {
    _totalRead+=bytesRead;
  }
 else {
    return bytesRead;
  }
  int percent=(int)((_totalRead * 100L) / _totalSize);
  if (_log.isDebugEnabled()) {
    _log.debug(bytesRead + "/" + _totalRead+ "="+ percent);
  }
  if ((_totalSize > 0) && (_totalSize < THRESHOLD_SIZE)) {
    _cachedBytes.write(b,off,bytesRead);
  }
  Integer curPercent=(Integer)_session.getAttribute(LiferayFileUpload.PERCENT);
  if ((curPercent == null) || (percent - curPercent.intValue() >= 1)) {
    _session.setAttribute(LiferayFileUpload.PERCENT,new Integer(percent));
  }
  return bytesRead;
}
