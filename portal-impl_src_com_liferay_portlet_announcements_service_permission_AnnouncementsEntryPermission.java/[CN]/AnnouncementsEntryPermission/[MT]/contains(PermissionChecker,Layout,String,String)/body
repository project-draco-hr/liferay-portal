{
  if (layout instanceof VirtualLayout) {
    VirtualLayout virtualLayout=(VirtualLayout)layout;
    layout=virtualLayout.getSourceLayout();
  }
  String primKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),portletId);
  return permissionChecker.hasPermission(layout.getGroupId(),portletId,primKey,actionId);
}
