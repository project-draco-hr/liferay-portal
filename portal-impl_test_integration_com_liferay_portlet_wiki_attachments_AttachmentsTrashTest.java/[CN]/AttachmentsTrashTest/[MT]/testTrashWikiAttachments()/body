{
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setScopeGroupId(TestPropsValues.getGroupId());
  WikiNode wikiNode=WikiNodeLocalServiceUtil.addNode(TestPropsValues.getUserId(),ServiceTestUtil.randomString(),"",serviceContext);
  WikiPage wikiPage=WikiPageLocalServiceUtil.addPage(TestPropsValues.getUserId(),wikiNode.getNodeId(),ServiceTestUtil.randomString(),null,WikiPageConstants.NEW,true,serviceContext);
  int initialNotInTrashCount=wikiPage.getAttachmentsFiles().length;
  int initialTrashEntriesCount=wikiPage.getDeletedAttachmentsFiles().length;
  Class<?> clazz=getClass();
  byte[] fileBytes=FileUtil.getBytes(clazz.getResourceAsStream(_OFFICE_TEST_DOCX));
  File file=null;
  if ((fileBytes != null) && (fileBytes.length > 0)) {
    file=FileUtil.createTempFile(fileBytes);
  }
  WikiPageLocalServiceUtil.addPageAttachment(TestPropsValues.getUserId(),wikiNode.getNodeId(),wikiPage.getTitle(),"Test File.txt",file);
  Assert.assertEquals(initialTrashEntriesCount,wikiPage.getDeletedAttachmentsFiles().length);
  Assert.assertEquals(initialNotInTrashCount + 1,wikiPage.getAttachmentsFiles().length);
  String fileName=wikiPage.getAttachmentsFiles()[0];
  WikiPageLocalServiceUtil.movePageAttachmentToTrash(wikiNode.getNodeId(),wikiPage.getTitle(),fileName);
  Assert.assertEquals(initialTrashEntriesCount + 1,wikiPage.getDeletedAttachmentsFiles().length);
  Assert.assertEquals(initialNotInTrashCount,wikiPage.getAttachmentsFiles().length);
  fileName=wikiPage.getDeletedAttachmentsFiles()[0];
  WikiPageLocalServiceUtil.movePageAttachmentFromTrash(wikiNode.getNodeId(),wikiPage.getTitle(),fileName);
  Assert.assertEquals(initialTrashEntriesCount,wikiPage.getDeletedAttachmentsFiles().length);
  Assert.assertEquals(initialNotInTrashCount + 1,wikiPage.getAttachmentsFiles().length);
}
