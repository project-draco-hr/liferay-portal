{
  User user=userPersistence.findByPrimaryKey(userId);
  long userNotificationDeliveryId=counterLocalService.increment();
  UserNotificationDelivery userNotificationDelivery=userNotificationDeliveryPersistence.create(userNotificationDeliveryId);
  userNotificationDelivery.setCompanyId(user.getCompanyId());
  userNotificationDelivery.setUserId(user.getUserId());
  userNotificationDelivery.setPortletId(portletId);
  userNotificationDelivery.setClassNameId(classNameId);
  userNotificationDelivery.setNotificationType(notificationType);
  userNotificationDelivery.setDeliveryType(deliveryType);
  userNotificationDelivery.setDeliver(deliver);
  return userNotificationDeliveryPersistence.update(userNotificationDelivery);
}
