{
  long repositoryId;
  long parentFolderId=atomRequestContext.getLongParameter("parentFolderId");
  if (parentFolderId != 0) {
    Folder parentFolder=DLAppServiceUtil.getFolder(parentFolderId);
    repositoryId=parentFolder.getRepositoryId();
  }
 else {
    repositoryId=atomRequestContext.getLongParameter("repositoryId");
  }
  int count=DLAppServiceUtil.getFoldersCount(repositoryId,parentFolderId);
  AtomPager atomPager=new AtomPager(atomRequestContext,count);
  AtomUtil.saveAtomPagerInRequest(atomRequestContext,atomPager);
  return DLAppServiceUtil.getFolders(repositoryId,parentFolderId,atomPager.getStart(),atomPager.getEnd() + 1,new RepositoryModelTitleComparator<Folder>());
}
