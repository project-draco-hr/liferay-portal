{
  boolean active=false;
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  if (_active != null) {
    active=_active.booleanValue();
  }
 else {
    active=Validator.equals(themeDisplay.getPpid(),_panelApp.getPortletId());
  }
  request.setAttribute("liferay-application-list:panel-app:active",active);
  if (_data == null) {
    _data=new HashMap<>();
  }
  if (Validator.isNull(_label) && (_panelApp != null)) {
    Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),_panelApp.getPortletId());
    _label=PortalUtil.getPortletTitle(portlet,servletContext,themeDisplay.getLocale());
    if (!_data.containsKey("qa-id")) {
      _data.put("qa-id","app");
    }
  }
  if (!_data.containsKey("title")) {
    _data.put("title",_label);
  }
  request.setAttribute("liferay-application-list:panel-app:data",_data);
  if (Validator.isNull(_id)) {
    _id="portlet_" + _panelApp.getPortletId();
  }
  request.setAttribute("liferay-application-list:panel-app:id",_id);
  request.setAttribute("liferay-application-list:panel-app:label",_label);
  int notificationsCount=0;
  if (_panelApp != null) {
    notificationsCount=_panelApp.getNotificationsCount(themeDisplay.getUser());
  }
  request.setAttribute("liferay-application-list:panel-app:notificationsCount",notificationsCount);
  request.setAttribute("liferay-application-list:panel-app:panelApp",_panelApp);
  if (Validator.isNull(_url) && (_panelApp != null)) {
    PortletURL portletURL=null;
    try {
      portletURL=_panelApp.getPortletURL(request);
    }
 catch (    PortalException pe) {
      _log.error(pe);
    }
    _url=portletURL.toString();
  }
  request.setAttribute("liferay-application-list:panel-app:url",_url);
}
