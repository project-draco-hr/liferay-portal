{
  long activitySetId=0;
  List<SocialActivityInterpreter> activityInterpreters=_activityInterpreters.get(PropsValues.SOCIAL_ACTIVITY_SETS_SELECTOR);
  if (activityInterpreters != null) {
    SocialActivity activity=socialActivityPersistence.findByPrimaryKey(activityId);
    String className=PortalUtil.getClassName(activity.getClassNameId());
    for (int i=0; i < activityInterpreters.size(); i++) {
      SocialActivityInterpreterImpl activityInterpreter=(SocialActivityInterpreterImpl)activityInterpreters.get(i);
      if (activityInterpreter.hasClassName(className)) {
        activitySetId=activityInterpreter.getActivitySetId(activityId);
        break;
      }
    }
  }
  if (activitySetId == 0) {
    SocialActivitySet activitySet=socialActivitySetLocalService.addActivitySet(activityId);
    activitySetId=activitySet.getActivitySetId();
  }
  return activitySetId;
}
