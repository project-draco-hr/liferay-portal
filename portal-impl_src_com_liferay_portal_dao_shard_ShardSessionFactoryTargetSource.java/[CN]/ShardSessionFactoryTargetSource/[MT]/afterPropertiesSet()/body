{
  Map<String,DataSource> dataSources=_shardDataSourceTargetSource.getDataSources();
  for (  String shardName : dataSources.keySet()) {
    DataSource dataSource=dataSources.get(shardName);
    PortalHibernateConfiguration portalHibernateConfiguration=new PortalHibernateConfiguration();
    portalHibernateConfiguration.setBeanFactory(_beanFactory);
    portalHibernateConfiguration.setDataSource(dataSource);
    SessionFactory sessionFactory=portalHibernateConfiguration.buildSessionFactory();
    _sessionFactories.put(shardName,sessionFactory);
  }
}
