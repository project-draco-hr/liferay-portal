{
  if (PropsValues.INDEX_DUMP_COMPRESSION_ENABLED) {
    inputStream=new GZIPInputStream(inputStream);
  }
  ObjectInputStream objectInputStream=null;
  try {
    objectInputStream=new ObjectInputStream(inputStream);
    IndexCommitMetaInfo indexCommitMetaInfo=null;
    try {
      indexCommitMetaInfo=(IndexCommitMetaInfo)objectInputStream.readObject();
    }
 catch (    ClassNotFoundException cnfe) {
      throw new IOException(cnfe);
    }
    if (_log.isDebugEnabled()) {
      _log.debug("Deserializing " + indexCommitMetaInfo);
    }
    if (indexCommitMetaInfo.isEmpty()) {
      return;
    }
    List<Segment> segments=indexCommitMetaInfo.getSegments();
    for (    Segment segment : segments) {
      if (_log.isDebugEnabled()) {
        _log.debug("Deserializing segment " + segment);
      }
      _deserializeSegment(objectInputStream,segment.getFileSize(),directory.createOutput(segment.getFileName()));
    }
    _writeSegmentsGen(directory,indexCommitMetaInfo.getGeneration());
  }
  finally {
    if (objectInputStream != null) {
      objectInputStream.close();
    }
  }
}
