{
  if (_initialized) {
    return;
  }
  _initialized=true;
  if ((groupId == 0) && (serviceContext != null)) {
    setScopeGroupId(serviceContext.getScopeGroupId());
  }
  Company company=CompanyLocalServiceUtil.getCompany(companyId);
  setContextAttribute("[$COMPANY_ID$]",company.getCompanyId());
  setContextAttribute("[$COMPANY_MX$]",company.getMx());
  setContextAttribute("[$COMPANY_NAME$]",company.getName());
  setContextAttribute("[$PORTAL_URL$]",company.getPortalURL(groupId));
  if (groupId > 0) {
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    setContextAttribute("[$SITE_NAME$]",group.getDescriptiveName());
  }
  if ((creatorUserId > 0) && Validator.isNotNull(_contextCreatorUserPrefix)) {
    setContextAttribute("[$" + _contextCreatorUserPrefix + "_USER_ADDRESS$]",PortalUtil.getUserEmailAddress(creatorUserId));
    setContextAttribute("[$" + _contextCreatorUserPrefix + "_USER_NAME$]",PortalUtil.getUserName(creatorUserId,StringPool.BLANK));
  }
  if (uniqueMailId) {
    _mailIdIds=ArrayUtil.append(_mailIdIds,PortalUUIDUtil.generate());
  }
  mailId=PortalUtil.getMailId(company.getMx(),_mailIdPopPortletPrefix,_mailIdIds);
}
