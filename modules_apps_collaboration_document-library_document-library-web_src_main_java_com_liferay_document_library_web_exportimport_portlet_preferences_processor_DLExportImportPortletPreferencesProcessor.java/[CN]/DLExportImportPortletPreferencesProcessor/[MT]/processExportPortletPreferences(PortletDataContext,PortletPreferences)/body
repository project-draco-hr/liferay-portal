{
  String portletId=portletDataContext.getPortletId();
  long rootFolderId=GetterUtil.getLong(portletPreferences.getValue("rootFolderId",null));
  if (rootFolderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    Folder folder=null;
    try {
      folder=_dlAppLocalService.getFolder(rootFolderId);
    }
 catch (    PortalException pe) {
      StringBundler sb=new StringBundler(4);
      sb.append("Portlet ");
      sb.append(portletId);
      sb.append(" refers to an invalid root folder ID ");
      sb.append(rootFolderId);
      _log.error(sb.toString());
      throw new PortletDataException(sb.toString(),pe);
    }
    StagedModelDataHandlerUtil.exportReferenceStagedModel(portletDataContext,portletId,folder);
  }
  return portletPreferences;
}
