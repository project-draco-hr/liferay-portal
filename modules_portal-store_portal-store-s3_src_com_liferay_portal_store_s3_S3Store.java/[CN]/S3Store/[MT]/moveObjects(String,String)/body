{
  ObjectListing targetPrefix=_amazonS3.listObjects(_bucketName,newPrefix);
  if (targetPrefix.getObjectSummaries().size() > 0) {
    throw new DuplicateFileException("Duplicate S3 object found when moving files from " + oldPrefix + " to "+ newPrefix);
  }
  List<S3ObjectSummary> oldObjectSummaries=listObjectsWithPrefix(oldPrefix);
  for (  S3ObjectSummary objectSummary : oldObjectSummaries) {
    String oldKey=objectSummary.getKey();
    String newKey=_s3KeyTransformer.moveKey(oldKey,oldPrefix,newPrefix);
    CopyObjectRequest copyObjectRequest=new CopyObjectRequest(_bucketName,oldKey,_bucketName,newKey);
    _amazonS3.copyObject(copyObjectRequest);
  }
  for (  S3ObjectSummary objectSummary : oldObjectSummaries) {
    String oldKey=objectSummary.getKey();
    DeleteObjectRequest deleteOldObjectRequest=new DeleteObjectRequest(_bucketName,oldKey);
    _amazonS3.deleteObject(deleteOldObjectRequest);
  }
}
