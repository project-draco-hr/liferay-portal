{
  try {
    if (Validator.isNull(versionLabel)) {
      versionLabel=getHeadVersionLabel(companyId,repositoryId,fileName);
    }
    S3Object s3Object=_s3Service.getObject(_s3Bucket.getName(),getKey(companyId,repositoryId,fileName,versionLabel));
    File tempFile=getTempFile(s3Object,fileName);
    cleanUpTempFiles();
    return tempFile;
  }
 catch (  Exception e) {
    if (isS3NoSuchKeyException(e)) {
      throw new NoSuchFileException(companyId,repositoryId,fileName,versionLabel,e);
    }
    throw new SystemException(e);
  }
}
