{
  String prefix=_s3KeyTransformer.getFileKey(companyId,repositoryId,fileName);
  List<S3ObjectSummary> versions=listObjectsWithPrefix(prefix);
  String[] keys=new String[versions.size()];
  Iterator<S3ObjectSummary> versionsIterator=versions.iterator();
  for (int i=0; i < keys.length; i++) {
    S3ObjectSummary s3ObjectSummary=versionsIterator.next();
    keys[i]=s3ObjectSummary.getKey();
  }
  if (keys.length > 0) {
    Arrays.sort(keys);
    String headKey=keys[keys.length - 1];
    int x=headKey.lastIndexOf(CharPool.SLASH);
    return headKey.substring(x + 1);
  }
 else {
    throw new NoSuchFileException(companyId,repositoryId,fileName);
  }
}
