{
  try {
    PortalPreferences preferences=PortletPreferencesFactoryUtil.getPortalPreferences(request);
    Callable<String> modifyOperation=new SessionTreeJSClicksOperation(request,treeId,new String[]{nodeId}){
      @Override public String call() throws Exception {
        PortalPreferences preferences=PortletPreferencesFactoryUtil.getPortalPreferences(_request);
        String openNodesString=preferences.getValue(SessionTreeJSClicks.class.getName(),_treeId);
        openNodesString=StringUtil.add(openNodesString,_nodeIds[0]);
        return openNodesString;
      }
    }
;
    preferences.getAndUpdateValue(SessionTreeJSClicks.class.getName(),treeId,modifyOperation);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
