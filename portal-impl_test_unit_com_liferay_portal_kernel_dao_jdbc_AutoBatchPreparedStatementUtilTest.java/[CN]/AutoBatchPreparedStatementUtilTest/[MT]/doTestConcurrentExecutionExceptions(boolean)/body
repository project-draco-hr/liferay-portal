{
  PreparedStatementInvocationHandler preparedStatementInvocationHandler=new PreparedStatementInvocationHandler(supportBatchUpdates);
  Set<Throwable> throwables=Collections.newSetFromMap(new IdentityHashMap<Throwable,Boolean>());
  try (PreparedStatement preparedStatement=AutoBatchPreparedStatementUtil.concurrentAutoBatch((Connection)ProxyUtil.newProxyInstance(ClassLoader.getSystemClassLoader(),new Class<?>[]{Connection.class},new ConnectionInvocationHandler(preparedStatementInvocationHandler)),StringPool.BLANK)){
    RuntimeException runtimeException1=new RuntimeException();
    throwables.add(runtimeException1);
    preparedStatementInvocationHandler.setRuntimeException(runtimeException1);
    preparedStatement.addBatch();
    preparedStatement.executeBatch();
    RuntimeException runtimeException2=new RuntimeException();
    throwables.add(runtimeException2);
    preparedStatementInvocationHandler.setRuntimeException(runtimeException2);
    preparedStatement.addBatch();
    preparedStatement.executeBatch();
  }
 catch (  Throwable t) {
    Assert.assertTrue(throwables.contains(t));
    Throwable[] suppressedThrowables=t.getSuppressed();
    Assert.assertEquals(1,suppressedThrowables.length);
    Assert.assertTrue(throwables.contains(suppressedThrowables[0]));
    return;
  }
  Assert.fail();
}
