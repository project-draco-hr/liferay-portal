{
  ExportImportConfiguration exportImportConfiguration=getExportImportConfiguration(backgroundTask);
  Map<String,Serializable> settingsMap=exportImportConfiguration.getSettingsMap();
  long userId=MapUtil.getLong(settingsMap,"userId");
  StringBundler sb=new StringBundler(4);
  sb.append(StringUtil.replace(exportImportConfiguration.getName(),StringPool.SPACE,StringPool.UNDERLINE));
  sb.append(StringPool.DASH);
  sb.append(Time.getShortTimestamp());
  sb.append(".lar");
  File larFile=LayoutLocalServiceUtil.exportLayoutsAsFile(exportImportConfiguration);
  BackgroundTaskLocalServiceUtil.addBackgroundTaskAttachment(userId,backgroundTask.getBackgroundTaskId(),sb.toString(),larFile);
  return BackgroundTaskResult.SUCCESS;
}
