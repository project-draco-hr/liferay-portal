{
  long companyId=portlet.getCompanyId();
  String portletId=portlet.getPortletId();
  String namespace=PortalUtil.getPortletNamespace(portletId);
  String strutsAction=ParamUtil.getString(request,namespace + "struts_action");
  String rootPortletId=PortletConstants.getRootPortletId(portletId);
  if (Validator.isNotNull(strutsAction)) {
    Set<String> whitelistActions=getPortletCSRFWhitelistActions();
    if (whitelistActions.contains(strutsAction) && isValidStrutsAction(companyId,rootPortletId,strutsAction)) {
      return true;
    }
  }
  return false;
}
