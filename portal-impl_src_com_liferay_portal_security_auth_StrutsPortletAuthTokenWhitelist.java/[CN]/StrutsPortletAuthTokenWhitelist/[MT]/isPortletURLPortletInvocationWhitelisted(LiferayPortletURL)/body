{
  String strutsAction=liferayPortletURL.getParameter("struts_action");
  if (Validator.isBlank(strutsAction)) {
    return false;
  }
  Set<String> whitelistActions=getPortletInvocationWhitelistActions();
  if (whitelistActions.contains(strutsAction)) {
    long companyId=0;
    long plid=liferayPortletURL.getPlid();
    try {
      Layout layout=LayoutLocalServiceUtil.getLayout(plid);
      companyId=layout.getCompanyId();
    }
 catch (    PortalException e) {
      if (_log.isDebugEnabled()) {
        _log.debug("Unable to load layout " + plid,e);
      }
      return false;
    }
    String portletId=liferayPortletURL.getPortletId();
    if (isValidStrutsAction(companyId,portletId,strutsAction)) {
      return true;
    }
  }
  return false;
}
