{
  long companyId=portlet.getCompanyId();
  String portletId=portlet.getPortletId();
  String namespace=PortalUtil.getPortletNamespace(portletId);
  String strutsAction=ParamUtil.getString(request,namespace + "struts_action");
  if (Validator.isNull(strutsAction)) {
    strutsAction=ParamUtil.getString(request,"struts_action");
  }
  if (Validator.isNotNull(strutsAction)) {
    Set<String> whitelistActions=getPortletInvocationWhitelistActions();
    if (whitelistActions.contains(strutsAction) && isValidStrutsAction(companyId,portletId,strutsAction)) {
      return true;
    }
  }
  return false;
}
