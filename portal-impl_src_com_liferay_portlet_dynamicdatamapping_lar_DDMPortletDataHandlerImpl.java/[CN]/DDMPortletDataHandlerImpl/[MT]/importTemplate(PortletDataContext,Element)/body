{
  String path=templateElement.attributeValue("path");
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  DDMTemplate template=(DDMTemplate)portletDataContext.getZipEntryAsObject(path);
  long userId=portletDataContext.getUserId(template.getUserUuid());
  ServiceContext serviceContext=portletDataContext.createServiceContext(templateElement,template,_NAMESPACE);
  DDMTemplate importedTemplate=null;
  if (portletDataContext.isDataStrategyMirror()) {
    DDMTemplate existingTemplate=DDMTemplateUtil.fetchByUUID_G(template.getUuid(),portletDataContext.getScopeGroupId());
    if (existingTemplate == null) {
      serviceContext.setUuid(template.getUuid());
      importedTemplate=DDMTemplateLocalServiceUtil.addTemplate(userId,portletDataContext.getScopeGroupId(),template.getClassNameId(),template.getClassPK(),template.getNameMap(),template.getDescriptionMap(),template.getType(),template.getMode(),template.getLanguage(),template.getScript(),serviceContext);
    }
 else {
      importedTemplate=DDMTemplateLocalServiceUtil.updateTemplate(existingTemplate.getTemplateId(),template.getNameMap(),template.getDescriptionMap(),template.getType(),template.getMode(),template.getLanguage(),template.getScript(),serviceContext);
    }
  }
 else {
    importedTemplate=DDMTemplateLocalServiceUtil.addTemplate(userId,portletDataContext.getScopeGroupId(),template.getClassNameId(),template.getClassPK(),template.getNameMap(),template.getDescriptionMap(),template.getType(),template.getMode(),template.getLanguage(),template.getScript(),serviceContext);
  }
  portletDataContext.importClassedModel(template,importedTemplate,_NAMESPACE);
}
