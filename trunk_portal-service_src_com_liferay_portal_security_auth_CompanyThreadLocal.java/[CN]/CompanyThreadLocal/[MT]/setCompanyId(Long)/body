{
  if (_log.isDebugEnabled()) {
    _log.debug("setCompanyId " + companyId);
  }
  if (companyId > 0) {
    try {
      Company company=CompanyLocalServiceUtil.getCompany(companyId);
      LocaleThreadLocal.setLocale(company.getLocale());
      TimeZoneThreadLocal.setTimeZone(company.getTimeZone());
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
    _companyId.set(companyId);
  }
 else {
    LocaleThreadLocal.setLocale(null);
    TimeZoneThreadLocal.setTimeZone(null);
    _companyId.set(CompanyConstants.SYSTEM);
  }
}
