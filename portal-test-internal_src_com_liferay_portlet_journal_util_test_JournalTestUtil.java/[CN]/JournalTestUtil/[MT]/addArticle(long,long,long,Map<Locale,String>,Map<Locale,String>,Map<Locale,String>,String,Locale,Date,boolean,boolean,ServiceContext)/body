{
  String content=DDMStructureTestUtil.getSampleStructuredContent(contentMap,LocaleUtil.toLanguageId(defaultLocale));
  String definition=DDMStructureTestUtil.getSampleStructureDefinition(_locales,defaultLocale);
  DDMStructure ddmStructure=DDMStructureTestUtil.addStructure(groupId,JournalArticle.class.getName(),definition,defaultLocale);
  DDMTemplate ddmTemplate=DDMTemplateTestUtil.addTemplate(groupId,ddmStructure.getStructureId());
  boolean neverExpire=true;
  int expirationDateDay=0;
  int expirationDateMonth=0;
  int expirationDateYear=0;
  int expirationDateHour=0;
  int expirationDateMinute=0;
  if (expirationDate != null) {
    neverExpire=false;
    Calendar expirationCal=CalendarFactoryUtil.getCalendar(TestPropsValues.getUser().getTimeZone());
    expirationCal.setTime(expirationDate);
    expirationDateMonth=expirationCal.get(Calendar.MONTH);
    expirationDateDay=expirationCal.get(Calendar.DATE);
    expirationDateYear=expirationCal.get(Calendar.YEAR);
    expirationDateHour=expirationCal.get(Calendar.HOUR_OF_DAY);
    expirationDateMinute=expirationCal.get(Calendar.MINUTE);
  }
  Calendar displayCal=CalendarFactoryUtil.getCalendar(TestPropsValues.getUser().getTimeZone());
  int displayDateDay=displayCal.get(Calendar.DATE);
  int displayDateMonth=displayCal.get(Calendar.MONTH);
  int displayDateYear=displayCal.get(Calendar.YEAR);
  int displayDateHour=displayCal.get(Calendar.HOUR_OF_DAY);
  int displayDateMinute=displayCal.get(Calendar.MINUTE);
  if (workflowEnabled) {
    serviceContext=(ServiceContext)serviceContext.clone();
    if (approved) {
      serviceContext.setWorkflowAction(WorkflowConstants.ACTION_PUBLISH);
    }
 else {
      serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
    }
  }
  return JournalArticleLocalServiceUtil.addArticle(serviceContext.getUserId(),groupId,folderId,classNameId,0,StringPool.BLANK,true,JournalArticleConstants.VERSION_DEFAULT,titleMap,descriptionMap,content,ddmStructure.getStructureKey(),ddmTemplate.getTemplateKey(),layoutUuid,displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,expirationDateMonth,expirationDateDay,expirationDateYear,expirationDateHour,expirationDateMinute,neverExpire,0,0,0,0,0,true,true,false,null,null,null,null,serviceContext);
}
