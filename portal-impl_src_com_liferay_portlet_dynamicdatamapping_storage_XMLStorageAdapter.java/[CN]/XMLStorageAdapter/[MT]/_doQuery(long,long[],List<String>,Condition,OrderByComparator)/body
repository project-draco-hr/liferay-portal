{
  XPath xPathCondition=null;
  List<Fields> results=new ArrayList<Fields>();
  if (condition != null) {
    xPathCondition=parseCondition(condition);
  }
  DDMContent content=null;
  Document document=null;
  for (  long classPK : classPKs) {
    content=DDMContentLocalServiceUtil.getContent(classPK);
    document=SAXReaderUtil.read(content.getXml());
    if ((xPathCondition == null) || ((xPathCondition != null) && xPathCondition.booleanValueOf(document))) {
      Fields fields=new Fields();
      List<Element> dynamicElements=document.getRootElement().elements(_DYNAMIC_ELEMENT);
      for (      Element dynamicElement : dynamicElements) {
        String name=dynamicElement.attributeValue(_NAME);
        String value=dynamicElement.elementText(_DYNAMIC_CONTENT);
        if (((fieldNames == null) || (fieldNames != null) && fieldNames.contains(name))) {
          fields.put(new Field(name,value));
        }
      }
      results.add(fields);
    }
  }
  if (orderByComparator != null) {
    Collections.sort(results,orderByComparator);
  }
  return results;
}
