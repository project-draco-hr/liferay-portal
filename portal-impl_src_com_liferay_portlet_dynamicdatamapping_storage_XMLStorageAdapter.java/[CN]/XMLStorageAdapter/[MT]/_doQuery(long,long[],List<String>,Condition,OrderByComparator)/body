{
  List<Fields> fieldsList=new ArrayList<Fields>();
  XPath conditionXPath=null;
  if (condition != null) {
    conditionXPath=_parseCondition(condition);
  }
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getDDMStructure(ddmStructureId);
  for (  long classPK : classPKs) {
    DDMContent ddmContent=DDMContentLocalServiceUtil.getContent(classPK);
    Document document=SAXReaderUtil.read(ddmContent.getXml());
    if ((conditionXPath == null) || ((conditionXPath != null) && conditionXPath.booleanValueOf(document))) {
      Fields fields=new Fields();
      Element rootElement=document.getRootElement();
      List<Element> dynamicElementElements=rootElement.elements("dynamic-element");
      for (      Element dynamicElementElement : dynamicElementElements) {
        String fieldName=dynamicElementElement.attributeValue("name");
        String fieldDataType=ddmStructure.getFieldDataType(fieldName);
        String fieldValue=dynamicElementElement.elementText("dynamic-content");
        if ((fieldNames == null) || ((fieldNames != null) && fieldNames.contains(fieldName))) {
          Serializable value=FieldConstants.getSerializable(fieldDataType,fieldValue);
          fields.put(new Field(fieldName,value));
        }
      }
      fieldsList.add(fields);
    }
  }
  if (orderByComparator != null) {
    Collections.sort(fieldsList,orderByComparator);
  }
  return fieldsList;
}
