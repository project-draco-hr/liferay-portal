{
  Image image=getImage(request,true);
  if (image == null) {
    throw new NoSuchImageException("Image is null");
  }
 else {
    if (!image.getType().equals(ImageConstants.TYPE_NOT_AVAILABLE)) {
      String contentType=ContentTypeUtil.getContentType(image.getType());
      response.setContentType(contentType);
    }
    try {
      ServletResponseUtil.write(response,image.getTextObj());
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
}
