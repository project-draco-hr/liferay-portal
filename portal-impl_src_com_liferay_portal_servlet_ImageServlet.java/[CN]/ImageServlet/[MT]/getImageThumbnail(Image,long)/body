{
  if (image == null) {
    return null;
  }
  long igThumbnailMaxDimension=PrefsPropsUtil.getLong(PropsKeys.IG_IMAGE_THUMBNAIL_MAX_DIMENSION);
  if ((image.getHeight() > igThumbnailMaxDimension) || (image.getWidth() > igThumbnailMaxDimension)) {
    DLFileEntry dlFileEntry=DLFileEntryLocalServiceUtil.getFileEntry(fileEntryId);
    DLFileEntryLocalServiceUtil.updateSmallImage(dlFileEntry.getSmallImageId(),dlFileEntry.getLargeImageId());
    return ImageServiceUtil.getImage(image.getImageId());
  }
  return image;
}
