{
  Role role=RoleLocalServiceUtil.getRole(roleId);
  if (role.getType() == RoleConstants.TYPE_ORGANIZATION) {
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    return OrganizationMembershipPolicyUtil.isRoleProtected(permissionChecker,userId,group.getOrganizationId(),roleId);
  }
  if (permissionChecker.isGroupOwner(groupId)) {
    return false;
  }
  String roleName=role.getName();
  if (!roleName.equals(RoleConstants.SITE_ADMINISTRATOR) && !roleName.equals(RoleConstants.SITE_OWNER)) {
    return false;
  }
  if (UserGroupRoleLocalServiceUtil.hasUserGroupRole(userId,groupId,roleId)) {
    return true;
  }
  return false;
}
