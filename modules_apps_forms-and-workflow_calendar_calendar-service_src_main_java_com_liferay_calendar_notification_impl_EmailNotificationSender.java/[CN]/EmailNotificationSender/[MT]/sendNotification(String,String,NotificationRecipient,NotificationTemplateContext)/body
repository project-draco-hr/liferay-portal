{
  try {
    CalendarNotificationTemplate calendarNotificationTemplate=notificationTemplateContext.getCalendarNotificationTemplate();
    String fromAddressValue=NotificationUtil.getTemplatePropertyValue(calendarNotificationTemplate,CalendarNotificationTemplateConstants.PROPERTY_FROM_ADDRESS,fromAddress);
    String fromNameValue=NotificationUtil.getTemplatePropertyValue(calendarNotificationTemplate,CalendarNotificationTemplateConstants.PROPERTY_FROM_NAME,fromName);
    notificationTemplateContext.setFromAddress(fromAddressValue);
    notificationTemplateContext.setFromName(fromNameValue);
    notificationTemplateContext.setToAddress(notificationRecipient.getEmailAddress());
    notificationTemplateContext.setToName(notificationRecipient.getName());
    String subject=NotificationTemplateRenderer.render(notificationTemplateContext,NotificationField.SUBJECT);
    String body=NotificationTemplateRenderer.render(notificationTemplateContext,NotificationField.BODY);
    sendNotification(notificationTemplateContext.getFromAddress(),notificationTemplateContext.getFromName(),notificationRecipient,subject,body);
  }
 catch (  Exception e) {
    throw new NotificationSenderException(e);
  }
}
