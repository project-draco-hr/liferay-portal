{
  RemoteMailAttachment remoteMailAttachment=new RemoteMailAttachment();
  try {
    remoteMailAttachment.setFilename(part.getFileName());
    remoteMailAttachment.setContentPath(contentPath);
    String[] contentId=part.getHeader(HttpHeaders.CONTENT_ID);
    if ((contentId != null) && (contentId.length == 1)) {
      remoteMailAttachment.setContentId(contentId[0]);
    }
  }
 catch (  MessagingException me) {
    if (_log.isErrorEnabled()) {
      _log.error("Unable to properly get file name of MIME attachment");
    }
    throw new ContentException(me);
  }
  return remoteMailAttachment;
}
