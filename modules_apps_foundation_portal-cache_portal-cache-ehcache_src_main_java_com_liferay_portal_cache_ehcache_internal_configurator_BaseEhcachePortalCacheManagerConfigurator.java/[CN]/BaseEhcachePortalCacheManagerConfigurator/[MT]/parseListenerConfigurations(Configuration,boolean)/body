{
  Set<Properties> cacheManagerListenerPropertiesSet=parseCacheManagerEventListenerConfigurations(configuration.getCacheManagerEventListenerFactoryConfiguration());
  CacheConfiguration defaultCacheConfiguration=configuration.getDefaultCacheConfiguration();
  if (defaultCacheConfiguration == null) {
    defaultCacheConfiguration=new CacheConfiguration();
  }
  defaultCacheConfiguration.setName(PortalCacheConfiguration.DEFAULT_PORTAL_CACHE_NAME);
  PortalCacheConfiguration defaultPortalCacheConfiguration=parseCacheListenerConfigurations(defaultCacheConfiguration,usingDefault);
  Set<PortalCacheConfiguration> portalCacheConfigurations=new HashSet<>();
  Map<String,CacheConfiguration> cacheConfigurations=configuration.getCacheConfigurations();
  for (  Map.Entry<String,CacheConfiguration> entry : cacheConfigurations.entrySet()) {
    portalCacheConfigurations.add(parseCacheListenerConfigurations(entry.getValue(),usingDefault));
  }
  return new PortalCacheManagerConfiguration(cacheManagerListenerPropertiesSet,defaultPortalCacheConfiguration,portalCacheConfigurations);
}
