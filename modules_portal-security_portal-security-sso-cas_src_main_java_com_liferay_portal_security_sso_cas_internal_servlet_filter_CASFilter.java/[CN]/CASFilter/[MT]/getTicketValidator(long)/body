{
  TicketValidator ticketValidator=_ticketValidators.get(companyId);
  if (ticketValidator != null) {
    return ticketValidator;
  }
  CASConfiguration casConfiguration=_configurationProvider.getConfiguration(CASConfiguration.class,new CompanyServiceSettingsLocator(companyId,CASConstants.SERVICE_NAME));
  String serverName=casConfiguration.serverName();
  String serverUrl=casConfiguration.serverURL();
  String loginUrl=casConfiguration.loginURL();
  Cas20ProxyTicketValidator cas20ProxyTicketValidator=new Cas20ProxyTicketValidator(serverUrl);
  Map<String,String> parameters=new HashMap<>();
  parameters.put("serverName",serverName);
  parameters.put("casServerUrlPrefix",serverUrl);
  parameters.put("casServerLoginUrl",loginUrl);
  parameters.put("redirectAfterValidation","false");
  cas20ProxyTicketValidator.setCustomParameters(parameters);
  _ticketValidators.put(companyId,cas20ProxyTicketValidator);
  return cas20ProxyTicketValidator;
}
