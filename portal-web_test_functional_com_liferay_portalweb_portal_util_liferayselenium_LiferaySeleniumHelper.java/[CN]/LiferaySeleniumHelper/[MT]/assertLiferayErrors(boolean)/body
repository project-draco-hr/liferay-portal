{
  String currentDate=DateUtil.getCurrentDate("yyyy-MM-dd",LocaleUtil.getDefault());
  String fileName=PropsValues.LIFERAY_HOME + "/logs/liferay." + currentDate+ ".xml";
  if (!FileUtil.exists(fileName)) {
    return null;
  }
  String content=FileUtil.read(fileName);
  if (content.equals("")) {
    return null;
  }
  content="<log4j>" + content + "</log4j>";
  content=content.replaceAll("log4j:","");
  Document document=SAXReaderUtil.read(content,true);
  Element rootElement=document.getRootElement();
  List<Element> eventElements=rootElement.elements("event");
  for (  Element eventElement : eventElements) {
    Element messageElement=eventElement.element("message");
    Element throwableElement=eventElement.element("throwable");
    String level=eventElement.attributeValue("level");
    String messageText=messageElement.getText();
    if (level.equals("ERROR")) {
      File file=new File(fileName);
      String fileString=FileUtil.read(file);
      FileUtil.write(file,fileString.replaceFirst("level=\"ERROR\"","level=\"ERROR_FOUND\""));
      if (isIgnorableErrorLine(messageText)) {
        continue;
      }
      if (throwableElement != null) {
        messageText=messageText + throwableElement.getText();
      }
      return messageText;
    }
 else     if (level.equals("ERROR_FOUND") && throwsException) {
      if (throwableElement != null) {
        throw new Exception(messageText + throwableElement.getText());
      }
      throw new Exception(messageText);
    }
  }
  return null;
}
