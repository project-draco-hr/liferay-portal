{
  try {
    ctxt.makeOutputDir(ctxt.getOutputDir());
    if (errDispatcher == null) {
      errDispatcher=new ErrorDispatcher(jspcMode);
    }
    generateJava();
    if (compileClass) {
      generateClass();
    }
 else {
      javaCompiler.doJavaFile(ctxt.keepGenerated());
    }
  }
  finally {
    if (tfp != null) {
      tfp.removeProtoTypeFiles(null);
    }
    tfp=null;
    errDispatcher=null;
    if (!jspcMode) {
      pageInfo=null;
    }
    pageNodes=null;
    if (ctxt.getWriter() != null) {
      ctxt.getWriter().close();
      ctxt.setWriter(null);
    }
  }
}
