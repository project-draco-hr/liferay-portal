{
  String spriteRootDirName=PropsValues.SPRITE_ROOT_DIR;
  File imageFile=imageFiles.get(0);
  File imageDir=imageFile.getParentFile();
  String imageDirName=imageDir.toString();
  if (Validator.isNull(spriteRootDirName)) {
    return imageDirName;
  }
  if (!spriteRootDirName.endsWith(StringPool.BACK_SLASH) && !spriteRootDirName.endsWith(StringPool.SLASH)) {
    spriteRootDirName+=StringPool.SLASH;
  }
  String portalProxyPath=PropsUtil.get(PropsKeys.PORTAL_PROXY_PATH);
  if (Validator.isNotNull(portalProxyPath)) {
    spriteRootDirName+=portalProxyPath + StringPool.SLASH;
  }
  String portalContextPath=PropsUtil.get(PropsKeys.PORTAL_CTX);
  if (Validator.isNotNull(portalContextPath) && !portalContextPath.equals(StringPool.SLASH)) {
    spriteRootDirName+=portalContextPath + StringPool.SLASH;
  }
  String portletContextPath=ContextPathUtil.getContextPath(servletContext);
  if (Validator.isNotNull(portletContextPath)) {
    spriteRootDirName+=portletContextPath + StringPool.SLASH;
  }
  String rootRealPath=ServletContextUtil.getRealPath(servletContext,StringPool.SLASH);
  spriteRootDirName=StringUtil.replace(spriteRootDirName + imageDirName.substring(rootRealPath.length()),CharPool.BACK_SLASH,CharPool.SLASH);
  if (spriteRootDirName.endsWith(StringPool.BACK_SLASH) || spriteRootDirName.endsWith(StringPool.SLASH)) {
    spriteRootDirName=spriteRootDirName.substring(0,spriteRootDirName.length() - 1);
  }
  return spriteRootDirName;
}
