{
  Thread currentThread=Thread.currentThread();
  ClassLoader contextClassLoader=currentThread.getContextClassLoader();
  try {
    ClassLoader operatingClassLoader=(ClassLoader)properties.get(MessageListener.MESSAGE_LISTENER_OPERATING_CLASS_LOADER);
    if (operatingClassLoader != null) {
      currentThread.setContextClassLoader(operatingClassLoader);
    }
    String destinationName=MapUtil.getString(properties,"destination.name");
    registerMessageListener(destinationName,messageListener);
  }
  finally {
    currentThread.setContextClassLoader(contextClassLoader);
  }
}
