{
  HttpTransport httpTransport=new NetHttpTransport();
  JacksonFactory jsonFactory=new JacksonFactory();
  String googleClientId=PrefsPropsUtil.getString(companyId,"google-client-id");
  String googleClientSecret=PrefsPropsUtil.getString(companyId,"google-client-secret");
  List<String> scopes=null;
  if (DeployManagerUtil.isDeployed(_GOOGLE_DRIVE_CONTEXT)) {
    scopes=_SCOPES_DRIVE;
  }
 else {
    scopes=_SCOPES_LOGIN;
  }
  GoogleAuthorizationCodeFlow.Builder builder=new GoogleAuthorizationCodeFlow.Builder(httpTransport,jsonFactory,googleClientId,googleClientSecret,scopes);
  String accessType="online";
  if (DeployManagerUtil.isDeployed(_GOOGLE_DRIVE_CONTEXT)) {
    accessType="offline";
  }
  builder.setAccessType(accessType);
  return builder.build();
}
