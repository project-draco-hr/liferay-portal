{
  _renderRequest=renderRequest;
  _renderResponse=renderResponse;
  _portletPreferences=portletPreferences;
  if (Validator.isNull(getKeywords())) {
    _hits=null;
    _searchContext=null;
    _searchContainer=null;
    return;
  }
  HttpServletRequest request=PortalUtil.getHttpServletRequest(_renderRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)_renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String emptyResultMessage=LanguageUtil.format(request,"no-results-were-found-that-matched-the-keywords-x","<strong>" + HtmlUtil.escape(getKeywords()) + "</strong>",false);
  SearchContainer<Document> searchContainer=new SearchContainer<>(_renderRequest,getPortletURL(),null,emptyResultMessage);
  SearchContext searchContext=SearchContextFactory.getInstance(request);
  searchContext.setAttribute("paginationType","more");
  searchContext.setEnd(searchContainer.getEnd());
  searchContext.setQueryConfig(getQueryConfig());
  searchContext.setStart(searchContainer.getStart());
  Facet assetEntriesFacet=new AssetEntriesFacet(searchContext);
  assetEntriesFacet.setStatic(true);
  searchContext.addFacet(assetEntriesFacet);
  Facet scopeFacet=new ScopeFacet(searchContext);
  scopeFacet.setStatic(true);
  searchContext.addFacet(scopeFacet);
  for (  SearchFacet searchFacet : getEnabledSearchFacets()) {
    searchFacet.init(themeDisplay.getCompanyId(),getSearchConfiguration(),searchContext);
    Facet facet=searchFacet.getFacet();
    if (facet == null) {
      continue;
    }
    searchContext.addFacet(facet);
  }
  Indexer<?> indexer=FacetedSearcher.getInstance();
  Hits hits=indexer.search(searchContext);
  searchContainer.setTotal(hits.getLength());
  searchContainer.setResults(hits.toList());
  searchContainer.setSearch(true);
  _hits=hits;
  _searchContext=searchContext;
  _searchContainer=searchContainer;
}
