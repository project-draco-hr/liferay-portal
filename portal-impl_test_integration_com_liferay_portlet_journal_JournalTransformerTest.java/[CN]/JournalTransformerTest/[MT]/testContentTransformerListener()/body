{
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("root");
  addDynamicElement(rootElement,"text","name");
  addDynamicElement(rootElement,"text","link");
  String xsd=document.asXML();
  DDMStructure ddmStructure=addDDMStructure(xsd);
  String xsl="$name.getData()";
  DDMTemplate ddmTemplate=addDDMTemplate(ddmStructure.getStructureId(),xsl,JournalTemplateConstants.LANG_TYPE_VM);
  document=createDocument("en_US","en_US");
  Element dynamicElement=addDynamicElement(document.getRootElement(),"text","name");
  addDynamicContent(dynamicElement,"en_US","Joe Bloggs");
  String xml=document.asXML();
  JournalArticle article=addArticle(xml,ddmStructure.getStructureKey(),ddmTemplate.getTemplateKey());
  Map<String,String> tokens=getTokens();
  String content=JournalUtil.transform(null,tokens,Constants.VIEW,"en_US",xml,xsl,JournalTemplateConstants.LANG_TYPE_VM);
  Assert.assertEquals("Joe Bloggs",content);
  Element element=(Element)document.selectSingleNode("//dynamic-content");
  element.setText("[@" + article.getArticleId() + ";name@]");
  content=JournalUtil.transform(null,tokens,Constants.VIEW,"en_US",document.asXML(),xsl,JournalTemplateConstants.LANG_TYPE_VM);
  Assert.assertEquals("Joe Bloggs",content);
}
