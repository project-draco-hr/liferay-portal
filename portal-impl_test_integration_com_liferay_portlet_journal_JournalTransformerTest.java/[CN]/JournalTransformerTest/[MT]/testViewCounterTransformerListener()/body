{
  Map<String,String> tokens=getTokens();
  tokens.put("article_resource_pk","1");
  String xml=JournalTestUtil.getSampleStructuredContent();
  String script="@view_counter@";
  String content=JournalUtil.transform(null,tokens,Constants.VIEW,"en_US",xml,script,TemplateConstants.LANG_TYPE_VM);
  StringBundler sb=new StringBundler(6);
  sb.append("<script type=\"text/javascript\">");
  sb.append("Liferay.Service.Asset.AssetEntry.incrementViewCounter");
  sb.append("({userId:0, className:'");
  sb.append("com.liferay.portlet.journal.model.JournalArticle', ");
  sb.append("classPK:1});");
  sb.append("</script>");
  Assert.assertEquals(sb.toString(),content);
}
