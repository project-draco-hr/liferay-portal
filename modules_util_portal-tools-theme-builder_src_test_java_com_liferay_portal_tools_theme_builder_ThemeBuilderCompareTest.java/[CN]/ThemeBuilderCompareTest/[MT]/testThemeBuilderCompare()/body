{
  File outputDir=temporaryFolder.newFolder("output");
  ThemeBuilder themeBuilder=new ThemeBuilder(_diffsDir,_name,outputDir,_parentDir,_parentName,_templateExtension,_unstyledJarFile);
  themeBuilder.build();
  File warDir=temporaryFolder.newFolder("war");
  _unzip(_warFile,warDir);
  String otherTemplateExtension="vm";
  if (_templateExtension.equals("vm")) {
    otherTemplateExtension="ftl";
  }
  String[] excludePatterns={"css/*.css","images/thumbnail.png","templates/*." + otherTemplateExtension,"WEB-INF/**"};
  Map<String,byte[]> outputFileNameDigests=_getFileNameDigests(outputDir.toPath(),excludePatterns);
  Map<String,byte[]> warFileNameDigests=_getFileNameDigests(warDir.toPath(),excludePatterns);
  Assert.assertEquals(outputFileNameDigests.size(),warFileNameDigests.size());
  for (  Map.Entry<String,byte[]> entry : outputFileNameDigests.entrySet()) {
    String fileName=entry.getKey();
    byte[] outputFileDigest=entry.getValue();
    byte[] warFileDigest=warFileNameDigests.get(fileName);
    Assert.assertArrayEquals("File " + fileName + " does not match",outputFileDigest,warFileDigest);
  }
}
