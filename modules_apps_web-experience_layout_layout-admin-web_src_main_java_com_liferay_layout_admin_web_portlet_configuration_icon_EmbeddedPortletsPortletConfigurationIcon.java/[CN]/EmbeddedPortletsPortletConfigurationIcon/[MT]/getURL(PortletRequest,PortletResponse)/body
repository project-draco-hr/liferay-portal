{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  try {
    PortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,portletDisplay.getId(),PortletRequest.RENDER_PHASE);
    portletURL.setParameter("mvcPath","/embedded_portlets.jsp");
    portletURL.setParameter("redirect",themeDisplay.getURLCurrent());
    portletURL.setParameter("selPlid",String.valueOf(getSelPlid(portletRequest)));
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    return portletURL.toString();
  }
 catch (  Exception e) {
  }
  return StringPool.BLANK;
}
