{
  DDLRecord record=(DDLRecord)obj;
  Document document=getBaseModelDocument(PORTLET_ID,record);
  DDLRecordVersion recordVersion=record.getRecordVersion();
  document.addKeyword(Field.CLASS_TYPE_ID,recordVersion.getRecordSetId());
  document.addKeyword(Field.STATUS,recordVersion.getStatus());
  document.addKeyword(Field.VERSION,recordVersion.getVersion());
  document.addText("ddmContent",extractDDMContent(recordVersion,LocaleUtil.getSiteDefault()));
  document.addKeyword("recordSetId",recordVersion.getRecordSetId());
  DDLRecordSet recordSet=recordVersion.getRecordSet();
  DDMStructure ddmStructure=recordSet.getDDMStructure();
  DDMFormValues ddmFormValues=StorageEngineUtil.getDDMFormValues(recordVersion.getDDMStorageId());
  DDMIndexerUtil.addAttributes(document,ddmStructure,ddmFormValues);
  return document;
}
