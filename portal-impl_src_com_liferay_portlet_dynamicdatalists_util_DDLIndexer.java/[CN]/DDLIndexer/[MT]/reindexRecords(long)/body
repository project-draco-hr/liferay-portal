{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(DDLRecord.class,PortalClassLoaderUtil.getClassLoader());
  Projection minRecordIdProjection=ProjectionFactoryUtil.min("recordId");
  Projection maxRecordIdProjection=ProjectionFactoryUtil.max("recordId");
  ProjectionList projectionList=ProjectionFactoryUtil.projectionList();
  projectionList.add(minRecordIdProjection);
  projectionList.add(maxRecordIdProjection);
  dynamicQuery.setProjection(projectionList);
  addReindexCriteria(dynamicQuery,companyId);
  List<Object[]> results=DDLRecordLocalServiceUtil.dynamicQuery(dynamicQuery);
  Object[] minAndMaxRecordIds=results.get(0);
  if ((minAndMaxRecordIds[0] == null) || (minAndMaxRecordIds[1] == null)) {
    return;
  }
  long minRecordId=(Long)minAndMaxRecordIds[0];
  long maxRecordId=(Long)minAndMaxRecordIds[1];
  long startRecordId=minRecordId;
  long endRecordId=startRecordId + DEFAULT_INTERVAL;
  while (startRecordId <= maxRecordId) {
    reindexRecords(companyId,startRecordId,endRecordId);
    startRecordId=endRecordId;
    endRecordId+=DEFAULT_INTERVAL;
  }
}
