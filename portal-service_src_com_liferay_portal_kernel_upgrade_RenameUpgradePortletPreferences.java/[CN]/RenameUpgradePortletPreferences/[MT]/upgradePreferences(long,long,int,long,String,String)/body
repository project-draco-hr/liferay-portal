{
  PortletPreferences preferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  Map<String,String[]> preferencesMap=preferences.getMap();
  Map<String,String> preferenceNamesMap=getPreferenceNamesMap();
  for (  String name : preferenceNamesMap.keySet()) {
    String[] values=preferencesMap.get(name);
    if (values == null) {
      continue;
    }
    preferences.reset(name);
    preferences.setValues(preferenceNamesMap.get(name),values);
  }
  return PortletPreferencesFactoryUtil.toXML(preferences);
}
