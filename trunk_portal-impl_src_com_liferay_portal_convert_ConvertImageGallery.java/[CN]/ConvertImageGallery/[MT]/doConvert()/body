{
  boolean cacheRegistryActive=CacheRegistryUtil.isActive();
  try {
    CacheRegistryUtil.setActive(false);
    _sourceHook=HookFactory.getInstance();
    String[] values=getParameterValues();
    String targetHookClassName=values[0];
    ClassLoader classLoader=PortalClassLoaderUtil.getClassLoader();
    _targetHook=(Hook)classLoader.loadClass(targetHookClassName).newInstance();
    migrateImages();
    HookFactory.setInstance(_targetHook);
    MaintenanceUtil.appendStatus("Please set " + PropsKeys.IMAGE_HOOK_IMPL + " in your portal-ext.properties to use "+ targetHookClassName);
    if (_sourceHook instanceof DatabaseHook) {
      DB db=DBFactoryUtil.getDB();
      db.runSQL("update Image set text_ = ''");
    }
    PropsValues.IMAGE_HOOK_IMPL=targetHookClassName;
  }
  finally {
    CacheRegistryUtil.setActive(cacheRegistryActive);
  }
}
