{
  PortletRequestImpl portletRequestImpl=(PortletRequestImpl)portletRequest;
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequestImpl.getAttribute(WebKeys.THEME_DISPLAY);
  PortletURL editPortletURL=null;
  if (IGPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.ADD_IMAGE)) {
    editPortletURL=new PortletURLImpl(portletRequestImpl,PortletKeys.IMAGE_GALLERY,themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    editPortletURL.setParameter("struts_action","/image_gallery/edit_image");
    editPortletURL.setParameter("folderId",String.valueOf(_image.getFolderId()));
    editPortletURL.setParameter("imageId",String.valueOf(_image.getImageId()));
  }
  return editPortletURL;
}
