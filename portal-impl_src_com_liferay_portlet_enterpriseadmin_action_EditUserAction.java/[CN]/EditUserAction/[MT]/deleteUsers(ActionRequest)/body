{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  long[] deleteUserIds=StringUtil.split(ParamUtil.getString(actionRequest,"deleteUserIds"),0L);
  for (int i=0; i < deleteUserIds.length; i++) {
    if (cmd.equals(Constants.DEACTIVATE) || cmd.equals(Constants.RESTORE)) {
      boolean active=!cmd.equals(Constants.DEACTIVATE);
      UserServiceUtil.updateActive(deleteUserIds[i],active);
    }
 else {
      User user=UserServiceUtil.getUserById(deleteUserIds[i]);
      Group group=user.getGroup();
      if (group != null && group.getGroupId() == PortalUtil.getScopeGroupId(actionRequest)) {
        actionRequest.setAttribute("deleteScopeGroup",true);
      }
      UserServiceUtil.deleteUser(deleteUserIds[i]);
    }
  }
}
