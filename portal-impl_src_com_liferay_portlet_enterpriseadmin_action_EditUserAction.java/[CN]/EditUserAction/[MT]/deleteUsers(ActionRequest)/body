{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  long[] deleteUserIds=StringUtil.split(ParamUtil.getString(actionRequest,"deleteUserIds"),0L);
  for (int i=0; i < deleteUserIds.length; i++) {
    if (cmd.equals(Constants.DEACTIVATE) || cmd.equals(Constants.RESTORE)) {
      boolean active=!cmd.equals(Constants.DEACTIVATE);
      UserServiceUtil.updateActive(deleteUserIds[i],active);
    }
 else {
      long scopeGroupId=PortalUtil.getScopeGroupId(actionRequest);
      Group group=UserServiceUtil.getUserById(deleteUserIds[i]).getGroup();
      if (group != null && scopeGroupId == group.getGroupId()) {
        throw new RequiredGroupException();
      }
      UserServiceUtil.deleteUser(deleteUserIds[i]);
    }
  }
}
