{
  long structureVersionId=counterLocalService.increment();
  DDMStructureVersion structureVersion=ddmStructureVersionPersistence.create(structureVersionId);
  structureVersion.setGroupId(structure.getGroupId());
  structureVersion.setCompanyId(structure.getCompanyId());
  structureVersion.setUserId(structure.getUserId());
  structureVersion.setUserName(structure.getUserName());
  structureVersion.setCreateDate(structure.getModifiedDate());
  structureVersion.setStructureId(structure.getStructureId());
  structureVersion.setVersion(version);
  structureVersion.setParentStructureId(structure.getParentStructureId());
  structureVersion.setName(structure.getName());
  structureVersion.setDescription(structure.getDescription());
  structureVersion.setDefinition(structure.getDefinition());
  structureVersion.setStorageType(structure.getStorageType());
  structureVersion.setType(structure.getType());
  int status=GetterUtil.getInteger(serviceContext.getAttribute("status"),WorkflowConstants.STATUS_APPROVED);
  structureVersion.setStatus(status);
  structureVersion.setStatusByUserId(user.getUserId());
  structureVersion.setStatusByUserName(user.getFullName());
  structureVersion.setStatusDate(structure.getModifiedDate());
  ddmStructureVersionPersistence.update(structureVersion);
  return structureVersion;
}
