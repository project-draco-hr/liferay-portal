{
  if (!GroupThreadLocal.isDeleteInProcess()) {
    if (ddmStructurePersistence.countByParentStructureId(structure.getStructureId()) > 0) {
      throw new RequiredStructureException.MustNotDeleteStructureThatHasChild(structure.getStructureId());
    }
    long classNameId=classNameLocalService.getClassNameId(DDMStructure.class);
    if (ddmTemplatePersistence.countByG_C_C(structure.getGroupId(),classNameId,structure.getPrimaryKey()) > 0) {
      throw new RequiredStructureException.MustNotDeleteStructureReferencedByTemplates(structure.getStructureId());
    }
  }
  ddmStructureLinkPersistence.removeByStructureId(structure.getStructureId());
  ddmStructurePersistence.remove(structure);
  List<DDMStructureVersion> structureVersions=ddmStructureVersionLocalService.getStructureVersions(structure.getStructureId());
  for (  DDMStructureVersion structureVersion : structureVersions) {
    ddmStructureLayoutPersistence.removeByStructureVersionId(structureVersion.getStructureVersionId());
    ddmStructureVersionPersistence.remove(structureVersion);
  }
  resourceLocalService.deleteResource(structure.getCompanyId(),DDMStructure.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,structure.getStructureId());
}
