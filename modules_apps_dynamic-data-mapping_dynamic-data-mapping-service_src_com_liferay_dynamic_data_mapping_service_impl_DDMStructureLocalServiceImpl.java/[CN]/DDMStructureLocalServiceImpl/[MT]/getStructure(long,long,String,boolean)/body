{
  structureKey=getStructureKey(structureKey);
  DDMStructure structure=ddmStructurePersistence.fetchByG_C_S(groupId,classNameId,structureKey);
  if (structure != null) {
    return structure;
  }
  if (!includeAncestorStructures) {
    throw new NoSuchStructureException("No DDMStructure exists with the structure key " + structureKey);
  }
  for (  long curGroupId : PortalUtil.getAncestorSiteGroupIds(groupId)) {
    structure=ddmStructurePersistence.fetchByG_C_S(curGroupId,classNameId,structureKey);
    if (structure != null) {
      return structure;
    }
  }
  throw new NoSuchStructureException("No DDMStructure exists with the structure key " + structureKey + " in the ancestor groups");
}
