{
  CometRequest cometRequest=cometSession.getCometRequest();
  _companyId=cometRequest.getCompanyId();
  _userId=cometRequest.getUserId();
  String pollerRequestString=cometRequest.getParameter("pollerRequest");
  JSONObject pollerResponseHeaderJSONObject=PollerRequestHandlerUtil.processRequest(cometRequest.getPathInfo(),pollerRequestString);
  if (pollerResponseHeaderJSONObject != null) {
    _channelListener=new PollerCometChannelListener(cometSession,pollerResponseHeaderJSONObject);
    try {
      ChannelHubManagerUtil.registerChannelListener(_companyId,_userId,_channelListener);
    }
 catch (    UnknownChannelException e) {
      if (_log.isDebugEnabled()) {
        _log.debug("User session already ended, terminating request: " + _userId);
      }
      cometSession.close();
    }
  }
 else {
    cometSession.close();
  }
}
