{
  ActionableDynamicQuery actionableDynamicQuery=JournalArticleLocalServiceUtil.getExportActionableDynamicQuery(portletDataContext);
  actionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod(){
    @Override public void performAction(    Object object) throws PortalException {
      JournalArticle article=(JournalArticle)object;
      if (portletDataContext.getBooleanParameter(NAMESPACE,"version-history")) {
        StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,article);
        return;
      }
      if (!article.isApproved()) {
        return;
      }
      JournalArticleKey articleKey=new JournalArticleKey(article);
      JournalArticle latestArticle=latestArtciles.get(articleKey);
      if ((latestArticle == null) || (latestArticle.getVersion() < article.getVersion())) {
        latestArtciles.put(articleKey,article);
      }
    }
  }
);
  return actionableDynamicQuery;
}
