{
  final List<ObjectValuePair<String,Long>> dateList=new ArrayList<ObjectValuePair<String,Long>>();
  StubHttpServletResponse stubHttpServletResponse=new StubHttpServletResponse(){
    @Override public void addDateHeader(    String name,    long value){
      dateList.add(new ObjectValuePair<String,Long>(name,value));
    }
  }
;
  MetaInfoCacheServletResponse metaInfoCacheServletResponse=new MetaInfoCacheServletResponse(stubHttpServletResponse);
  Map<String,Set<Header>> headers=metaInfoCacheServletResponse.getHeaders();
  assertEquals(0,headers.size());
  metaInfoCacheServletResponse.addDateHeader("date1",1);
  assertEquals(1,headers.size());
  assertTrue(metaInfoCacheServletResponse.containsHeader("date1"));
  Set<Header> dateHeaders1=headers.get("date1");
  assertEquals(1,dateHeaders1.size());
  assertTrue(dateHeaders1.contains(new Header(1L)));
  assertEquals(1,dateList.size());
  assertEquals(new ObjectValuePair<String,Long>("date1",1L),dateList.get(0));
  metaInfoCacheServletResponse.addDateHeader("date1",2);
  assertEquals(1,headers.size());
  assertTrue(metaInfoCacheServletResponse.containsHeader("date1"));
  dateHeaders1=headers.get("date1");
  assertEquals(2,dateHeaders1.size());
  assertTrue(dateHeaders1.contains(new Header(2L)));
  assertEquals(2,dateList.size());
  assertEquals(new ObjectValuePair<String,Long>("date1",2L),dateList.get(1));
  metaInfoCacheServletResponse.addDateHeader("date2",1);
  assertEquals(2,headers.size());
  assertTrue(metaInfoCacheServletResponse.containsHeader("date2"));
  Set<Header> dateHeaders2=headers.get("date2");
  assertEquals(1,dateHeaders2.size());
  assertTrue(dateHeaders2.contains(new Header(1L)));
  assertEquals(3,dateList.size());
  assertEquals(new ObjectValuePair<String,Long>("date2",1L),dateList.get(2));
}
