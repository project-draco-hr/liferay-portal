{
  final List<ObjectValuePair<String,Long>> objectValuePairs=new ArrayList<>();
  StubHttpServletResponse stubHttpServletResponse=new StubHttpServletResponse(){
    @Override public void addDateHeader(    String name,    long value){
      objectValuePairs.add(new ObjectValuePair<String,Long>(name,value));
    }
  }
;
  MetaInfoCacheServletResponse metaInfoCacheServletResponse=new MetaInfoCacheServletResponse(stubHttpServletResponse);
  Map<String,Set<Header>> headers=metaInfoCacheServletResponse.getHeaders();
  Assert.assertEquals(0,headers.size());
  metaInfoCacheServletResponse.addDateHeader("date1",1);
  Assert.assertEquals(1,headers.size());
  Assert.assertTrue(metaInfoCacheServletResponse.containsHeader("date1"));
  Set<Header> dateHeaders1=headers.get("date1");
  Assert.assertEquals(1,dateHeaders1.size());
  Assert.assertTrue(dateHeaders1.contains(new Header(1L)));
  Assert.assertEquals(1,objectValuePairs.size());
  Assert.assertEquals(new ObjectValuePair<String,Long>("date1",1L),objectValuePairs.get(0));
  metaInfoCacheServletResponse.addDateHeader("date1",2);
  Assert.assertEquals(1,headers.size());
  Assert.assertTrue(metaInfoCacheServletResponse.containsHeader("date1"));
  dateHeaders1=headers.get("date1");
  Assert.assertEquals(2,dateHeaders1.size());
  Assert.assertTrue(dateHeaders1.contains(new Header(2L)));
  Assert.assertEquals(2,objectValuePairs.size());
  Assert.assertEquals(new ObjectValuePair<String,Long>("date1",2L),objectValuePairs.get(1));
  metaInfoCacheServletResponse.addDateHeader("date2",1);
  Assert.assertEquals(2,headers.size());
  Assert.assertTrue(metaInfoCacheServletResponse.containsHeader("date2"));
  Set<Header> dateHeaders2=headers.get("date2");
  Assert.assertEquals(1,dateHeaders2.size());
  Assert.assertTrue(dateHeaders2.contains(new Header(1L)));
  Assert.assertEquals(3,objectValuePairs.size());
  Assert.assertEquals(new ObjectValuePair<String,Long>("date2",1L),objectValuePairs.get(2));
}
