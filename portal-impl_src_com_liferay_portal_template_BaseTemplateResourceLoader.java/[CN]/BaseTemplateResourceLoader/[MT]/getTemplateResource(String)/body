{
  TemplateResource templateResource=null;
  Object object=_portalCache.get(templateId);
  if ((object != null) && (object instanceof TemplateResource)) {
    templateResource=(TemplateResource)object;
    if (!checkInterval) {
      return templateResource;
    }
    if ((templateResource.getLastModified() + interval) > System.currentTimeMillis()) {
      return templateResource;
    }
  }
  for (  TemplateResourceParser templateResourceParser : _templateResourceParsers) {
    templateResource=templateResourceParser.getTemplateResource(templateId);
    if (templateResource != null) {
      if (!TemplateManager.VELOCITY.equals(getTemplateResourceLoaderName()) || !templateId.contains(SandboxHandler.SANDBOX_MARKER)) {
        _portalCache.put(templateId,templateResource);
      }
      break;
    }
  }
  return templateResource;
}
