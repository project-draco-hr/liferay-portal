{
  ShoppingConfig shoppingConfig=AdminConfigServiceUtil.getShoppingConfig(order.getCompanyId());
  EmailConfig shippingEmail=shoppingConfig.getShippingEmail();
  if (override || (order.isSendShippingEmail() && shippingEmail.isSend())) {
    List orderItems=ShoppingOrderItemServiceUtil.getOrderItems(order.getOrderId());
    Set supplierUserIds=ShoppingUtil.getSupplierUserIds(orderItems);
    Iterator itr=supplierUserIds.iterator();
    while (itr.hasNext()) {
      String supplierUserId=(String)itr.next();
      _sendEmail(order,orderItems,supplierUserId,shoppingConfig,shippingEmail);
    }
    _sendEmail(order,orderItems,null,shoppingConfig,shippingEmail);
    order.setModifiedDate(new Date());
    order.setSendShippingEmail(false);
    ShoppingOrderUtil.update(order);
  }
}
