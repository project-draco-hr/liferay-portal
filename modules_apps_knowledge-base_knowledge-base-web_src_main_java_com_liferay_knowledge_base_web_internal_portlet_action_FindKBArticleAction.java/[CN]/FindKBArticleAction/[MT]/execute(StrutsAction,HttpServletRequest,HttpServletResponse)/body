{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long plid=ParamUtil.getLong(request,"plid");
  long resourcePrimKey=ParamUtil.getLong(request,"resourcePrimKey");
  int status=ParamUtil.getInteger(request,"status",WorkflowConstants.STATUS_APPROVED);
  boolean maximized=ParamUtil.getBoolean(request,"maximized");
  KBArticle kbArticle=getKBArticle(resourcePrimKey,status);
  if (!isValidPlid(plid)) {
    plid=themeDisplay.getPlid();
  }
  PortletURL portletURL=null;
  if (kbArticle == null) {
    portletURL=getDynamicPortletURL(plid,status,request);
  }
  if (status != WorkflowConstants.STATUS_APPROVED) {
    portletURL=getDynamicPortletURL(plid,status,request);
  }
  if (portletURL == null) {
    portletURL=getKBArticleURL(plid,false,kbArticle,request);
  }
  if (portletURL == null) {
    portletURL=getKBArticleURL(plid,true,kbArticle,request);
  }
  if (portletURL == null) {
    portletURL=getDynamicPortletURL(plid,status,request);
  }
  if (maximized) {
    portletURL.setWindowState(LiferayWindowState.MAXIMIZED);
    portletURL.setPortletMode(PortletMode.VIEW);
  }
  response.sendRedirect(portletURL.toString());
  return null;
}
