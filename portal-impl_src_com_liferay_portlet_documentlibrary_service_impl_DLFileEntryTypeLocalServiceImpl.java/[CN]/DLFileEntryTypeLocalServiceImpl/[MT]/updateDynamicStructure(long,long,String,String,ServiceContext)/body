{
  Locale locale=ServiceContextUtil.getLocale(serviceContext);
  Locale defaultLocale=LocaleUtil.getDefault();
  Map<Locale,String> nameMap=new HashMap<Locale,String>();
  nameMap.put(locale,name);
  nameMap.put(defaultLocale,name);
  Map<Locale,String> descriptionMap=new HashMap<Locale,String>();
  descriptionMap.put(locale,description);
  descriptionMap.put(defaultLocale,description);
  String xsd=ParamUtil.getString(serviceContext,"xsd");
  String ddmStructureKey="auto_" + fileEntryTypeId;
  DDMStructure ddmStructure=ddmStructureService.fetchStructure(groupId,ddmStructureKey);
  try {
    if (ddmStructure == null) {
      ddmStructure=ddmStructureService.addStructure(groupId,PortalUtil.getClassNameId(DLFileEntryMetadata.class),ddmStructureKey,nameMap,descriptionMap,xsd,"xml",serviceContext);
    }
 else {
      ddmStructure=ddmStructureService.updateStructure(ddmStructure.getStructureId(),nameMap,descriptionMap,xsd,serviceContext);
    }
    return ddmStructure.getStructureId();
  }
 catch (  StructureXsdException sxe) {
    if (ddmStructure != null) {
      ddmStructureService.deleteStructure(ddmStructure.getStructureId());
    }
  }
  return 0;
}
