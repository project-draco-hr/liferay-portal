{
  String[][] renamePortletIdsArray=getRenamePortletIdsArray();
  for (  String[] renamePortletIds : renamePortletIdsArray) {
    String oldRootPortletId=renamePortletIds[0];
    String newRootPortletId=renamePortletIds[1];
    updatePortlet(oldRootPortletId,newRootPortletId);
    updateLayouts(oldRootPortletId,newRootPortletId,false);
  }
  String[] uninstanceablePortletIds=getUninstanceablePortletIds();
  for (  String portletId : uninstanceablePortletIds) {
    if (portletId.contains(PortletConstants.INSTANCE_SEPARATOR)) {
      if (_log.isWarnEnabled()) {
        _log.warn("Portlet " + portletId + " is already instanceable");
      }
      continue;
    }
    String instanceId=PortletConstants.generateInstanceId();
    String newPortletId=PortletConstants.assemblePortletId(portletId,instanceId);
    updateResourcePermission(portletId,newPortletId,false);
    updateInstanceablePortletPreferences(portletId,newPortletId);
    updateLayouts(portletId,newPortletId,true);
  }
}
