{
  String sql="select plid, typeSettings from Layout where " + getTypeSettingsCriteria(oldRootPortletId);
  try (PreparedStatement ps=connection.prepareStatement(sql);ResultSet rs=ps.executeQuery()){
    while (rs.next()) {
      long plid=rs.getLong("plid");
      String typeSettings=rs.getString("typeSettings");
      List<String> layoutColumnIds=_getLayoutColumnIds();
      layoutColumnIds.addAll(_getNestedPortletColumnIds(typeSettings));
      String newTypeSettings=getNewTypeSettings(typeSettings,oldRootPortletId,newRootPortletId,layoutColumnIds,exactMatch);
      updateLayout(plid,newTypeSettings);
    }
  }
 }
