{
  AccessControlContext accessControlContext=AccessControlUtil.getAccessControlContext();
  if (accessControlContext == null) {
    return;
  }
  Map<String,Object> settings=accessControlContext.getSettings();
  String[] hostsAllowed=StringUtil.split(GetterUtil.getString(settings.get("hosts.allowed")));
  Set<String> hostsAllowedSet=SetUtil.fromArray(hostsAllowed);
  HttpServletRequest httpServletRequest=accessControlContext.getHttpServletRequest();
  boolean accessAllowed=AuthSettingsUtil.isAccessAllowed(httpServletRequest,hostsAllowedSet);
  if (!accessAllowed) {
    throw new SecurityException("Access denied for " + httpServletRequest.getRemoteAddr());
  }
}
