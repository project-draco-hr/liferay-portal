{
  AccessControlContext accessControlContext=AccessControlUtil.getAccessControlContext();
  if (accessControlContext == null) {
    return;
  }
  HttpServletRequest request=accessControlContext.getRequest();
  String hostsAllowedString=MapUtil.getString(accessControlContext.getSettings(),"hosts.allowed");
  String[] hostsAllowed=StringUtil.split(hostsAllowedString);
  Set<String> hostsAllowedSet=SetUtil.fromArray(hostsAllowed);
  if (!AuthSettingsUtil.isAccessAllowed(request,hostsAllowedSet)) {
    throw new SecurityException("Access denied for " + request.getRemoteAddr());
  }
}
