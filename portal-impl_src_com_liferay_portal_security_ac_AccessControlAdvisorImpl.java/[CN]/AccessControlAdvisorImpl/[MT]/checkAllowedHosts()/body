{
  AccessControlContext accessControlContext=AccessControlUtil.getAccessControlContext();
  if (accessControlContext == null) {
    return;
  }
  HttpServletRequest request=accessControlContext.getRequest();
  Map<String,Object> settings=accessControlContext.getSettings();
  String[] hostsAllowed=StringUtil.split(GetterUtil.getString(settings.get("hosts.allowed")));
  Set<String> hostsAllowedSet=SetUtil.fromArray(hostsAllowed);
  if (!AuthSettingsUtil.isAccessAllowed(request,hostsAllowedSet)) {
    throw new SecurityException("Access denied for " + request.getRemoteAddr());
  }
}
