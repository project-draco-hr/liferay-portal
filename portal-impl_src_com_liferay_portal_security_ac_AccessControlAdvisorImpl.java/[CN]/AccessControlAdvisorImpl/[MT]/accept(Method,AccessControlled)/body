{
  checkAllowedHosts();
  AccessControlType accessControlType=accessControlled.accessControlType();
  if (accessControlType == AccessControlType.AUTHENTICATED) {
    PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
    if ((permissionChecker == null) || !permissionChecker.isSignedIn()) {
      throw new SecurityException("Authenticated access required");
    }
  }
}
