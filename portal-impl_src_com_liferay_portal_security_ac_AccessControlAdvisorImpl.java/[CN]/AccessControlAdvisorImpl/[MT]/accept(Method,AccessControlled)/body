{
  if (accessControlled.hostAllowedValidationEnabled()) {
    checkAllowedHosts();
  }
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  if (!accessControlled.guestAccessEnabled() && ((permissionChecker == null) || !permissionChecker.isSignedIn())) {
    throw new SecurityException("Authenticated access required");
  }
}
