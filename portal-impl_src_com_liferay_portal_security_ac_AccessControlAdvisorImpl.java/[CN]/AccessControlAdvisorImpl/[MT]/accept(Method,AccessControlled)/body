{
  checkAllowedHosts();
  AccessControlType remoteMethodAccessType=accessControlled.accessControlType();
  if (remoteMethodAccessType == AccessControlType.AUTHENTICATED) {
    PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
    if ((permissionChecker == null) || !permissionChecker.isSignedIn()) {
      throw new SecurityException("Authenticated access required.");
    }
  }
}
