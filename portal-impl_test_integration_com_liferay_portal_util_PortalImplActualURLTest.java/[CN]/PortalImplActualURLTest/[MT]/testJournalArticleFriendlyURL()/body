{
  ServiceContext serviceContext=ServiceTestUtil.getServiceContext();
  Group group=GroupLocalServiceUtil.addGroup(TestPropsValues.getUserId(),GroupConstants.DEFAULT_PARENT_GROUP_ID,StringPool.BLANK,0,GroupConstants.DEFAULT_LIVE_GROUP_ID,"Test " + ServiceTestUtil.nextInt(),StringPool.BLANK,GroupConstants.TYPE_SITE_OPEN,StringPool.BLANK,true,true,serviceContext);
  LayoutLocalServiceUtil.addLayout(TestPropsValues.getUserId(),group.getGroupId(),false,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,"Home",StringPool.BLANK,StringPool.BLANK,LayoutConstants.TYPE_PORTLET,false,StringPool.BLANK,serviceContext);
  Layout layout=LayoutLocalServiceUtil.addLayout(TestPropsValues.getUserId(),group.getGroupId(),false,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,"Test " + ServiceTestUtil.nextInt(),StringPool.BLANK,StringPool.BLANK,LayoutConstants.TYPE_PORTLET,false,StringPool.BLANK,serviceContext);
  LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
  String portletId=layoutTypePortlet.addPortletId(TestPropsValues.getUserId(),PortletKeys.ASSET_PUBLISHER,"column-1",0);
  layoutTypePortlet.setTypeSettingsProperty(LayoutTypePortletConstants.DEFAULT_ASSET_PUBLISHER_PORTLET_ID,portletId);
  layout=LayoutServiceUtil.updateLayout(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),layout.getTypeSettings());
  Map<Locale,String> titleMap=new HashMap<Locale,String>();
  titleMap.put(Locale.US,"Test Journal Article");
  StringBundler sb=new StringBundler(6);
  sb.append("<?xml version=\"1.0\"?><root available-locales=");
  sb.append("\"en_US\" default-locale=\"en_US\">");
  sb.append("<static-content language-id=\"en_US\"><![CDATA[<p>");
  sb.append("This test content is in English.");
  sb.append("</p>]]>");
  sb.append("</static-content></root>");
  JournalArticleLocalServiceUtil.addArticle(TestPropsValues.getUserId(),group.getGroupId(),0,0,0,StringPool.BLANK,true,1,titleMap,new HashMap<Locale,String>(),sb.toString(),"general",null,null,layout.getUuid(),1,1,1965,0,0,0,0,0,0,0,true,0,0,0,0,0,true,false,false,null,null,null,StringPool.BLANK,serviceContext);
  String actualURL=PortalUtil.getActualURL(group.getGroupId(),false,Portal.PATH_MAIN,"/-/test-journal-article",new HashMap<String,String[]>(),getRequestContext());
  Assert.assertNotNull(actualURL);
  try {
    PortalUtil.getActualURL(group.getGroupId(),false,Portal.PATH_MAIN,"/-/non-existing-test-journal-article",new HashMap<String,String[]>(),getRequestContext());
    Assert.fail();
  }
 catch (  NoSuchLayoutException nsle) {
  }
  GroupLocalServiceUtil.deleteGroup(group);
}
