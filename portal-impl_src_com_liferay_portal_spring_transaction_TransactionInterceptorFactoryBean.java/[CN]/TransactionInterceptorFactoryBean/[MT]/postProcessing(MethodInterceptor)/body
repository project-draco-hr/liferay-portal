{
  TransactionInterceptor transactionInterceptor=(TransactionInterceptor)methodInterceptor;
  TransactionExecutor transactionExecutor=TransactionExecutorFactory.createTransactionExecutor(transactionInterceptor.platformTransactionManager,false);
  transactionInterceptor.setTransactionExecutor(transactionExecutor);
  DynamicDataSourceTargetSource dynamicDataSourceTargetSource=(DynamicDataSourceTargetSource)InfrastructureUtil.getDynamicDataSourceTargetSource();
  if (dynamicDataSourceTargetSource == null) {
    return methodInterceptor;
  }
  DynamicDataSourceAdvice dynamicDataSourceAdvice=new DynamicDataSourceAdvice();
  dynamicDataSourceAdvice.setDynamicDataSourceTargetSource(dynamicDataSourceTargetSource);
  dynamicDataSourceAdvice.setNextMethodInterceptor(methodInterceptor);
  dynamicDataSourceAdvice.setTransactionAttributeSource(transactionInterceptor.transactionAttributeSource);
  return dynamicDataSourceAdvice;
}
