{
  List<ResourcePermission> roleResourcePermissions=ResourcePermissionLocalServiceUtil.getRoleResourcePermissions(roleId);
  Group userPersonalSite=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.USER_PERSONAL_SITE);
  String groupIdString=String.valueOf(userPersonalSite.getGroupId());
  for (  ResourcePermission resourcePermission : roleResourcePermissions) {
    if (!resourcePermission.hasActionId(ActionKeys.ADD_TO_PAGE)) {
      continue;
    }
    ResourcePermissionLocalServiceUtil.removeResourcePermission(companyId,resourcePermission.getName(),resourcePermission.getScope(),resourcePermission.getPrimKey(),roleId,ActionKeys.ADD_TO_PAGE);
    if (!limitScope || groupIdString.equals(resourcePermission.getPrimKey())) {
      continue;
    }
    ResourcePermissionLocalServiceUtil.addResourcePermission(companyId,resourcePermission.getName(),ResourceConstants.SCOPE_GROUP,groupIdString,roleId,ActionKeys.ADD_TO_PAGE);
  }
}
