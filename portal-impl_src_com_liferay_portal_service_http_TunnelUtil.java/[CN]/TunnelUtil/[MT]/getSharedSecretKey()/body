{
  String sharedSecret=PropsValues.TUNNELING_SERVLET_SHARED_SECRET;
  if (Validator.isNull(sharedSecret)) {
    AuthException authException=new AuthException(LanguageUtil.get(LocaleUtil.ENGLISH,"the-tunneling-servlet-shared-secret-is-not-set"));
    authException.setType(AuthException.NO_SHARED_SECRET);
    throw authException;
  }
  if ((sharedSecret.length() != 16) && (sharedSecret.length() != 32) && (sharedSecret.length() != 64)) {
    AuthException authException=new AuthException("the-tunneling-servlet-shared-secret-must-be-16,-32,-or-64-" + "characters-long");
    authException.setType(AuthException.NO_SHARED_SECRET);
    throw authException;
  }
  return new SecretKeySpec(sharedSecret.getBytes(),_TUNNEL_ENCRYPTION_ALGORITHM);
}
