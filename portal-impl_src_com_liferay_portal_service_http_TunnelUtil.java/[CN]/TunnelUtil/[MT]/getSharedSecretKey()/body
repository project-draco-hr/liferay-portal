{
  String sharedSecret=PropsValues.TUNNELING_SERVLET_SHARED_SECRET;
  if (Validator.isNull(sharedSecret)) {
    AuthException authException=new AuthException();
    authException.setType(AuthException.NO_SHARED_SECRET);
    throw authException;
  }
  if (sharedSecret.length() < 8) {
    AuthException authException=new AuthException();
    authException.setType(AuthException.INVALID_SHARED_SECRET);
    throw authException;
  }
  return new SecretKeySpec(sharedSecret.getBytes(),PropsValues.TUNNELING_SERVLET_ENCRYPTION_ALGORITHM);
}
