{
  List<String> badIsbns=new ArrayList<>();
  String[] isbns=portletPreferences.getValues("isbns",StringPool.EMPTY_ARRAY);
  for (  String isbn : isbns) {
    ISBNValidator isbnValidator=new ISBNValidator();
    if (isbnValidator.isValid(isbn)) {
      AmazonRankings amazonRankings=AmazonRankingsUtil.getAmazonRankings(_amazonRankingsConfiguration,isbn);
      if (amazonRankings != null) {
        continue;
      }
    }
    badIsbns.add(isbn);
    if (_log.isInfoEnabled()) {
      _log.info("Invalid ISBN " + isbn);
    }
  }
  if (!badIsbns.isEmpty()) {
    throw new ValidatorException("Unable to retrieve ISBNs",badIsbns);
  }
}
