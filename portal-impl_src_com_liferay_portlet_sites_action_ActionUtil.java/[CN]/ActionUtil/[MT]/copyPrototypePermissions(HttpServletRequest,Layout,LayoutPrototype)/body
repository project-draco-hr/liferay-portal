{
  long companyId=targetLayout.getCompanyId();
  List<Role> roles=RoleLocalServiceUtil.getRoles(companyId);
  String sourceResourceName=LayoutPrototype.class.getName();
  String sourceResourcePrimKey=String.valueOf(sourceLayoutPrototype.getLayoutPrototypeId());
  String targetResourceName=Layout.class.getName();
  String targetResourcePrimKey=String.valueOf(targetLayout.getPlid());
  List<String> actionIds=ResourceActionsUtil.getResourceActions(sourceResourceName);
  for (  Role role : roles) {
    String roleName=role.getName();
    if (roleName.equals(RoleConstants.ADMINISTRATOR)) {
      continue;
    }
    List<String> actions=ResourcePermissionLocalServiceUtil.getAvailableResourcePermissionActionIds(companyId,sourceResourceName,ResourceConstants.SCOPE_INDIVIDUAL,sourceResourcePrimKey,role.getRoleId(),actionIds);
    ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,targetResourceName,ResourceConstants.SCOPE_INDIVIDUAL,targetResourcePrimKey,role.getRoleId(),actions.toArray(new String[actions.size()]));
  }
}
