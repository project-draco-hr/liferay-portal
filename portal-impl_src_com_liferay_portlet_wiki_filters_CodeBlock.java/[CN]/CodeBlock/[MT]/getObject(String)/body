{
  StringBundler sb=new StringBundler();
  Matcher matcher=_pattern.matcher(content);
  if (matcher.matches()) {
    sb.append("<div class=\"wiki-code\">");
    String[] lines=matcher.group(1).split("\\n");
    for (int i=0; i < lines.length; i++) {
      if (i != 0) {
        sb.append("<br />");
      }
      String translation=StringUtil.replace(lines[i],new String[]{"\\s","<",">","=","\"","'","\t"},new String[]{"&nbsp;","&lt;","&gt;","&#x003D;","&#0034;","&#0039;","&nbsp;&#8594;&nbsp;"});
      int padlength=String.valueOf(lines.length).length() - String.valueOf(i + 1).length();
      String padding="";
      for (int j=0; j < padlength; j++) {
        padding+="&#0149;";
      }
      sb.append("<span class=\"code-lines\">");
      sb.append(padding + (i + 1));
      sb.append("</span>");
      sb.append(translation);
    }
    sb.append("</div>");
    content=sb.toString();
  }
  return content;
}
