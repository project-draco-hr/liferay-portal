{
  List<Organization> userOrgs=OrganizationLocalServiceUtil.getUserOrganizations(userId);
  if (userOrgs.isEmpty()) {
    return Collections.emptySet();
  }
  if (PropsValues.ORGANIZATIONS_MEMBERSHIP_STRICT) {
    return new HashSet<>(userOrgs);
  }
  Set<Organization> organizations=new LinkedHashSet<>();
  for (  Organization organization : userOrgs) {
    if (organizations.add(organization)) {
      List<Organization> ancestorOrganizations=OrganizationLocalServiceUtil.getParentOrganizations(organization.getOrganizationId());
      organizations.addAll(ancestorOrganizations);
    }
  }
  return organizations;
}
