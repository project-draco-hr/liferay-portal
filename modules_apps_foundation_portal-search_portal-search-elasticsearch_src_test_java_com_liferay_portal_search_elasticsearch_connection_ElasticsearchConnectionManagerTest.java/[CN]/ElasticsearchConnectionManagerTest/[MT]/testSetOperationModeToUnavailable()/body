{
  _elasticsearchConnectionManager.unsetElasticsearchConnection(_remoteElasticsearchConnection);
  verifyCloseNeverConnect(_remoteElasticsearchConnection);
  verifyNeverCloseNeverConnect(_embeddedElasticsearchConnection);
  resetMockConnections();
  try {
    modify(OperationMode.REMOTE);
    Assert.fail();
  }
 catch (  MissingOperationModeException mome) {
    String message=mome.getMessage();
    Assert.assertTrue(message.contains(String.valueOf(OperationMode.REMOTE)));
  }
  verifyNeverCloseNeverConnect(_embeddedElasticsearchConnection);
  verifyNeverCloseNeverConnect(_remoteElasticsearchConnection);
}
