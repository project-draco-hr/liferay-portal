{
  Document contentDoc=SAXReaderUtil.read(oldArticle.getContent());
  XPath xpathSelector=SAXReaderUtil.createXPath("//dynamic-element[@type='image']");
  List<Node> imageNodes=xpathSelector.selectNodes(contentDoc);
  for (  Node imageNode : imageNodes) {
    Element imageEl=(Element)imageNode;
    String instanceId=imageEl.attributeValue("instance-id");
    String name=imageEl.attributeValue("name");
    List<Element> dynamicContentEls=imageEl.elements("dynamic-content");
    for (    Element dynamicContentEl : dynamicContentEls) {
      long imageId=GetterUtil.getLong(dynamicContentEl.attributeValue("id"));
      String languageId=dynamicContentEl.attributeValue("language-id");
      Image oldImage=null;
      try {
        oldImage=imageLocalService.getImage(imageId);
      }
 catch (      NoSuchImageException nsie) {
        continue;
      }
      imageId=journalArticleImageLocalService.getArticleImageId(newArticle.getGroupId(),newArticle.getArticleId(),newArticle.getVersion(),instanceId,name,languageId);
      imageLocalService.updateImage(imageId,oldImage.getTextObj());
      String elContent="/image/journal/article?img_id=" + imageId + "&t="+ ImageServletTokenUtil.getToken(imageId);
      dynamicContentEl.setText(elContent);
      dynamicContentEl.addAttribute("id",String.valueOf(imageId));
    }
  }
  newArticle.setContent(contentDoc.formattedString());
}
