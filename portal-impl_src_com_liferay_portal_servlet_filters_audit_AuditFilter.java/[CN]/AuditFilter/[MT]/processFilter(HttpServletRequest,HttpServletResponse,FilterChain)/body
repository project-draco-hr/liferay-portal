{
  AuditRequestThreadLocal auditRequestThreadLocal=AuditRequestThreadLocal.getAuditThreadLocal();
  auditRequestThreadLocal.setClientHost(request.getRemoteHost());
  auditRequestThreadLocal.setClientIP(request.getRemoteAddr());
  auditRequestThreadLocal.setQueryString(request.getQueryString());
  auditRequestThreadLocal.setRequestURL(request.getRequestURL().toString());
  auditRequestThreadLocal.setServerName(request.getServerName());
  auditRequestThreadLocal.setServerPort(request.getServerPort());
  auditRequestThreadLocal.setSessionID(request.getSession().getId());
  Long realUserId=(Long)request.getSession().getAttribute(WebKeys.USER_ID);
  if (realUserId != null) {
    auditRequestThreadLocal.setRealUserId(realUserId.longValue());
  }
  try {
    processFilter(AuditFilter.class,request,response,filterChain);
  }
  finally {
    AuditRequestThreadLocal.removeAuditThreadLocal();
  }
}
