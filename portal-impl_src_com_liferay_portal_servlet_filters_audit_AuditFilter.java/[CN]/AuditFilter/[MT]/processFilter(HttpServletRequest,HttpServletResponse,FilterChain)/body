{
  AuditRequestThreadLocal auditRequestThreadLocal=AuditRequestThreadLocal.getAuditThreadLocal();
  auditRequestThreadLocal.setClientHost(request.getRemoteHost());
  auditRequestThreadLocal.setClientIP(request.getRemoteAddr());
  auditRequestThreadLocal.setQueryString(request.getQueryString());
  HttpSession session=request.getSession();
  Long userId=(Long)session.getAttribute(WebKeys.USER_ID);
  if (userId != null) {
    auditRequestThreadLocal.setRealUserId(userId.longValue());
  }
  auditRequestThreadLocal.setRequestURL(request.getRequestURL().toString());
  auditRequestThreadLocal.setServerName(request.getServerName());
  auditRequestThreadLocal.setServerPort(request.getServerPort());
  auditRequestThreadLocal.setSessionID(request.getSession().getId());
  try {
    processFilter(AuditFilter.class,request,response,filterChain);
  }
  finally {
    AuditRequestThreadLocal.removeAuditThreadLocal();
  }
}
