{
  AuditRequestThreadLocal auditRequestThreadLocal=AuditRequestThreadLocal.getAuditThreadLocal();
  HttpServletRequest httpServletRequest=(HttpServletRequest)request;
  AuditRequest auditRequest=new AuditRequest(httpServletRequest);
  auditRequestThreadLocal.setClientHost(request.getRemoteHost());
  auditRequestThreadLocal.setClientIP(auditRequest.getRemoteAddr());
  auditRequestThreadLocal.setQueryString(request.getQueryString());
  HttpSession session=request.getSession();
  Long userId=(Long)session.getAttribute(WebKeys.USER_ID);
  if (userId != null) {
    auditRequestThreadLocal.setRealUserId(userId.longValue());
  }
  auditRequestThreadLocal.setRequestURL(request.getRequestURL().toString());
  auditRequestThreadLocal.setServerName(request.getServerName());
  auditRequestThreadLocal.setServerPort(request.getServerPort());
  auditRequestThreadLocal.setSessionID(session.getId());
  return null;
}
