{
  if (!WorkflowThreadLocal.isEnabled()) {
    return;
  }
  List<WorkflowInstanceLink> workflowInstanceLinks=getWorkflowInstanceLinks(companyId,groupId,className,oldClassPK);
  for (  WorkflowInstanceLink workflowInstanceLink : workflowInstanceLinks) {
    WorkflowInstance workflowInstance=WorkflowInstanceManagerUtil.getWorkflowInstance(workflowInstanceLink.getCompanyId(),workflowInstanceLink.getWorkflowInstanceId());
    workflowInstanceLink.setClassPK(newClassPK);
    workflowInstanceLinkPersistence.update(workflowInstanceLink,false);
    Map<String,Serializable> workflowContext=new HashMap<String,Serializable>(workflowInstance.getWorkflowContext());
    workflowContext.put(WorkflowConstants.CONTEXT_ENTRY_CLASS_PK,newClassPK);
    WorkflowInstanceManagerUtil.updateWorkflowContext(workflowInstanceLink.getCompanyId(),workflowInstanceLink.getWorkflowInstanceId(),workflowContext);
  }
}
