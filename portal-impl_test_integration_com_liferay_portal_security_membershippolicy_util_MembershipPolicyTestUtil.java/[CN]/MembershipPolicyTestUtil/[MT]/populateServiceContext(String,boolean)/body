{
  ServiceContext serviceContext=ServiceTestUtil.getServiceContext();
  serviceContext.setAddGroupPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  if (includeCategorization) {
    AssetTag tag=AssetTagLocalServiceUtil.addTag(TestPropsValues.getUserId(),ServiceTestUtil.randomString(),null,new ServiceContext());
    serviceContext.setAssetTagNames(new String[]{tag.getName()});
    AssetVocabulary vocabulary=AssetVocabularyLocalServiceUtil.addVocabulary(TestPropsValues.getUserId(),ServiceTestUtil.randomString(),new ServiceContext());
    AssetCategory category=AssetCategoryLocalServiceUtil.addCategory(TestPropsValues.getUserId(),ServiceTestUtil.randomString(),vocabulary.getVocabularyId(),serviceContext);
    serviceContext.setAssetCategoryIds(new long[]{category.getCategoryId()});
  }
  serviceContext.setExpandoBridgeAttributes(addExpandoMap(className));
  return serviceContext;
}
