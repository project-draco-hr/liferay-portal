{
  ObjectOutputStream oos=null;
  try {
    UnsyncByteArrayOutputStream baos=new UnsyncByteArrayOutputStream();
    oos=new ObjectOutputStream(baos);
    oos.writeObject(obj);
    oos.close();
    oos=null;
    return baos.toByteArray();
  }
  finally {
    if (oos != null) {
      oos.close();
    }
  }
}
