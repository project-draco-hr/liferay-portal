{
  String cmd=ParamUtil.getString(request,Constants.CMD);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=themeDisplay.getScopeGroupId();
  long classNameId=ParamUtil.getLong(request,"classNameId");
  long classPK=ParamUtil.getLong(request,"classPK");
  String articleId=ParamUtil.getString(request,"articleId");
  String structureId=ParamUtil.getString(request,"structureId");
  JournalArticle article=null;
  if (!cmd.equals(Constants.ADD) && Validator.isNotNull(articleId)) {
    article=JournalArticleServiceUtil.getLatestArticle(groupId,articleId,WorkflowConstants.STATUS_ANY);
  }
 else   if ((classNameId > 0) && (classPK > JournalArticleConstants.CLASSNAME_ID_DEFAULT)) {
    String className=PortalUtil.getClassName(classNameId);
    article=JournalArticleServiceUtil.getLatestArticle(groupId,className,classPK);
  }
 else   if (Validator.isNotNull(structureId)) {
    DDMStructure structure=null;
    try {
      structure=DDMStructureServiceUtil.getStructure(groupId,structureId);
    }
 catch (    NoSuchStructureException nsse1) {
      if (groupId == themeDisplay.getCompanyGroupId()) {
        return;
      }
      try {
        structure=DDMStructureServiceUtil.getStructure(themeDisplay.getCompanyGroupId(),structureId);
      }
 catch (      NoSuchStructureException nsse2) {
        return;
      }
    }
    article=JournalArticleServiceUtil.getArticle(groupId,DDMStructure.class.getName(),structure.getStructureId());
    article.setNew(true);
    article.setId(0);
    article.setClassNameId(JournalArticleConstants.CLASSNAME_ID_DEFAULT);
    article.setClassPK(0);
    article.setArticleId(null);
    article.setVersion(0);
  }
  request.setAttribute(WebKeys.JOURNAL_ARTICLE,article);
}
