{
  String key=encodeKey(companyId,name,scope);
  ResourceCode resourceCode=_resourceCodes.get(key);
  if (resourceCode == null) {
    resourceCode=resourceCodePersistence.fetchByC_N_S(companyId,name,scope);
    if (resourceCode == null) {
      long codeId=counterLocalService.increment(ResourceCode.class.getName());
      resourceCode=resourceCodePersistence.create(codeId);
      resourceCode.setCompanyId(companyId);
      resourceCode.setName(name);
      resourceCode.setScope(scope);
      resourceCodePersistence.update(resourceCode,false);
    }
    _resourceCodes.put(key,resourceCode);
  }
  return resourceCode;
}
