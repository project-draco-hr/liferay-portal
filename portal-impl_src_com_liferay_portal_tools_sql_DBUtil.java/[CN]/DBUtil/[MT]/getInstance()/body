{
  if (_dbUtil == null) {
    try {
      if (Validator.isNotNull(PropsValues.HIBERNATE_DIALECT) && Validator.isNotNull(PropsValues.JPA_DATABASE_TYPE)) {
        throw new Exception("Either set " + PropsKeys.HIBERNATE_DIALECT + " or set "+ PropsKeys.JPA_DATABASE_TYPE+ ", but not both.");
      }
      if (Validator.isNotNull(PropsValues.HIBERNATE_DIALECT)) {
        Dialect dialect=(Dialect)Class.forName(PropsValues.HIBERNATE_DIALECT).newInstance();
        if (_log.isInfoEnabled()) {
          _log.info("Using hibernate dialect " + PropsValues.HIBERNATE_DIALECT);
        }
        setInstance(dialect);
      }
 else       if (Validator.isNotNull(PropsValues.JPA_DATABASE_TYPE)) {
        if (_log.isInfoEnabled()) {
          _log.info("Using JPA database type " + PropsValues.JPA_DATABASE_TYPE);
        }
        _dbUtil=getInstance(PropsValues.JPA_DATABASE_TYPE);
      }
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
  return _dbUtil;
}
