{
  Connection con=null;
  Statement stmt=null;
  try {
    con=HibernateUtil.getConnection();
    stmt=con.createStatement();
    for (int i=0; i < templates.length; i++) {
      String sql=buildSQL(templates[i]);
      sql=sql.trim();
      if (sql.endsWith(";")) {
        sql=sql.substring(0,sql.length() - 1);
      }
      if (_log.isDebugEnabled()) {
        _log.debug(sql);
      }
      try {
        stmt.executeUpdate(sql);
      }
 catch (      SQLException sqle) {
        _log.error("Error running " + sql);
        throw sqle;
      }
    }
  }
  finally {
    DataAccess.cleanUp(con,stmt);
  }
}
