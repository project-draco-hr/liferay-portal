{
  Map<String,Object> variables=new HashMap<String,Object>();
  variables.put("counter",new SimpleCounter());
  template=VelocityUtil.evaluate(template,variables);
  BufferedReader br=new BufferedReader(new StringReader(template));
  StringMaker sm=new StringMaker();
  String line=null;
  while ((line=br.readLine()) != null) {
    line=line.trim();
    sm.append(line);
    sm.append("\n");
  }
  br.close();
  template=sm.toString();
  template=StringUtil.replace(template,"\n\n\n","\n\n");
  return template;
}
