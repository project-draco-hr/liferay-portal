{
  Date now=new Date();
  SubscriptionSender subscriptionSender=new SubscriptionSender();
  subscriptionSender.setBody(body);
  subscriptionSender.setCompanyId(company.getCompanyId());
  subscriptionSender.setContextAttributes("[$CONTENT_ID$]",contentId,"[$CONTENT_TYPE$]",contentType,"[$DATE$]",now.toString(),"[$REASON$]",reason,"[$REPORTED_USER_ADDRESS$]",reportedEmailAddress,"[$REPORTED_USER_NAME$]",reportedUserName,"[$REPORTED_USER_URL$]",reportedUserURL,"[$REPORTER_USER_ADDRESS$]",reporterEmailAddress,"[$REPORTER_USER_NAME$]",reporterUserName,"[$SITE_NAME$]",groupName);
  subscriptionSender.setContextAttributes("[$CONTENT_TITLE$]",contentTitle,false);
  subscriptionSender.setContextAttributes("[$CONTENT_URL$]",contentURL,false);
  subscriptionSender.setFrom(fromAddress,fromName);
  subscriptionSender.setHtmlFormat(true);
  subscriptionSender.setMailId("flags_request",contentId);
  subscriptionSender.setPortletId(PortletKeys.FLAGS);
  subscriptionSender.setServiceContext(serviceContext);
  subscriptionSender.setSubject(subject);
  subscriptionSender.addRuntimeSubscribers(toAddress,toName);
  subscriptionSender.flushNotificationsAsync();
}
