{
  Assert.assertEquals(2,params.length);
  Assert.assertSame(Long.class,params[0].getClass());
  Assert.assertSame(Long.class,params[1].getClass());
  if (_databaseError) {
    throw new RuntimeException("Database error");
  }
  Long leftPrimaryKey=(Long)params[0];
  Long rightPrimaryKey=(Long)params[1];
  long[] rightPrimaryKeys=_mappingStore.get(leftPrimaryKey);
  if (rightPrimaryKeys == null) {
    return 0;
  }
  if (ArrayUtil.contains(rightPrimaryKeys,rightPrimaryKey)) {
    rightPrimaryKeys=ArrayUtil.remove(rightPrimaryKeys,rightPrimaryKey);
    _mappingStore.put(leftPrimaryKey,rightPrimaryKeys);
    return 1;
  }
  return 0;
}
