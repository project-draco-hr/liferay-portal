{
  List<Portlet> portlets=new ArrayList<Portlet>();
  Iterator<Map.Entry<String,Portlet>> itr=portletsPool.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry<String,Portlet> entry=itr.next();
    String portletId=entry.getKey();
    Portlet portlet=entry.getValue();
    if (servletContextName != null) {
      if (portletId.endsWith(PortletImpl.WAR_SEPARATOR + servletContextName)) {
        portlets.add(portlet);
      }
    }
 else {
      if (portletId.indexOf(PortletImpl.WAR_SEPARATOR) == -1) {
        portlets.add(portlet);
      }
    }
  }
  return portlets;
}
