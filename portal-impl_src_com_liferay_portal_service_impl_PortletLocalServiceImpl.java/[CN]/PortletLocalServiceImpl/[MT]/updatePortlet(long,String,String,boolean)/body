{
  portletId=PortalUtil.getJsSafePortletName(portletId);
  Portlet portlet=PortletUtil.fetchByC_P(companyId,portletId);
  if (portlet == null) {
    long id=CounterLocalServiceUtil.increment();
    portlet=PortletUtil.create(id);
    portlet.setCompanyId(companyId);
    portlet.setPortletId(portletId);
  }
  portlet.setRoles(roles);
  portlet.setActive(active);
  PortletUtil.update(portlet);
  portlet=getPortletById(companyId,portletId);
  portlet.setRoles(roles);
  portlet.setActive(active);
  return portlet;
}
