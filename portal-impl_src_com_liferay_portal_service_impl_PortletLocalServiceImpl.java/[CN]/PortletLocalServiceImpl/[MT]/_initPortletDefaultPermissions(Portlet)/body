{
  long companyId=portlet.getCompanyId();
  String portletName=portlet.getRootPortletId();
  if (resourcePermissionLocalService.getResourcePermissionsCount(companyId,portletName,ResourceConstants.SCOPE_INDIVIDUAL,portletName) > 0) {
    return;
  }
  List<String> groupActions=ResourceActionsUtil.getPortletResourceGroupDefaultActions(portletName);
  Role siteMemberRole=roleLocalService.getRole(companyId,RoleConstants.SITE_MEMBER);
  resourcePermissionLocalService.setResourcePermissions(companyId,portletName,ResourceConstants.SCOPE_INDIVIDUAL,portletName,siteMemberRole.getRoleId(),groupActions.toArray(new String[0]));
  Role guestRole=roleLocalService.getRole(companyId,RoleConstants.GUEST);
  List<String> guestActions=ResourceActionsUtil.getPortletResourceGuestDefaultActions(portletName);
  resourcePermissionLocalService.setResourcePermissions(companyId,portletName,ResourceConstants.SCOPE_INDIVIDUAL,portletName,guestRole.getRoleId(),guestActions.toArray(new String[0]));
  Role ownerRole=roleLocalService.getRole(companyId,RoleConstants.OWNER);
  List<String> ownerActions=ResourceActionsUtil.getPortletResourceActions(portletName);
  resourcePermissionLocalService.setOwnerResourcePermissions(companyId,portletName,ResourceConstants.SCOPE_INDIVIDUAL,portletName,ownerRole.getRoleId(),0,ownerActions.toArray(new String[0]));
}
