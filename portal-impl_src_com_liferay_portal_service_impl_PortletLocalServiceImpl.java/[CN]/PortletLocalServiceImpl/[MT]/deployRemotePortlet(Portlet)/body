{
  PortletApp portletApp=_getPortletApp(StringPool.BLANK);
  remotePortlet.setPortletApp(portletApp);
  _getPortletsPool().put(remotePortlet.getPortletId(),remotePortlet);
  _clearCaches();
  long[] companyIds=PortalInstances.getCompanyIds();
  PortletCategory newPortletCategory=new PortletCategory();
  PortletCategory wsrpCategory=new PortletCategory(_WSRP_CATEGORY);
  newPortletCategory.addCategory(wsrpCategory);
  wsrpCategory.getPortletIds().add(remotePortlet.getPortletId());
  for (int i=0; i < companyIds.length; i++) {
    long companyId=companyIds[i];
    PortletCategory portletCategory=(PortletCategory)WebAppPool.get(String.valueOf(companyId),WebKeys.PORTLET_CATEGORY);
    if (portletCategory != null) {
      portletCategory.merge(newPortletCategory);
    }
 else {
      _log.error("Unable to register remote portlet for company " + companyId + " because it does not exist");
    }
  }
  return remotePortlet;
}
