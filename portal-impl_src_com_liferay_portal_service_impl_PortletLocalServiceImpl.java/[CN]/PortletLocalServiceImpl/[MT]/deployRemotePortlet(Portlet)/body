{
  long companyId=portlet.getCompanyId();
  Map<String,Portlet> portletsPool=_getPortletsPool(companyId);
  portletsPool.put(portlet.getRootPortletId(),portlet);
  _clearCaches();
  PortletCategory newPortletCategory=new PortletCategory();
  PortletCategory wsrpCategory=new PortletCategory(_WSRP_CATEGORY);
  newPortletCategory.addCategory(wsrpCategory);
  wsrpCategory.getPortletIds().add(portlet.getPortletId());
  PortletCategory portletCategory=(PortletCategory)WebAppPool.get(String.valueOf(companyId),WebKeys.PORTLET_CATEGORY);
  if (portletCategory != null) {
    portletCategory.merge(newPortletCategory);
  }
 else {
    _log.error("Unable to register remote portlet for company " + companyId + " because it does not exist");
  }
  return portlet;
}
