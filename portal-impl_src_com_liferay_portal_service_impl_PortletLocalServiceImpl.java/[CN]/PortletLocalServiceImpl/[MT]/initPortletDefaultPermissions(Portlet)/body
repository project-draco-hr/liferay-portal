{
  long companyId=portlet.getCompanyId();
  String rootPortletId=portlet.getRootPortletId();
  int count=resourcePermissionLocalService.getResourcePermissionsCount(companyId,rootPortletId,ResourceConstants.SCOPE_INDIVIDUAL,rootPortletId);
  if (count > 0) {
    return;
  }
  Role guestRole=roleLocalService.getRole(companyId,RoleConstants.GUEST);
  List<String> guestActions=ResourceActionsUtil.getPortletResourceGuestDefaultActions(rootPortletId);
  resourcePermissionLocalService.setResourcePermissions(companyId,rootPortletId,ResourceConstants.SCOPE_INDIVIDUAL,rootPortletId,guestRole.getRoleId(),guestActions.toArray(new String[0]));
  Role ownerRole=roleLocalService.getRole(companyId,RoleConstants.OWNER);
  List<String> ownerActionIds=ResourceActionsUtil.getPortletResourceActions(rootPortletId);
  resourcePermissionLocalService.setOwnerResourcePermissions(companyId,rootPortletId,ResourceConstants.SCOPE_INDIVIDUAL,rootPortletId,ownerRole.getRoleId(),0,ownerActionIds.toArray(new String[0]));
  Role siteMemberRole=roleLocalService.getRole(companyId,RoleConstants.SITE_MEMBER);
  List<String> groupActionIds=ResourceActionsUtil.getPortletResourceGroupDefaultActions(rootPortletId);
  resourcePermissionLocalService.setResourcePermissions(companyId,rootPortletId,ResourceConstants.SCOPE_INDIVIDUAL,rootPortletId,siteMemberRole.getRoleId(),groupActionIds.toArray(new String[0]));
}
