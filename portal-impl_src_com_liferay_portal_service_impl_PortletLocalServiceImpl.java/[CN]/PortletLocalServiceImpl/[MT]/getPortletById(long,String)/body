{
  portletId=PortalUtil.getJsSafePortletId(portletId);
  Portlet portlet=null;
  Map<String,Portlet> companyPortletsPool=_getPortletsPool(companyId);
  String rootPortletId=PortletConstants.getRootPortletId(portletId);
  if (portletId.equals(rootPortletId)) {
    portlet=companyPortletsPool.get(portletId);
  }
 else {
    portlet=companyPortletsPool.get(rootPortletId);
    if (portlet != null) {
      portlet=portlet.getClonedInstance(portletId);
    }
  }
  if ((portlet == null) && (!portletId.equals(PortletKeys.LIFERAY_PORTAL))) {
    if (_portletsPool.isEmpty()) {
      if (_log.isDebugEnabled()) {
        _log.debug("No portlets are installed");
      }
    }
 else {
      if (_log.isWarnEnabled()) {
        _log.warn("Portlet not found for " + companyId + " "+ portletId);
      }
    }
  }
  return portlet;
}
