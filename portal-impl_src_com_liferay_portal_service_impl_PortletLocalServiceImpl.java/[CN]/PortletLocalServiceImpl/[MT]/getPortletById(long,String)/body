{
  portletId=PortalUtil.getJsSafePortletId(portletId);
  Portlet portlet=null;
  Map companyPortletsPool=_getPortletsPool(companyId);
  String rootPortletId=PortletImpl.getRootPortletId(portletId);
  if (portletId.equals(rootPortletId)) {
    portlet=(Portlet)companyPortletsPool.get(portletId);
  }
 else {
    portlet=(Portlet)companyPortletsPool.get(rootPortletId);
    if (portlet != null) {
      portlet=portlet.getClonedInstance(portletId);
    }
  }
  if ((portlet == null) && (!portletId.equals(PortletKeys.LIFERAY_PORTAL))) {
    if (_log.isWarnEnabled()) {
      _log.warn("Portlet not found for " + companyId + " "+ portletId);
    }
  }
  return portlet;
}
