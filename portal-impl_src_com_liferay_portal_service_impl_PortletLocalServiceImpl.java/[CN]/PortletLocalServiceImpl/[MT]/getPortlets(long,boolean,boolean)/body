{
  Map<String,Portlet> portletsPool=_getPortletsPool(companyId);
  List<Portlet> portlets=ListUtil.fromCollection(portletsPool.values());
  if (!showSystem || !showPortal) {
    Iterator<Portlet> itr=portlets.iterator();
    while (itr.hasNext()) {
      Portlet portlet=itr.next();
      if (showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
      }
 else       if (!showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
        itr.remove();
      }
 else       if (!showSystem && portlet.isSystem()) {
        itr.remove();
      }
    }
  }
  return portlets;
}
