{
  Map<String,Portlet> portletsMap=getPortletsMap(companyId);
  List<Portlet> portlets=ListUtil.fromMapValues(portletsMap);
  if (showSystem && showPortal) {
    return portlets;
  }
  Iterator<Portlet> itr=portlets.iterator();
  while (itr.hasNext()) {
    Portlet portlet=itr.next();
    if (showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
    }
 else     if (!showPortal && portlet.getPortletId().equals(PortletKeys.PORTAL)) {
      itr.remove();
    }
 else     if (!showSystem && portlet.isSystem()) {
      itr.remove();
    }
  }
  return portlets;
}
