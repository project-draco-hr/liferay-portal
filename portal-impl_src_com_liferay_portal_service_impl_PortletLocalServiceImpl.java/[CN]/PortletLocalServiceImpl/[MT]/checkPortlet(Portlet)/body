{
  if (portlet.isSystem()) {
    return;
  }
  String[] roleNames=portlet.getRolesArray();
  if (roleNames.length == 0) {
    return;
  }
  long companyId=portlet.getCompanyId();
  String name=portlet.getPortletId();
  int scope=ResourceConstants.SCOPE_COMPANY;
  String primKey=String.valueOf(companyId);
  String actionId=ActionKeys.ADD_TO_PAGE;
  for (  String roleName : roleNames) {
    Role role=roleLocalService.getRole(companyId,roleName);
    if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
      resourcePermissionLocalService.addResourcePermission(companyId,name,scope,primKey,role.getRoleId(),actionId);
    }
 else {
      permissionLocalService.setRolePermission(role.getRoleId(),companyId,name,scope,primKey,actionId);
    }
  }
  updatePortlet(companyId,portlet.getPortletId(),StringPool.BLANK,portlet.isActive());
}
