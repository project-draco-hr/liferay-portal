{
  MBMessage parentMessage=MBTestUtil.addMessage(_group.getGroupId());
  Thread.sleep(2000);
  MBMessage firstReplyMessage=MBTestUtil.addMessage(_group.getGroupId(),parentMessage.getCategoryId(),parentMessage.getThreadId(),parentMessage.getMessageId());
  Thread.sleep(2000);
  MBMessage secondReplyMessage=MBTestUtil.addMessage(_group.getGroupId(),parentMessage.getCategoryId(),parentMessage.getThreadId(),parentMessage.getMessageId());
  MBMessageLocalServiceUtil.deleteMessage(secondReplyMessage.getMessageId());
  Date lastMessageModifiedDate=firstReplyMessage.getModifiedDate();
  MBThread mbThread=parentMessage.getThread();
  Date mbThreadLastPostDate=mbThread.getLastPostDate();
  Assert.assertTrue(mbThreadLastPostDate.getTime() == (lastMessageModifiedDate.getTime() / 1000) * 1000);
}
