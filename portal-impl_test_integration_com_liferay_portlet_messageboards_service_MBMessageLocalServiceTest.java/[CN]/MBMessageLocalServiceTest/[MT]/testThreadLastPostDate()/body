{
  MBMessage parentMessage=MBTestUtil.addMessage(_group.getGroupId());
  Thread.sleep(2000);
  MBMessage firstReplyMessage=MBTestUtil.addMessage(_group.getGroupId(),parentMessage.getCategoryId(),parentMessage.getThreadId(),parentMessage.getMessageId());
  Thread.sleep(2000);
  MBMessage secondReplyMessage=MBTestUtil.addMessage(_group.getGroupId(),parentMessage.getCategoryId(),parentMessage.getThreadId(),parentMessage.getMessageId());
  DateFormat dateFormat=DateFormatFactoryUtil.getSimpleDateFormat(PropsValues.INDEX_DATE_FORMAT_PATTERN);
  MBThread mbThread=parentMessage.getThread();
  Assert.assertEquals(dateFormat.format(mbThread.getLastPostDate()),dateFormat.format(secondReplyMessage.getModifiedDate()));
  MBMessageLocalServiceUtil.deleteMessage(secondReplyMessage.getMessageId());
  Assert.assertEquals(dateFormat.format(mbThread.getLastPostDate()),dateFormat.format(firstReplyMessage.getModifiedDate()));
}
