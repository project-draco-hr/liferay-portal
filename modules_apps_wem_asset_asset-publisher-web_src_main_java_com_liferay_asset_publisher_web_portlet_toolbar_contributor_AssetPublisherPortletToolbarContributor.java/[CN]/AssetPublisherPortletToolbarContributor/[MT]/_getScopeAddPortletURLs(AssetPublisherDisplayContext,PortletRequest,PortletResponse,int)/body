{
  long[] groupIds=assetPublisherDisplayContext.getGroupIds();
  if (groupIds.length == 0) {
    return Collections.emptyMap();
  }
  Map<Long,Map<String,PortletURL>> scopeAddPortletURLs=new HashMap();
  LiferayPortletResponse liferayPortletResponse=(LiferayPortletResponse)portletResponse;
  PortletURL redirectURL=liferayPortletResponse.createRenderURL();
  redirectURL.setParameter("hideDefaultSuccessMessage",Boolean.TRUE.toString());
  redirectURL.setParameter("mvcPath","/add_asset_redirect.jsp");
  LiferayPortletRequest liferayPortletRequest=(LiferayPortletRequest)portletRequest;
  PortletURL currentURLObj=PortletURLUtil.getCurrent(liferayPortletRequest,liferayPortletResponse);
  redirectURL.setParameter("redirect",currentURLObj.toString());
  redirectURL.setWindowState(LiferayWindowState.POP_UP);
  String redirect=redirectURL.toString();
  for (  long groupId : groupIds) {
    Map<String,PortletURL> addPortletURLs=AssetUtil.getAddPortletURLs(liferayPortletRequest,liferayPortletResponse,groupId,assetPublisherDisplayContext.getClassNameIds(),assetPublisherDisplayContext.getClassTypeIds(),assetPublisherDisplayContext.getAllAssetCategoryIds(),assetPublisherDisplayContext.getAllAssetTagNames(),redirect);
    if (MapUtil.isNotEmpty(addPortletURLs)) {
      scopeAddPortletURLs.put(groupId,addPortletURLs);
    }
    if (scopeAddPortletURLs.size() > max) {
      break;
    }
  }
  return scopeAddPortletURLs;
}
