{
  BlockingQueue<Datagram> sendingQueue=new LinkedBlockingQueue<Datagram>();
  ChannelContext channelContext=new ChannelContext(sendingQueue);
  ReadingCallable readingCallable=new ReadingCallable(scatteringByteChannel,channelContext);
  WritingCallable writingCallable=new WritingCallable(gatheringByteChannel,channelContext);
  Future<Void> readFuture=executorService.submit(readingCallable);
  Future<Void> writeFuture=executorService.submit(writingCallable);
  FutureRegistrationReference futureRegistrationReference=new FutureRegistrationReference(this,channelContext,readFuture,writeFuture);
  channelContext.setRegistrationReference(futureRegistrationReference);
  readingCallable.openLatch();
  writingCallable.openLatch();
  return futureRegistrationReference;
}
