{
  if (name.indexOf(StringPool.PERIOD) != -1) {
    List actions=ResourceActionsUtil.getModelResourceGuestUnsupportedActions(name);
    if (actions.contains(actionId)) {
      return false;
    }
  }
 else {
    List actions=ResourceActionsUtil.getPortletResourceGuestUnsupportedActions(name);
    if (actions.contains(actionId)) {
      return false;
    }
  }
  long companyId=user.getCompanyId();
  Group guestGroup=GroupServiceUtil.getGroup(companyId,GroupImpl.GUEST);
  long[] resourceIds=getResourceIds(companyId,guestGroup.getGroupId(),name,primKey,actionId);
  PermissionCheckerBag bag=getBag(GUEST_GROUP_BAG_ID);
  if (bag == null) {
    List groups=new ArrayList();
    groups.add(guestGroup);
    List roles=RoleServiceUtil.getUserRoles(user.getUserId());
    roles.addAll(RoleServiceUtil.getGroupRoles(guestGroup.getGroupId()));
    bag=new PermissionCheckerBagImpl(defaultUserId,new ArrayList(),new ArrayList(),new ArrayList(),new ArrayList(),groups,roles);
    putBag(GUEST_GROUP_BAG_ID,bag);
  }
  try {
    return PermissionServiceUtil.hasUserPermissions(defaultUserId,guestGroup.getGroupId(),actionId,resourceIds,bag);
  }
 catch (  Exception e) {
    return false;
  }
}
