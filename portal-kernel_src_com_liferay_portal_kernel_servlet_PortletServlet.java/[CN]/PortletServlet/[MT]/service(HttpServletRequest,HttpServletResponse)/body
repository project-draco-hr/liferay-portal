{
  PortletRequest portletRequest=(PortletRequest)request.getAttribute(JavaConstants.JAVAX_PORTLET_REQUEST);
  PortletResponse portletResponse=(PortletResponse)request.getAttribute(JavaConstants.JAVAX_PORTLET_RESPONSE);
  FilterChain filterChain=(FilterChain)request.getAttribute(PORTLET_SERVLET_FILTER_CHAIN);
  LiferayPortletSession portletSession=(LiferayPortletSession)portletRequest.getPortletSession();
  portletRequest.setAttribute(PORTLET_SERVLET_CONFIG,getServletConfig());
  portletRequest.setAttribute(PORTLET_SERVLET_REQUEST,request);
  portletRequest.setAttribute(PORTLET_SERVLET_RESPONSE,response);
  HttpSession session=request.getSession();
  PortletSessionTracker.add(session);
  portletSession.setHttpSession(session);
  try {
    if (portletRequest instanceof ActionRequest) {
      ActionRequest actionRequest=(ActionRequest)portletRequest;
      ActionResponse actionResponse=(ActionResponse)portletResponse;
      filterChain.doFilter(actionRequest,actionResponse);
    }
 else     if (portletRequest instanceof EventRequest) {
      EventRequest eventRequest=(EventRequest)portletRequest;
      EventResponse eventResponse=(EventResponse)portletResponse;
      filterChain.doFilter(eventRequest,eventResponse);
    }
 else     if (portletRequest instanceof RenderRequest) {
      RenderRequest renderRequest=(RenderRequest)portletRequest;
      RenderResponse renderResponse=(RenderResponse)portletResponse;
      filterChain.doFilter(renderRequest,renderResponse);
    }
 else     if (portletRequest instanceof ResourceRequest) {
      ResourceRequest resourceRequest=(ResourceRequest)portletRequest;
      ResourceResponse resourceResponse=(ResourceResponse)portletResponse;
      filterChain.doFilter(resourceRequest,resourceResponse);
    }
  }
 catch (  PortletException pe) {
    _log.error(pe,pe);
    throw new ServletException(pe);
  }
}
