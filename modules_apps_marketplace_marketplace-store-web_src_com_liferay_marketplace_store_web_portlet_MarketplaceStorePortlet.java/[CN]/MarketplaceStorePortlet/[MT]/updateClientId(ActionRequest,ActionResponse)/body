{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (!themeDisplay.isSignedIn()) {
    return;
  }
  String clientId=ParamUtil.getString(actionRequest,"clientId");
  String token=ParamUtil.getString(actionRequest,"token");
  String decodedClientId=MarketplaceUtil.decodeClientId(clientId,token);
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  jsonObject.put("cmd","updateClientId");
  if (Validator.isNull(decodedClientId)) {
    jsonObject.put("message","fail");
    writeJSON(actionRequest,actionResponse,jsonObject);
    return;
  }
  ExpandoValueLocalServiceUtil.addValue(themeDisplay.getCompanyId(),User.class.getName(),"MP","clientId",themeDisplay.getUserId(),decodedClientId);
  jsonObject.put("message","success");
  writeJSON(actionRequest,actionResponse,jsonObject);
}
