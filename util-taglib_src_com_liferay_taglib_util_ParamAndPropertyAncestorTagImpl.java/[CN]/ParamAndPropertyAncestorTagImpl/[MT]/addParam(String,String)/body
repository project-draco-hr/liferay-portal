{
  DynamicServletRequest dynamicServletRequest=null;
  if (request instanceof DynamicServletRequest) {
    dynamicServletRequest=(DynamicServletRequest)request;
  }
 else {
    dynamicServletRequest=new DynamicServletRequest(request);
    request=dynamicServletRequest;
  }
  Map<String,String[]> params=dynamicServletRequest.getDynamicParameterMap();
  if (!_allowEmptyParam && ((value == null) || (value.length() == 0))) {
    params.remove(name);
    if (_removedParameterNames == null) {
      _removedParameterNames=new HashSet<String>();
    }
    _removedParameterNames.add(name);
    return;
  }
  String[] values=params.get(name);
  if (values == null) {
    values=new String[]{value};
  }
 else {
    String[] newValues=new String[values.length + 1];
    System.arraycopy(values,0,newValues,0,values.length);
    newValues[newValues.length - 1]=value;
    values=newValues;
  }
  params.put(name,values);
}
