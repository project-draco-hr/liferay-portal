{
  String strutsAction=ParamUtil.getString(request,"struts_action");
  boolean selectCategory=strutsAction.equals("/message_boards/select_category") || strutsAction.equals("/message_boards_admin/select_category");
  PortletURL portletURL=renderResponse.createRenderURL();
  if (selectCategory) {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    portletURL.setParameter("struts_action","/message_boards/select_category");
    PortalUtil.addPortletBreadcrumbEntry(request,themeDisplay.translate("categories"),portletURL.toString());
  }
 else {
    portletURL.setParameter("struts_action","/message_boards/view");
  }
  List<MBCategory> ancestorCategories=category.getAncestors();
  Collections.reverse(ancestorCategories);
  for (  MBCategory curCategory : ancestorCategories) {
    portletURL.setParameter("mbCategoryId",String.valueOf(curCategory.getCategoryId()));
    PortalUtil.addPortletBreadcrumbEntry(request,curCategory.getName(),portletURL.toString());
  }
  portletURL.setParameter("mbCategoryId",String.valueOf(category.getCategoryId()));
  PortalUtil.addPortletBreadcrumbEntry(request,category.getName(),portletURL.toString());
}
