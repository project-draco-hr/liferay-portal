{
  Callable<Void> callable=new Callable<Void>(){
    @Override public Void call() throws Exception {
      MBCategory category=MBCategoryLocalServiceUtil.fetchMBCategory(categoryId);
      if (category == null) {
        return null;
      }
      int messageCount=_getMessageCount(category);
      int threadCount=MBThreadLocalServiceUtil.getCategoryThreadsCount(category.getGroupId(),category.getCategoryId(),WorkflowConstants.STATUS_APPROVED);
      category.setMessageCount(messageCount);
      category.setThreadCount(threadCount);
      MBCategoryLocalServiceUtil.updateMBCategory(category);
      return null;
    }
  }
;
  TransactionCommitCallbackRegistryUtil.registerCallback(callable);
}
