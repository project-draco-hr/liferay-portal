{
  if (!portletDataContext.isWithinDateRange(event.getModifiedDate())) {
    return;
  }
  String path=getEventPath(portletDataContext,event);
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  Element eventElement=rootElement.addElement("event");
  eventElement.addAttribute("path",path);
  event.setUserUuid(event.getUserUuid());
  portletDataContext.addPermissions(CalEvent.class,event.getEventId());
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"categories")) {
    portletDataContext.addAssetCategories(CalEvent.class,event.getEventId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"comments")) {
    portletDataContext.addComments(CalEvent.class,event.getEventId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"ratings")) {
    portletDataContext.addRatingsEntries(CalEvent.class,event.getEventId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"tags")) {
    portletDataContext.addAssetTags(CalEvent.class,event.getEventId());
  }
  portletDataContext.addZipEntry(path,eventElement,event);
}
