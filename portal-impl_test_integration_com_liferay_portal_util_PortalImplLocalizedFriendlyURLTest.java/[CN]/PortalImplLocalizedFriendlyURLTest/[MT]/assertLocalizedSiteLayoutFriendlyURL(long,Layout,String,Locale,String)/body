{
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  String groupFriendlyURL=group.getFriendlyURL();
  String groupServletMapping=_PUBLIC_GROUP_SERVLET_MAPPING;
  if (layout.isPrivateLayout()) {
    groupServletMapping=_PRIVATE_GROUP_SERVLET_MAPPING;
  }
  MockHttpServletRequest mockHttpServletRequest=new MockHttpServletRequest();
  mockHttpServletRequest.setRequestURI(groupServletMapping + groupFriendlyURL + layoutFriendlyURL);
  mockHttpServletRequest.setPathInfo(groupFriendlyURL + layoutFriendlyURL);
  String localizedFriendlyURL=PortalUtil.getLocalizedFriendlyURL(mockHttpServletRequest,layout,locale);
  StringBundler sb=new StringBundler();
  sb.append(StringPool.SLASH);
  sb.append(PortalUtil.getI18nPathLanguageId(locale,StringPool.BLANK));
  sb.append(groupServletMapping);
  sb.append(group.getFriendlyURL());
  sb.append(expectedLayoutFriendlyURL);
  Assert.assertEquals(sb.toString(),localizedFriendlyURL);
}
