{
  MockHttpServletRequest mockHttpServletRequest=new MockHttpServletRequest();
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  mockHttpServletRequest.setPathInfo(group.getFriendlyURL() + layoutFriendlyURL);
  String groupServletMapping=_PUBLIC_GROUP_SERVLET_MAPPING;
  if (layout.isPrivateLayout()) {
    groupServletMapping=_PRIVATE_GROUP_SERVLET_MAPPING;
  }
  mockHttpServletRequest.setRequestURI(groupServletMapping + group.getFriendlyURL() + layoutFriendlyURL);
  StringBundler sb=new StringBundler(includeI18nPath ? 5 : 3);
  if (includeI18nPath) {
    sb.append(StringPool.SLASH);
    sb.append(PortalUtil.getI18nPathLanguageId(locale,StringPool.BLANK));
  }
  sb.append(groupServletMapping);
  sb.append(group.getFriendlyURL());
  sb.append(expectedLayoutFriendlyURL);
  String localizedFriendlyURL=PortalUtil.getLocalizedFriendlyURL(mockHttpServletRequest,layout,locale,originalLocale);
  Assert.assertEquals(sb.toString(),localizedFriendlyURL);
}
