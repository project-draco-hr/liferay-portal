{
  PortletPreferences prefs=req.getPreferences();
  String folderName=ParamUtil.getString(req,"folder_name");
  String newFolderName=ParamUtil.getString(req,"folder_name_2");
  if (Validator.isNotNull(folderName)) {
    List list=ListUtil.fromArray(prefs.getValues("folder-names",new String[0]));
    list.remove(folderName);
    list.add(newFolderName);
    Collections.sort(list,new StringComparator());
    prefs.setValues("folder-names",(String[])list.toArray(new String[0]));
    MailUtil.renameFolder(req,folderName,newFolderName);
  }
  prefs.store();
  SessionMessages.add(req,EditFolderAction.class.getName());
  res.sendRedirect(ParamUtil.getString(req,"redirect"));
}
