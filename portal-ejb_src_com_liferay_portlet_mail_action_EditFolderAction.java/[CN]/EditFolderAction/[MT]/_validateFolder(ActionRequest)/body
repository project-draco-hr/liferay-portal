{
  String folderName=ParamUtil.getString(req,"folder_name");
  String newFolderName=ParamUtil.getString(req,"folder_name_2");
  if (!MailUtil.isValidFolderName(folderName)) {
    SessionErrors.add(req,"folder_name_invalid");
  }
  if (!MailUtil.isValidFolderName(newFolderName)) {
    SessionErrors.add(req,"new_folder_name_invalid");
  }
  if ((MailUtil.isValidFolderName(folderName)) && (MailUtil.isValidFolderName(newFolderName))) {
    if (!folderName.equals(MailUtil.MAIL_INBOX_NAME)) {
      if (!folderName.startsWith(MailUtil.MAIL_BOX_STYLE)) {
        folderName=MailUtil.MAIL_BOX_STYLE + folderName;
      }
    }
    if (!newFolderName.equals(MailUtil.MAIL_INBOX_NAME)) {
      if (!newFolderName.startsWith(MailUtil.MAIL_BOX_STYLE)) {
        newFolderName=MailUtil.MAIL_BOX_STYLE + newFolderName;
      }
    }
    FolderPool folderPool=MailUtil.getFolderPool(req);
    if (folderPool.get(folderName) == null) {
      SessionErrors.add(req,"folder_name_dne");
    }
    if (folderPool.get(newFolderName) != null) {
      SessionErrors.add(req,"new_folder_name_already_taken");
    }
    if ((newFolderName.equalsIgnoreCase(MailUtil.MAIL_INBOX_NAME)) || (newFolderName.equalsIgnoreCase(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_INBOX_NAME)) || (newFolderName.equalsIgnoreCase(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_JUNK_NAME))|| (newFolderName.equalsIgnoreCase(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_SENT_NAME))|| (newFolderName.equalsIgnoreCase(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_DRAFTS_NAME))|| (newFolderName.equalsIgnoreCase(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_TRASH_NAME))|| (newFolderName.indexOf(StringPool.COMMA) != -1)) {
      SessionErrors.add(req,"new_folder_name_invalid");
    }
  }
}
