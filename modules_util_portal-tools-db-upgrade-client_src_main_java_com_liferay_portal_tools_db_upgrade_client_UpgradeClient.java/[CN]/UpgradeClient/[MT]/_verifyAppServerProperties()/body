{
  String value=_appServerProperties.getProperty("dir");
  if ((value == null) || value.isEmpty()) {
    String response=null;
    while (_appServer == null) {
      System.out.print("[ ");
      for (      String appServer : _appServers.keySet()) {
        System.out.print(appServer + " ");
      }
      System.out.println("]");
      System.out.println("Please enter your application server (tomcat): ");
      response=_consoleReader.readLine();
      if (response.isEmpty()) {
        response="tomcat";
      }
      _appServer=_appServers.get(response);
      if (_appServer == null) {
        System.err.println(response + " is an unsupported application server.");
      }
    }
    File dir=_appServer.getDir();
    File globalLibDir=_appServer.getGlobalLibDir();
    File portalDir=_appServer.getPortalDir();
    List<File> serverDirs=_appServer.getExtraDirs();
    System.out.println("Please enter your application server directory (" + dir + "): ");
    response=_consoleReader.readLine();
    if (!response.isEmpty()) {
      _appServer.setDirName(response);
    }
    System.out.println("Please enter your global library directory (" + globalLibDir + "): ");
    response=_consoleReader.readLine();
    if (!response.isEmpty()) {
      _appServer.setGlobalLibDirName(response);
    }
    System.out.println("Please enter your portal directory (" + portalDir + "): ");
    response=_consoleReader.readLine();
    if (!response.isEmpty()) {
      _appServer.setPortalDirName(response);
    }
    System.out.println("Please enter a comma delimited list of any extra directories" + " you need for the upgrade (" + _appServer.getServerDirNames() + "): ");
    response=_consoleReader.readLine();
    if (!response.isEmpty()) {
      _appServer.setExtraDirNames(response);
    }
    _appServerProperties.setProperty("dir",dir.getCanonicalPath());
    _appServerProperties.setProperty("global.lib.dir",_getRelativePath(dir,globalLibDir));
    _appServerProperties.setProperty("portal.dir",_getRelativePath(dir,portalDir));
    _appServerProperties.setProperty("server.dirs",StringUtil.join(_getRelativePaths(dir,serverDirs),','));
  }
 else {
    _appServer=new AppServer(value,_appServerProperties.getProperty("extra.dirs"),_appServerProperties.getProperty("global.lib.dir"),_appServerProperties.getProperty("portal.dir"));
  }
}
