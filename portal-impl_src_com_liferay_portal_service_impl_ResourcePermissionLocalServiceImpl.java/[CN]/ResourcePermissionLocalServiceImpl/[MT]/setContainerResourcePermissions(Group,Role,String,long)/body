{
  long companyId=group.getCompanyId();
  int scope=ResourceConstants.SCOPE_INDIVIDUAL;
  String primKey=String.valueOf(group.getGroupId());
  if (resourcePermissionPersistence.countByC_N_S_P(companyId,name,scope,primKey) == 0) {
    return;
  }
  ResourcePermission resourcePermission=resourcePermissionPersistence.fetchByC_N_S_P_R(companyId,name,scope,primKey,role.getRoleId());
  if (resourcePermission == null) {
    long resourcePermissionId=counterLocalService.increment(ResourcePermission.class.getName());
    resourcePermission=resourcePermissionPersistence.create(resourcePermissionId);
    resourcePermission.setCompanyId(companyId);
    resourcePermission.setName(name);
    resourcePermission.setScope(scope);
    resourcePermission.setPrimKey(primKey);
    resourcePermission.setRoleId(role.getRoleId());
    List<String> defaultActionIds=null;
    String roleName=role.getName();
    if (roleName.equals(RoleConstants.GUEST)) {
      defaultActionIds=ResourceActionsUtil.getModelResourceGuestDefaultActions(name);
    }
 else     if (roleName.equals(RoleConstants.OWNER)) {
      defaultActionIds=ResourceActionsUtil.getModelResourceOwnerDefaultActions(name);
    }
 else     if (roleName.equals(RoleConstants.SITE_MEMBER) || roleName.equals(RoleConstants.ORGANIZATION_USER)) {
      defaultActionIds=ResourceActionsUtil.getModelResourceGroupDefaultActions(name);
    }
    List<ResourceAction> resourceActions=resourceActionLocalService.getResourceActions(name);
    for (    ResourceAction resourceAction : resourceActions) {
      if (defaultActionIds.contains(resourceAction.getActionId())) {
        actionIdsLong|=resourceAction.getBitwiseValue();
      }
    }
  }
 else {
    actionIdsLong|=resourcePermission.getActionIds();
  }
  resourcePermission.setActionIds(actionIdsLong);
  resourcePermissionPersistence.update(resourcePermission,false);
}
