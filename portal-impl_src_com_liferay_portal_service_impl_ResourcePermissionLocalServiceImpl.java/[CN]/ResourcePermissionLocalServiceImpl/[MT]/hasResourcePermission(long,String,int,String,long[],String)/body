{
  ResourceAction resourceAction=resourceActionLocalService.getResourceAction(name,actionId);
  DB db=DBFactoryUtil.getDB();
  String dbType=db.getType();
  if ((roleIds.length > PropsValues.PERMISSIONS_ROLE_RESOURCE_PERMISSION_QUERY_THRESHOLD) && !dbType.equals(DB.TYPE_DERBY) && !dbType.equals(DB.TYPE_JDATASTORE)&& !dbType.equals(DB.TYPE_SAP)) {
    int count=resourcePermissionFinder.countByC_N_S_P_R_A(companyId,name,scope,primKey,roleIds,resourceAction.getBitwiseValue());
    if (count > 0) {
      return true;
    }
  }
 else {
    List<ResourcePermission> resourcePermissions=resourcePermissionPersistence.findByC_N_S_P_R(companyId,name,scope,primKey,roleIds);
    if (resourcePermissions.isEmpty()) {
      return false;
    }
    for (    ResourcePermission resourcePermission : resourcePermissions) {
      if (hasActionId(resourcePermission,resourceAction)) {
        return true;
      }
    }
  }
  return false;
}
