{
  if (scope == ResourceConstants.SCOPE_COMPANY) {
    unsetResourcePermissions(roleId,companyId,name,ResourceConstants.SCOPE_GROUP,actionId);
  }
 else   if (scope == ResourceConstants.SCOPE_GROUP) {
    unsetResourcePermissions(roleId,companyId,name,ResourceConstants.SCOPE_COMPANY,actionId);
  }
 else   if (scope == ResourceConstants.SCOPE_INDIVIDUAL) {
    throw new NoSuchResourcePermissionException();
  }
  Resource resource=resourceLocalService.addResource(companyId,name,scope,primKey);
  long resourceId=resource.getResourceId();
  updateResourcePermission(roleId,new String[]{actionId},resource.getResourceId(),ResourcePermissionConstants.OPERATOR_ADD);
  PermissionCacheUtil.clearCache();
}
