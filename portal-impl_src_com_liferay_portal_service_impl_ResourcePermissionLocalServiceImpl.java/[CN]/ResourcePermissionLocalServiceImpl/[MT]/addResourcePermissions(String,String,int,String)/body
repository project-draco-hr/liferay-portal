{
  List<ResourcePermission> resourcePermissions=resourcePermissionPersistence.findByN_S(resourceName,scope);
  List<Role> roles=rolePersistence.findByName(roleName);
  for (  ResourcePermission resourcePermission : resourcePermissions) {
    long companyId=resourcePermission.getCompanyId();
    String primKey=resourcePermission.getPrimKey();
    for (    Role role : roles) {
      long roleId=role.getRoleId();
      List<String> actionIds=getAvailableResourcePermissionActionIds(companyId,resourceName,scope,primKey,roleId,ResourceActionsUtil.getResourceActions(resourceName));
      if (actionIds == (List<?>)Collections.emptyList()) {
        actionIds=new ArrayList<String>();
      }
      actionIds.add(actionId);
      setResourcePermissions(companyId,resourceName,scope,primKey,roleId,actionIds.toArray(new String[actionIds.size()]));
    }
  }
}
