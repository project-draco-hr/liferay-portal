{
  List<Role> roles=rolePersistence.findByName(roleName);
  for (  Role role : roles) {
    long roleId=role.getRoleId();
    List<ResourcePermission> resourcePermissions=resourcePermissionPersistence.findByN_R_S(resourceName,roleId,scope);
    for (    ResourcePermission resourcePermission : resourcePermissions) {
      long companyId=resourcePermission.getCompanyId();
      String primKey=resourcePermission.getPrimKey();
      List<String> actionIds=getAvailableResourcePermissionActionIds(companyId,resourceName,scope,primKey,roleId,ResourceActionsUtil.getResourceActions(resourceName));
      if (actionIds == (List<?>)Collections.emptyList()) {
        actionIds=new ArrayList<String>();
      }
      actionIds.add(actionId);
      setResourcePermissions(companyId,resourceName,scope,primKey,roleId,actionIds.toArray(new String[actionIds.size()]));
    }
  }
}
