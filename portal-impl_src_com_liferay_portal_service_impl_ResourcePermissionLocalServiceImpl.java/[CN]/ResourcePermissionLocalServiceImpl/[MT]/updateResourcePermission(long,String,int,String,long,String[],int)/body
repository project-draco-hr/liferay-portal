{
  DB db=DBFactoryUtil.getDB();
  if (db.getType().equals(DB.TYPE_HYPERSONIC)) {
    doUpdateResourcePermission(companyId,name,scope,primKey,roleId,actionIds,operator);
    return;
  }
  StringBundler sb=new StringBundler(9);
  sb.append(companyId);
  sb.append(StringPool.POUND);
  sb.append(name);
  sb.append(StringPool.POUND);
  sb.append(scope);
  sb.append(StringPool.POUND);
  sb.append(primKey);
  sb.append(StringPool.POUND);
  sb.append(roleId);
  String groupName=getClass().getName();
  String key=sb.toString();
  Lock lock=LockRegistry.allocateLock(groupName,key);
  lock.lock();
  try {
    doUpdateResourcePermission(companyId,name,scope,primKey,roleId,actionIds,operator);
  }
  finally {
    lock.unlock();
    LockRegistry.freeLock(groupName,key);
  }
}
