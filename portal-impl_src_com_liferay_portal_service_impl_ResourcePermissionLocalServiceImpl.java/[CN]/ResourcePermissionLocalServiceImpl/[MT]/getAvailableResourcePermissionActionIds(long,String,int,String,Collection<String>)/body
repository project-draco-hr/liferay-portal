{
  if (actionIds.isEmpty()) {
    return Collections.emptyMap();
  }
  List<ResourcePermission> resourcePermissions=getResourcePermissions(companyId,name,scope,primKey);
  Map<Long,Set<String>> roleIdsToActionIds=new HashMap<>(resourcePermissions.size());
  for (  ResourcePermission resourcePermission : resourcePermissions) {
    if (resourcePermission.getActionIds() == 0) {
      Set<String> emptyActionIds=Collections.emptySet();
      roleIdsToActionIds.put(resourcePermission.getRoleId(),emptyActionIds);
      continue;
    }
    Set<String> availableActionIds=new HashSet<>(actionIds.size());
    for (    String actionId : actionIds) {
      if (resourcePermission.hasActionId(actionId)) {
        availableActionIds.add(actionId);
      }
    }
    if (availableActionIds.size() > 0) {
      roleIdsToActionIds.put(resourcePermission.getRoleId(),availableActionIds);
    }
  }
  return roleIdsToActionIds;
}
