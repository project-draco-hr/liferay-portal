{
  if (roleIds.length == 0) {
    return false;
  }
  int size=resources.size();
  if (size < 2) {
    throw new IllegalArgumentException("The list of resources must contain at least two values");
  }
  Resource individualResource=resources.get(0);
  if (individualResource.getScope() != ResourceConstants.SCOPE_INDIVIDUAL) {
    throw new IllegalArgumentException("The first resource must be an individual scope");
  }
  Resource companyResource=resources.get(size - 1);
  if (companyResource.getScope() != ResourceConstants.SCOPE_COMPANY) {
    throw new IllegalArgumentException("The last resource must be a company scope");
  }
  if (resourcePermissionPersistence.countByC_N_S_P(individualResource.getCompanyId(),individualResource.getName(),individualResource.getScope(),individualResource.getPrimKey()) < 1) {
    return false;
  }
  for (int i=size - 1; i >= 0; i--) {
    Resource resource=resources.get(i);
    if (hasResourcePermission(resource.getCompanyId(),resource.getName(),resource.getScope(),resource.getPrimKey(),roleIds,actionId)) {
      return true;
    }
  }
  return false;
}
