{
  int size=resources.size();
  if (size < 2) {
    throw new IllegalArgumentException("The list of resources must contain at least two values");
  }
  Resource firstResource=resources.get(0);
  if (firstResource.getScope() != ResourceConstants.SCOPE_INDIVIDUAL) {
    throw new IllegalArgumentException("The first resource must be individual scope");
  }
  Resource lastResource=resources.get(size - 1);
  if (lastResource.getScope() != ResourceConstants.SCOPE_COMPANY) {
    throw new IllegalArgumentException("The last resource must be company scope");
  }
  if (resourcePermissionPersistence.countByC_N_S_P(firstResource.getCompanyId(),firstResource.getName(),firstResource.getScope(),firstResource.getPrimKey()) < 1) {
    return false;
  }
  for (int i=size - 1; i >= 0; i--) {
    Resource resource=resources.get(i);
    if (hasResourcePermission(resource.getCompanyId(),resource.getName(),resource.getScope(),resource.getPrimKey(),roleIds,actionId)) {
      return true;
    }
  }
  return false;
}
