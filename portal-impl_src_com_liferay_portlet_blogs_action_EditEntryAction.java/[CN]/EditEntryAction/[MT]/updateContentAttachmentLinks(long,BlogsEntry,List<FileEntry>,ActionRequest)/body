{
  List<FileEntry> entryAttachments=new ArrayList<>(tempAttachments.size());
  String content=entry.getContent();
  for (  FileEntry tempAttachment : tempAttachments) {
    String fileName=ParamUtil.getString(actionRequest,"fileName",StringUtil.randomString());
    InputStream inputStream=tempAttachment.getContentStream();
    File file=null;
    try {
      file=FileUtil.createTempFile(inputStream);
      String mimeType=MimeTypesUtil.getContentType(file,fileName);
      FileEntry attachment=BlogsEntryServiceUtil.addEntryAttachment(groupId,entry.getEntryId(),fileName,file,mimeType);
      entryAttachments.add(attachment);
      ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
      content=StringUtil.replace(content,getTempAttachmentLink(tempAttachment,themeDisplay),getAttachmentLink(attachment,themeDisplay));
    }
 catch (    IOException ioe) {
      throw new SystemException("Unable to write temporary file",ioe);
    }
 finally {
      FileUtil.delete(file);
    }
  }
  return content;
}
