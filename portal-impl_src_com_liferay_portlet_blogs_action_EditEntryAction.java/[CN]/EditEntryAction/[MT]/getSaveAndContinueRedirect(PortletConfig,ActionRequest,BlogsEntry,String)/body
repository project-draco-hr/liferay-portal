{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String backURL=ParamUtil.getString(actionRequest,"backURL");
  String content=ParamUtil.getString(actionRequest,"content");
  String title=ParamUtil.getString(actionRequest,"title");
  boolean preview=ParamUtil.getBoolean(actionRequest,"preview");
  PortletURLImpl portletURL=new PortletURLImpl((ActionRequestImpl)actionRequest,portletConfig.getPortletName(),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
  portletURL.setWindowState(actionRequest.getWindowState());
  String portletName=portletConfig.getPortletName();
  if (portletName.equals(PortletKeys.BLOGS_ADMIN)) {
    portletURL.setParameter("struts_action","/blogs_admin/edit_entry");
  }
 else {
    portletURL.setParameter("struts_action","/blogs/edit_entry");
  }
  portletURL.setParameter(Constants.CMD,Constants.UPDATE,false);
  portletURL.setParameter("backURL",backURL,false);
  portletURL.setParameter("preview",String.valueOf(preview),false);
  portletURL.setParameter("redirect",redirect,false);
  if (entry != null) {
    portletURL.setParameter("entryId",String.valueOf(entry.getEntryId()),false);
    portletURL.setParameter("groupId",String.valueOf(entry.getGroupId()),false);
  }
 else {
    portletURL.setParameter("content",content,false);
    portletURL.setParameter("title",title,false);
  }
  return portletURL.toString();
}
