{
  if (!PrefsPropsUtil.getBoolean(PropsUtil.OPENOFFICE_SERVER_ENABLED,PropsValues.OPENOFFICE_SERVER_ENABLED)) {
    return null;
  }
  StringMaker sm=new StringMaker();
  sm.append(SystemProperties.get(SystemProperties.TMP_DIR));
  sm.append("/liferay/document_conversion/");
  sm.append(id);
  sm.append(StringPool.PERIOD);
  sm.append(targetExtension);
  String fileName=sm.toString();
  File file=new File(fileName);
  if (!file.exists()) {
    DocumentFormatRegistry registry=new DefaultDocumentFormatRegistry();
    DocumentConverter converter=_getConverter(registry);
    DocumentFormat inputFormat=registry.getFormatByFileExtension(sourceExtension);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    DocumentFormat outputFormat=registry.getFormatByFileExtension(targetExtension);
    converter.convert(is,inputFormat,baos,outputFormat);
    FileUtil.write(file,baos.toByteArray());
  }
  return new FileInputStream(file);
}
