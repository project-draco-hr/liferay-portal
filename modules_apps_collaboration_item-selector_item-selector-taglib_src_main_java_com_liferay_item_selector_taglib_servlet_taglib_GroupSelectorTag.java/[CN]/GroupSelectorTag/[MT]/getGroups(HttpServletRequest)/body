{
  if (_groups != null) {
    return _groups;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  User user=themeDisplay.getUser();
  String keywords=ParamUtil.getString(request,"keywords");
  int cur=ParamUtil.getInteger(request,SearchContainer.DEFAULT_CUR_PARAM,SearchContainer.DEFAULT_CUR);
  int delta=ParamUtil.getInteger(request,SearchContainer.DEFAULT_DELTA_PARAM,SearchContainer.DEFAULT_DELTA);
  int[] startAndEnd=SearchPaginationUtil.calculateStartAndEnd(cur,delta);
  if (Validator.isNotNull(keywords)) {
    LinkedHashMap<String,Object> groupParams=new LinkedHashMap<>();
    groupParams.put("site",Boolean.TRUE);
    groupParams.put("usersGroups",Long.valueOf(user.getUserId()));
    return GroupLocalServiceUtil.search(themeDisplay.getCompanyId(),_CLASSNAME_IDS,keywords,groupParams,startAndEnd[0],startAndEnd[1],null);
  }
  try {
    List<Group> groups=user.getMySiteGroups(null,startAndEnd[1]);
    return ListUtil.subList(groups,startAndEnd[0],startAndEnd[1]);
  }
 catch (  Exception e) {
    _log.error(e,e);
    return new ArrayList<>();
  }
}
