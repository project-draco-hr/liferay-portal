{
  Bundle bundle=bundleContext.getBundle();
  Dictionary<String,String> headers=bundle.getHeaders();
  String contextName=headers.get("Liferay-WAB-Context-Name");
  if (contextName == null) {
    throw new IllegalArgumentException("The header \"Liferay-WAB-Context-Name\" is null");
  }
  String lpkgURLString=headers.get("Liferay-WAB-LPKG-URL");
  if (lpkgURLString == null) {
    throw new IllegalArgumentException("The header \"Liferay-WAB-LPKG-URL\" is null");
  }
  String startLevelString=headers.get("Liferay-WAB-Start-Level");
  if (startLevelString == null) {
    throw new IllegalArgumentException("The header \"Liferay-WAB-Start-Level\" is null");
  }
  int startLevel=Integer.parseInt(startLevelString);
  LPKGWARBundleRegistry lpkgWarBundleRegistry=bundleContext.getService(bundleContext.getServiceReference(LPKGWARBundleRegistry.class));
  _serviceTracker=new ServiceTracker<>(bundleContext,bundleContext.createFilter("(&(" + URLConstants.URL_HANDLER_PROTOCOL + "=webbundle)(objectClass="+ URLStreamHandlerService.class.getName()+ "))"),new URLStreamHandlerServiceServiceTrackerCustomizer(bundleContext,contextName,new URL(lpkgURLString),startLevel,lpkgWarBundleRegistry));
  _serviceTracker.open();
}
