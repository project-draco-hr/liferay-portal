{
  Bundle bundle=bundleContext.getBundle();
  Dictionary<String,String> headers=bundle.getHeaders();
  String contextName=headers.get("Liferay-WAB-Context-Name");
  if (contextName == null) {
    throw new IllegalArgumentException("Missing Liferay-WAB-Context-Name header");
  }
  String lpkgURLString=headers.get("Liferay-WAB-LPKG-URL");
  if (lpkgURLString == null) {
    throw new IllegalArgumentException("Missing Liferay-WAB-LPKG-URL header");
  }
  String startLevelString=headers.get("Liferay-WAB-Start-Level");
  if (startLevelString == null) {
    throw new IllegalArgumentException("Missing Liferay-WAB-Start-Level header");
  }
  int startLevel=Integer.parseInt(startLevelString);
  LPKGWARBundleRegistry lpkgWarBundleRegistry=bundleContext.getService(bundleContext.getServiceReference(LPKGWARBundleRegistry.class));
  _serviceTracker=new ServiceTracker<>(bundleContext,bundleContext.createFilter("(&(objectClass=" + URLStreamHandlerService.class.getName() + ")("+ URLConstants.URL_HANDLER_PROTOCOL+ "=webbundle))"),new URLStreamHandlerServiceServiceTrackerCustomizer(bundleContext,contextName,new URL(lpkgURLString),startLevel,lpkgWarBundleRegistry));
  _serviceTracker.open();
}
