{
  try (ServiceTrackerMap<String,TrackedOne> serviceTrackerMap=ServiceTrackerCollections.openSingleValueMap(TrackedOne.class,"(&(other=*)(target=*))",new ServiceReferenceMapper<String,TrackedOne>(){
    @Override public void map(    ServiceReference<TrackedOne> serviceReference,    Emitter<String> keys){
      keys.emit(serviceReference.getProperty("other") + " - " + serviceReference.getProperty("target"));
    }
  }
)){
    Dictionary<String,String> properties=new Hashtable<>();
    properties.put("other","aProperty");
    properties.put("target","aTarget");
    ServiceRegistration<TrackedOne> serviceRegistration=_bundleContext.registerService(TrackedOne.class,new TrackedOne(),properties);
    Assert.assertNotNull(serviceTrackerMap.getService("aProperty - aTarget"));
    serviceRegistration.unregister();
  }
 }
