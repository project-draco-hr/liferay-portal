{
  List layoutSets=LayoutSetUtil.findAll();
  LayoutSetUtil.removeAll();
  Map ownerIdMap=new HashMap(layoutSets.size());
  Iterator itr=layoutSets.iterator();
  while (itr.hasNext()) {
    LayoutSet oldLayoutSet=(LayoutSet)itr.next();
    String oldOwnerId=oldLayoutSet.getOwnerId();
    String ownerId;
    if (LayoutImpl.isPrivateLayout(oldOwnerId)) {
      ownerId=LayoutImpl.PRIVATE + oldLayoutSet.getGroupId();
    }
 else {
      ownerId=LayoutImpl.PUBLIC + oldLayoutSet.getGroupId();
    }
    ownerIdMap.put(oldOwnerId,ownerId);
    LayoutSet layoutSet=LayoutSetUtil.create(ownerId);
    layoutSet.setCompanyId(oldLayoutSet.getCompanyId());
    layoutSet.setGroupId(oldLayoutSet.getGroupId());
    layoutSet.setUserId(oldLayoutSet.getUserId());
    layoutSet.setPrivateLayout(oldLayoutSet.getPrivateLayout());
    layoutSet.setThemeId(oldLayoutSet.getThemeId());
    layoutSet.setColorSchemeId(oldLayoutSet.getColorSchemeId());
    layoutSet.setPageCount(oldLayoutSet.getPageCount());
    layoutSet.setVirtualHost(oldLayoutSet.getVirtualHost());
    LayoutSetUtil.update(layoutSet);
  }
  itr=LayoutUtil.findAll().iterator();
  LayoutUtil.removeAll();
  while (itr.hasNext()) {
    Layout oldLayout=(Layout)itr.next();
    String ownerId=(String)ownerIdMap.get(oldLayout.getOwnerId());
    Layout layout=LayoutUtil.create(new LayoutPK(oldLayout.getLayoutId(),ownerId));
    layout.setCompanyId(oldLayout.getCompanyId());
    layout.setParentLayoutId(oldLayout.getParentLayoutId());
    layout.setName(oldLayout.getName());
    layout.setTitle(oldLayout.getTitle());
    layout.setType(oldLayout.getType());
    layout.setTypeSettings(oldLayout.getTypeSettings());
    layout.setHidden(oldLayout.getHidden());
    layout.setFriendlyURL(oldLayout.getFriendlyURL());
    layout.setThemeId(oldLayout.getThemeId());
    layout.setColorSchemeId(oldLayout.getColorSchemeId());
    layout.setPriority(oldLayout.getPriority());
    LayoutUtil.update(layout);
  }
  return ownerIdMap;
}
