{
  try {
    long groupId=LayoutImpl.getGroupId(ownerId);
    boolean privateLayout=LayoutImpl.isPrivateLayout(ownerId);
    LayoutSet layoutSet=LayoutSetUtil.findByG_P(groupId,privateLayout);
    layoutSet.setLogo(logo);
    LayoutSetUtil.update(layoutSet);
    if (logo) {
      ImageLocalUtil.put(layoutSet.getLogoImageId(),FileUtil.getBytes(file));
      BufferedImage thumbnail=ImageUtil.scale(ImageIO.read(file),.6);
      ByteArrayMaker bam=new ByteArrayMaker();
      ImageIO.write(thumbnail,"png",bam);
      ImageLocalUtil.put(layoutSet.getPngLogoImageId(),bam.toByteArray());
      bam=new ByteArrayMaker();
      ImageUtil.encodeWBMP(thumbnail,bam);
      ImageLocalUtil.put(layoutSet.getWbmpLogoImageId(),bam.toByteArray());
    }
 else {
      ImageLocalUtil.remove(layoutSet.getLogoImageId());
      ImageLocalUtil.remove(layoutSet.getPngLogoImageId());
      ImageLocalUtil.remove(layoutSet.getWbmpLogoImageId());
    }
  }
 catch (  InterruptedException ie) {
    throw new SystemException(ie);
  }
catch (  IOException ioe) {
    throw new SystemException(ioe);
  }
}
