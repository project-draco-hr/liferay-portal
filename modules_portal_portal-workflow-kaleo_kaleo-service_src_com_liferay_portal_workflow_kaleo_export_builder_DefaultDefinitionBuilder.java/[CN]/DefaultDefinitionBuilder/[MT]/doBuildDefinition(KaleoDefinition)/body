{
  Definition definition=new Definition(kaleoDefinition.getName(),kaleoDefinition.getDescription(),kaleoDefinition.getContent(),kaleoDefinition.getVersion());
  List<KaleoNode> kaleoNodes=kaleoNodeLocalService.getKaleoDefinitionKaleoNodes(kaleoDefinition.getKaleoDefinitionId());
  for (  KaleoNode kaleoNode : kaleoNodes) {
    NodeBuilder nodeBuilder=NodeBuilderRegistry.getNodeBuilder(kaleoNode.getType());
    Node node=nodeBuilder.buildNode(kaleoNode);
    definition.addNode(node);
  }
  List<KaleoTransition> kaleoTransitions=kaleoTransitionLocalService.getKaleoDefinitionKaleoTransitions(kaleoDefinition.getKaleoDefinitionId());
  for (  KaleoTransition kaleoTransition : kaleoTransitions) {
    String sourceNodeName=kaleoTransition.getSourceKaleoNodeName();
    Node sourceNode=definition.getNode(sourceNodeName);
    String targetNodeName=kaleoTransition.getTargetKaleoNodeName();
    Node targetNode=definition.getNode(targetNodeName);
    Transition transition=new Transition(kaleoTransition.getName(),sourceNode,targetNode,kaleoTransition.isDefaultTransition());
    sourceNode.addOutgoingTransition(transition);
    targetNode.addIncomingTransition(transition);
  }
  return definition;
}
