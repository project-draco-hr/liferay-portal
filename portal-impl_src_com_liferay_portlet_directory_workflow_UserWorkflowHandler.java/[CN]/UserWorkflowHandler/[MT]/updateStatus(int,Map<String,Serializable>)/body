{
  long userId=GetterUtil.getLong((String)workflowContext.get(WorkflowConstants.CONTEXT_ENTRY_CLASS_PK));
  User user=UserLocalServiceUtil.getUser(userId);
  if (((user.getStatus() == WorkflowConstants.STATUS_DRAFT) || (user.getStatus() == WorkflowConstants.STATUS_PENDING)) && (status == WorkflowConstants.STATUS_APPROVED)) {
    ServiceContext serviceContext=(ServiceContext)workflowContext.get(WorkflowConstants.CONTEXT_SERVICE_CONTEXT);
    UserLocalServiceUtil.completeUserRegistration(user,serviceContext);
    serviceContext.setAttribute("passwordUnencrypted",user.getPasswordUnencrypted());
  }
  return UserLocalServiceUtil.updateStatus(userId,status);
}
