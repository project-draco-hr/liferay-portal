{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long companyId=themeDisplay.getCompanyId();
  String code=ParamUtil.get(request,"code",StringPool.BLANK);
  String token=getAccessToken(companyId,code);
  if (Validator.isNotNull(token)) {
    String email=getUserEmail(companyId,token);
    if (Validator.isNotNull(email)) {
      request.getSession().setAttribute(WebKeys.FACEBOOK_USER_EMAIL,email);
    }
  }
  response.sendRedirect("/");
  return null;
}
