{
  ReferenceQueue<Object> referenceQueue=new ReferenceQueue<Object>();
  WeakReference<Object> weakReference=new WeakReference<Object>(new Object(),referenceQueue);
  if (actively) {
    while (weakReference.get() != null) {
      System.gc();
      System.runFinalization();
    }
  }
  Assert.assertSame(weakReference,referenceQueue.remove());
  if (ensureEnqueuedReferences) {
    gc(actively,false);
  }
}
