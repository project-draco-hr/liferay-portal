{
  _builder=pattern;
  String regex=escapeRegex(pattern);
  Matcher matcher=_fragmentPattern.matcher(pattern);
  while (matcher.find()) {
    String chunk=matcher.group();
    StringParserFragment fragment=new StringParserFragment(chunk);
    _fragments.add(fragment);
    _builder=_builder.replace(chunk,fragment.getToken());
    regex=regex.replace(escapeRegex(chunk),"(" + fragment.getPattern() + ")");
  }
  _pattern=Pattern.compile(regex);
}
