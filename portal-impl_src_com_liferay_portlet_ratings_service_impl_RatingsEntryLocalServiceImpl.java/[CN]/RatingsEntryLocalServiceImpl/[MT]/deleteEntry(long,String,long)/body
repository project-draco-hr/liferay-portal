{
  long classNameId=PortalUtil.getClassNameId(className);
  RatingsEntry entry=ratingsEntryPersistence.fetchByU_C_C(userId,classNameId,classPK);
  if (entry == null) {
    return;
  }
  double oldScore=entry.getScore();
  ratingsEntryPersistence.removeByU_C_C(userId,classNameId,classPK);
  RatingsStats stats=ratingsStatsLocalService.getStats(className,classPK);
  int totalEntries=stats.getTotalEntries() - 1;
  double totalScore=stats.getTotalScore() - oldScore;
  double averageScore=0;
  if (totalEntries > 0) {
    averageScore=totalScore / totalEntries;
  }
  stats.setTotalEntries(totalEntries);
  stats.setTotalScore(totalScore);
  stats.setAverageScore(averageScore);
  ratingsStatsPersistence.update(stats,false);
}
