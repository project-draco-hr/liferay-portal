{
  long classNameId=PortalUtil.getClassNameId(className);
  try {
    RatingsEntry entry=ratingsEntryPersistence.findByU_C_C(userId,classNameId,classPK);
    double oldScore=entry.getScore();
    double avgScore=0;
    ratingsEntryPersistence.removeByU_C_C(userId,classNameId,classPK);
    RatingsStats stats=ratingsStatsLocalService.getStats(className,classPK);
    if (stats.getTotalEntries() > 1) {
      avgScore=stats.getTotalScore() / stats.getTotalEntries();
    }
    stats.setTotalEntries(stats.getTotalEntries() - 1);
    stats.setTotalScore(stats.getTotalScore() - oldScore);
    stats.setAverageScore(avgScore);
    ratingsStatsPersistence.update(stats,false);
  }
 catch (  NoSuchEntryException nsee) {
    _log.warn(nsee);
  }
}
