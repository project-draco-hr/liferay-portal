{
  String result=s;
  if (entryName != null) {
    TagsEntry entry=TagsEntryLocalServiceUtil.getEntry(companyId,entryName);
    List properties=TagsPropertyLocalServiceUtil.getProperties(entry.getEntryId());
    Iterator it=properties.iterator();
    while (it.hasNext()) {
      TagsProperty property=(TagsProperty)it.next();
      result=StringUtil.replace(result,"[$" + property.getKey() + "$]",property.getValue());
    }
  }
  StringMaker sm=new StringMaker(result);
  int varStart=result.indexOf("[$");
  while (varStart != -1) {
    int varEnd=result.indexOf("$]",varStart);
    sm=sm.replace(varStart,varEnd + 2,StringPool.BLANK);
    varStart=sm.indexOf("[$");
  }
  return sm.toString();
}
