{
  if (updatedUser == null) {
    return true;
  }
  if (updatingUser == null) {
    long updatingUserId=PrincipalThreadLocal.getUserId();
    if (updatingUserId > 0) {
      updatingUser=UserLocalServiceUtil.fetchUserById(updatingUserId);
    }
  }
  if ((updatingUser != null) && !updatingUser.equals(updatedUser) && UserPermissionUtil.contains(permissionChecker,updatingUser.getUserId(),ActionKeys.UPDATE_USER)) {
    return true;
  }
  for (  String userType : PropsValues.FIELD_EDITABLE_USER_TYPES) {
    if (userType.equals("user-with-mx") && updatedUser.hasCompanyMx()) {
      return true;
    }
    if (userType.equals("user-without-mx") && !updatedUser.hasCompanyMx()) {
      return true;
    }
  }
  for (  String roleName : PropsValues.FIELD_EDITABLE_ROLES) {
    Role role=RoleLocalServiceUtil.fetchRole(updatedUser.getCompanyId(),roleName);
    if ((role != null) && RoleLocalServiceUtil.hasUserRole(updatedUser.getUserId(),role.getRoleId())) {
      return true;
    }
  }
  String emailAddress=updatedUser.getEmailAddress();
  for (  String domainName : PropsValues.FIELD_EDITABLE_DOMAINS) {
    if (emailAddress.endsWith(domainName)) {
      return true;
    }
  }
  String[] fieldEditableDomainNames=PropsUtil.getArray(PropsKeys.FIELD_EDITABLE_DOMAINS,new Filter(field));
  for (  String domainName : fieldEditableDomainNames) {
    if (domainName.equals(StringPool.STAR) || emailAddress.endsWith(domainName)) {
      return true;
    }
  }
  return false;
}
