{
  if (updatingUser == null) {
    long updatingUserId=PrincipalThreadLocal.getUserId();
    if (updatingUserId > 0) {
      updatingUser=UserLocalServiceUtil.fetchUserById(updatingUserId);
    }
  }
  if ((updatingUser != null) && (updatingUser != updatedUser)) {
    for (    String roleName : PropsValues.FIELD_ALL_USERS_EDITABLE_ROLES) {
      Role role=RoleLocalServiceUtil.fetchRole(updatingUser.getCompanyId(),roleName);
      if ((role != null) && RoleLocalServiceUtil.hasUserRole(updatingUser.getUserId(),role.getRoleId())) {
        return true;
      }
    }
    return false;
  }
  if (updatedUser == null) {
    return true;
  }
  for (  String userType : PropsValues.FIELD_EDITABLE_USER_TYPES) {
    if (userType.equals("user-with-mx") && updatedUser.hasCompanyMx()) {
      return true;
    }
    if (userType.equals("user-without-mx") && !updatedUser.hasCompanyMx()) {
      return true;
    }
  }
  for (  String roleName : PropsValues.FIELD_EDITABLE_ROLES) {
    Role role=RoleLocalServiceUtil.fetchRole(updatedUser.getCompanyId(),roleName);
    if ((role != null) && RoleLocalServiceUtil.hasUserRole(updatedUser.getUserId(),role.getRoleId())) {
      return true;
    }
  }
  String emailAddress=updatedUser.getEmailAddress();
  for (  String domainName : PropsValues.FIELD_EDITABLE_DOMAINS) {
    if (emailAddress.endsWith(domainName)) {
      return true;
    }
  }
  String[] fieldEditableDomainNames=PropsUtil.getArray(PropsKeys.FIELD_EDITABLE_DOMAINS,new Filter(field));
  for (  String domainName : fieldEditableDomainNames) {
    if (emailAddress.endsWith(domainName)) {
      return true;
    }
  }
  return false;
}
