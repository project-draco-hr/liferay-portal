{
  List<Document> documents=hits.toList();
  List<User> users=new ArrayList<>(documents.size());
  for (  Document document : documents) {
    long userId=UserIndexer.getUserId(document);
    User user=UserLocalServiceUtil.fetchUser(userId);
    if (user == null) {
      users=null;
      Indexer<User> indexer=IndexerRegistryUtil.getIndexer(User.class);
      long companyId=GetterUtil.getLong(document.get(Field.COMPANY_ID));
      indexer.delete(companyId,document.getUID());
    }
 else     if (users != null) {
      users.add(user);
    }
  }
  return users;
}
