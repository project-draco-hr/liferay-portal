{
  Set<Long> phoneIds=new HashSet<>();
  for (  Phone phone : phones) {
    long phoneId=phone.getPhoneId();
    String number=phone.getNumber();
    String extension=phone.getExtension();
    long typeId=phone.getTypeId();
    boolean primary=phone.isPrimary();
    if (phoneId <= 0) {
      phone=PhoneServiceUtil.addPhone(className,classPK,number,extension,typeId,primary,new ServiceContext());
      phoneId=phone.getPhoneId();
    }
 else {
      PhoneServiceUtil.updatePhone(phoneId,number,extension,typeId,primary);
    }
    phoneIds.add(phoneId);
  }
  phones=PhoneServiceUtil.getPhones(className,classPK);
  for (  Phone phone : phones) {
    if (!phoneIds.contains(phone.getPhoneId())) {
      PhoneServiceUtil.deletePhone(phone.getPhoneId());
    }
  }
}
