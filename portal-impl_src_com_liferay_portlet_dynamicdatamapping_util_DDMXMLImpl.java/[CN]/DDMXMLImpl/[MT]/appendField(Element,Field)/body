{
  int dynamicElementCount=0;
  for (  Locale locale : field.getAvailableLocales()) {
    List<Serializable> values=field.getValues(locale);
    if (dynamicElementCount < values.size()) {
      dynamicElementCount=values.size();
    }
  }
  for (int i=0; i < dynamicElementCount; i++) {
    Element dynamicElementElement=element.addElement("dynamic-element");
    dynamicElementElement.addAttribute("default-language-id",LocaleUtil.toLanguageId(field.getDefaultLocale()));
    dynamicElementElement.addAttribute("name",field.getName());
    for (    Locale locale : field.getAvailableLocales()) {
      List<Serializable> values=field.getValues(locale);
      if (i >= values.size()) {
        continue;
      }
      Element dynamicContentElement=dynamicElementElement.addElement("dynamic-content");
      dynamicContentElement.addAttribute("language-id",LocaleUtil.toLanguageId(locale));
      Serializable value=field.getValue(locale,i);
      updateField(dynamicContentElement,locale,field.getName(),value);
    }
  }
}
