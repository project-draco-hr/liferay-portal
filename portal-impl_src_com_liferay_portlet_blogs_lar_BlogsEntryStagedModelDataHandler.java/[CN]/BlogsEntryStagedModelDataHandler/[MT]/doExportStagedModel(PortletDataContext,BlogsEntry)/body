{
  if (!entry.isApproved() && !entry.isInTrash()) {
    return;
  }
  Element entryElement=portletDataContext.getExportDataElement(entry);
  if (entry.isSmallImage()) {
    Image smallImage=ImageUtil.fetchByPrimaryKey(entry.getSmallImageId());
    if (Validator.isNotNull(entry.getSmallImageURL())) {
      String smallImageURL=ExportImportUtil.replaceExportContentReferences(portletDataContext,entry,entryElement,entry.getSmallImageURL().concat(StringPool.SPACE),true);
      entry.setSmallImageURL(smallImageURL);
    }
 else     if (smallImage != null) {
      String smallImagePath=ExportImportPathUtil.getModelPath(entry,smallImage.getImageId() + StringPool.PERIOD + smallImage.getType());
      entryElement.addAttribute("small-image-path",smallImagePath);
      entry.setSmallImageType(smallImage.getType());
      portletDataContext.addZipEntry(smallImagePath,smallImage.getTextObj());
    }
  }
  String content=ExportImportUtil.replaceExportContentReferences(portletDataContext,entry,entryElement,entry.getContent(),true);
  entry.setContent(content);
  portletDataContext.addClassedModel(entryElement,ExportImportPathUtil.getModelPath(entry),entry,BlogsPortletDataHandler.NAMESPACE);
}
