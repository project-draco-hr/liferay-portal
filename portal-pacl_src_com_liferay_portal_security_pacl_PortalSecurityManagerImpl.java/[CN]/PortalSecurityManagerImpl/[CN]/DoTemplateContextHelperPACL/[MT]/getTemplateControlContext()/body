{
  PACLPolicy paclPolicy=PACLUtil.getPACLPolicy();
  ClassLoader contextClassLoader=ClassLoaderUtil.getContextClassLoader();
  if (paclPolicy == null) {
    paclPolicy=PACLPolicyManager.getPACLPolicy(contextClassLoader);
  }
  if ((paclPolicy == null) || !paclPolicy.isActive()) {
    return new TemplateControlContext(null,contextClassLoader);
  }
  ProtectionDomain protectionDomain=new ProtectionDomain(null,null,paclPolicy.getClassLoader(),null);
  AccessControlContext accessControlContext=new AccessControlContext(new ProtectionDomain[]{protectionDomain});
  return new TemplateControlContext(accessControlContext,paclPolicy.getClassLoader());
}
