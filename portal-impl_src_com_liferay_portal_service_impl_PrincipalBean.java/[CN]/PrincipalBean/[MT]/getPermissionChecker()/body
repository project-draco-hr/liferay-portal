{
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  if (permissionChecker == null) {
    throw new PrincipalException("PermissionChecker not initialized");
  }
  return permissionChecker;
}
