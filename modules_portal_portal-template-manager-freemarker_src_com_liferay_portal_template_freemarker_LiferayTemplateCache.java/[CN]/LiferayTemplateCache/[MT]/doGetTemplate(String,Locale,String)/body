{
  if (templateId == null) {
    throw new IllegalArgumentException("Argument \"name\" is null");
  }
  if (locale == null) {
    throw new IllegalArgumentException("Argument \"locale\" is null");
  }
  if (encoding == null) {
    throw new IllegalArgumentException("Argument \"encoding\" is null");
  }
  TemplateResource templateResource=null;
  if (templateId.startsWith(TemplateConstants.TEMPLATE_RESOURCE_UUID_PREFIX)) {
    templateResource=TemplateResourceThreadLocal.getTemplateResource(TemplateConstants.LANG_TYPE_FTL);
  }
 else {
    try {
      templateResource=TemplateResourceLoaderUtil.getTemplateResource(TemplateConstants.LANG_TYPE_FTL,templateId);
    }
 catch (    Exception e) {
      templateResource=null;
    }
  }
  if (templateResource == null) {
    throw new IOException("Unable to find FreeMarker template with ID " + templateId);
  }
  Object object=_portalCache.get(templateResource);
  if ((object != null) && (object instanceof Template)) {
    return (Template)object;
  }
  Template template=new Template(templateResource.getTemplateId(),templateResource.getReader(),_configuration,TemplateConstants.DEFAUT_ENCODING);
  if (_freemarkerEngineConfiguration.getResourceModificationCheck() != 0) {
    _portalCache.put(templateResource,template);
  }
  return template;
}
