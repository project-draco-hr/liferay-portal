{
  MBCategoryPermission.check(getPermissionChecker(),categoryId,ActionKeys.ADD_MESSAGE);
  if (!MBCategoryPermission.contains(getPermissionChecker(),categoryId,ActionKeys.UPDATE_THREAD_PRIORITY)) {
    priority=0.0;
  }
  return MBMessageLocalServiceUtil.addMessage(getUserId(),categoryId,threadId,parentMessageId,subject,body,files,anonymous,priority,null,addCommunityPermissions,addGuestPermissions);
}
