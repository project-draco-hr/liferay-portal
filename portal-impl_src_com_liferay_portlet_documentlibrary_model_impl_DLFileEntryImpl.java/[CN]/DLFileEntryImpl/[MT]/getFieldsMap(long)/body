{
  Map<String,Fields> fieldsMap=new HashMap<String,Fields>();
  DLFileVersion dlFileVersion=DLFileVersionLocalServiceUtil.getFileVersion(fileVersionId);
  long fileEntryTypeId=dlFileVersion.getFileEntryTypeId();
  if (fileEntryTypeId <= 0) {
    return fieldsMap;
  }
  DLFileEntryType dlFileEntryType=DLFileEntryTypeLocalServiceUtil.getFileEntryType(fileEntryTypeId);
  List<DDMStructure> ddmStructures=dlFileEntryType.getDDMStructures();
  for (  DDMStructure ddmStructure : ddmStructures) {
    long ddmStructureId=ddmStructure.getStructureId();
    DLFileEntryMetadata dlFileEntryMetadata=DLFileEntryMetadataLocalServiceUtil.getFileEntryMetadata(ddmStructureId,fileVersionId);
    Fields fields=StorageEngineUtil.getFields(ddmStructureId,dlFileEntryMetadata.getDDMStorageId());
    fieldsMap.put(ddmStructure.getStructureKey(),fields);
  }
  return fieldsMap;
}
