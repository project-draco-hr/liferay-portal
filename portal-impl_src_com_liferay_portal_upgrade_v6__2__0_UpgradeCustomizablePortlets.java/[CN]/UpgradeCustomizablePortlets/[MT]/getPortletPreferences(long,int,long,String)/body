{
  StringBundler sb=new StringBundler(3);
  sb.append("select portletPreferencesId, ownerId, ownerType, plid, ");
  sb.append("portletId, preferences from PortletPreferences where ");
  sb.append("ownerId = ?, ownerType = ?, plid = ?, portletId = ?");
  try (PreparedStatement ps=connection.prepareStatement(sb.toString())){
    ps.setLong(1,ownerId);
    ps.setInt(2,ownerType);
    ps.setLong(3,plid);
    ps.setString(4,portletId);
    try (ResultSet rs=ps.executeQuery()){
      if (!rs.next()) {
        return null;
      }
      PortletPreferences portletPreferences=new PortletPreferencesImpl();
      portletPreferences.setPortletPreferencesId(rs.getLong("portletPreferencesId"));
      portletPreferences.setOwnerId(rs.getLong("ownerId"));
      portletPreferences.setOwnerType(rs.getInt("ownerType"));
      portletPreferences.setPlid(rs.getLong("plid"));
      portletPreferences.setPortletId(rs.getString("portletId"));
      portletPreferences.setPreferences(rs.getString("preferences"));
      return portletPreferences;
    }
   }
 }
