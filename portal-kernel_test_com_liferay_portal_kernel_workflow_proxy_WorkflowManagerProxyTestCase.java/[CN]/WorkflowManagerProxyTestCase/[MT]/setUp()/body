{
  messageBus=new DefaultMessageBus();
  DefaultMessageSender sender=new DefaultMessageSender();
  sender.setMessageBus(messageBus);
  SynchronousMessageSender syncSender=new DefaultSynchronousMessageSender(messageBus,new PortalUUIDImpl(),120 * 1000);
  messageBus.addDestination(new ParallelDestination(DestinationNames.WORKFLOW_DEFINITION));
  messageBus.addDestination(new ParallelDestination(DestinationNames.WORKFLOW_INSTANCE));
  messageBus.addDestination(new ParallelDestination(DestinationNames.WORKFLOW_TASK));
  messageBus.addDestination(new ParallelDestination(DestinationNames.MESSAGE_BUS_DEFAULT_RESPONSE));
  definitionMessageSender=new DefaultSingleDestinationMessageSender(DestinationNames.WORKFLOW_DEFINITION,sender);
  instanceMessageSender=new DefaultSingleDestinationMessageSender(DestinationNames.WORKFLOW_INSTANCE,sender);
  instanceSynchronousMessageSender=new DefaultSingleDestinationSynchronousMessageSender(DestinationNames.WORKFLOW_INSTANCE,syncSender);
  taskSynchronousMessageSender=new DefaultSingleDestinationSynchronousMessageSender(DestinationNames.WORKFLOW_TASK,syncSender);
}
