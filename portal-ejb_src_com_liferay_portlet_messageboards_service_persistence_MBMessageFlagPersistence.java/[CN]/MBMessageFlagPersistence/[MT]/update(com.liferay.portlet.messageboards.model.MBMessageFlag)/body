{
  Session session=null;
  try {
    if (mbMessageFlag.isNew() || mbMessageFlag.isModified()) {
      session=openSession();
      if (mbMessageFlag.isNew()) {
        MBMessageFlagHBM mbMessageFlagHBM=new MBMessageFlagHBM();
        mbMessageFlagHBM.setTopicId(mbMessageFlag.getTopicId());
        mbMessageFlagHBM.setMessageId(mbMessageFlag.getMessageId());
        mbMessageFlagHBM.setUserId(mbMessageFlag.getUserId());
        mbMessageFlagHBM.setFlag(mbMessageFlag.getFlag());
        session.save(mbMessageFlagHBM);
        session.flush();
      }
 else {
        MBMessageFlagHBM mbMessageFlagHBM=(MBMessageFlagHBM)session.get(MBMessageFlagHBM.class,mbMessageFlag.getPrimaryKey());
        if (mbMessageFlagHBM != null) {
          mbMessageFlagHBM.setFlag(mbMessageFlag.getFlag());
          session.flush();
        }
 else {
          mbMessageFlagHBM=new MBMessageFlagHBM();
          mbMessageFlagHBM.setTopicId(mbMessageFlag.getTopicId());
          mbMessageFlagHBM.setMessageId(mbMessageFlag.getMessageId());
          mbMessageFlagHBM.setUserId(mbMessageFlag.getUserId());
          mbMessageFlagHBM.setFlag(mbMessageFlag.getFlag());
          session.save(mbMessageFlagHBM);
          session.flush();
        }
      }
      mbMessageFlag.setNew(false);
      mbMessageFlag.setModified(false);
    }
    return mbMessageFlag;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
