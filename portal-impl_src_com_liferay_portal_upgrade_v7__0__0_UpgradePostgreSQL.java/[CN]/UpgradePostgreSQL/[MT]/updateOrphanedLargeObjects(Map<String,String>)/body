{
  PreparedStatement ps=null;
  StringBundler sb=new StringBundler(3);
  sb.append("select lo_unlink(l.oid) from pg_largeobject_metadata l ");
  sb.append("where ");
  int count=1;
  int size=columnsWithOids.size();
  for (  Map.Entry<String,String> column : columnsWithOids.entrySet()) {
    String tableName=column.getKey();
    String columnName=column.getValue();
    sb.append("(not exists (select 1 from ");
    sb.append(tableName);
    sb.append(" t where t.");
    sb.append(columnName);
    sb.append(" = l.oid))");
    if (count < size) {
      sb.append(" and ");
    }
    count++;
  }
  try {
    ps=connection.prepareStatement(sb.toString());
    ps.execute();
  }
  finally {
    DataAccess.cleanUp(ps);
  }
}
