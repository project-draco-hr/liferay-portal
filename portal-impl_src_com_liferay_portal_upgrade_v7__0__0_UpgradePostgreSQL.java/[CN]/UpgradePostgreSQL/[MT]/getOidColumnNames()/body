{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    Map<String,String> columnsWithOids=new HashMap<>();
    StringBundler sb=new StringBundler(4);
    sb.append("select table_name, column_name from ");
    sb.append("information_schema.columns where table_schema='");
    String schema=getCurrentSchema();
    if (schema == null) {
      throw new UpgradeException("Unable to get current schema");
    }
    sb.append(schema);
    sb.append("' and data_type='oid';");
    try (PreparedStatement ps=connection.prepareStatement(sb.toString());ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        String tableName=(String)rs.getObject("table_name");
        String columnName=(String)rs.getObject("column_name");
        columnsWithOids.put(tableName,columnName);
      }
      return columnsWithOids;
    }
   }
 }
