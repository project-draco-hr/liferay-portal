{
  try {
    IndexWriterRequest request=(IndexWriterRequest)JSONUtil.deserialize(message);
    if (request.getCommand().equals(IndexWriterRequest.ADD)) {
      LuceneSearchEngineUtil.addDocument(request.getCompanyId(),request.getDocument());
    }
 else     if (request.getCommand().equals(IndexWriterRequest.DELETE)) {
      LuceneSearchEngineUtil.deleteDocument(request.getCompanyId(),request.getUid(),request.getDocument());
    }
 else     if (request.getCommand().equals(IndexWriterRequest.UPDATE)) {
      LuceneSearchEngineUtil.updateDocument(request.getCompanyId(),request.getUid(),request.getDocument());
    }
  }
 catch (  UnmarshallException ue) {
    ue.printStackTrace();
  }
catch (  SearchException se) {
    se.printStackTrace();
  }
}
