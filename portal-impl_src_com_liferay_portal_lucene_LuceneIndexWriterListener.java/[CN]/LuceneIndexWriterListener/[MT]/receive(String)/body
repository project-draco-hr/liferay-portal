{
  try {
    IndexWriterRequest req=(IndexWriterRequest)JSONUtil.deserialize(message);
    String command=req.getCommand();
    if (command.equals(IndexWriterRequest.ADD)) {
      LuceneSearchEngineUtil.addDocument(req.getCompanyId(),req.getDocument());
    }
 else     if (command.equals(IndexWriterRequest.DELETE)) {
      LuceneSearchEngineUtil.deleteDocument(req.getCompanyId(),req.getUid());
    }
 else     if (command.equals(IndexWriterRequest.UPDATE)) {
      LuceneSearchEngineUtil.updateDocument(req.getCompanyId(),req.getUid(),req.getDocument());
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
