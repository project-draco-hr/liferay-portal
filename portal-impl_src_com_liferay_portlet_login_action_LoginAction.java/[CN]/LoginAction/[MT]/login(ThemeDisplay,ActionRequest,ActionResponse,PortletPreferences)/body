{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
  HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
  String login=ParamUtil.getString(actionRequest,"login");
  String password=actionRequest.getParameter("password");
  boolean rememberMe=ParamUtil.getBoolean(actionRequest,"rememberMe");
  String authType=preferences.getValue("authType",null);
  LoginUtil.login(request,response,login,password,rememberMe,authType);
  if (PropsValues.PORTAL_JAAS_ENABLE) {
    actionResponse.sendRedirect(themeDisplay.getPathMain() + "/portal/protected");
  }
 else {
    String redirect=ParamUtil.getString(actionRequest,"redirect");
    if (Validator.isNotNull(redirect)) {
      redirect=PortalUtil.escapeRedirect(redirect);
      if (!redirect.startsWith(Http.HTTP)) {
        redirect=getCompleteRedirectURL(request,redirect);
      }
      actionResponse.sendRedirect(redirect);
    }
 else {
      boolean doActionAfterLogin=ParamUtil.getBoolean(actionRequest,"doActionAfterLogin");
      if (doActionAfterLogin) {
        return;
      }
 else {
        actionResponse.sendRedirect(themeDisplay.getPathMain());
      }
    }
  }
}
