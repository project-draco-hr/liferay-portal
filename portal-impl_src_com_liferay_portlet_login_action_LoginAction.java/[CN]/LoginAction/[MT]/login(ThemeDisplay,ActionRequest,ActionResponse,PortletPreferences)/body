{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(actionRequest);
  HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
  String key=ParamUtil.getString(actionRequest,"key");
  String login=ParamUtil.getString(actionRequest,"login");
  String password=ParamUtil.getString(actionRequest,"password");
  boolean rememberMe=ParamUtil.getBoolean(actionRequest,"rememberMe");
  String authType=preferences.getValue("authType",null);
  LoginUtil.login(request,response,login,password,rememberMe,authType);
  if (PropsValues.PORTAL_JAAS_ENABLE) {
    actionResponse.sendRedirect(themeDisplay.getPathMain() + "/portal/protected");
  }
 else   if (Validator.isNotNull(key)) {
    setForward(actionRequest,"portlet.login.confirm_membership_invitation");
  }
 else {
    String redirect=ParamUtil.getString(actionRequest,"redirect");
    if (Validator.isNotNull(redirect)) {
      actionResponse.sendRedirect(redirect);
    }
 else {
      actionResponse.sendRedirect(themeDisplay.getPathMain());
    }
  }
}
