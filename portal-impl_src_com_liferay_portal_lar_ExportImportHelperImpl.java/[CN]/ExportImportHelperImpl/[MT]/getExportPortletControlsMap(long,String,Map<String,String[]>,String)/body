{
  boolean exportPortletConfiguration=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_CONFIGURATION);
  boolean exportPortletConfigurationAll=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_CONFIGURATION_ALL);
  boolean exportPortletData=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA);
  boolean exportPortletDataAll=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA_ALL);
  if (_log.isDebugEnabled()) {
    _log.debug("Export portlet data " + exportPortletData);
    _log.debug("Export all portlet data " + exportPortletDataAll);
    _log.debug("Export portlet configuration " + exportPortletConfiguration);
  }
  boolean exportCurPortletData=exportPortletData;
  String rootPortletId=getExportableRootPortletId(companyId,portletId);
  if (exportPortletDataAll) {
    exportCurPortletData=true;
  }
 else   if (rootPortletId != null) {
    exportCurPortletData=exportPortletData && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA + StringPool.UNDERLINE + rootPortletId);
  }
  boolean exportCurPortletArchivedSetups=exportPortletConfiguration;
  boolean exportCurPortletConfiguration=exportPortletConfiguration;
  boolean exportCurPortletSetup=exportPortletConfiguration;
  boolean exportCurPortletUserPreferences=exportPortletConfiguration;
  if (exportPortletConfigurationAll || (exportPortletConfiguration && type.equals("layout-prototype"))) {
    exportCurPortletConfiguration=true;
    exportCurPortletArchivedSetups=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_ARCHIVED_SETUPS_ALL);
    exportCurPortletSetup=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_SETUP_ALL);
    exportCurPortletUserPreferences=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_USER_PREFERENCES_ALL);
  }
 else   if (rootPortletId != null) {
    exportCurPortletConfiguration=exportPortletConfiguration && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_CONFIGURATION + StringPool.UNDERLINE + rootPortletId);
    exportCurPortletArchivedSetups=exportCurPortletConfiguration && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_ARCHIVED_SETUPS + StringPool.UNDERLINE + rootPortletId);
    exportCurPortletSetup=exportCurPortletConfiguration && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_SETUP + StringPool.UNDERLINE + rootPortletId);
    exportCurPortletUserPreferences=exportCurPortletConfiguration && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_USER_PREFERENCES + StringPool.UNDERLINE + rootPortletId);
  }
  Map<String,Boolean> exportPortletControlsMap=new HashMap<String,Boolean>();
  exportPortletControlsMap.put(PortletDataHandlerKeys.PORTLET_ARCHIVED_SETUPS,exportCurPortletArchivedSetups);
  exportPortletControlsMap.put(PortletDataHandlerKeys.PORTLET_CONFIGURATION,exportCurPortletConfiguration);
  exportPortletControlsMap.put(PortletDataHandlerKeys.PORTLET_DATA,exportCurPortletData);
  exportPortletControlsMap.put(PortletDataHandlerKeys.PORTLET_SETUP,exportCurPortletSetup);
  exportPortletControlsMap.put(PortletDataHandlerKeys.PORTLET_USER_PREFERENCES,exportCurPortletUserPreferences);
  return exportPortletControlsMap;
}
