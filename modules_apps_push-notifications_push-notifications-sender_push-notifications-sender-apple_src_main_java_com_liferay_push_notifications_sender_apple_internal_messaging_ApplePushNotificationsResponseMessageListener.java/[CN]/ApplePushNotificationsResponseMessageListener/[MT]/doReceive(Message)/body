{
  Response response=(Response)message.getPayload();
  if (response.isSucceeded() || !(response instanceof AppleResponse)) {
    return;
  }
  AppleResponse appleResponse=(AppleResponse)response;
  String invalidTokenErrorName=DeliveryError.INVALID_TOKEN.name();
  String status=appleResponse.getStatus();
  if (invalidTokenErrorName.equals(status)) {
    String token=appleResponse.getToken();
    try {
      _pushNotificationsDeviceLocalService.deletePushNotificationsDevice(token);
      if (_log.isWarnEnabled()) {
        _log.warn("Token " + token + " is invalid and was deleted");
      }
    }
 catch (    Exception e) {
    }
  }
}
