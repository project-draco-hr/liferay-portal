{
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  JSONArray facetsJSONArray=JSONFactoryUtil.createJSONArray();
  for (  SearchFacet searchFacet : SearchFacetTracker.getSearchFacets()) {
    JSONObject facetJSONObject=JSONFactoryUtil.createJSONObject();
    facetJSONObject.put("className",searchFacet.getFacetClassName());
    facetJSONObject.put("data",searchFacet.getJSONData(actionRequest));
    facetJSONObject.put("fieldName",searchFacet.getFieldName());
    facetJSONObject.put("label",searchFacet.getLabel());
    facetJSONObject.put("order",searchFacet.getOrder());
    facetJSONObject.put("id",searchFacet.getId());
    boolean displayFacet=ParamUtil.getBoolean(actionRequest,searchFacet.getClassName() + "displayFacet");
    facetJSONObject.put("static",!displayFacet);
    double weight=ParamUtil.getDouble(actionRequest,searchFacet.getClassName() + "weight");
    facetJSONObject.put("weight",weight);
    facetsJSONArray.put(facetJSONObject);
  }
  jsonObject.put("facets",facetsJSONArray);
  setPreference(actionRequest,"searchConfiguration",jsonObject.toString());
  super.processAction(portletConfig,actionRequest,actionResponse);
}
