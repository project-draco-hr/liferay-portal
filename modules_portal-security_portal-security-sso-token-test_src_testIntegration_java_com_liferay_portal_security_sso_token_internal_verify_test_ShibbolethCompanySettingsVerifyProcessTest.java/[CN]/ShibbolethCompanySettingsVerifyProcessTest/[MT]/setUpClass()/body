{
  Bundle bundle=FrameworkUtil.getBundle(ShibbolethCompanySettingsVerifyProcessTest.class);
  _bundleContext=bundle.getBundleContext();
  ServiceReference<SettingsFactory> settingsFactoryReference=_bundleContext.getServiceReference(SettingsFactory.class);
  _settingsFactory=_bundleContext.getService(settingsFactoryReference);
  ServiceReference<CompanyLocalService> companyLocalServiceReference=_bundleContext.getServiceReference(CompanyLocalService.class);
  _companyLocalService=_bundleContext.getService(companyLocalServiceReference);
  ServiceReference<PrefsProps> prefsPropsServiceReference=_bundleContext.getServiceReference(PrefsProps.class);
  _prefsProps=_bundleContext.getService(prefsPropsServiceReference);
  UnicodeProperties properties=new UnicodeProperties();
  properties.put(LegacyTokenPropsKeys.SHIBBOLETH_AUTH_ENABLED,"true");
  properties.put(LegacyTokenPropsKeys.SHIBBOLETH_IMPORT_FROM_LDAP,"true");
  properties.put(LegacyTokenPropsKeys.SHIBBOLETH_LOGOUT_URL,"/test/shibboleth/url");
  properties.put(LegacyTokenPropsKeys.SHIBBOLETH_USER_HEADER,"testShibboleth");
  List<Company> companies=_companyLocalService.getCompanies(false);
  for (  Company company : companies) {
    _companyLocalService.updatePreferences(company.getCompanyId(),properties);
  }
}
