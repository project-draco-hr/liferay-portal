{
  User user=TestPropsValues.getUser();
  try (CaptureAppender captureAppender=Log4JLoggerTestUtil.configureLog4JLogger(BackgroundTaskMessageListener.class.getName(),Level.ERROR)){
    try {
      StagingUtil.publishPortlet(user.getUserId(),_group.getGroupId(),_liveGroup.getGroupId(),0,0,StringPool.BLANK,_parameterMap);
    }
 catch (    Throwable t) {
      if (_log.isInfoEnabled()) {
        _log.info(t,t);
      }
    }
    List<LoggingEvent> loggingEvents=captureAppender.getLoggingEvents();
    LoggingEvent loggingEvent=loggingEvents.get(0);
    Assert.assertEquals("Unable to execute background task",loggingEvent.getMessage());
    ThrowableInformation throwableInformation=loggingEvent.getThrowableInformation();
    Throwable throwable=throwableInformation.getThrowable();
    Assert.assertSame(SystemException.class,throwable.getClass());
  }
   Assert.assertTrue(_firedExportImportLifecycleEventsMap.containsKey(ExportImportLifecycleConstants.EVENT_PUBLICATION_PORTLET_LOCAL_FAILED));
}
