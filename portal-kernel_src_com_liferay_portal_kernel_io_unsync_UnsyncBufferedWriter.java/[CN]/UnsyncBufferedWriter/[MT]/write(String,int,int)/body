{
  if (writer == null) {
    throw new IOException("Writer closed");
  }
  int begin=off;
  int end=off + len;
  while (begin < end) {
    if (count >= bufferSize) {
      writer.write(buffer);
      count=0;
    }
    int leftFreeSpace=bufferSize - count;
    int leftDataSize=end - begin;
    if (leftFreeSpace > leftDataSize) {
      s.getChars(begin,end,buffer,count);
      count+=leftDataSize;
      break;
    }
 else {
      int copyEnd=begin + leftFreeSpace;
      s.getChars(begin,copyEnd,buffer,count);
      count+=leftFreeSpace;
      begin=copyEnd;
    }
  }
}
