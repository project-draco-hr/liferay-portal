{
  PortletRequestImpl portletRequestImpl=(PortletRequestImpl)portletRequest;
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequestImpl.getAttribute(WebKeys.THEME_DISPLAY);
  PortletURL addAssetURL=null;
  if (IGPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.ADD_IMAGE)) {
    addAssetURL=portletResponse.createRenderURL(PortletKeys.IMAGE_GALLERY);
    addAssetURL.setParameter("struts_action","/image_gallery/edit_image");
    addAssetURL.setParameter("groupId",String.valueOf(themeDisplay.getScopeGroupId()));
    addAssetURL.setParameter("folderId",String.valueOf(AssetPublisherUtil.getRecentFolderId(portletRequest,CLASS_NAME)));
    addAssetURL.setParameter("uploader","classic");
  }
  return addAssetURL;
}
