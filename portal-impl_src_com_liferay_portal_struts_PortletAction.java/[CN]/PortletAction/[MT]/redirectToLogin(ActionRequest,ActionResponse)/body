{
  if (req.getRemoteUser() == null) {
    HttpServletRequest httpReq=PortalUtil.getHttpServletRequest(req);
    SessionErrors.add(httpReq,PrincipalException.class.getName());
    ThemeDisplay themeDisplay=(ThemeDisplay)httpReq.getAttribute(WebKeys.THEME_DISPLAY);
    res.sendRedirect(themeDisplay.getURLSignIn());
    return true;
  }
 else {
    return false;
  }
}
