{
  if (theme.isWARFile()) {
    ServletContext themeCtx=ctx.getContext(StringPool.SLASH + theme.getServletContextName());
    if (themeCtx == null) {
      _log.error("Theme " + theme.getThemeId() + " cannot find its "+ "servlet context at "+ theme.getServletContextName());
    }
 else {
      RequestDispatcher rd=themeCtx.getRequestDispatcher(path);
      if (rd == null) {
        _log.error("Theme " + theme.getThemeId() + " does not have "+ path);
      }
 else {
        Map sharedSessionAttributes=SharedSessionUtil.getSharedSessionAttributes(req);
        SharedSessionServletRequest sharedSessionServletReq=new SharedSessionServletRequest(req,sharedSessionAttributes);
        rd.include(sharedSessionServletReq,res);
      }
    }
  }
 else {
    RequestDispatcher rd=ctx.getRequestDispatcher(path);
    if (rd == null) {
      _log.error("Theme " + theme.getThemeId() + " does not have "+ path);
    }
 else {
      rd.include(req,res);
    }
  }
}
