{
  String extension=theme.getTemplateExtension();
  String servletContextName=GetterUtil.getString(theme.getServletContextName());
  int pos=page.lastIndexOf(CharPool.PERIOD);
  StringBundler sb=new StringBundler(7);
  sb.append(servletContextName);
  if (extension.equals(_TEMPLATE_EXTENSION_FTL)) {
    sb.append(theme.getFreeMarkerTemplateLoader());
    sb.append(theme.getTemplatesPath());
    sb.append(StringPool.SLASH);
    sb.append(page.substring(0,pos));
    sb.append(StringPool.PERIOD);
    sb.append(_TEMPLATE_EXTENSION_FTL);
    return sb.toString();
  }
 else   if (extension.equals(_TEMPLATE_EXTENSION_VM)) {
    sb.append(theme.getVelocityResourceListener());
    sb.append(theme.getTemplatesPath());
    sb.append(StringPool.SLASH);
    sb.append(page.substring(0,pos));
    sb.append(StringPool.PERIOD);
    sb.append(_TEMPLATE_EXTENSION_VM);
    return sb.toString();
  }
 else {
    return page;
  }
}
