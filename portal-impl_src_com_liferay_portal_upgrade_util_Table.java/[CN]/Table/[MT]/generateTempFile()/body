{
  Connection con=DataAccess.getUpgradeOptimizedConnection();
  try {
    return generateTempFile(con);
  }
  finally {
    DataAccess.cleanUp(con);
  }
}
