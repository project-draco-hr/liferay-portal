{
  if (calledGetOutputStream) {
    throw new IllegalStateException("Cannot obtain Writer because OutputStream is already in use");
  }
  if (_printWriter != null) {
    return _printWriter;
  }
  ServletResponse servletResponse=getResponse();
  _restrictedByteArrayCacheOutputStream=new RestrictedByteArrayCacheOutputStream(servletResponse.getOutputStream(),_cacheCapacity,new FinishResponseFlushPreAction());
  _printWriter=UnsyncPrintWriterPool.borrow(_restrictedByteArrayCacheOutputStream,getCharacterEncoding());
  calledGetWriter=true;
  return _printWriter;
}
