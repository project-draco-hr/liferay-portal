{
  if (!folder.isDefaultRepository()) {
    return;
  }
  List<Long> currentFolderFileEntryTypeIds=new ArrayList<>();
  String defaultFileEntryTypeUuid=GetterUtil.getString(folderElement.attributeValue("defaultFileEntryTypeUuid"));
  long defaultFileEntryTypeId=0;
  List<Element> referenceElements=portletDataContext.getReferenceElements(folder,DLFileEntryType.class);
  for (  Element referenceElement : referenceElements) {
    long referenceDlFileEntryTypeId=GetterUtil.getLong(referenceElement.attributeValue("class-pk"));
    String referenceDlFileEntryTypeUuid=referenceElement.attributeValue("uuid");
    Map<Long,Long> dlFileEntryTypeIds=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(DLFileEntryType.class);
    long dlFileEntryTypeId=MapUtil.getLong(dlFileEntryTypeIds,referenceDlFileEntryTypeId,referenceDlFileEntryTypeId);
    DLFileEntryType existingDLFileEntryType=_dlFileEntryTypeLocalService.fetchDLFileEntryType(dlFileEntryTypeId);
    if (existingDLFileEntryType == null) {
      continue;
    }
    currentFolderFileEntryTypeIds.add(existingDLFileEntryType.getFileEntryTypeId());
    if (defaultFileEntryTypeUuid.equals(referenceDlFileEntryTypeUuid)) {
      defaultFileEntryTypeId=existingDLFileEntryType.getFileEntryTypeId();
    }
  }
  if (GetterUtil.getBoolean(folderElement.attributeValue("basic-document"))) {
    currentFolderFileEntryTypeIds.add(DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT);
  }
  if (!currentFolderFileEntryTypeIds.isEmpty()) {
    DLFolder dlFolder=(DLFolder)importedFolder.getModel();
    dlFolder.setDefaultFileEntryTypeId(defaultFileEntryTypeId);
    dlFolder.setRestrictionType(DLFolderConstants.RESTRICTION_TYPE_FILE_ENTRY_TYPES_AND_WORKFLOW);
    _dlFolderLocalService.updateDLFolder(dlFolder);
    _dlFileEntryTypeLocalService.updateFolderFileEntryTypes(dlFolder,currentFolderFileEntryTypeIds,defaultFileEntryTypeId,serviceContext);
  }
}
