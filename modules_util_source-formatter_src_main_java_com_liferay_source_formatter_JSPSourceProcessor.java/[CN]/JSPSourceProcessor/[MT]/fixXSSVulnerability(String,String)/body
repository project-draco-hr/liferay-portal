{
  Matcher matcher1=_xssPattern.matcher(content);
  String jspVariable=null;
  int vulnerabilityPos=-1;
  while (matcher1.find()) {
    jspVariable=matcher1.group(1);
    String anchorVulnerability=" href=\"<%= " + jspVariable + " %>";
    String inputVulnerability=" value=\"<%= " + jspVariable + " %>";
    vulnerabilityPos=Math.max(getTaglibXSSVulnerabilityPos(content,anchorVulnerability),getTaglibXSSVulnerabilityPos(content,inputVulnerability));
    if (vulnerabilityPos != -1) {
      break;
    }
    Pattern pattern=Pattern.compile("('|\\(\"| \"|\\.)<%= " + jspVariable + " %>");
    Matcher matcher2=pattern.matcher(content);
    if (matcher2.find()) {
      vulnerabilityPos=matcher2.start();
      break;
    }
  }
  if (vulnerabilityPos != -1) {
    return StringUtil.replaceFirst(content,"<%= " + jspVariable + " %>","<%= HtmlUtil.escape(" + jspVariable + ") %>",vulnerabilityPos);
  }
  return content;
}
