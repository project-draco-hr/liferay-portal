{
  if (_started.get().booleanValue()) {
    return true;
  }
  try {
    _started.set(true);
    PermissionCollection permissionCollection=null;
    if (_IBM_JVM) {
      permissionCollection=getPermissions(protectionDomain);
      if ((permissionCollection != null) && (!(permissionCollection instanceof PortalPermissionCollection))) {
        Enumeration<Permission> elements=permissionCollection.elements();
        while (elements.hasMoreElements()) {
          Permission curPermission=elements.nextElement();
          if (curPermission instanceof AllPermission) {
            return true;
          }
        }
      }
    }
    if (!(permission instanceof PACLUtil.Permission) && !_paclPolicy.isCheckablePermission(permission)) {
      return _checkWithParentPolicy(protectionDomain,permission);
    }
    if (!_IBM_JVM) {
      permissionCollection=getPermissions(protectionDomain);
    }
    if (permissionCollection instanceof PortalPermissionCollection) {
      if (permissionCollection.implies(permission) || _checkWithPACLPolicyPolicy(protectionDomain,permission,permissionCollection)) {
        return true;
      }
      throw new AccessControlException("access denied " + permission,permission);
    }
    return _checkWithParentPolicy(protectionDomain,permission);
  }
  finally {
    _started.set(false);
  }
}
