{
  if (_started.get().booleanValue()) {
    return true;
  }
  try {
    _started.set(true);
    if (!(permission instanceof PACLUtil.Permission) && ((protectionDomain.getClassLoader() == null) || !_paclPolicy.isCheckablePermission(permission))) {
      return _checkWithParentPolicy(protectionDomain,permission);
    }
    Object key=_getKey(protectionDomain);
    PermissionCollection permissionCollection=getPermissions(protectionDomain);
    if (permissionCollection != null) {
      if (permissionCollection.implies(permission)) {
        return _checkWithParentPolicy(protectionDomain,permission);
      }
 else       if (_checkWithPACLPolicyPolicy(protectionDomain,permission,permissionCollection)) {
        return _checkWithParentPolicy(protectionDomain,permission);
      }
      return false;
    }
    permissionCollection=getPermissions(protectionDomain);
    _permissionCollections.putIfAbsent(key,permissionCollection);
    if (permissionCollection.implies(permission)) {
      return _checkWithParentPolicy(protectionDomain,permission);
    }
 else     if (_checkWithPACLPolicyPolicy(protectionDomain,permission,permissionCollection)) {
      return _checkWithParentPolicy(protectionDomain,permission);
    }
    return false;
  }
  finally {
    _started.set(false);
  }
}
