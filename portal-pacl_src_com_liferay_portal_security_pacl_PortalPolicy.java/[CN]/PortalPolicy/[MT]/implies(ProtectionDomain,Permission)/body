{
  if (_started.get().booleanValue()) {
    return true;
  }
  try {
    _started.set(true);
    PermissionCollection permissionCollection=null;
    if (!(permission instanceof PACLUtil.Permission) && !_paclPolicy.isCheckablePermission(permission)) {
      return _checkWithParentPolicy(protectionDomain,permission);
    }
    if (permissionCollection instanceof PortalPermissionCollection) {
      if (permissionCollection.implies(permission) || _checkWithPACLPolicyPolicy(protectionDomain,permission,permissionCollection)) {
        return true;
      }
      throw new AccessControlException("access denied " + permission,permission);
    }
    return _checkWithParentPolicy(protectionDomain,permission);
  }
  finally {
    _started.set(false);
  }
}
