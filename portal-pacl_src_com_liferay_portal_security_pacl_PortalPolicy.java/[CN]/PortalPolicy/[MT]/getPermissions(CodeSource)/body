{
  if ((codeSource == null) || (codeSource.getLocation() == null)) {
    return new LenientPermissionCollection();
  }
  URL location=codeSource.getLocation();
  URLWrapper urlWrapper=new URLWrapper(location);
  PermissionCollection permissionCollection=_urlPermissionCollections.get(urlWrapper);
  if (permissionCollection != null) {
    return permissionCollection;
  }
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(location);
  if (paclPolicy != null) {
    permissionCollection=new PortalPermissionCollection(paclPolicy);
  }
 else {
    permissionCollection=new LenientPermissionCollection();
  }
  _urlPermissionCollections.put(urlWrapper,permissionCollection);
  return permissionCollection;
}
