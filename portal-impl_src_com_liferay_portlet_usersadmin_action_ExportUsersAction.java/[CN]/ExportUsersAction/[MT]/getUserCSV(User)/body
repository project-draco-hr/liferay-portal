{
  StringBundler sb=new StringBundler(PropsValues.USERS_EXPORT_CSV_FIELDS.length * 2);
  for (int i=0; i < PropsValues.USERS_EXPORT_CSV_FIELDS.length; i++) {
    String field=PropsValues.USERS_EXPORT_CSV_FIELDS[i];
    if (field.equals("fullName")) {
      sb.append(CSVUtil.encode(user.getFullName()));
    }
 else     if (field.startsWith("expando:")) {
      String attributeName=field.substring(8);
      ExpandoBridge expandoBridge=user.getExpandoBridge();
      sb.append(CSVUtil.encode(expandoBridge.getAttribute(attributeName)));
    }
 else {
      sb.append(CSVUtil.encode(BeanPropertiesUtil.getString(user,field)));
    }
    if ((i + 1) < PropsValues.USERS_EXPORT_CSV_FIELDS.length) {
      sb.append(StringPool.COMMA);
    }
  }
  sb.append(StringPool.NEW_LINE);
  return sb.toString();
}
