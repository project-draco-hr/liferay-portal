{
  WikiPage page=null;
  OrderByComparator<WikiPage> orderByComparator=new PageVersionComparator();
  if (status == WorkflowConstants.STATUS_ANY) {
    if (preferApproved) {
      page=wikiPagePersistence.fetchByR_N_S_First(resourcePrimKey,nodeId,WorkflowConstants.STATUS_APPROVED,orderByComparator);
    }
    if (page == null) {
      page=wikiPagePersistence.fetchByR_N_First(resourcePrimKey,nodeId,orderByComparator);
    }
  }
 else {
    page=wikiPagePersistence.fetchByR_N_S_First(resourcePrimKey,nodeId,status,orderByComparator);
  }
  return page;
}
