{
  ResourceBundle resourceBundleA=_createResourceBundle("key","value","this","esto2");
  Map<String,Object> properties=new HashMap<>();
  properties.put("javax.portlet.name",TestPortlet.PORTLET_NAME);
  properties.put("language.id","es_ES");
  Registry registry=RegistryUtil.getRegistry();
  ServiceRegistration<ResourceBundle> serviceRegistration=registry.registerService(ResourceBundle.class,resourceBundleA,properties);
  try {
    PortletConfig portletConfig=_genericPortlet.getPortletConfig();
    Locale locale=LocaleUtil.fromLanguageId("es_ES");
    ResourceBundle resourceBundle=portletConfig.getResourceBundle(locale);
    Assert.assertEquals("value",ResourceBundleUtil.getString(resourceBundle,"key"));
    Assert.assertEquals("esto2",ResourceBundleUtil.getString(resourceBundle,"this"));
  }
  finally {
    serviceRegistration.unregister();
  }
}
