{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=themeDisplay.getScopeGroupIdOrLiveGroupId();
  String jsonSettings=ParamUtil.getString(actionRequest,"jsonSettings");
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject(jsonSettings);
  JSONArray actions=jsonObject.getJSONArray("actions");
  String modelName=jsonObject.getString("modelName");
  for (int i=0; i < actions.length(); i++) {
    JSONObject action=actions.getJSONObject(i);
    int activityType=action.getInt("activityType");
    SocialActivityDefinition activityDefinition=SocialActivitySettingLocalServiceUtil.getActivityDefinition(groupId,modelName,activityType);
    if (Validator.isNotNull(activityDefinition)) {
      List<SocialActivityCounterDefinition> counters=new ArrayList<SocialActivityCounterDefinition>();
      counters.add(updateCounter(action,activityDefinition,SocialActivityCounterConstants.NAME_PARTICIPATION));
      counters.add(updateCounter(action,activityDefinition,SocialActivityCounterConstants.NAME_CONTRIBUTION));
      counters.add(updateCounter(action,activityDefinition,SocialActivityCounterConstants.NAME_POPULARITY));
      SocialActivitySettingLocalServiceUtil.updateActivitySettings(groupId,modelName,activityType,counters);
    }
  }
}
