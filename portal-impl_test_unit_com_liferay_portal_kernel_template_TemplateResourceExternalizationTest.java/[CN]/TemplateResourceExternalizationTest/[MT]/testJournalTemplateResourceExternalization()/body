{
  String templateId="testId";
  final long journalTemplateId=100;
  JournalTemplate journalTemplate=(JournalTemplate)ProxyUtil.newProxyInstance(getClass().getClassLoader(),new Class<?>[]{JournalTemplate.class},new InvocationHandler(){
    public Object invoke(    Object proxy,    Method method,    Object[] arguments) throws Throwable {
      String methodName=method.getName();
      if (methodName.equals("getId")) {
        return journalTemplateId;
      }
      throw new UnsupportedOperationException();
    }
  }
);
  JournalTemplateResource journalTemplateResource=new JournalTemplateResource(templateId,journalTemplate);
  UnsyncByteArrayOutputStream unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream();
  ObjectOutput objectOutput=new MockObjectOutput(unsyncByteArrayOutputStream);
  journalTemplateResource.writeExternal(objectOutput);
  objectOutput.close();
  byte[] externalizedData=unsyncByteArrayOutputStream.toByteArray();
  DataInputStream dataInputStream=new DataInputStream(new UnsyncByteArrayInputStream(externalizedData));
  Assert.assertEquals(journalTemplateId,dataInputStream.readLong());
  Assert.assertEquals(templateId,dataInputStream.readUTF());
  JournalTemplateResource newJournalTemplateResource=new JournalTemplateResource();
  MockObjectInput mockObjectInput=new MockObjectInput(new DataInputStream(new UnsyncByteArrayInputStream(externalizedData)));
  UnsyncByteArrayOutputStream hijackedUnsyncByteArrayOutputStream=ConsoleTestUtil.hijackStdErr();
  try {
    newJournalTemplateResource.readExternal(mockObjectInput);
    Assert.fail();
  }
 catch (  IOException ioe) {
    Assert.assertEquals("Unable to retrieve journal template with ID " + journalTemplateId,ioe.getMessage());
  }
 finally {
    ConsoleTestUtil.restoreStdErr(hijackedUnsyncByteArrayOutputStream);
  }
  Assert.assertEquals(null,newJournalTemplateResource.getTemplateId());
}
