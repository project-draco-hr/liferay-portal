{
  template=VelocityUtil.evaluate(template);
  BufferedReader br=new BufferedReader(new StringReader(template));
  StringBuffer sb=new StringBuffer();
  String line=null;
  while ((line=br.readLine()) != null) {
    line=line.trim();
    sb.append(line);
    sb.append("\n");
  }
  br.close();
  template=sb.toString();
  template=StringUtil.replace(template,"\n\n\n","\n\n");
  return template;
}
