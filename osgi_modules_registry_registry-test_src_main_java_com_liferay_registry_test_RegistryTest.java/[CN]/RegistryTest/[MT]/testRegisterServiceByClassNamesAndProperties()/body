{
  Registry registry=RegistryUtil.getRegistry();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("a.property","E");
  properties.put("b.property","F");
  ServiceRegistration<?> serviceRegistration=registry.registerService(new String[]{InterfaceOne.class.getName(),InterfaceTwo.class.getName()},new InterfaceBoth(){
  }
,properties);
  Assert.assertNotNull(serviceRegistration);
  ServiceReference<?> serviceReference=serviceRegistration.getServiceReference();
  Assert.assertNotNull(serviceReference);
  Assert.assertEquals(serviceReference.getProperty("a.property"),"E");
  Assert.assertEquals(serviceReference.getProperty("b.property"),"F");
  Assert.assertNull(serviceReference.getProperty("c.property"));
  serviceRegistration.unregister();
  Object registeredOne=registry.getService(serviceReference);
  Assert.assertNull(registeredOne);
}
