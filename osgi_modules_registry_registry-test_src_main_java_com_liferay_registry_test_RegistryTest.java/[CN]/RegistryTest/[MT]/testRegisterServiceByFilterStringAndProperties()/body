{
  Registry registry=RegistryUtil.getRegistry();
  InterfaceOne one=getInstance();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("a.property","C");
  properties.put("b.property","D");
  ServiceRegistration<InterfaceOne> serviceRegistration=registry.registerService(InterfaceOne.class.getName(),one,properties);
  Assert.assertNotNull(serviceRegistration);
  ServiceReference<InterfaceOne> serviceReference=serviceRegistration.getServiceReference();
  Assert.assertNotNull(serviceReference);
  Assert.assertEquals(serviceReference.getProperty("a.property"),"C");
  Assert.assertEquals(serviceReference.getProperty("b.property"),"D");
  Assert.assertNull(serviceReference.getProperty("c.property"));
  serviceRegistration.unregister();
  InterfaceOne registeredOne=registry.getService(serviceReference);
  Assert.assertNull(registeredOne);
}
