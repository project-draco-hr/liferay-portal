{
  Registry registry=RegistryUtil.getRegistry();
  InterfaceOne one=getInstance();
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("a.property","A");
  properties.put("b.property","B");
  ServiceRegistration<InterfaceOne> serviceRegistration=registry.registerService(InterfaceOne.class,one,properties);
  Assert.assertNotNull(serviceRegistration);
  ServiceReference<InterfaceOne> serviceReference=serviceRegistration.getServiceReference();
  Assert.assertNotNull(serviceReference);
  Assert.assertEquals(serviceReference.getProperty("a.property"),"A");
  Assert.assertEquals(serviceReference.getProperty("b.property"),"B");
  Assert.assertNull(serviceReference.getProperty("c.property"));
  serviceRegistration.unregister();
  InterfaceOne actual=registry.getService(serviceReference);
  Assert.assertNull(actual);
}
