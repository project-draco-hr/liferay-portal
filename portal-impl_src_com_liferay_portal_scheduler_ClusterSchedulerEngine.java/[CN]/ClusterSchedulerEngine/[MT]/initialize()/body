{
  try {
    ReadWriteLock readWriteLock=new ReentrantReadWriteLock();
    _readLock=readWriteLock.readLock();
    _writeLock=readWriteLock.writeLock();
    if (!ClusterMasterExecutorUtil.isMaster()) {
      initMemoryClusteredJobs();
    }
    _schedulerClusterMasterTokenTransitionListener=new SchedulerClusterMasterTokenTransitionListener();
    ClusterMasterExecutorUtil.registerClusterMasterTokenTransitionListener(_schedulerClusterMasterTokenTransitionListener);
  }
 catch (  Exception e) {
    throw new SchedulerException("Unable to initialize scheduler",e);
  }
}
