{
  long[] filteredRoles=roleIds;
  for (  long roleId : roleIds) {
    UserGroupRolePermissionUtil.check(getPermissionChecker(),groupId,roleId);
    Role role=roleLocalService.getRole(roleId);
    if (GroupPermissionUtil.hasRoleProtected(getPermissionChecker(),groupId,userId,role)) {
      filteredRoles=ArrayUtil.remove(filteredRoles,roleId);
    }
 else     if (OrganizationPermissionUtil.hasRoleProtected(getPermissionChecker(),groupId,userId,role)) {
      filteredRoles=ArrayUtil.remove(filteredRoles,roleId);
    }
  }
  if (filteredRoles.length == 0) {
    return;
  }
  checkDeleteUserGroupRolesMembershipPolicy(new long[]{userId},groupId,filteredRoles);
  userGroupRoleLocalService.deleteUserGroupRoles(userId,groupId,filteredRoles);
}
