{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long plid=getPlid(themeDisplay);
  long controlPanelPlid=PortalUtil.getControlPanelPlid(themeDisplay.getCompanyId());
  if (plid == controlPanelPlid) {
    return PortalUtil.getControlPanelPortletURL(request,getPortletId(),0,PortletRequest.RENDER_PHASE);
  }
 else {
    return PortletURLFactoryUtil.create(request,getPortletId(),plid,PortletRequest.RENDER_PHASE);
  }
}
