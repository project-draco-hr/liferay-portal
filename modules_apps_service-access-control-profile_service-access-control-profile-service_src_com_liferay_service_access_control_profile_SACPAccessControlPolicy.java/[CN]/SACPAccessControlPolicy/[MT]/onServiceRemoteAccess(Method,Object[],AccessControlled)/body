{
  List<String> serviceAccessControlProfileNames=ServiceAccessControlProfileThreadLocal.getActiveServiceAccessControlProfileNames();
  if (serviceAccessControlProfileNames == null) {
    return;
  }
  long companyId=CompanyThreadLocal.getCompanyId();
  Set<String> allowedServiceSignatures=new HashSet<>();
  for (  String name : serviceAccessControlProfileNames) {
    try {
      SACPEntry sacpEntry=_sacpEntryLocalService.getSACPEntry(companyId,name);
      allowedServiceSignatures.addAll(sacpEntry.getAllowedServiceSignaturesList());
    }
 catch (    PortalException pe) {
      throw new SecurityException(pe);
    }
  }
  Class<?> clazz=method.getDeclaringClass();
  String className=clazz.getName();
  if (allowedServiceSignatures.contains(className)) {
    return;
  }
  String methodName=method.getName();
  String classNameAndMethodName=className.concat(StringPool.POUND).concat(methodName);
  if (allowedServiceSignatures.contains(classNameAndMethodName)) {
    return;
  }
  for (  String allowedService : allowedServiceSignatures) {
    if (matches(className,methodName,allowedService)) {
      return;
    }
  }
  throw new SecurityException("Access denied to " + classNameAndMethodName);
}
