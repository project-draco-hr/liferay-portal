{
  Element rootElement=getMacroRootElement(macroName);
  if (rootElement == null) {
    return;
  }
  String macroFileName=getMacroFileName(macroName);
  List<Element> varElements=_seleniumBuilderFileUtil.getAllChildElements(rootElement,"var");
  for (  Element varElement : varElements) {
    String varName=varElement.attributeValue("name");
    String varPath=varElement.attributeValue("path");
    String varLocatorKey=varElement.attributeValue("locator-key");
    if (!Validator.isNull(varPath) && !Validator.isNull(varLocatorKey)) {
      if (!_pathRootElements.containsKey(varPath)) {
        _seleniumBuilderFileUtil.throwValidationException(1014,macroFileName,varElement,varPath);
      }
      if (!_isValidLocatorKey(varPath,null,varLocatorKey)) {
        _seleniumBuilderFileUtil.throwValidationException(1010,macroFileName,varElement,varLocatorKey);
      }
    }
  }
  List<Element> commandElements=_seleniumBuilderFileUtil.getAllChildElements(rootElement,"command");
  Set<String> commandElementNames=new HashSet<String>();
  for (  Element commandElement : commandElements) {
    String commandName=commandElement.attributeValue("name");
    if (commandElementNames.contains(commandName)) {
      _seleniumBuilderFileUtil.throwValidationException(1009,macroFileName,commandElement,commandName);
    }
 else {
      commandElementNames.add(commandName);
    }
  }
  List<Element> conditionAndExecuteElements=_seleniumBuilderFileUtil.getAllChildElements(rootElement,"condition");
  conditionAndExecuteElements.addAll(_seleniumBuilderFileUtil.getAllChildElements(rootElement,"execute"));
  for (  Element conditionAndExecuteElement : conditionAndExecuteElements) {
    String action=conditionAndExecuteElement.attributeValue("action");
    String macro=conditionAndExecuteElement.attributeValue("macro");
    if (action != null) {
      _validateActionElement(macroFileName,conditionAndExecuteElement);
    }
 else     if (macro != null) {
      _validateMacroElement(macroFileName,conditionAndExecuteElement);
    }
  }
}
