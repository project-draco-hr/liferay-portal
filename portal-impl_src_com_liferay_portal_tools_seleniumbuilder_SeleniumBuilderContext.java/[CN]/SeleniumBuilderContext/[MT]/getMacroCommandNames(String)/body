{
  Set<String> commandNames=new TreeSet<String>();
  Element macroRootElement=getMacroRootElement(macroName);
  List<Element> macroCommandElements=macroRootElement.elements("command");
  for (  Element macroCommandElement : macroCommandElements) {
    commandNames.add(macroCommandElement.attributeValue("name"));
  }
  String extendsName=macroRootElement.attributeValue("extends");
  if (extendsName != null) {
    Element extendsRootElement=getMacroRootElement(extendsName);
    List<Element> extendsCommandElements=extendsRootElement.elements("command");
    for (    Element extendsCommandElement : extendsCommandElements) {
      commandNames.add(extendsCommandElement.attributeValue("name"));
    }
  }
  return commandNames;
}
