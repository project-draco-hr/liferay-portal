{
  try {
    Indexer<?> indexer=AssetSearcher.getInstance();
    AssetSearcher assetSearcher=(AssetSearcher)indexer;
    AssetEntryQuery assetEntryQuery=new AssetEntryQuery();
    assetEntryQuery.setClassNameIds(getClassNameIds(companyId,className));
    assetEntryQuery.setAttribute("showInvisible",showInvisible);
    String[] assetTagNamesArray=StringUtil.split(assetTagNames);
    if (andSearch) {
      assetEntryQuery.setAnyCategoryIds(StringUtil.split(assetCategoryIds,0L));
      for (      String assetTagName : assetTagNamesArray) {
        long[] allAssetTagIds=getTagIds(groupIds,assetTagName);
        assetEntryQuery.addAllTagIdsArray(allAssetTagIds);
      }
    }
 else {
      assetEntryQuery.setAllCategoryIds(StringUtil.split(assetCategoryIds,0L));
      if (ArrayUtil.isNotEmpty(assetTagNamesArray)) {
        assetEntryQuery.setAnyTagIds(getTagIds(groupIds,assetTagNames));
      }
    }
    SearchContext searchContext=buildSearchContext(companyId,groupIds,userId,classTypeId,userName,title,description,assetCategoryIds,assetTagNames,showNonindexable,statuses,andSearch,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
    QueryConfig queryConfig=searchContext.getQueryConfig();
    queryConfig.setHighlightEnabled(false);
    queryConfig.setScoreEnabled(false);
    assetSearcher.setAssetEntryQuery(assetEntryQuery);
    return assetSearcher.searchCount(searchContext);
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
