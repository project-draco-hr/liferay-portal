{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  FileEntry fileEntry=ExportImportHelperUtil.getTempFileEntry(groupId,themeDisplay.getUserId(),folderName);
  InputStream inputStream=null;
  try {
    inputStream=DLFileEntryLocalServiceUtil.getFileAsStream(themeDisplay.getUserId(),fileEntry.getFileEntryId(),fileEntry.getVersion(),false);
    importData(actionRequest,inputStream,fileEntry.getTitle());
    deleteTempFileEntry(groupId,folderName);
    addSuccessMessage(actionRequest,actionResponse);
  }
  finally {
    StreamUtil.cleanUp(inputStream);
  }
}
