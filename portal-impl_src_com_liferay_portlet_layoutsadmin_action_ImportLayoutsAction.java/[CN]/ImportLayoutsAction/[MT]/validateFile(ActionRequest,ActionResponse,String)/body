{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  FileEntry fileEntry=ExportImportHelperUtil.getTempFileEntry(groupId,themeDisplay.getUserId(),folderName);
  InputStream inputStream=null;
  try {
    inputStream=DLFileEntryLocalServiceUtil.getFileAsStream(themeDisplay.getUserId(),fileEntry.getFileEntryId(),fileEntry.getVersion(),false);
    boolean privateLayout=ParamUtil.getBoolean(actionRequest,"privateLayout");
    MissingReferences missingReferences=validateFile(actionRequest,inputStream);
    Map<String,MissingReference> weakMissingReferences=missingReferences.getWeakMissingReferences();
    if (weakMissingReferences.isEmpty()) {
      return;
    }
    JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
    if ((weakMissingReferences != null) && (weakMissingReferences.size() > 0)) {
      jsonObject.put("warningMessages",StagingUtil.getWarningMessagesJSONArray(themeDisplay.getLocale(),weakMissingReferences,null));
    }
    writeJSON(actionRequest,actionResponse,jsonObject);
  }
  finally {
    StreamUtil.cleanUp(inputStream);
  }
}
