{
  addUsers();
  addRequiredSites();
  int expectedUserGroupCount=UserLocalServiceUtil.getGroupUsersCount(getRequiredSiteIds()[0]) + addedUsers(1);
  User user=UserLocalServiceUtil.getUser(getUserIds()[0]);
  MembershipPolicyTestUtil.updateUser(user,null,null,new long[]{getRequiredSiteIds()[0]},null,Collections.<UserGroupRole>emptyList());
  int currentUserGroupCount=UserLocalServiceUtil.getGroupUsersCount(getRequiredSiteIds()[0]);
  Assert.assertEquals(expectedUserGroupCount,currentUserGroupCount);
  Assert.assertTrue(getPropagateMembershipMethodFlag());
}
