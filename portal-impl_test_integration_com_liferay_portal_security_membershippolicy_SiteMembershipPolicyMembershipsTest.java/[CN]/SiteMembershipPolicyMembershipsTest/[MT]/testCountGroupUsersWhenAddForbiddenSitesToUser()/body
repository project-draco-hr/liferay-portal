{
  addUsers();
  addForbiddenSites();
  int expectedUsersInFirstForbiddenGroupCount=UserLocalServiceUtil.getGroupUsersCount(getForbiddenSiteIds()[0]);
  int expectedUsersInSecondForbiddenGroupCount=UserLocalServiceUtil.getGroupUsersCount(getForbiddenSiteIds()[1]);
  User user=UserLocalServiceUtil.getUser(getUserIds()[0]);
  try {
    MembershipPolicyTestUtil.updateUser(user,null,null,getForbiddenSiteIds(),null,Collections.<UserGroupRole>emptyList());
  }
 catch (  Exception e) {
    if (!(e instanceof MembershipPolicyException)) {
      Assert.fail("Exception Throwing :" + e.getClass().getName());
    }
  }
  int currentUsersInFirstForbiddenGroupCount=UserLocalServiceUtil.getGroupUsersCount(getForbiddenSiteIds()[0]);
  int currentUsersInSecondForbiddenGroupCount=UserLocalServiceUtil.getGroupUsersCount(getForbiddenSiteIds()[1]);
  Assert.assertEquals(expectedUsersInFirstForbiddenGroupCount,currentUsersInFirstForbiddenGroupCount);
  Assert.assertEquals(expectedUsersInSecondForbiddenGroupCount,currentUsersInSecondForbiddenGroupCount);
}
