{
  Connection con=getConnection();
  DatabaseMetaData metaData=con.getMetaData();
  String productName=metaData.getDatabaseProductName();
  if (!productName.equals("Microsoft SQL Server")) {
    return con;
  }
  return (Connection)ProxyUtil.newProxyInstance(Thread.currentThread().getContextClassLoader(),new Class[]{Connection.class},new UpgradeOptimizedConnectionHandler(con));
}
