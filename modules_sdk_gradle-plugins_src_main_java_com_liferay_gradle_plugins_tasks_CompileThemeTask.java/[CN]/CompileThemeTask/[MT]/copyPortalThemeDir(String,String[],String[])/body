{
  final String prefix=theme + "/";
  final File frontendThemesWebDir=getFrontendThemesWebDir();
  if (frontendThemesWebDir != null) {
    _project.copy(new Action<CopySpec>(){
      @Override public void execute(      CopySpec copySpec){
        copySpec.from(new File(frontendThemesWebDir,prefix));
        if (ArrayUtil.isNotEmpty(excludes)) {
          copySpec.exclude(excludes);
        }
        copySpec.include(includes);
        copySpec.into(getThemeRootDir());
      }
    }
);
  }
 else {
    String jarPrefix="META-INF/resources/" + prefix;
    final File frontendThemeFile=getFrontendThemeFile(theme);
    final String[] prefixedExcludes=StringUtil.prepend(excludes,jarPrefix);
    final String[] prefixedIncludes=StringUtil.prepend(includes,jarPrefix);
    _project.copy(new Action<CopySpec>(){
      @Override public void execute(      CopySpec copySpec){
        copySpec.eachFile(new StripPathSegmentsAction(3));
        if (ArrayUtil.isNotEmpty(prefixedExcludes)) {
          copySpec.exclude(prefixedExcludes);
        }
        copySpec.from(_project.zipTree(frontendThemeFile));
        copySpec.include(prefixedIncludes);
        copySpec.into(getThemeRootDir());
        copySpec.setIncludeEmptyDirs(false);
      }
    }
);
  }
}
