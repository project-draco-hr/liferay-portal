{
  Test test=GradleUtil.addTask(project,RUN_POSHI_TASK_NAME,Test.class);
  test.dependsOn(BasePlugin.CLEAN_TASK_NAME + StringUtil.capitalize(RUN_POSHI_TASK_NAME),EXPAND_POSHI_RUNNER_TASK_NAME);
  test.include("com/liferay/poshi/runner/PoshiRunner.class");
  test.setClasspath(getPoshiRunnerClasspath(project));
  test.setDescription("Execute tests using Poshi Runner.");
  test.setGroup("verification");
  test.setScanForTestClasses(false);
  test.setTestClassesDir(getExpandedPoshiRunnerDir(project));
  TestLoggingContainer testLoggingContainer=test.getTestLogging();
  testLoggingContainer.setShowStandardStreams(true);
  test.doFirst(new Action<Task>(){
    @Override public void execute(    Task task){
      Test test=(Test)task;
      Map<String,Object> systemProperties=test.getSystemProperties();
      if (!systemProperties.containsKey("test.name")) {
        throw new GradleException("Please set the property poshiTestName.");
      }
    }
  }
);
  return test;
}
