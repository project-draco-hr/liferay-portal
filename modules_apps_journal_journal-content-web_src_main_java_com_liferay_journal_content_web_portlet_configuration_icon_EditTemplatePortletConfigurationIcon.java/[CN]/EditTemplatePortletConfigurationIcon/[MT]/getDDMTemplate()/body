{
  PortletPreferences portletPreferences=portletRequest.getPreferences();
  String articleId=portletPreferences.getValue("articleId",null);
  if (Validator.isNull(articleId)) {
    return null;
  }
  int status=ParamUtil.getInteger(portletRequest,"status",WorkflowConstants.STATUS_ANY);
  long groupId=ParamUtil.getLong(portletRequest,"groupId",themeDisplay.getScopeGroupId());
  JournalArticle article=JournalArticleServiceUtil.getLatestArticle(groupId,articleId,status);
  DDMTemplate ddmTemplate=article.getDDMTemplate();
  if (ddmTemplate == null) {
    ddmTemplate=DDMTemplateLocalServiceUtil.fetchTemplate(groupId,PortalUtil.getClassNameId(DDMStructure.class),article.getDDMTemplateKey(),true);
  }
  return ddmTemplate;
}
