{
  Layout sourceLayout=_layoutLocalService.getLayout(plid);
  Group stagingGroup=null;
  Group liveGroup=null;
  Layout targetLayout=null;
  if (sourceLayout.isTypeControlPanel()) {
    stagingGroup=_groupLocalService.fetchGroup(scopeGroupId);
    liveGroup=stagingGroup.getLiveGroup();
    targetLayout=sourceLayout;
  }
 else   if (sourceLayout.hasScopeGroup() && (sourceLayout.getScopeGroup().getGroupId() == scopeGroupId)) {
    stagingGroup=sourceLayout.getScopeGroup();
    liveGroup=stagingGroup.getLiveGroup();
    targetLayout=_layoutLocalService.getLayout(liveGroup.getClassPK());
  }
 else {
    stagingGroup=sourceLayout.getGroup();
    liveGroup=stagingGroup.getLiveGroup();
    targetLayout=_layoutLocalService.fetchLayoutByUuidAndGroupId(sourceLayout.getUuid(),liveGroup.getGroupId(),sourceLayout.isPrivateLayout());
  }
  if (copyFromLive) {
    return publishPortlet(userId,liveGroup.getGroupId(),stagingGroup.getGroupId(),targetLayout.getPlid(),sourceLayout.getPlid(),portletId,parameterMap);
  }
  return publishPortlet(userId,stagingGroup.getGroupId(),liveGroup.getGroupId(),sourceLayout.getPlid(),targetLayout.getPlid(),portletId,parameterMap);
}
