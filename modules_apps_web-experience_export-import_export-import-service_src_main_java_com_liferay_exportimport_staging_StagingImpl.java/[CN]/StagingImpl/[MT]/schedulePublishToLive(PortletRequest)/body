{
  long sourceGroupId=ParamUtil.getLong(portletRequest,"stagingGroupId");
  Group sourceGroup=_groupLocalService.getGroup(sourceGroupId);
  long targetGroupId=sourceGroup.getLiveGroupId();
  long exportImportConfigurationId=ParamUtil.getLong(portletRequest,"exportImportConfigurationId");
  Map<String,String[]> parameterMap=null;
  boolean privateLayout=false;
  long[] layoutIds=null;
  if (exportImportConfigurationId > 0) {
    ExportImportConfiguration exportImportConfiguration=_exportImportConfigurationLocalService.fetchExportImportConfiguration(exportImportConfigurationId);
    if (exportImportConfiguration != null) {
      Map<String,Serializable> settingsMap=exportImportConfiguration.getSettingsMap();
      parameterMap=(Map<String,String[]>)settingsMap.get("parameterMap");
      privateLayout=MapUtil.getBoolean(settingsMap,"privateLayout");
      layoutIds=(long[])settingsMap.get("layoutIds");
    }
  }
  if (parameterMap == null) {
    privateLayout=getPrivateLayout(portletRequest);
    layoutIds=ExportImportHelperUtil.getLayoutIds(portletRequest,targetGroupId);
    parameterMap=ExportImportConfigurationParameterMapFactory.buildParameterMap(portletRequest);
  }
  ScheduleInformation scheduleInformation=getScheduleInformation(portletRequest,targetGroupId,false);
  String name=ParamUtil.getString(portletRequest,"name");
  _layoutService.schedulePublishToLive(sourceGroupId,targetGroupId,privateLayout,layoutIds,parameterMap,scheduleInformation.getGroupName(),scheduleInformation.getCronText(),scheduleInformation.getStartCalendar().getTime(),scheduleInformation.getSchedulerEndDate(),name);
}
