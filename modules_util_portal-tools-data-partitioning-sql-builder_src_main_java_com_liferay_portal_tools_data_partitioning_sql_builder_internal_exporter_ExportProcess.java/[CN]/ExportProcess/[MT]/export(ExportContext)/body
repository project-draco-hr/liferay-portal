{
  List<String> partitionedTableNames=_dbExporter.getPartitionedTableNames(exportContext.getSchemaName());
  List<String> controlTableNames=_dbExporter.getControlTableNames(exportContext.getSchemaName());
  List<Long> companyIds=exportContext.getCompanyIds();
  for (  Long companyId : companyIds) {
    ExportProcessCommand deleteExportProcessCommand=new DeleteExportProcessCommand(companyId,_dbExporter,partitionedTableNames,exportContext);
    deleteExportProcessCommand.execute();
    ExportProcessCommand insertPartitionedExportProcessCommand=new InsertPartitionedExportProcessCommand(companyId,_dbExporter,partitionedTableNames,exportContext);
    insertPartitionedExportProcessCommand.execute();
    ExportProcessCommand insertControlExportProcessCommand=new InsertControlExportProcessCommand(companyId,_dbExporter,controlTableNames,exportContext);
    insertControlExportProcessCommand.execute();
  }
}
