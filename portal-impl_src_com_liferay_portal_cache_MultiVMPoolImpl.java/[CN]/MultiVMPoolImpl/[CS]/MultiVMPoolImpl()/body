{
  Registry registry=RegistryUtil.getRegistry();
  StringBundler sb=new StringBundler(7);
  sb.append("(&(objectClass=");
  sb.append(PortalCacheManager.class.getName());
  sb.append(")(portal.cache.manager.name=");
  sb.append(PortalCacheManagerNames.MULTI_VM);
  sb.append(")(portal.cache.manager.type=");
  sb.append(PropsValues.PORTAL_CACHE_MANAGER_TYPE_MULTI_VM);
  sb.append("))");
  Filter filter=registry.getFilter(sb.toString());
  ServiceTracker<PortalCacheManager<? extends Serializable,? extends Serializable>,PortalCacheManager<? extends Serializable,? extends Serializable>> serviceTracker=registry.trackServices(filter);
  serviceTracker.open();
  try {
    _portalCacheManager=SPIPortalCacheManagerConfigurator.createSPIPortalCacheManager(serviceTracker.waitForService(0));
  }
 catch (  Exception e) {
    throw new IllegalStateException("Unable to initialize multi VM pool",e);
  }
}
