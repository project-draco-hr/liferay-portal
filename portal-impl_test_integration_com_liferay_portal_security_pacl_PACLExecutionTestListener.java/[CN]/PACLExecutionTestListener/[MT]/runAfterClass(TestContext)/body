{
  HotDeployEvent hotDeployEvent=_hotDeployEvents.remove(testContext.getClazz());
  if (hotDeployEvent == null) {
    return;
  }
  HotDeployUtil.fireUndeployEvent(hotDeployEvent);
  PortletContextLoaderListener portletContextLoaderListener=new PortletContextLoaderListener();
  try {
    PortletClassLoaderUtil.setClassLoader(hotDeployEvent.getContextClassLoader());
    PortletClassLoaderUtil.setServletContextName(hotDeployEvent.getServletContextName());
    portletContextLoaderListener.contextDestroyed(new ServletContextEvent(hotDeployEvent.getServletContext()));
  }
  finally {
    PortletClassLoaderUtil.setClassLoader(null);
    PortletClassLoaderUtil.setServletContextName(null);
  }
}
