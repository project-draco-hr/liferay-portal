{
  PortletURL portletURL=null;
  MBThread thread=_mbThreadLocalService.getThread(classPK);
  String portletId=PortletProviderUtil.getPortletId(MBThread.class.getName(),PortletProvider.Action.EDIT);
  long plid=PortalUtil.getPlidFromPortletId(thread.getGroupId(),portletId);
  if (plid == LayoutConstants.DEFAULT_PLID) {
    portletId=PortletProviderUtil.getPortletId(MBThread.class.getName(),PortletProvider.Action.MANAGE);
    portletURL=PortalUtil.getControlPanelPortletURL(portletRequest,portletId,PortletRequest.RENDER_PHASE);
  }
 else {
    portletURL=PortletURLFactoryUtil.create(portletRequest,portletId,plid,PortletRequest.RENDER_PHASE);
  }
  if (containerModel) {
    String mvcRenderCommandName="/message_boards/view";
    if (thread.getCategoryId() != MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID) {
      mvcRenderCommandName="/message_boards/view_category";
    }
    portletURL.setParameter("mvcRenderCommandName",mvcRenderCommandName);
  }
 else {
    portletURL.setParameter("mvcRenderCommandName","/message_boards/view_message");
  }
  return portletURL;
}
