{
  ResourceBundleLoader resourceBundleLoader=(ResourceBundleLoader)request.getAttribute(WebKeys.RESOURCE_BUNDLE_LOADER);
  if (resourceBundleLoader == null) {
    ServletContext servletContext=request.getServletContext();
    String servletContextName=servletContext.getServletContextName();
    if (Validator.isNull(servletContextName)) {
      return null;
    }
    resourceBundleLoader=ResourceBundleLoaderUtil.getResourceBundleLoaderByServletContextName(servletContextName);
  }
  if (resourceBundleLoader == null) {
    return ResourceBundleLoaderUtil.getPortalResourceBundleLoader();
  }
 else {
    return new AggregateResourceBundleLoader(resourceBundleLoader,ResourceBundleLoaderUtil.getPortalResourceBundleLoader());
  }
}
