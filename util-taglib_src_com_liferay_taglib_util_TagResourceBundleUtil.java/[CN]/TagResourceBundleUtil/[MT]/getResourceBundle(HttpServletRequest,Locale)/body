{
  ServletContext servletContext=request.getServletContext();
  String servletContextName=servletContext.getServletContextName();
  ResourceBundleLoader resourceBundleLoader=null;
  if (Validator.isNotNull(servletContextName)) {
    resourceBundleLoader=ResourceBundleLoaderUtil.getResourceBundleLoaderByServletContextName(servletContext.getServletContextName());
  }
  if (resourceBundleLoader != null) {
    return resourceBundleLoader.loadResourceBundle(LanguageUtil.getLanguageId(locale));
  }
  ResourceBundle portletResourceBundle=getPortletResourceBundle(request,locale);
  ResourceBundle portalResourceBundle=PortalUtil.getResourceBundle(locale);
  return new AggregateResourceBundle(portletResourceBundle,portalResourceBundle);
}
