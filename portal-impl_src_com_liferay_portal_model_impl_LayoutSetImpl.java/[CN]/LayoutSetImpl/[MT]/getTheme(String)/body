{
  boolean controlPanel=false;
  try {
    Group group=getGroup();
    controlPanel=group.isControlPanel();
  }
 catch (  Exception e) {
  }
  if (controlPanel) {
    String themeId=PrefsPropsUtil.getString(getCompanyId(),PropsKeys.CONTROL_PANEL_LAYOUT_REGULAR_THEME_ID);
    return ThemeLocalServiceUtil.getTheme(getCompanyId(),themeId,!device.equals("regular"));
  }
 else   if (device.equals("regular")) {
    return getTheme();
  }
 else {
    return getWapTheme();
  }
}
