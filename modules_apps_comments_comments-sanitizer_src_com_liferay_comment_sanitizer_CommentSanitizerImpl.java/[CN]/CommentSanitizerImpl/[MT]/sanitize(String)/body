{
  HtmlPolicyBuilder htmlPolicyBuilder=new HtmlPolicyBuilder();
  htmlPolicyBuilder.allowStandardUrlProtocols();
  Map<String,String[]> attributeNames=_commentAllowedContent.getAttributeNames();
  for (  String elementName : attributeNames.keySet()) {
    String[] attributesNames=attributeNames.get(elementName);
    if (attributesNames != null) {
      HtmlPolicyBuilder.AttributeBuilder attributeBuilder=htmlPolicyBuilder.allowAttributes(attributesNames);
      attributeBuilder.onElements(elementName);
    }
    htmlPolicyBuilder.allowElements(elementName);
  }
  PolicyFactory policyFactory=htmlPolicyBuilder.toFactory();
  return policyFactory.sanitize(html);
}
