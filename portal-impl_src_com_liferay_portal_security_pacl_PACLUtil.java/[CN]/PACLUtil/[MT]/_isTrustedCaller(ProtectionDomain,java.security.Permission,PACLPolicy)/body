{
  if (protectionDomain.getClassLoader() == null) {
    return true;
  }
  PortalSecurityManager portalSecurityManager=SecurityManagerUtil.getPortalSecurityManager();
  Policy portalPolicy=portalSecurityManager.getPolicy();
  PermissionCollection permissionCollection=portalPolicy.getPermissions(protectionDomain);
  if (!_hasSameOrigin(protectionDomain,permissionCollection,paclPolicy) && permissionCollection.implies(permission)) {
    return true;
  }
  return false;
}
