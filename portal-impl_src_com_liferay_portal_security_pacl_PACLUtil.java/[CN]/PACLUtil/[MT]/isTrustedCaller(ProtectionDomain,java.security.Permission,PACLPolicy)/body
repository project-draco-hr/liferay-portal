{
  if (protectionDomain.getClassLoader() == null) {
    return true;
  }
  PortalSecurityManager portalSecurityManager=SecurityManagerUtil.getPortalSecurityManager();
  Policy portalPolicy=portalSecurityManager.getPolicy();
  PermissionCollection permissionCollection=portalPolicy.getPermissions(protectionDomain);
  boolean hasSameOrigin=hasSameOrigin(protectionDomain,permissionCollection,paclPolicy);
  if (!hasSameOrigin && permissionCollection.implies(permission)) {
    return true;
  }
  return false;
}
