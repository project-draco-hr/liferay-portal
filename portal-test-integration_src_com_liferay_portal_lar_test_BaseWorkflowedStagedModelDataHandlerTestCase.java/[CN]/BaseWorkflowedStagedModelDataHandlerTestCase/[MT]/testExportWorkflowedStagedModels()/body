{
  initExport();
  List<StagedModel> stagedModels=null;
  boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
  try {
    WorkflowThreadLocal.setEnabled(true);
    stagedModels=addWorkflowedStagedModels(stagingGroup);
  }
  finally {
    WorkflowThreadLocal.setEnabled(workflowEnabled);
  }
  for (  StagedModel stagedModel : stagedModels) {
    Assert.assertTrue("Staged model is not a workflowed model",stagedModel instanceof WorkflowedModel);
    try {
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,stagedModel);
    }
 catch (    PortletDataException pde) {
      Assert.assertEquals("An unexpected error occurred during the export",PortletDataException.STATUS_UNAVAILABLE,pde.getType());
    }
    validateWorkflowedExport(portletDataContext,stagedModel);
  }
}
