{
  Set<String> keys=new HashSet<String>();
  for (  String key : typeSettingsProperties.keySet()) {
    if (key.contains(StagingConstants.STAGED_PORTLET)) {
      keys.add(key);
    }
  }
  for (  String key : keys) {
    String portletId=StringUtil.replace(key,StagingConstants.STAGED_PORTLET,StringPool.BLANK);
    Portlet portlet=PortletLocalServiceUtil.getPortletById(portletId);
    if (portlet == null) {
      typeSettingsProperties.remove(key);
      if (_log.isInfoEnabled()) {
        _log.info("removing type settings property: " + key);
      }
      continue;
    }
    PortletDataHandler portletDataHandler=portlet.getPortletDataHandlerInstance();
    if ((portletDataHandler == null) || !portletDataHandler.isDataSiteLevel()) {
      typeSettingsProperties.remove(key);
      if (_log.isInfoEnabled()) {
        _log.info("removing type settings property: " + key);
      }
    }
  }
}
