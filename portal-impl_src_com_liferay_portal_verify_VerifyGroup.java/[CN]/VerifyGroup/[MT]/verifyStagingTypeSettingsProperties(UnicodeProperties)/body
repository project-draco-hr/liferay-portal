{
  Set<String> keys=typeSettingsProperties.keySet();
  Iterator<String> iterator=keys.iterator();
  while (iterator.hasNext()) {
    String key=iterator.next();
    if (!key.contains(StagingConstants.STAGED_PORTLET)) {
      continue;
    }
    String portletId=StringUtil.replace(key,StagingConstants.STAGED_PORTLET,StringPool.BLANK);
    Portlet portlet=PortletLocalServiceUtil.getPortletById(portletId);
    if (portlet == null) {
      if (_log.isInfoEnabled()) {
        _log.info("Removing type settings property: " + key);
      }
      iterator.remove();
      continue;
    }
    PortletDataHandler portletDataHandler=portlet.getPortletDataHandlerInstance();
    if ((portletDataHandler == null) || !portletDataHandler.isDataSiteLevel()) {
      if (_log.isInfoEnabled()) {
        _log.info("Removing type settings property: " + key);
      }
      iterator.remove();
    }
  }
}
