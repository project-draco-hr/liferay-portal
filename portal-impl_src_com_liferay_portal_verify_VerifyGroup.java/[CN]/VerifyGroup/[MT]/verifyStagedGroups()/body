{
  List<Group> groups=GroupLocalServiceUtil.getLiveGroups();
  for (  Group group : groups) {
    if (!group.hasStagingGroup()) {
      continue;
    }
    UnicodeProperties typeSettingsProperties=group.getTypeSettingsProperties();
    typeSettingsProperties.setProperty("staged",Boolean.TRUE.toString());
    typeSettingsProperties.setProperty("stagedRemotely",Boolean.FALSE.toString());
    GroupLocalServiceUtil.updateGroup(group.getGroupId(),typeSettingsProperties.toString());
    if (group.isOrganization()) {
      Group stagingGroup=group.getStagingGroup();
      long classNameId=PortalUtil.getClassNameId(Organization.class.getName().concat(".staging"));
      stagingGroup.setClassNameId(classNameId);
      stagingGroup.setName(group.getDescriptiveName().concat(" (Staging)"));
      GroupLocalServiceUtil.updateGroup(stagingGroup,false);
    }
  }
}
