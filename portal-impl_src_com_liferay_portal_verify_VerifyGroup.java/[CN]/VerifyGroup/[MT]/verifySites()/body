{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    ActionableDynamicQuery actionableDynamicQuery=GroupLocalServiceUtil.getActionableDynamicQuery();
    actionableDynamicQuery.setAddCriteriaMethod(new ActionableDynamicQuery.AddCriteriaMethod(){
      @Override public void addCriteria(      DynamicQuery dynamicQuery){
        dynamicQuery.add(RestrictionsFactoryUtil.eq("classNameId",PortalUtil.getClassNameId(Organization.class)));
        dynamicQuery.add(RestrictionsFactoryUtil.eq("site",false));
      }
    }
);
    actionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod<Group>(){
      @Override public void performAction(      Group group) throws PortalException {
        if ((group.getPrivateLayoutsPageCount() > 0) || (group.getPublicLayoutsPageCount() > 0)) {
          group.setSite(true);
          GroupLocalServiceUtil.updateGroup(group);
        }
      }
    }
);
    actionableDynamicQuery.setParallel(true);
    actionableDynamicQuery.performActions();
  }
 }
