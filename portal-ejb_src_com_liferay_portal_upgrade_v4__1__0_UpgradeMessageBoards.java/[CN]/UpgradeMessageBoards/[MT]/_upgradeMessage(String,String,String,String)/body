{
  Connection con=null;
  PreparedStatement ps=null;
  try {
    con=DataAccess.getConnection(Constants.DATA_SOURCE);
    ps=con.prepareStatement(_UPGRADE_MESSAGE_2);
    ps.setString(1,categoryId);
    ps.setString(2,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(3,newMessageId);
    ps.setString(4,topicId);
    ps.setString(5,oldMessageId);
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_3);
    ps.setString(1,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(2,newMessageId);
    ps.setString(3,topicId);
    ps.setString(4,oldMessageId);
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_4);
    ps.setString(1,categoryId);
    ps.setString(2,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(3,newMessageId);
    ps.setString(4,topicId);
    ps.setString(5,oldMessageId);
    ps.executeUpdate();
  }
  finally {
    DataAccess.cleanUp(con,ps);
  }
}
