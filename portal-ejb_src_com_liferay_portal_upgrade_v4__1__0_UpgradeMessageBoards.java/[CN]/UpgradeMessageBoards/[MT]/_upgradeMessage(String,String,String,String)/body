{
  Connection con=null;
  PreparedStatement ps=null;
  try {
    con=DataAccess.getConnection(Constants.DATA_SOURCE);
    ps=con.prepareStatement(_UPGRADE_MESSAGE_3);
    ps.setString(1,categoryId);
    ps.setString(2,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(3,newMessageId);
    ps.setString(4,topicId);
    ps.setString(5,oldMessageId);
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_4);
    ps.setString(1,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(2,newMessageId);
    ps.setString(3,topicId);
    ps.setString(4,oldMessageId);
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_5);
    ps.setString(1,categoryId);
    ps.setString(2,MBMessage.DEPRECATED_TOPIC_ID);
    ps.setString(3,newMessageId);
    ps.setString(4,topicId);
    ps.setString(5,oldMessageId);
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_6);
    ps.setString(1,"ADD_MESSAGE");
    ps.setString(2,"ADD_TOPIC");
    ps.executeUpdate();
    ps=con.prepareStatement(_UPGRADE_MESSAGE_7);
    ps.setString(1,"{topicId=" + MBMessage.DEPRECATED_TOPIC_ID + ", messageId="+ newMessageId+ "}");
    ps.setString(2,MBMessage.class.getName());
    ps.setString(3,"{topicId=" + topicId + ", messageId="+ oldMessageId+ "}");
    ps.executeUpdate();
  }
  finally {
    DataAccess.cleanUp(con,ps);
  }
}
