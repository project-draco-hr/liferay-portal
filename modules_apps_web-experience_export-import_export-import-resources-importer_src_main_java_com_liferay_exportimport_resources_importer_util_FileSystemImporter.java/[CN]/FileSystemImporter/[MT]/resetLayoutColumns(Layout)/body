{
  UnicodeProperties typeSettings=layout.getTypeSettingsProperties();
  Set<String> typeSettingsKeys=typeSettings.keySet();
  Set<String> columnsToRemove=new HashSet<>();
  for (  String key : typeSettingsKeys) {
    if (key.startsWith("column-")) {
      String portletIds=typeSettings.get(key);
      columnsToRemove.add(key);
      String[] portletIdsArray=StringUtil.split(portletIds);
      for (      String portletId : portletIdsArray) {
        try {
          portletPreferencesLocalService.deletePortletPreferences(PortletKeys.PREFS_OWNER_ID_DEFAULT,PortletKeys.PREFS_OWNER_TYPE_LAYOUT,layout.getPlid(),portletId);
        }
 catch (        PortalException pe) {
          if (_log.isWarnEnabled()) {
            _log.warn("Unable to delete portlet preferences for " + "portlet " + portletId,pe);
          }
        }
      }
    }
  }
  typeSettingsKeys.removeAll(columnsToRemove);
  layout.setTypeSettingsProperties(typeSettings);
  layoutLocalService.updateLayout(layout);
}
