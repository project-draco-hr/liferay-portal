{
  WSRPPortlet portlet=null;
  if (portletKey != null) {
    portlet=_consumerEnv.getPortletRegistry().getPortlet(portletKey);
    if (portlet == null) {
      String parentHandle=preferences.getValue("parent-handle",StringPool.BLANK);
      if (Validator.isNull(parentHandle)) {
        parentHandle=preferences.getValue("portlet-handle",StringPool.BLANK);
        ;
      }
      portlet=_createPortlet(portletKey,parentHandle);
      _consumerEnv.getPortletRegistry().addPortlet(portlet);
    }
  }
  return portlet;
}
