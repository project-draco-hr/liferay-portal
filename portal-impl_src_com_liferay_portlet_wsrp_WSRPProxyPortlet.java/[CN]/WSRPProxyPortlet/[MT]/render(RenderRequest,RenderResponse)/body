{
  Exception producerConfigError=null;
  try {
    Producer producer=_getProducer(request.getPreferences());
    request.setAttribute(WebKeys.WSRP_PRODUCER,producer);
  }
 catch (  WSRPException e) {
    producerConfigError=e;
    SessionMessages.add(request,_portletConfig.getPortletName() + ".configError",e);
  }
  PortletMode mode=request.getPortletMode();
  if (mode.equals(PortletMode.VIEW)) {
    if (producerConfigError == null) {
      _renderRemote(request,response);
    }
 else {
      super.render(request,response);
    }
  }
 else {
    boolean remoteInvocation=ParamUtil.get(request,REMOTE_INVOCATION,false);
    if (remoteInvocation && producerConfigError == null) {
      _renderRemote(request,response);
    }
 else {
      super.render(request,response);
    }
  }
}
