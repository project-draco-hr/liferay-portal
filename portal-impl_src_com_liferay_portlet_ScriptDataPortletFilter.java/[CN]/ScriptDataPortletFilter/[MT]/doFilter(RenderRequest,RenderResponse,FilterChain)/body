{
  filterChain.doFilter(renderRequest,renderResponse);
  HttpServletRequest request=PortalUtil.getHttpServletRequest(renderRequest);
  ScriptData scriptData=(ScriptData)request.getAttribute(WebKeys.AUI_SCRIPT_DATA);
  if (scriptData == null) {
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (themeDisplay.isIsolated() || themeDisplay.isStateExclusive()) {
    _flushScriptData(request,scriptData,_getMimeResponseImpl(renderResponse));
  }
}
