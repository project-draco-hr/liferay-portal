{
  String[] portletIds=searchContext.getPortletIds();
  if ((portletIds == null) || (portletIds.length == 0)) {
    contextQuery.addRequiredTerm(Field.PORTLET_ID,getPortletId(searchContext));
  }
 else {
    BooleanQuery portletIdsQuery=BooleanQueryFactoryUtil.create();
    for (    String portletId : portletIds) {
      if (Validator.isNull(portletId)) {
        continue;
      }
      TermQuery termQuery=TermQueryFactoryUtil.create(Field.PORTLET_ID,portletId);
      portletIdsQuery.add(termQuery,BooleanClauseOccur.SHOULD);
    }
    if (!portletIdsQuery.clauses().isEmpty()) {
      contextQuery.add(portletIdsQuery,BooleanClauseOccur.MUST);
    }
  }
}
