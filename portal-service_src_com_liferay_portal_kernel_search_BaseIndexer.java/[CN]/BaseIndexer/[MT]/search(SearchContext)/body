{
  try {
    Hits hits=null;
    PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
    boolean isUseSearchResultPermissionFilter=isUseSearchResultPermissionFilter(searchContext,permissionChecker);
    if (isUseSearchResultPermissionFilter) {
      SearchResultPermissionFilter searchResultPermissionFilter=new IndexerSearchResultPermissionFilter(permissionChecker);
      hits=searchResultPermissionFilter.search(searchContext);
    }
 else {
      hits=doSearch(searchContext);
    }
    processHits(searchContext,hits);
    return hits;
  }
 catch (  SearchException se) {
    throw se;
  }
catch (  Exception e) {
    throw new SearchException(e);
  }
}
