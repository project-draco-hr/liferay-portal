{
  String[] relatedEntryClassNames=(String[])searchContext.getAttribute("relatedEntryClassNames");
  if ((relatedEntryClassNames != null) && (relatedEntryClassNames.length > 0)) {
    BooleanQuery relatedQueries=BooleanQueryFactoryUtil.create(searchContext);
    for (    String relatedEntryClassName : relatedEntryClassNames) {
      Indexer indexer=IndexerRegistryUtil.getIndexer(relatedEntryClassName);
      if (indexer != null) {
        BooleanQuery relatedQuery=BooleanQueryFactoryUtil.create(searchContext);
        indexer.postProcessContextQuery(relatedQuery,searchContext);
        relatedQuery.addRequiredTerm(Field.CLASS_NAME_ID,PortalUtil.getClassNameId(relatedEntryClassName));
        relatedQueries.add(relatedQuery,BooleanClauseOccur.SHOULD);
      }
    }
    contextQuery.add(relatedQueries,BooleanClauseOccur.MUST);
  }
}
