{
  BooleanQuery facetQuery=BooleanQueryFactoryUtil.create(searchContext);
  facetQuery.addExactTerm(Field.ENTRY_CLASS_NAME,className);
  if (searchContext.getUserId() > 0) {
    SearchPermissionChecker searchPermissionChecker=SearchEngineUtil.getSearchPermissionChecker();
    long[] groupIds=null;
    String contextGroupId=(String)searchContext.getAttribute("groupId");
    if (contextGroupId != null) {
      if (!"0".equals(contextGroupId)) {
        groupIds=new long[]{Long.parseLong(contextGroupId)};
      }
 else {
        groupIds=searchContext.getGroupIds();
      }
    }
 else {
      groupIds=searchContext.getGroupIds();
    }
    facetQuery=(BooleanQuery)searchPermissionChecker.getPermissionQuery(searchContext.getCompanyId(),groupIds,searchContext.getUserId(),className,facetQuery,searchContext);
  }
  return facetQuery;
}
