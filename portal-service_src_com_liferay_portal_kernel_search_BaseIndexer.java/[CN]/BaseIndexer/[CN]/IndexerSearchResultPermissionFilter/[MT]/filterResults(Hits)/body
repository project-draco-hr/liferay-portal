{
  List<Document> docs=new ArrayList<Document>();
  List<Float> scores=new ArrayList<Float>();
  Document[] documents=hits.getDocs();
  int excludeDocsSize=0;
  for (int i=0; i < documents.length; i++) {
    try {
      Document document=documents[i];
      String entryClassName=document.get(Field.ENTRY_CLASS_NAME);
      long entryClassPK=GetterUtil.getLong(document.get(Field.ENTRY_CLASS_PK));
      Indexer indexer=IndexerRegistryUtil.getIndexer(entryClassName);
      if ((indexer.isFilterSearch() && indexer.hasPermission(_permissionChecker,entryClassName,entryClassPK,ActionKeys.VIEW)) || !indexer.isFilterSearch() || !indexer.isPermissionAware()) {
        docs.add(document);
        scores.add(hits.score(i));
      }
 else {
        excludeDocsSize++;
      }
    }
 catch (    Exception e) {
      excludeDocsSize++;
    }
  }
  hits.setDocs(docs.toArray(new Document[docs.size()]));
  hits.setScores(scores.toArray(new Float[scores.size()]));
  hits.setSearchTime((float)(System.currentTimeMillis() - hits.getStart()) / Time.SECOND);
  hits.setLength(hits.getLength() - excludeDocsSize);
}
