{
  DDLRecord record=(DDLRecord)obj;
  DDLRecordVersion recordVersion=record.getRecordVersion();
  Document document=getDocument(record);
  if (!recordVersion.isApproved()) {
    if (Validator.equals(recordVersion.getVersion(),DDLRecordConstants.VERSION_DEFAULT)) {
      SearchEngineUtil.deleteDocument(getSearchEngineId(),record.getCompanyId(),document.get(Field.UID),isCommitImmediately());
    }
    return;
  }
  if (document != null) {
    SearchEngineUtil.updateDocument(getSearchEngineId(),record.getCompanyId(),document,isCommitImmediately());
  }
}
