{
  org.dom4j.io.SAXReader reader=null;
  if (!PropsValues.XML_VALIDATION_ENABLED) {
    validate=false;
  }
  try {
    reader=new org.dom4j.io.SAXReader(new SAXParser(),validate);
    reader.setEntityResolver(new EntityResolver());
    reader.setFeature(_FEATURES_DYNAMIC,validate);
    reader.setFeature(_FEATURES_VALIDATION,validate);
    reader.setFeature(_FEATURES_VALIDATION_SCHEMA,validate);
    reader.setFeature(_FEATURES_VALIDATION_SCHEMA_FULL_CHECKING,validate);
    if (!validate) {
      reader.setFeature(_FEATURES_EXTERNAL_GENERAL_ENTITIES,validate);
      reader.setFeature(_FEATURES_LOAD_DTD_GRAMMAR,validate);
      reader.setFeature(_FEATURES_LOAD_EXTERNAL_DTD,validate);
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("XSD validation is disabled because " + e.getMessage());
    }
    reader=new org.dom4j.io.SAXReader(false);
    reader.setEntityResolver(new EntityResolver());
  }
  return reader;
}
