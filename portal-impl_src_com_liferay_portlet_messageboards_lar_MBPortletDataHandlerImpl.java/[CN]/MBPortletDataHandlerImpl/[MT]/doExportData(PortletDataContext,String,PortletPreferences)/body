{
  portletDataContext.addPermissions("com.liferay.portlet.messageboards",portletDataContext.getScopeGroupId());
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("message-boards-data");
  rootElement.addAttribute("group-id",String.valueOf(portletDataContext.getScopeGroupId()));
  Element categoriesElement=rootElement.addElement("categories");
  Element messagesElement=rootElement.addElement("messages");
  Element messageFlagsElement=rootElement.addElement("thread-flags");
  Element userBansElement=rootElement.addElement("user-bans");
  List<MBCategory> categories=MBCategoryUtil.findByGroupId(portletDataContext.getScopeGroupId());
  for (  MBCategory category : categories) {
    exportCategory(portletDataContext,categoriesElement,messagesElement,messageFlagsElement,category);
  }
  List<MBMessage> messages=MBMessageUtil.findByG_C(portletDataContext.getScopeGroupId(),MBCategoryConstants.DEFAULT_PARENT_CATEGORY_ID);
  for (  MBMessage message : messages) {
    exportMessage(portletDataContext,categoriesElement,messagesElement,messageFlagsElement,message);
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"user-bans")) {
    List<MBBan> bans=MBBanUtil.findByGroupId(portletDataContext.getScopeGroupId());
    for (    MBBan ban : bans) {
      exportBan(portletDataContext,userBansElement,ban);
    }
  }
  return document.formattedString();
}
