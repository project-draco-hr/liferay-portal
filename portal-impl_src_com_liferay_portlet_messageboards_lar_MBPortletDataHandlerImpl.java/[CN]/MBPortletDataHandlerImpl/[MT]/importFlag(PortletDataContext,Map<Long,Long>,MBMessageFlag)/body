{
  long userId=context.getUserId(flag.getUserUuid());
  long messageId=MapUtil.getLong(messagePKs,flag.getMessageId(),flag.getMessageId());
  try {
    MBMessage message=MBMessageUtil.findByPrimaryKey(messageId);
    MBThread thread=message.getThread();
    MBMessageFlagLocalServiceUtil.addReadFlags(userId,thread);
  }
 catch (  NoSuchMessageException nsme) {
    _log.error("Could not find the message for flag " + flag.getMessageFlagId());
  }
}
