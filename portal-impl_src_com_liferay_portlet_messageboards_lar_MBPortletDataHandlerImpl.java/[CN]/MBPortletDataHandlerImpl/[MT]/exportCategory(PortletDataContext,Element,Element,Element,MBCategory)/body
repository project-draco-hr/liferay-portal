{
  if (context.isWithinDateRange(category.getModifiedDate())) {
    String path=getCategoryPath(context,category);
    if (context.isPathNotProcessed(path)) {
      Element categoryEl=categoriesEl.addElement("category");
      categoryEl.addAttribute("path",path);
      category.setUserUuid(category.getUserUuid());
      context.addZipEntry(path,category);
    }
    exportParentCategory(context,categoriesEl,category.getParentCategoryId());
  }
  List<MBMessage> messages=MBMessageUtil.findByCategoryId(category.getCategoryId());
  for (  MBMessage message : messages) {
    exportMessage(context,categoriesEl,messagesEl,messageFlagsEl,message);
  }
}
