{
  long userId=portletDataContext.getUserId(threadFlag.getUserUuid());
  Map<Long,Long> messagePKs=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(MBMessage.class);
  long threadId=MapUtil.getLong(messagePKs,threadFlag.getThreadId(),threadFlag.getThreadId());
  MBThread thread=MBThreadUtil.findByPrimaryKey(threadId);
  MBThreadFlagLocalServiceUtil.addFlag(userId,thread);
}
