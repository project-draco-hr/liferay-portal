{
  Connection connection=_dataSource.getConnection();
  if (!PACLPolicyManager.isActive() || !PortalSecurityManagerThreadLocal.isCheckSQL() || !PortalSecurityManagerThreadLocal.isEnabled()) {
    return connection;
  }
  PACLPolicy paclPolicy=PACLClassUtil.getPACLPolicy(_log.isDebugEnabled());
  if ((paclPolicy == null) || !paclPolicy.isActive()) {
    return connection;
  }
  return (Connection)ProxyUtil.newProxyInstance(paclPolicy.getClassLoader(),new Class<?>[]{Connection.class},new PACLConnectionHandler(connection,paclPolicy));
}
