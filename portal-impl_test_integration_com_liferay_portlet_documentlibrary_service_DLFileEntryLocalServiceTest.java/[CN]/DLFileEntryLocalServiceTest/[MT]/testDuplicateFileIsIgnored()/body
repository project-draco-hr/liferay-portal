{
  DLFolder dlFolder=DLTestUtil.addDLFolder(_group.getGroupId());
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId());
  InputStream inputStream=new ByteArrayInputStream(new byte[0]);
  Map<String,DDMFormValues> ddmFormValuesMap=Collections.emptyMap();
  DLFileEntry fileEntry=DLFileEntryLocalServiceUtil.addFileEntry(TestPropsValues.getUserId(),dlFolder.getGroupId(),dlFolder.getRepositoryId(),dlFolder.getFolderId(),StringUtil.randomString(),ContentTypes.TEXT_PLAIN,StringUtil.randomString(),StringPool.BLANK,StringPool.BLANK,DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT,ddmFormValuesMap,null,inputStream,0,serviceContext);
  DLFileVersion fileVersion=fileEntry.getLatestFileVersion(true);
  DLFileEntryLocalServiceUtil.updateStatus(TestPropsValues.getUserId(),fileVersion.getFileVersionId(),WorkflowConstants.STATUS_APPROVED,serviceContext,new HashMap<String,Serializable>());
  DLStoreUtil.updateFile(fileEntry.getCompanyId(),fileEntry.getRepositoryId(),fileEntry.getName(),fileEntry.getExtension(),false,"2.0",StringUtil.randomString(),inputStream);
  fileEntry=DLFileEntryLocalServiceUtil.updateFileEntry(TestPropsValues.getUserId(),fileEntry.getFileEntryId(),StringUtil.randomString(),ContentTypes.TEXT_PLAIN,StringUtil.randomString(),StringPool.BLANK,StringPool.BLANK,true,DLFileEntryTypeConstants.FILE_ENTRY_TYPE_ID_BASIC_DOCUMENT,ddmFormValuesMap,null,inputStream,0,serviceContext);
  fileVersion=fileEntry.getLatestFileVersion(true);
  DLFileEntryLocalServiceUtil.updateStatus(TestPropsValues.getUserId(),fileVersion.getFileVersionId(),WorkflowConstants.STATUS_APPROVED,serviceContext,new HashMap<String,Serializable>());
  fileEntry=DLFileEntryLocalServiceUtil.getFileEntry(fileEntry.getFileEntryId());
  Assert.assertEquals("2.0",fileEntry.getVersion());
}
