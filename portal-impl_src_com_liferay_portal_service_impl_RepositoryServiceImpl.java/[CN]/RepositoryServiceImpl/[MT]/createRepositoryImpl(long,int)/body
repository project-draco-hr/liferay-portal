{
  try {
    String repositoryImplClassName=PropsUtil.get(PropsKeys.DL_REPOSITORY_IMPL,new Filter(String.valueOf(type)));
    BaseRepositoryImpl baseRepositoryImpl=(BaseRepositoryImpl)InstanceFactory.newInstance(repositoryImplClassName);
    baseRepositoryImpl.setRepositoryId(repositoryId);
    Repository repository=getRepository(repositoryId);
    baseRepositoryImpl.setTypeSettingsProperties(repository.getTypeSettingsProperties());
    baseRepositoryImpl.initRepository();
    return baseRepositoryImpl;
  }
 catch (  Exception e) {
    throw new RepositoryException("There is no valid repository class for type " + type,e);
  }
}
