{
  long repositoryEntryId=getRepositoryEntryId(folderId,fileEntryId,fileVersionId);
  LocalRepository localRepositoryImpl=_localRepositoriesByRepositoryEntryId.get(repositoryEntryId);
  if (localRepositoryImpl != null) {
    return localRepositoryImpl;
  }
  localRepositoryImpl=new LiferayLocalRepository(folderId,fileEntryId,fileVersionId);
  if (localRepositoryImpl.getRepositoryId() == 0) {
    localRepositoryImpl=null;
  }
  if (localRepositoryImpl == null) {
    BaseRepositoryImpl baseRepositoryImpl=createRepositoryImpl(repositoryEntryId);
    localRepositoryImpl=baseRepositoryImpl.getLocalRepository();
  }
 else {
    checkRepository(localRepositoryImpl.getRepositoryId());
  }
  _localRepositoriesByRepositoryEntryId.put(repositoryEntryId,localRepositoryImpl);
  return localRepositoryImpl;
}
