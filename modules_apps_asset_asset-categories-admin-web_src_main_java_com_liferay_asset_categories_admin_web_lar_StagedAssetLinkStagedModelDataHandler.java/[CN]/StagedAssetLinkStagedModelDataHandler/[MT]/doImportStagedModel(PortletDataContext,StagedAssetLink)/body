{
  long userId=portletDataContext.getUserId(stagedAssetLink.getUserUuid());
  StagedAssetLink existingStagedAssetLink=fetchExistingAssetLink(portletDataContext.getScopeGroupId(),stagedAssetLink.getEntry1Uuid(),stagedAssetLink.getEntry2Uuid());
  if (existingStagedAssetLink != null) {
    _assetLinkLocalService.updateLink(userId,existingStagedAssetLink.getEntryId1(),existingStagedAssetLink.getEntryId2(),stagedAssetLink.getType(),stagedAssetLink.getWeight());
    return;
  }
  Map<Long,Long> assetEntry1Ids=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(stagedAssetLink.getEntry1ClassName());
  Map<Long,Long> assetEntry2Ids=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(stagedAssetLink.getEntry2ClassName());
  long assetEntry1Id=MapUtil.getLong(assetEntry1Ids,stagedAssetLink.getEntryId1(),-1);
  long assetEntry2Id=MapUtil.getLong(assetEntry2Ids,stagedAssetLink.getEntryId2(),-1);
  if ((assetEntry1Id <= 0) || (assetEntry2Id <= 0)) {
    return;
  }
  _assetLinkLocalService.addLink(userId,assetEntry1Id,assetEntry2Id,stagedAssetLink.getType(),stagedAssetLink.getWeight());
}
