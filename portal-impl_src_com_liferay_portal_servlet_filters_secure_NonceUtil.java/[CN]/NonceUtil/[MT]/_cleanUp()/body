{
  long expired=System.currentTimeMillis() - _NONCE_EXPIRATION;
  List<Long> times=new ArrayList<Long>();
  _readWriteLock.readLock().lock();
  try {
    for (    long time : _nonceMap.keySet()) {
      if (time <= expired) {
        times.add(time);
      }
 else {
        break;
      }
    }
  }
  finally {
    _readWriteLock.readLock().unlock();
  }
  _readWriteLock.writeLock().lock();
  try {
    for (    long time : times) {
      _nonceMap.remove(time);
    }
  }
  finally {
    _readWriteLock.writeLock().unlock();
  }
}
