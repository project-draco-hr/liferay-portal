{
  String nonce=null;
  long timestamp=System.currentTimeMillis();
  String companyKey=null;
  try {
    Company company=CompanyLocalServiceUtil.getCompanyById(companyId);
    companyKey=company.getKey();
  }
 catch (  Exception e) {
    throw new RuntimeException("Invalid companyId " + companyId,e);
  }
  nonce=DigesterUtil.digestHex(Digester.MD5,remoteAddr,Long.toString(timestamp),companyKey);
  _cache.put(timestamp,nonce);
  return nonce;
}
