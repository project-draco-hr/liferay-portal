{
  addOAuthParameter(oAuthRequest,"clientPortletNamespace",portletResponse.getNamespace());
  String currentURL=PortalUtil.getCurrentURL(portletRequest);
  addOAuthParameter(oAuthRequest,"clientURL",currentURL);
  addOAuthParameter(oAuthRequest,"p_p_id",getServerPortletId());
  String serverNamespace=PortalUtil.getPortletNamespace(getServerPortletId());
  Map<String,String[]> parameterMap=portletRequest.getParameterMap();
  for (  Map.Entry<String,String[]> entry : parameterMap.entrySet()) {
    String key=entry.getKey();
    String[] values=entry.getValue();
    if (key.equals("remoteWindowState")) {
      key="p_p_state";
    }
 else {
      key=serverNamespace.concat(key);
    }
    if (ArrayUtil.isEmpty(values) || Validator.isNull(values[0])) {
      continue;
    }
    addOAuthParameter(oAuthRequest,key,values[0]);
  }
}
