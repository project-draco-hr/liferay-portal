{
  User user=UserUtil.findByPrimaryKey(userId);
  Date now=new Date();
  validate(0,user.getCompanyId(),className,classPK,street1,city,zip,regionId,countryId,typeId,mailing,primary);
  long addressId=CounterLocalServiceUtil.increment(Counter.class.getName());
  Address address=AddressUtil.create(addressId);
  address.setCompanyId(user.getCompanyId());
  address.setUserId(user.getUserId());
  address.setUserName(user.getFullName());
  address.setCreateDate(now);
  address.setModifiedDate(now);
  address.setClassName(className);
  address.setClassPK(classPK);
  address.setStreet1(street1);
  address.setStreet2(street2);
  address.setStreet3(street3);
  address.setCity(city);
  address.setZip(zip);
  address.setRegionId(regionId);
  address.setCountryId(countryId);
  address.setTypeId(typeId);
  address.setMailing(mailing);
  address.setPrimary(primary);
  AddressUtil.update(address);
  return address;
}
