{
  MailException mailException=null;
  boolean failedIncomingConnection=false;
  try {
    testIncomingConnection();
  }
 catch (  MailException me) {
    mailException=me;
    failedIncomingConnection=true;
  }
  boolean failedOutgoingConnection=false;
  try {
    testOutgoingConnection();
  }
 catch (  MailException me) {
    mailException=me;
    failedOutgoingConnection=true;
  }
  if (failedIncomingConnection && failedOutgoingConnection) {
    throw new MailException(MailException.ACCOUNT_CONNECTIONS_FAILED,mailException);
  }
 else   if (failedIncomingConnection) {
    throw new MailException(MailException.ACCOUNT_INCOMING_CONNECTION_FAILED,mailException);
  }
 else   if (failedOutgoingConnection) {
    throw new MailException(MailException.ACCOUNT_OUTGOING_CONNECTION_FAILED,mailException);
  }
}
