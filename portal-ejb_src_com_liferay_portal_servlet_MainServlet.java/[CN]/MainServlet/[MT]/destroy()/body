{
  try {
    Iterator itr=PortletLocalServiceUtil.getPortlets(_companyId).iterator();
    while (itr.hasNext()) {
      Portlet portlet=(Portlet)itr.next();
      PortletInstanceFactory.destroy(portlet);
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Process shutdown events");
  }
  try {
    EventsProcessor.process(PropsUtil.getArray(PropsUtil.GLOBAL_SHUTDOWN_EVENTS),true);
    EventsProcessor.process(PropsUtil.getArray(PropsUtil.APPLICATION_SHUTDOWN_EVENTS),new String[]{_companyId});
  }
 catch (  Exception e) {
    _log.error(e);
  }
  super.destroy();
}
