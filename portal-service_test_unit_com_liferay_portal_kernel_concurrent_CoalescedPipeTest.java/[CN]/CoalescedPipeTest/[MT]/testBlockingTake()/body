{
  final CoalescedPipe<String> coalescedPipe=new CoalescedPipe<>();
  ScheduledExecutorService scheduledExecutorService=Executors.newScheduledThreadPool(1);
  scheduledExecutorService.schedule(new Runnable(){
    @Override public void run(){
      try {
        coalescedPipe.put("test1");
      }
 catch (      InterruptedException ie) {
        Assert.fail(ie.getMessage());
      }
    }
  }
,500,TimeUnit.MILLISECONDS);
  long startTime=System.currentTimeMillis();
  Assert.assertEquals("test1",coalescedPipe.take());
  Assert.assertTrue((System.currentTimeMillis() - startTime) > 250L);
  scheduledExecutorService.shutdownNow();
  scheduledExecutorService.awaitTermination(120,TimeUnit.SECONDS);
}
