{
  Map renderParams=getParameterMap();
  Map params=new HashMap();
  String[] plid={String.valueOf(getPlid())};
  params.put("p_l_id",plid);
  String[] portletId={getPortletId()};
  params.put("p_p_id",portletId);
  String[] action={isAction() ? "1" : "0"};
  params.put("p_p_action",action);
  WindowState windowState=getWindowState();
  if (getWindowState() != null) {
    String[] stateStr={windowState.toString()};
    params.put("p_p_state",stateStr);
  }
  PortletMode portletMode=getPortletMode();
  if (getPortletMode() != null) {
    String[] modeStr={portletMode.toString()};
    params.put("p_p_mode",modeStr);
  }
  Iterator itr=renderParams.entrySet().iterator();
  while (itr.hasNext()) {
    Map.Entry entry=(Map.Entry)itr.next();
    String name=PortalUtil.getPortletNamespace(portletId[0]) + (String)entry.getKey();
    String[] values=(String[])entry.getValue();
    for (int i=0; i < values.length; i++) {
      params.put(name,values);
    }
  }
  String encodedParams=null;
  try {
    encodedParams=Base64.encode(ObjectSerializer.serialize(params));
  }
 catch (  Exception e) {
  }
  return encodedParams;
}
