{
  String login=PrincipalThreadLocal.getName();
  if (Validator.isNull(login)) {
    return login;
  }
  try {
    Company company=companyLocalService.getCompany(getCompanyId());
    String authType=company.getAuthType();
    if (!authType.equals(CompanyConstants.AUTH_TYPE_ID)) {
      User user=userLocalService.getUser(GetterUtil.getLong(login));
      if (authType.equals(CompanyConstants.AUTH_TYPE_EA)) {
        login=user.getEmailAddress();
      }
 else       if (authType.equals(CompanyConstants.AUTH_TYPE_SN)) {
        login=user.getScreenName();
      }
    }
  }
 catch (  Exception e) {
    throw new RepositoryException(e);
  }
  return login;
}
