{
  try {
    WorkflowURL url=getWorkflowURL();
    xml=StringUtil.replace(xml,new String[]{"\n","\r","\t"},new String[]{"","",""});
    url.setParameter(Constants.CMD,"deploy");
    url.setParameter("xml",xml);
    String content=url.getContent();
    String definitionId=parseString(content,"definitionId");
    String companyId=getUser().getCompanyId();
    String portletId=CompanyImpl.SYSTEM;
    String groupId=GroupImpl.DEFAULT_PARENT_GROUP_ID;
    String repositoryId=CompanyImpl.SYSTEM;
    String dirName="workflow/definitions";
    String fileName=dirName + "/" + definitionId+ ".xml";
    try {
      try {
        DLServiceUtil.addDirectory(companyId,repositoryId,dirName);
      }
 catch (      DuplicateDirectoryException dde) {
      }
      DLServiceUtil.addFile(companyId,portletId,groupId,repositoryId,fileName,xml.getBytes());
    }
 catch (    RemoteException re) {
    }
    return definitionId;
  }
 catch (  Exception e) {
    throw new WorkflowComponentException(e);
  }
}
