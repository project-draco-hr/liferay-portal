{
  if (layout.isTypeControlPanel()) {
    isAccessAllowedToControlPanelPortlet(request,portlet);
    return;
  }
  if (isAccessAllowedToLayoutPortlet(request,layout,portlet)) {
    PortalUtil.addPortletDefaultResource(request,portlet);
    if (hasAccessPermission(request,layout,portlet)) {
      return;
    }
  }
  throw new PrincipalException();
}
