{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  String portletId=portlet.getPortletId();
  if (layout.isTypePanel() && isPanelSelectedPortlet(themeDisplay,portletId)) {
    return true;
  }
  LayoutTypePortlet layoutTypePortlet=themeDisplay.getLayoutTypePortlet();
  if ((layoutTypePortlet != null) && layoutTypePortlet.hasPortletId(portletId)) {
    return true;
  }
  return false;
}
