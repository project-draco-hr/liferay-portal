{
  List<JournalContentSearch> contentSearches=JournalContentSearchLocalServiceUtil.getArticleContentSearches();
  Set<String> portletIds=new HashSet<String>();
  for (  JournalContentSearch contentSearch : contentSearches) {
    portletIds.add(contentSearch.getPortletId());
  }
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    for (    String portletId : portletIds) {
      contentSearches=JournalContentSearchLocalServiceUtil.getArticleContentSearchesByPortletId(portletId);
      if (contentSearches.size() <= 1) {
        continue;
      }
      ps=con.prepareStatement("select preferences from PortletPreferences where " + "portletId = ?");
      ps.setString(1,portletId);
      rs=ps.executeQuery();
      while (rs.next()) {
        String xml=rs.getString("preferences");
        PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromDefaultXML(xml);
        String articleId=portletPreferences.getValue("articleId",null);
        JournalContentSearch contentSearch=contentSearches.get(1);
        JournalContentSearchLocalServiceUtil.updateContentSearch(contentSearch.getGroupId(),contentSearch.isPrivateLayout(),contentSearch.getLayoutId(),contentSearch.getPortletId(),articleId,true);
      }
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
