{
  Method method=methodInvocation.getMethod();
  Class<?> targetClass=null;
  Object targetBean=methodInvocation.getThis();
  if (targetBean != null) {
    targetClass=targetBean.getClass();
  }
  TransactionAttribute transactionAttribute=transactionAttributeSource.getTransactionAttribute(method,targetClass);
  if (transactionAttribute == null) {
    return methodInvocation.proceed();
  }
  TransactionStatus transactionStatus=_platformTransactionManager.getTransaction(transactionAttribute);
  if (transactionStatus.isNewTransaction()) {
    TransactionalPortalCacheHelper.begin();
    TransactionCommitCallbackUtil.pushCallbackList();
  }
  Object returnValue=null;
  try {
    returnValue=methodInvocation.proceed();
  }
 catch (  Throwable throwable) {
    processThrowable(throwable,transactionAttribute,transactionStatus);
  }
  _platformTransactionManager.commit(transactionStatus);
  if (transactionStatus.isNewTransaction()) {
    TransactionalPortalCacheHelper.commit();
    invokeCallbacks();
  }
  return returnValue;
}
