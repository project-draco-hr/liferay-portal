{
  if (value == null) {
    throw new UpgradeException("Nulls should never be inserted into the database");
  }
 else   if (value instanceof Clob || value instanceof String) {
    value=StringUtil.replace((String)value,StringPool.COMMA,_SAFE_COMMA_CHARACTER);
    value=StringUtil.replace((String)value,StringPool.NEW_LINE,_SAFE_NEWLINE_CHARACTER);
    sb.append(value);
  }
 else   if (value instanceof Date) {
    DateFormat df=DateUtil.getISOFormat();
    sb.append(df.format(value));
  }
 else {
    sb.append(value);
  }
  sb.append(StringPool.COMMA);
  if (last) {
    sb.append(StringPool.NEW_LINE);
  }
}
