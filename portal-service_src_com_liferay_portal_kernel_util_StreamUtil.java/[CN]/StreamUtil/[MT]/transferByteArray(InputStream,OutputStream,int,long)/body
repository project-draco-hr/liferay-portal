{
  byte[] bytes=new byte[bufferSize];
  if (length > 0) {
    long remainingLength=length;
    while (remainingLength > 0) {
      int readBytes=inputStream.read(bytes,0,(int)Math.min(remainingLength,bufferSize));
      if (readBytes == -1) {
        break;
      }
      outputStream.write(bytes,0,readBytes);
      remainingLength-=readBytes;
    }
  }
 else {
    int value=-1;
    while ((value=inputStream.read(bytes)) != -1) {
      outputStream.write(bytes,0,value);
    }
  }
}
