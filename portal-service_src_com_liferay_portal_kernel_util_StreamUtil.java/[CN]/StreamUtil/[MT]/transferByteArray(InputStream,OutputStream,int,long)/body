{
  byte[] bytes=new byte[bufferSize];
  long lengthRemaining=length;
  if (lengthRemaining > 0) {
    while (lengthRemaining > 0) {
      int readBytes=inputStream.read(bytes,0,(int)Math.min(lengthRemaining,bufferSize));
      if (readBytes == -1) {
        break;
      }
      outputStream.write(bytes,0,readBytes);
      lengthRemaining-=readBytes;
    }
  }
 else {
    int value=-1;
    while ((value=inputStream.read(bytes)) != -1) {
      outputStream.write(bytes,0,value);
    }
  }
}
