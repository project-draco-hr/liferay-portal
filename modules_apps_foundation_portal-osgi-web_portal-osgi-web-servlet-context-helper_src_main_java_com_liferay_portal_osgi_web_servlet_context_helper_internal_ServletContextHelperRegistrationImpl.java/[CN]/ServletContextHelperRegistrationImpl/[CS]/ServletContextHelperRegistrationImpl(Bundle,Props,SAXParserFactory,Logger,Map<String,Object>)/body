{
  _bundle=bundle;
  _props=props;
  _saxParserFactory=saxParserFactory;
  _logger=logger;
  _properties=properties;
  String contextPath=getContextPath();
  _servletContextName=getServletContextName(contextPath);
  URL url=_bundle.getEntry("WEB-INF/");
  if (url != null) {
    _wabShapedBundle=true;
  }
 else {
    _wabShapedBundle=false;
  }
  _bundleContext=_bundle.getBundleContext();
  _customServletContextHelper=new CustomServletContextHelper(_bundle,_wabShapedBundle);
  _servletContextHelperServiceRegistration=createServletContextHelper(contextPath);
  _servletContextListenerServiceRegistration=createServletContextListener();
  registerServletContext();
  _defaultServletServiceRegistration=createDefaultServlet();
  _jspServletServiceRegistration=createJspServlet();
  _portletServletServiceRegistration=createPortletServlet();
  _portletServletRequestFilterServiceRegistration=createRestrictPortletServletRequestFilter();
}
