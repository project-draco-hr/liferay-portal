{
  _props=props;
  _properties=properties;
  String contextPath=getContextPath(bundle);
  _servletContextName=getServletContextName(bundle,contextPath);
  URL url=bundle.getEntry("WEB-INF/");
  if (url != null) {
    _wabShapedBundle=true;
  }
 else {
    _wabShapedBundle=false;
  }
  _bundleContext=bundle.getBundleContext();
  _customServletContextHelper=new CustomServletContextHelper(bundle,_wabShapedBundle);
  _servletContextHelperServiceRegistration=createServletContextHelper(_bundleContext,_servletContextName,contextPath);
  _servletContextListenerServiceRegistration=createServletContextListener(_bundleContext,_servletContextName);
  _defaultServletServiceRegistration=createDefaultServlet(_bundleContext,_servletContextName);
  _jspServletServiceRegistration=createJspServlet(_bundleContext,_servletContextName);
  _portletServletServiceRegistration=createPortletServlet(_bundleContext,_servletContextName);
  _portletServletRequestFilterServiceRegistration=createRestrictPortletServletRequestFilter(_bundleContext,_servletContextName);
}
