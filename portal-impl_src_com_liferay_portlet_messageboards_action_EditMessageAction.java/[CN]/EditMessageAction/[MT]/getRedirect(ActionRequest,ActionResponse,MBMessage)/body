{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  int workflowAction=ParamUtil.getInteger(actionRequest,"workflowAction",WorkflowConstants.ACTION_PUBLISH);
  if (((message == null) && cmd.equals(Constants.PREVIEW)) || (workflowAction == WorkflowConstants.ACTION_SAVE_DRAFT)) {
    return getSaveAndContinueRedirect(actionRequest,actionResponse,message);
  }
 else   if (message == null) {
    return ParamUtil.getString(actionRequest,"redirect");
  }
  ActionResponseImpl actionResponseImpl=(ActionResponseImpl)actionResponse;
  PortletURL portletURL=actionResponseImpl.createRenderURL();
  portletURL.setParameter("struts_action","/message_boards/view_message");
  portletURL.setParameter("messageId",String.valueOf(message.getMessageId()));
  return portletURL.toString();
}
