{
  String body=ParamUtil.getString(actionRequest,"body");
  String redirect=ParamUtil.getString(actionRequest,"redirect");
  String subject=ParamUtil.getString(actionRequest,"subject");
  boolean preview=ParamUtil.getBoolean(actionRequest,"preview");
  PortletURL portletURL=((ActionResponseImpl)actionResponse).createRenderURL();
  portletURL.setParameter("struts_action","/message_boards/edit_message");
  portletURL.setParameter("redirect",redirect);
  portletURL.setParameter("preview",String.valueOf(preview));
  if (message != null) {
    portletURL.setParameter("messageId",String.valueOf(message.getMessageId()));
  }
 else {
    portletURL.setParameter("body",body);
    portletURL.setParameter("subject",subject);
  }
  return portletURL.toString();
}
