{
  int stackIndex=getStackIndex(15,14);
  Class<?> callerClass=Reflection.getCallerClass(stackIndex);
  if (isTrustedCaller(callerClass,permission)) {
    callerClass=Reflection.getCallerClass(stackIndex + 1);
    if (isTrustedCaller(callerClass,permission)) {
      return true;
    }
  }
  Class<?> clazz=PACLUtil.getClass(object);
  if (clazz == null) {
    return false;
  }
  ClassLoader classLoader=ClassLoaderUtil.getClassLoader(clazz);
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
  if (paclPolicy == getPACLPolicy()) {
    return true;
  }
  Set<String> services=getServices(paclPolicy);
  String className=PACLUtil.getServiceInterfaceName(clazz.getName());
  if (services.contains(className)) {
    return true;
  }
  if (method == null) {
    return false;
  }
  String methodName=method.getName();
  if (methodName.equals("invokeMethod")) {
    methodName=(String)arguments[0];
  }
  if (services.contains(className.concat(StringPool.POUND).concat(methodName))) {
    return true;
  }
  return false;
}
