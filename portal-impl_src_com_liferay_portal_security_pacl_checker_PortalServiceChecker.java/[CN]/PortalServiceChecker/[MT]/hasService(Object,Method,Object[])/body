{
  Class<?> clazz=object.getClass();
  if (Proxy.isProxyClass(clazz)) {
    Class<?>[] interfaces=clazz.getInterfaces();
    if (interfaces.length == 0) {
      return false;
    }
    clazz=interfaces[0];
  }
  ClassLoader classLoader=PACLClassLoaderUtil.getClassLoader(clazz);
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
  if (paclPolicy == getPACLPolicy()) {
    return true;
  }
  Set<String> services=getServices(paclPolicy);
  String className=getInterfaceName(clazz.getName());
  if (services.contains(className)) {
    return true;
  }
  String methodName=method.getName();
  if (methodName.equals("invokeMethod")) {
    methodName=(String)arguments[0];
  }
  if (services.contains(className.concat(StringPool.POUND).concat(methodName))) {
    return true;
  }
  return false;
}
