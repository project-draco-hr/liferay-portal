{
  InternetAddress[] internetAddresses=new InternetAddress[0];
  try {
    internetAddresses=InternetAddress.parse(addresses,true);
    for (int i=0; i < internetAddresses.length; i++) {
      InternetAddress internetAddress=internetAddresses[i];
      if (!Validator.isEmailAddress(internetAddress.getAddress())) {
        StringBundler sb=new StringBundler(4);
        sb.append(internetAddress.getPersonal());
        sb.append(StringPool.LESS_THAN);
        sb.append(internetAddress.getAddress());
        sb.append(StringPool.GREATER_THAN);
        throw new MailException(MailException.MESSAGE_INVALID_ADDRESS,sb.toString());
      }
    }
  }
 catch (  AddressException ae) {
    throw new MailException(MailException.MESSAGE_INVALID_ADDRESS,ae,addresses);
  }
  return internetAddresses;
}
