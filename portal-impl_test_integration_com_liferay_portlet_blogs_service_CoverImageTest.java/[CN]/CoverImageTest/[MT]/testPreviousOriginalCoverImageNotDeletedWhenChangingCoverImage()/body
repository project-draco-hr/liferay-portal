{
  Folder folder=BlogsEntryLocalServiceUtil.addAttachmentsFolder(_user.getUserId(),_group.getGroupId());
  int initialFolderFileEntriesCount=PortletFileRepositoryUtil.getPortletFileEntriesCount(_group.getGroupId(),folder.getFolderId());
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId(),_user.getUserId());
  FileEntry initialFileEntry=getTempFileEntry(_user.getUserId(),"image1.jpg",serviceContext);
  ImageSelector coverImageSelector=new ImageSelector(initialFileEntry.getFileEntryId(),StringPool.BLANK,_IMAGE_CROP_REGION);
  ImageSelector smallImageSelector=null;
  BlogsEntry entry=BlogsEntryLocalServiceUtil.addEntry(_user.getUserId(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),new Date(),true,true,new String[0],StringPool.BLANK,coverImageSelector,smallImageSelector,serviceContext);
  FileEntry finalFileEntry=getTempFileEntry(_user.getUserId(),"image2.jpg",serviceContext);
  coverImageSelector=new ImageSelector(finalFileEntry.getFileEntryId(),StringPool.BLANK,_IMAGE_CROP_REGION);
  BlogsEntryLocalServiceUtil.updateEntry(_user.getUserId(),entry.getEntryId(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),RandomTestUtil.randomString(),new Date(),true,true,new String[0],StringPool.BLANK,coverImageSelector,smallImageSelector,serviceContext);
  int finalPortletFileEntriesCount=PortletFileRepositoryUtil.getPortletFileEntriesCount(_group.getGroupId(),folder.getFolderId());
  Assert.assertEquals(initialFolderFileEntriesCount + 2,finalPortletFileEntriesCount);
  PortletFileRepositoryUtil.getPortletFileEntry(_group.getGroupId(),folder.getFolderId(),"image1.jpg");
  PortletFileRepositoryUtil.getPortletFileEntry(_group.getGroupId(),folder.getFolderId(),"image2.jpg");
}
