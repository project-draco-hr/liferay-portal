{
  if (layouts.isEmpty()) {
    return layouts;
  }
  Layout firstLayout=layouts.get(0);
  Layout wrappedFirstLayout=wrapLayout(firstLayout);
  if (wrappedFirstLayout == firstLayout) {
    return layouts;
  }
  long layoutSetBranchId=0;
  if (!showIncomplete) {
    try {
      long userId=GetterUtil.getLong(PrincipalThreadLocal.getName());
      if (userId > 0) {
        User user=UserLocalServiceUtil.getUser(userId);
        LayoutSet layoutSet=firstLayout.getLayoutSet();
        layoutSetBranchId=StagingUtil.getRecentLayoutSetBranchId(user,layoutSet.getLayoutSetId());
      }
    }
 catch (    Exception e) {
    }
  }
  List<Layout> wrappedLayouts=new ArrayList<Layout>(layouts.size());
  for (int i=0; i < layouts.size(); i++) {
    Layout wrappedLayout=wrapLayout(layouts.get(i));
    if (showIncomplete || !StagingUtil.isIncomplete(wrappedLayout,layoutSetBranchId)) {
      wrappedLayouts.add(wrappedLayout);
    }
  }
  return wrappedLayouts;
}
