{
  Layout layout=LayoutUtil.findByG_P_L(groupId,privateLayout,layoutId);
  layout=wrapLayout(layout);
  LayoutRevision layoutRevision=LayoutStagingUtil.getLayoutRevision(layout);
  if (layoutRevision == null) {
    return target.updateLookAndFeel(groupId,privateLayout,layoutId,themeId,colorSchemeId,css,wapTheme);
  }
  if (wapTheme) {
    layout.setWapThemeId(themeId);
    layout.setWapColorSchemeId(colorSchemeId);
  }
 else {
    layout.setThemeId(themeId);
    layout.setColorSchemeId(colorSchemeId);
    layout.setCss(css);
  }
  ServiceContext serviceContext=ServiceContextThreadLocal.getServiceContext();
  boolean hasWorkflowTask=StagingUtil.hasWorkflowTask(serviceContext.getUserId(),layoutRevision);
  serviceContext.setAttribute("revisionInProgress",hasWorkflowTask);
  if (!MergeLayoutPrototypesThreadLocal.isInProgress()) {
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
  }
  LayoutRevisionLocalServiceUtil.updateLayoutRevision(serviceContext.getUserId(),layoutRevision.getLayoutRevisionId(),layoutRevision.getLayoutBranchId(),layoutRevision.getName(),layoutRevision.getTitle(),layoutRevision.getDescription(),layoutRevision.getKeywords(),layoutRevision.getRobots(),layoutRevision.getTypeSettings(),layoutRevision.getIconImage(),layoutRevision.getIconImageId(),layoutRevision.getThemeId(),layoutRevision.getColorSchemeId(),layoutRevision.getWapThemeId(),layoutRevision.getWapColorSchemeId(),layoutRevision.getCss(),serviceContext);
  return layout;
}
