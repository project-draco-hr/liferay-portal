{
  HttpServletRequest request=PortalUtil.getHttpServletRequest(portletRequest);
  HttpServletResponse response=PortalUtil.getHttpServletResponse(portletResponse);
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long recordSetId=ParamUtil.getLong(portletRequest,"recordSetId");
  DDLRecordSet recordSet=DDLRecordSetServiceUtil.getRecordSet(recordSetId);
  String fileExtension=ParamUtil.getString(portletRequest,"fileExtension");
  String fileName=recordSet.getName(themeDisplay.getLocale()) + CharPool.PERIOD + fileExtension;
  DDLExporter exporter=_ddlExporterFactory.getDDLExporter(fileExtension);
  exporter.setLocale(themeDisplay.getLocale());
  byte[] bytes=exporter.export(recordSetId,WorkflowConstants.STATUS_APPROVED);
  String contentType=MimeTypesUtil.getContentType(fileName);
  ServletResponseUtil.sendFile(request,response,fileName,bytes,contentType);
}
