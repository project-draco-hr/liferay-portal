{
  JSONObject ddlRecordJSONObject=JSONFactoryUtil.createJSONObject();
  ddlRecordJSONObject.put("modelAttributes",JSONFactoryUtil.createJSONObject(JSONFactoryUtil.looseSerialize(ddlRecord.getModelAttributes())));
  Map<String,Object> ddlRecordMap=new HashMap<>();
  DDMFormValues ddmFormValues=ddlRecord.getDDMFormValues();
  Set<Locale> availableLocales=ddmFormValues.getAvailableLocales();
  if ((locale == null) || !availableLocales.contains(locale)) {
    locale=ddmFormValues.getDefaultLocale();
  }
  for (  DDMFormFieldValue ddmFormFieldValue : ddmFormValues.getDDMFormFieldValues()) {
    Object fieldValue=getFieldValue(ddmFormFieldValue,locale);
    if (fieldValue != null) {
      ddlRecordMap.put(ddmFormFieldValue.getName(),fieldValue);
    }
 else {
      for (      Locale availableLocale : availableLocales) {
        fieldValue=getFieldValue(ddmFormFieldValue,availableLocale);
        if (fieldValue != null) {
          ddlRecordMap.put(ddmFormFieldValue.getName(),fieldValue);
          break;
        }
      }
    }
  }
  ddlRecordJSONObject.put("modelValues",JSONFactoryUtil.createJSONObject(JSONFactoryUtil.looseSerialize(ddlRecordMap)));
  return ddlRecordJSONObject;
}
