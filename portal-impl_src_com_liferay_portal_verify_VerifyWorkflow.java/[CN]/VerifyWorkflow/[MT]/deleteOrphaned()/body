{
  PreparedStatement ps=null;
  ResultSet rs=null;
  for (  String[] orphanedAttachedModel : getOrphanedAttachedModels()) {
    String tableName=orphanedAttachedModel[0];
    if (!hasTable(tableName) || !hasColumn(tableName,"classNameId")) {
      continue;
    }
    try {
      ps=connection.prepareStatement("select distinct classNameId from " + tableName);
      rs=ps.executeQuery();
      while (rs.next()) {
        long classNameId=rs.getLong("classNameId");
        ClassName className=ClassNameLocalServiceUtil.fetchClassName(classNameId);
        if (className == null) {
          continue;
        }
        String classNameValue=className.getValue();
        String orphanedClassName=orphanedAttachedModel[1];
        if (classNameValue.equals(orphanedClassName)) {
          String orphanedTableName=orphanedAttachedModel[2];
          String orphanedColumnName=orphanedAttachedModel[3];
          if (hasTable(orphanedTableName)) {
            deleteOrphaned(tableName,orphanedTableName,orphanedColumnName);
          }
        }
      }
    }
  finally {
      DataAccess.cleanUp(null,ps,rs);
    }
  }
}
