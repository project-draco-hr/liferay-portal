{
  try {
    StringBuffer sb=new StringBuffer();
    sb.append("<a ");
    if (Validator.isNotNull(className)) {
      sb.append("class=\"");
      sb.append(className);
      sb.append("\" ");
    }
    sb.append("href=\"").append(protocol).append("://");
    int pos=url.indexOf("?");
    if (pos == -1) {
      sb.append(url);
    }
 else {
      sb.append(url.substring(0,pos)).append("?");
      Company company=PortalUtil.getCompany((HttpServletRequest)pageContext.getRequest());
      Key key=company.getKeyObj();
      StringTokenizer st=new StringTokenizer(url.substring(pos + 1,url.length()),"&");
      while (st.hasMoreTokens()) {
        String paramAndValue=st.nextToken();
        int x=paramAndValue.indexOf("=");
        String param=paramAndValue.substring(0,x);
        String value=paramAndValue.substring(x + 1,paramAndValue.length());
        sb.append(param).append("=");
        if (unencryptedParamsSet.contains(param)) {
          sb.append(Http.encodeURL(value));
        }
 else {
          try {
            sb.append(Http.encodeURL(Encryptor.encrypt(key,value)));
          }
 catch (          EncryptorException ee) {
            _log.error(ee.getMessage());
          }
          if (st.hasMoreTokens()) {
            sb.append("&");
          }
        }
      }
      sb.append("&shuo=1");
    }
    sb.append("\" ");
    if (Validator.isNotNull(style)) {
      sb.append("style=\"");
      sb.append(style);
      sb.append("\" ");
    }
    if (Validator.isNotNull(target)) {
      sb.append("target=\"" + target + "\"");
    }
    sb.append(">");
    pageContext.getOut().print(sb.toString());
  }
 catch (  Exception e) {
    throw new JspException(e);
  }
}
