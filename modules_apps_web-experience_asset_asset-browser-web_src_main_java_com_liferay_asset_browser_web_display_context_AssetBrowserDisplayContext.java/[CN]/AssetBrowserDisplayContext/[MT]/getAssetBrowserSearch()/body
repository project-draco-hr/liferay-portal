{
  ThemeDisplay themeDisplay=(ThemeDisplay)_request.getAttribute(WebKeys.THEME_DISPLAY);
  AssetBrowserSearch assetBrowserSearch=new AssetBrowserSearch(_renderRequest,getPortletURL());
  if (Validator.isNull(getKeywords())) {
    if (Validator.isNotNull(getAddButtonURL())) {
      assetBrowserSearch.setEmptyResultsMessageCssClass("taglib-empty-result-message-header-has-plus-btn");
    }
  }
 else {
    assetBrowserSearch.setSearch(true);
  }
  AssetRendererFactory assetRendererFactory=getAssetRendererFactory();
  int total=getTotal();
  assetBrowserSearch.setTotal(total);
  if (AssetBrowserWebConfigurationValues.SEARCH_WITH_DATABASE) {
    List<AssetEntry> assetEntries=AssetEntryLocalServiceUtil.getEntries(getFilterGroupIds(),new long[]{assetRendererFactory.getClassNameId()},getKeywords(),getKeywords(),getKeywords(),getKeywords(),getListable(),false,false,assetBrowserSearch.getStart(),assetBrowserSearch.getEnd(),"modifiedDate","title","DESC","ASC");
    assetBrowserSearch.setResults(assetEntries);
  }
 else {
    Hits hits=AssetEntryLocalServiceUtil.search(themeDisplay.getCompanyId(),getFilterGroupIds(),themeDisplay.getUserId(),assetRendererFactory.getClassName(),getSubtypeSelectionId(),getKeywords(),isShowNonindexable(),getStatuses(),assetBrowserSearch.getStart(),assetBrowserSearch.getEnd());
    List<AssetEntry> assetEntries=AssetUtil.getAssetEntries(hits);
    assetBrowserSearch.setResults(assetEntries);
  }
  return assetBrowserSearch;
}
