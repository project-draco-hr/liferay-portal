{
  long companyId=role.getCompanyId();
  long roleId=role.getRoleId();
  if (selected) {
    if (scope == ResourceConstants.SCOPE_GROUP) {
      ResourceBlockServiceUtil.removeAllGroupScopePermissions(scopeGroupId,companyId,selResource,roleId,actionId);
      ResourceBlockServiceUtil.removeCompanyScopePermission(scopeGroupId,companyId,selResource,roleId,actionId);
      for (      String groupId : groupIds) {
        ResourceBlockServiceUtil.addGroupScopePermission(scopeGroupId,companyId,GetterUtil.getLong(groupId),selResource,roleId,actionId);
      }
    }
 else {
      ResourceBlockServiceUtil.removeAllGroupScopePermissions(scopeGroupId,companyId,selResource,roleId,actionId);
      ResourceBlockServiceUtil.addCompanyScopePermission(scopeGroupId,companyId,selResource,roleId,actionId);
    }
  }
 else {
    ResourceBlockServiceUtil.removeAllGroupScopePermissions(scopeGroupId,companyId,selResource,roleId,actionId);
    ResourceBlockServiceUtil.removeCompanyScopePermission(scopeGroupId,companyId,selResource,roleId,actionId);
  }
}
