{
  Locale locale=PortalUtil.getSiteDefaultLocale(groupId);
  List<Element> structureElements=getDDMStructures(fileName,locale);
  for (  Element structureElement : structureElements) {
    boolean dynamicStructure=GetterUtil.getBoolean(structureElement.elementText("dynamic-structure"));
    if (dynamicStructure) {
      continue;
    }
    String name=structureElement.elementText("name");
    String description=structureElement.elementText("description");
    String ddmStructureKey=name;
    DDMStructure ddmStructure=DDMStructureLocalServiceUtil.fetchStructure(groupId,classNameId,ddmStructureKey);
    if (ddmStructure != null) {
      continue;
    }
    Element structureElementRootElement=structureElement.element("root");
    String definition=structureElementRootElement.asXML();
    Map<Locale,String> nameMap=new HashMap<>();
    Map<Locale,String> descriptionMap=new HashMap<>();
    Locale[] locales=LanguageUtil.getAvailableLocales(groupId);
    for (    Locale curLocale : locales) {
      nameMap.put(curLocale,LanguageUtil.get(curLocale,name));
      descriptionMap.put(curLocale,LanguageUtil.get(curLocale,description));
    }
    Attribute defaultLocaleAttribute=structureElementRootElement.attribute("default-locale");
    Locale ddmStructureDefaultLocale=LocaleUtil.fromLanguageId(defaultLocaleAttribute.getValue());
    definition=DDMXMLUtil.updateXMLDefaultLocale(definition,ddmStructureDefaultLocale,locale);
    if (name.equals(DLFileEntryTypeConstants.NAME_IG_IMAGE) && !UpgradeProcessUtil.isCreateIGImageDocumentType()) {
      continue;
    }
    DDMForm ddmForm=DDMFormXSDDeserializerUtil.deserialize(definition);
    DDMFormLayout ddmFormLayout=DDMUtil.getDefaultDDMFormLayout(ddmForm);
    ddmStructure=DDMStructureLocalServiceUtil.addStructure(userId,groupId,DDMStructureConstants.DEFAULT_PARENT_STRUCTURE_ID,classNameId,ddmStructureKey,nameMap,descriptionMap,ddmForm,ddmFormLayout,StorageType.JSON.toString(),DDMStructureConstants.TYPE_DEFAULT,serviceContext);
    Element templateElement=structureElement.element("template");
    if (templateElement == null) {
      continue;
    }
    String templateFileName=templateElement.elementText("file-name");
    boolean templateCacheable=GetterUtil.getBoolean(templateElement.elementText("cacheable"));
    DDMTemplateLocalServiceUtil.addTemplate(userId,groupId,PortalUtil.getClassNameId(DDMStructure.class),ddmStructure.getStructureId(),ddmStructure.getClassNameId(),null,nameMap,null,DDMTemplateConstants.TEMPLATE_TYPE_DISPLAY,DDMTemplateConstants.TEMPLATE_MODE_CREATE,TemplateConstants.LANG_TYPE_FTL,getContent(templateFileName),templateCacheable,false,StringPool.BLANK,null,serviceContext);
  }
}
