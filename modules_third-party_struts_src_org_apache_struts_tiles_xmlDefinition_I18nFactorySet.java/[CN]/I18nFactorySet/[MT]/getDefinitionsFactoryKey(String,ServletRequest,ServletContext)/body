{
  Locale locale=null;
  try {
    HttpSession session=((HttpServletRequest)request).getSession(false);
    if (session != null) {
      locale=(Locale)session.getAttribute(ComponentConstants.LOCALE_KEY);
    }
  }
 catch (  ClassCastException ex) {
    log.error("I18nFactorySet.getDefinitionsFactoryKey");
    ex.printStackTrace();
  }
  return locale;
}
