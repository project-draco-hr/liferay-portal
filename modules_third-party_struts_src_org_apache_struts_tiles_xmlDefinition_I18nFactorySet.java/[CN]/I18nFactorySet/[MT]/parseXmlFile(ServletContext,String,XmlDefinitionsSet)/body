{
  try {
    InputStream input=servletContext.getResourceAsStream(filename);
    if (null == input) {
      try {
        input=new java.io.FileInputStream(servletContext.getRealPath(filename));
      }
 catch (      Exception e) {
      }
    }
    if (input == null) {
      input=getClass().getResourceAsStream(filename);
    }
    if (input == null) {
      if (log.isDebugEnabled()) {
        log.debug("Can't open file '" + filename + "'");
      }
      return xmlDefinitions;
    }
    if (true) {
      xmlParser=new XmlParser();
      xmlParser.setValidating(isValidatingParser);
    }
    if (xmlDefinitions == null) {
      xmlDefinitions=new XmlDefinitionsSet();
    }
    xmlParser.parse(input,xmlDefinitions);
  }
 catch (  SAXException ex) {
    if (log.isDebugEnabled()) {
      log.debug("Error while parsing file '" + filename + "'.");
      ex.printStackTrace();
    }
    throw new DefinitionsFactoryException("Error while parsing file '" + filename + "'. "+ ex.getMessage(),ex);
  }
catch (  IOException ex) {
    throw new DefinitionsFactoryException("IO Error while parsing file '" + filename + "'. "+ ex.getMessage(),ex);
  }
  return xmlDefinitions;
}
