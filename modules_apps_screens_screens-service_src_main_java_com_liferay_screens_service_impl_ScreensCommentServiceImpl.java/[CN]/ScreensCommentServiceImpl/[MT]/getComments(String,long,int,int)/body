{
  DiscussionPermission discussionPermission=commentManager.getDiscussionPermission(getPermissionChecker());
  AssetEntry assetEntry=assetEntryLocalService.getEntry(className,classPK);
  long companyId=groupLocalService.getGroup(assetEntry.getGroupId()).getCompanyId();
  discussionPermission.checkViewPermission(companyId,assetEntry.getGroupId(),className,classPK);
  Discussion discussion=commentManager.getDiscussion(getUserId(),assetEntry.getGroupId(),className,classPK,createServiceContextFunction());
  DiscussionComment rootDiscussionComment=discussion.getRootDiscussionComment();
  if (start == QueryUtil.ALL_POS) {
    start=0;
  }
  DiscussionCommentIterator threadDiscussionCommentIterator=rootDiscussionComment.getThreadDiscussionCommentIterator(start);
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  if (end == QueryUtil.ALL_POS) {
    while (threadDiscussionCommentIterator.hasNext()) {
      JSONObject jsonObject=toJSONObject(threadDiscussionCommentIterator.next(),discussionPermission);
      jsonArray.put(jsonObject);
    }
  }
 else {
    int commentsCount=end - start;
    while (threadDiscussionCommentIterator.hasNext() && (commentsCount > 0)) {
      JSONObject jsonObject=toJSONObject(threadDiscussionCommentIterator.next(),discussionPermission);
      jsonArray.put(jsonObject);
      commentsCount--;
    }
  }
  return jsonArray;
}
