{
  fileExt=fileExt.toLowerCase();
  Reader reader=new BufferedReader(new InputStreamReader(is));
  String text=null;
  try {
    if (fileExt.equals(".doc")) {
      try {
        WordExtractor wordExtractor=new WordExtractor();
        text=wordExtractor.extractText(is);
        text=GetterUtil.getString(text);
      }
 catch (      Exception e1) {
        _log.error(e1.getMessage());
      }
    }
 else     if (fileExt.equals(".htm") || fileExt.equals(".html")) {
      try {
        DefaultStyledDocument dsd=new DefaultStyledDocument();
        HTMLEditorKit htmlEditorKit=new HTMLEditorKit();
        htmlEditorKit.read(reader,dsd,0);
        text=dsd.getText(0,dsd.getLength());
      }
 catch (      Exception e) {
        _log.error(e);
      }
    }
 else     if (fileExt.equals(".pdf")) {
      PDDocument pdDoc=null;
      StringWriter stringWriter=null;
      try {
        PDFParser parser=new PDFParser(is);
        parser.parse();
        pdDoc=parser.getPDDocument();
        stringWriter=new StringWriter();
        PDFTextStripper stripper=new PDFTextStripper();
        stripper.setLineSeparator("\n");
        stripper.writeText(pdDoc,stringWriter);
        text=stringWriter.toString();
      }
 catch (      Exception e) {
        _log.error(e);
      }
 finally {
        try {
          stringWriter.close();
        }
 catch (        Exception e) {
        }
        try {
          pdDoc.close();
        }
 catch (        Exception e) {
        }
      }
    }
 else     if (fileExt.equals(".rtf")) {
      try {
        DefaultStyledDocument dsd=new DefaultStyledDocument();
        RTFEditorKit rtfEditorKit=new RTFEditorKit();
        rtfEditorKit.read(reader,dsd,0);
        text=dsd.getText(0,dsd.getLength());
      }
 catch (      Exception e) {
        _log.error(e);
      }
    }
 else     if (fileExt.equals(".xls")) {
      try {
        XLSTextStripper stripper=new XLSTextStripper(is);
        text=stripper.getText();
      }
 catch (      Exception e) {
        _log.error(e);
      }
    }
    if (text != null) {
      return new Field(field,text,Field.Store.YES,Field.Index.TOKENIZED);
    }
 else {
      return new Field(field,reader);
    }
  }
  finally {
    if (text != null) {
      try {
        reader.close();
      }
 catch (      Exception e) {
      }
      try {
        is.close();
      }
 catch (      Exception e) {
      }
    }
  }
}
