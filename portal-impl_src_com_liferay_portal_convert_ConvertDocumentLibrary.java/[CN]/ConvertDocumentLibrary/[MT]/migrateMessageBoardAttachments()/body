{
  int count=MBMessageLocalServiceUtil.getMBMessagesCount();
  int pages=count / Indexer.DEFAULT_INTERVAL;
  MaintenanceUtil.appendStatus("Migrating message board attachments in " + count + " messages");
  for (int i=0; i <= pages; i++) {
    int start=(i * Indexer.DEFAULT_INTERVAL);
    int end=start + Indexer.DEFAULT_INTERVAL;
    List<MBMessage> messages=MBMessageLocalServiceUtil.getMBMessages(start,end);
    for (    MBMessage message : messages) {
      migrateAttachments(message.getCompanyId(),message.getAttachmentsDir(),message.getAttachmentsFiles());
    }
  }
}
