{
  int count=DLFileEntryLocalServiceUtil.getFileEntriesCount();
  MaintenanceUtil.appendStatus("Migrating " + count + " documents and media files");
  int pages=count / Indexer.DEFAULT_INTERVAL;
  for (int i=0; i <= pages; i++) {
    int start=(i * Indexer.DEFAULT_INTERVAL);
    int end=start + Indexer.DEFAULT_INTERVAL;
    List<DLFileEntry> dlFileEntries=DLFileEntryLocalServiceUtil.getFileEntries(start,end);
    for (    DLFileEntry dlFileEntry : dlFileEntries) {
      long companyId=dlFileEntry.getCompanyId();
      long repositoryId=dlFileEntry.getDataRepositoryId();
      migrateDLFileEntry(companyId,repositoryId,dlFileEntry);
    }
  }
  count=ImageLocalServiceUtil.getImagesCount();
  MaintenanceUtil.appendStatus("Migrating " + count + " images");
  pages=count / Indexer.DEFAULT_INTERVAL;
  for (int i=0; i <= pages; i++) {
    int start=(i * Indexer.DEFAULT_INTERVAL);
    int end=start + Indexer.DEFAULT_INTERVAL;
    List<Image> images=ImageLocalServiceUtil.getImages(start,end);
    for (    Image image : images) {
      String fileName=image.getImageId() + StringPool.PERIOD + image.getType();
      migrateFile(_COMPANY_ID,_REPOSITORY_ID,fileName,Store.VERSION_DEFAULT);
    }
  }
}
