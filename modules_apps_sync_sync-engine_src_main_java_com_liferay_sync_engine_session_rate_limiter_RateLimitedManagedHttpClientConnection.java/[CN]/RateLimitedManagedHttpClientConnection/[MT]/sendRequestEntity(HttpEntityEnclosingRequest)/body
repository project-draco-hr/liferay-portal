{
  Args.notNull(request,"HTTP request");
  ensureOpen();
  HttpEntity entity=request.getEntity();
  if (entity == null) {
    return;
  }
  OutputStream outputStream=prepareOutput(request);
  Header header=request.getFirstHeader("Sync-UUID");
  SyncAccount syncAccount=SyncAccountService.fetchSyncAccount(header.getValue());
  OutputStream rateLimitedOutputStream=new RateLimitedOutputStream(outputStream,syncAccount.getSyncAccountId());
  entity.writeTo(rateLimitedOutputStream);
  outputStream.close();
}
