{
  String postfix=PortalLDAPUtil.getPropertyPostfix(ldapServerId);
  _user=user;
  Properties userMappings=PortalLDAPUtil.getUserMappings(ldapServerId,_user.getCompanyId());
  _attributes=new BasicAttributes(true);
  Attribute objectClass=new BasicAttribute("objectclass");
  String[] defaultObjectClasses=PrefsPropsUtil.getStringArray(_user.getCompanyId(),PropsKeys.LDAP_USER_DEFAULT_OBJECT_CLASSES + postfix,StringPool.COMMA);
  for (int i=0; i < defaultObjectClasses.length; i++) {
    objectClass.add(defaultObjectClasses[i]);
  }
  _attributes.put(objectClass);
  _attributes.put(userMappings.getProperty("firstName"),_user.getFirstName());
  _attributes.put(userMappings.getProperty("lastName"),_user.getLastName());
  if (Validator.isNotNull(_user.getPasswordUnencrypted())) {
    _attributes.put(userMappings.getProperty("password"),_user.getPasswordUnencrypted());
  }
  if (Validator.isNotNull(_user.getEmailAddress())) {
    _attributes.put(userMappings.getProperty("emailAddress"),_user.getEmailAddress());
  }
  String fullNameMapping=userMappings.getProperty("fullName");
  if (Validator.isNotNull(fullNameMapping)) {
    _attributes.put(fullNameMapping,_user.getFullName());
  }
  String jobTitleMapping=userMappings.getProperty("jobTitle");
  if (Validator.isNotNull(jobTitleMapping) && Validator.isNotNull(_user.getJobTitle())) {
    _attributes.put(jobTitleMapping,_user.getJobTitle());
  }
}
