{
  Translation translation=new Translation(_translationId,_fromText);
  try {
    MicrosoftTranslator microsoftTranslator=MicrosoftTranslatorFactoryUtil.getMicrosoftTranslator();
    int x=_translationId.indexOf(StringPool.UNDERLINE);
    if ((x == -1) || ((x + 1) == _translationId.length())) {
      throw new WebCacheException("Invalid translation ID " + _translationId);
    }
    if (Character.isUpperCase(_translationId.charAt(x + 1))) {
      x=_translationId.indexOf(StringPool.UNDERLINE,x + 1);
      if ((x == -1) || ((x + 1) == _translationId.length())) {
        throw new WebCacheException("Invalid translation ID " + _translationId);
      }
    }
    String fromLanguage=_translationId.substring(0,x);
    String toLanguage=_translationId.substring(x + 1);
    String toText=microsoftTranslator.translate(fromLanguage,toLanguage,_fromText);
    translation.setToText(toText);
  }
 catch (  Exception e) {
    throw new WebCacheException(e);
  }
  return translation;
}
