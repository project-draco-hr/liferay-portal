{
  List<File> files=new ArrayList<>();
  Map<Bundle,List<Bundle>> deployedLPKGBundles=_lpkgDeployer.getDeployedLPKGBundles();
  for (  Bundle bundle : deployedLPKGBundles.keySet()) {
    files.add(new File(bundle.getLocation()));
  }
  List<URI> uris=_indexLPKGFiles(files);
  byte[] data=null;
  LocalProcessExecutor localProcessExecutor=new LocalProcessExecutor();
  try {
    ProcessChannel<byte[]> processChannel=localProcessExecutor.execute(_processConfig,new TargetPlatformIndexerProcessCallable(PropsValues.MODULE_FRAMEWORK_BASE_DIR + "/static",PropsValues.MODULE_FRAMEWORK_MODULES_DIR,PropsValues.MODULE_FRAMEWORK_PORTAL_DIR));
    Future<byte[]> future=processChannel.getProcessNoticeableFuture();
    data=future.get();
  }
  finally {
    localProcessExecutor.destroy();
  }
  URL url=_bytesURLProtocolSupport.putData("liferay-target-platform",data);
  uris.add(url.toURI());
  return uris;
}
