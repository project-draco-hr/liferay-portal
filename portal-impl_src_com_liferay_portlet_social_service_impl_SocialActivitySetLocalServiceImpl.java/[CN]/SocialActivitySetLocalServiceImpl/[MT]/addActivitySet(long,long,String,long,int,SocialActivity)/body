{
  User user=userPersistence.findByPrimaryKey(userId);
  long createDate=activity.getCreateDate();
  long activitySetId=counterLocalService.increment();
  SocialActivitySet activitySet=socialActivitySetPersistence.create(activitySetId);
  activitySet.setGroupId(groupId);
  activitySet.setCompanyId(user.getCompanyId());
  activitySet.setUserId(userId);
  activitySet.setCreateDate(createDate);
  activitySet.setModifiedDate(createDate);
  activitySet.setClassName(className);
  activitySet.setClassPK(classPK);
  activitySet.setType(type);
  activitySet.setActivityCount(1);
  socialActivitySetLocalService.addSocialActivitySet(activitySet);
  activity.setActivitySetId(activitySetId);
  socialActivityLocalService.updateSocialActivity(activity);
}
