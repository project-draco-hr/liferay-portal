{
  if (image == null) {
    return null;
  }
  long igThumbnailMaxDimension=PrefsPropsUtil.getLong(PropsKeys.IG_IMAGE_THUMBNAIL_MAX_DIMENSION);
  if ((image.getHeight() <= igThumbnailMaxDimension) && (image.getWidth() <= igThumbnailMaxDimension)) {
    return image;
  }
  DLFileEntry dlFileEntry=DLFileEntryLocalServiceUtil.getFileEntry(dlFileEntryId);
  DLFileEntryLocalServiceUtil.updateSmallImage(dlFileEntry.getSmallImageId(),dlFileEntry.getLargeImageId());
  return ImageServiceUtil.getImage(image.getImageId());
}
