{
  long groupId=GetterUtil.getLong(pathArray[1],-1);
  String uuid=pathArray[3];
  if ((groupId == -1) || Validator.isNull(uuid)) {
    throw new NoSuchFileEntryException("Unable to find attachment with groupId " + groupId + " uuid "+ uuid);
  }
  FileEntry fileEntry=PortletFileRepositoryUtil.getPortletFileEntry(uuid,groupId);
  DLFileEntry dlFileEntry=(DLFileEntry)fileEntry.getModel();
  DLFileVersion dlFileVersion=dlFileEntry.getFileVersion();
  int status=ParamUtil.getInteger(request,"status",WorkflowConstants.STATUS_APPROVED);
  if ((status != WorkflowConstants.STATUS_IN_TRASH) && (dlFileVersion.isInTrash() || dlFileEntry.isInTrashContainer())) {
    return null;
  }
  return dlFileEntry;
}
