{
  String[] pathArray=WebDAVUtil.getPathArray(request.getPathInfo(),true);
  WebDAVStorage storage=null;
  if (pathArray.length == 1) {
    storage=(WebDAVStorage)InstancePool.get(CompanyWebDAVStorageImpl.class.getName());
  }
 else   if (pathArray.length == 2) {
    storage=(WebDAVStorage)InstancePool.get(GroupWebDAVStorageImpl.class.getName());
  }
 else   if (pathArray.length >= 3) {
    storage=WebDAVUtil.getStorage(pathArray[2]);
  }
  if (storage == null) {
    throw new WebDAVException("Invalid WebDAV path " + request.getPathInfo());
  }
  return storage;
}
