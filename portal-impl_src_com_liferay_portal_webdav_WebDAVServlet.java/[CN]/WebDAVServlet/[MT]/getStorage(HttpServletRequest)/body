{
  String pathInfo=WebDAVUtil.stripManualCheckInRequiredPath(request.getPathInfo());
  pathInfo=WebDAVUtil.stripOfficeExtension(pathInfo);
  String[] pathArray=WebDAVUtil.getPathArray(pathInfo,true);
  WebDAVStorage storage=null;
  if (pathArray.length == 0) {
    storage=(WebDAVStorage)InstancePool.get(CompanyWebDAVStorageImpl.class.getName());
  }
 else   if (pathArray.length == 1) {
    storage=(WebDAVStorage)InstancePool.get(GroupWebDAVStorageImpl.class.getName());
  }
 else   if (pathArray.length >= 2) {
    storage=WebDAVUtil.getStorage(pathArray[1]);
  }
  return storage;
}
