{
  Thread currentThread=Thread.currentThread();
  ClassLoader contextClassLoader=currentThread.getContextClassLoader();
  Filter filter=(Filter)InstanceFactory.newInstance(contextClassLoader,filterClassName);
  FilterConfig filterConfig=new InvokerFilterConfig(servletContext,filterName,initParameterMap);
  filter.init(filterConfig);
  boolean filterEnabled=true;
  if (filter instanceof LiferayFilter) {
    LiferayFilter liferayFilter=(LiferayFilter)filter;
    filterEnabled=liferayFilter.isFilterEnabled();
  }
  if (filterEnabled) {
    _filterConfigs.put(filterName,filterConfig);
    _filters.put(filterName,filter);
  }
 else {
    if (_log.isDebugEnabled()) {
      _log.debug("Removing disabled filter " + filter.getClass());
    }
  }
}
