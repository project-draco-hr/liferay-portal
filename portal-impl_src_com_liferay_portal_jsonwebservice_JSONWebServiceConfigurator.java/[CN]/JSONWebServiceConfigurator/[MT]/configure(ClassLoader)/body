{
  File[] classPathFiles=null;
  if (classLoader != null) {
    URL servicePropertiesURL=classLoader.getResource("service.properties");
    String servicePropertiesPath=servicePropertiesURL.getPath();
    File classPathFile=null;
    int pos=servicePropertiesPath.indexOf("_wl_cls_gen.jar!");
    if (pos != -1) {
      String wlClsGenJarPath=servicePropertiesPath.substring(0,pos + 15);
      classPathFile=new File(wlClsGenJarPath);
    }
 else {
      File servicePropertiesFile=new File(servicePropertiesPath);
      File webInfDir=servicePropertiesFile.getParentFile();
      classPathFile=webInfDir;
    }
    classPathFiles=new File[1];
    classPathFiles[0]=classPathFile;
  }
 else {
    Thread currentThread=Thread.currentThread();
    classLoader=currentThread.getContextClassLoader();
    File portalImplJarFile=new File(PortalUtil.getPortalLibDir(),"portal-impl.jar");
    File portalServiceJarFile=new File(PortalUtil.getGlobalLibDir(),"portal-service.jar");
    if (portalImplJarFile.exists() && portalServiceJarFile.exists()) {
      classPathFiles=new File[2];
      classPathFiles[0]=portalImplJarFile;
      classPathFiles[1]=portalServiceJarFile;
    }
 else {
      classPathFiles=ClassLoaderUtil.getDefaultClasspath(classLoader);
    }
  }
  _classLoader=classLoader;
  configure(classPathFiles);
}
