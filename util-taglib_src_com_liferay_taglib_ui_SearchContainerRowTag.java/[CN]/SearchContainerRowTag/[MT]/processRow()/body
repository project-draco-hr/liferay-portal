{
  Object model=_results.get(_rowIndex);
  if (isEscapedModel()) {
    try {
      Thread currentThread=Thread.currentThread();
      ClassLoader contextClassLoader=currentThread.getContextClassLoader();
      Class<?> classObj=contextClassLoader.loadClass(_className);
      Method method=classObj.getMethod("toEscapedModel",new Class[0]);
      model=method.invoke(model,new Object[0]);
    }
 catch (    Exception e) {
      throw new JspException(e.getMessage());
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug(BeanPropertiesUtil.getBoolean(model,"escapedModel"));
  }
  if (Validator.isNull(_keyProperty)) {
    String primaryKey=String.valueOf(model);
    _row=new ResultRow(model,primaryKey,_rowIndex,_bold);
  }
 else   if (isStringKey()) {
    String primaryKey=BeanPropertiesUtil.getString(model,_keyProperty);
    _row=new ResultRow(model,primaryKey,_rowIndex,_bold);
  }
 else {
    long primaryKey=BeanPropertiesUtil.getLong(model,_keyProperty);
    _row=new ResultRow(model,primaryKey,_rowIndex,_bold);
  }
  pageContext.setAttribute(_indexVar,_rowIndex);
  pageContext.setAttribute(_modelVar,model);
  pageContext.setAttribute(_rowVar,_row);
}
