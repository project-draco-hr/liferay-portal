{
  try {
    DatabaseMetaData databaseMetaData=connection.getMetaData();
    ResultSet tableResultSet=databaseMetaData.getTables(null,null,tableName,null);
    try {
      if (!tableResultSet.next()) {
        throw new IllegalStateException("Unable to access table " + tableName);
      }
    }
  finally {
      DataAccess.cleanUp(tableResultSet);
    }
    ResultSet columnResultSet=databaseMetaData.getColumns(null,null,tableName,null);
    List<Object[]> columns=new ArrayList<Object[]>();
    try {
      while (columnResultSet.next()) {
        columns.add(new Object[]{columnResultSet.getString("COLUMN_NAME"),columnResultSet.getInt("DATA_TYPE")});
      }
    }
  finally {
      DataAccess.cleanUp(columnResultSet);
    }
    return new Table(tableName,columns.toArray(new Object[columns.size()][]));
  }
 catch (  SQLException sqle) {
    throw new RuntimeException(sqle);
  }
}
