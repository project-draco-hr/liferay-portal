{
  String type=getPreviewType(fileVersion);
  File file=null;
  try {
    file=FileUtil.createTempFile(type);
    FileOutputStream fos=new FileOutputStream(file);
    try {
      ImageToolUtil.write(renderedImage,type,fos);
    }
  finally {
      fos.close();
    }
    addFileToStore(fileVersion.getCompanyId(),PREVIEW_PATH,getPreviewFilePath(fileVersion,type),file);
  }
  finally {
    FileUtil.delete(file);
  }
}
