{
  try {
    File jackrabbitConfigFile=new File(_jcrStoreConfiguration.jackrabbitConfigFilePath());
    if (jackrabbitConfigFile.exists() && jackrabbitConfigFile.isFile()) {
      return;
    }
    String path=_jcrStoreConfiguration.jackrabbitRepositoryRoot();
    File repositoryRoot=new File(path);
    if (!repositoryRoot.isAbsolute()) {
      path=PropsUtil.get(PropsKeys.LIFERAY_HOME) + StringPool.SLASH + path;
    }
    FileUtil.mkdirs(path);
    File tempFile=new File(SystemProperties.get(SystemProperties.TMP_DIR) + File.separator + Time.getTimestamp());
    String repositoryXmlPath="com/liferay/portal/store/jcr/jackrabbit/dependencies" + "/repository-ext.xml";
    ClassLoader classLoader=getClass().getClassLoader();
    if (classLoader.getResource(repositoryXmlPath) == null) {
      repositoryXmlPath="com/liferay/portal/store/jcr/jackrabbit/dependencies" + "/repository.xml";
    }
    FileUtil.write(tempFile,classLoader.getResourceAsStream(repositoryXmlPath));
    FileUtil.copyFile(tempFile,jackrabbitConfigFile);
    tempFile.delete();
  }
 catch (  IOException ioe) {
    _log.error("Unable to prepare Jackrabbit directory");
    throw new RepositoryException(ioe);
  }
}
