{
  SecurityManager securityManager=System.getSecurityManager();
  if (securityManager == null) {
    return;
  }
  String methodName=method.getName();
  if (methodName.equals("invokeMethod")) {
    methodName=(String)arguments[0];
  }
  Class<?> clazz=PACLUtil.getClass(object);
  String className=PACLUtil.getServiceInterfaceName(clazz.getName());
  ClassLoader classLoader=ClassLoaderUtil.getClassLoader(clazz);
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
  if ((paclPolicy != null) && (paclPolicy == PACLUtil.getPACLPolicy())) {
    return;
  }
  String contextName="portal";
  if (paclPolicy != null) {
    contextName=paclPolicy.getContextName();
  }
  PortalServicePermission portalServicePermission=new PortalServicePermission(PACLConstants.PORTAL_SERVICE_PERMISSION_SERVICE,contextName,className,methodName);
  securityManager.checkPermission(portalServicePermission);
}
