{
  MailAccount account=null;
  AccountFinder accountFinder=AccountFinderLocator.getAccountFinderInstance();
  User user=null;
  String password=null;
  try {
    String userId=PortalUtil.getUserId(ses);
    user=UserLocalServiceUtil.getUserById(userId);
    password=PortalUtil.getUserPassword(ses);
    account=accountFinder.findAccount(user,password,accountName);
  }
 catch (  AccountNotFoundException anfe) {
    try {
      account=accountFinder.findAccount(user,password,accountFinder.getDefaultAccountName());
    }
 catch (    Exception e1) {
      throw new MailAccountsException("Could not read the default account",e1);
    }
  }
catch (  Exception e2) {
    throw new MailAccountsException("Could not read the account " + accountName,e2);
  }
  _findAllAccounts(user,password);
  return account;
}
