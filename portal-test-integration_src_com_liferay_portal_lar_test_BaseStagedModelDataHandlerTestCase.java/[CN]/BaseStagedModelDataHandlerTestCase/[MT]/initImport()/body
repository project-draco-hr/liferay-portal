{
  userIdStrategy=new TestUserIdStrategy();
  zipReader=ZipReaderFactoryUtil.getZipReader(zipWriter.getFile());
  String xml=zipReader.getEntryAsString("/manifest.xml");
  if (xml == null) {
    Document document=SAXReaderUtil.createDocument();
    Element rootElement=document.addElement("root");
    rootElement.addElement("header");
    zipWriter.addEntry("/manifest.xml",document.asXML());
    zipReader=ZipReaderFactoryUtil.getZipReader(zipWriter.getFile());
  }
  portletDataContext=PortletDataContextFactoryUtil.createImportPortletDataContext(liveGroup.getCompanyId(),liveGroup.getGroupId(),getParameterMap(),userIdStrategy,zipReader);
  portletDataContext.setImportDataRootElement(rootElement);
  Element missingReferencesElement=rootElement.element("missing-references");
  if (missingReferencesElement == null) {
    missingReferencesElement=rootElement.addElement("missing-references");
  }
  portletDataContext.setMissingReferencesElement(missingReferencesElement);
  Group sourceCompanyGroup=GroupLocalServiceUtil.getCompanyGroup(stagingGroup.getCompanyId());
  portletDataContext.setSourceCompanyGroupId(sourceCompanyGroup.getGroupId());
  portletDataContext.setSourceCompanyId(stagingGroup.getCompanyId());
  portletDataContext.setSourceGroupId(stagingGroup.getGroupId());
}
