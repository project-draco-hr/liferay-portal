{
  if (Validator.isNull(xpath)) {
    return xpath;
  }
  StringBuilder sb=new StringBuilder();
  for (int i=0; i < xpath.length(); i++) {
    char c=xpath.charAt(i);
    boolean isVulnerable=false;
    for (int j=0; j < _XPATH_TOKENS.length; j++) {
      if (c == _XPATH_TOKENS[j]) {
        isVulnerable=true;
        break;
      }
    }
    if (isVulnerable) {
      sb.append(StringPool.UNDERLINE);
    }
 else {
      sb.append(c);
    }
  }
  return sb.toString();
}
