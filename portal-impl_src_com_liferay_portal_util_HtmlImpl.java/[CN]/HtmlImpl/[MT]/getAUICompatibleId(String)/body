{
  if (Validator.isNull(text)) {
    return text;
  }
  if (text.length() == 0) {
    return StringPool.BLANK;
  }
  StringBundler sb=null;
  int lastReplacementIndex=0;
  for (int i=0; i < text.length(); i++) {
    char c=text.charAt(i);
    if (!((c <= CharPool.SLASH) || ((c >= CharPool.COLON) && (c <= CharPool.AT)) || ((c >= CharPool.OPEN_BRACKET) && (c <= CharPool.PRIME))|| ((c >= CharPool.OPEN_CURLY_BRACE) && (c <= CharPool.DELETE))|| (c == CharPool.NO_BREAK_SPACE)|| (c == CharPool.FIGURE_SPACE)|| (c == CharPool.NARROW_NO_BREAK_SPACE))) {
      continue;
    }
    if (sb == null) {
      sb=new StringBundler();
    }
    if (i > lastReplacementIndex) {
      sb.append(text.substring(lastReplacementIndex,i));
    }
    sb.append(CharPool.UNDERLINE);
    if (c != CharPool.UNDERLINE) {
      sb.append(Integer.toHexString(c));
    }
    sb.append(CharPool.UNDERLINE);
    lastReplacementIndex=i + 1;
  }
  if (sb == null) {
    return text;
  }
  if (lastReplacementIndex < text.length()) {
    sb.append(text.substring(lastReplacementIndex));
  }
  return sb.toString();
}
