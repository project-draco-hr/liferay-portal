{
  UnicodeProperties typeSettingsProperties=layout.getTypeSettingsProperties();
  if (layout.isHidden() || !PortalUtil.isLayoutSitemapable(layout) || !GetterUtil.getBoolean(typeSettingsProperties.getProperty("sitemap-include"),true)) {
    return;
  }
  Element urlElement=element.addElement("url");
  String layoutFullURL=PortalUtil.getLayoutFullURL(layout,themeDisplay);
  layoutFullURL=PortalUtil.getCanonicalURL(layoutFullURL,themeDisplay,layout);
  Element locElement=urlElement.addElement("loc");
  locElement.addText(encodeXML(layoutFullURL));
  String changefreq=typeSettingsProperties.getProperty("sitemap-changefreq");
  if (Validator.isNotNull(changefreq)) {
    Element changefreqElement=urlElement.addElement("changefreq");
    changefreqElement.addText(changefreq);
  }
  String priority=typeSettingsProperties.getProperty("sitemap-priority");
  if (Validator.isNotNull(priority)) {
    Element priorityElement=urlElement.addElement("priority");
    priorityElement.addText(priority);
  }
  visitArticles(element,layout,themeDisplay);
  List<Layout> children=layout.getChildren();
  visitLayouts(element,children,themeDisplay);
}
