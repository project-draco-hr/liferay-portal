{
  StringBundler sb=null;
  int lastReplacementIndex=0;
  for (int i=0; i < input.length(); i++) {
    char c=input.charAt(i);
    String replacement=null;
switch (c) {
case '&':
      replacement="&amp;";
    break;
case '<':
  replacement="&lt;";
break;
case '>':
replacement="&gt;";
break;
case '\'':
replacement="&apos;";
break;
case '"':
replacement="&quot;";
break;
}
if (replacement != null) {
if (sb == null) {
sb=new StringBundler();
}
if (i > lastReplacementIndex) {
sb.append(input.substring(lastReplacementIndex,i));
}
sb.append(replacement);
lastReplacementIndex=i + 1;
}
}
if (sb == null) {
return input;
}
if (lastReplacementIndex < input.length()) {
sb.append(input.substring(lastReplacementIndex));
}
return sb.toString();
}
