{
  if (Validator.isNull(encryptedPassword)) {
    Matcher matcher=_pattern.matcher(algorithm);
    if (matcher.matches()) {
      _keySize=GetterUtil.getInteger(matcher.group(1),_KEY_SIZE);
      _rounds=GetterUtil.getInteger(matcher.group(2),_ROUNDS);
    }
    BigEndianCodec.putLong(_saltBytes,0,SecureRandomUtil.nextLong());
  }
 else {
    byte[] bytes=new byte[16];
    try {
      byte[] encryptedPasswordBytes=Base64.decode(encryptedPassword);
      System.arraycopy(encryptedPasswordBytes,0,bytes,0,bytes.length);
    }
 catch (    Exception e) {
      throw new PwdEncryptorException("Unable to extract salt from encrypted password " + e.getMessage(),e);
    }
    ByteBuffer byteBuffer=ByteBuffer.wrap(bytes);
    _keySize=byteBuffer.getInt();
    _rounds=byteBuffer.getInt();
    byteBuffer.get(_saltBytes);
  }
}
