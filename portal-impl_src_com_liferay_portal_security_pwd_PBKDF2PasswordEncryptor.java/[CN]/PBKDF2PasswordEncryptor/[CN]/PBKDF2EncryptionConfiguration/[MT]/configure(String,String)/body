{
  if (Validator.isNull(currentEncryptedPassword)) {
    Matcher pbkdf2Matcher=_PBKDF2_PATTERN.matcher(algorithm);
    if (pbkdf2Matcher.matches()) {
      _keySize=GetterUtil.getInteger(pbkdf2Matcher.group(1),_DEFAULT_PBKDF2_KEY_SIZE);
      _rounds=GetterUtil.getInteger(pbkdf2Matcher.group(2),_DEFAULT_PBKDF2_ROUNDS);
    }
    SecureRandom random=new SecureRandom();
    random.nextBytes(_saltBytes);
  }
 else {
    byte[] configAndSalt=new byte[16];
    try {
      byte[] passwordBytes=Base64.decode(currentEncryptedPassword);
      System.arraycopy(passwordBytes,0,configAndSalt,0,configAndSalt.length);
    }
 catch (    Exception e) {
      throw new PwdEncryptorException("Unable to extract salt from encrypted password: " + e.getMessage());
    }
    ByteBuffer buff=ByteBuffer.wrap(configAndSalt);
    _keySize=buff.getInt();
    _rounds=buff.getInt();
    buff.get(_saltBytes);
  }
}
