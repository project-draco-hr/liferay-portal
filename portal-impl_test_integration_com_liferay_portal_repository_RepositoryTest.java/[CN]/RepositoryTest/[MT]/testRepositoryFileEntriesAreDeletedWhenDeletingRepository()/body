{
  long classNameId=PortalUtil.getClassNameId(LiferayRepository.class);
  Repository repository1=RepositoryLocalServiceUtil.addRepository(TestPropsValues.getUserId(),_group.getGroupId(),classNameId,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID,RandomTestUtil.randomString(),RandomTestUtil.randomString(),PortletKeys.DOCUMENT_LIBRARY,new UnicodeProperties(),true,new ServiceContext());
  long[] fileEntryIds=new long[4];
  long[] primaryKeys=populateRepository(repository1.getRepositoryId());
  fileEntryIds[0]=primaryKeys[0];
  fileEntryIds[1]=primaryKeys[2];
  long[] folderIds=new long[2];
  folderIds[0]=primaryKeys[1];
  Repository repository2=RepositoryLocalServiceUtil.addRepository(TestPropsValues.getUserId(),_group.getGroupId(),classNameId,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID,RandomTestUtil.randomString(),RandomTestUtil.randomString(),PortletKeys.DOCUMENT_LIBRARY,new UnicodeProperties(),true,new ServiceContext());
  primaryKeys=populateRepository(repository2.getRepositoryId());
  fileEntryIds[2]=primaryKeys[0];
  fileEntryIds[3]=primaryKeys[2];
  folderIds[1]=primaryKeys[1];
  DLAppLocalServiceUtil.deleteAll(repository1.getRepositoryId());
  try {
    LocalRepository localRepository=RepositoryServiceUtil.getLocalRepositoryImpl(repository2.getRepositoryId());
    localRepository.getFileEntry(fileEntryIds[0]);
    localRepository.getFileEntry(fileEntryIds[1]);
    Assert.fail("Should be able to get file entry from repository " + repository2.getRepositoryId());
  }
 catch (  Exception e) {
  }
  try {
    LocalRepository localRepository=RepositoryServiceUtil.getLocalRepositoryImpl(repository2.getRepositoryId());
    localRepository.getFileEntry(fileEntryIds[2]);
    localRepository.getFileEntry(fileEntryIds[3]);
  }
 catch (  Exception e) {
    Assert.fail("Should not be able to get file entry from repository " + repository2.getRepositoryId());
  }
}
