{
  int initialMountFolders=DLFolderServiceUtil.getMountFoldersCount(TestPropsValues.getGroupId(),DLFolderConstants.DEFAULT_PARENT_FOLDER_ID);
  long[] repositoryIds=new long[2];
  long classNameId=PortalUtil.getClassNameId(LiferayRepository.class);
  repositoryIds[0]=RepositoryLocalServiceUtil.addRepository(TestPropsValues.getUserId(),TestPropsValues.getGroupId(),classNameId,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID,"Test 1","Test 1",PortletKeys.DOCUMENT_LIBRARY,new UnicodeProperties(),hidden,new ServiceContext());
  DLFolder dlFolder=DLFolderServiceUtil.addFolder(TestPropsValues.getGroupId(),TestPropsValues.getGroupId(),false,DLFolderConstants.DEFAULT_PARENT_FOLDER_ID,"Folder","Folder",new ServiceContext());
  repositoryIds[1]=RepositoryLocalServiceUtil.addRepository(TestPropsValues.getUserId(),TestPropsValues.getGroupId(),classNameId,dlFolder.getFolderId(),"Test 2","Test 2",PortletKeys.DOCUMENT_LIBRARY,new UnicodeProperties(),hidden,new ServiceContext());
  if (hidden) {
    Assert.assertEquals(initialMountFolders,DLFolderServiceUtil.getMountFoldersCount(TestPropsValues.getGroupId(),DLFolderConstants.DEFAULT_PARENT_FOLDER_ID));
  }
 else {
    Assert.assertEquals(initialMountFolders + 1,DLFolderServiceUtil.getMountFoldersCount(TestPropsValues.getGroupId(),DLFolderConstants.DEFAULT_PARENT_FOLDER_ID));
  }
  RepositoryLocalServiceUtil.deleteRepositories(TestPropsValues.getGroupId());
  for (  long repositoryId : repositoryIds) {
    try {
      RepositoryServiceUtil.getLocalRepositoryImpl(repositoryId);
      Assert.fail("Should not be able to access repository " + repositoryId);
    }
 catch (    Exception e) {
    }
  }
  Assert.assertEquals(initialMountFolders,DLFolderServiceUtil.getMountFoldersCount(TestPropsValues.getGroupId(),DLFolderConstants.DEFAULT_PARENT_FOLDER_ID));
}
