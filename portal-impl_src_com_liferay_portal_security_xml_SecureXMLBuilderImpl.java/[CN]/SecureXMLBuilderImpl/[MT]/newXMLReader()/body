{
  XMLReader xmlReader=new SAXParser();
  if (!PropsValues.XML_SECURITY_ENABLED) {
    return xmlReader;
  }
  try {
    xmlReader.setFeature(_FEATURES_DISALLOW_DOCTYPE_DECL,true);
  }
 catch (  Exception e) {
    _log.error("Unable to initialize safe SAX parser! Your system may be " + "vulnerable to XML Bomb attacks!",e);
  }
  try {
    xmlReader.setFeature(_FEATURES_EXTERNAL_GENERAL_ENTITIES,false);
    xmlReader.setFeature(_FEATURES_EXTERNAL_PARAMETER_ENTITIES,false);
  }
 catch (  Exception e) {
    _log.error("Unable to initialize safe SAX parser! Your system may be " + "vulnerable to XXE attacks!",e);
  }
  return xmlReader;
}
