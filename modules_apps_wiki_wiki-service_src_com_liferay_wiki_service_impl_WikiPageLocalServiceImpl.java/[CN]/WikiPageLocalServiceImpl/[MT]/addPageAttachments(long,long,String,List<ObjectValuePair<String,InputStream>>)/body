{
  List<FileEntry> fileEntries=new ArrayList<>();
  if (inputStreamOVPs.isEmpty()) {
    return Collections.emptyList();
  }
  for (int i=0; i < inputStreamOVPs.size(); i++) {
    ObjectValuePair<String,InputStream> inputStreamOVP=inputStreamOVPs.get(i);
    String fileName=inputStreamOVP.getKey();
    InputStream inputStream=inputStreamOVP.getValue();
    File file=null;
    try {
      file=FileUtil.createTempFile(inputStream);
      String mimeType=MimeTypesUtil.getContentType(file,fileName);
      FileEntry fileEntry=addPageAttachment(userId,nodeId,title,fileName,file,mimeType);
      fileEntries.add(fileEntry);
    }
 catch (    IOException ioe) {
      throw new SystemException("Unable to write temporary file",ioe);
    }
 finally {
      FileUtil.delete(file);
    }
  }
  return fileEntries;
}
