{
  List<WikiPage> versionPages=wikiPagePersistence.findByN_T(nodeId,title,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new PageVersionComparator());
  WikiPage page=fetchLatestPage(newNodeId,title,WorkflowConstants.STATUS_ANY,false);
  if (page == null) {
    page=getLatestPage(nodeId,title,WorkflowConstants.STATUS_ANY,false);
  }
  for (  WikiPage versionPage : versionPages) {
    versionPage.setParentTitle(page.getParentTitle());
    versionPage.setNodeId(newNodeId);
    wikiPagePersistence.update(versionPage);
  }
  long resourcePrimKey=page.getResourcePrimKey();
  WikiPageResource pageResource=wikiPageResourcePersistence.findByPrimaryKey(resourcePrimKey);
  pageResource.setNodeId(newNodeId);
  wikiPageResourcePersistence.update(pageResource);
  changeChildPagesNode(userId,nodeId,title,newNodeId,serviceContext);
  changeRedirectorPagesNode(userId,nodeId,title,newNodeId,serviceContext);
  updateAsset(userId,page,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames(),serviceContext.getAssetLinkEntryIds());
  return page;
}
