{
  if (_permissions.implies(permission)) {
    return true;
  }
  int stackIndex=Reflection.getStackIndex(10,9);
  Class<?> callerClass1=Reflection.getCallerClass(stackIndex);
  Class<?> callerClass2=Reflection.getCallerClass(stackIndex + 1);
  Package callerClass1Package=callerClass1.getPackage();
  if ((callerClass1Package != null) && callerClass1Package.getName().startsWith("java.") && !callerClass1.equals(ProcessBuilder.class)&& isTrustedCaller(callerClass2,permission)) {
    return true;
  }
  logSecurityException(_log,"Attempted to " + permission.getActions() + " on file "+ permission.getName());
  return false;
}
