{
  _mockClusterExecutor.setNodeNumber(3);
  CaptureHandler captureHandler=null;
  try {
    captureHandler=JDKLoggerTestUtil.configureJDKLogger(LuceneHelperImpl.class.getName(),Level.FINE);
    List<LogRecord> logRecords=captureHandler.getLogRecords();
    ClusterEvent clusterEvent=ClusterEvent.join(_clusterNode);
    _fireClusterEventListeners(clusterEvent);
    Assert.assertEquals(1,logRecords.size());
    _assertLogger(logRecords.get(0),"Number of original cluster members is greater than one",null);
    Assert.assertNotEquals(_COMPANY_ID,LuceneClusterUtilAdvice._COMPANY_ID);
    logRecords=captureHandler.resetLogLevel(Level.INFO);
    _fireClusterEventListeners(clusterEvent);
    Assert.assertTrue(logRecords.isEmpty());
    Assert.assertNotEquals(_COMPANY_ID,LuceneClusterUtilAdvice._COMPANY_ID);
  }
  finally {
    if (captureHandler != null) {
      captureHandler.close();
    }
  }
}
