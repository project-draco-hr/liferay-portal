{
  String className=PortalUtil.getClassName(classNameId);
  String[] groupIdSQLParts=StringUtil.split(_getGroupIdSQLPartsMap.get(className));
  if (ArrayUtil.isEmpty(groupIdSQLParts)) {
    if (_log.isWarnEnabled()) {
      _log.warn("Unable to determine the group ID for the class name " + className);
    }
    return 0;
  }
  String sql="select " + groupIdSQLParts[1] + " from "+ groupIdSQLParts[0]+ " where "+ groupIdSQLParts[2]+ " = ?";
  try (PreparedStatement ps=connection.prepareStatement(sql)){
    ps.setLong(1,classPK);
    try (ResultSet rs=ps.executeQuery()){
      if (rs.next()) {
        return rs.getLong("groupId");
      }
    }
   }
   return 0;
}
