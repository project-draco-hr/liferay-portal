{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  ShoppingSettings preferences=ShoppingSettings.getInstance(themeDisplay.getCompanyId(),themeDisplay.getScopeGroupId());
  updatePayment(actionRequest,preferences);
  updateShippingCalculation(actionRequest,preferences);
  updateInsuranceCalculation(actionRequest,preferences);
  updateEmailFrom(actionRequest,preferences);
  updateEmailOrderConfirmation(actionRequest,preferences);
  updateEmailOrderShipping(actionRequest,preferences);
  if (SessionErrors.isEmpty(actionRequest)) {
    preferences.store();
    SessionMessages.add(actionRequest,PortalUtil.getPortletId(actionRequest) + SessionMessages.KEY_SUFFIX_REFRESH_PORTLET,PortletKeys.SHOPPING);
    SessionMessages.add(actionRequest,PortalUtil.getPortletId(actionRequest) + SessionMessages.KEY_SUFFIX_UPDATED_CONFIGURATION);
  }
}
