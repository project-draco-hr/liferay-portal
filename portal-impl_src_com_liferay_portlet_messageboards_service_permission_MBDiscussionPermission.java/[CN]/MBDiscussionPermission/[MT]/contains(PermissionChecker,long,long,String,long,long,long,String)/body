{
  MBMessage message=MBMessageLocalServiceUtil.getMessage(messageId);
  if (message.isPending()) {
    Boolean hasPermission=WorkflowPermissionUtil.hasPermission(permissionChecker,message.getGroupId(),message.getWorkflowClassName(),message.getMessageId(),actionId);
    if (hasPermission != null) {
      return hasPermission.booleanValue();
    }
  }
  if (!contains(permissionChecker,companyId,groupId,className,classPK,ownerId,actionId)) {
    return false;
  }
  MBDiscussion discussion=MBDiscussionLocalServiceUtil.getThreadDiscussion(message.getThreadId());
  long classNameId=PortalUtil.getClassNameId(className);
  if ((discussion.getClassNameId() == classNameId) && (discussion.getClassPK() == classPK)) {
    return true;
  }
  return false;
}
