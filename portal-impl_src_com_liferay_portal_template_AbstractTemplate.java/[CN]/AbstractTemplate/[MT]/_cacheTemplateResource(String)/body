{
  String templateId=templateResource.getTemplateId();
  if (templateManagerName.equals(TemplateConstants.LANG_TYPE_VM) && templateId.contains(SandboxHandler.SANDBOX_MARKER)) {
    return;
  }
  if (!(templateResource instanceof CacheTemplateResource) && !(templateResource instanceof StringTemplateResource)) {
    templateResource=new CacheTemplateResource(templateResource);
  }
  String cacheName=TemplateResourceLoader.class.getName();
  cacheName=cacheName.concat(StringPool.PERIOD).concat(templateManagerName);
  PortalCache<String,Serializable> portalCache=_getPortalCache(templateResource,cacheName);
  Object object=portalCache.get(templateResource.getTemplateId());
  if ((object == null) || !templateResource.equals(object)) {
    portalCache.put(templateResource.getTemplateId(),templateResource);
  }
  if (errorTemplateResource == null) {
    return;
  }
  String errorTemplateId=errorTemplateResource.getTemplateId();
  if (templateManagerName.equals(TemplateConstants.LANG_TYPE_VM) && errorTemplateId.contains(SandboxHandler.SANDBOX_MARKER)) {
    return;
  }
  if (!(errorTemplateResource instanceof CacheTemplateResource) && !(errorTemplateResource instanceof StringTemplateResource)) {
    errorTemplateResource=new CacheTemplateResource(errorTemplateResource);
  }
  portalCache=_getPortalCache(errorTemplateResource,cacheName);
  object=portalCache.get(errorTemplateResource.getTemplateId());
  if ((object == null) || !errorTemplateResource.equals(object)) {
    portalCache.put(errorTemplateResource.getTemplateId(),errorTemplateResource);
  }
}
