{
  int initialNotInTrashCount=getNotInTrashCount();
  int initialTrashEntriesCount=getTrashEntriesCount();
  Folder folder1=addFolder(false,"Folder A1");
  Folder folder2=addFolder(false,"Folder A2");
  long subEntryId=doAddSubEntry(folder1.getFolderId(),folder2.getFolderId());
  Assert.assertEquals(initialNotInTrashCount + 2,getNotInTrashCount());
  Assert.assertEquals(initialTrashEntriesCount,getTrashEntriesCount());
  doMoveSubEntryToTrash(subEntryId);
  DLAppServiceUtil.moveFolderToTrash(folder1.getFolderId());
  Assert.assertEquals(initialNotInTrashCount + 1,getNotInTrashCount());
  Assert.assertEquals(initialTrashEntriesCount + 2,getTrashEntriesCount());
  if (deleteFolder) {
    TrashEntry trashEntry=TrashEntryLocalServiceUtil.getEntry(DLFolderConstants.getClassName(),folder1.getFolderId());
    TrashHandler trashHandler=TrashHandlerRegistryUtil.getTrashHandler(trashEntry.getClassName());
    trashHandler.deleteTrashEntry(trashEntry.getClassPK());
    Assert.assertEquals(initialNotInTrashCount + 1,getNotInTrashCount());
    Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount());
  }
 else {
    doMoveSubEntryFromTrash(subEntryId);
    Assert.assertEquals(initialNotInTrashCount + 2,getNotInTrashCount());
    Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount());
  }
}
