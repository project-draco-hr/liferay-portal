{
  String[] oldValues=portletPreferences.getValues(key,null);
  if (oldValues == null) {
    return;
  }
  String[] newValues=new String[oldValues.length];
  for (int i=0; i < oldValues.length; i++) {
    String oldValue=oldValues[i];
    String newValue=oldValue;
    String[] primaryKeys=StringUtil.split(oldValue);
    for (    String primaryKey : primaryKeys) {
      if (!Validator.isNumber(primaryKey)) {
        break;
      }
      long primaryKeyLong=GetterUtil.getLong(primaryKey);
      String newPreferencesValue=getExportPortletPreferencesValue(portletDataContext,portlet,className,primaryKeyLong);
      if (Validator.isNull(newPreferencesValue)) {
        if (_log.isWarnEnabled()) {
          StringBundler sb=new StringBundler(4);
          sb.append("Unable to export portlet preferences value " + "contains class with class name ");
          sb.append(className);
          sb.append(" and primary key ");
          sb.append(primaryKeyLong);
          _log.warn(sb.toString());
        }
        continue;
      }
      newValue=StringUtil.replace(newValue,primaryKey,newPreferencesValue);
    }
    newValues[i]=newValue;
  }
  portletPreferences.setValues(key,newValues);
}
