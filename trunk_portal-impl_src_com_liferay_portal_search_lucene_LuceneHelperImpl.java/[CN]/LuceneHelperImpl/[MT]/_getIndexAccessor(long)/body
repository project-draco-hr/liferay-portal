{
  IndexAccessor indexAccessor=_indexAccessors.get(companyId);
  if (indexAccessor != null) {
    return indexAccessor;
  }
synchronized (this) {
    indexAccessor=_indexAccessors.get(companyId);
    if (indexAccessor == null) {
      indexAccessor=new IndexAccessorImpl(companyId);
      if (isLoadIndexFromClusterEnabled()) {
        InputStream inputStream=null;
        try {
          Address bootupAddress=selectBootupClusterAddress(companyId,IndexAccessor.DEFAULT_LAST_GENERATION);
          if (bootupAddress != null) {
            inputStream=getLoadIndexesInputStreamFromCluster(companyId,bootupAddress);
            indexAccessor.loadIndex(inputStream);
          }
          indexAccessor.enableDumpIndex();
        }
 catch (        Exception e) {
          _log.error("Unable to load index for company " + indexAccessor.getCompanyId(),e);
        }
 finally {
          if (inputStream != null) {
            try {
              inputStream.close();
            }
 catch (            IOException ioe) {
              _log.error("Unable to close input stream for " + "company " + indexAccessor.getCompanyId(),ioe);
            }
          }
        }
      }
      _indexAccessors.put(companyId,indexAccessor);
    }
  }
  return indexAccessor;
}
