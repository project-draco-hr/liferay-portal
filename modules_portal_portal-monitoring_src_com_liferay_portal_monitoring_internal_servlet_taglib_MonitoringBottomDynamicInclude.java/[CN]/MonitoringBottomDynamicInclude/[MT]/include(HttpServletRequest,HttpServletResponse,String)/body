{
  if (!_monitoringConfiguration.monitorPortalRequest()) {
    return;
  }
  DataSample dataSample=(DataSample)request.getAttribute(MonitoringWebKeys.PORTAL_REQUEST_DATA_SAMPLE);
  if (dataSample != null) {
    dataSample.capture(RequestStatus.SUCCESS);
    DataSampleThreadLocal.addDataSample(dataSample);
  }
  List<DataSample> dataSamples=DataSampleThreadLocal.getDataSamples();
  if (!_monitoringConfiguration.showPerRequestDataSample() || ListUtil.isEmpty(dataSamples)) {
    return;
  }
  StringBundler sb=new StringBundler(dataSamples.size() * 2 + 2);
  sb.append("<!--\n");
  for (  DataSample curDataSample : dataSamples) {
    sb.append(curDataSample.toString());
    sb.append("\n");
  }
  sb.append("-->");
  PrintWriter printWriter=response.getWriter();
  printWriter.println(sb);
}
