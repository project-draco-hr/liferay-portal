{
  AttributesTransformer attributesTransformer=AttributesTransformerFactory.getInstance();
  attributes=attributesTransformer.transformUser(attributes);
  LDAPUser ldapUser=_ldapToPortalConverter.importLDAPUser(companyId,attributes,userMappings,userExpandoMappings,contactMappings,contactExpandoMappings,password);
  User user=findLiferayUser(companyId,ldapUser);
  if ((user != null) && user.isDefaultUser()) {
    return user;
  }
  if (user != null) {
    String modifiedDate=LDAPUtil.getAttributeValue(attributes,"modifyTimestamp");
    user=updateLiferayUser(companyId,ldapUser,user,password,modifiedDate);
  }
 else {
    user=createLiferayUser(companyId,ldapUser,password);
  }
  updateExpandoAttributes(user,ldapUser);
  return user;
}
