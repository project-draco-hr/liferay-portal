{
  Set<Long> allUserGroups=new HashSet<Long>(newUserGroupIds);
  List<UserGroup> portalUserGroups=UserGroupLocalServiceUtil.getUserUserGroups(userId);
  for (  UserGroup userGroup : portalUserGroups) {
    if (!userGroup.isLdap()) {
      allUserGroups.add(userGroup.getUserGroupId());
    }
  }
  return new ArrayList<Long>(allUserGroups);
}
