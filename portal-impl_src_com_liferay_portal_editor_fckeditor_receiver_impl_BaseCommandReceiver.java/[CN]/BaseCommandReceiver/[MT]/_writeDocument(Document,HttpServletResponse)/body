{
  try {
    Element documentElement=document.getDocumentElement();
    documentElement.normalize();
    TransformerFactory transformerFactory=TransformerFactory.newInstance();
    Transformer transformer=transformerFactory.newTransformer();
    DOMSource domSource=new DOMSource(document);
    if (_log.isDebugEnabled()) {
      StreamResult streamResult=new StreamResult(System.out);
      transformer.transform(domSource,streamResult);
    }
    response.setContentType("text/xml; charset=UTF-8");
    response.setHeader("Cache-Control","no-cache");
    PrintWriter printWriter=response.getWriter();
    StreamResult streamResult=new StreamResult(printWriter);
    transformer.transform(domSource,streamResult);
    printWriter.flush();
    printWriter.close();
  }
 catch (  Exception e) {
    throw new FCKException(e);
  }
}
