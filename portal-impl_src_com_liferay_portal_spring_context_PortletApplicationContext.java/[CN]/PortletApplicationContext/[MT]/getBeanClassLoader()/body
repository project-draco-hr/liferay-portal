{
  if (_isUseRestrictedClassLoader()) {
    boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
    try {
      PortalSecurityManagerThreadLocal.setEnabled(false);
      return new PreloadClassLoader(PortletClassLoaderUtil.getClassLoader(),_classes);
    }
  finally {
      PortalSecurityManagerThreadLocal.setEnabled(enabled);
    }
  }
  ClassLoader beanClassLoader=AggregateClassLoader.getAggregateClassLoader(new ClassLoader[]{PortletClassLoaderUtil.getClassLoader(),PortalClassLoaderUtil.getClassLoader()});
  return new FilterClassLoader(beanClassLoader);
}
