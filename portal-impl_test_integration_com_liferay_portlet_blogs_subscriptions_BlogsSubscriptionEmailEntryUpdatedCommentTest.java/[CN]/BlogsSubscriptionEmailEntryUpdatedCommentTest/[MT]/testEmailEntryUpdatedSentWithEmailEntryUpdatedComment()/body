{
  givenThatBlogSendsEmailEntryUpdatedBasedOnUserComments();
  BlogsEntry entry=BlogsTestUtil.addEntry(group,true);
  BlogsEntryLocalServiceUtil.subscribe(TestPropsValues.getUserId(),group.getGroupId());
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(entry.getGroupId());
  serviceContext.setAttribute("emailEntryUpdatedComment","This entry has been updated");
  serviceContext.setAttribute("sendEmailEntryUpdated",Boolean.TRUE.toString());
  BlogsTestUtil.updateEntry(entry,StringUtil.randomString(),true,serviceContext);
  MailMessage message=MailServiceTestUtil.getLastMailMessage();
  Assert.assertEquals(message.getBody(),"This entry has been updated");
}
