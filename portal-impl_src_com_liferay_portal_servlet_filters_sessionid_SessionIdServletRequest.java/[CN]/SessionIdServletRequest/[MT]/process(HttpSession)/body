{
  if ((session == null) || !session.isNew() || !isSecure()|| isRequestedSessionIdFromCookie()) {
    return;
  }
  Object jsessionIdAlreadySet=getAttribute(_JESSIONID_ALREADY_SET);
  if (jsessionIdAlreadySet == null) {
    if (_log.isDebugEnabled()) {
      _log.debug("Processing " + session.getId());
    }
    Cookie cookie=new Cookie(_JESSIONID,session.getId());
    cookie.setMaxAge(-1);
    String contextPath=getContextPath();
    if (Validator.isNotNull(contextPath)) {
      cookie.setPath(contextPath);
    }
 else {
      cookie.setPath(StringPool.SLASH);
    }
    _res.addCookie(cookie);
    setAttribute(_JESSIONID_ALREADY_SET,Boolean.TRUE);
  }
}
