{
  String flagString=String.valueOf(flag);
  Message message=messagePersistence.findByPrimaryKey(messageId);
  String flags=message.getFlags();
  if (value && !StringUtil.contains(flags,flagString)) {
    message.setFlags(StringUtil.add(flags,flagString));
  }
 else   if (!value && StringUtil.contains(flags,flagString)) {
    message.setFlags(StringUtil.remove(flags,flagString));
  }
  return messagePersistence.update(message);
}
