{
  RangeQueryBuilder rangeQueryBuilder=QueryBuilders.rangeQuery(dateRangeTermFilter.getField());
  Format format=FastDateFormatFactoryUtil.getSimpleDateFormat(dateRangeTermFilter.getDateFormat(),dateRangeTermFilter.getTimeZone());
  try {
    rangeQueryBuilder.from(format.parseObject(dateRangeTermFilter.getLowerBound()));
    rangeQueryBuilder.includeLower(dateRangeTermFilter.isIncludesLower());
    rangeQueryBuilder.includeUpper(dateRangeTermFilter.isIncludesUpper());
    rangeQueryBuilder.to(format.parseObject(dateRangeTermFilter.getUpperBound()));
  }
 catch (  ParseException e) {
    throw new IllegalArgumentException("Invalid date range " + dateRangeTermFilter,e);
  }
  return rangeQueryBuilder;
}
