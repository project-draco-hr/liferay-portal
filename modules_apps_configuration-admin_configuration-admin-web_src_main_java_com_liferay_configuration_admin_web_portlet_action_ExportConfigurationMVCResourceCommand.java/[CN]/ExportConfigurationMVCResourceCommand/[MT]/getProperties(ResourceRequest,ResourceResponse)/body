{
  Properties properties=new Properties();
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Map<String,ConfigurationModel> configurationModels=_configurationModelRetriever.getConfigurationModels(themeDisplay.getLanguageId());
  String factoryPid=ParamUtil.getString(resourceRequest,"factoryPid");
  String pid=ParamUtil.getString(resourceRequest,"pid",factoryPid);
  ConfigurationModel configurationModel=configurationModels.get(pid);
  if ((configurationModel == null) && Validator.isNotNull(factoryPid)) {
    configurationModel=configurationModels.get(factoryPid);
  }
  if (configurationModel != null) {
    ExtendedAttributeDefinition[] attributeDefinitions=configurationModel.getAttributeDefinitions(ConfigurationModel.ALL);
    for (    AttributeDefinition attributeDefinition : attributeDefinitions) {
      Configuration configuration=configurationModel.getConfiguration();
      String[] values=AttributeDefinitionUtil.getProperty(attributeDefinition,configuration);
      String value=null;
      if (values.length == 1) {
        value=values[0];
      }
 else       if (values.length > 1) {
        value=StringUtil.merge(values,"\n");
      }
      properties.setProperty(attributeDefinition.getID(),value);
    }
  }
  return properties;
}
