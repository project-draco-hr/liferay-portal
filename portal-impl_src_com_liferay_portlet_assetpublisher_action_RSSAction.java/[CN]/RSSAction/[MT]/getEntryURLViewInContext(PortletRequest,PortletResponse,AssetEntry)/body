{
  AssetRendererFactory assetRendererFactory=AssetRendererFactoryRegistryUtil.getAssetRendererFactoryByClassName(assetEntry.getClassName());
  AssetRenderer assetRenderer=assetRendererFactory.getAssetRenderer(assetEntry.getClassPK());
  String viewInContextURL=assetRenderer.getURLViewInContext((LiferayPortletRequest)portletRequest,(LiferayPortletResponse)portletResponse,null);
  StringBundler sb=new StringBundler(2);
  if (!viewInContextURL.startsWith(Http.HTTP_WITH_SLASH) && !viewInContextURL.startsWith(Http.HTTPS_WITH_SLASH)) {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    sb.append(themeDisplay.getPortalURL());
  }
  sb.append(viewInContextURL);
  return sb.toString();
}
