{
  int alphanumericActualMinLength=passwordPolicy.getMinLowerCase() + passwordPolicy.getMinNumbers() + passwordPolicy.getMinUpperCase();
  int alphanumericMinLength=Math.max(passwordPolicy.getMinAlphanumeric(),alphanumericActualMinLength);
  int passwordMinLength=Math.max(passwordPolicy.getMinLength(),alphanumericMinLength + passwordPolicy.getMinSymbols());
  StringBundler sb=new StringBundler(passwordMinLength);
  if (passwordPolicy.getMinLowerCase() > 0) {
    sb.append(getRandomString(passwordPolicy.getMinLowerCase(),_lowerCaseCharsetArray));
  }
  if (passwordPolicy.getMinNumbers() > 0) {
    sb.append(getRandomString(passwordPolicy.getMinNumbers(),_numbersCharsetArray));
  }
  if (passwordPolicy.getMinSymbols() > 0) {
    sb.append(getRandomString(passwordPolicy.getMinSymbols(),_symbolsCharsetArray));
  }
  if (passwordPolicy.getMinUpperCase() > 0) {
    sb.append(getRandomString(passwordPolicy.getMinUpperCase(),_upperCaseCharsetArray));
  }
  if (alphanumericMinLength > alphanumericActualMinLength) {
    int count=alphanumericMinLength - alphanumericActualMinLength;
    sb.append(getRandomString(count,_alphanumericCharsetArray));
  }
  if (passwordMinLength > (alphanumericMinLength + passwordPolicy.getMinSymbols())) {
    int count=passwordMinLength - (alphanumericMinLength + passwordPolicy.getMinSymbols());
    sb.append(PwdGenerator.getSecurePassword(_completeCharset,count));
  }
  if (sb.length() == 0) {
    int count=PropsValues.PASSWORDS_DEFAULT_POLICY_MIN_LENGTH;
    sb.append(PwdGenerator.getPassword(_completeCharset,count));
  }
  Randomizer randomizer=Randomizer.getInstance();
  return randomizer.randomize(sb.toString());
}
