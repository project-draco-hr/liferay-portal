{
  if (name.equals(HttpHeaders.EXPIRES) && Validator.isNumber(value)) {
    int seconds=GetterUtil.getInteger(value);
    Calendar cal=new GregorianCalendar();
    cal.add(Calendar.SECOND,seconds);
    value=_dateFormat.format(cal.getTime());
  }
  boolean addHeader=true;
  if (StringUtil.equalsIgnoreCase(name,HttpHeaders.CACHE_CONTROL) || StringUtil.equalsIgnoreCase(name,HttpHeaders.EXPIRES)) {
    HttpSession session=request.getSession(false);
    if ((session == null) || session.isNew()) {
      String contextPath=request.getContextPath();
      if (StringUtil.equalsIgnoreCase(name,HttpHeaders.EXPIRES)) {
        addHeader=false;
      }
 else       if (PropsValues.WEB_SERVER_PROXY_LEGACY_MODE && contextPath.equals(PortalUtil.getPathContext())) {
        addHeader=false;
      }
    }
  }
  if (addHeader) {
    response.addHeader(name,value);
  }
}
