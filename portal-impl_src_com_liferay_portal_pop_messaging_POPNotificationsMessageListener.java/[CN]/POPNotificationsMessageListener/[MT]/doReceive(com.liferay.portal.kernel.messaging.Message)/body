{
  try {
    initInboxFolder();
    Message[] messages=_inboxFolder.getMessages();
    if (ArrayUtil.isEmpty(messages)) {
      return;
    }
    try {
      notifyMessageListeners(messages);
    }
  finally {
      if (_log.isDebugEnabled()) {
        _log.debug("Deleting messages");
      }
      _inboxFolder.setFlags(messages,new Flags(Flags.Flag.DELETED),true);
      _inboxFolder.close(true);
      _store.close();
    }
  }
  finally {
    _store=null;
    _inboxFolder=null;
  }
}
