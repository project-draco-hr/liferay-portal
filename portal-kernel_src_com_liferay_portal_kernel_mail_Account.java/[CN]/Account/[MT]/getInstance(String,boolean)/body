{
  Account account=null;
  if (protocol.equals(Account.IMAP_PROTOCOL) || protocol.equals(Account.IMAPS_PROTOCOL)) {
    account=new IMAPAccount(protocol,useSSL);
  }
 else   if (protocol.equals(Account.POP3_PROTOCOL) || protocol.equals(Account.POP3S_PROTOCOL)) {
    account=new POP3Account(protocol,useSSL);
  }
 else   if (protocol.equals(Account.SMTP_PROTOCOL) || protocol.equals(Account.SMTPS_PROTOCOL)) {
    account=new SMTPAccount(protocol,useSSL);
  }
 else {
    throw new IllegalArgumentException("Mail protocol not recognized: " + protocol);
  }
  return account;
}
