{
  boolean exportTheme=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME);
  if (_log.isDebugEnabled()) {
    _log.debug("Export theme " + exportTheme);
  }
  if (exportTheme && !portletDataContext.isPerformDirectBinaryImport() && !layout.isInheritLookAndFeel()) {
    Theme theme=layout.getTheme();
    StringBundler sb=new StringBundler(6);
    ZipWriter zipWriter=portletDataContext.getZipWriter();
    sb.append(zipWriter.getPath());
    sb.append(StringPool.SLASH);
    sb.append("theme");
    sb.append(StringPool.DASH);
    sb.append(String.valueOf(layout.getLayoutId()));
    sb.append(".zip");
    File themeZipFile=new File(sb.toString());
    exportTheme(theme,themeZipFile);
  }
}
