{
  boolean exportTheme=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME);
  boolean exportThemeSettings=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME_REFERENCE);
  if (_log.isDebugEnabled()) {
    _log.debug("Export theme " + exportTheme);
    _log.debug("Export theme settings " + exportThemeSettings);
  }
  Element exportDataRootElement=portletDataContext.getExportDataRootElement();
  Element headerElement=exportDataRootElement.element("header");
  if (exportTheme || exportThemeSettings) {
    headerElement.addAttribute("theme-id",theme.getThemeId());
    headerElement.addAttribute("color-scheme-id",colorSchemeId);
  }
  if (exportTheme && !portletDataContext.isPerformDirectBinaryImport()) {
    ZipWriter zipWriter=portletDataContext.getZipWriter();
    File themeZipFile=new File(zipWriter.getPath() + "/theme.zip");
    exportTheme(theme,themeZipFile);
  }
  Element cssElement=headerElement.addElement("css");
  cssElement.addCDATA(css);
}
