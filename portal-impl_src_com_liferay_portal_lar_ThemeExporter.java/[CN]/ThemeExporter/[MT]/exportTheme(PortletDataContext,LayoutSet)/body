{
  boolean exportTheme=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME);
  boolean exportThemeSettings=MapUtil.getBoolean(portletDataContext.getParameterMap(),PortletDataHandlerKeys.THEME_REFERENCE);
  if (_log.isDebugEnabled()) {
    _log.debug("Export theme " + exportTheme);
    _log.debug("Export theme settings " + exportThemeSettings);
  }
  Element exportDataRootElement=portletDataContext.getExportDataRootElement();
  Element headerElement=exportDataRootElement.element("header");
  if (exportTheme || exportThemeSettings) {
    headerElement.addAttribute("theme-id",layoutSet.getThemeId());
    headerElement.addAttribute("color-scheme-id",layoutSet.getColorSchemeId());
  }
  if (exportTheme && !portletDataContext.isPerformDirectBinaryImport()) {
    Theme theme=layoutSet.getTheme();
    ZipWriter zipWriter=portletDataContext.getZipWriter();
    File themeZip=new File(zipWriter.getPath() + "/theme.zip");
    exportTheme(theme,themeZip);
  }
  Element cssElement=headerElement.addElement("css");
  cssElement.addCDATA(layoutSet.getCss());
}
