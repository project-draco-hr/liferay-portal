{
  ActionableDynamicQuery actionableDynamicQuery=trashEntryLocalService.getActionableDynamicQuery();
  actionableDynamicQuery.setPerformActionMethod(new ActionableDynamicQuery.PerformActionMethod(){
    @Override public void performAction(    Object object) throws PortalException {
      TrashEntry trashEntry=(TrashEntry)object;
      Date createDate=trashEntry.getCreateDate();
      Group group=groupPersistence.fetchByPrimaryKey(trashEntry.getGroupId());
      Date date=getMaxAge(group);
      if (createDate.before(date) || !TrashUtil.isTrashEnabled(group)) {
        TrashHandler trashHandler=TrashHandlerRegistryUtil.getTrashHandler(trashEntry.getClassName());
        trashHandler.deleteTrashEntry(trashEntry.getClassPK());
      }
    }
  }
);
  actionableDynamicQuery.setTransactionAttribute(BaseActionableDynamicQuery.REQUIRES_NEW_TRANSACTION_ATTRIBUTE);
  actionableDynamicQuery.performActions();
}
