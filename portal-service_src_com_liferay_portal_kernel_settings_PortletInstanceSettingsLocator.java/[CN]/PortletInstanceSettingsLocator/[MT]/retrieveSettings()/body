{
  long companyId=getCompanyId(_layout.getGroupId());
  Settings portalPropertiesSettings=_settingsLocatorHelper.getPortalPropertiesSettings();
  Settings configurationBeanSettings=_settingsLocatorHelper.getConfigurationBeanSettings(_portletId,portalPropertiesSettings);
  Settings portalPreferencesSettings=_settingsLocatorHelper.getPortalPreferencesSettings(companyId,configurationBeanSettings);
  Settings companyPortletPreferencesSettings=_settingsLocatorHelper.getCompanyPortletPreferencesSettings(companyId,_portletId,portalPreferencesSettings);
  Settings groupPortletPreferencesSettings=_settingsLocatorHelper.getGroupPortletPreferencesSettings(_layout.getGroupId(),_portletId,companyPortletPreferencesSettings);
  return _settingsLocatorHelper.getPortletInstancePortletPreferencesSettings(_layout,_portletId,groupPortletPreferencesSettings);
}
