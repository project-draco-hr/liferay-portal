{
  return new Statement(){
    @Override public void evaluate() throws Throwable {
      String methodName=description.getMethodName();
      Level level=Log4JLoggerTestUtil.setLoggerLevel(Table.class.getName(),Level.WARN);
      if (methodName == null) {
        try {
          if (ResetDatabaseUtil.initialize()) {
            backupDLStores(true);
            backupSearchIndices(true);
          }
 else {
            restoreDLStores(true);
            restoreSearchIndices(true);
          }
        }
  finally {
          Log4JLoggerTestUtil.setLoggerLevel(Table.class.getName(),level);
        }
      }
 else {
        ResetDatabaseUtil.startRecording();
        backupDLStores(false);
        backupSearchIndices(false);
      }
      try {
        statement.evaluate();
      }
  finally {
        if (methodName != null) {
          restoreDLStores(false);
          restoreSearchIndices(false);
          ResetDatabaseUtil.resetModifiedTables();
          Log4JLoggerTestUtil.setLoggerLevel(Table.class.getName(),level);
          CacheRegistryUtil.clear();
          SingleVMPoolUtil.clear();
          MultiVMPoolUtil.clear();
          ThreadLocalCacheManager.clearAll(Lifecycle.REQUEST);
        }
      }
    }
  }
;
}
