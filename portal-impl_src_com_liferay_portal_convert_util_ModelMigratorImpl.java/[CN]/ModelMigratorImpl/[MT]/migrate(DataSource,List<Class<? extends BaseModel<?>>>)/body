{
  Dialect dialect=DialectDetector.getDialect(dataSource);
  Connection connection=dataSource.getConnection();
  try {
    if (_log.isDebugEnabled()) {
      _log.debug("Migrating database tables");
    }
    for (    Class<? extends BaseModel<?>> model : models) {
      Map<String,Tuple> modelTableDetails=getModelTableDetails(model);
      MaintenanceUtil.appendStatus("Processing " + modelTableDetails.size() + " models");
      migrateModel(modelTableDetails,DBManagerUtil.getDB(dialect,dataSource),connection);
    }
  }
  finally {
    DataAccess.cleanUp(connection);
  }
}
