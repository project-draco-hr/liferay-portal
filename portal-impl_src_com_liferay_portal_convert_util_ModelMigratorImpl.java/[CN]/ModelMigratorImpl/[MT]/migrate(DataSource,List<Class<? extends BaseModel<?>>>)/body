{
  Dialect dialect=DialectDetector.getDialect(dataSource);
  Connection connection=dataSource.getConnection();
  try {
    if (_log.isDebugEnabled()) {
      _log.debug("Migrating database tables");
    }
    int i=0;
    for (    Class<? extends BaseModel<?>> model : models) {
      Map<String,Tuple> modelTableDetails=getModelTableDetails(model);
      if ((i > 0) && (i % (models.size() / 4.0) == 0)) {
        MaintenanceUtil.appendStatus((i * 100 / modelTableDetails.size()) + "%");
      }
      migrateModel(modelTableDetails,DBManagerUtil.getDB(dialect,dataSource),connection);
      i++;
    }
  }
  finally {
    DataAccess.cleanUp(connection);
  }
}
