{
  Dialect dialect=DialectDetector.getDialect(dataSource);
  Connection connection=dataSource.getConnection();
  try {
    if (_log.isDebugEnabled()) {
      _log.debug("Migrating database tables");
    }
    Map<String,Tuple> modelTableDetails=new HashMap<>();
    for (    Class<? extends BaseModel<?>> model : models) {
      modelTableDetails.putAll(getModelTableDetails(model));
    }
    MaintenanceUtil.appendStatus("Processing " + modelTableDetails.size() + " models");
    migrateModel(modelTableDetails,DBManagerUtil.getDB(dialect,dataSource),connection);
  }
  finally {
    DataAccess.cleanUp(connection);
  }
}
