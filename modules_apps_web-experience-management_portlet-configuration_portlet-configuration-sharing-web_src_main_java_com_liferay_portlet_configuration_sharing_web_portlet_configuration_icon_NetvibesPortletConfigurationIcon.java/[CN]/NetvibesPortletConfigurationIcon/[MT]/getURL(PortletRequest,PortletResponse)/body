{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    LiferayPortletURL portletURL=PortletURLFactoryUtil.create(portletRequest,PortletConfigurationSharingPortletKeys.PORTLET_CONFIGURATION_SHARING,themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    portletURL.setParameter("netvibesURL",getWidgetURL(portletRequest));
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    return portletURL.toString();
  }
 catch (  Exception e) {
    _log.error(e,e);
    return StringPool.BLANK;
  }
}
