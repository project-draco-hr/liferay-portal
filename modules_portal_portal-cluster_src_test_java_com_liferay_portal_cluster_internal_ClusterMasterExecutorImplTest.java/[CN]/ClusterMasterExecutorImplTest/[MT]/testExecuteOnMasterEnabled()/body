{
  ClusterMasterExecutorImpl clusterMasterExecutorImpl=createMasterExecutorImpl(true);
  MockClusterExecutor mockClusterExecutor=new MockClusterExecutor(true);
  clusterMasterExecutorImpl.setClusterExecutor(mockClusterExecutor);
  clusterMasterExecutorImpl.activate();
  Assert.assertTrue(clusterMasterExecutorImpl.isEnabled());
  String timeString=String.valueOf(System.currentTimeMillis());
  NoticeableFuture<String> noticeableFuture=clusterMasterExecutorImpl.executeOnMaster(new MethodHandler(_TEST_METHOD,timeString));
  Assert.assertSame(timeString,noticeableFuture.get());
  try {
    clusterMasterExecutorImpl.executeOnMaster(_BAD_METHOD_HANDLER);
    Assert.fail();
  }
 catch (  SystemException se) {
    Assert.assertEquals("Unable to execute on master " + mockClusterExecutor.getLocalClusterNodeId(),se.getMessage());
  }
}
