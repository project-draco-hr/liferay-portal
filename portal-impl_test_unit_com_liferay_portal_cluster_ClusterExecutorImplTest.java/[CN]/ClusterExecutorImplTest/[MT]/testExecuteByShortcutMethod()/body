{
  BaseReceiverAdvice.reset(1);
  ClusterExecutorImpl clusterExecutorImpl=getClusterExecutorImpl();
  try {
    Channel channel=clusterExecutorImpl.getControlChannel();
    Object object=BaseReceiverAdvice.getJGroupsMessagePayload(channel.getReceiver(),channel.getAddress());
    ClusterRequest clusterRequest=(ClusterRequest)object;
    Assert.assertEquals(clusterExecutorImpl.getLocalClusterNode(),clusterRequest.getPayload());
    String timestamp=String.valueOf(System.currentTimeMillis());
    ClusterNode clusterNode=clusterExecutorImpl.getLocalClusterNode();
    String clusterNodeId=clusterNode.getClusterNodeId();
    clusterRequest=ClusterRequest.createUnicastRequest(new MethodHandler(testMethod1MethodKey,timestamp),clusterNodeId);
    FutureClusterResponses futureClusterResponses=clusterExecutorImpl.execute(clusterRequest);
    assertFutureClusterResponsesWithoutException(futureClusterResponses.get(),clusterRequest.getUuid(),timestamp,Collections.singletonList(clusterNodeId));
  }
  finally {
    clusterExecutorImpl.destroy();
  }
}
