{
  ClusterExecutorImpl clusterExecutorImpl=getClusterExecutorImpl();
  try {
    String timestamp=String.valueOf(System.currentTimeMillis());
    MethodHandler methodHandler=new MethodHandler(testMethod1MethodKey,timestamp);
    ClusterNode clusterNode=clusterExecutorImpl.getLocalClusterNode();
    String clusterNodeId=clusterNode.getClusterNodeId();
    ClusterRequest clusterRequest=ClusterRequest.createMulticastRequest(methodHandler,false);
    FutureClusterResponses futureClusterResponses=clusterExecutorImpl.execute(clusterRequest);
    ClusterNodeResponses clusterNodeResponses=futureClusterResponses.get();
    ClusterNodeResponse clusterNodeResponse=clusterNodeResponses.getClusterResponse(clusterNodeId);
    Assert.assertNotNull(clusterNodeResponse);
    Assert.assertEquals(timestamp,clusterNodeResponse.getResult());
    timestamp=String.valueOf(System.currentTimeMillis());
    methodHandler=new MethodHandler(testMethod1MethodKey,timestamp);
    clusterRequest=ClusterRequest.createMulticastRequest(methodHandler,true);
    futureClusterResponses=clusterExecutorImpl.execute(clusterRequest);
    clusterNodeResponses=futureClusterResponses.get();
    clusterNodeResponse=clusterNodeResponses.getClusterResponse(clusterNodeId);
    Assert.assertNull(clusterNodeResponse);
    Assert.assertNotEquals(TestBean.TIMESTAMP,timestamp);
  }
  finally {
    clusterExecutorImpl.destroy();
  }
}
