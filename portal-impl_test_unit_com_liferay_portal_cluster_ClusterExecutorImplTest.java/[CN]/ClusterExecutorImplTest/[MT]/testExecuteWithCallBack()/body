{
  ClusterExecutorImpl clusterExecutorImpl=getClusterExecutorImpl();
  try {
    String timestamp=String.valueOf(System.currentTimeMillis());
    MethodHandler methodHandler=new MethodHandler(testMethod1MethodKey,timestamp);
    ClusterNode clusterNode=clusterExecutorImpl.getLocalClusterNode();
    ClusterRequest clusterRequest=ClusterRequest.createUnicastRequest(methodHandler,clusterNode.getClusterNodeId());
    MockClusterResponseCallback mockClusterResponseCallback=new MockClusterResponseCallback();
    FutureClusterResponses futureClusterResponses=clusterExecutorImpl.execute(clusterRequest,mockClusterResponseCallback);
    BlockingQueue<ClusterNodeResponse> blockingQueue=mockClusterResponseCallback.waitMessage();
    Assert.assertSame(futureClusterResponses.getPartialResults(),blockingQueue);
  }
  finally {
    clusterExecutorImpl.destroy();
  }
}
