{
  ClusterExecutorImpl clusterExecutorImpl=null;
  try {
    clusterExecutorImpl=getClusterExecutorImpl();
    String timestamp=String.valueOf(System.currentTimeMillis());
    MethodHandler methodHandler=new MethodHandler(testMethod1MethodKey,timestamp);
    Address address=clusterExecutorImpl.getLocalClusterNodeAddress();
    ClusterRequest clusterRequest=ClusterRequest.createUnicastRequest(methodHandler,address);
    MockClusterResponseCallback mockClusterResponseCallback=new MockClusterResponseCallback();
    FutureClusterResponses futureClusterResponses=clusterExecutorImpl.execute(clusterRequest,mockClusterResponseCallback);
    BlockingQueue<ClusterNodeResponse> blockingQueue=mockClusterResponseCallback.waitMessage();
    Assert.assertSame(futureClusterResponses.getPartialResults(),blockingQueue);
  }
  finally {
    if (clusterExecutorImpl != null) {
      clusterExecutorImpl.destroy();
    }
  }
}
