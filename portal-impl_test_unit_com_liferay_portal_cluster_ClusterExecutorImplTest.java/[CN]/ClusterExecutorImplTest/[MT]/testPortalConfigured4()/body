{
  ClusterExecutorImpl clusterExecutorImpl=null;
  try {
    clusterExecutorImpl=getClusterExecutorImpl(false,false);
    ClusterNode clusterNode=clusterExecutorImpl.getLocalClusterNode();
    Assert.assertEquals(-1,clusterNode.getPort());
    Assert.assertEquals(null,clusterNode.getPortalAddress());
    Field portalAddressField=ReflectionUtil.getDeclaredField(ClusterExecutorImpl.class,"_portalAddress");
    Field portalPortField=ReflectionUtil.getDeclaredField(ClusterExecutorImpl.class,"_port");
    portalAddressField.set(clusterExecutorImpl,InetAddress.getLocalHost());
    clusterExecutorImpl.portalLocalAddressConfigured(InetAddress.getByName(SetPortalAddressAdvice.SECURE_PORTAL_ADDRESS),SetPortalAddressAdvice.SECURE_PORTAL_PORT);
    Assert.assertEquals(SetPortalAddressAdvice.SECURE_PORTAL_PORT,clusterNode.getPort());
    Assert.assertEquals(InetAddress.getByName(SetPortalAddressAdvice.SECURE_PORTAL_ADDRESS),clusterNode.getPortalAddress());
    portalAddressField.set(clusterExecutorImpl,null);
    portalPortField.set(clusterExecutorImpl,80);
    clusterExecutorImpl.portalLocalAddressConfigured(InetAddress.getByName(SetPortalAddressAdvice.SECURE_PORTAL_ADDRESS),SetPortalAddressAdvice.SECURE_PORTAL_PORT);
    Assert.assertEquals(SetPortalAddressAdvice.SECURE_PORTAL_PORT,clusterNode.getPort());
    Assert.assertEquals(InetAddress.getByName(SetPortalAddressAdvice.SECURE_PORTAL_ADDRESS),clusterNode.getPortalAddress());
  }
  finally {
    if (clusterExecutorImpl != null) {
      clusterExecutorImpl.destroy();
    }
  }
}
