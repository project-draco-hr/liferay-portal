{
  ClusterExecutorImpl clusterExecutorImpl=null;
  try {
    clusterExecutorImpl=getClusterExecutorImpl(false,false);
    Field field=ReflectionUtil.getDeclaredField(ClusterExecutorImpl.class,"_clusterEventListeners");
    CopyOnWriteArrayList<ClusterEventListener> listeners=(CopyOnWriteArrayList<ClusterEventListener>)field.get(clusterExecutorImpl);
    MockClusterEventListener mockClusterEventListener=new MockClusterEventListener();
    listeners.add(mockClusterEventListener);
    Assert.assertEquals(1,listeners.size());
    clusterExecutorImpl.addClusterEventListener(new MockClusterEventListener());
    Assert.assertEquals(1,listeners.size());
    clusterExecutorImpl.removeClusterEventListener(mockClusterEventListener);
    Assert.assertEquals(1,listeners.size());
    List<ClusterEventListener> clusterEventListeners=clusterExecutorImpl.getClusterEventListeners();
    Assert.assertTrue(clusterEventListeners.isEmpty());
    clusterEventListeners=new ArrayList<ClusterEventListener>();
    clusterEventListeners.add(new MockClusterEventListener());
    clusterExecutorImpl.setClusterEventListeners(clusterEventListeners);
    Assert.assertEquals(1,listeners.size());
  }
  finally {
    if (clusterExecutorImpl != null) {
      clusterExecutorImpl.destroy();
    }
  }
}
