{
  ClusterExecutorImpl clusterExecutorImpl1=getClusterExecutorImpl();
  MockClusterEventListener mockClusterEventListener=new MockClusterEventListener();
  clusterExecutorImpl1.addClusterEventListener(mockClusterEventListener);
  ClusterExecutorImpl clusterExecutorImpl2=getClusterExecutorImpl();
  ClusterNode clusterNode=clusterExecutorImpl2.getLocalClusterNode();
  assertClusterEvent(mockClusterEventListener.waitJoinMessage(),ClusterEventType.JOIN,clusterNode);
  try {
    ClusterNode clusterNode1=clusterExecutorImpl1.getLocalClusterNode();
    Assert.assertNotNull(clusterNode1);
    ClusterNode clusterNode2=clusterExecutorImpl2.getLocalClusterNode();
    Assert.assertNotNull(clusterNode2);
    List<ClusterNode> clusterNodes=clusterExecutorImpl1.getClusterNodes();
    Assert.assertEquals(2,clusterNodes.size());
    Assert.assertTrue(clusterNodes.contains(clusterNode1));
    Assert.assertTrue(clusterNodes.contains(clusterNode2));
    Assert.assertTrue(clusterExecutorImpl1.isClusterNodeAlive(clusterNode2.getClusterNodeId()));
  }
  finally {
    clusterExecutorImpl1.destroy();
    clusterExecutorImpl2.destroy();
  }
}
