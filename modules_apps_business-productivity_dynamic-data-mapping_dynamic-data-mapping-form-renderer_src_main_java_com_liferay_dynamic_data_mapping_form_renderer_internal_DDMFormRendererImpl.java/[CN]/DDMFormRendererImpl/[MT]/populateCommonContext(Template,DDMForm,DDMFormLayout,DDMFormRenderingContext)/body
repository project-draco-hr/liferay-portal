{
  String containerId=ddmFormRenderingContext.getContainerId();
  if (Validator.isNull(containerId)) {
    containerId=StringUtil.randomId();
  }
  template.put("containerId",containerId);
  template.put("definition",DDMFormJSONSerializerUtil.serialize(ddmForm));
  DDMFormValues ddmFormValues=ddmFormRenderingContext.getDDMFormValues();
  if (ddmFormValues != null) {
    removeStaleDDMFormFieldValues(ddmForm.getDDMFormFieldsMap(true),ddmFormValues.getDDMFormFieldValues());
  }
  Locale locale=ddmFormRenderingContext.getLocale();
  DDMFormEvaluationResult ddmFormEvaluationResult=_ddmFormEvaluator.evaluate(ddmForm,ddmFormRenderingContext.getDDMFormValues(),locale);
  JSONSerializer jsonSerializer=_jsonFactory.createJSONSerializer();
  template.put("evaluation",jsonSerializer.serializeDeep(ddmFormEvaluationResult));
  List<DDMFormFieldType> ddmFormFieldTypes=_ddmFormFieldTypeServicesTracker.getDDMFormFieldTypes();
  template.put("fieldTypes",_ddmFormFieldTypesJSONSerializer.serialize(ddmFormFieldTypes));
  template.put("layout",DDMFormLayoutJSONSerializerUtil.serialize(ddmFormLayout));
  List<Object> pages=getPages(ddmForm,ddmFormLayout,ddmFormRenderingContext);
  template.put("pages",pages);
  template.put("portletNamespace",ddmFormRenderingContext.getPortletNamespace());
  template.put("readOnly",ddmFormRenderingContext.isReadOnly());
  JSONArray readOnlyFieldsJSONArray=getReadOnlyFieldsJSONArray(ddmForm);
  template.put("readOnlyFields",readOnlyFieldsJSONArray.toString());
  ResourceBundle resourceBundle=getResourceBundle(locale);
  template.put("requiredFieldsWarningMessageHTML",getRequiredFieldsWarningMessageHTML(resourceBundle));
  template.put("showRequiredFieldsWarning",ddmFormRenderingContext.isShowRequiredFieldsWarning());
  boolean showSubmitButton=ddmFormRenderingContext.isShowSubmitButton();
  if (ddmFormRenderingContext.isReadOnly()) {
    showSubmitButton=false;
  }
  template.put("showSubmitButton",showSubmitButton);
  template.put("strings",getLanguageStringsMap(resourceBundle));
  String submitLabel=GetterUtil.getString(ddmFormRenderingContext.getSubmitLabel(),LanguageUtil.get(locale,"submit"));
  template.put("submitLabel",submitLabel);
  template.put("templateNamespace",getTemplateNamespace(ddmFormLayout));
  if (ddmFormValues != null) {
    template.put("values",DDMFormValuesJSONSerializerUtil.serialize(ddmFormValues));
  }
 else {
    template.put("values",JSONFactoryUtil.getNullJSON());
  }
}
