{
  if (!PropsValues.AUTH_TOKEN_CHECK_ENABLED || !_lifecycle.equals(PortletRequest.ACTION_PHASE)) {
    return;
  }
  String strutsAction=getParameter("struts_action");
  if (AuthTokenWhitelistUtil.isPortletCSRFWhitelisted(_portlet.getCompanyId(),_portletId,strutsAction)) {
    return;
  }
  sb.append("p_auth");
  sb.append(StringPool.EQUAL);
  sb.append(processValue(key,AuthTokenUtil.getToken(_request)));
  sb.append(StringPool.AMPERSAND);
}
