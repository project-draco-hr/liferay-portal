{
  String namespace=getNamespace();
  Layout layout=getLayout();
  Map<String,String[]> renderParameters=RenderParametersPool.get(_request,layout.getPlid(),getPortlet().getPortletId());
  if (renderParameters == null) {
    return portletURLParams;
  }
  Map<String,String[]> mergedRenderParams=new LinkedHashMap<>(portletURLParams);
  for (  Map.Entry<String,String[]> entry : renderParameters.entrySet()) {
    String name=entry.getKey();
    if (name.contains(namespace)) {
      name=name.substring(namespace.length());
    }
    if (!_lifecycle.equals(PortletRequest.RESOURCE_PHASE) && (_removedParameterNames != null) && _removedParameterNames.contains(name)) {
      continue;
    }
    String[] oldValues=entry.getValue();
    String[] newValues=_params.get(name);
    if (newValues == null) {
      mergedRenderParams.put(name,oldValues);
    }
 else     if (isBlankValue(newValues)) {
      mergedRenderParams.remove(name);
    }
 else {
      newValues=ArrayUtil.append(newValues,oldValues);
      mergedRenderParams.put(name,newValues);
    }
  }
  return mergedRenderParams;
}
