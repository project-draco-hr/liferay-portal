{
  if (count == 0) {
    return null;
  }
  StringBundler sb=new StringBundler();
  String[] params=url.split(StringPool.AMPERSAND);
  for (int i=0; i < params.length; i++) {
    String param=params[i];
    if (param.contains("_backURL=") || param.contains("_redirect=") || param.contains("_returnToFullPageURL=")) {
      int pos=param.indexOf(StringPool.EQUAL);
      String qName=param.substring(0,pos);
      String redirect=param.substring(pos + 1);
      redirect=HttpUtil.decodeURL(redirect);
      String newURL=shortenURL(redirect,--count);
      if (newURL != null) {
        newURL=HttpUtil.encodeURL(newURL);
        sb.append(qName);
        sb.append(StringPool.EQUAL);
        sb.append(newURL);
        if (i < (params.length - 1)) {
          sb.append(StringPool.AMPERSAND);
        }
      }
    }
 else {
      sb.append(param);
      if (i < (params.length - 1)) {
        sb.append(StringPool.AMPERSAND);
      }
    }
  }
  return sb.toString();
}
