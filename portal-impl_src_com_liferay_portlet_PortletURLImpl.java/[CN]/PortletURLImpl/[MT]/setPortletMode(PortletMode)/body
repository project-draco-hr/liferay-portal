{
  if (_portletRequest != null) {
    Portlet portlet=getPortlet();
    if ((portlet != null) && !portlet.hasPortletMode(_portletRequest.getResponseContentType(),portletMode)) {
      throw new PortletModeException(portletMode.toString(),portletMode);
    }
  }
  _portletModeString=portletMode.toString();
  clearCache();
}
