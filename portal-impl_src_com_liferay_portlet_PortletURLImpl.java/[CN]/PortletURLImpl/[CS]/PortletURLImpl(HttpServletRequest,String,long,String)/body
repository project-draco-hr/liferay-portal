{
  _request=request;
  _portletId=portletId;
  _plid=plid;
  _lifecycle=lifecycle;
  _parametersIncludedInPath=new LinkedHashSet<String>();
  _params=new LinkedHashMap<String,String[]>();
  _removePublicRenderParameters=new LinkedHashMap<String,String[]>();
  _secure=PortalUtil.isSecure(request);
  _wsrp=ParamUtil.getBoolean(request,"wsrp");
  Portlet portlet=getPortlet();
  if (portlet != null) {
    Set<String> autoPropagatedParameters=portlet.getAutoPropagatedParameters();
    for (    String autoPropagatedParameter : autoPropagatedParameters) {
      if (PortalUtil.isReservedParameter(autoPropagatedParameter)) {
        continue;
      }
      String value=ParamUtil.getString(request,autoPropagatedParameter);
      if (Validator.isNotNull(value)) {
        setParameter(autoPropagatedParameter,value);
      }
    }
    PortletApp portletApp=portlet.getPortletApp();
    _escapeXml=MapUtil.getBoolean(portletApp.getContainerRuntimeOptions(),LiferayPortletConfig.RUNTIME_OPTION_ESCAPE_XML,PropsValues.PORTLET_URL_ESCAPE_XML);
  }
}
