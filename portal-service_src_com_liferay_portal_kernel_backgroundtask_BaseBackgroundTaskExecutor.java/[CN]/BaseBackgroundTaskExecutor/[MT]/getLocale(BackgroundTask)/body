{
  Map<String,Serializable> taskContextMap=backgroundTask.getTaskContextMap();
  long userId=MapUtil.getLong(taskContextMap,"userId");
  if (userId > 0) {
    try {
      User user=UserLocalServiceUtil.fetchUser(userId);
      if (user != null) {
        return user.getLocale();
      }
    }
 catch (    Exception e) {
      if (_log.isDebugEnabled()) {
        _log.debug("Non-fatal error retrieving user's locale",e);
      }
    }
  }
  return LocaleUtil.getDefault();
}
