{
  long plid=LayoutLocalServiceUtil.getDefaultPlid(groupId,true);
  if (plid == 0) {
    plid=LayoutLocalServiceUtil.getDefaultPlid(groupId,false);
  }
  if (plid == 0) {
    Layout layout=(Layout)req.getAttribute(WebKeys.LAYOUT);
    if (layout != null) {
      plid=layout.getPlid();
    }
  }
  PortletURL portletURL=new PortletURLImpl(req,portletId,plid,false);
  portletURL.setWindowState(WindowState.MAXIMIZED);
  portletURL.setPortletMode(PortletMode.VIEW);
  return portletURL;
}
