{
  HttpServletRequest request=liferayPortletRequest.getHttpServletRequest();
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Group controlPanelGroup=GroupLocalServiceUtil.getGroup(themeDisplay.getCompanyId(),GroupConstants.CONTROL_PANEL);
  long controlPanelPlid=LayoutLocalServiceUtil.getDefaultPlid(controlPanelGroup.getGroupId(),true);
  PortletURL addAssetURL=null;
  if (CalendarPermission.contains(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.ADD_EVENT)) {
    addAssetURL=new PortletURLImpl(request,PortletKeys.CALENDAR,controlPanelPlid,PortletRequest.RENDER_PHASE);
    addAssetURL.setParameter("struts_action","/calendar/edit_event");
  }
  return addAssetURL;
}
