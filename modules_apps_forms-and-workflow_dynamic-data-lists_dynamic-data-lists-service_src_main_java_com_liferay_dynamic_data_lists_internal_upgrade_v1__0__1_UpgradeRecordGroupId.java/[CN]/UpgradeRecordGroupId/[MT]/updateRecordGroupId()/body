{
  StringBundler sb=new StringBundler(4);
  sb.append("select DDLRecordSet.groupId, DDLRecord.recordId ");
  sb.append("from DDLRecord inner join DDLRecordSet ");
  sb.append("on DDLRecord.recordSetId = DDLRecordSet.recordSetId ");
  sb.append("where DDLRecord.groupId != DDLRecordSet.groupId");
  try (PreparedStatement ps1=connection.prepareStatement(sb.toString());ResultSet rs=ps1.executeQuery();PreparedStatement ps2=AutoBatchPreparedStatementUtil.concurrentAutoBatch(connection,"update DDLRecord set groupId = ? where recordId = ?")){
    while (rs.next()) {
      long groupId=rs.getLong("groupId");
      long recordId=rs.getLong("recordId");
      ps2.setLong(1,groupId);
      ps2.setLong(2,recordId);
      ps2.addBatch();
    }
    ps2.executeBatch();
  }
 }
