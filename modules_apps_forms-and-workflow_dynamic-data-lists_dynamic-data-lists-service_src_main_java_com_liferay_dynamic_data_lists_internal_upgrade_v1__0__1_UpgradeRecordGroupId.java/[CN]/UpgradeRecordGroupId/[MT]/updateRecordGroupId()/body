{
  String sql="SELECT DDLRecordSet.groupId, DDLRecord.recordId " + "FROM DDLRecord INNER JOIN DDLRecordSet " + "ON DDLRecord.recordSetId = DDLRecordSet.recordSetId "+ "WHERE DDLRecord.groupId != DDLRecordSet.groupId;";
  try (PreparedStatement ps1=connection.prepareStatement(sql);ResultSet rs=ps1.executeQuery();PreparedStatement ps2=AutoBatchPreparedStatementUtil.concurrentAutoBatch(connection,"update DDLRecord set groupId = ? where recordId = ?")){
    while (rs.next()) {
      long groupId=rs.getLong("groupId");
      long recordId=rs.getLong("recordId");
      ps2.setLong(1,groupId);
      ps2.setLong(2,recordId);
      ps2.addBatch();
    }
    ps2.executeBatch();
  }
 }
