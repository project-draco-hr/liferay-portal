{
  String requestPassword=ParamUtil.getString(actionRequest,"password0");
  if (Validator.isNotNull(requestPassword)) {
    String newPassword=ParamUtil.getString(actionRequest,"password1");
    if (Validator.isNull(newPassword)) {
      throw new UserPasswordException(UserPasswordException.PASSWORD_LENGTH);
    }
    Company company=PortalUtil.getCompany(actionRequest);
    String authType=company.getAuthType();
    User user=PortalUtil.getSelectedUser(actionRequest);
    String login=null;
    if (authType.equals(CompanyConstants.AUTH_TYPE_EA)) {
      login=user.getEmailAddress();
    }
    if (authType.equals(CompanyConstants.AUTH_TYPE_ID)) {
      login=String.valueOf(user.getUserId());
    }
    if (authType.equals(CompanyConstants.AUTH_TYPE_SN)) {
      login=user.getScreenName();
    }
    boolean validPassword=PwdAuthenticator.authenticate(login,requestPassword,user.getPassword());
    if (!validPassword) {
      throw new UserPasswordException(UserPasswordException.PASSWORD_INVALID);
    }
  }
  return super.updateUser(actionRequest,actionResponse);
}
