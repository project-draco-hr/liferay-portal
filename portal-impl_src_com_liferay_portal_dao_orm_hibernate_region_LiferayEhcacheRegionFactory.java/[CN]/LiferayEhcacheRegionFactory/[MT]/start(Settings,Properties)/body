{
  HibernatePortalCacheManager hibernatePortalCacheManager=new HibernatePortalCacheManager();
  hibernatePortalCacheManager.setClusterAware(true);
  if (properties != null) {
    hibernatePortalCacheManager.setConfigFile((String)properties.get(NET_SF_EHCACHE_CONFIGURATION_RESOURCE_NAME));
  }
  hibernatePortalCacheManager.setDefaultConfigFile(_DEFAULT_CONFIG_FILE);
  hibernatePortalCacheManager.setMpiOnly(true);
  hibernatePortalCacheManager.setName(PortalCacheManagerNames.HIBERNATE);
  boolean skipUpdateCheck=GetterUtil.getBoolean(SystemProperties.get("net.sf.ehcache.skipUpdateCheck"));
  boolean tcActive=GetterUtil.getBoolean(SystemProperties.get("tc.active"));
  hibernatePortalCacheManager.setStopCacheManagerTimer(skipUpdateCheck && !tcActive);
  hibernatePortalCacheManager.afterPropertiesSet();
  manager=hibernatePortalCacheManager.getEhcacheManager();
  mbeanRegistrationHelper.registerMBean(manager,properties);
  _hibernatePortalCacheManager=hibernatePortalCacheManager;
}
