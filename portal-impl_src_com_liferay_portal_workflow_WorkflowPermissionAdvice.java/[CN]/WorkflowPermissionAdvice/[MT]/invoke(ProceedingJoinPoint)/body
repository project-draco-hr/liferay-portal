{
  String methodName=proceedingJoinPoint.getSignature().getName();
  Object[] arguments=proceedingJoinPoint.getArgs();
  if (methodName.equals(_ASSIGN_WORKFLOW_TASK_TO_USER_METHOD_NAME)) {
    long userId=(Long)arguments[0];
    PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
    if (permissionChecker.getUserId() != userId) {
      throw new PrincipalException();
    }
    PortletPermissionUtil.check(permissionChecker,PortletKeys.WORKFLOW_TASKS,ActionKeys.ASSIGN_USER_TASKS);
  }
  return proceedingJoinPoint.proceed();
}
