{
  for (int i=1; i < classes.length; i++) {
    Class<?> callerClass=classes[i];
    if (callerClass == null) {
      break;
    }
    if ((callerClass == PACLAdvice.class) || (callerClass == PACLDataSource.class) || (callerClass == PACLBeanHandler.class)|| (callerClass == PortalSecurityManager.class)) {
      continue;
    }
    if (debug) {
      _log.debug("Frame " + i + " has caller class "+ callerClass.getName());
    }
    ClassLoader callerClassLoader=_getCallerClassLoader(callerClass);
    if ((callerClassLoader == null) || (callerClassLoader == _commonClassLoader) || (callerClassLoader == _systemClassLoader)|| isAncestor(_portalClassLoader,callerClassLoader)) {
      continue;
    }
    PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(callerClassLoader);
    if (paclPolicy != null) {
      return paclPolicy;
    }
  }
  return PACLPolicyManager.getDefaultPACLPolicy();
}
