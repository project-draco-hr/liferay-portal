{
  ClassLoader foreignClassLoader=getForeignClassLoader(Thread.currentThread().getContextClassLoader());
  if (foreignClassLoader == null) {
    for (int i=(classes.length - 1); i >= 0; i--) {
      Class<?> clazz=classes[i];
      ClassLoader classLoader=clazz.getClassLoader();
      foreignClassLoader=getForeignClassLoader(classLoader);
      if (foreignClassLoader != null) {
        break;
      }
    }
  }
  if (foreignClassLoader == null) {
    return null;
  }
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(foreignClassLoader);
  if (paclPolicy != null) {
    return paclPolicy;
  }
  return null;
}
