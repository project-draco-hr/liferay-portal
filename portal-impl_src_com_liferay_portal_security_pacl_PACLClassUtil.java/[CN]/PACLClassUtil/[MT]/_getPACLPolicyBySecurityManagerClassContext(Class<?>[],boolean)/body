{
  ClassLoader foreignClassLoader=null;
  for (int i=(classes.length - 1); i >= 0; i--) {
    Class<?> clazz=classes[i];
    ClassLoader classLoader=clazz.getClassLoader();
    foreignClassLoader=getForeignClassLoader(classLoader);
    if (foreignClassLoader != null) {
      break;
    }
  }
  if (foreignClassLoader == null) {
    return PACLPolicyManager.getDefaultPACLPolicy();
  }
  PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(foreignClassLoader);
  if (paclPolicy != null) {
    return paclPolicy;
  }
  return PACLPolicyManager.getDefaultPACLPolicy();
}
