{
  ClassLoader callerClassLoader=callerClass.getClassLoader();
  if (callerClassLoader == null) {
    return null;
  }
  Class<?> callerClassLoaderClass=callerClassLoader.getClass();
  String callerClassLoaderClassName=callerClassLoaderClass.getName();
  if (callerClassLoader instanceof FilterClassLoader) {
    callerClassLoader=callerClassLoader.getParent();
    if (callerClassLoader instanceof AggregateClassLoader) {
      callerClassLoader=callerClassLoader.getParent();
    }
  }
  if (callerClassLoaderClassName.equals(_ClASS_NAME_JASPER_LOADER)) {
    callerClassLoader=callerClassLoader.getParent();
  }
 else   if (ServerDetector.isResin()) {
    if (callerClassLoaderClassName.equals(_ClASS_NAME_DYNAMIC_CLASS_LOADER)) {
      callerClassLoader=callerClassLoader.getParent();
    }
  }
 else   if (ServerDetector.isWebLogic()) {
    if (callerClassLoaderClassName.equals(_CLASS_NAME_JSP_CLASS_LOADER)) {
      callerClassLoader=callerClassLoader.getParent();
      callerClassLoader=callerClassLoader.getParent();
    }
  }
 else   if (ServerDetector.isWebSphere()) {
    if (callerClassLoaderClassName.equals(_CLASS_NAME_JSP_EXTENSION_CLASS_LOADER)) {
      callerClassLoader=callerClassLoader.getParent();
    }
  }
  return callerClassLoader;
}
