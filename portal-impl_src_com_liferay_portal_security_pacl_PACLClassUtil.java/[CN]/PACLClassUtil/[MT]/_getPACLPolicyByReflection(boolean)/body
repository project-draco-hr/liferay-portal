{
  for (int i=3; ; i++) {
    Class<?> callerClass=Reflection.getCallerClass(i);
    if (callerClass == null) {
      break;
    }
    if (_isSkipCallerClass(callerClass,i,debug)) {
      continue;
    }
    ClassLoader callerClassLoader=_getCallerClassLoader(callerClass);
    if (_isSkipCallerClassLoader(callerClassLoader)) {
      continue;
    }
    PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(callerClassLoader);
    if (paclPolicy != null) {
      return paclPolicy;
    }
  }
  return PACLPolicyManager.getDefaultPACLPolicy();
}
