{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long membershipRequestId=ParamUtil.getLong(actionRequest,"membershipRequestId");
  long statusId=ParamUtil.getLong(actionRequest,"statusId");
  String replyComments=ParamUtil.getString(actionRequest,"replyComments");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(actionRequest);
  MembershipRequestServiceUtil.updateStatus(membershipRequestId,replyComments,statusId,serviceContext);
  if (statusId == MembershipRequestConstants.STATUS_APPROVED) {
    MembershipRequest membershipRequest=MembershipRequestServiceUtil.getMembershipRequest(membershipRequestId);
    LiveUsers.joinGroup(themeDisplay.getCompanyId(),membershipRequest.getGroupId(),new long[]{membershipRequest.getUserId()});
  }
  SessionMessages.add(actionRequest,"membershipReplySent");
  sendRedirect(actionRequest,actionResponse);
}
