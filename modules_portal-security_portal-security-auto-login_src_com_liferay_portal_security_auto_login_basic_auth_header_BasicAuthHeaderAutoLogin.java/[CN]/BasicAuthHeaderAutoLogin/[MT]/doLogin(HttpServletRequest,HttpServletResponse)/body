{
  long companyId=PortalUtil.getCompanyId(request);
  if (!isEnabled(companyId)) {
    return null;
  }
  HttpAuthorizationHeader httpAuthorizationHeader=HttpAuthManagerUtil.parse(request);
  String scheme=httpAuthorizationHeader.getScheme();
  if (!StringUtil.equalsIgnoreCase(scheme,HttpAuthorizationHeader.SCHEME_BASIC)) {
    return null;
  }
  String login=httpAuthorizationHeader.getAuthParameter(HttpAuthorizationHeader.AUTHPARAM_USERID);
  String password=httpAuthorizationHeader.getAuthParameter(HttpAuthorizationHeader.AUTHPARAM_PASSWORD);
  long userId=AuthenticatedSessionManagerUtil.getAuthenticatedUserId(request,login,password,null);
  String[] credentials=new String[3];
  credentials[0]=String.valueOf(userId);
  credentials[1]=password;
  credentials[2]=Boolean.TRUE.toString();
  return credentials;
}
