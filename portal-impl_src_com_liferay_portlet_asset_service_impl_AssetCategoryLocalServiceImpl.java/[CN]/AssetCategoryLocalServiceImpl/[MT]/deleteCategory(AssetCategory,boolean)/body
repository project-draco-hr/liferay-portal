{
  List<AssetCategory> categories=assetCategoryPersistence.findByParentCategoryId(category.getCategoryId());
  for (  AssetCategory curCategory : categories) {
    deleteCategory(curCategory,true);
  }
  if (!categories.isEmpty() && !childCategory) {
    final long groupId=category.getGroupId();
    TransactionCommitCallbackRegistryUtil.registerCallback(new Callable<Void>(){
      @Override public Void call() throws Exception {
        assetCategoryLocalService.rebuildTree(groupId,true);
        return null;
      }
    }
);
  }
  assetCategoryPersistence.remove(category);
  resourceLocalService.deleteResource(category.getCompanyId(),AssetCategory.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,category.getCategoryId());
  List<AssetEntry> entries=assetCategoryPersistence.getAssetEntries(category.getCategoryId());
  assetCategoryPropertyLocalService.deleteCategoryProperties(category.getCategoryId());
  assetEntryLocalService.reindex(entries);
  return category;
}
