{
  SearchContext searchContext=SearchContextTestUtil.getSearchContext(_group.getGroupId());
  assertSearchCount(0,_group.getGroupId(),searchContext);
  JournalFolder folder=JournalTestUtil.addFolder(_group.getGroupId(),RandomTestUtil.randomString());
  String content="Liferay Architectural Approach";
  JournalArticle article=JournalTestUtil.addArticleWithWorkflow(_group.getGroupId(),folder.getFolderId(),"title",content,true);
  assertSearchCount(1,_group.getGroupId(),searchContext);
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId());
  serviceContext.setWorkflowAction(WorkflowConstants.ACTION_PUBLISH);
  article=JournalTestUtil.updateArticle(article,article.getTitleMap(),article.getContent(),false,true,serviceContext);
  assertSearchCount(2,_group.getGroupId(),false,WorkflowConstants.STATUS_ANY,searchContext);
  if (delete) {
    if (all) {
      JournalArticleLocalServiceUtil.deleteArticle(_group.getGroupId(),article.getArticleId(),serviceContext);
      assertSearchCount(0,_group.getGroupId(),false,WorkflowConstants.STATUS_ANY,searchContext);
    }
 else {
      JournalArticleLocalServiceUtil.deleteArticle(article);
      assertSearchCount(1,_group.getGroupId(),false,WorkflowConstants.STATUS_ANY,searchContext);
    }
  }
 else {
    if (all) {
      JournalArticleLocalServiceUtil.expireArticle(TestPropsValues.getUserId(),_group.getGroupId(),article.getArticleId(),article.getUrlTitle(),serviceContext);
    }
 else {
      JournalArticleLocalServiceUtil.expireArticle(TestPropsValues.getUserId(),_group.getGroupId(),article.getArticleId(),article.getVersion(),article.getUrlTitle(),serviceContext);
    }
    assertSearchCount(2,_group.getGroupId(),false,WorkflowConstants.STATUS_ANY,searchContext);
  }
}
