{
  T service=null;
  try {
    if (_serviceTrackerCustomizer != null) {
      service=_serviceTrackerCustomizer.addingService(serviceReference);
    }
 else {
      service=(T)BasicRegistryImpl.this.getService(serviceReference);
    }
    if (service == null) {
      return null;
    }
    _tracked.put(serviceReference,service);
    return service;
  }
  finally {
    if (service != null) {
      _stateCounter.incrementAndGet();
      _countDownLatch.countDown();
    }
  }
}
