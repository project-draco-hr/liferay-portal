{
  Authenticator[] authenticators=_authenticators.get(key);
  boolean skipLiferayCheck=false;
  if ((authenticators == null) || (authenticators.length == 0)) {
    return Authenticator.SUCCESS;
  }
  for (  Authenticator authenticator : authenticators) {
    try {
      int authResult=Authenticator.FAILURE;
      if (authType.equals(CompanyConstants.AUTH_TYPE_EA)) {
        authResult=authenticator.authenticateByEmailAddress(companyId,login,password,headerMap,parameterMap);
      }
 else       if (authType.equals(CompanyConstants.AUTH_TYPE_SN)) {
        authResult=authenticator.authenticateByScreenName(companyId,login,password,headerMap,parameterMap);
      }
 else       if (authType.equals(CompanyConstants.AUTH_TYPE_ID)) {
        long userId=GetterUtil.getLong(login);
        authResult=authenticator.authenticateByUserId(companyId,userId,password,headerMap,parameterMap);
      }
      if (authResult == Authenticator.SKIP_LIFERAY_CHECK) {
        skipLiferayCheck=true;
      }
 else       if (authResult != Authenticator.SUCCESS) {
        return authResult;
      }
    }
 catch (    AuthException ae) {
      throw ae;
    }
catch (    Exception e) {
      throw new AuthException(e);
    }
  }
  if (skipLiferayCheck) {
    return Authenticator.SKIP_LIFERAY_CHECK;
  }
 else {
    return Authenticator.SUCCESS;
  }
}
