{
  boolean active=_showOpen;
  PanelAppRegistry panelAppRegistry=(PanelAppRegistry)request.getAttribute(ApplicationListWebKeys.PANEL_APP_REGISTRY);
  PanelCategoryRegistry panelCategoryRegistry=(PanelCategoryRegistry)request.getAttribute(ApplicationListWebKeys.PANEL_CATEGORY_REGISTRY);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  List<PanelApp> panelApps=panelAppRegistry.getPanelApps(_panelCategory,themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroup());
  PanelCategoryHelper panelCategoryHelper=new PanelCategoryHelper(panelAppRegistry,panelCategoryRegistry);
  if (!_showOpen && !panelApps.isEmpty()) {
    active=panelCategoryHelper.containsPortlet(themeDisplay.getPpid(),_panelCategory);
  }
  request.setAttribute("liferay-application-list:panel-category:active",active);
  String id=StringUtil.replace(_panelCategory.getKey(),StringPool.PERIOD,StringPool.UNDERLINE);
  id="panel-manage-" + id;
  request.setAttribute("liferay-application-list:panel-category:id",id);
  request.setAttribute("liferay-application-list:panel-category:panelApps",panelApps);
  request.setAttribute("liferay-application-list:panel-category:panelCategory",_panelCategory);
  int notificationsCount=panelCategoryHelper.getNotificationsCount(_panelCategory.getKey(),themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroup());
  request.setAttribute("liferay-application-list:panel-category:notificationsCount",notificationsCount);
  request.setAttribute("liferay-application-list:panel-category:showHeader",_showHeader);
  request.setAttribute("liferay-application-list:panel-category:showOpen",_showOpen);
}
