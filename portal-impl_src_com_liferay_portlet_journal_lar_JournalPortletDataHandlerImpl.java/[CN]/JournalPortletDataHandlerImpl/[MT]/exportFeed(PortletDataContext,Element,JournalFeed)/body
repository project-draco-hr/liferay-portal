{
  if (!portletDataContext.isWithinDateRange(feed.getModifiedDate())) {
    return;
  }
  String path=getFeedPath(portletDataContext,feed);
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  feed=(JournalFeed)feed.clone();
  Element feedElement=feedsElement.addElement("feed");
  Group group=GroupLocalServiceUtil.getGroup(portletDataContext.getScopeGroupId());
  String newGroupFriendlyURL=group.getFriendlyURL().substring(1);
  String[] friendlyUrlParts=StringUtil.split(feed.getTargetLayoutFriendlyUrl(),'/');
  String oldGroupFriendlyURL=friendlyUrlParts[2];
  if (newGroupFriendlyURL.equals(oldGroupFriendlyURL)) {
    String targetLayoutFriendlyUrl=StringUtil.replaceFirst(feed.getTargetLayoutFriendlyUrl(),StringPool.SLASH + newGroupFriendlyURL + StringPool.SLASH,"/@data_handler_group_friendly_url@/");
    feed.setTargetLayoutFriendlyUrl(targetLayoutFriendlyUrl);
  }
  portletDataContext.addClassedModel(feedElement,path,feed,_NAMESPACE);
}
