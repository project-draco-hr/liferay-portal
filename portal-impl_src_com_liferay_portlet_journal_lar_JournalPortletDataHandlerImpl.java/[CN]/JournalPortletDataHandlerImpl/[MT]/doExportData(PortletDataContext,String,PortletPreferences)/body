{
  context.addPermissions("com.liferay.portlet.journal",context.getScopeGroupId());
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("journal-data");
  rootElement.addAttribute("group-id",String.valueOf(context.getScopeGroupId()));
  Element structuresElement=rootElement.addElement("structures");
  List<JournalStructure> structures=JournalStructureUtil.findByGroupId(context.getScopeGroupId());
  for (  JournalStructure structure : structures) {
    if (context.isWithinDateRange(structure.getModifiedDate())) {
      exportStructure(context,structuresElement,structure);
    }
  }
  Element templatesElement=rootElement.addElement("templates");
  Element dlFoldersElement=rootElement.addElement("dl-folders");
  Element dlFilesElement=rootElement.addElement("dl-file-entries");
  Element dlFileRanksElement=rootElement.addElement("dl-file-ranks");
  Element igFoldersElement=rootElement.addElement("ig-folders");
  Element igImagesElement=rootElement.addElement("ig-images");
  List<JournalTemplate> templates=JournalTemplateUtil.findByGroupId(context.getScopeGroupId());
  for (  JournalTemplate template : templates) {
    if (context.isWithinDateRange(template.getModifiedDate())) {
      exportTemplate(context,templatesElement,dlFoldersElement,dlFilesElement,dlFileRanksElement,igFoldersElement,igImagesElement,template);
    }
  }
  Element feedsElement=rootElement.addElement("feeds");
  List<JournalFeed> feeds=JournalFeedUtil.findByGroupId(context.getScopeGroupId());
  for (  JournalFeed feed : feeds) {
    if (context.isWithinDateRange(feed.getModifiedDate())) {
      exportFeed(context,feedsElement,feed);
    }
  }
  Element articlesElement=rootElement.addElement("articles");
  if (context.getBooleanParameter(_NAMESPACE,"articles")) {
    List<JournalArticle> articles=JournalArticleUtil.findByG_ST(context.getScopeGroupId(),WorkflowConstants.STATUS_APPROVED,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new ArticleIDComparator(true));
    for (    JournalArticle article : articles) {
      exportArticle(context,articlesElement,dlFoldersElement,dlFilesElement,dlFileRanksElement,igFoldersElement,igImagesElement,article);
    }
  }
  return document.formattedString();
}
