{
  portletDataContext.addExpandoColumns(JournalArticle.class.getName());
  portletDataContext.addExpandoColumns(JournalFeed.class.getName());
  portletDataContext.addExpandoColumns(JournalTemplate.class.getName());
  portletDataContext.addExpandoColumns(JournalStructure.class.getName());
  portletDataContext.addPermissions("com.liferay.portlet.journal",portletDataContext.getScopeGroupId());
  Document document=SAXReaderUtil.createDocument();
  Element rootElement=document.addElement("journal-data");
  rootElement.addAttribute("group-id",String.valueOf(portletDataContext.getScopeGroupId()));
  Element structuresElement=rootElement.addElement("structures");
  List<JournalStructure> structures=JournalStructureUtil.findByGroupId(portletDataContext.getScopeGroupId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,new StructurePKComparator(true));
  for (  JournalStructure structure : structures) {
    if (portletDataContext.isWithinDateRange(structure.getModifiedDate())) {
      exportStructure(portletDataContext,structuresElement,structure);
    }
  }
  Element templatesElement=rootElement.addElement("templates");
  Element dlFoldersElement=rootElement.addElement("dl-folders");
  Element dlFilesElement=rootElement.addElement("dl-file-entries");
  Element dlFileRanksElement=rootElement.addElement("dl-file-ranks");
  Element igFoldersElement=rootElement.addElement("ig-folders");
  Element igImagesElement=rootElement.addElement("ig-images");
  List<JournalTemplate> templates=JournalTemplateUtil.findByGroupId(portletDataContext.getScopeGroupId());
  for (  JournalTemplate template : templates) {
    if (portletDataContext.isWithinDateRange(template.getModifiedDate())) {
      exportTemplate(portletDataContext,templatesElement,dlFoldersElement,dlFilesElement,dlFileRanksElement,igFoldersElement,igImagesElement,template,true);
    }
  }
  Element feedsElement=rootElement.addElement("feeds");
  List<JournalFeed> feeds=JournalFeedUtil.findByGroupId(portletDataContext.getScopeGroupId());
  for (  JournalFeed feed : feeds) {
    if (portletDataContext.isWithinDateRange(feed.getModifiedDate())) {
      exportFeed(portletDataContext,feedsElement,feed);
    }
  }
  Element articlesElement=rootElement.addElement("articles");
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"articles")) {
    List<JournalArticle> articles=JournalArticleUtil.findByGroupId(portletDataContext.getScopeGroupId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,new ArticleIDComparator(true));
    for (    JournalArticle article : articles) {
      exportArticle(portletDataContext,articlesElement,structuresElement,templatesElement,dlFoldersElement,dlFilesElement,dlFileRanksElement,igFoldersElement,igImagesElement,article,true);
    }
  }
  return document.formattedString();
}
