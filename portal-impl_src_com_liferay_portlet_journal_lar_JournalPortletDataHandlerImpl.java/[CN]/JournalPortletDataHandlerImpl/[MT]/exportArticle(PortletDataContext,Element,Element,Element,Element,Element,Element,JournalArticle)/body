{
  if (!context.isWithinDateRange(article.getModifiedDate())) {
    return;
  }
  if (article.getStatus() != WorkflowConstants.STATUS_APPROVED) {
    return;
  }
  String path=getArticlePath(context,article);
  if (!context.isPathNotProcessed(path)) {
    return;
  }
  article=(JournalArticle)article.clone();
  Element articleEl=articlesEl.addElement("article");
  articleEl.addAttribute("path",path);
  Image smallImage=ImageUtil.fetchByPrimaryKey(article.getSmallImageId());
  if (article.isSmallImage() && (smallImage != null)) {
    String smallImagePath=getArticleSmallImagePath(context,article);
    articleEl.addAttribute("small-image-path",smallImagePath);
    article.setSmallImageType(smallImage.getType());
    context.addZipEntry(smallImagePath,smallImage.getTextObj());
  }
  if (context.getBooleanParameter(_NAMESPACE,"images")) {
    String imagePath=getArticleImagePath(context,article);
    articleEl.addAttribute("image-path",imagePath);
    List<JournalArticleImage> articleImages=JournalArticleImageUtil.findByG_A_V(article.getGroupId(),article.getArticleId(),article.getVersion());
    for (    JournalArticleImage articleImage : articleImages) {
      try {
        Image image=ImageUtil.findByPrimaryKey(articleImage.getArticleImageId());
        String articleImagePath=getArticleImagePath(context,article,articleImage,image);
        if (!context.isPathNotProcessed(articleImagePath)) {
          continue;
        }
        context.addZipEntry(articleImagePath,image.getTextObj());
      }
 catch (      NoSuchImageException nsie) {
      }
    }
  }
  context.addPermissions(JournalArticle.class,article.getResourcePrimKey());
  if (context.getBooleanParameter(_NAMESPACE,"categories")) {
    context.addAssetCategories(JournalArticle.class,article.getResourcePrimKey());
  }
  if (context.getBooleanParameter(_NAMESPACE,"comments")) {
    context.addComments(JournalArticle.class,article.getResourcePrimKey());
  }
  if (context.getBooleanParameter(_NAMESPACE,"ratings")) {
    context.addRatingsEntries(JournalArticle.class,article.getResourcePrimKey());
  }
  if (context.getBooleanParameter(_NAMESPACE,"tags")) {
    context.addAssetTags(JournalArticle.class,article.getResourcePrimKey());
  }
  if (context.getBooleanParameter(_NAMESPACE,"embedded-assets")) {
    String content=article.getContent();
    content=exportDLFileEntries(context,dlFoldersEl,dlFileEntriesEl,dlFileRanksEl,articleEl,content);
    content=exportIGImages(context,igFoldersEl,igImagesEl,articleEl,content);
    content=exportLayoutFriendlyURLs(context,content);
    article.setContent(content);
  }
  article.setUserUuid(article.getUserUuid());
  article.setStatusByUserUuid(article.getStatusByUserUuid());
  context.addZipEntry(path,article);
}
