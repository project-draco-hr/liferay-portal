{
  StringBuffer sb=new StringBuffer(text);
  Pattern pattern=Pattern.compile("/get_file\\?([^\"']+)[\"']?");
  Matcher matcher=pattern.matcher(text);
  while (matcher.find()) {
    try {
      Map<String,String> detail=MapUtil.toLinkedHashMap(matcher.group(1).replace("&amp;","&").split("&"),StringPool.EQUAL);
      DLFileEntry fileEntry=null;
      if (detail.containsKey("uuid")) {
        String uuid=detail.get("uuid");
        long groupId=GetterUtil.getLong(detail.get("groupId"));
        fileEntry=DLFileEntryLocalServiceUtil.getFileEntryByUuidAndGroupId(uuid,groupId);
      }
 else       if (detail.containsKey("folderId")) {
        long folderId=GetterUtil.getLong(detail.get("folderId"));
        String name=detail.get("name");
        fileEntry=DLFileEntryLocalServiceUtil.getFileEntry(folderId,name);
      }
      if (fileEntry == null) {
        continue;
      }
      DLPortletDataHandlerImpl.exportFileEntry(context,foldersEl,fileEntriesEl,fileRanks,fileEntry);
      sb.replace(matcher.start(1),matcher.end(1),"uuid=" + fileEntry.getUuid() + "&amp;groupId=@group_id@");
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
  return sb.toString();
}
