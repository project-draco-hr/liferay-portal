{
  StringBuffer sb=new StringBuffer(text);
  Pattern pattern=Pattern.compile("/get_file\\?([^\"']+)[\"']?");
  Matcher matcher=pattern.matcher(text);
  while (matcher.find()) {
    try {
      Map<String,String> detail=MapUtil.toLinkedHashMap(matcher.group(1).replace("&amp;","&").split("&"),StringPool.EQUAL);
      DLFileEntry file=null;
      if (detail.containsKey("uuid")) {
        String uuid=detail.get("uuid");
        long groupId=GetterUtil.getLong(detail.get("groupId"));
        file=DLFileEntryLocalServiceUtil.getFileEntryByUuidAndGroupId(uuid,groupId);
      }
 else       if (detail.containsKey("folderId")) {
        long folderId=GetterUtil.getLong(detail.get("folderId"));
        String name=detail.get("name");
        file=DLFileEntryLocalServiceUtil.getFileEntry(folderId,name);
      }
      if (file != null) {
        DLPortletDataHandlerImpl.exportFileEntry(context,dlFoldersEl,dlFilesEl,dlFileRanks,file);
        StringBuffer sb2=new StringBuffer();
        sb2.append("uuid=");
        sb2.append(file.getUuid());
        sb2.append("&amp;groupId=@group_id@");
        sb.replace(matcher.start(1),matcher.end(1),sb2.toString());
      }
    }
 catch (    Exception e) {
      _log.debug(e,e);
    }
  }
  return sb.toString();
}
