{
  _mockHttpServletRequest.addHeader(HttpHeaders.CONTENT_TYPE,ContentTypes.MULTIPART_FORM_DATA);
  SPIAgentRequest spiAgentRequest=new SPIAgentRequest(new UploadServletRequestImpl(_mockHttpServletRequest,null,null));
  HttpServletRequest populateHttpServletRequest=spiAgentRequest.populateRequest(new MockHttpServletRequest());
  Assert.assertSame(AgentHttpServletRequestWrapper.class,populateHttpServletRequest.getClass());
  spiAgentRequest=new SPIAgentRequest(new UploadServletRequestImpl(_mockHttpServletRequest,new HashMap<String,FileItem[]>(),new HashMap<String,List<String>>()));
  populateHttpServletRequest=spiAgentRequest.populateRequest(new MockHttpServletRequest());
  Assert.assertSame(AgentHttpServletRequestWrapper.class,populateHttpServletRequest.getClass());
  Map<String,FileItem[]> fileParams=new HashMap<String,FileItem[]>();
  String fileParameter="fileParameter";
  FileItem[] fileItems=new FileItem[0];
  fileParams.put(fileParameter,fileItems);
  spiAgentRequest=new SPIAgentRequest(new UploadServletRequestImpl(_mockHttpServletRequest,fileParams,new HashMap<String,List<String>>()));
  populateHttpServletRequest=spiAgentRequest.populateRequest(new MockHttpServletRequest());
  Assert.assertSame(UploadServletRequestImpl.class,populateHttpServletRequest.getClass());
  UploadServletRequestImpl uploadServletRequestImpl=(UploadServletRequestImpl)populateHttpServletRequest;
  Map<String,FileItem[]> populatedFileParams=uploadServletRequestImpl.getMultipartParameterMap();
  Map<String,List<String>> populatedRegularParams=uploadServletRequestImpl.getRegularParameterMap();
  Assert.assertEquals(1,populatedFileParams.size());
  Assert.assertSame(fileItems,populatedFileParams.get(fileParameter));
  Assert.assertTrue(populatedRegularParams.isEmpty());
  Map<String,List<String>> regularParams=new HashMap<String,List<String>>();
  String regularParameter="regularParameter";
  List<String> parameters=new ArrayList<String>();
  regularParams.put(regularParameter,parameters);
  spiAgentRequest=new SPIAgentRequest(new UploadServletRequestImpl(_mockHttpServletRequest,fileParams,regularParams));
  populateHttpServletRequest=spiAgentRequest.populateRequest(new MockHttpServletRequest());
  Assert.assertSame(UploadServletRequestImpl.class,populateHttpServletRequest.getClass());
  uploadServletRequestImpl=(UploadServletRequestImpl)populateHttpServletRequest;
  populatedFileParams=uploadServletRequestImpl.getMultipartParameterMap();
  populatedRegularParams=uploadServletRequestImpl.getRegularParameterMap();
  Assert.assertEquals(1,populatedFileParams.size());
  Assert.assertSame(fileItems,populatedFileParams.get(fileParameter));
  Assert.assertEquals(1,populatedRegularParams.size());
  Assert.assertSame(parameters,populatedRegularParams.get(regularParameter));
  spiAgentRequest=new SPIAgentRequest(new UploadServletRequestImpl(_mockHttpServletRequest,new HashMap<String,FileItem[]>(),regularParams));
  populateHttpServletRequest=spiAgentRequest.populateRequest(new MockHttpServletRequest());
  Assert.assertSame(UploadServletRequestImpl.class,populateHttpServletRequest.getClass());
  uploadServletRequestImpl=(UploadServletRequestImpl)populateHttpServletRequest;
  populatedFileParams=uploadServletRequestImpl.getMultipartParameterMap();
  populatedRegularParams=uploadServletRequestImpl.getRegularParameterMap();
  Assert.assertTrue(populatedFileParams.isEmpty());
  Assert.assertEquals(1,populatedRegularParams.size());
  Assert.assertSame(parameters,populatedRegularParams.get(regularParameter));
}
