{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  Layout layout=(Layout)actionRequest.getAttribute(WebKeys.LAYOUT);
  long groupId=ParamUtil.getLong(actionRequest,"groupId");
  String feedId=ParamUtil.getString(actionRequest,"feedId");
  boolean autoFeedId=ParamUtil.getBoolean(actionRequest,"autoFeedId");
  String name=ParamUtil.getString(actionRequest,"name");
  String description=ParamUtil.getString(actionRequest,"description");
  String type=ParamUtil.getString(actionRequest,"type");
  String structureId=ParamUtil.getString(actionRequest,"structureId");
  String templateId=ParamUtil.getString(actionRequest,"templateId");
  String rendererTemplateId=ParamUtil.getString(actionRequest,"rendererTemplateId");
  int delta=ParamUtil.getInteger(actionRequest,"delta");
  String orderByCol=ParamUtil.getString(actionRequest,"orderByCol");
  String orderByType=ParamUtil.getString(actionRequest,"orderByType");
  String targetLayoutFriendlyUrl=ParamUtil.getString(actionRequest,"targetLayoutFriendlyUrl");
  String targetPortletId=ParamUtil.getString(actionRequest,"targetPortletId");
  String contentField=ParamUtil.getString(actionRequest,"contentField");
  String feedType=RSSUtil.DEFAULT_TYPE;
  double feedVersion=RSSUtil.DEFAULT_VERSION;
  String feedTypeAndVersion=ParamUtil.getString(actionRequest,"feedTypeAndVersion");
  if (Validator.isNotNull(feedTypeAndVersion)) {
    String[] parts=feedTypeAndVersion.split(StringPool.COLON);
    try {
      feedType=parts[0];
      feedVersion=GetterUtil.getDouble(parts[1]);
    }
 catch (    Exception e) {
    }
  }
 else {
    feedType=ParamUtil.getString(actionRequest,"feedType",feedType);
    feedVersion=ParamUtil.getDouble(actionRequest,"feedVersion",feedVersion);
  }
  String[] communityPermissions=actionRequest.getParameterValues("communityPermissions");
  String[] guestPermissions=actionRequest.getParameterValues("guestPermissions");
  if (cmd.equals(Constants.ADD)) {
    JournalFeedServiceUtil.addFeed(layout.getPlid(),feedId,autoFeedId,name,description,type,structureId,templateId,rendererTemplateId,delta,orderByCol,orderByType,targetLayoutFriendlyUrl,targetPortletId,contentField,feedType,feedVersion,communityPermissions,guestPermissions);
  }
 else {
    JournalFeedServiceUtil.updateFeed(groupId,feedId,name,description,type,structureId,templateId,rendererTemplateId,delta,orderByCol,orderByType,targetLayoutFriendlyUrl,targetPortletId,contentField,feedType,feedVersion);
  }
}
