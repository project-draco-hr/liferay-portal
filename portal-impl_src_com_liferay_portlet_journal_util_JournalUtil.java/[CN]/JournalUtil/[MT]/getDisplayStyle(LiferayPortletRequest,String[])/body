{
  PortalPreferences portalPreferences=PortletPreferencesFactoryUtil.getPortalPreferences(liferayPortletRequest);
  String displayStyle=ParamUtil.getString(liferayPortletRequest,"displayStyle");
  if (Validator.isNull(displayStyle)) {
    displayStyle=portalPreferences.getValue(PortletKeys.JOURNAL,"display-style",PropsValues.JOURNAL_DEFAULT_DISPLAY_VIEW);
  }
 else {
    boolean saveDisplayStyle=ParamUtil.getBoolean(liferayPortletRequest,"saveDisplayStyle");
    if (saveDisplayStyle && ArrayUtil.contains(displayViews,displayStyle)) {
      portalPreferences.setValue(PortletKeys.JOURNAL,"display-style",displayStyle);
    }
  }
  if (!ArrayUtil.contains(displayViews,displayStyle)) {
    displayStyle=displayViews[0];
  }
  return displayStyle;
}
