{
  ServiceDependencyManager serviceDependencyManager=new ServiceDependencyManager();
  serviceDependencyManager.addServiceDependencyListener(new ServiceDependencyListener(){
    @Override public void dependenciesFulfilled(){
      Registry registry=RegistryUtil.getRegistry();
      SchedulerEngineHelper schedulerEngineHelper=registry.getService(SchedulerEngineHelper.class);
      if (schedulerEngineHelper.isClusteredSchedulerEngine()) {
        ClusterMasterExecutor clusterMasterExecutor=registry.getService(ClusterMasterExecutor.class);
        clusterMasterExecutor.initialize();
      }
      try {
        schedulerEngineHelper.start();
      }
 catch (      SchedulerException se) {
        _log.error("Unable to start scheduler engine",se);
      }
    }
    @Override public void destroy(){
    }
  }
);
  Registry registry=RegistryUtil.getRegistry();
  Filter filter=registry.getFilter("(objectClass=com.liferay.portal.scheduler.quartz.internal." + "QuartzSchemaManager)");
  serviceDependencyManager.registerDependencies(new Class[]{ClusterMasterExecutor.class,SchedulerEngineHelper.class},new Filter[]{filter});
}
