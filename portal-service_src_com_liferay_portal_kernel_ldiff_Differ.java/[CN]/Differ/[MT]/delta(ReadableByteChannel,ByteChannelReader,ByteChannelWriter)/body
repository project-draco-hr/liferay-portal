{
  _checksums=checksums;
  _modified=modified;
  _delta=delta;
  _checksums.resizeBuffer(LDiff.BUFFER_FACTOR * 20);
  _checksumsBuffer=_checksums.getBuffer();
  readChecksumsHeader();
  readChecksums();
  _reader=new RollingChecksum(_modified,_blockLength);
  _delta.resizeBuffer(_blockLength * LDiff.BUFFER_FACTOR + 5);
  _deltaBuffer=_delta.getBuffer();
  if (_dataBuffer == null || _dataBuffer.capacity() < _blockLength * LDiff.BUFFER_FACTOR) {
    _dataBuffer=ByteBuffer.allocate(_blockLength * LDiff.BUFFER_FACTOR);
  }
  writeDeltaHeader();
  writeDeltaBlocks();
}
