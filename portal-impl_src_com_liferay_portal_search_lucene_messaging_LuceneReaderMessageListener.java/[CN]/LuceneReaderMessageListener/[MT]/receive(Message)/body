{
  String replyTo=message.getReplyTo();
  String messageId=message.getMessageId();
  if (Validator.isNull(replyTo) || Validator.isNull(messageId)) {
    return;
  }
  SearchRequest searchRequest=(SearchRequest)message.getPayload();
  String command=searchRequest.getCommand();
  if (!command.equals(SearchRequest.COMMAND_INDEX_ONLY) && !command.equals(SearchRequest.COMMAND_SEARCH)) {
    return;
  }
  try {
    Object payload=null;
    if (command.equals(SearchRequest.COMMAND_INDEX_ONLY)) {
      payload=doCommandIndexOnly(searchRequest);
    }
 else     if (command.equals(SearchRequest.COMMAND_SEARCH)) {
      payload=doCommandSearch(searchRequest);
    }
    Message reply=new Message(MessageTypes.INDEX_READER_MESSAGE);
    reply.setDestination(replyTo);
    reply.setMessageId(messageId);
    reply.setPayload(payload);
    MessageBusUtil.sendMessage(replyTo,message);
  }
 catch (  Exception e) {
    _log.error("Unable to process message " + message,e);
  }
}
