{
  DLFileEntry fileEntry=dlFileEntryPersistence.findByG_F_N(groupId,folderId,name);
  if (PropsValues.DL_FILE_ENTRY_READ_COUNT_ENABLED) {
    fileEntry.setReadCount(fileEntry.getReadCount() + 1);
    dlFileEntryPersistence.update(fileEntry,false);
  }
  dlAppHelperLocalService.getFileAsStream(userId,fileEntry);
  if (Validator.isNotNull(version)) {
    return dlLocalService.getFileAsStream(companyId,fileEntry.getRepositoryId(),name,version);
  }
 else {
    return dlLocalService.getFileAsStream(companyId,fileEntry.getRepositoryId(),name,fileEntry.getVersion());
  }
}
