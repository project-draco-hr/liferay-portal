{
  HttpSession session=request.getSession();
  Locale locale=(Locale)session.getAttribute(Globals.LOCALE_KEY);
  String requestedLanguageId=null;
  if (Validator.isNotNull(locale)) {
    requestedLanguageId=LocaleUtil.toLanguageId(locale);
  }
  if (Validator.isNull(requestedLanguageId)) {
    requestedLanguageId=userLanguageId;
  }
  if (Validator.isNull(requestedLanguageId)) {
    requestedLanguageId=CookieKeys.getCookie(request,CookieKeys.GUEST_LANGUAGE_ID,false);
  }
  return requestedLanguageId;
}
