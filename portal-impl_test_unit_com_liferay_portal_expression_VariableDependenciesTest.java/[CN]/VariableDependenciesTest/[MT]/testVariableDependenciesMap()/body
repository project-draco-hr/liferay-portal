{
  Expression<Long> expression=ExpressionFactoryUtil.createLongExpression("var1 + var2 + var3");
  expression.setLongVariableValue("var1",5l);
  expression.setExpressionVariableValue("var2",Long.class,"var1 + 3");
  expression.setExpressionVariableValue("var3",Long.class,"var2 + var1");
  Map<String,VariableDependencies> dependenciesMap=expression.getVariableDependenciesMap();
  VariableDependencies var1Dependencies=dependenciesMap.get("var1");
  Assert.assertTrue(var1Dependencies.getRequiredVariableNames().isEmpty());
  Assert.assertTrue(affectedVariablesContains(var1Dependencies,"var2"));
  Assert.assertTrue(affectedVariablesContains(var1Dependencies,"var3"));
  VariableDependencies var2Dependencies=dependenciesMap.get("var2");
  Assert.assertTrue(requiredVariablesContains(var2Dependencies,"var1"));
  Assert.assertTrue(affectedVariablesContains(var2Dependencies,"var3"));
  VariableDependencies var3Dependencies=dependenciesMap.get("var3");
  Assert.assertTrue(requiredVariablesContains(var3Dependencies,"var1"));
  Assert.assertTrue(requiredVariablesContains(var3Dependencies,"var2"));
  Assert.assertTrue(var3Dependencies.getAffectedVariableNames().isEmpty());
}
