{
  Deserializer deserializer=new Deserializer(datagram.getDataByteBuffer());
  PortalCacheActionType portalCacheActionType=PortalCacheActionType.values()[deserializer.readInt()];
  PortalCacheManager<Serializable,Serializable> portalCacheManager=IntrabandPortalCacheManager.getPortalCacheManager();
switch (portalCacheActionType) {
case CLEAR_ALL:
    portalCacheManager.clearAll();
  break;
case DESTROY:
portalCacheManager.destroy();
break;
case GET:
PortalCache<Serializable,Serializable> portalCache=portalCacheManager.getCache(deserializer.readString());
Serializable key=deserializer.readObject();
Serializable value=portalCache.get(key);
_sendResponse(registrationReference,datagram,value);
break;
case PUT:
portalCache=portalCacheManager.getCache(deserializer.readString());
key=deserializer.readObject();
value=deserializer.readObject();
portalCache.put(key,value);
break;
case PUT_TTL:
portalCache=portalCacheManager.getCache(deserializer.readString());
key=deserializer.readObject();
value=deserializer.readObject();
int ttl=deserializer.readInt();
portalCache.put(key,value,ttl);
break;
case RECONFIGURE:
portalCacheManager.reconfigureCaches(new URL(deserializer.readString()));
break;
case REMOVE:
portalCache=portalCacheManager.getCache(deserializer.readString());
key=deserializer.readObject();
portalCache.remove(key);
break;
case REMOVE_ALL:
portalCache=portalCacheManager.getCache(deserializer.readString());
portalCache.removeAll();
break;
case REMOVE_CACHE:
portalCacheManager.removeCache(deserializer.readString());
break;
default :
throw new PortalCacheException("Unsupported portal cache action type " + portalCacheActionType);
}
}
