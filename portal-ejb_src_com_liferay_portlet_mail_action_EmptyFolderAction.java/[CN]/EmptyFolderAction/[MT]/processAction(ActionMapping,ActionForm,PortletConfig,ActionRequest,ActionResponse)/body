{
  try {
    String folderName=req.getParameter("folder_name");
    Folder folder=MailUtil.getFolder(req,folderName);
    Message[] messages=folder.getMessages();
    if (!folder.getFullName().equals(MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_TRASH_NAME)) {
      folder.copyMessages(messages,MailUtil.getFolder(req,MailUtil.MAIL_BOX_STYLE + MailUtil.MAIL_TRASH_NAME));
    }
    folder.setFlags(messages,new Flags(Flags.Flag.DELETED),true);
    folder.expunge();
    String redirect=ParamUtil.getString(req,"redirect");
    if (Validator.isNull(redirect)) {
      setForward(req,Constants.COMMON_NULL);
    }
 else {
      res.sendRedirect(redirect);
    }
  }
 catch (  Exception e) {
    req.setAttribute(PageContext.EXCEPTION,e);
    setForward(req,Constants.COMMON_ERROR);
  }
}
