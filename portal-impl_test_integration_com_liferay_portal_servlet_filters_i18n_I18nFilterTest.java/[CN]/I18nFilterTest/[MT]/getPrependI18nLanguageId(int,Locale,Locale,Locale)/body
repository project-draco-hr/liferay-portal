{
  HttpSession session=_request.getSession();
  session.setAttribute(Globals.LOCALE_KEY,sessionLocale);
  if (userLocale != null) {
    User user=UserTestUtil.addUser(ServiceTestUtil.randomString(),true,userLocale,ServiceTestUtil.randomString(),ServiceTestUtil.randomString(),new long[]{TestPropsValues.getGroupId()});
    _request.setAttribute(WebKeys.USER,user);
  }
  if (cookieLocale != null) {
    LanguageUtil.updateCookie(_request,_response,cookieLocale);
    _request.setCookies(_response.getCookies());
  }
  return _i18nFilter.prependI18nLanguageId(_request,localePrependFriendlyURLStyle);
}
