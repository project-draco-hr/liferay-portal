{
  if (login) {
    _user=UserTestUtil.addUser();
    _request.setAttribute(WebKeys.USER,_user);
  }
  String i18nLanguageId=_DEFAULT_WEB_LANGUAGE_ID;
  if (cookie) {
    i18nLanguageId=_DEFAULT_I18N_LANGUAGE_ID;
    LanguageUtil.updateCookie(_request,_response,LocaleUtil.fromLanguageId("es_ES"));
    _request.setCookies(_response.getCookies());
  }
  if (i18n) {
    i18nLanguageId=_DEFAULT_I18N_LANGUAGE_ID;
  }
  return _i18nFilter.prependI18nLanguageId(_request,i18nLanguageId,algorithm);
}
