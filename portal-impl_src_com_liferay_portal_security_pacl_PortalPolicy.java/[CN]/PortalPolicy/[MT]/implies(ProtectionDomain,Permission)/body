{
  if ((protectionDomain.getClassLoader() == null) || !PACLPolicyManager.isActive() || !_defaultPaclPolicy.isCheckablePermission(permission)) {
    return checkWithParent(protectionDomain,permission);
  }
  Object key=getKey(protectionDomain);
  PermissionCollection permissionCollection=_protectionDomainMapping.get(key);
  if (permissionCollection != null) {
    if (permissionCollection.implies(permission)) {
      return checkWithParent(protectionDomain,permission);
    }
 else     if (checkWithJavaSecurityPolicy(protectionDomain,permission,permissionCollection)) {
      return checkWithParent(protectionDomain,permission);
    }
    return false;
  }
  permissionCollection=getPermissions(protectionDomain);
  _protectionDomainMapping.putIfAbsent(key,permissionCollection);
  if (permissionCollection.implies(permission)) {
    return checkWithParent(protectionDomain,permission);
  }
 else   if (checkWithJavaSecurityPolicy(protectionDomain,permission,permissionCollection)) {
    return checkWithParent(protectionDomain,permission);
  }
  return false;
}
