{
  if (!(permissionCollection instanceof PortalPermissionCollection)) {
    return false;
  }
  PortalPermissionCollection portalPermissionCollection=(PortalPermissionCollection)permissionCollection;
  Policy policy=portalPermissionCollection.getPolicy();
  ClassLoader classLoader=portalPermissionCollection.getClassLoader();
  if ((policy != null) && (classLoader == protectionDomain.getClassLoader())) {
    return policy.implies(protectionDomain,permission);
  }
  return false;
}
