{
  PermissionCollection permissionCollection=null;
  if (_policy != null) {
    permissionCollection=_policy.getPermissions(codeSource);
  }
  String location=StringPool.BLANK;
  URL url=codeSource.getLocation();
  if ((codeSource != null) && (url != null)) {
    location=url.toString();
  }
  if (location.equals(StringPool.BLANK) || location.contains(PropsValues.LIFERAY_LIB_GLOBAL_DIR) || location.contains(PropsValues.LIFERAY_LIB_GLOBAL_SHARED_DIR)|| location.contains(PropsValues.LIFERAY_LIB_PORTAL_DIR)|| location.contains(PropsValues.LIFERAY_WEB_PORTAL_DIR)|| location.contains(PropsValues.MODULE_FRAMEWORK_CORE_DIR)|| location.contains(PropsValues.MODULE_FRAMEWORK_PORTAL_DIR)) {
    if (permissionCollection == null) {
      permissionCollection=new Permissions();
    }
    permissionCollection.add(_allPermission);
  }
  if (permissionCollection == null) {
    permissionCollection=new Permissions();
  }
  return permissionCollection;
}
