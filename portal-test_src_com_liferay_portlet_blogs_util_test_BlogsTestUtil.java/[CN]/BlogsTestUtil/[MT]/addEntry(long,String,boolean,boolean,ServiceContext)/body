{
  boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
  try {
    WorkflowThreadLocal.setEnabled(true);
    String subtitle=StringPool.BLANK;
    String description="Description";
    String content="Content";
    int displayDateMonth=1;
    int displayDateDay=1;
    int displayDateYear=2012;
    int displayDateHour=12;
    int displayDateMinute=0;
    boolean allowPingbacks=true;
    boolean allowTrackbacks=true;
    String[] trackbacks=new String[0];
    ImageSelector imageSelector=null;
    if (smallImage) {
      Class<?> clazz=BlogsTestUtil.class;
      ClassLoader classLoader=clazz.getClassLoader();
      InputStream inputStream=classLoader.getResourceAsStream("com/liferay/portal/util/dependencies/test.jpg");
      FileEntry fileEntry=null;
      try {
        fileEntry=TempFileEntryUtil.getTempFileEntry(serviceContext.getScopeGroupId(),userId,BlogsEntry.class.getName(),"image.jpg");
      }
 catch (      Exception e) {
        fileEntry=TempFileEntryUtil.addTempFileEntry(serviceContext.getScopeGroupId(),userId,"image.jpg",BlogsEntry.class.getName(),inputStream,MimeTypesUtil.getContentType("image.jpg"));
      }
      imageSelector=new ImageSelector(fileEntry.getFileEntryId(),StringPool.BLANK);
    }
    serviceContext=(ServiceContext)serviceContext.clone();
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
    BlogsEntry entry=BlogsEntryLocalServiceUtil.addEntry(userId,title,subtitle,description,content,displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,allowPingbacks,allowTrackbacks,trackbacks,imageSelector,serviceContext);
    if (approved) {
      return updateStatus(entry,serviceContext);
    }
    return entry;
  }
  finally {
    WorkflowThreadLocal.setEnabled(workflowEnabled);
  }
}
