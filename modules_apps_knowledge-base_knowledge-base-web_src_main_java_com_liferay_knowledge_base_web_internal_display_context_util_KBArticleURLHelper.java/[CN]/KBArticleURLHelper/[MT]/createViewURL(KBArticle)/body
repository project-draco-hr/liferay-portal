{
  PortletURL portletURL=_renderResponse.createRenderURL();
  String portletId=PortalUtil.getPortletId(_renderRequest);
  if (portletId.startsWith(KBPortletKeys.KNOWLEDGE_BASE_ADMIN) || portletId.startsWith(KBPortletKeys.KNOWLEDGE_BASE_SECTION) || portletId.startsWith(KBPortletKeys.KNOWLEDGE_BASE_SEARCH)) {
    portletURL.setParameter("mvcPath",_templatePath + "view_article.jsp");
  }
  if (portletId.startsWith(KBPortletKeys.KNOWLEDGE_BASE_ADMIN) || portletId.startsWith(KBPortletKeys.KNOWLEDGE_BASE_SEARCH)) {
    portletURL.setParameter("redirect",PortalUtil.getCurrentURL(_renderRequest));
  }
  if (Validator.isNull(kbArticle.getUrlTitle()) || portletId.equals(KBPortletKeys.KNOWLEDGE_BASE_ADMIN) || portletId.equals(KBPortletKeys.KNOWLEDGE_BASE_SEARCH)) {
    portletURL.setParameter("resourceClassNameId",String.valueOf(kbArticle.getClassNameId()));
    portletURL.setParameter("resourcePrimKey",String.valueOf(kbArticle.getResourcePrimKey()));
  }
 else {
    portletURL.setParameter("urlTitle",kbArticle.getUrlTitle());
    if (kbArticle.getKbFolderId() != KBFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
      KBFolder kbFolder=KBFolderServiceUtil.getKBFolder(kbArticle.getKbFolderId());
      portletURL.setParameter("kbFolderUrlTitle",kbFolder.getUrlTitle());
    }
  }
  return portletURL;
}
