{
  try {
    JsonTokenParser jsonTokenParser=getJsonTokenParser();
    JsonToken jsonToken=jsonTokenParser.verifyAndDeserialize(tokenString);
    JsonPrimitive userIdJsonPrimitive=jsonToken.getParamAsPrimitive("userId");
    if (userIdJsonPrimitive == null) {
      return null;
    }
    long userId=userIdJsonPrimitive.getAsLong();
    User user=UserLocalServiceUtil.fetchUser(userId);
    Date passwordModifiedDate=user.getPasswordModifiedDate();
    if (passwordModifiedDate != null) {
      Instant instant=jsonToken.getIssuedAt();
      if (instant.isBefore(passwordModifiedDate.getTime())) {
        return null;
      }
    }
    return String.valueOf(userId);
  }
 catch (  Exception e) {
    return null;
  }
}
