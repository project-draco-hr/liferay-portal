{
  PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  String[] assetEntryXmls=portletPreferences.getValues("asset-entry-xml",new String[0]);
  if (Validator.isNull(assetEntryXmls)) {
    assetEntryXmls=portletPreferences.getValues("assetEntryXml",new String[0]);
  }
  String[] manualEntries=portletPreferences.getValues("manual-entries",new String[0]);
  if (Validator.isNull(manualEntries)) {
    manualEntries=portletPreferences.getValues("manualEntries",new String[0]);
  }
  String selectionStyle=portletPreferences.getValue("selection-style",null);
  if (Validator.isNull(selectionStyle)) {
    selectionStyle=portletPreferences.getValue("selectionStyle",null);
  }
  if (Validator.isNotNull(selectionStyle) && !selectionStyle.equals("dynamic") && Validator.isNull(assetEntryXmls)&& Validator.isNotNull(manualEntries)) {
    assetEntryXmls=getAssetEntryXmls(manualEntries);
    portletPreferences.setValues("asset-entry-xml",assetEntryXmls);
  }
  return PortletPreferencesFactoryUtil.toXML(portletPreferences);
}
