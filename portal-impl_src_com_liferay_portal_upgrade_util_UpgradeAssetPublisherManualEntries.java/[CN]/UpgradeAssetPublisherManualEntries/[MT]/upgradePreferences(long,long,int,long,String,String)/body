{
  PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  String[] assetEntryXmls=portletPreferences.getValues("asset-entry-xml",new String[0]);
  if (ArrayUtil.isEmpty(assetEntryXmls)) {
    assetEntryXmls=portletPreferences.getValues("assetEntryXml",new String[0]);
  }
  String[] manualEntries=portletPreferences.getValues("manual-entries",new String[0]);
  if (ArrayUtil.isEmpty(manualEntries)) {
    manualEntries=portletPreferences.getValues("manualEntries",new String[0]);
  }
  if (ArrayUtil.isEmpty(assetEntryXmls) && ArrayUtil.isNotEmpty(manualEntries)) {
    assetEntryXmls=getAssetEntryXmls(manualEntries);
    portletPreferences.setValues("asset-entry-xml",assetEntryXmls);
  }
  if (ArrayUtil.isNotEmpty(assetEntryXmls)) {
    upgradeUuids(assetEntryXmls);
    portletPreferences.setValues("assetEntryXml",assetEntryXmls);
  }
  return PortletPreferencesFactoryUtil.toXML(portletPreferences);
}
