{
  Map<String,String> bundleInstructions=getBundleInstructions(project);
  String includeResource=bundleInstructions.get(Constants.INCLUDERESOURCE);
  if (Validator.isNull(includeResource) || !includeResource.contains("-*.")) {
    return;
  }
  Configuration configuration=GradleUtil.getConfiguration(project,JavaPlugin.COMPILE_CONFIGURATION_NAME);
  DependencySet dependencySet=configuration.getAllDependencies();
  GradleInternal gradle=(GradleInternal)project.getGradle();
  ServiceRegistry serviceRegistry=gradle.getServices();
  ProjectConfigurer projectConfigurer=serviceRegistry.get(ProjectConfigurer.class);
  for (  ProjectDependency projectDependency : dependencySet.withType(ProjectDependency.class)) {
    ProjectInternal dependencyProject=(ProjectInternal)projectDependency.getDependencyProject();
    projectConfigurer.configure(dependencyProject);
    if (!hasPlugin(dependencyProject,BasePlugin.class)) {
      continue;
    }
    String name=getArchivesBaseName(dependencyProject);
    String version=String.valueOf(dependencyProject.getVersion());
    includeResource=includeResource.replace(name + "-*.",name + "-" + version+ ".");
  }
  ResolvedConfiguration resolvedConfiguration=configuration.getResolvedConfiguration();
  for (  ResolvedDependency resolvedDependency : resolvedConfiguration.getFirstLevelModuleDependencies()) {
    String name=resolvedDependency.getModuleName();
    String version=resolvedDependency.getModuleVersion();
    includeResource=includeResource.replace(name + "-*.",name + "-" + version+ ".");
  }
  bundleInstructions.put(Constants.INCLUDERESOURCE,includeResource);
}
