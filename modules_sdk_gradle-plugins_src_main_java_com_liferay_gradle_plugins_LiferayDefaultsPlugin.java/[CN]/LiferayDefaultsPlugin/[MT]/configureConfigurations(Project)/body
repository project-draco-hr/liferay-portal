{
  ConfigurationContainer configurationContainer=project.getConfigurations();
  final LiferayExtension liferayExtension=GradleUtil.getExtension(project,LiferayExtension.class);
  Action<Configuration> action=new Action<Configuration>(){
    @Override public void execute(    Configuration configuration){
      ResolutionStrategy resolutionStrategy=configuration.getResolutionStrategy();
      resolutionStrategy.eachDependency(new Action<DependencyResolveDetails>(){
        @Override public void execute(        DependencyResolveDetails dependencyResolveDetails){
          ModuleVersionSelector moduleVersionSelector=dependencyResolveDetails.getRequested();
          String group=moduleVersionSelector.getGroup();
          if (group.equals("com.liferay.portal")) {
            String name=moduleVersionSelector.getName();
            if (name.equals("portal-service")) {
              name="portal-kernel";
            }
            dependencyResolveDetails.useTarget("com.liferay:com.liferay." + name + ":"+ liferayExtension.getPortalVersion());
          }
 else           if (GradleUtil.isPortal(moduleVersionSelector)) {
            dependencyResolveDetails.useVersion(liferayExtension.getPortalVersion());
          }
        }
      }
);
    }
  }
;
  configurationContainer.all(action);
}
