{
  Project project=recordArtifactTask.getProject();
  Task task=project.task(PRINT_ARTIFACT_PUBLISH_COMMANDS);
  task.doLast(new Action<Task>(){
    private String _getGitCommitCommand(    Project project,    String message,    boolean ignored){
      return _getGitCommitCommand(project,message,false,ignored);
    }
    private String _getGradlewCommand(    String gradlewRelativePath,    String command,    boolean daemon,    String... arguments){
      StringBuilder sb=new StringBuilder();
      sb.append(gradlewRelativePath);
      sb.append(' ');
      sb.append(command);
      if (daemon) {
        sb.append(" --daemon");
      }
      for (      String argument : arguments) {
        sb.append(' ');
        sb.append(argument);
      }
      return sb.toString();
    }
    private String _getGitCommitCommand(    Project project,    String message,    boolean all,    boolean ignored){
      StringBuilder sb=new StringBuilder();
      if (all) {
        sb.append("(git diff-index --quiet HEAD || ");
      }
      sb.append("git commit ");
      if (all) {
        sb.append("--all ");
      }
      sb.append("--message=\"");
      if (ignored) {
        sb.append(_IGNORED_MESSAGE_PATTERN);
        sb.append(' ');
      }
      sb.append(project.getName());
      sb.append(' ');
      sb.append(project.getVersion());
      sb.append(' ');
      sb.append(message);
      sb.append('"');
      if (all) {
        sb.append(')');
      }
      return sb.toString();
    }
    @Override public void execute(    Task task){
      List<String> commands=new ArrayList<>();
      Project project=task.getProject();
      commands.add("cd " + FileUtil.getAbsolutePath(project.getProjectDir()));
      File rootDir=portalRootDir;
      if (portalRootDir == null) {
        rootDir=project.getRootDir();
      }
      File gradlewFile=new File(rootDir,"gradlew");
      String gradlewRelativePath=project.relativePath(gradlewFile);
      boolean daemon=true;
      String daemonString=GradleUtil.getTaskPrefixedProperty(task,"daemon");
      if (Validator.isNotNull(daemonString)) {
        daemon=Boolean.parseBoolean(daemonString);
      }
      commands.add(_getGradlewCommand(gradlewRelativePath,BasePlugin.UPLOAD_ARCHIVES_TASK_NAME,daemon,"-P" + _SNAPSHOT_PROPERTY_NAME));
      commands.add(_getGradlewCommand(gradlewRelativePath,BasePlugin.UPLOAD_ARCHIVES_TASK_NAME,daemon));
      commands.add("git add " + project.relativePath("bnd.bnd"));
      commands.add(_getGitCommitCommand(project,"prep next",true));
      commands.add("git add " + project.relativePath(recordArtifactTask.getOutputFile()));
      commands.add(_getGitCommitCommand(project,"artifact properties",true));
      commands.add(_getGitCommitCommand(project,"apply",true,false));
      System.out.println();
      for (      String command : commands) {
        System.out.print(" && ");
        System.out.print(command);
      }
      if (GradleUtil.getProperty(project,"first",false)) {
        throw new GradleException();
      }
    }
  }
);
  if (gitRepoDir != null) {
    task.onlyIf(new LeafArtifactSpec(gitRepoDir));
  }
  task.setDescription("Prints the artifact publish commands if this project has been " + "changed since the last publish.");
  configureTaskEnabledIfStale(task,recordArtifactTask,testProject);
  return task;
}
