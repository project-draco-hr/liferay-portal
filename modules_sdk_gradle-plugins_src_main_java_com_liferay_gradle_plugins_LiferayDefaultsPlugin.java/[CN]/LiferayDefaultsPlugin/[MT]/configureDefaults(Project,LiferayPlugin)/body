{
  final File gitRepoDir=getRootDir(project,".gitrepo");
  final File portalRootDir=getRootDir(project.getRootProject(),"portal-impl");
  final boolean publishing=isPublishing(project);
  boolean testProject=isTestProject(project);
  applyPlugins(project);
  configureMavenConf2ScopeMappings(project);
  applyConfigScripts(project);
  Configuration portalConfiguration=GradleUtil.getConfiguration(project,LiferayJavaPlugin.PORTAL_CONFIGURATION_NAME);
  Configuration portalTestConfiguration=addConfigurationPortalTest(project);
  addDependenciesPortalTest(project);
  addDependenciesTestCompile(project);
  final Jar jarJavadocTask=addTaskJarJavadoc(project);
  final Jar jarSourcesTask=addTaskJarSources(project,testProject);
  final Jar jarTLDDocTask=addTaskJarTLDDoc(project);
  final WritePropertiesTask recordArtifactTask=addTaskRecordArtifact(project);
  addTaskPrintArtifactPublishCommands(gitRepoDir,portalRootDir,recordArtifactTask,testProject);
  addTaskPrintStaleArtifact(portalRootDir,recordArtifactTask,testProject);
  final ReplaceRegexTask updateFileVersionsTask=addTaskUpdateFileVersions(project,gitRepoDir);
  configureBasePlugin(project,portalRootDir);
  configureConfigurations(project);
  configureEclipse(project,portalTestConfiguration);
  configureIdea(project,portalTestConfiguration);
  configureJavaPlugin(project);
  configureProject(project);
  configureRepositories(project);
  configureSourceSetMain(project);
  configureSourceSetTest(project,portalConfiguration,portalTestConfiguration);
  configureSourceSetTestIntegration(project,portalConfiguration,portalTestConfiguration);
  configureTaskJar(project,testProject);
  configureTaskTest(project);
  configureTaskTestIntegration(project);
  configureTasksFindBugs(project);
  configureTasksJavaCompile(project);
  configureTasksPublishNodeModule(project);
  withPlugin(project,BundlePlugin.class,new Action<BundlePlugin>(){
    @Override public void execute(    BundlePlugin bundlePlugin){
      addTaskCopyLibs(project);
      addTaskUpdateBundleVersion(project);
      configureBundleDefaultInstructions(project,publishing);
      configureTaskJavadoc(project);
    }
  }
);
  withPlugin(project,ServiceBuilderPlugin.class,new Action<ServiceBuilderPlugin>(){
    @Override public void execute(    ServiceBuilderPlugin serviceBuilderPlugin){
      configureLocalPortalTool(project,portalRootDir,ServiceBuilderPlugin.CONFIGURATION_NAME,ServiceBuilderDefaultsPlugin.PORTAL_TOOL_NAME,"portal-tools-service-builder");
    }
  }
);
  project.afterEvaluate(new Action<Project>(){
    @Override public void execute(    Project project){
      configureArtifacts(project,jarJavadocTask,jarSourcesTask,jarTLDDocTask);
      configureProjectVersion(project);
      configureTaskUpdateFileVersions(updateFileVersionsTask,portalRootDir);
      configureTaskUploadArchives(project,recordArtifactTask,updateFileVersionsTask);
      if (hasPlugin(project,BundlePlugin.class)) {
        configureBundleInstructions(project);
        configureProjectBndProperties(project);
      }
    }
  }
);
}
