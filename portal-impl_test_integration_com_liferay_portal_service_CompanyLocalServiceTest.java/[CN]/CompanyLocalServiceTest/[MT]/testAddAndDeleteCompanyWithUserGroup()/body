{
  Company company=addCompany();
  long companyId=company.getCompanyId();
  long userId=UserLocalServiceUtil.getDefaultUserId(companyId);
  Group group=GroupTestUtil.addGroup(companyId,userId,GroupConstants.DEFAULT_PARENT_GROUP_ID);
  UserGroup userGroup=UserGroupTestUtil.addUserGroup(group.getGroupId());
  User user=addUser(companyId,userId,group.getGroupId(),getServiceContext(companyId));
  UserGroupLocalServiceUtil.addUserUserGroup(user.getUserId(),userGroup);
  CompanyLocalServiceUtil.deleteCompany(company.getCompanyId());
  userGroup=UserGroupLocalServiceUtil.fetchUserGroup(userGroup.getUserGroupId());
  Assert.assertNull(userGroup);
  user=UserLocalServiceUtil.fetchUser(user.getUserId());
  Assert.assertNull(user);
}
