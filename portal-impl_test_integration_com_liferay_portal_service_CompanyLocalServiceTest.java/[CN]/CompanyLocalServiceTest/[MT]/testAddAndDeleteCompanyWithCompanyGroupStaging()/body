{
  Company company=addCompany();
  long companyId=company.getCompanyId();
  long userId=UserLocalServiceUtil.getDefaultUserId(companyId);
  Group companyGroup=company.getGroup();
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAttribute("staging",Boolean.TRUE);
  Group companyStagingGroup=GroupLocalServiceUtil.addGroup(userId,GroupConstants.DEFAULT_PARENT_GROUP_ID,companyGroup.getClassName(),companyGroup.getClassPK(),companyGroup.getGroupId(),RandomTestUtil.randomLocaleStringMap(),RandomTestUtil.randomLocaleStringMap(),companyGroup.getType(),companyGroup.isManualMembership(),companyGroup.getMembershipRestriction(),companyGroup.getFriendlyURL(),false,companyGroup.isActive(),serviceContext);
  CompanyLocalServiceUtil.deleteCompany(company.getCompanyId());
  companyGroup=GroupLocalServiceUtil.fetchGroup(companyGroup.getGroupId());
  Assert.assertNull(companyGroup);
  companyStagingGroup=GroupLocalServiceUtil.fetchGroup(companyStagingGroup.getGroupId());
  Assert.assertNull(companyStagingGroup);
}
