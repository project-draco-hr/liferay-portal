{
  int processNumber=4;
  int incrementCount=10000;
  String classPath=ClassPathUtil.getJVMClassPath(true);
  List<String> jvmArguments=Arrays.asList("-Xmx1024m","-XX:MaxPermSize=200m");
  List<Future<Long[]>> futureResults=new ArrayList<Future<Long[]>>();
  for (int i=0; i < processNumber; i++) {
    ProcessCallable<Long[]> processCallable=new IncrementProcessCallable("Increment Process-" + i,_COUNTER_NAME,incrementCount);
    Future<Long[]> result=ProcessExecutor.execute(classPath,jvmArguments,processCallable);
    futureResults.add(result);
  }
  int totalIdCount=processNumber * incrementCount;
  List<Long> ids=new ArrayList<Long>(totalIdCount);
  for (  Future<Long[]> futureResult : futureResults) {
    ids.addAll(Arrays.asList(futureResult.get()));
  }
  Assert.assertEquals(totalIdCount,ids.size());
  Collections.sort(ids);
  for (int i=0; i < totalIdCount; i++) {
    Assert.assertEquals(i + 1,ids.get(i).intValue());
  }
}
