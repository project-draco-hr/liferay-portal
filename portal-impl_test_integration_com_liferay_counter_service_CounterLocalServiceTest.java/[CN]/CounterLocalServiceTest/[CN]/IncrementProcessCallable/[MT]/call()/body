{
  RegistryUtil.setRegistry(new BasicRegistryImpl());
  System.setProperty(PropsKeys.COUNTER_INCREMENT + "." + _counterName,"1");
  System.setProperty("catalina.base",".");
  System.setProperty("external-properties","portal-test.properties");
  System.setProperty("portal:jdbc.default.maxPoolSize","1");
  System.setProperty("portal:jdbc.default.minPoolSize","0");
  System.setProperty("portal:jdbc.default.maximumPoolSize","1");
  System.setProperty("portal:jdbc.default.minimumIdle","0");
  if (_HYPERSONIC) {
    System.setProperty("portal:jdbc.default.url","jdbc:hsqldb:hsql://localhost/lportal");
    System.setProperty("portal:jdbc.default.username","sa");
    System.setProperty("portal:jdbc.default.password","");
  }
  CacheKeyGeneratorUtil cacheKeyGeneratorUtil=new CacheKeyGeneratorUtil();
  cacheKeyGeneratorUtil.setDefaultCacheKeyGenerator(new SimpleCacheKeyGenerator());
  InitUtil.initWithSpring(Arrays.asList("META-INF/base-spring.xml","META-INF/counter-spring.xml"),false);
  List<Long> ids=new ArrayList<>();
  try {
    for (int i=0; i < _incrementCount; i++) {
      ids.add(CounterLocalServiceUtil.increment(_counterName));
    }
  }
 catch (  SystemException se) {
    throw new ProcessException(se);
  }
  return ids.toArray(new Long[ids.size()]);
}
