{
  if (text.isEmpty())   return this;
  int openingCharsToStrip=0, trailingCharsToStrip=0;
  boolean deliberateLeftTrim=deliberateLeftTrim();
  boolean deliberateRightTrim=deliberateRightTrim();
  if (!stripWhitespace || text.isEmpty()) {
    return this;
  }
  if (getParentElement().getParentElement() == null && previousSibling() == null)   return this;
  if (!deliberateLeftTrim) {
    trailingCharsToStrip=trailingCharsToStrip();
  }
  if (!deliberateRightTrim) {
    openingCharsToStrip=openingCharsToStrip();
  }
  if (openingCharsToStrip == 0 && trailingCharsToStrip == 0) {
    return this;
  }
  this.text=text.substring(openingCharsToStrip,text.length() - trailingCharsToStrip);
  if (openingCharsToStrip > 0) {
    this.beginLine++;
    this.beginColumn=1;
  }
  if (trailingCharsToStrip > 0) {
    this.endColumn=0;
  }
  return this;
}
