{
  FileCacheOutputStream fcos=null;
  InputStream is=null;
  try {
    Group group=GroupLocalServiceUtil.getGroup(layoutSet.getGroupId());
    if (!group.isCommunity() || group.getName().contains(_TEMPLATE_POSTFIX)) {
      return;
    }
    Group templateGroup=getTemplateGroup(group);
    if (templateGroup == null) {
      return;
    }
    Group templateStagingGroup=templateGroup.getStagingGroup();
    if (templateStagingGroup == null) {
      return;
    }
    fcos=LayoutLocalServiceUtil.exportLayoutsAsStream(templateStagingGroup.getGroupId(),layoutSet.isPrivateLayout(),null,_templateParameters,null,null);
    is=fcos.getFileInputStream();
    LayoutLocalServiceUtil.importLayouts(group.getCreatorUserId(),group.getGroupId(),layoutSet.isPrivateLayout(),_templateParameters,is);
  }
 catch (  Exception e) {
    _log.error("Unble to import layouts for group " + layoutSet.getGroupId(),e);
  }
 finally {
    try {
      if (is != null) {
        is.close();
      }
      if (fcos != null) {
        fcos.cleanUp();
      }
    }
 catch (    Exception e) {
    }
  }
}
