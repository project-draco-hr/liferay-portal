{
  User user=(User)obj;
  Set<Group> mandatoryGroups=MembershipPolicyUtil.getMandatoryGroups(user);
  if ((isChecked(user) && mandatoryGroups.contains(_group)) || (!isChecked(user) && !MembershipPolicyUtil.isMembershipAllowed(_group,user))) {
    return true;
  }
 else {
    try {
      PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
      if (GroupPermissionUtil.hasMembershipProtected(permissionChecker,_group.getGroupId(),user.getUserId())) {
        return true;
      }
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
  return super.isDisabled(obj);
}
