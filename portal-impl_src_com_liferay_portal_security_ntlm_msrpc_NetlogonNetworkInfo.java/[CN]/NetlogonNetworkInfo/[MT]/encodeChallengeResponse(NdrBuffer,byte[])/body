{
  buffer=buffer.deferred;
  buffer.enc_ndr_long(challenge.length);
  buffer.enc_ndr_long(0);
  buffer.enc_ndr_long(challenge.length);
  int challengeIndex=buffer.index;
  buffer.advance(challenge.length);
  buffer=buffer.derive(challengeIndex);
  for (int i=0; i < challenge.length; i++) {
    buffer.enc_ndr_small(challenge[i]);
  }
}
