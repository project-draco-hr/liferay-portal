{
  buffer.align(4);
  _identity.encode(buffer);
  int lmChallengeIndex=buffer.index;
  buffer.advance(8);
  buffer.enc_ndr_short((short)_ntChallengeResponse.length);
  buffer.enc_ndr_short((short)_ntChallengeResponse.length);
  buffer.enc_ndr_referent(_ntChallengeResponse,1);
  buffer.enc_ndr_short((short)_lmChallengeResponse.length);
  buffer.enc_ndr_short((short)_lmChallengeResponse.length);
  buffer.enc_ndr_referent(_lmChallengeResponse,1);
  _identity.encodeLogonDomainName(buffer);
  _identity.encodeUserName(buffer);
  _identity.encodeWorkStationName(buffer);
  buffer=buffer.derive(lmChallengeIndex);
  for (int i=0; i < 8; i++) {
    buffer.enc_ndr_small(_lmChallenge[i]);
  }
  encodeChallengeResponse(buffer,_ntChallengeResponse);
  encodeChallengeResponse(buffer,_lmChallengeResponse);
}
