{
  TrashEntry trashEntry=trashEntryLocalService.getEntry(JournalArticle.class.getName(),article.getResourcePrimKey());
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setScopeGroupId(article.getGroupId());
  updateStatus(userId,article,trashEntry.getStatus(),null,new HashMap<String,Serializable>(),serviceContext);
  List<TrashVersion> trashVersions=trashVersionLocalService.getVersions(trashEntry.getEntryId());
  for (  TrashVersion trashVersion : trashVersions) {
    JournalArticle trashArticleVersion=journalArticlePersistence.findByPrimaryKey(trashVersion.getClassPK());
    trashArticleVersion.setStatus(trashVersion.getStatus());
    journalArticlePersistence.update(trashArticleVersion);
  }
  trashEntryLocalService.deleteEntry(JournalArticle.class.getName(),article.getResourcePrimKey());
  JSONObject extraDataJSONObject=JSONFactoryUtil.createJSONObject();
  extraDataJSONObject.put("title",article.getTitle());
  socialActivityLocalService.addActivity(userId,article.getGroupId(),JournalArticle.class.getName(),article.getResourcePrimKey(),SocialActivityConstants.TYPE_RESTORE_FROM_TRASH,extraDataJSONObject.toString(),0);
  List<JournalArticle> articleVersions=journalArticlePersistence.findByG_A(article.getGroupId(),article.getArticleId());
  if (!articleVersions.isEmpty()) {
    Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(JournalArticle.class);
    for (    JournalArticle articleVersion : articleVersions) {
      indexer.reindex(articleVersion);
    }
  }
  return article;
}
