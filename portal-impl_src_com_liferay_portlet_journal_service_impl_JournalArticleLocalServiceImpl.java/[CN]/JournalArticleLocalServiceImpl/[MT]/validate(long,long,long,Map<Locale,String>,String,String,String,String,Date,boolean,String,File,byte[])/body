{
  Locale articleDefaultLocale=LocaleUtil.fromLanguageId(LocalizationUtil.getDefaultLanguageId(content));
  Locale[] availableLocales=LanguageUtil.getAvailableLocales(groupId);
  if (!ArrayUtil.contains(availableLocales,articleDefaultLocale)) {
    LocaleException le=new LocaleException(LocaleException.TYPE_CONTENT,"The locale " + articleDefaultLocale + " is not available in site with groupId"+ groupId);
    Locale[] sourceAvailableLocales={articleDefaultLocale};
    le.setSourceAvailableLocales(sourceAvailableLocales);
    le.setTargetAvailableLocales(availableLocales);
    throw le;
  }
  if ((classNameId == JournalArticleConstants.CLASSNAME_ID_DEFAULT) && (titleMap.isEmpty() || Validator.isNull(titleMap.get(articleDefaultLocale)))) {
    throw new ArticleTitleException();
  }
 else   if (Validator.isNull(type)) {
    throw new ArticleTypeException();
  }
  validateContent(content);
  if (Validator.isNotNull(ddmStructureKey)) {
    Group companyGroup=groupLocalService.getCompanyGroup(companyId);
    DDMStructure ddmStructure=null;
    try {
      ddmStructure=ddmStructurePersistence.findByG_C_S(groupId,PortalUtil.getClassNameId(JournalArticle.class),ddmStructureKey);
    }
 catch (    NoSuchStructureException nsse) {
      ddmStructure=ddmStructurePersistence.findByG_C_S(companyGroup.getGroupId(),PortalUtil.getClassNameId(JournalArticle.class),ddmStructureKey);
    }
    DDMTemplate ddmTemplate=null;
    if (Validator.isNotNull(ddmTemplateKey)) {
      try {
        ddmTemplate=ddmTemplatePersistence.findByG_C_T(groupId,PortalUtil.getClassNameId(DDMStructure.class),ddmTemplateKey);
      }
 catch (      NoSuchTemplateException nste) {
        ddmTemplate=ddmTemplatePersistence.findByG_C_T(companyGroup.getGroupId(),PortalUtil.getClassNameId(DDMStructure.class),ddmTemplateKey);
      }
      if (ddmTemplate.getClassPK() != ddmStructure.getStructureId()) {
        throw new NoSuchTemplateException();
      }
    }
 else     if (classNameId == JournalArticleConstants.CLASSNAME_ID_DEFAULT) {
      throw new NoSuchTemplateException();
    }
  }
  if ((expirationDate != null) && expirationDate.before(new Date()) && !ExportImportThreadLocal.isImportInProcess()) {
    throw new ArticleExpirationDateException();
  }
  String[] imageExtensions=PrefsPropsUtil.getStringArray(PropsKeys.JOURNAL_IMAGE_EXTENSIONS,StringPool.COMMA);
  if (!smallImage || Validator.isNotNull(smallImageURL) || (smallImageFile == null)|| (smallImageBytes == null)) {
    return;
  }
  String smallImageName=smallImageFile.getName();
  if (smallImageName != null) {
    boolean validSmallImageExtension=false;
    for (    String _imageExtension : imageExtensions) {
      if (StringPool.STAR.equals(_imageExtension) || StringUtil.endsWith(smallImageName,_imageExtension)) {
        validSmallImageExtension=true;
        break;
      }
    }
    if (!validSmallImageExtension) {
      throw new ArticleSmallImageNameException(smallImageName);
    }
  }
  long smallImageMaxSize=PrefsPropsUtil.getLong(PropsKeys.JOURNAL_IMAGE_SMALL_MAX_SIZE);
  if ((smallImageMaxSize > 0) && ((smallImageBytes == null) || (smallImageBytes.length > smallImageMaxSize))) {
    throw new ArticleSmallImageSizeException();
  }
}
