{
  Date[] dateInterval=getDateInterval(article.getGroupId(),article.getArticleId(),article.getDisplayDate(),article.getExpirationDate());
  Date displayDate=dateInterval[0];
  Date expirationDate=dateInterval[1];
  boolean visible=article.isApproved();
  if (article.getClassNameId() > 0) {
    visible=false;
  }
  boolean addDraftAssetEntry=false;
  if (!article.isApproved() && (article.getVersion() != JournalArticleConstants.VERSION_DEFAULT)) {
    int approvedArticlesCount=journalArticlePersistence.countByG_A_ST(article.getGroupId(),article.getArticleId(),WorkflowConstants.STATUS_APPROVED);
    if (approvedArticlesCount > 0) {
      addDraftAssetEntry=true;
    }
  }
  AssetEntry assetEntry=null;
  if (addDraftAssetEntry) {
    assetEntry=assetEntryLocalService.updateEntry(userId,article.getGroupId(),JournalArticle.class.getName(),article.getPrimaryKey(),article.getUuid(),getClassTypeId(article),assetCategoryIds,assetTagNames,false,null,null,displayDate,expirationDate,ContentTypes.TEXT_HTML,article.getTitle(),article.getDescription(),article.getDescription(),null,article.getLayoutUuid(),0,0,null,false);
  }
 else {
    JournalArticleResource journalArticleResource=journalArticleResourceLocalService.getArticleResource(article.getResourcePrimKey());
    assetEntry=assetEntryLocalService.updateEntry(userId,article.getGroupId(),JournalArticle.class.getName(),journalArticleResource.getResourcePrimKey(),journalArticleResource.getUuid(),getClassTypeId(article),assetCategoryIds,assetTagNames,visible,null,null,displayDate,expirationDate,ContentTypes.TEXT_HTML,article.getTitle(),article.getDescription(),article.getDescription(),null,article.getLayoutUuid(),0,0,null,false);
  }
  assetLinkLocalService.updateLinks(userId,assetEntry.getEntryId(),assetLinkEntryIds,AssetLinkConstants.TYPE_RELATED);
}
