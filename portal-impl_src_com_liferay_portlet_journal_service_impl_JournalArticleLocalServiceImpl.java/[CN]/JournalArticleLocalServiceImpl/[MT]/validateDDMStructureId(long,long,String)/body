{
  DDMStructure ddmStructure=ddmStructureLocalService.getStructure(PortalUtil.getSiteGroupId(groupId),classNameLocalService.getClassNameId(JournalArticle.class),ddmStructureKey,true);
  JournalFolder folder=journalFolderPersistence.fetchByPrimaryKey(folderId);
  int restrictionType=JournalFolderConstants.RESTRICTION_TYPE_INHERIT;
  if (folder != null) {
    restrictionType=folder.getRestrictionType();
  }
  List<DDMStructure> folderDDMStructures=ddmStructureLocalService.getJournalFolderStructures(PortalUtil.getCurrentAndAncestorSiteGroupIds(groupId),folderId,restrictionType);
  for (  DDMStructure folderDDMStructure : folderDDMStructures) {
    if (folderDDMStructure.getStructureId() == ddmStructure.getStructureId()) {
      return;
    }
  }
  throw new InvalidDDMStructureException("Invalid structure " + ddmStructure.getStructureId() + " for folder "+ folderId);
}
