{
  List<JournalArticle> approvedArticles=journalArticlePersistence.findByG_A_ST(article.getGroupId(),article.getArticleId(),WorkflowConstants.STATUS_APPROVED,0,2);
  if (approvedArticles.isEmpty() || ((approvedArticles.size() == 1) && (article.getStatus() == WorkflowConstants.STATUS_APPROVED))) {
    if (article.isIndexable()) {
      Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(JournalArticle.class);
      indexer.delete(article);
    }
    assetEntryLocalService.updateVisible(JournalArticle.class.getName(),article.getResourcePrimKey(),false);
  }
 else {
    JournalArticle previousApprovedArticle=approvedArticles.get(0);
    if (article.getStatus() == WorkflowConstants.STATUS_APPROVED) {
      previousApprovedArticle=approvedArticles.get(1);
    }
    Date[] dateInterval=getDateInterval(previousApprovedArticle.getGroupId(),previousApprovedArticle.getArticleId(),previousApprovedArticle.getDisplayDate(),previousApprovedArticle.getExpirationDate());
    Date displayDate=dateInterval[0];
    Date expirationDate=dateInterval[1];
    assetEntryLocalService.updateEntry(JournalArticle.class.getName(),article.getResourcePrimKey(),displayDate,expirationDate,true);
    if (article.isIndexable()) {
      Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(JournalArticle.class);
      indexer.reindex(previousApprovedArticle);
    }
  }
}
