{
  Document contentDocument=oldArticle.getDocument();
  contentDocument=contentDocument.clone();
  XPath xPathSelector=SAXReaderUtil.createXPath("//dynamic-element[@type='image']");
  List<Node> imageNodes=xPathSelector.selectNodes(contentDocument);
  for (  Node imageNode : imageNodes) {
    Element imageEl=(Element)imageNode;
    String elInstanceId=imageEl.attributeValue("instance-id");
    String elName=imageEl.attributeValue("name");
    String elIndex=imageEl.attributeValue("index");
    String name=elName + StringPool.UNDERLINE + elIndex;
    List<Element> dynamicContentEls=imageEl.elements("dynamic-content");
    for (    Element dynamicContentEl : dynamicContentEls) {
      long imageId=GetterUtil.getLong(dynamicContentEl.attributeValue("id"));
      String languageId=StringPool.UNDERLINE + dynamicContentEl.attributeValue("language-id");
      Image oldImage=imageLocalService.fetchImage(imageId);
      if (oldImage == null) {
        continue;
      }
      imageId=journalArticleImageLocalService.getArticleImageId(newArticle.getGroupId(),newArticle.getArticleId(),newArticle.getVersion(),elInstanceId,name,languageId);
      imageLocalService.updateImage(imageId,oldImage.getTextObj());
      String elContent="/image/journal/article?img_id=" + imageId + "&t="+ WebServerServletTokenUtil.getToken(imageId);
      dynamicContentEl.setText(elContent);
      dynamicContentEl.addAttribute("id",String.valueOf(imageId));
    }
  }
  newArticle.setContent(contentDocument.formattedString());
}
