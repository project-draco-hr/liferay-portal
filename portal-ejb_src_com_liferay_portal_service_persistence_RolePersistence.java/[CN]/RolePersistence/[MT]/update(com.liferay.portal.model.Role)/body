{
  Session session=null;
  try {
    if (role.isNew() || role.isModified()) {
      session=openSession();
      if (role.isNew()) {
        RoleHBM roleHBM=new RoleHBM();
        roleHBM.setRoleId(role.getRoleId());
        roleHBM.setCompanyId(role.getCompanyId());
        roleHBM.setClassName(role.getClassName());
        roleHBM.setClassPK(role.getClassPK());
        roleHBM.setName(role.getName());
        roleHBM.setDescription(role.getDescription());
        roleHBM.setGroups(new HashSet());
        roleHBM.setPermissions(new HashSet());
        roleHBM.setUsers(new HashSet());
        session.save(roleHBM);
        session.flush();
      }
 else {
        RoleHBM roleHBM=(RoleHBM)session.get(RoleHBM.class,role.getPrimaryKey());
        if (roleHBM != null) {
          roleHBM.setCompanyId(role.getCompanyId());
          roleHBM.setClassName(role.getClassName());
          roleHBM.setClassPK(role.getClassPK());
          roleHBM.setName(role.getName());
          roleHBM.setDescription(role.getDescription());
          session.flush();
        }
 else {
          roleHBM=new RoleHBM();
          roleHBM.setRoleId(role.getRoleId());
          roleHBM.setCompanyId(role.getCompanyId());
          roleHBM.setClassName(role.getClassName());
          roleHBM.setClassPK(role.getClassPK());
          roleHBM.setName(role.getName());
          roleHBM.setDescription(role.getDescription());
          session.save(roleHBM);
          session.flush();
        }
      }
      role.setNew(false);
      role.setModified(false);
    }
    return role;
  }
 catch (  HibernateException he) {
    throw new SystemException(he);
  }
 finally {
    closeSession(session);
  }
}
