{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
    PortletURL portletURL=PortletURLFactoryUtil.create(actionRequest,PortletKeys.KNOWLEDGE_BASE_ADMIN,themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
    portletURL.setParameter("mvcPath",templatePath + "edit_article.jsp");
    portletURL.setParameter("redirect",getRedirect(actionRequest,actionResponse));
    portletURL.setParameter("resourcePrimKey",String.valueOf(kbArticle.getResourcePrimKey()));
    portletURL.setWindowState(actionRequest.getWindowState());
    return portletURL.toString();
  }
 catch (  WindowStateException wse) {
    throw new PortalException(wse);
  }
}
