{
  ProducerEntityManagerFactory producerEntityManagerFactory=ProducerEntityManagerFactory.getInstance();
  String portalId=WSRPConfig.getPortalId();
  ProducerEntityManager producerEntityManager=producerEntityManagerFactory.getProducerEntityManager(portalId,null);
  ProducerEntity producerEntity=producerEntityManager.getProducerEntity(producerEntityId);
  PortletDescription portletDescription=producerEntity.getPortletDescription(portletHandle);
  Map<String,Set<String>> portletModes=new HashMap<String,Set<String>>();
  List<MarkupType> markupTypes=portletDescription.getMarkupTypes();
  for (  MarkupType markupType : markupTypes) {
    Set<String> mimeModes=getPortalModes(markupType.getModes());
    portletModes.put(markupType.getMimeType(),mimeModes);
  }
  portlet.setPortletModes(portletModes);
  LocalizedString displayName=portletDescription.getDisplayName();
  if (displayName != null) {
    String display=displayName.getValue();
    if (display == null) {
      portlet.setDisplayName(portletHandle);
    }
 else {
      portlet.setDisplayName(display);
    }
  }
  String title=portletDescription.getTitle().getValue();
  if (title == null) {
    title=portletHandle;
  }
  String shortTitle=portletDescription.getShortTitle().getValue();
  if (shortTitle == null) {
    shortTitle=portletHandle;
  }
  String keyword=null;
  List<LocalizedString> keywords=portletDescription.getKeywords();
  if ((keywords != null) && (keywords.size() >= 1)) {
    LocalizedString element=keywords.get(0);
    if (element != null) {
      keyword=element.getValue();
    }
  }
  if (keyword == null) {
    keyword=_DEFAULT_KEYWORD;
  }
  PortletInfo portletInfo=new PortletInfo(title,shortTitle,keyword);
  portlet.setPortletInfo(portletInfo);
}
