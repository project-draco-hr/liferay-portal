{
  _scriptingContainer=new ScriptingContainer(LocalContextScope.THREADSAFE);
  LocalContextProvider localContextProvider=_scriptingContainer.getProvider();
  RubyInstanceConfig rubyInstanceConfig=localContextProvider.getRubyInstanceConfig();
  if (_COMPILE_MODE_FORCE.equals(compileMode)) {
    rubyInstanceConfig.setCompileMode(RubyInstanceConfig.CompileMode.FORCE);
  }
 else   if (_COMPILE_MODE_JIT.equals(compileMode)) {
    rubyInstanceConfig.setCompileMode(RubyInstanceConfig.CompileMode.JIT);
  }
  List<String> loadPaths=new ArrayList<>();
  loadPaths.add("META-INF/jruby.home/lib/ruby/site_ruby/1.8");
  loadPaths.add("META-INF/jruby.home/lib/ruby/site_ruby/shared");
  loadPaths.add("META-INF/jruby.home/lib/ruby/1.8");
  loadPaths.add("gems/chunky_png-1.3.4/lib");
  loadPaths.add("gems/compass-1.0.1/lib");
  loadPaths.add("gems/compass-core-1.0.3/lib");
  loadPaths.add("gems/compass-import-once-1.0.5/lib");
  loadPaths.add("gems/ffi-1.9.6-java/lib");
  loadPaths.add("gems/multi_json-1.10.1/lib");
  loadPaths.add("gems/rb-fsevent-0.9.4/lib");
  loadPaths.add("gems/rb-inotify-0.9.5/lib");
  loadPaths.add("gems/sass-3.4.13/lib");
  rubyInstanceConfig.setLoadPaths(loadPaths);
  rubyInstanceConfig.setJitThreshold(compilerThreshold);
  ClassLoader classLoader=getClass().getClassLoader();
  Path path=Paths.get(classLoader.getResource(_SCRIPT_PATH).toURI());
  String rubyScript=new String(Files.readAllBytes(path));
  _scriptObject=_scriptingContainer.runScriptlet(rubyScript);
  _docrootPath=docrootPath;
  _includePath=includePath;
}
