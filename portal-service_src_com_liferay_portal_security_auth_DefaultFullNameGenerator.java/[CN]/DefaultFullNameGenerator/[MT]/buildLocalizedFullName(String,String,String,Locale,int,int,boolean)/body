{
  StringBundler sb=new StringBundler(5);
  Map<String,String> namesMap=new HashMap<String,String>();
  FullNameDefinition fullNameDefinition=LocalizationUtil.getFullNameDefinition(locale);
  if (Validator.isNotNull(firstName)) {
    if (useInitials) {
      firstName=firstName.substring(0,1);
    }
    namesMap.put("first-name",firstName);
  }
  if (Validator.isNotNull(middleName)) {
    if (useInitials) {
      middleName=middleName.substring(0,1);
    }
    namesMap.put("middle-name",middleName);
  }
  if (Validator.isNotNull(lastName)) {
    namesMap.put("last-name",lastName);
  }
  if (prefixId != 0) {
    try {
      String prefix=ListTypeServiceUtil.getListType(prefixId).getName();
      prefix=LanguageUtil.get(locale,prefix);
      namesMap.put("prefix",prefix);
    }
 catch (    NoSuchListTypeException nslte) {
      if (_log.isDebugEnabled()) {
        _log.debug("Ignoring full name prefix " + prefixId + " because"+ " it cannot be found",nslte);
      }
    }
catch (    PortalException pe) {
      throw new SystemException(pe);
    }
  }
  if (suffixId != 0) {
    try {
      String suffix=ListTypeServiceUtil.getListType(suffixId).getName();
      suffix=LanguageUtil.get(locale,suffix);
      namesMap.put("suffix",suffix);
    }
 catch (    NoSuchListTypeException nslte) {
      if (_log.isDebugEnabled()) {
        _log.debug("Ignoring full name suffix " + suffixId + " because"+ " it cannot be found",nslte);
      }
    }
catch (    PortalException pe) {
      throw new SystemException(pe);
    }
  }
  for (  FullNameField fullNameField : fullNameDefinition.getFields()) {
    if (namesMap.containsKey(fullNameField.getName())) {
      sb.append(StringPool.SPACE);
      sb.append(namesMap.get(fullNameField.getName()));
    }
  }
  return sb.toString();
}
