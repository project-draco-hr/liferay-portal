{
  StringBundler sb=new StringBundler(5);
  Map<String,String> namesMap=new HashMap<String,String>();
  String fieldsString=LanguageUtil.get(LocaleUtil.getDefault(),"user.name.fields");
  String[] userNameFields=StringUtil.split(fieldsString);
  if (Validator.isNotNull(firstName)) {
    if (useInitials) {
      firstName=firstName.substring(0,1);
    }
    namesMap.put("first-name",firstName);
  }
  if (Validator.isNotNull(middleName)) {
    if (useInitials) {
      middleName=middleName.substring(0,1);
    }
    namesMap.put("middle-name",middleName);
  }
  if (Validator.isNotNull(lastName)) {
    namesMap.put("last-name",lastName);
  }
  for (  String userNameField : userNameFields) {
    if (namesMap.containsKey(userNameField)) {
      sb.append(StringPool.SPACE);
      sb.append(namesMap.get(userNameField));
    }
  }
  return sb.toString();
}
