{
  StringBundler sb=new StringBundler(5);
  Map<String,String> namesMap=new HashMap<String,String>();
  Locale locale=LocaleUtil.getDefault();
  String fieldsString=LanguageUtil.get(locale,"user.name.fields");
  String[] userNameFields=StringUtil.split(fieldsString);
  if (Validator.isNotNull(firstName)) {
    if (useInitials) {
      firstName=firstName.substring(0,1);
    }
    namesMap.put("firstName",firstName);
  }
  if (Validator.isNotNull(middleName)) {
    if (useInitials) {
      middleName=middleName.substring(0,1);
    }
    namesMap.put("middleName",middleName);
  }
  if (Validator.isNotNull(lastName)) {
    namesMap.put("lastName",lastName);
  }
  for (  String userNameField : userNameFields) {
    if (namesMap.containsKey(userNameField)) {
      sb.append(StringPool.SPACE);
      sb.append(namesMap.get(userNameField));
    }
  }
  return sb.toString();
}
