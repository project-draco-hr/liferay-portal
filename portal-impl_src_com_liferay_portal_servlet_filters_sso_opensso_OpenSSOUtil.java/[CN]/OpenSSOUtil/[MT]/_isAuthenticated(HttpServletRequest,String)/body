{
  boolean authenticated=false;
  String[] cookieNames=_getCookieNames(serviceUrl);
  int cookieCount=0;
  for (  String cookieName : cookieNames) {
    if (CookieUtil.get(request,cookieName) != null) {
      cookieCount++;
    }
  }
  if (cookieCount == 0) {
    if (_log.isWarnEnabled()) {
      _log.warn("Request has no SSO cookies. User is not logged in.");
    }
    return false;
  }
  String url=serviceUrl + _VALIDATE_TOKEN;
  URL urlObj=new URL(url);
  HttpURLConnection urlc=(HttpURLConnection)urlObj.openConnection();
  urlc.setDoOutput(true);
  urlc.setRequestMethod("POST");
  urlc.setRequestProperty("Content-type","application/x-www-form-urlencoded");
  _setCookieProperty(request,urlc,cookieNames);
  OutputStreamWriter osw=new OutputStreamWriter(urlc.getOutputStream());
  osw.write("dummy");
  osw.flush();
  int responseCode=urlc.getResponseCode();
  if (responseCode == HttpURLConnection.HTTP_OK) {
    String data=StringUtil.read(urlc.getInputStream());
    if (data.toLowerCase().indexOf("boolean=true") != -1) {
      authenticated=true;
    }
  }
 else   if (_log.isDebugEnabled()) {
    _log.debug("Authentication response code " + responseCode);
  }
  return authenticated;
}
