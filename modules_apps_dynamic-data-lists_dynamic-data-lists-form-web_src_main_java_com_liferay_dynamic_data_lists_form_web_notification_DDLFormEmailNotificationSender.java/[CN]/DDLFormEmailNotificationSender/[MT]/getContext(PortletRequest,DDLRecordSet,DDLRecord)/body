{
  Map<String,Serializable> context=new HashMap<>();
  DDMStructure ddmStructure=recordSet.getDDMStructure();
  String emailFromAddress=DDLFormEmailNotificationUtil.getEmailFromAddress(recordSet);
  String emailFromName=DDLFormEmailNotificationUtil.getEmailFromName(recordSet);
  Locale locale=ddmStructure.getDDMForm().getDefaultLocale();
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Group siteGroup=themeDisplay.getSiteGroup();
  String portalUrl=PortalUtil.getPortalURL(portletRequest);
  context.put("formName",recordSet.getName(locale));
  context.put("siteName",siteGroup.getName(locale));
  context.put("formFieldsValues",getSerializedDDMFormValues(record));
  context.put("fromName",emailFromName);
  context.put("fromAddress",emailFromAddress);
  context.put("portalUrl",portalUrl);
  return context;
}
