{
  SocketChannel[] peerSocketChannels=IntrabandTestUtil.createSocketChannelPeers();
  SocketChannel socketChannel=peerSocketChannels[0];
  socketChannel.configureBlocking(true);
  try {
    FutureRegistrationReference futureRegistrationReference=(FutureRegistrationReference)_executorIntraband.registerChannel(socketChannel);
    Assert.assertSame(_executorIntraband,futureRegistrationReference.getIntraband());
    Assert.assertTrue(futureRegistrationReference.isValid());
    futureRegistrationReference.cancelRegistration();
    Assert.assertFalse(futureRegistrationReference.isValid());
  }
  finally {
    peerSocketChannels[0].close();
    peerSocketChannels[1].close();
  }
}
