{
  if (resourcePath.startsWith(Http.HTTP) || resourcePath.startsWith(Http.HTTPS)) {
    int pos=resourcePath.indexOf(Http.PROTOCOL_DELIMITER);
    resourcePath=resourcePath.substring(pos + 3);
  }
  int pos=resourcePath.indexOf(StringPool.SLASH);
  if (pos != -1) {
    resourcePath=resourcePath.substring(pos);
  }
  if (cache) {
    Long lastModified=(Long)servletContext.getAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + resourcePath);
    if (lastModified != null) {
      return lastModified.longValue();
    }
  }
  long lastModified=0;
  Set<String> resourcePaths=servletContext.getResourcePaths(resourcePath);
  if (resourcePaths != null) {
    for (    String curResourcePath : resourcePaths) {
      if (curResourcePath.endsWith(StringPool.SLASH)) {
        long curLastModified=getLastModified(servletContext,curResourcePath);
        if (curLastModified > lastModified) {
          lastModified=curLastModified;
        }
      }
 else {
        File file=new File(servletContext.getRealPath(curResourcePath));
        if (file.lastModified() > lastModified) {
          lastModified=file.lastModified();
        }
      }
    }
  }
  if (cache) {
    servletContext.setAttribute(ServletContextUtil.class.getName() + StringPool.PERIOD + resourcePath,new Long(lastModified));
  }
  return lastModified;
}
