{
  _mockHttpServletRequest.setAttribute(WebKeys.SPI_AGENT_LIFECYCLE,SPIAgent.Lifecycle.EVENT);
  Event event=new EventImpl(null,null,null);
  _mockHttpServletRequest.setAttribute(WebKeys.SPI_AGENT_EVENT,event);
  Layout layout=new LayoutImpl();
  _mockHttpServletRequest.setAttribute(WebKeys.SPI_AGENT_LAYOUT,layout);
  _portalResiliencyAction.execute(null,null,_mockHttpServletRequest,_response);
  Assert.assertSame(_mockHttpServletRequest,_mockPortletContainer.request);
  Assert.assertSame(_response,_mockPortletContainer.response);
  Assert.assertSame(_portlet,_mockPortletContainer.portlet);
  Assert.assertSame(layout,_mockPortletContainer.layout);
  Assert.assertSame(event,_mockPortletContainer.event);
  Assert.assertSame(_mockPortletContainer.events,_mockHttpServletRequest.getAttribute(WebKeys.SPI_AGENT_EVENT_RESULT));
  Assert.assertNull(_mockHttpServletRequest.getAttribute(WebKeys.SPI_AGENT_LAYOUT_TYPE_SETTINGS));
  _mockPortletContainer.modifyLayoutTypeSettings=true;
  _mockHttpServletRequest.setParameter("p_p_id",_PORTLET_ID);
  _portalResiliencyAction.execute(null,null,_mockHttpServletRequest,_response);
  Assert.assertSame(_mockHttpServletRequest,_mockPortletContainer.request);
  Assert.assertSame(_response,_mockPortletContainer.response);
  Assert.assertSame(_portlet,_mockPortletContainer.portlet);
  Assert.assertSame(layout,_mockPortletContainer.layout);
  Assert.assertSame(event,_mockPortletContainer.event);
  Assert.assertSame(_mockPortletContainer.events,_mockHttpServletRequest.getAttribute(WebKeys.SPI_AGENT_EVENT_RESULT));
  Assert.assertEquals(MockPortletContainer.MOCK_LAYOUT_TYPE_SETTINGS,_mockHttpServletRequest.getAttribute(WebKeys.SPI_AGENT_LAYOUT_TYPE_SETTINGS));
}
