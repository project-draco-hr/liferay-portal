{
  _request.setAttribute(WebKeys.SPI_AGENT_LIFECYCLE,SPIAgent.Lifecycle.EVENT);
  Event event=new EventImpl(null,null,null);
  _request.setAttribute(WebKeys.SPI_AGENT_EVENT,event);
  Layout layout=new LayoutImpl();
  _request.setAttribute(WebKeys.SPI_AGENT_LAYOUT,layout);
  _portalResiliencyAction.execute(null,null,_request,_response);
  Assert.assertSame(_request,_mockPortletContainer.request);
  Assert.assertSame(_response,_mockPortletContainer.response);
  Assert.assertSame(_portlet,_mockPortletContainer.portlet);
  Assert.assertSame(layout,_mockPortletContainer.layout);
  Assert.assertSame(event,_mockPortletContainer.event);
  Assert.assertSame(_mockPortletContainer.events,_request.getAttribute(WebKeys.SPI_AGENT_EVENT_RESULT));
  Assert.assertNull(_request.getAttribute(WebKeys.SPI_AGENT_LAYOUT_TYPE_SETTINGS));
  _mockPortletContainer.modifyLayoutTypeSettings=true;
  _request.setParameter("p_p_id",_PORTLET_ID);
  _portalResiliencyAction.execute(null,null,_request,_response);
  Assert.assertSame(_request,_mockPortletContainer.request);
  Assert.assertSame(_response,_mockPortletContainer.response);
  Assert.assertSame(_portlet,_mockPortletContainer.portlet);
  Assert.assertSame(layout,_mockPortletContainer.layout);
  Assert.assertSame(event,_mockPortletContainer.event);
  Assert.assertSame(_mockPortletContainer.events,_request.getAttribute(WebKeys.SPI_AGENT_EVENT_RESULT));
  Assert.assertEquals(MockPortletContainer.MOCK_LAYOUT_TYPE_SETTINGS,_request.getAttribute(WebKeys.SPI_AGENT_LAYOUT_TYPE_SETTINGS));
}
