{
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=(Layout)request.getAttribute(WebKeys.LAYOUT);
  PortletMode portletMode=PortletModeFactory.getPortletMode(ParamUtil.getString(request,"p_p_mode"));
  return PortletPermissionUtil.hasAccessPermission(permissionChecker,themeDisplay.getScopeGroupId(),layout,portlet,portletMode);
}
