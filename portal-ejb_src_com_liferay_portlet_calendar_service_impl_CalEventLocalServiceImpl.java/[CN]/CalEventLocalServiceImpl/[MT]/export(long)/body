{
  net.fortuna.ical4j.model.Calendar cal=exportICal4j(eventId);
  OutputStream os=null;
  try {
    File file=File.createTempFile("CalEvent." + eventId,".ics");
    os=new BufferedOutputStream(new FileOutputStream(file.getPath()));
    CalendarOutputter calOutput=new CalendarOutputter();
    calOutput.output(cal,os);
    return file;
  }
 catch (  Exception e) {
    _log.error(e,e);
    throw new SystemException(e);
  }
 finally {
    ServletResponseUtil.cleanUp(os);
  }
}
