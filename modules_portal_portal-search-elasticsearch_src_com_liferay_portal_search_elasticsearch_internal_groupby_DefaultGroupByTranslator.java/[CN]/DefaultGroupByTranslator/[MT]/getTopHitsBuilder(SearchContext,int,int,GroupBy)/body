{
  TopHitsBuilder topHitsBuilder=AggregationBuilders.topHits(TOP_HITS_AGGREGATION_NAME);
  int groupyByStart=groupBy.getStart();
  if (groupyByStart == 0) {
    groupyByStart=start;
  }
  topHitsBuilder.setFrom(groupyByStart);
  int groupBySize=groupBy.getSize();
  if (groupBySize == 0) {
    groupBySize=end - start + 1;
  }
  topHitsBuilder.setSize(groupBySize);
  addHighlights(topHitsBuilder,searchContext.getQueryConfig());
  addSorts(topHitsBuilder,searchContext.getSorts());
  return topHitsBuilder;
}
