{
  OAuthConsumer oAuthConsumer=null;
  try {
    oAuthConsumer=OAuthConsumerLocalServiceUtil.fetchOAuthConsumer(securityToken.getAppId(),serviceName);
  }
 catch (  SystemException se) {
    throw new GadgetException(GadgetException.Code.INTERNAL_SERVER_ERROR,se);
  }
  if (oAuthConsumer == null) {
    return _oAuthConsumer;
  }
  if (oAuthConsumer.getKeyType().equals(OAuthConsumerConstants.KEY_TYPE_RSA_PRIVATE)) {
    if (_oAuthConsumer == null) {
      throw new GadgetException(GadgetException.Code.INTERNAL_SERVER_ERROR,"No OAuth key specified");
    }
    oAuthConsumer.setConsumerSecret(_oAuthConsumer.getConsumerSecret());
  }
  return oAuthConsumer;
}
