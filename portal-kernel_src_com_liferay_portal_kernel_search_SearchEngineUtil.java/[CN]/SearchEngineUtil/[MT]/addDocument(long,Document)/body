{
  if (isMessageBusListener()) {
    _instance._messageBusIndexWriter.addDocument(companyId,doc);
  }
 else {
    ClassLoader contextClassLoader=_setSearchEngineClassLoader();
    try {
      _instance._getWriter().addDocument(companyId,doc);
    }
  finally {
      _setContextClassLoader(contextClassLoader);
    }
  }
}
