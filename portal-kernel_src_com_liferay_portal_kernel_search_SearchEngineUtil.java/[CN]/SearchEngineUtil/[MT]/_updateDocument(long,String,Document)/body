{
  ClassLoader contextClassLoader=_getContextClassLoader();
  try {
    if (_currentSearchEngine.isMessageBusListener()) {
      _messageBusIndexWriter.updateDocument(companyId,uid,doc);
    }
 else {
      _getWriter().updateDocument(companyId,uid,doc);
    }
  }
  finally {
    _setContextClassLoader(contextClassLoader);
  }
}
