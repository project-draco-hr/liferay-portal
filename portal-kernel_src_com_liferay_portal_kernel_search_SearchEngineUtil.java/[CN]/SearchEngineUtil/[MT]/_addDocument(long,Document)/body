{
  ClassLoader contextClassLoader=_getContextClassLoader();
  try {
    if (_currentSearchEngine.isMessageBusListener()) {
      _messageBusIndexWriter.addDocument(companyId,doc);
    }
 else {
      _getWriter().addDocument(companyId,doc);
    }
  }
  finally {
    _setContextClassLoader(contextClassLoader);
  }
}
