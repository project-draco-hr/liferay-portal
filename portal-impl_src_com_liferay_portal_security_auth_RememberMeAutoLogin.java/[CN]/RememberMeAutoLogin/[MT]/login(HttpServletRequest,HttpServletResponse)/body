{
  try {
    String[] credentials=null;
    String autoUserId=CookieKeys.getCookie(request,CookieKeys.ID);
    String autoPassword=CookieKeys.getCookie(request,CookieKeys.PASSWORD);
    String rememberMe=CookieKeys.getCookie(request,CookieKeys.REMEMBER_ME);
    if (!PortalUtil.getPathContext().equals(request.getContextPath())) {
      rememberMe=Boolean.TRUE.toString();
    }
    if (Validator.isNotNull(autoUserId) && Validator.isNotNull(autoPassword) && Validator.isNotNull(rememberMe)) {
      Company company=PortalUtil.getCompany(request);
      KeyValuePair kvp=null;
      if (company.isAutoLogin()) {
        kvp=UserLocalServiceUtil.decryptUserId(company.getCompanyId(),autoUserId,autoPassword);
        credentials=new String[3];
        credentials[0]=kvp.getKey();
        credentials[1]=kvp.getValue();
        credentials[2]=Boolean.FALSE.toString();
      }
    }
    return credentials;
  }
 catch (  Exception e) {
    _log.warn(e,e);
    Cookie cookie=new Cookie(CookieKeys.ID,StringPool.BLANK);
    cookie.setMaxAge(0);
    cookie.setPath(StringPool.SLASH);
    CookieKeys.addCookie(request,response,cookie);
    cookie=new Cookie(CookieKeys.PASSWORD,StringPool.BLANK);
    cookie.setMaxAge(0);
    cookie.setPath(StringPool.SLASH);
    CookieKeys.addCookie(request,response,cookie);
    throw new AutoLoginException(e);
  }
}
