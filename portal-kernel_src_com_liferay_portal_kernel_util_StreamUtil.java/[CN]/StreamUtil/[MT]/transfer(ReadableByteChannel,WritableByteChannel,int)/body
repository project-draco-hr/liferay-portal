{
  ByteBuffer byteBuffer=ByteBuffer.allocateDirect(bufferSize);
  while (readableByteChannel.read(byteBuffer) != -1) {
    byteBuffer.flip();
    writableByteChannel.write(byteBuffer);
    byteBuffer.compact();
  }
  byteBuffer.flip();
  while (byteBuffer.hasRemaining()) {
    writableByteChannel.write(byteBuffer);
  }
}
