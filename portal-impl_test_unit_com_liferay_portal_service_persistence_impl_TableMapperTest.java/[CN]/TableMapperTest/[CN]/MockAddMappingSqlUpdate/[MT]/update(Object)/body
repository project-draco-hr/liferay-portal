{
  Assert.assertEquals(3,params.length);
  Assert.assertSame(Long.class,params[0].getClass());
  Assert.assertSame(Long.class,params[1].getClass());
  Assert.assertSame(Long.class,params[2].getClass());
  Long companyId=(Long)params[0];
  Long leftPrimaryKey=(Long)params[1];
  Long rightPrimaryKey=(Long)params[2];
  Map<Long,long[]> mappingStore=getMappingStore(companyId);
  long[] rightPrimaryKeys=mappingStore.get(leftPrimaryKey);
  if (rightPrimaryKeys == null) {
    rightPrimaryKeys=new long[1];
    rightPrimaryKeys[0]=rightPrimaryKey;
    mappingStore.put(leftPrimaryKey,rightPrimaryKeys);
  }
 else   if (ArrayUtil.contains(rightPrimaryKeys,rightPrimaryKey)) {
    throw new RuntimeException("Unique key violation for left primary key " + leftPrimaryKey + " and right primary key "+ rightPrimaryKey);
  }
 else {
    rightPrimaryKeys=ArrayUtil.append(rightPrimaryKeys,rightPrimaryKey);
    mappingStore.put(leftPrimaryKey,rightPrimaryKeys);
  }
  return 1;
}
