{
  String registrationHandle=KeyGenerator.generateKey();
  String consumerModes=_getCommaSeperatedString(registrationRecord.getConsumerModes());
  String consumerWindowStates=_getCommaSeperatedString(registrationRecord.getConsumerWindowStates());
  String customUserProfileData=_getCommaSeperatedString(registrationRecord.getCustomUserProfileData());
  String consumerUserScopes=_getCommaSeperatedString(registrationRecord.getConsumerUserScopes());
  String registrationProperties=null;
  String lifeTime=null;
  if (registrationRecord.getLifetime() != null) {
    LeaseTime leaseTime=registrationRecord.getLifetime();
    if (leaseTime.getTerminationTime() != null) {
      lifeTime=registrationRecord.getLifetime().getTerminationTime().toXMLFormat();
    }
  }
  try {
    WSRPConsumerRegistrationLocalServiceUtil.addConsumerRegistration(registrationRecord.getConsumerName(),registrationRecord.isEnabled(),registrationHandle,registrationRecord.getConsumerAgent(),registrationRecord.isMethodGetSupported(),consumerModes,consumerWindowStates,consumerUserScopes,customUserProfileData,registrationProperties,lifeTime,_wsrpProducer.getInstanceName());
  }
 catch (  Exception e) {
    throw new ProducerException(e);
  }
  return registrationHandle;
}
