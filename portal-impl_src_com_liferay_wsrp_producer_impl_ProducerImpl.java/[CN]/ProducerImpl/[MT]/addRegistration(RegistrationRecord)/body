{
  String registrationHandle=KeyGenerator.generateKey();
  String consumerModes=StringUtil.merge(registrationRecord.getConsumerModes());
  String consumerWindowStates=StringUtil.merge(registrationRecord.getConsumerWindowStates());
  String customUserProfileData=StringUtil.merge(registrationRecord.getCustomUserProfileData());
  String consumerUserScopes=StringUtil.merge(registrationRecord.getConsumerUserScopes());
  String registrationProperties=null;
  String lifetime=getLifeTimeString(registrationRecord.getLifetime());
  try {
    WSRPConsumerRegistrationLocalServiceUtil.addConsumerRegistration(registrationRecord.getConsumerName(),true,registrationHandle,registrationRecord.getConsumerAgent(),registrationRecord.isMethodGetSupported(),consumerModes,consumerWindowStates,consumerUserScopes,customUserProfileData,registrationProperties,lifetime,_producerModel.getInstanceName());
  }
 catch (  Exception e) {
    throw new ProducerException(e);
  }
  return registrationHandle;
}
