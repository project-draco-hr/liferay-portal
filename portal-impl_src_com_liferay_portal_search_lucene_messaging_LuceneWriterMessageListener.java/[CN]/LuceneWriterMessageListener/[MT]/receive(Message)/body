{
  try {
    SearchRequest searchRequest=(SearchRequest)message.getPayload();
    String command=searchRequest.getCommand();
    long companyId=searchRequest.getCompanyId();
    String id=searchRequest.getId();
    Document doc=searchRequest.getDocument();
    if (command.equals(SearchRequest.COMMAND_ADD)) {
      LuceneSearchEngineUtil.addDocument(companyId,doc);
    }
 else     if (command.equals(SearchRequest.COMMAND_DELETE)) {
      LuceneSearchEngineUtil.deleteDocument(companyId,id);
    }
 else     if (command.equals(SearchRequest.COMMAND_DELETE_PORTLET_DOCS)) {
      LuceneSearchEngineUtil.deletePortletDocuments(companyId,id);
    }
 else     if (command.equals(SearchRequest.COMMAND_UPDATE)) {
      LuceneSearchEngineUtil.updateDocument(companyId,id,doc);
    }
  }
 catch (  SearchException e) {
    if (_log.isErrorEnabled()) {
      _log.error("Unable to process request: " + message,e);
    }
  }
}
