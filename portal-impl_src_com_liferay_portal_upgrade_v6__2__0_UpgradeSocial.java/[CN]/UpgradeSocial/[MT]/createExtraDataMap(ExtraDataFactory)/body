{
  Map<Long,String> extraDataMap=new HashMap<>();
  StringBundler sb=new StringBundler(4);
  sb.append("select activityId, groupId, companyId, userId, ");
  sb.append("classNameId, classPK, type_, extraData from ");
  sb.append("SocialActivity where ");
  sb.append(extraDataFactory.getActivitySQLWhereClause());
  try (PreparedStatement ps=connection.prepareStatement(sb.toString())){
    extraDataFactory.setActivitySQLParameters(ps);
    try (ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        long activityId=rs.getLong("activityId");
        long classNameId=rs.getLong("classNameId");
        long classPK=rs.getLong("classPK");
        long companyId=rs.getLong("companyId");
        String extraData=rs.getString("extraData");
        long groupId=rs.getLong("groupId");
        int type=rs.getInt("type_");
        long userId=rs.getLong("userId");
        String newExtraData=createExtraData(extraDataFactory,groupId,companyId,userId,classNameId,classPK,type,extraData);
        if (newExtraData != null) {
          extraDataMap.put(activityId,newExtraData);
        }
      }
    }
   }
   return extraDataMap;
}
