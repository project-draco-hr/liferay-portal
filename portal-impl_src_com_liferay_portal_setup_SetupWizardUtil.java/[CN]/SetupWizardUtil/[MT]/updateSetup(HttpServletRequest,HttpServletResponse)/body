{
  UnicodeProperties unicodeProperties=PropertiesParamUtil.getProperties(request,_PROPERTIES_PREFIX);
  unicodeProperties.setProperty(PropsKeys.LIFERAY_HOME,SystemProperties.get(PropsKeys.LIFERAY_HOME));
  boolean databaseConfigured=_isDatabaseConfigured(unicodeProperties);
  _processDatabaseProperties(request,unicodeProperties,databaseConfigured);
  updateLanguage(request,response);
  unicodeProperties.put(PropsKeys.SETUP_WIZARD_ENABLED,String.valueOf(false));
  PropsUtil.addProperties(unicodeProperties);
  if (!databaseConfigured) {
    _reloadServletContext(request,unicodeProperties);
  }
  _updateCompany(request);
  _updateAdminUser(request,response,unicodeProperties);
  _initPlugins();
  if (ParamUtil.getBoolean(request,"addSampleData")) {
    SetupWizardSampleDataUtil.addSampleData(PortalInstances.getDefaultCompanyId());
  }
  HttpSession session=request.getSession();
  session.setAttribute(WebKeys.SETUP_WIZARD_PROPERTIES,unicodeProperties);
  session.setAttribute(WebKeys.SETUP_WIZARD_PROPERTIES_FILE_CREATED,_writePropertiesFile(unicodeProperties));
}
