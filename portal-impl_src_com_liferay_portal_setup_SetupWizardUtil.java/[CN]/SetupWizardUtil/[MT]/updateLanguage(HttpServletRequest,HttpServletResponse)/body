{
  String languageId=_getParameter(request,PropsKeys.COMPANY_DEFAULT_LOCALE,PropsValues.COMPANY_DEFAULT_LOCALE);
  Locale locale=LocaleUtil.fromLanguageId(languageId);
  List<Locale> availableLocales=ListUtil.fromArray(LanguageUtil.getAvailableLocales());
  if (!availableLocales.contains(locale)) {
    return;
  }
  PropsValues.COMPANY_DEFAULT_LOCALE=languageId;
  HttpSession session=request.getSession();
  session.setAttribute(Globals.LOCALE_KEY,locale);
  session.setAttribute(WebKeys.SETUP_WIZARD_DEFAULT_LOCALE,languageId);
  LanguageUtil.updateCookie(request,response,locale);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  themeDisplay.setLanguageId(languageId);
  themeDisplay.setLocale(locale);
}
