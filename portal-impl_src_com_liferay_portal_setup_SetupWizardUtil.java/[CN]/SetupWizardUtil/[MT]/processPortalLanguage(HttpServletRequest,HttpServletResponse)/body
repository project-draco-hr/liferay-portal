{
  String languageId=_getParameter(request,PropsKeys.DEFAULT_LOCALE,PropsValues.DEFAULT_LOCALE);
  Locale locale=LocaleUtil.fromLanguageId(languageId);
  List<Locale> availableLocales=ListUtil.fromArray(LanguageUtil.getAvailableLocales());
  if (availableLocales.contains(locale)) {
    request.getSession().setAttribute(Globals.LOCALE_KEY,locale);
    LanguageUtil.updateCookie(request,response,locale);
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    themeDisplay.setLanguageId(languageId);
    themeDisplay.setLocale(locale);
  }
}
