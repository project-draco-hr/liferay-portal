{
  Collection<ServiceReference<PermissionCheckerFactory>> permissionCheckerFactoryServiceReferences=_bundleContext.getServiceReferences(PermissionCheckerFactory.class,"(!(component.name=" + StagingPermissionCheckerFactory.class.getName() + "))");
  if (permissionCheckerFactoryServiceReferences.isEmpty()) {
    return null;
  }
  ServiceReference<PermissionCheckerFactory> permissionCheckerFactoryServiceReference=permissionCheckerFactoryServiceReferences.iterator().next();
  PermissionCheckerFactory permissionCheckerFactory=_bundleContext.getService(permissionCheckerFactoryServiceReference);
  try {
    PermissionChecker permissionChecker=permissionCheckerFactory.create(user);
    return new StagingPermissionChecker(permissionChecker);
  }
  finally {
    _bundleContext.ungetService(permissionCheckerFactoryServiceReference);
  }
}
