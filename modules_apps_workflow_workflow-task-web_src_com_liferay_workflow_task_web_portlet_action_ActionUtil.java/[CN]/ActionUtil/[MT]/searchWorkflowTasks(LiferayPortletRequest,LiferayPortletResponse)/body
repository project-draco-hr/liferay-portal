{
  String tabs=ParamUtil.getString(request,_TABS1,_PENDING);
  String[] assetTypes=WorkflowHandlerUtil.getSearchableAssetTypes();
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Company company=themeDisplay.getCompany();
  User user=themeDisplay.getUser();
  PortletURL currentURLObj=PortletURLUtil.getCurrent(request,response);
  List<WorkflowTask> tasks=new ArrayList<>();
  if (tabs.equals(_COMPLETED)) {
    List<WorkflowTask> workflowTasks=searchTasksAssignedToMe(request,company,user,currentURLObj,assetTypes,true);
    tasks.addAll(workflowTasks);
  }
 else   if (tabs.equals(_PENDING)) {
    List<WorkflowTask> workflowTasks=searchPendingTasksAssignedToMyRoles(request,company,user,currentURLObj,assetTypes);
    tasks.addAll(workflowTasks);
    workflowTasks=searchTasksAssignedToMe(request,company,user,currentURLObj,assetTypes,false);
    tasks.addAll(workflowTasks);
  }
  WorkflowTaskViewDisplayContext displayContext=new WorkflowTaskViewDisplayContext(request,response,tasks);
  request.setAttribute(WebKeys.WORKFLOW_TASK_DISPLAY_CONTEXT,displayContext);
}
