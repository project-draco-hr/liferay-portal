{
  FirefoxProfile firefoxProfile=new FirefoxProfile();
  try {
    File file=new File(StringPool.PERIOD);
    String absolutePath=file.getAbsolutePath();
    if (absolutePath.endsWith(StringPool.PERIOD)) {
      absolutePath=absolutePath.substring(0,absolutePath.length() - 1);
      absolutePath=StringUtil.replace(absolutePath,StringPool.BACK_SLASH,StringPool.FORWARD_SLASH);
    }
    firefoxProfile.addExtension(WebDriverUtil.class,"/META-INF/resources/firefox/extensions/jserrorcollector.xpi");
  }
 catch (  Exception e) {
  }
  String outputDirName=PropsValues.OUTPUT_DIR_NAME;
  if (OSDetector.isWindows()) {
    outputDirName=StringUtil.replace(outputDirName,StringPool.FORWARD_SLASH,StringPool.BACK_SLASH);
  }
  firefoxProfile.setPreference("browser.download.dir",outputDirName);
  firefoxProfile.setPreference("browser.download.folderList",2);
  firefoxProfile.setPreference("browser.download.manager.showWhenStarting",false);
  firefoxProfile.setPreference("browser.download.useDownloadDir",true);
  firefoxProfile.setPreference("browser.helperApps.alwaysAsk.force",false);
  firefoxProfile.setPreference("browser.helperApps.neverAsk.saveToDisk","application/excel,application/msword,application/pdf," + "application/zip,audio/mpeg3,image/jpeg,image/png,text/plain");
  firefoxProfile.setPreference("dom.max_chrome_script_run_time",300);
  firefoxProfile.setPreference("dom.max_script_run_time",300);
  return new FirefoxDriver(firefoxProfile);
}
