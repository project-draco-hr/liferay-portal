{
  if (!WorkflowEngineManagerUtil.isDeployed()) {
    throw new NoSuchWorkflowDefinitionLinkException();
  }
  long classNameId=PortalUtil.getClassNameId(className);
  WorkflowDefinitionLink workflowDefinitionLink=null;
  if (groupId > 0) {
    Group group=groupLocalService.getGroup(groupId);
    if (group.isLayout()) {
      groupId=group.getParentGroupId();
    }
  }
  workflowDefinitionLink=workflowDefinitionLinkPersistence.fetchByG_C_C_C_T(groupId,companyId,classNameId,classPK,typePK);
  if (!strict && (workflowDefinitionLink == null)) {
    workflowDefinitionLink=workflowDefinitionLinkPersistence.fetchByG_C_C_C_T(WorkflowConstants.DEFAULT_GROUP_ID,companyId,classNameId,classPK,typePK);
  }
  if (workflowDefinitionLink == null) {
    throw new NoSuchWorkflowDefinitionLinkException("No workflow for groupId=" + groupId + ", companyId="+ companyId+ " and classNameId="+ classNameId);
  }
  return workflowDefinitionLink;
}
