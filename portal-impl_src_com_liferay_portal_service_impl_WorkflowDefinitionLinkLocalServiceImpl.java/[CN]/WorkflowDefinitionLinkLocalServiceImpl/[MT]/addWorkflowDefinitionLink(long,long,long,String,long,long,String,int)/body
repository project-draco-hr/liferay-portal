{
  User user=userPersistence.findByPrimaryKey(userId);
  groupId=StagingUtil.getLiveGroupId(groupId);
  long classNameId=classNameLocalService.getClassNameId(className);
  Date now=new Date();
  long workflowDefinitionLinkId=counterLocalService.increment();
  WorkflowDefinitionLink workflowDefinitionLink=workflowDefinitionLinkPersistence.create(workflowDefinitionLinkId);
  workflowDefinitionLink.setCreateDate(now);
  workflowDefinitionLink.setModifiedDate(now);
  workflowDefinitionLink.setUserId(userId);
  workflowDefinitionLink.setUserName(user.getFullName());
  workflowDefinitionLink.setGroupId(groupId);
  workflowDefinitionLink.setCompanyId(companyId);
  workflowDefinitionLink.setClassNameId(classNameId);
  workflowDefinitionLink.setClassPK(classPK);
  workflowDefinitionLink.setTypePK(typePK);
  workflowDefinitionLink.setWorkflowDefinitionName(workflowDefinitionName);
  workflowDefinitionLink.setWorkflowDefinitionVersion(workflowDefinitionVersion);
  workflowDefinitionLinkPersistence.update(workflowDefinitionLink);
  return workflowDefinitionLink;
}
