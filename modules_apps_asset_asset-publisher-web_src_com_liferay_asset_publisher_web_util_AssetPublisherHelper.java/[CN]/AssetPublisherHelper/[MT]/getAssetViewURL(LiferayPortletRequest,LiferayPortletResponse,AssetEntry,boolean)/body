{
  PortletURL viewFullContentURL=liferayPortletResponse.createRenderURL();
  viewFullContentURL.setParameter("mvcPath","/view_content.jsp");
  viewFullContentURL.setParameter("assetEntryId",String.valueOf(assetEntry.getEntryId()));
  AssetRendererFactory<?> assetRendererFactory=assetEntry.getAssetRendererFactory();
  AssetRenderer<?> assetRenderer=assetEntry.getAssetRenderer();
  viewFullContentURL.setParameter("type",assetRendererFactory.getType());
  ThemeDisplay themeDisplay=(ThemeDisplay)liferayPortletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (Validator.isNotNull(assetRenderer.getUrlTitle())) {
    if (assetRenderer.getGroupId() != themeDisplay.getScopeGroupId()) {
      viewFullContentURL.setParameter("groupId",String.valueOf(assetRenderer.getGroupId()));
    }
    viewFullContentURL.setParameter("urlTitle",assetRenderer.getUrlTitle());
  }
  String viewURL=null;
  String currentURL=null;
  if (viewInContext) {
    currentURL=PortalUtil.getCurrentURL(liferayPortletRequest);
    String viewFullContentURLString=viewFullContentURL.toString();
    viewFullContentURLString=HttpUtil.setParameter(viewFullContentURLString,"redirect",currentURL);
    try {
      viewURL=assetRenderer.getURLViewInContext(liferayPortletRequest,liferayPortletResponse,viewFullContentURLString);
    }
 catch (    Exception e) {
    }
  }
 else {
    PortletURL currentURLObj=PortletURLUtil.getCurrent(liferayPortletRequest,liferayPortletResponse);
    currentURL=currentURLObj.toString();
  }
  if (Validator.isNull(viewURL)) {
    viewURL=viewFullContentURL.toString();
  }
  viewURL=AssetUtil.checkViewURL(assetEntry,viewInContext,viewURL,currentURL,themeDisplay);
  return viewURL;
}
