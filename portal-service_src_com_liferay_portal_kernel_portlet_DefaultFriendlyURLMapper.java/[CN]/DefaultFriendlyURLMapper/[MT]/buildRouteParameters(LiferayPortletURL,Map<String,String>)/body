{
  Map<String,String[]> portletURLParameters=liferayPortletURL.getParameterMap();
  for (  Map.Entry<String,String[]> entry : portletURLParameters.entrySet()) {
    String[] values=entry.getValue();
    if (values.length > 0) {
      routeParameters.put(entry.getKey(),values[0]);
    }
  }
  if (isPortletInstanceable()) {
    String portletId=liferayPortletURL.getPortletId();
    routeParameters.put("p_p_id",portletId);
    if (Validator.isNotNull(portletId)) {
      int index1=portletId.indexOf(PortletConstants.INSTANCE_SEPARATOR);
      if (index1 != -1) {
        int start=index1 + PortletConstants.INSTANCE_SEPARATOR.length();
        int index2=portletId.indexOf(portletId,start);
        if (index2 != -1) {
          routeParameters.put("instanceId",portletId.substring(start,index2));
        }
 else {
          routeParameters.put("instanceId",portletId.substring(start));
        }
      }
    }
  }
  routeParameters.putAll(liferayPortletURL.getReservedParameterMap());
}
