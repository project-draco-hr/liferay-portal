{
  Map<String,String[]> portletURLParameters=liferayPortletURL.getParameterMap();
  for (  Map.Entry<String,String[]> entry : portletURLParameters.entrySet()) {
    String[] values=entry.getValue();
    if (values.length > 0) {
      routeParameters.put(entry.getKey(),values[0]);
    }
  }
  if (isPortletInstanceable()) {
    String portletId=liferayPortletURL.getPortletId();
    routeParameters.put("p_p_id",portletId);
    if (Validator.isNotNull(portletId)) {
      int x=portletId.indexOf(PortletConstants.INSTANCE_SEPARATOR);
      if (x != -1) {
        x+=PortletConstants.INSTANCE_SEPARATOR.length();
        String instanceId=null;
        int y=portletId.indexOf(portletId,x);
        if (y != -1) {
          instanceId=portletId.substring(x,y);
        }
 else {
          instanceId=portletId.substring(x);
        }
        routeParameters.put("instanceId",instanceId);
      }
    }
  }
  routeParameters.putAll(liferayPortletURL.getReservedParameterMap());
}
