{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String portletTitle=PortletConfigurationUtil.getPortletTitle(portletPreferences,themeDisplay.getLanguageId());
  if (Validator.isNull(portletTitle)) {
    ServletContext servletContext=(ServletContext)portletRequest.getAttribute(WebKeys.CTX);
    portletTitle=PortalUtil.getPortletTitle(portlet,servletContext,themeDisplay.getLocale());
  }
  return portletTitle;
}
