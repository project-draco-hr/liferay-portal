{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Layout layout=themeDisplay.getLayout();
  PortletPreferences preferences=PortletPreferencesFactoryUtil.getLayoutPortletSetup(layout,portlet.getPortletId());
  String scopeType=GetterUtil.getString(preferences.getValue("lfr-scope-type",null));
  if (Validator.isNull(scopeType)) {
    return null;
  }
  String scopeName=null;
  if (scopeType.equals("company")) {
    scopeName=themeDisplay.translate("global");
  }
 else   if (scopeType.equals("layout")) {
    String scopeLayoutUuid=GetterUtil.getString(preferences.getValue("lfrScopeLayoutUuid",null));
    try {
      Layout scopeLayout=LayoutLocalServiceUtil.getLayoutByUuidAndGroupId(scopeLayoutUuid,layout.getGroupId());
      scopeName=scopeLayout.getName(themeDisplay.getLocale());
    }
 catch (    NoSuchLayoutException nsle) {
    }
  }
 else {
    throw new IllegalArgumentException("Scope type " + scopeType + " is invalid");
  }
  return scopeName;
}
