{
  WSRPPortlets rootNode=getRootNode();
  if ((rootNode == null) || (rootNode.getWSRPPortlet().size() == 0)) {
    return Collections.EMPTY_LIST;
  }
  List<Portlet> portlets=new ArrayList<Portlet>();
  List<WSRPPortlet> wsrpPortlets=rootNode.getWSRPPortlet();
  for (  WSRPPortlet wsrpPortlet : wsrpPortlets) {
    String portletId=PortalUtil.getJsSafePortletId(wsrpPortlet.getPortletId());
    Portlet portlet=new PortletImpl(CompanyConstants.SYSTEM,portletId);
    portlet.setPortletId(portletId);
    portlet.setTimestamp(System.currentTimeMillis());
    portlet.setPortletName(portletId);
    portlet.setInstanceable(true);
    portlet.setActive(true);
    portlet.setRemote(true);
    portlet.setRemoteConsumerId(wsrpPortlet.getConsumerId());
    portlet.setRemoteProducerEntityId(wsrpPortlet.getProducerEntityId());
    portlet.setRemotePortletHandle(wsrpPortlet.getPortletHandle());
    portlet.setRemotePortletId(wsrpPortlet.getPortletHandle());
    List<MimeType> mimeTypes=wsrpPortlet.getMimeTypes();
    Map<String,Set<String>> portletModes=new HashMap<String,Set<String>>();
    for (    MimeType mimeType : mimeTypes) {
      Set<String> modes=new HashSet<String>(mimeType.getModes());
      portletModes.put(mimeType.getMime(),modes);
    }
    portlet.setPortletModes(portletModes);
    PortletInfo portletInfo=new PortletInfo(wsrpPortlet.getTitle(),wsrpPortlet.getShortTitle(),wsrpPortlet.getKeywords());
    portlet.setPortletInfo(portletInfo);
    portlets.add(portlet);
  }
  return portlets;
}
