{
  try {
    WSRPPortlet wsrpPortlet=WSRPPortletLocalServiceUtil.createWSRPPortlet(CounterServiceUtil.increment());
    PortletInfo portletInfo=portlet.getPortletInfo();
    wsrpPortlet.setChannelName(portlet.getPortletId());
    wsrpPortlet.setConsumerId(portlet.getRemoteConsumerId());
    wsrpPortlet.setDisplayName(portlet.getDisplayName());
    wsrpPortlet.setKeywords(portletInfo.getKeywords());
    wsrpPortlet.setPortletHandle(portlet.getRemotePortletHandle());
    wsrpPortlet.setName(portlet.getPortletId());
    wsrpPortlet.setProducerEntityId(portlet.getRemoteProducerEntityId());
    wsrpPortlet.setShortTitle(portletInfo.getShortTitle());
    wsrpPortlet.setStatus(portlet.isActive() ? 1 : 0);
    wsrpPortlet.setTitle(portletInfo.getTitle());
    Map<String,Set<String>> portletModes=portlet.getPortletModes();
    Set<String> mimeTypes=portletModes.keySet();
    MimeTypes mimeHolder=new MimeTypes();
    for (    String mimeType : mimeTypes) {
      Set<String> mimeTypeModes=portletModes.get(mimeType);
      MimeType mimeTypeModel=new MimeType();
      mimeTypeModel.setMime(mimeType);
      mimeTypeModel.getModes().addAll(mimeTypeModes);
      mimeHolder.getMimeType().add(mimeTypeModel);
    }
    wsrpPortlet.setMimeTypes(marshalMimeTypes(mimeHolder));
    WSRPPortletLocalServiceUtil.updateWSRPPortlet(wsrpPortlet);
  }
 catch (  SystemException ex) {
    throw new WSRPConsumerException(ex.getMessage(),ex);
  }
}
