{
  SyncFile syncFile=new SyncFile();
  syncFile.setChangeLog(changeLog);
  syncFile.setChecksum(checksum);
  syncFile.setDescription(description);
  syncFile.setFilePathName(filePathName);
  if (MSOfficeFileUtil.isLegacyExcelFile(Paths.get(filePathName))) {
    syncFile.setLocalExtraSetting("lastSavedDate",MSOfficeFileUtil.getLastSavedDate(Paths.get(filePathName)));
  }
  syncFile.setLocalSyncTime(System.currentTimeMillis());
  syncFile.setMimeType(mimeType);
  syncFile.setName(name);
  syncFile.setParentFolderId(parentFolderId);
  syncFile.setRepositoryId(repositoryId);
  syncFile.setSize(size);
  syncFile.setState(state);
  syncFile.setSyncAccountId(syncAccountId);
  syncFile.setType(type);
  _syncFilePersistence.create(syncFile);
  FileKeyUtil.writeFileKey(Paths.get(filePathName),String.valueOf(syncFile.getSyncFileId()),true);
  if (createChecksums) {
    IODeltaUtil.checksums(syncFile);
  }
  return syncFile;
}
