{
  try (LoggingTimer loggingTimer=new LoggingTimer()){
    String[] uninstanceablePortletIds=getUninstanceablePortletIds();
    for (    String portletId : uninstanceablePortletIds) {
      PortletInstance portletInstance=PortletInstance.fromPortletInstanceKey(portletId);
      if (portletInstance.hasInstanceId()) {
        if (_log.isWarnEnabled()) {
          _log.warn("Portlet " + portletId + " is already instanceable");
        }
        continue;
      }
      PortletInstance newPortletInstance=new PortletInstance(portletId);
      String newPortletInstanceKey=newPortletInstance.getPortletInstanceKey();
      updateGroup(portletId,newPortletInstanceKey);
      updateInstanceablePortletPreferences(portletId,newPortletInstanceKey);
      updateResourcePermission(portletId,newPortletInstanceKey,false);
      updateLayoutRevisions(portletId,newPortletInstanceKey,true);
      updateLayouts(portletId,newPortletInstanceKey,true);
    }
  }
 }
