{
  String sql="select plid, typeSettings from Layout where " + getTypeSettingsCriteria(oldRootPortletId);
  try (PreparedStatement ps=connection.prepareStatement(sql);ResultSet rs=ps.executeQuery()){
    while (rs.next()) {
      long plid=rs.getLong("plid");
      String typeSettings=rs.getString("typeSettings");
      List<String> layoutColumns=_getLayoutColumns();
      layoutColumns.addAll(_getNestedPortletColumns(typeSettings));
      String newTypeSettings=getNewTypeSettings(typeSettings,oldRootPortletId,newRootPortletId,layoutColumns,exactMatch);
      updateLayout(plid,newTypeSettings);
    }
  }
 }
