{
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(portletRequest);
  long groupId=ParamUtil.getLong(uploadPortletRequest,"groupId");
  long classNameId=ParamUtil.getLong(uploadPortletRequest,"classNameId");
  long classPK=ParamUtil.getLong(uploadPortletRequest,"classPK");
  long resourceClassNameId=ParamUtil.getLong(uploadPortletRequest,"resourceClassNameId");
  String templateKey=ParamUtil.getString(uploadPortletRequest,"templateKey");
  Map<Locale,String> nameMap=LocalizationUtil.getLocalizationMap(uploadPortletRequest,"name");
  Map<Locale,String> descriptionMap=LocalizationUtil.getLocalizationMap(uploadPortletRequest,"description");
  String type=ParamUtil.getString(uploadPortletRequest,"type");
  String mode=ParamUtil.getString(uploadPortletRequest,"mode");
  String language=ParamUtil.getString(uploadPortletRequest,"language",TemplateConstants.LANG_TYPE_VM);
  String script=getScript(uploadPortletRequest);
  boolean cacheable=ParamUtil.getBoolean(uploadPortletRequest,"cacheable");
  boolean smallImage=ParamUtil.getBoolean(uploadPortletRequest,"smallImage");
  String smallImageURL=ParamUtil.getString(uploadPortletRequest,"smallImageURL");
  File smallImageFile=uploadPortletRequest.getFile("smallImageFile");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(DDMTemplate.class.getName(),uploadPortletRequest);
  return _ddmTemplateService.addTemplate(groupId,classNameId,classPK,resourceClassNameId,templateKey,nameMap,descriptionMap,type,mode,language,script,cacheable,smallImage,smallImageURL,smallImageFile,serviceContext);
}
