{
  MultiThreadedHttpConnectionManager connectionManager=new MultiThreadedHttpConnectionManager();
  HttpConnectionParams params=connectionManager.getParams();
  params.setParameter("maxConnectionsPerHost",new Integer(MAX_CONNECTIONS_PER_HOST));
  params.setParameter("maxTotalConnections",new Integer(MAX_TOTAL_CONNECTIONS));
  params.setConnectionTimeout(TIMEOUT);
  params.setSoTimeout(TIMEOUT);
  _nonProxyClient=new HttpClient(connectionManager);
  if (Validator.isNotNull(PROXY_HOST) && PROXY_PORT > 0) {
    connectionManager=new MultiThreadedHttpConnectionManager();
    params.setParameter("maxConnectionsPerHost",new Integer(MAX_CONNECTIONS_PER_HOST));
    params.setParameter("maxTotalConnections",new Integer(MAX_TOTAL_CONNECTIONS));
    params.setConnectionTimeout(TIMEOUT);
    params.setSoTimeout(TIMEOUT);
    _client=new HttpClient(connectionManager);
    if (Validator.isNotNull(PROXY_USERNAME)) {
      Credentials credentials=null;
      if (PROXY_AUTH_TYPE.equals("username-password")) {
        credentials=new UsernamePasswordCredentials(PROXY_USERNAME,PROXY_PASSWORD);
      }
 else       if (PROXY_AUTH_TYPE.equals("ntlm")) {
        credentials=new NTCredentials(PROXY_USERNAME,PROXY_PASSWORD,PROXY_NTLM_HOST,PROXY_NTLM_DOMAIN);
        List authPrefs=new ArrayList();
        authPrefs.add(AuthPolicy.NTLM);
        authPrefs.add(AuthPolicy.BASIC);
        authPrefs.add(AuthPolicy.DIGEST);
        _client.getParams().setParameter(AuthPolicy.AUTH_SCHEME_PRIORITY,authPrefs);
      }
      _client.getState().setProxyCredentials(new AuthScope(PROXY_HOST,PROXY_PORT,null),credentials);
    }
  }
}
