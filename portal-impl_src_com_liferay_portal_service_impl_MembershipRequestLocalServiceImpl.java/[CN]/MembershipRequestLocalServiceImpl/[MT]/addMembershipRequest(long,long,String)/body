{
  validate(comments);
  User user=UserUtil.findByPrimaryKey(userId);
  Date now=new Date();
  long requestId=CounterLocalServiceUtil.increment();
  MembershipRequest membershipRequest=MembershipRequestUtil.create(requestId);
  membershipRequest.setCompanyId(user.getCompanyId());
  membershipRequest.setUserId(userId);
  membershipRequest.setGroupId(groupId);
  membershipRequest.setComments(comments);
  membershipRequest.setCreateDate(now);
  membershipRequest.setStatusId(MembershipRequestImpl.STATUS_PENDING);
  MembershipRequestUtil.update(membershipRequest);
  notifyCommunityAdministrators(membershipRequest);
  return membershipRequest;
}
