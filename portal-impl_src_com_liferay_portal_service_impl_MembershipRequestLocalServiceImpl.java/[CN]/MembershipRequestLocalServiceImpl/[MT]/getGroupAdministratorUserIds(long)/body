{
  List<Long> userIds=new UniqueList<Long>();
  Group group=groupLocalService.getGroup(groupId);
  String modelResource=Group.class.getName();
  List<Role> roles=ListUtil.copy(ResourceActionsUtil.getRoles(group.getCompanyId(),group,modelResource,null));
  List<Team> teams=teamLocalService.getGroupTeams(groupId);
  if (teams != null) {
    for (    Team team : teams) {
      Role role=roleLocalService.getTeamRole(team.getCompanyId(),team.getTeamId());
      roles.add(role);
    }
  }
  Resource resource=resourceLocalService.getResource(group.getCompanyId(),modelResource,ResourceConstants.SCOPE_INDIVIDUAL,String.valueOf(groupId));
  List<String> actions=ResourceActionsUtil.getResourceActions(Group.class.getName());
  for (  Role role : roles) {
    String roleName=role.getName();
    if (roleName.equals(RoleConstants.OWNER)) {
      continue;
    }
    if ((roleName.equals(RoleConstants.ORGANIZATION_ADMINISTRATOR) || roleName.equals(RoleConstants.ORGANIZATION_OWNER)) && !group.isOrganization()) {
      continue;
    }
    if (roleName.equals(RoleConstants.SITE_ADMINISTRATOR) || roleName.equals(RoleConstants.SITE_OWNER) || roleName.equals(RoleConstants.ORGANIZATION_ADMINISTRATOR)|| roleName.equals(RoleConstants.ORGANIZATION_OWNER)) {
      Role curRole=roleLocalService.getRole(group.getCompanyId(),roleName);
      List<UserGroupRole> userGroupRoles=userGroupRoleLocalService.getUserGroupRolesByGroupAndRole(groupId,curRole.getRoleId());
      for (      UserGroupRole userGroupRole : userGroupRoles) {
        userIds.add(userGroupRole.getUserId());
      }
    }
    List<String> currentIndividualActions=new ArrayList<String>();
    List<String> currentGroupActions=new ArrayList<String>();
    List<String> currentGroupTemplateActions=new ArrayList<String>();
    List<String> currentCompanyActions=new ArrayList<String>();
    ResourcePermissionUtil.populateResourcePermissionActionIds(groupId,role,resource,actions,currentIndividualActions,currentGroupActions,currentGroupTemplateActions,currentCompanyActions);
    if (currentIndividualActions.contains(ActionKeys.ASSIGN_MEMBERS) || currentGroupActions.contains(ActionKeys.ASSIGN_MEMBERS) || currentGroupTemplateActions.contains(ActionKeys.ASSIGN_MEMBERS)|| currentCompanyActions.contains(ActionKeys.ASSIGN_MEMBERS)) {
      List<UserGroupRole> currentUserGroupRoles=userGroupRoleLocalService.getUserGroupRolesByGroupAndRole(groupId,role.getRoleId());
      for (      UserGroupRole userGroupRole : currentUserGroupRoles) {
        userIds.add(userGroupRole.getUserId());
      }
    }
  }
  return userIds;
}
