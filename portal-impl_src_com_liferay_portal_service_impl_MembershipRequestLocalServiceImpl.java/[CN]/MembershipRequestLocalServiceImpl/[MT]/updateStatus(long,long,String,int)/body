{
  MembershipRequest membershipRequest=getMembershipRequest(membershipRequestId);
  validate(replyComments);
  Date now=new Date();
  if (statusId == MembershipRequestImpl.STATUS_APPROVED) {
    long[] addUserIds=new long[]{membershipRequest.getUserId()};
    UserLocalServiceUtil.addGroupUsers(membershipRequest.getGroupId(),addUserIds);
  }
  membershipRequest.setStatusId(statusId);
  membershipRequest.setReplyComments(replyComments);
  membershipRequest.setReplyDate(now);
  membershipRequest.setReplierUserId(replierUserId);
  MembershipRequestUtil.update(membershipRequest);
  notify(membershipRequest.getUserId(),membershipRequest,PropsUtil.COMMUNITIES_EMAIL_MEMBERSHIP_REPLY_SUBJECT,PropsUtil.COMMUNITIES_EMAIL_MEMBERSHIP_REPLY_BODY);
}
