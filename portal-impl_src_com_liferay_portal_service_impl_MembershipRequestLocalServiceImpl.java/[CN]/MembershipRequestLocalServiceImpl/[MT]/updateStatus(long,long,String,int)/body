{
  validate(replyComments);
  MembershipRequest membershipRequest=membershipRequestPersistence.findByPrimaryKey(membershipRequestId);
  membershipRequest.setReplyComments(replyComments);
  membershipRequest.setReplyDate(new Date());
  membershipRequest.setReplierUserId(replierUserId);
  membershipRequest.setStatusId(statusId);
  membershipRequestPersistence.update(membershipRequest);
  if (statusId == MembershipRequestImpl.STATUS_APPROVED) {
    long[] addUserIds=new long[]{membershipRequest.getUserId()};
    userLocalService.addGroupUsers(membershipRequest.getGroupId(),addUserIds);
  }
  notify(membershipRequest.getUserId(),membershipRequest,PropsUtil.COMMUNITIES_EMAIL_MEMBERSHIP_REPLY_SUBJECT,PropsUtil.COMMUNITIES_EMAIL_MEMBERSHIP_REPLY_BODY);
}
