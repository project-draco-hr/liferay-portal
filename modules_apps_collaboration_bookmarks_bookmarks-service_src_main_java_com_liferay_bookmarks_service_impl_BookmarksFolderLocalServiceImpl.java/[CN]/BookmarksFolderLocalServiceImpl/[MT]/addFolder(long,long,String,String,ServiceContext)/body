{
  User user=userPersistence.findByPrimaryKey(userId);
  long groupId=serviceContext.getScopeGroupId();
  parentFolderId=getParentFolderId(groupId,parentFolderId);
  validate(name);
  long folderId=counterLocalService.increment();
  BookmarksFolder folder=bookmarksFolderPersistence.create(folderId);
  folder.setUuid(serviceContext.getUuid());
  folder.setGroupId(groupId);
  folder.setCompanyId(user.getCompanyId());
  folder.setUserId(user.getUserId());
  folder.setUserName(user.getFullName());
  folder.setParentFolderId(parentFolderId);
  folder.setTreePath(folder.buildTreePath());
  folder.setName(name);
  folder.setDescription(description);
  folder.setExpandoBridgeAttributes(serviceContext);
  bookmarksFolderPersistence.update(folder);
  resourceLocalService.addModelResources(folder,serviceContext);
  updateAsset(userId,folder,serviceContext.getAssetCategoryIds(),serviceContext.getAssetTagNames(),serviceContext.getAssetLinkEntryIds(),serviceContext.getAssetPriority());
  return folder;
}
