{
  try {
    GroupPermission.check(getPermissionChecker(),groupId,ActionKeys.UPDATE);
  }
 catch (  PrincipalException pe) {
    boolean hasPermission=false;
    User user=getUser();
    if ((userIds.length == 1) && (user.getUserId().equals(userIds[0]))) {
      Group group=GroupLocalServiceUtil.getGroup(groupId);
      if (group.getType().equals(GroupImpl.TYPE_COMMUNITY_OPEN)) {
        hasPermission=true;
      }
    }
    if (!hasPermission) {
      throw new PrincipalException();
    }
  }
}
