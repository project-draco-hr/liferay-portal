{
  fromLanguageId=getMicrosoftLanguageId(fromLanguageId);
  toLanguageId=getMicrosoftLanguageId(toLanguageId);
  Http.Options options=new Http.Options();
  StringBundler sb=new StringBundler(7);
  sb.append("http://api.microsofttranslator.com/v2/Http.svc/Translate?");
  sb.append("text=");
  sb.append(HttpUtil.encodeURL(fromText));
  sb.append("&from=");
  sb.append(fromLanguageId);
  sb.append("&to=");
  sb.append(toLanguageId);
  options.setLocation(sb.toString());
  String accessToken=_microsoftTranslatorAuthenticator.getAccessToken();
  if (Validator.isNull(accessToken)) {
    throw new MicrosoftTranslatorException(_microsoftTranslatorAuthenticator.getError());
  }
  options.addHeader("Authorization","Bearer " + accessToken);
  String text=HttpUtil.URLtoString(options);
  int x=text.indexOf(">") + 1;
  int y=text.indexOf("</string>",x);
  if ((x == -1) || (y == -1)) {
    x=text.indexOf("Message: ");
    y=text.indexOf("<",x);
    if ((x > -1) && (y > -1)) {
      text=text.substring(x,y);
    }
    throw new MicrosoftTranslatorException(text);
  }
  String toText=text.substring(x,y);
  toText=toText.trim();
  return StringUtil.replace(toText,CharPool.NEW_LINE,CharPool.SPACE);
}
