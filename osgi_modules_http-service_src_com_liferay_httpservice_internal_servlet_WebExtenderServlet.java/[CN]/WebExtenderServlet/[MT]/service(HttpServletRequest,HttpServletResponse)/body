{
  printHeaders(request);
  Portlet portlet=null;
  String portletId=(String)request.getAttribute(WebKeys.PORTLET_ID);
  if (Validator.isNotNull(portletId)) {
    try {
      String rootPortletId=PortletConstants.getRootPortletId(portletId);
      portlet=PortletLocalServiceUtil.getPortletById(rootPortletId);
    }
 catch (    Exception e) {
      _log.debug(e,e);
    }
  }
  String servletContextName=null;
  if (portlet != null) {
    PortletApp portletApp=portlet.getPortletApp();
    servletContextName=portletApp.getServletContextName();
  }
  ServletContext servletContext=ServletContextPool.get(servletContextName);
  service(request,response,servletContext,portletId,request.getRequestURI());
}
