{
  String servletContextName=servletContext.getServletContextName();
  String xml=HttpUtil.URLtoString(servletContext.getResource("/WEB-INF/liferay-plugin-package.xml"));
  if (_log.isInfoEnabled()) {
    if (servletContextName == null) {
      _log.info("Reading plugin package for the root context");
    }
 else {
      _log.info("Reading plugin package for " + servletContextName);
    }
  }
  PluginPackage pluginPackage=null;
  if (xml == null) {
    String propertiesString=HttpUtil.URLtoString(servletContext.getResource("/WEB-INF/liferay-plugin-package.properties"));
    if (propertiesString == null) {
      if (_log.isDebugEnabled()) {
        _log.debug("Reading plugin package from MANIFEST.MF");
      }
      pluginPackage=_readPluginPackageServletManifest(servletContext);
    }
 else {
      if (_log.isDebugEnabled()) {
        _log.debug("Reading plugin package from " + "liferay-plugin-package.properties");
      }
      Properties properties=PropertiesUtil.load(propertiesString);
      int beginIndex=servletContextName.startsWith("/") ? 1 : 0;
      String displayName=servletContextName.substring(beginIndex);
      pluginPackage=_readPluginPackageProperties(displayName,properties);
    }
  }
 else {
    if (_log.isDebugEnabled()) {
      _log.debug("Reading plugin package from liferay-plugin-package.xml");
    }
    pluginPackage=_readPluginPackageXml(xml);
  }
  pluginPackage.setContext(servletContextName);
  return pluginPackage;
}
