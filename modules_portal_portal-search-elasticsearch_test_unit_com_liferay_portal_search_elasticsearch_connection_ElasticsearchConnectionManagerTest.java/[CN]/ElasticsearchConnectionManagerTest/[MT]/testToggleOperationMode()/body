{
  modify(OperationMode.EMBEDDED);
  verifyConnectNeverClose(_embeddedElasticsearchConnection);
  verifyNeverCloseNeverConnect(_remoteElasticsearchConnection);
  resetMockConnections();
  modify(OperationMode.REMOTE);
  verifyCloseNeverConnect(_embeddedElasticsearchConnection);
  verifyConnectNeverClose(_remoteElasticsearchConnection);
  resetMockConnections();
  modify(OperationMode.EMBEDDED);
  verifyCloseNeverConnect(_remoteElasticsearchConnection);
  verifyConnectNeverClose(_embeddedElasticsearchConnection);
}
