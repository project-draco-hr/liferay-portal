{
  if (_serviceTrackerCustomizer != null) {
    _serviceTrackerCustomizer.removedService(serviceReference,service);
  }
  if (_services.remove(serviceReference) != null) {
    _servicesList.set(Collections.unmodifiableList(new ArrayList<S>(_services.values())));
  }
  Registry registry=RegistryUtil.getRegistry();
  registry.ungetService(serviceReference);
}
