{
  S service=null;
  if (_serviceTrackerCustomizer != null) {
    service=_serviceTrackerCustomizer.addingService(serviceReference);
  }
 else {
    Registry registry=RegistryUtil.getRegistry();
    service=registry.getService(serviceReference);
  }
  if (service != null) {
    _services.put(serviceReference,service);
    _servicesList.set(Collections.unmodifiableList(new ArrayList<S>(_services.values())));
  }
  return service;
}
