{
  if (_fieldsMap != null) {
    return;
  }
  if (_dlFileVersion == null) {
    return;
  }
  _fieldsMap=new HashMap<>();
  try {
    _dlFileEntryMetadata=_dlFileEntryMetadataLocalService.getFileEntryMetadata(_ddmStructure.getStructureId(),_dlFileVersion.getFileVersionId());
  }
 catch (  NoSuchFileEntryMetadataException nsfeme) {
    addGoogleDocsDLFileEntryMetadata();
  }
catch (  PortalException pe) {
    throw new SystemException("Unable to load file entry metadata for file version " + _dlFileVersion.getFileVersionId(),pe);
  }
  try {
    DDMFormValues ddmFormValues=_storageEngine.getDDMFormValues(_dlFileEntryMetadata.getDDMStorageId());
    _fields=DDMFormValuesToFieldsConverterUtil.convert(_ddmStructure,ddmFormValues);
    for (    Field field : _fields) {
      _fieldsMap.put(field.getName(),field);
    }
  }
 catch (  PortalException pe) {
    throw new SystemException("Unable to load DDM fields for file version " + _dlFileVersion.getFileVersionId(),pe);
  }
}
