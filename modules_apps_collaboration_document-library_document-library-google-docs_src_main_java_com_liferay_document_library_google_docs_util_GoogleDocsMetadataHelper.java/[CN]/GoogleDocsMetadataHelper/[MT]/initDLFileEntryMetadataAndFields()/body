{
  if (_fieldsMap != null) {
    return;
  }
  if (_dlFileVersion == null) {
    return;
  }
  _fieldsMap=new HashMap<>();
  _dlFileEntryMetadata=_dlFileEntryMetadataLocalService.fetchFileEntryMetadata(_ddmStructure.getStructureId(),_dlFileVersion.getFileVersionId());
  if (_dlFileEntryMetadata == null) {
    addGoogleDocsDLFileEntryMetadata();
  }
  try {
    DDMFormValues ddmFormValues=_storageEngine.getDDMFormValues(_dlFileEntryMetadata.getDDMStorageId());
    _fields=_ddmFormValuesToFieldsConverter.convert(_ddmStructureLocalService.getDDMStructure(_ddmStructure.getStructureId()),ddmFormValues);
    for (    Field field : _fields) {
      _fieldsMap.put(field.getName(),field);
    }
  }
 catch (  PortalException pe) {
    throw new SystemException("Unable to load DDM fields for file version " + _dlFileVersion.getFileVersionId(),pe);
  }
}
