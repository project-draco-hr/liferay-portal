{
  try {
    PortletSession ses=req.getPortletSession();
    CaptchaProducer captchaProducer=CaptchaUtil.getCaptchaProducer();
    String captchaText=captchaProducer.createText();
    ses.setAttribute(WebKeys.CAPTCHA_TEXT,captchaText);
    HttpServletResponse httpRes=PortalUtil.getHttpServletResponse(res);
    captchaProducer.createImage(httpRes.getOutputStream(),captchaText);
    setForward(req,ActionConstants.COMMON_NULL);
  }
 catch (  Exception e) {
    _log.error(e);
  }
}
