{
  try {
    PortletSession portletSession=actionRequest.getPortletSession();
    CaptchaProducer captchaProducer=CaptchaUtil.getCaptchaProducer();
    String captchaText=captchaProducer.createText();
    portletSession.setAttribute(WebKeys.CAPTCHA_TEXT,captchaText);
    HttpServletResponse response=PortalUtil.getHttpServletResponse(actionResponse);
    captchaProducer.createImage(response.getOutputStream(),captchaText);
    setForward(actionRequest,ActionConstants.COMMON_NULL);
  }
 catch (  Exception e) {
    _log.error(e);
  }
}
