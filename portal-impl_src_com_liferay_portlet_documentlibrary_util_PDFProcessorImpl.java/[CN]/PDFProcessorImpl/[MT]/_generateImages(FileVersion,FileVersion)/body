{
  InputStream inputStream=null;
  try {
    if (sourceFileVersion != null) {
      copy(sourceFileVersion,destinationFileVersion);
      return;
    }
    if (_hasImages(destinationFileVersion)) {
      return;
    }
    String extension=destinationFileVersion.getExtension();
    if (extension.equals("pdf")) {
      if (destinationFileVersion instanceof LiferayFileVersion) {
        try {
          LiferayFileVersion liferayFileVersion=(LiferayFileVersion)destinationFileVersion;
          File file=liferayFileVersion.getFile(false);
          _generateImages(destinationFileVersion,file);
          return;
        }
 catch (        UnsupportedOperationException uoe) {
        }
      }
      inputStream=destinationFileVersion.getContentStream(false);
      _generateImages(destinationFileVersion,inputStream);
    }
 else     if (DocumentConversionUtil.isEnabled()) {
      inputStream=destinationFileVersion.getContentStream(false);
      String tempFileId=DLUtil.getTempFileId(destinationFileVersion.getFileEntryId(),destinationFileVersion.getVersion());
      if (Objects.equals("PWC",destinationFileVersion.getVersion()) || destinationFileVersion.isPending()) {
        File file=new File(DocumentConversionUtil.getFilePath(tempFileId,"pdf"));
        FileUtil.delete(file);
      }
      File file=DocumentConversionUtil.convert(tempFileId,inputStream,extension,"pdf");
      _generateImages(destinationFileVersion,file);
    }
  }
 catch (  NoSuchFileEntryException nsfee) {
    if (_log.isDebugEnabled()) {
      _log.debug(nsfee,nsfee);
    }
  }
 finally {
    StreamUtil.cleanUp(inputStream);
    _fileVersionIds.remove(destinationFileVersion.getFileVersionId());
  }
}
