{
  PDDocument pdDocument=null;
  try {
    pdDocument=PDDocument.load(file);
    PDDocumentCatalog pdDocumentCatalog=pdDocument.getDocumentCatalog();
    List<PDPage> pdPages=pdDocumentCatalog.getAllPages();
    PDPage firstPage=pdPages.get(0);
    float width=firstPage.getMediaBox().getWidth();
    float height=firstPage.getMediaBox().getHeight();
    double widthFactor=(double)PropsValues.DL_FILE_ENTRY_PREVIEW_DOCUMENT_MAX_WIDTH / width;
    double heightFactor=(double)PropsValues.DL_FILE_ENTRY_PREVIEW_DOCUMENT_MAX_HEIGHT / height;
    int scaledWidth=(int)Math.round(heightFactor * width);
    int scaledHeight=(int)Math.round(widthFactor * height);
    Map<String,Integer> scaledDimensions=new HashMap<String,Integer>();
    scaledDimensions.put("width",scaledWidth);
    scaledDimensions.put("height",scaledHeight);
    return scaledDimensions;
  }
  finally {
    if (pdDocument != null) {
      pdDocument.close();
    }
  }
}
