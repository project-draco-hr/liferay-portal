{
  PDDocument pdDocument=null;
  try {
    Map<String,Integer> scaledDimensions=new HashMap<>();
    pdDocument=PDDocument.load(file);
    PDDocumentCatalog pdDocumentCatalog=pdDocument.getDocumentCatalog();
    List<PDPage> pdPages=pdDocumentCatalog.getAllPages();
    PDPage pdPage=pdPages.get(0);
    PDRectangle pdRectangle=pdPage.getMediaBox();
    float width=pdRectangle.getWidth();
    double widthFactor=(double)PropsValues.DL_FILE_ENTRY_PREVIEW_DOCUMENT_MAX_WIDTH / width;
    float height=pdRectangle.getHeight();
    int scaledHeight=(int)Math.round(widthFactor * height);
    scaledDimensions.put("height",scaledHeight);
    double heightFactor=(double)PropsValues.DL_FILE_ENTRY_PREVIEW_DOCUMENT_MAX_HEIGHT / height;
    int scaledWidth=(int)Math.round(heightFactor * width);
    scaledDimensions.put("width",scaledWidth);
    return scaledDimensions;
  }
  finally {
    if (pdDocument != null) {
      pdDocument.close();
    }
  }
}
