{
  String MN="getServiceDescription";
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.entry(Logger.TRACE_HIGH,MN);
  }
  ServiceDescription description=null;
  try {
    paramCheck.check(request);
    DescriptionHandler descrHandler=provider.getDescriptionHandler();
    RegistrationContext regContext=request.getRegistrationContext();
    boolean registered=false;
    if (regContext != null) {
      registered=consumerRegistry.check(regContext.getRegistrationHandle());
    }
    if (!registrationRequired || ((regContext != null) && (registered))) {
      description=descrHandler.getServiceDescription(regContext,request.getDesiredLocales());
    }
 else {
      if (regContext == null && !registered) {
        description=descrHandler.getServiceDescription(null,request.getDesiredLocales());
      }
 else {
        throw new WSRPException(ErrorCodes.INVALID_REGISTRATION);
      }
    }
  }
 catch (  WSRPException e) {
    WSRPXHelper.handleWSRPException(e);
  }
catch (  Throwable t) {
    t.printStackTrace();
  }
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.exit(Logger.TRACE_HIGH,MN);
  }
  return description;
}
