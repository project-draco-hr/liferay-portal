{
  String MN="clonePortlet";
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.entry(Logger.TRACE_HIGH,MN);
  }
  PortletContext portletContext=null;
  try {
    paramCheck.check(request);
    PortletStateManager portletStateManager=null;
    portletStateManager=provider.getPortletStateManager();
    String orgPortletHandle=request.getPortletContext().getPortletHandle();
    Portlet portletClone=null;
    portletClone=provider.getPortletPool().clone(orgPortletHandle);
    if (portletClone != null) {
      String newPortletHandle=portletClone.getPortletHandle();
      portletContext=new PortletContext();
      portletContext.setPortletHandle(newPortletHandle);
      portletContext.setPortletState(portletStateManager.getAsString(newPortletHandle).getBytes());
      portletContext.setExtensions(null);
      RegistrationContext regContext=request.getRegistrationContext();
      if (regContext != null) {
        String regHandle=regContext.getRegistrationHandle();
        if (regHandle != null && consumerRegistry.check(regHandle) == true) {
          provider.getPortletRegistrationFilterWriter().makeAvailable(regHandle,newPortletHandle);
        }
      }
    }
 else {
      throw new WSRPException(ErrorCodes.OPERATION_FAILED);
    }
  }
 catch (  WSRPException e) {
    WSRPXHelper.handleWSRPException(e);
  }
  if (logger.isLogging(Logger.TRACE_HIGH)) {
    logger.exit(Logger.TRACE_HIGH,MN);
  }
  return portletContext;
}
