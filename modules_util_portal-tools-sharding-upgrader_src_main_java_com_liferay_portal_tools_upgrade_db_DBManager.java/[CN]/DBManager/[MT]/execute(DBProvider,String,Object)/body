{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    DataSource dataSource=dbProvider.getDataSource();
    con=dataSource.getConnection();
    ps=con.prepareStatement(sql);
    for (int i=0; i < args.length; i++) {
      Object arg=args[i];
      if ((arg instanceof Date)) {
        Date date=(Date)arg;
        ps.setTimestamp(i + 1,new Timestamp(date.getTime()));
      }
 else       if ((arg instanceof Timestamp)) {
        Timestamp timestamp=(Timestamp)arg;
        ps.setTimestamp(i + 1,timestamp);
      }
 else {
        ps.setObject(i + 1,arg);
      }
    }
    return ps.executeUpdate();
  }
  finally {
    cleanUp(con,ps,rs);
  }
}
