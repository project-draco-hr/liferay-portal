{
  PortletPreferences prefs=req.getPreferences();
  String initUrl=prefs.getValue("initUrl",StringPool.BLANK);
  if (Validator.isNull(initUrl)) {
    PortletRequestDispatcher prd=getPortletContext().getRequestDispatcher(StrutsUtil.TEXT_HTML_DIR + "/portal/portlet_not_setup.jsp");
    prd.include(req,res);
  }
 else {
    super.doView(req,res);
    RenderResponseImpl resImpl=(RenderResponseImpl)res;
    StringServletResponse stringServletRes=(StringServletResponse)resImpl.getHttpServletResponse();
    String output=stringServletRes.getString();
    output=StringUtil.replace(output,"//pbhs/","/pbhs/");
    stringServletRes.setString(output);
  }
}
