{
  long scopeGroupId=0;
  Layout layoutTypePortletLayout=layoutTypePortlet.getLayout();
  Layout requestLayout=(Layout)request.getAttribute(WebKeys.LAYOUT);
  try {
    request.setAttribute(WebKeys.LAYOUT,layoutTypePortletLayout);
    scopeGroupId=PortalUtil.getScopeGroupId(request,portletId);
  }
  finally {
    request.setAttribute(WebKeys.LAYOUT,requestLayout);
  }
  if (scopeGroupId <= 0) {
    scopeGroupId=PortalUtil.getScopeGroupId(layoutTypePortletLayout,portletId);
  }
  return scopeGroupId;
}
