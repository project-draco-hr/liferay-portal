{
  List<Layout> layouts=LayoutLocalServiceUtil.getLayouts(layout.getGroupId(),layout.isPrivateLayout(),LayoutConstants.TYPE_PORTLET);
  List<Portlet> portlets=new ArrayList<Portlet>();
  for (  Layout currentLayout : layouts) {
    LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)currentLayout.getLayoutType();
    List<Portlet> layoutPortlets=layoutTypePortlet.getPortlets();
    if (portlets != null) {
      portlets.addAll(layoutPortlets);
    }
  }
  return portlets;
}
