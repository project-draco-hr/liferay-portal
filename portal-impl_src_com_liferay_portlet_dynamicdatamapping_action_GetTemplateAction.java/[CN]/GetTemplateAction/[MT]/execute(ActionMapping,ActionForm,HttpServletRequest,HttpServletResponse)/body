{
  try {
    long templateId=ParamUtil.getLong(request,"templateId");
    DDMTemplate template=DDMTemplateServiceUtil.getTemplate(templateId);
    String script=template.getScript();
    String contentType=null;
    String type=template.getType();
    String language=GetterUtil.getString(template.getLanguage(),TemplateConstants.LANG_TYPE_VM);
    if (type.equals(DDMTemplateConstants.TEMPLATE_TYPE_FORM) || language.equals(TemplateConstants.LANG_TYPE_XSL)) {
      contentType=ContentTypes.TEXT_XML_UTF8;
    }
 else {
      contentType=ContentTypes.TEXT_PLAIN_UTF8;
    }
    ServletResponseUtil.sendFile(request,response,null,script.getBytes(),contentType);
    return null;
  }
 catch (  Exception e) {
    PortalUtil.sendError(e,request,response);
    return null;
  }
}
