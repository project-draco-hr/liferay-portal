{
  try {
    long templateId=ParamUtil.getLong(request,"templateId");
    DDMTemplate template=DDMTemplateServiceUtil.getTemplate(templateId);
    String extension=GetterUtil.getString(template.getLanguage(),TemplateConstants.LANG_TYPE_VM);
    String script=template.getScript();
    String contentType=null;
    if (extension.equals(TemplateConstants.LANG_TYPE_XSD)) {
      contentType=ContentTypes.TEXT_XML_UTF8;
    }
 else {
      contentType=ContentTypes.TEXT_PLAIN_UTF8;
    }
    ServletResponseUtil.sendFile(request,response,null,script.getBytes(),contentType);
    return null;
  }
 catch (  Exception e) {
    PortalUtil.sendError(e,request,response);
    return null;
  }
}
