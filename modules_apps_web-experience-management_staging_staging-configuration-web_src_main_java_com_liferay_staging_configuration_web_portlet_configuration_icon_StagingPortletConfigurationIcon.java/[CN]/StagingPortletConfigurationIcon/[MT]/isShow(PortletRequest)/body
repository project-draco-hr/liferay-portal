{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  Group group=themeDisplay.getSiteGroup();
  if (group.isStagedRemotely() || group.hasLocalOrRemoteStagingGroup()) {
    return false;
  }
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  String rootPortletId=portletDisplay.getRootPortletId();
  if (rootPortletId.equals(ExportImportPortletKeys.EXPORT) || rootPortletId.equals(ExportImportPortletKeys.EXPORT_IMPORT) || rootPortletId.equals(ExportImportPortletKeys.IMPORT)|| rootPortletId.equals(StagingConfigurationPortletKeys.STAGING_CONFIGURATION)|| rootPortletId.equals(StagingProcessesPortletKeys.STAGING_PROCESSES)) {
    return false;
  }
  return portletDisplay.isShowStagingIcon();
}
