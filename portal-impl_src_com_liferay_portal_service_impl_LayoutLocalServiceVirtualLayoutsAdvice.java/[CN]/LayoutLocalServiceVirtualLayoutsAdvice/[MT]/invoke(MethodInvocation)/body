{
  if (MergeLayoutPrototypesThreadLocal.isInProgress()) {
    return methodInvocation.proceed();
  }
  Method method=methodInvocation.getMethod();
  String methodName=method.getName();
  Class<?>[] parameterTypes=method.getParameterTypes();
  Object[] arguments=methodInvocation.getArguments();
  if (methodName.equals("getLayouts") && (Arrays.equals(parameterTypes,_TYPES_L_B_L) || Arrays.equals(parameterTypes,_TYPES_L_B_L_B_I_I))) {
    long groupId=(Long)arguments[0];
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    boolean privateLayout=(Boolean)arguments[1];
    long parentLayoutId=(Long)arguments[2];
    LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(groupId,privateLayout);
    if (!_mergeLayouts(group,layoutSet,arguments)) {
      return methodInvocation.proceed();
    }
    List<Layout> layouts=(List<Layout>)methodInvocation.proceed();
    return _injectVirtualLayouts(group,layoutSet,layouts,parentLayoutId);
  }
  return methodInvocation.proceed();
}
