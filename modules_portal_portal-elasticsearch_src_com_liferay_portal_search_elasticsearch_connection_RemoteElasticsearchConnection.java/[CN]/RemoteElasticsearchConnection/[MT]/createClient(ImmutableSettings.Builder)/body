{
  if (_transportAddresses.isEmpty()) {
    throw new IllegalStateException("There must be at least one transport address");
  }
  builder.loadFromClasspath(PortletPropsValues.ELASTICSEARCH_REMOTE_CONFIG_LOCATION);
  TransportClient transportClient=new TransportClient(builder);
  builder.put("client.transport.sniff",true);
  builder.put("cluster.name",getClusterName());
  for (  String transportAddress : _transportAddresses) {
    String[] transportAddressParts=StringUtil.split(transportAddress,StringPool.COLON);
    try {
      InetAddress inetAddress=InetAddress.getByName(transportAddressParts[0]);
      int port=GetterUtil.getInteger(transportAddressParts[1]);
      transportClient.addTransportAddress(new InetSocketTransportAddress(inetAddress,port));
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to add transport address " + transportAddress,e);
      }
    }
  }
  return transportClient;
}
