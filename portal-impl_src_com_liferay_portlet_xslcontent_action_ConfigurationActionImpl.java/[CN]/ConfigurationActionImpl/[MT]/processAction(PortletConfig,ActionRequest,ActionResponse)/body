{
  String cmd=ParamUtil.getString(req,Constants.CMD);
  if (!cmd.equals(Constants.UPDATE)) {
    return;
  }
  URL xmlURL=null;
  try {
    xmlURL=new URL(ParamUtil.getString(req,"xmlURL"));
  }
 catch (  MalformedURLException murle) {
    SessionErrors.add(req,"xmlURL");
    return;
  }
  URL xslURL=null;
  try {
    xslURL=new URL(ParamUtil.getString(req,"xslURL"));
  }
 catch (  MalformedURLException murle) {
    SessionErrors.add(req,"xslURL");
    return;
  }
  try {
    XSLContentUtil.transform(xmlURL,xslURL);
  }
 catch (  Exception e) {
    SessionErrors.add(req,"transformation");
    return;
  }
  String portletResource=ParamUtil.getString(req,"portletResource");
  PortletPreferences prefs=PortletPreferencesFactoryUtil.getPortletSetup(req,portletResource,true,true);
  prefs.setValue("xml-url",xmlURL.toString());
  prefs.setValue("xsl-url",xslURL.toString());
  prefs.store();
  SessionMessages.add(req,config.getPortletName() + ".doConfigure");
}
