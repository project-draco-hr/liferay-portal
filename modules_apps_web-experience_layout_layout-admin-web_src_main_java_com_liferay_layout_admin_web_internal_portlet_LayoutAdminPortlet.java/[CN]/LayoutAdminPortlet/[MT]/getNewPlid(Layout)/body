{
  long newPlid=LayoutConstants.DEFAULT_PLID;
  if (layout.getParentLayoutId() != LayoutConstants.DEFAULT_PARENT_LAYOUT_ID) {
    Layout parentLayout=layoutLocalService.fetchLayout(layout.getGroupId(),layout.isPrivateLayout(),layout.getParentLayoutId());
    if (parentLayout != null) {
      newPlid=parentLayout.getPlid();
    }
  }
  if (newPlid <= 0) {
    Layout firstLayout=layoutLocalService.fetchFirstLayout(layout.getGroupId(),layout.isPrivateLayout(),LayoutConstants.DEFAULT_PARENT_LAYOUT_ID);
    if ((firstLayout != null) && (firstLayout.getPlid() != layout.getPlid())) {
      newPlid=firstLayout.getPlid();
    }
    if (newPlid <= 0) {
      Layout otherLayoutSetFirstLayout=layoutLocalService.fetchFirstLayout(layout.getGroupId(),!layout.isPrivateLayout(),LayoutConstants.DEFAULT_PARENT_LAYOUT_ID);
      if ((otherLayoutSetFirstLayout != null) && (otherLayoutSetFirstLayout.getPlid() != layout.getPlid())) {
        newPlid=otherLayoutSetFirstLayout.getPlid();
      }
    }
  }
  return newPlid;
}
