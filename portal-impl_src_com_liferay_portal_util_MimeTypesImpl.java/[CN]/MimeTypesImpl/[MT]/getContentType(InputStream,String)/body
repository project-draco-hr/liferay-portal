{
  List<MimeType> types=new ArrayList<MimeType>(MimeUtil.getMimeTypes(is));
  MimeType type=types.get(0);
  if (types.size() > 1 && (type instanceof TextMimeType)) {
    type=types.get(1);
  }
  String contentType=type.getMediaType() + "/" + type.getSubType();
  if (contentType.equals(ContentTypes.APPLICATION_OCTET_STREAM)) {
    contentType=getContentType(fileName);
  }
 else   if (contentType.equals(ContentTypes.APPLICATION_ZIP)) {
    String typeByFileName=getContentType(fileName);
    if (typeByFileName.contains("vnd.openxmlformats")) {
      contentType=typeByFileName;
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Content type " + contentType + " returned for InputStream");
  }
  return contentType;
}
