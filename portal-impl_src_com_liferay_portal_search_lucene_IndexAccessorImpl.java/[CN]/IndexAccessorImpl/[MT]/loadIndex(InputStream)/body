{
  File tempFile=FileUtil.createTempFile();
  Directory tempDirectory=FSDirectory.open(tempFile);
  IndexCommitSerializationUtil.deserializeIndex(inputStream,tempDirectory);
  close();
  if (PropsValues.INDEX_FORCE_GC_BEFORE_DELETE) {
    System.gc();
  }
  _deleteDirectory();
  for (  String file : tempDirectory.listAll()) {
    tempDirectory.copy(getLuceneDir(),file,file);
  }
  _initIndexWriter();
  tempDirectory.close();
  FileUtil.deltree(tempFile);
}
