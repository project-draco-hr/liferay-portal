{
  ClusterExecutorImpl clusterExecutorImpl1=getClusterExecutorImpl();
  MockClusterEventListener mockClusterEventListener=new MockClusterEventListener();
  clusterExecutorImpl1.addClusterEventListener(mockClusterEventListener);
  ClusterExecutorImpl clusterExecutorImpl2=getClusterExecutorImpl();
  ClusterNode clusterNode=clusterExecutorImpl2.getLocalClusterNode();
  String clusterNodeId=clusterNode.getClusterNodeId();
  assertClusterEvent(mockClusterEventListener.waitJoinMessage(),ClusterEventType.JOIN,clusterNode);
  try (CaptureHandler captureHandler=JDKLoggerTestUtil.configureJDKLogger(ClusterRequestReceiver.class.getName(),Level.OFF)){
    ClusterRequest clusterRequest=ClusterRequest.createUnicastRequest(new MethodHandler(testMethod1MethodKey,StringPool.BLANK),clusterNodeId);
    FutureClusterResponses futureClusterResponses=clusterExecutorImpl1.execute(clusterRequest);
    assertFutureClusterResponsesWithoutException(futureClusterResponses.get(),clusterRequest.getUuid(),null,Collections.singletonList(clusterNodeId));
    String timestamp=String.valueOf(System.currentTimeMillis());
    clusterRequest=ClusterRequest.createUnicastRequest(new MethodHandler(testMethod1MethodKey,timestamp),clusterNodeId);
    futureClusterResponses=clusterExecutorImpl1.execute(clusterRequest);
    assertFutureClusterResponsesWithoutException(futureClusterResponses.get(),clusterRequest.getUuid(),timestamp,Collections.singletonList(clusterNodeId));
    clusterRequest=ClusterRequest.createUnicastRequest(new MethodHandler(testMethod2MethodKey),clusterNodeId);
    futureClusterResponses=clusterExecutorImpl1.execute(clusterRequest);
    assertFutureClusterResponsesWithException(futureClusterResponses,clusterRequest.getUuid(),clusterNodeId,"Return value is not serializable");
    timestamp=String.valueOf(System.currentTimeMillis());
    clusterRequest=ClusterRequest.createUnicastRequest(new MethodHandler(testMethod3MethodKey,timestamp),clusterNodeId);
    futureClusterResponses=clusterExecutorImpl1.execute(clusterRequest);
    assertFutureClusterResponsesWithException(futureClusterResponses,clusterRequest.getUuid(),clusterNodeId,timestamp);
    clusterRequest=ClusterRequest.createUnicastRequest(StringPool.BLANK,clusterNodeId);
    futureClusterResponses=clusterExecutorImpl1.execute(clusterRequest);
    assertFutureClusterResponsesWithException(futureClusterResponses,clusterRequest.getUuid(),clusterNodeId,"Payload is not of type " + MethodHandler.class.getName());
  }
  finally {
    clusterExecutorImpl1.destroy();
    clusterExecutorImpl2.destroy();
  }
}
