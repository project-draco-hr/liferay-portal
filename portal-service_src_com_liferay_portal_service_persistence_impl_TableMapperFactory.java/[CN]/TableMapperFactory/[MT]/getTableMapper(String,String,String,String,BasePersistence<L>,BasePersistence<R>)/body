{
  TableMapper<?,?> tableMapper=tableMappers.get(tableName);
  if (tableMapper == null) {
    TableMapperImpl<L,R> tableMapperImpl=null;
    if (cacheMappingTableNames.contains(tableName)) {
      tableMapperImpl=new TableMapperImpl<>(tableName,companyColumnName,leftColumnName,rightColumnName,leftPersistence,rightPersistence);
    }
 else {
      tableMapperImpl=new CachelessTableMapperImpl<>(tableName,companyColumnName,leftColumnName,rightColumnName,leftPersistence,rightPersistence);
    }
    tableMapperImpl.setReverseTableMapper(new ReverseTableMapper<>(tableMapperImpl));
    tableMapper=tableMapperImpl;
    tableMappers.put(tableName,tableMapper);
  }
 else   if (!tableMapper.matches(leftColumnName,rightColumnName)) {
    tableMapper=tableMapper.getReverseTableMapper();
  }
  return (TableMapper<L,R>)tableMapper;
}
