{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  if (!LayoutPermissionUtil.contains(themeDisplay.getPermissionChecker(),themeDisplay.getLayout(),ActionKeys.CUSTOMIZE)) {
    throw new PrincipalException();
  }
  LayoutTypePortlet layoutTypePortlet=themeDisplay.getLayoutTypePortlet();
  if ((layoutTypePortlet != null) && layoutTypePortlet.isCustomizable() && layoutTypePortlet.isCustomizedView()) {
    layoutTypePortlet.resetUserPreferences();
  }
  MultiSessionMessages.add(actionRequest,PortalUtil.getPortletId(actionRequest) + "requestProcessed");
}
