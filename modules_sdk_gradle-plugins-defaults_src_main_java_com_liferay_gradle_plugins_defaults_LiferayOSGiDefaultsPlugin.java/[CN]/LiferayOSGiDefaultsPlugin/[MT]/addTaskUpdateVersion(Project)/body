{
  final ReplaceRegexTask replaceRegexTask=GradleUtil.addTask(project,LiferayRelengPlugin.UPDATE_VERSION_TASK_NAME,ReplaceRegexTask.class);
  replaceRegexTask.match(_BUNDLE_VERSION_REGEX,"bnd.bnd");
  File packageJsonFile=project.file("package.json");
  if (packageJsonFile.exists()) {
    replaceRegexTask.match("\\n\\t\"version\": \"(.+)\"",packageJsonFile);
  }
  replaceRegexTask.onlyIf(new Spec<Task>(){
    @Override public boolean isSatisfiedBy(    Task task){
      Project project=task.getProject();
      String version=String.valueOf(project.getVersion());
      if (version.contains("LIFERAY-PATCHED-")) {
        return false;
      }
      return true;
    }
  }
);
  replaceRegexTask.setDescription("Updates the project version in the " + Constants.BUNDLE_VERSION + " header.");
  replaceRegexTask.setReplacement(IncrementVersionClosure.MICRO_INCREMENT);
  return replaceRegexTask;
}
