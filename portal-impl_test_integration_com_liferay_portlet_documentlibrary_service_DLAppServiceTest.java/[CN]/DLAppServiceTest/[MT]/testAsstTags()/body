{
  long folderId=parentFolder.getFolderId();
  String name="TestTags.txt";
  String description=StringPool.BLANK;
  String changeLog=StringPool.BLANK;
  byte[] bytes=CONTENT.getBytes();
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddGroupPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  String[] assetTagNames=new String[]{"hello","world"};
  serviceContext.setAssetTagNames(assetTagNames);
  FileEntry fileEntry=DLAppServiceUtil.addFileEntry(TestPropsValues.getGroupId(),folderId,name,ContentTypes.TEXT_PLAIN,name,description,changeLog,bytes,serviceContext);
  AssetEntry assetEntry=AssetEntryLocalServiceUtil.fetchEntry(DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId());
  AssertUtils.assertEqualsSorted(assetTagNames,assetEntry.getTagNames());
  Thread.sleep(1000 * TestPropsValues.JUNIT_DELAY_FACTOR);
  _fileEntry=fileEntry;
  search(false,"hello",true);
  search(false,"world",true);
  search(false,"liferay",false);
  assetTagNames=new String[]{"hello","world","liferay"};
  serviceContext.setAssetTagNames(assetTagNames);
  fileEntry=DLAppServiceUtil.updateFileEntry(fileEntry.getFileEntryId(),name,ContentTypes.TEXT_PLAIN,name,description,changeLog,false,bytes,serviceContext);
  assetEntry=AssetEntryLocalServiceUtil.fetchEntry(DLFileEntryConstants.getClassName(),fileEntry.getFileEntryId());
  AssertUtils.assertEqualsSorted(assetTagNames,assetEntry.getTagNames());
  Thread.sleep(1000 * TestPropsValues.JUNIT_DELAY_FACTOR);
  _fileEntry=fileEntry;
  search(false,"hello",true);
  search(false,"world",true);
  search(false,"liferay",true);
  DLAppServiceUtil.deleteFileEntry(_fileEntry.getFileEntryId());
  _fileEntry=null;
}
