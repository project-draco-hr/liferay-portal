{
  String fileName=RandomTestUtil.randomString();
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(group.getGroupId());
  FileEntry fileEntry=DLAppServiceUtil.addFileEntry(group.getGroupId(),parentFolder.getFolderId(),fileName,ContentTypes.TEXT_PLAIN,fileName,StringPool.BLANK,StringPool.BLANK,null,0,serviceContext);
  long oldValue=PrefsPropsUtil.getLong(PropsKeys.DL_FILE_MAX_SIZE);
  PortletPreferences portletPreferences=PrefsPropsUtil.getPreferences(0,false);
  portletPreferences.setValue(PropsKeys.DL_FILE_MAX_SIZE,String.valueOf(1L));
  portletPreferences.store();
  try {
    byte[] bytes=RandomTestUtil.randomBytes();
    DLAppServiceUtil.updateFileEntry(fileEntry.getFileEntryId(),fileName,ContentTypes.TEXT_PLAIN,StringPool.BLANK,StringPool.BLANK,StringPool.BLANK,true,bytes,serviceContext);
  }
  finally {
    portletPreferences.setValue(PropsKeys.DL_FILE_MAX_SIZE,String.valueOf(oldValue));
    portletPreferences.store();
  }
}
