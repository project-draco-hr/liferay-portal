{
  long currentTime=System.currentTimeMillis();
  long expireTime=currentTime + timeTolive;
  _expungeExpiredToken(currentTime);
  String token=PortalUUIDUtil.generate();
  while (_tokens.putIfAbsent(expireTime,token) != null) {
    expireTime++;
  }
  return token;
}
