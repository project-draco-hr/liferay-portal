{
  try {
    visitPortletPreferences(portletId,ownerType,new Visitor<PortletPreferencesRow>(){
      @Override public void visit(      PortletPreferencesRow portletPreferencesRow) throws SQLException {
        portletPreferencesRow._portletPreferencesId=increment();
        portletPreferencesRow._ownerType=PortletKeys.PREFS_OWNER_TYPE_GROUP;
        portletPreferencesRow._portletId=serviceName;
        if (ownerType == PortletKeys.PREFS_OWNER_TYPE_LAYOUT) {
          long plid=portletPreferencesRow._plid;
          long groupId=getGroupId(plid);
          portletPreferencesRow._ownerId=groupId;
          portletPreferencesRow._plid=0;
          _logCopyOfServiceSettings(portletId,plid,serviceName,groupId);
        }
        addPortletPreferences(portletPreferencesRow);
      }
    }
);
  }
 catch (  SQLException sqle) {
    throw new PortalException("Unable to create service settings for portlet " + portletId,sqle);
  }
catch (  RuntimeException re) {
    throw new SystemException("Unable to create service settings for portlet " + portletId,re);
  }
}
