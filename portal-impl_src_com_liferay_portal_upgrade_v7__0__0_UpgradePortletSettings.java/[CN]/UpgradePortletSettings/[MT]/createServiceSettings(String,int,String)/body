{
  try {
    visitPortletPreferences(portletId,ownerType,new Visitor<PortletPreferencesRow>(){
      @Override public void visit(      PortletPreferencesRow portletPreferencesRow) throws SQLException {
        portletPreferencesRow.portletPreferencesId=increment();
        portletPreferencesRow.ownerType=PortletKeys.PREFS_OWNER_TYPE_GROUP;
        portletPreferencesRow.portletId=serviceName;
        if (ownerType == PortletKeys.PREFS_OWNER_TYPE_LAYOUT) {
          long plid=portletPreferencesRow.plid;
          long groupId=getGroupIdFromPlid(plid);
          portletPreferencesRow.ownerId=groupId;
          portletPreferencesRow.plid=0;
          _logCopyOfServiceSettings(portletId,plid,serviceName,groupId);
        }
        addPortletPreferences(portletPreferencesRow);
      }
    }
);
  }
 catch (  SQLException sqle) {
    throw new PortalException("Unable to create service settings for portlet " + portletId,sqle);
  }
catch (  RuntimeException re) {
    throw new SystemException("Unable to create service settings for portlet " + portletId,re);
  }
}
