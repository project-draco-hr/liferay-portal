{
  String className=clazz.getName();
  PortalCache<Serializable,Serializable> portalCache=_portalCaches.get(className);
  if ((portalCache == null) && createIfAbsent) {
    String groupKey=_GROUP_KEY_PREFIX.concat(className);
    portalCache=(PortalCache<Serializable,Serializable>)_multiVMPool.getPortalCache(groupKey,PropsValues.VALUE_OBJECT_ENTITY_BLOCKING_CACHE);
    if (PropsValues.VALUE_OBJECT_MVCC_ENTITY_CACHE_ENABLED && MVCCModel.class.isAssignableFrom(clazz)) {
      portalCache=(PortalCache<Serializable,Serializable>)MVCCPortalCacheFactory.createMVCCEhcachePortalCache(portalCache);
    }
    PortalCache<Serializable,Serializable> previousPortalCache=_portalCaches.putIfAbsent(className,portalCache);
    if (previousPortalCache != null) {
      portalCache=previousPortalCache;
    }
  }
  return portalCache;
}
