{
  LayoutTestUtil.addLayout(_group.getGroupId(),"Layout 1");
  LayoutTestUtil.addLayout(_group.getGroupId(),"Layout 2");
  AssetCategory assetCategory=addAssetCategory(_group.getGroupId(),"Title","content");
  JournalArticle journalArticle=JournalTestUtil.addArticle(_group.getGroupId(),"Title","content");
  ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId());
  Map<String,String[]> parameters=StagingUtil.getStagingParameters();
  parameters.put(PortletDataHandlerKeys.PORTLET_CONFIGURATION + StringPool.UNDERLINE + PortletKeys.JOURNAL,new String[]{String.valueOf(stageJournal)});
  parameters.put(PortletDataHandlerKeys.PORTLET_CONFIGURATION_ALL,new String[]{Boolean.FALSE.toString()});
  parameters.put(PortletDataHandlerKeys.PORTLET_DATA + StringPool.UNDERLINE + PortletKeys.ASSET_CATEGORIES_ADMIN,new String[]{String.valueOf(stageAssetCategories)});
  parameters.put(PortletDataHandlerKeys.PORTLET_DATA + StringPool.UNDERLINE + PortletKeys.JOURNAL,new String[]{String.valueOf(stageJournal)});
  parameters.put(PortletDataHandlerKeys.PORTLET_DATA_ALL,new String[]{Boolean.FALSE.toString()});
  parameters.put(PortletDataHandlerKeys.PORTLET_SETUP + StringPool.UNDERLINE + PortletKeys.JOURNAL,new String[]{String.valueOf(stageJournal)});
  serviceContext.setAttribute(StagingUtil.getStagedPortletId(PortletKeys.JOURNAL),stageJournal);
  for (  String parameterName : parameters.keySet()) {
    serviceContext.setAttribute(parameterName,parameters.get(parameterName)[0]);
  }
  enableLocalStaging(branching,serviceContext);
  Group stagingGroup=_group.getStagingGroup();
  AssetCategory stagingAssetCategory=AssetCategoryLocalServiceUtil.getCategory(assetCategory.getUuid(),stagingGroup.getGroupId());
  stagingAssetCategory=updateAssetCategory(stagingAssetCategory,"new name");
  JournalArticle stagingJournalArticle=JournalArticleLocalServiceUtil.getArticleByUrlTitle(stagingGroup.getGroupId(),journalArticle.getUrlTitle());
  stagingJournalArticle=JournalTestUtil.updateArticle(stagingJournalArticle,"Title2",stagingJournalArticle.getContent());
  StagingUtil.publishLayouts(TestPropsValues.getUserId(),stagingGroup.getGroupId(),_group.getGroupId(),false,parameters,null,null);
  assetCategory=AssetCategoryLocalServiceUtil.getCategory(assetCategory.getUuid(),_group.getGroupId());
  journalArticle=JournalArticleLocalServiceUtil.getArticle(_group.getGroupId(),journalArticle.getArticleId());
  if (stageAssetCategories) {
    for (    Locale locale : _locales) {
      Assert.assertEquals(assetCategory.getTitle(locale),stagingAssetCategory.getTitle(locale));
    }
  }
 else {
    for (    Locale locale : _locales) {
      Assert.assertNotEquals(assetCategory.getTitle(locale),stagingAssetCategory.getTitle(locale));
    }
  }
  if (stageJournal) {
    for (    Locale locale : _locales) {
      Assert.assertEquals(journalArticle.getTitle(locale),stagingJournalArticle.getTitle(locale));
    }
  }
 else {
    for (    Locale locale : _locales) {
      Assert.assertNotEquals(journalArticle.getTitle(locale),stagingJournalArticle.getTitle(locale));
    }
  }
}
