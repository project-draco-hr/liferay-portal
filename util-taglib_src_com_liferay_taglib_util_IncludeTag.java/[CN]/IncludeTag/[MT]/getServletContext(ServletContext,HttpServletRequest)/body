{
  if (Validator.isNull(_portletId)) {
    return servletContext;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),_portletId);
  if (portlet == null) {
    return servletContext;
  }
  PortletApp portletApp=portlet.getPortletApp();
  if (!portletApp.isWARFile()) {
    return servletContext;
  }
  PortletConfig portletConfig=PortletConfigFactory.create(portlet,servletContext);
  PortletContextImpl portletContextImpl=(PortletContextImpl)portletConfig.getPortletContext();
  return portletContextImpl.getServletContext();
}
