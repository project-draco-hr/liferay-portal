{
  try {
    String page=null;
    if (_useCustomPage) {
      page=getCustomPage(servletContext,request);
    }
    if (Validator.isNull(page)) {
      page=getPage();
    }
    if (Validator.isNull(page)) {
      page=getEndPage();
    }
    callSetAttributes();
    if (themeResourceExists(page)) {
      doIncludeTheme(page);
      return EVAL_PAGE;
    }
    if (!FileAvailabilityUtil.isAvailable(servletContext,page)) {
      return processEndTag();
    }
    doInclude(page,false);
    return EVAL_PAGE;
  }
 catch (  Exception e) {
    throw new JspException(e);
  }
 finally {
    clearDynamicAttributes();
    clearParams();
    clearProperties();
    cleanUpSetAttributes();
    if (!ServerDetector.isResin()) {
      setPage(null);
      setUseCustomPage(true);
      cleanUp();
    }
  }
}
