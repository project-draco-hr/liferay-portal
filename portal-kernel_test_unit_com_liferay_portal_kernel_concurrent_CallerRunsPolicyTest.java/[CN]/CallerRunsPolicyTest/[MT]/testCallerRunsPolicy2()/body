{
  MarkerThreadPoolHandler markerThreadPoolHandler=new MarkerThreadPoolHandler();
  ThreadPoolExecutor threadPoolExecutor=new ThreadPoolExecutor(1,1,TestUtil.KEEPALIVE_TIME,TimeUnit.MILLISECONDS,true,1,new CallerRunsPolicy(),Executors.defaultThreadFactory(),markerThreadPoolHandler);
  try {
    threadPoolExecutor.execute(new MarkerBlockingJob(true));
    threadPoolExecutor.execute(new MarkerBlockingJob(true));
    MarkerBlockingJob markerBlockingJob=new MarkerBlockingJob();
    threadPoolExecutor.execute(markerBlockingJob);
    Assert.assertTrue(markerBlockingJob.isEnded());
    Assert.assertTrue(markerThreadPoolHandler.isBeforeExecuteRan());
    Assert.assertTrue(markerThreadPoolHandler.isAfterExecuteRan());
  }
  finally {
    TestUtil.closePool(threadPoolExecutor,true);
  }
}
