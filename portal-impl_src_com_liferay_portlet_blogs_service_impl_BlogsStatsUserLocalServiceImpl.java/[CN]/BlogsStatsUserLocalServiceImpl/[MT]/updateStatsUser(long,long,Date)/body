{
  int entryCount=blogsEntryPersistence.countByG_U_S(groupId,userId,WorkflowConstants.STATUS_APPROVED);
  if (entryCount == 0) {
    int blogsStatsCount=blogsStatsUserPersistence.countByG_U(groupId,userId);
    if (blogsStatsCount > 0) {
      blogsStatsUserPersistence.removeByG_U(groupId,userId);
    }
    return;
  }
  BlogsStatsUser statsUser=getStatsUser(groupId,userId);
  statsUser.setEntryCount(entryCount);
  BlogsEntry blogsEntry=blogsEntryPersistence.findByG_U_S_First(groupId,userId,WorkflowConstants.STATUS_APPROVED,new EntryDisplayDateComparator());
  Date lastDisplayDate=blogsEntry.getDisplayDate();
  Date lastPostDate=statsUser.getLastPostDate();
  if (displayDate != null) {
    if (lastPostDate == null) {
      statsUser.setLastPostDate(displayDate);
    }
 else     if (displayDate.after(lastPostDate)) {
      statsUser.setLastPostDate(displayDate);
    }
 else     if (lastDisplayDate.before(lastPostDate)) {
      statsUser.setLastPostDate(lastDisplayDate);
    }
  }
 else   if (lastDisplayDate.before(lastPostDate)) {
    statsUser.setLastPostDate(lastDisplayDate);
  }
  blogsStatsUserPersistence.update(statsUser,false);
}
