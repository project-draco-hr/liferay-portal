{
  Indexer<?> indexer=IndexerRegistryUtil.getIndexer(className);
  if (indexer == null) {
    return;
  }
  for (  long companyId : companyIds) {
    ReindexStatusMessageSenderUtil.sendStatusMessage(ReindexBackgroundTaskConstants.SINGLE_START,companyId,companyIds);
    try {
      SearchEngineHelperUtil.deleteEntityDocuments(indexer.getSearchEngineId(),companyId,className,true);
      indexer.reindex(new String[]{String.valueOf(companyId)});
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
 finally {
      ReindexStatusMessageSenderUtil.sendStatusMessage(ReindexBackgroundTaskConstants.SINGLE_END,companyId,companyIds);
    }
  }
}
