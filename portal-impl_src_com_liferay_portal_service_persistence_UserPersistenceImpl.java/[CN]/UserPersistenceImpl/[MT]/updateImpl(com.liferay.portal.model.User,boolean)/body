{
  user=toUnwrappedModel(user);
  boolean isNew=user.isNew();
  UserModelImpl userModelImpl=(UserModelImpl)user;
  if (Validator.isNull(user.getUuid())) {
    String uuid=PortalUUIDUtil.generate();
    user.setUuid(uuid);
  }
  Session session=null;
  try {
    session=openSession();
    BatchSessionUtil.update(session,user,merge);
    user.setNew(false);
  }
 catch (  Exception e) {
    throw processException(e);
  }
 finally {
    closeSession(session);
  }
  FinderCacheUtil.clearCache(FINDER_CLASS_NAME_LIST_WITH_PAGINATION);
  if (isNew || !UserModelImpl.COLUMN_BITMASK_ENABLED) {
    FinderCacheUtil.clearCache(FINDER_CLASS_NAME_LIST_WITHOUT_PAGINATION);
  }
 else {
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_UUID.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{userModelImpl.getOriginalUuid()};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_UUID,args);
      FinderCacheUtil.removeResult(FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_UUID,args);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_COMPANYID.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_COMPANYID,args);
      FinderCacheUtil.removeResult(FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_COMPANYID,args);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_EMAILADDRESS.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{userModelImpl.getOriginalEmailAddress()};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_EMAILADDRESS,args);
      FinderCacheUtil.removeResult(FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_EMAILADDRESS,args);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_C_S.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Integer.valueOf(userModelImpl.getOriginalStatus())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_S,args);
      FinderCacheUtil.removeResult(FINDER_PATH_WITHOUT_PAGINATION_FIND_BY_C_S,args);
    }
  }
  EntityCacheUtil.putResult(UserModelImpl.ENTITY_CACHE_ENABLED,UserImpl.class,user.getPrimaryKey(),user);
  if (isNew) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_CONTACTID,new Object[]{Long.valueOf(user.getContactId())},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_PORTRAITID,new Object[]{Long.valueOf(user.getPortraitId())},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_U,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getUserId())},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_DU,new Object[]{Long.valueOf(user.getCompanyId()),Boolean.valueOf(user.getDefaultUser())},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_SN,new Object[]{Long.valueOf(user.getCompanyId()),user.getScreenName()},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_EA,new Object[]{Long.valueOf(user.getCompanyId()),user.getEmailAddress()},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_FID,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getFacebookId())},user);
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_O,new Object[]{Long.valueOf(user.getCompanyId()),user.getOpenId()},user);
  }
 else {
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_CONTACTID.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalContactId())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_CONTACTID,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_CONTACTID,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_CONTACTID,new Object[]{Long.valueOf(user.getContactId())},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_PORTRAITID.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalPortraitId())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_PORTRAITID,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_PORTRAITID,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_PORTRAITID,new Object[]{Long.valueOf(user.getPortraitId())},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_U.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Long.valueOf(userModelImpl.getOriginalUserId())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_U,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_U,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_U,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getUserId())},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_DU.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Boolean.valueOf(userModelImpl.getOriginalDefaultUser())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_DU,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_DU,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_DU,new Object[]{Long.valueOf(user.getCompanyId()),Boolean.valueOf(user.getDefaultUser())},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_SN.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalScreenName()};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_SN,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_SN,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_SN,new Object[]{Long.valueOf(user.getCompanyId()),user.getScreenName()},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_EA.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalEmailAddress()};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_EA,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_EA,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_EA,new Object[]{Long.valueOf(user.getCompanyId()),user.getEmailAddress()},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_FID.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Long.valueOf(userModelImpl.getOriginalFacebookId())};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_FID,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_FID,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_FID,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getFacebookId())},user);
    }
    if ((userModelImpl.getColumnBitmask() & FINDER_PATH_FETCH_BY_C_O.getColumnBitmask()) != 0) {
      Object[] args=new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalOpenId()};
      FinderCacheUtil.removeResult(FINDER_PATH_COUNT_BY_C_O,args);
      FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_O,args);
      FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_O,new Object[]{Long.valueOf(user.getCompanyId()),user.getOpenId()},user);
    }
  }
  return user;
}
