{
  user=toUnwrappedModel(user);
  boolean isNew=user.isNew();
  UserModelImpl userModelImpl=(UserModelImpl)user;
  if (Validator.isNull(user.getUuid())) {
    String uuid=PortalUUIDUtil.generate();
    user.setUuid(uuid);
  }
  Session session=null;
  try {
    session=openSession();
    BatchSessionUtil.update(session,user,merge);
    user.setNew(false);
  }
 catch (  Exception e) {
    throw processException(e);
  }
 finally {
    closeSession(session);
  }
  FinderCacheUtil.clearCache(FINDER_CLASS_NAME_LIST);
  EntityCacheUtil.putResult(UserModelImpl.ENTITY_CACHE_ENABLED,UserImpl.class,user.getPrimaryKey(),user);
  if (!isNew && (user.getContactId() != userModelImpl.getOriginalContactId())) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_CONTACTID,new Object[]{Long.valueOf(userModelImpl.getOriginalContactId())});
  }
  if (isNew || (user.getContactId() != userModelImpl.getOriginalContactId())) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_CONTACTID,new Object[]{Long.valueOf(user.getContactId())},user);
  }
  if (!isNew && (user.getPortraitId() != userModelImpl.getOriginalPortraitId())) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_PORTRAITID,new Object[]{Long.valueOf(userModelImpl.getOriginalPortraitId())});
  }
  if (isNew || (user.getPortraitId() != userModelImpl.getOriginalPortraitId())) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_PORTRAITID,new Object[]{Long.valueOf(user.getPortraitId())},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getUserId() != userModelImpl.getOriginalUserId()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_U,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Long.valueOf(userModelImpl.getOriginalUserId())});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getUserId() != userModelImpl.getOriginalUserId()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_U,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getUserId())},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getDefaultUser() != userModelImpl.getOriginalDefaultUser()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_DU,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Boolean.valueOf(userModelImpl.getOriginalDefaultUser())});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getDefaultUser() != userModelImpl.getOriginalDefaultUser()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_DU,new Object[]{Long.valueOf(user.getCompanyId()),Boolean.valueOf(user.getDefaultUser())},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getScreenName(),userModelImpl.getOriginalScreenName()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_SN,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalScreenName()});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getScreenName(),userModelImpl.getOriginalScreenName()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_SN,new Object[]{Long.valueOf(user.getCompanyId()),user.getScreenName()},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getEmailAddress(),userModelImpl.getOriginalEmailAddress()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_EA,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalEmailAddress()});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getEmailAddress(),userModelImpl.getOriginalEmailAddress()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_EA,new Object[]{Long.valueOf(user.getCompanyId()),user.getEmailAddress()},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getFacebookId() != userModelImpl.getOriginalFacebookId()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_FID,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),Long.valueOf(userModelImpl.getOriginalFacebookId())});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || (user.getFacebookId() != userModelImpl.getOriginalFacebookId()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_FID,new Object[]{Long.valueOf(user.getCompanyId()),Long.valueOf(user.getFacebookId())},user);
  }
  if (!isNew && ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getOpenId(),userModelImpl.getOriginalOpenId()))) {
    FinderCacheUtil.removeResult(FINDER_PATH_FIND_ALL,FINDER_ARGS_EMPTY);
    FinderCacheUtil.removeResult(FINDER_PATH_FETCH_BY_C_O,new Object[]{Long.valueOf(userModelImpl.getOriginalCompanyId()),userModelImpl.getOriginalOpenId()});
  }
  if (isNew || ((user.getCompanyId() != userModelImpl.getOriginalCompanyId()) || !Validator.equals(user.getOpenId(),userModelImpl.getOriginalOpenId()))) {
    FinderCacheUtil.putResult(FINDER_PATH_FETCH_BY_C_O,new Object[]{Long.valueOf(user.getCompanyId()),user.getOpenId()},user);
  }
  return user;
}
