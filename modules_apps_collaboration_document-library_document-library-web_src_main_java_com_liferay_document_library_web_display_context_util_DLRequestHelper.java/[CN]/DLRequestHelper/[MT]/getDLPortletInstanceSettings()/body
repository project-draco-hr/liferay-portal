{
  if (_dlGroupServiceSettings != null) {
    return _dlPortletInstanceSettings;
  }
  HttpServletRequest request=getRequest();
  _dlPortletInstanceSettings=(DLPortletInstanceSettings)request.getAttribute(DLWebKeys.DOCUMENT_LIBRARY_PORTLET_INSTANCE_SETTINGS);
  if (_dlPortletInstanceSettings != null) {
    return _dlPortletInstanceSettings;
  }
  String portletResource=getPortletResource();
  try {
    if (Validator.isNotNull(portletResource)) {
      _dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(getLayout(),getResourcePortletId(),request.getParameterMap());
    }
 else {
      _dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(getLayout(),getPortletId());
    }
  }
 catch (  PortalException pe) {
    throw new SystemException(pe);
  }
  request.setAttribute(DLWebKeys.DOCUMENT_LIBRARY_PORTLET_INSTANCE_SETTINGS,_dlPortletInstanceSettings);
  return _dlPortletInstanceSettings;
}
