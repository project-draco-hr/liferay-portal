{
  if (_dlPortletInstanceSettings == null) {
    HttpServletRequest request=getRequest();
    _dlPortletInstanceSettings=(DLPortletInstanceSettings)request.getAttribute("DL_PORTLET_INSTANCE_SETTINGS");
    if (_dlPortletInstanceSettings == null) {
      String portletResource=getPortletResource();
      try {
        if (Validator.isNotNull(portletResource)) {
          _dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(getLayout(),getResourcePortletId(),request.getParameterMap());
        }
 else {
          _dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(getLayout(),getPortletId());
        }
      }
 catch (      PortalException pe) {
        throw new SystemException(pe);
      }
      request.setAttribute("DL_PORTLET_INSTANCE_SETTINGS",_dlPortletInstanceSettings);
    }
  }
  return _dlPortletInstanceSettings;
}
