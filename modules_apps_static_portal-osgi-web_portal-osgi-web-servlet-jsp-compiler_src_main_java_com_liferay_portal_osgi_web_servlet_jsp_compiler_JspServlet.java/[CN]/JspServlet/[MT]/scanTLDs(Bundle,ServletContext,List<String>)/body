{
  Boolean analyzedTlds=(Boolean)servletContext.getAttribute(_ANALYZED_TLDS);
  if ((analyzedTlds != null) && analyzedTlds.booleanValue()) {
    return;
  }
  servletContext.setAttribute(_ANALYZED_TLDS,Boolean.TRUE);
  BundleWiring bundleWiring=bundle.adapt(BundleWiring.class);
  Collection<String> resources=bundleWiring.listResources("META-INF/","*.tld",BundleWiring.LISTRESOURCES_RECURSE);
  if (resources == null) {
    return;
  }
  for (  String resource : resources) {
    URL url=bundle.getResource(resource);
    if (url == null) {
      continue;
    }
    try (InputStream inputStream=url.openStream()){
      ParserUtils parserUtils=new ParserUtils(true);
      TreeNode treeNode=parserUtils.parseXMLDocument(url.getPath(),inputStream,false);
      Iterator<TreeNode> iterator=treeNode.findChildren("listener");
      while (iterator.hasNext()) {
        TreeNode listenerTreeNode=iterator.next();
        TreeNode listenerClassTreeNode=listenerTreeNode.findChild("listener-class");
        if (listenerClassTreeNode == null) {
          continue;
        }
        String listenerClassName=listenerClassTreeNode.getBody();
        if (listenerClassName == null) {
          continue;
        }
        listenerClassNames.add(listenerClassName);
      }
    }
 catch (    Exception e) {
      servletContext.log(e.getMessage(),e);
    }
  }
}
