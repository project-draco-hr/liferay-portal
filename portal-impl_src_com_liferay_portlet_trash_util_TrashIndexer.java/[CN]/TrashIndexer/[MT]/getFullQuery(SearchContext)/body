{
  try {
    BooleanQuery contextQuery=BooleanQueryFactoryUtil.create(searchContext);
    contextQuery.addRequiredTerm(Field.COMPANY_ID,searchContext.getCompanyId());
    BooleanQuery excludeAttachmentsQuery=BooleanQueryFactoryUtil.create(searchContext);
    excludeAttachmentsQuery.addRequiredTerm(Field.ENTRY_CLASS_NAME,DLFileEntryConstants.getClassName());
    excludeAttachmentsQuery.addRequiredTerm(Field.HIDDEN,true);
    contextQuery.add(excludeAttachmentsQuery,BooleanClauseOccur.MUST_NOT);
    BooleanQuery groupQuery=BooleanQueryFactoryUtil.create(searchContext);
    for (    long groupId : searchContext.getGroupIds()) {
      groupQuery.addTerm(Field.GROUP_ID,String.valueOf(groupId),false,BooleanClauseOccur.SHOULD);
    }
    contextQuery.add(groupQuery,BooleanClauseOccur.MUST);
    contextQuery.addRequiredTerm(Field.STATUS,WorkflowConstants.STATUS_IN_TRASH);
    BooleanQuery fullQuery=createFullQuery(contextQuery,searchContext);
    return fullQuery;
  }
 catch (  SearchException se) {
    throw se;
  }
catch (  Exception e) {
    throw new SearchException(e);
  }
}
