{
  User user=UserUtil.findByPrimaryKey(userId);
  String groupId=PortalUtil.getPortletGroupId(plid);
  Date now=new Date();
  validate(name);
  String nodeId=Long.toString(CounterServiceUtil.increment(WikiNode.class.getName()));
  WikiNode node=WikiNodeUtil.create(nodeId);
  node.setGroupId(groupId);
  node.setCompanyId(user.getCompanyId());
  node.setUserId(user.getUserId());
  node.setUserName(user.getFullName());
  node.setCreateDate(now);
  node.setModifiedDate(now);
  node.setName(name);
  node.setDescription(description);
  WikiNodeUtil.update(node);
  addNodeResources(node,addCommunityPermissions,addGuestPermissions);
  return node;
}
