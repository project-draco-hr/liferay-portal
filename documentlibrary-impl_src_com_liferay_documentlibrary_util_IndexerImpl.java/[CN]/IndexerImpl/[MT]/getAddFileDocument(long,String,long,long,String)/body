{
  try {
    DLFileEntry fileEntry=null;
    try {
      fileEntry=DLFileEntryLocalServiceUtil.getFileEntry(repositoryId,fileName);
    }
 catch (    NoSuchFileEntryException nsfe) {
      if (_log.isWarnEnabled()) {
        _log.warn("File " + fileName + " in repository "+ repositoryId+ " exists in the JCR but does "+ "not exist in the database");
      }
      return null;
    }
    StringMaker sm=new StringMaker();
    sm.append(fileEntry.getTitle());
    sm.append(StringPool.SPACE);
    sm.append(fileEntry.getDescription());
    sm.append(StringPool.SPACE);
    Properties extraSettingsProps=fileEntry.getExtraSettingsProperties();
    Iterator itr=(Iterator)extraSettingsProps.entrySet().iterator();
    while (itr.hasNext()) {
      Map.Entry entry=(Map.Entry)itr.next();
      String value=GetterUtil.getString((String)entry.getValue());
      sm.append(value);
    }
    String properties=sm.toString();
    return getAddFileDocument(companyId,portletId,groupId,repositoryId,fileName,properties);
  }
 catch (  PortalException pe) {
    throw new IOException(pe.getMessage());
  }
catch (  SystemException se) {
    throw new IOException(se.getMessage());
  }
}
