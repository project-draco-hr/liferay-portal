{
  User user=userPersistence.findByPrimaryKey(userId);
  validate(0,groupId,name);
  long teamId=counterLocalService.increment();
  Team team=teamPersistence.create(teamId);
  team.setUserId(userId);
  team.setCompanyId(user.getCompanyId());
  team.setUserName(user.getFullName());
  team.setGroupId(groupId);
  team.setName(name);
  team.setDescription(description);
  teamPersistence.update(team);
  resourceLocalService.addResources(user.getCompanyId(),groupId,userId,Team.class.getName(),team.getTeamId(),false,true,true);
  roleLocalService.addRole(userId,Team.class.getName(),teamId,String.valueOf(teamId),null,null,RoleConstants.TYPE_PROVIDER,null,null);
  return team;
}
