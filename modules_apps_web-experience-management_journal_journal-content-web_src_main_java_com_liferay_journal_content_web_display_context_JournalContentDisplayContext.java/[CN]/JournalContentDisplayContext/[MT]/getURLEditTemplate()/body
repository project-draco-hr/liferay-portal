{
  ThemeDisplay themeDisplay=(ThemeDisplay)_portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PortletURL portletURL=PortletURLFactoryUtil.create(_portletRequest,PortletProviderUtil.getPortletId(DDMTemplate.class.getName(),PortletProvider.Action.EDIT),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
  DDMTemplate ddmTemplate=getDDMTemplate();
  if (ddmTemplate == null) {
    return StringPool.BLANK;
  }
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  PortletURL redirectURL=PortletURLFactoryUtil.create(_portletRequest,portletDisplay.getId(),themeDisplay.getPlid(),PortletRequest.RENDER_PHASE);
  try {
    portletURL.setParameter("hideDefaultSuccessMessage",Boolean.TRUE.toString());
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    portletURL.setPortletMode(PortletMode.VIEW);
    redirectURL.setWindowState(LiferayWindowState.POP_UP);
  }
 catch (  Exception e) {
    _log.error("Unable to set URL window state and portlet mode",e);
  }
  redirectURL.setParameter("mvcPath","/update_journal_article_redirect.jsp");
  redirectURL.setParameter("referringPortletResource",portletDisplay.getId());
  portletURL.setParameter("mvcPath","/edit_template.jsp");
  portletURL.setParameter("navigationStartsOn","SELECT_TEMPLATE");
  portletURL.setParameter("redirect",redirectURL.toString());
  portletURL.setParameter("showBackURL",Boolean.FALSE.toString());
  portletURL.setParameter("showCacheableInput",Boolean.TRUE.toString());
  portletURL.setParameter("groupId",String.valueOf(ddmTemplate.getGroupId()));
  portletURL.setParameter("refererPortletName",PortletProviderUtil.getPortletId(JournalArticle.class.getName(),PortletProvider.Action.EDIT));
  portletURL.setParameter("templateId",String.valueOf(ddmTemplate.getTemplateId()));
  portletURL.setParameter("showHeader",Boolean.FALSE.toString());
  return portletURL.toString();
}
