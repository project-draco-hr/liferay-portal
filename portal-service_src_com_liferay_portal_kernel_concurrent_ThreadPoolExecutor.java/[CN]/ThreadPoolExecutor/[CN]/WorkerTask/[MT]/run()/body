{
  boolean[] cleanUpMarker=new boolean[1];
  try {
    Runnable task=_task;
    do {
      if (task != null) {
        _runTask(task);
        task=null;
      }
    }
 while ((task=_getTask(this,cleanUpMarker)) != null);
  }
  finally {
    if (!cleanUpMarker[0]) {
      _mainLock.lock();
      try {
        _completedTaskCount+=_localCompletedTaskCount;
        _workerTaskSet.remove(this);
        if (--_poolSize == 0) {
          _tryTerminate();
        }
      }
  finally {
        _mainLock.unlock();
      }
    }
    _threadPoolHandler.beforeThreadEnd(_thread);
  }
}
