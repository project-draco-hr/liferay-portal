{
  List<WikiPage> intermediatePages=new ArrayList<WikiPage>();
  double previousVersion=0;
  double nextVersion=0;
  List<WikiPage> pages=WikiPageLocalServiceUtil.getPages(nodeId,title,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new PageVersionComparator(true));
  for (  WikiPage page : pages) {
    if ((page.getVersion() < sourceVersion) && (page.getVersion() > previousVersion)) {
      previousVersion=page.getVersion();
    }
    if ((page.getVersion() > targetVersion) && ((page.getVersion() < nextVersion) || (nextVersion == 0))) {
      nextVersion=page.getVersion();
    }
    if ((page.getVersion() > sourceVersion) && (page.getVersion() <= targetVersion)) {
      intermediatePages.add(page);
    }
  }
  List<DiffVersion> diffVersions=new ArrayList<DiffVersion>();
  for (  WikiPage page : intermediatePages) {
    String extraInfo=StringPool.BLANK;
    if (page.isMinorEdit()) {
      extraInfo=LanguageUtil.get(pageContext,"minor-edit");
    }
    DiffVersion diffVersion=new DiffVersion(page.getUserId(),page.getVersion(),page.getModifiedDate(),page.getSummary(),extraInfo);
    diffVersions.add(diffVersion);
  }
  return new DiffVersionsInfo(diffVersions,nextVersion,previousVersion);
}
