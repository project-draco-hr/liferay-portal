{
  WikiEngine engine=_getEngine(page.getFormat());
  String content=engine.convert(page,editPageURL);
  if ((editPageURL != null) && (editPageURL instanceof LiferayPortletURL)) {
    LiferayPortletURL liferayPageURL=(LiferayPortletURL)viewPageURL;
    liferayPageURL.setParameter("nodeId",String.valueOf(page.getNodeId()));
    LiferayPortletURL liferayEditURL=(LiferayPortletURL)editPageURL;
    liferayEditURL.setParameter("nodeId",String.valueOf(page.getNodeId()));
    Iterator itr=engine.getOutgoingLinks(page).keySet().iterator();
    while (itr.hasNext()) {
      String title=(String)itr.next();
      content=_replaceLinks(title,content,liferayPageURL,liferayEditURL);
    }
    content=_replaceAttachments(content,page.getTitle(),attachmentURLPrefix);
  }
  return content;
}
