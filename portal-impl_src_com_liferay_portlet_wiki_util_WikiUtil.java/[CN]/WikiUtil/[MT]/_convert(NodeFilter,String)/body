{
  if (content == null) {
    return StringPool.BLANK;
  }
  StringWriter out=new StringWriter();
  filter.filter(new StringReader(content),out);
  String newContent=out.toString();
  String portletURLToString=StringPool.BLANK;
  LiferayPortletURL portletURL=(LiferayPortletURL)filter.getPortletURL();
  if (portletURL != null) {
    portletURL.setParameter("nodeId",String.valueOf(filter.getNodeId()));
    Iterator itr=filter.getTitles().keySet().iterator();
    while (itr.hasNext()) {
      String title=(String)itr.next();
      portletURL.setParameter("title",title,false);
      portletURLToString=portletURL.toString();
      newContent=StringUtil.replace(newContent,"[$BEGIN_PAGE_TITLE$]" + title + "[$END_PAGE_TITLE$]",portletURLToString);
    }
  }
  return newContent;
}
