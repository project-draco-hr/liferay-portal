{
  nodes=ListUtil.copy(nodes);
  if (needOrder) {
    nodes=_orderNodes(nodes,visibleNodes);
  }
  Iterator<WikiNode> itr=nodes.iterator();
  while (itr.hasNext()) {
    WikiNode node=itr.next();
    if (ArrayUtil.contains(hiddenNodes,node.getName()) || !WikiNodePermission.contains(permissionChecker,node,ActionKeys.VIEW)) {
      itr.remove();
    }
 else     if (returnFirst) {
      List<WikiNode> firstNodeList=new ArrayList<WikiNode>(1);
      firstNodeList.add(node);
      return firstNodeList;
    }
  }
  if (returnFirst) {
    return Collections.EMPTY_LIST;
  }
  return nodes;
}
