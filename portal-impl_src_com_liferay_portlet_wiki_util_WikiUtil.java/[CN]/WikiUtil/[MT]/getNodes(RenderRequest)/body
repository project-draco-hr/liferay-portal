{
  ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=themeDisplay.getLayout().getGroupId();
  String allNodes=ListUtil.toString(WikiNodeLocalServiceUtil.getNodes(groupId),"name");
  String[] visibleNodes=StringUtil.split(req.getPreferences().getValue("visible-nodes",allNodes));
  String[] hiddenNodes=StringUtil.split(req.getPreferences().getValue("hidden-nodes",StringPool.BLANK));
  return getNodes(groupId,themeDisplay.getPermissionChecker(),visibleNodes,hiddenNodes);
}
