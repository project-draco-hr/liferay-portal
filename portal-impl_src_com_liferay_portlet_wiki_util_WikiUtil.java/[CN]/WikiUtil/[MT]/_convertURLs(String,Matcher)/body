{
  StringBuffer sb=new StringBuffer();
  while (matcher.find()) {
    String replacement=null;
    if (matcher.groupCount() >= 1) {
      String encodedTitle=HttpUtil.encodeURL(HtmlUtil.unescape(matcher.group(1)));
      replacement=url.replace("$1",encodedTitle);
    }
 else {
      replacement=url;
    }
    matcher.appendReplacement(sb,replacement);
  }
  return matcher.appendTail(sb).toString();
}
