{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long groupId=themeDisplay.getScopeGroupId();
  String allNodes=ListUtil.toString(WikiNodeLocalServiceUtil.getNodes(groupId),"name");
  String[] visibleNodes=StringUtil.split(portletRequest.getPreferences().getValue("visible-nodes",allNodes));
  String[] hiddenNodes=StringUtil.split(portletRequest.getPreferences().getValue("hidden-nodes",StringPool.BLANK));
  return getNodes(groupId,visibleNodes,hiddenNodes,themeDisplay.getPermissionChecker());
}
