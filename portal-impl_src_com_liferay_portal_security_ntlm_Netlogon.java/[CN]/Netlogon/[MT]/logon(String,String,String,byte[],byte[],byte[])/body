{
  try {
    connect();
    NetlogonAuthenticator authenticator=computeNetlogonAuthenticator();
    NetlogonIdentityInfo identity=new NetlogonIdentityInfo(domain,0x00000820,0,0,userName,workstation);
    NetlogonNetworkInfo logonInformation=new NetlogonNetworkInfo(identity,serverChallenge,ntResponse,lmResponse);
    NetrLogonSamLogon msg=new NetrLogonSamLogon(_domainControllerName,_serviceAccount.getComputerName(),authenticator,new NetlogonAuthenticator(),2,logonInformation,2,new NetlogonValidationSamInfo(),0);
    _handle.sendrecv(msg);
    if (msg.getStatus() == 0) {
      NetlogonValidationSamInfo samInfo=msg.getNetlogonValidationSamInfo();
      UnicodeString name=new UnicodeString(samInfo.getEffectiveName(),false);
      return new NtlmUserAccount(name.toString());
    }
 else {
      SmbException se=new SmbException(msg.getStatus(),false);
      _log.warn(se);
    }
  }
 catch (  Exception e) {
    _log.error(e);
  }
 finally {
    try {
      disconnect();
    }
 catch (    Exception e) {
      _log.error(e);
    }
  }
  return null;
}
