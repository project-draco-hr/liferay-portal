{
  if (_log.isInfoEnabled()) {
    _log.info("Create new liferay data source");
  }
  DataSource newDataSource=DataSourceFactoryUtil.initDataSource(properties);
  DataSource oldDataSource=_liferayDataSourceWrapper.getWrappedDataSource();
  if (_log.isInfoEnabled()) {
    _log.info("Set new liferay data source");
  }
  _liferayDataSourceWrapper.setWrappedDataSource(newDataSource);
  if (_log.isInfoEnabled()) {
    _log.info("Destroy old liferay data source");
  }
  DataSourceFactoryUtil.destroyDataSource(oldDataSource);
  if (PropsValues.PERSISTENCE_PROVIDER.equalsIgnoreCase("jpa")) {
    if (_log.isInfoEnabled()) {
      _log.info("Reinitialize Hibernate for new liferay data source");
    }
    _reinitializeJPA("liferaySessionFactory",newDataSource);
  }
 else {
    if (_log.isInfoEnabled()) {
      _log.info("Reinitialize JPA for new liferay data source");
    }
    _reinitializeHibernate("liferaySessionFactory",newDataSource);
  }
}
