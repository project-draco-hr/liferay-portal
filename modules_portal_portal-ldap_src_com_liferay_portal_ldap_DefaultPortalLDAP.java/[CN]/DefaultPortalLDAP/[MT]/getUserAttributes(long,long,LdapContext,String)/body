{
  Properties userMappings=_ldapSettings.getUserMappings(ldapServerId,companyId);
  Properties userExpandoMappings=_ldapSettings.getUserExpandoMappings(ldapServerId,companyId);
  PropertiesUtil.merge(userMappings,userExpandoMappings);
  Properties contactMappings=_ldapSettings.getContactMappings(ldapServerId,companyId);
  Properties contactExpandoMappings=_ldapSettings.getContactExpandoMappings(ldapServerId,companyId);
  PropertiesUtil.merge(contactMappings,contactExpandoMappings);
  PropertiesUtil.merge(userMappings,contactMappings);
  String[] mappedUserAttributeIds=ArrayUtil.toStringArray(userMappings.values().toArray(new Object[userMappings.size()]));
  Attributes attributes=_getAttributes(ldapContext,fullDistinguishedName,mappedUserAttributeIds);
  if (_log.isDebugEnabled()) {
    for (    String attributeId : mappedUserAttributeIds) {
      Attribute attribute=attributes.get(attributeId);
      if (attribute == null) {
        continue;
      }
      _log.debug("LDAP user attribute " + attribute.toString());
    }
  }
  return attributes;
}
