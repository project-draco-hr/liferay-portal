{
  final CountDownLatch countDownLatch=new CountDownLatch(number);
  Filter filter=bundleContext.createFilter(filterString);
  ServiceTracker<?,?> serviceTracker=new ServiceTracker<Object,Object>(bundleContext,filter,null){
    @Override public void removedService(    ServiceReference<Object> reference,    Object service){
      countDownLatch.countDown();
      close();
    }
  }
;
  serviceTracker.open();
  return new Waiter(){
    @Override public boolean waitFor(    long timeout) throws InterruptedException {
      if (!countDownLatch.await(timeout,TimeUnit.MILLISECONDS)) {
        return false;
      }
      return true;
    }
  }
;
}
