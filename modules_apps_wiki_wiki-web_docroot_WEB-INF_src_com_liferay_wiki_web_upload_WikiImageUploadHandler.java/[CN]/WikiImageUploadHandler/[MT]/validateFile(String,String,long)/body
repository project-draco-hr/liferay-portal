{
  WikiWebComponentProvider wikiWebComponentProvider=WikiWebComponentProvider.getWikiWebComponentProvider();
  WikiGroupServiceConfiguration wikiGroupServiceConfiguration=wikiWebComponentProvider.getWikiGroupServiceConfiguration();
  long maxSize=wikiGroupServiceConfiguration.imageMaxSize();
  if ((maxSize > 0) && (size > maxSize)) {
    throw new PageAttachmentSizeException();
  }
  String extension=FileUtil.getExtension(fileName);
  for (  String imageExtension : wikiGroupServiceConfiguration.imageExtensions()) {
    if (StringPool.STAR.equals(imageExtension) || imageExtension.equals(StringPool.PERIOD + extension)) {
      return;
    }
  }
  throw new PageAttachmentNameException("Invalid image for file name " + fileName);
}
