{
  ExpandoTable table=expandoTablePersistence.findByPrimaryKey(tableId);
  ExpandoValue value=validate(0,tableId,name,type,defaultData);
  long columnId=counterLocalService.increment();
  ExpandoColumn column=expandoColumnPersistence.create(columnId);
  column.setCompanyId(table.getCompanyId());
  column.setTableId(tableId);
  column.setName(name);
  column.setType(type);
  column.setDefaultData(value.getData());
  expandoColumnPersistence.update(column,false);
  long companyId=CompanyThreadLocal.getCompanyId();
  resourceLocalService.addResources(companyId,0,0,ExpandoColumn.class.getName(),column.getColumnId(),false,false,false);
  return column;
}
