{
  if (Validator.isNull(name)) {
    throw new ColumnNameException("Name is null");
  }
  ExpandoColumn column=expandoColumnPersistence.fetchByT_N(tableId,name);
  if ((column != null) && (column.getColumnId() != columnId)) {
    StringBundler sb=new StringBundler(7);
    sb.append("{tableId=");
    sb.append(tableId);
    sb.append(", columnId=");
    sb.append(columnId);
    sb.append(", name=");
    sb.append(name);
    sb.append("}");
    throw new DuplicateColumnNameException(sb.toString());
  }
  if ((type != ExpandoColumnConstants.BOOLEAN) && (type != ExpandoColumnConstants.BOOLEAN_ARRAY) && (type != ExpandoColumnConstants.DATE)&& (type != ExpandoColumnConstants.DATE_ARRAY)&& (type != ExpandoColumnConstants.DOUBLE)&& (type != ExpandoColumnConstants.DOUBLE_ARRAY)&& (type != ExpandoColumnConstants.FLOAT)&& (type != ExpandoColumnConstants.FLOAT_ARRAY)&& (type != ExpandoColumnConstants.INTEGER)&& (type != ExpandoColumnConstants.INTEGER_ARRAY)&& (type != ExpandoColumnConstants.LONG)&& (type != ExpandoColumnConstants.LONG_ARRAY)&& (type != ExpandoColumnConstants.NUMBER)&& (type != ExpandoColumnConstants.NUMBER_ARRAY)&& (type != ExpandoColumnConstants.SHORT)&& (type != ExpandoColumnConstants.SHORT_ARRAY)&& (type != ExpandoColumnConstants.STRING)&& (type != ExpandoColumnConstants.STRING_ARRAY)&& (type != ExpandoColumnConstants.STRING_ARRAY_LOCALIZED)&& (type != ExpandoColumnConstants.STRING_LOCALIZED)) {
    throw new ColumnTypeException("Invalid type " + type);
  }
  ExpandoValue value=new ExpandoValueImpl();
  if (defaultData == null) {
    return value;
  }
  value.setColumnId(columnId);
  if (type == ExpandoColumnConstants.BOOLEAN) {
    value.setBoolean((Boolean)defaultData);
  }
 else   if (type == ExpandoColumnConstants.BOOLEAN_ARRAY) {
    value.setBooleanArray((boolean[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.DATE) {
    value.setDate((Date)defaultData);
  }
 else   if (type == ExpandoColumnConstants.DATE_ARRAY) {
    value.setDateArray((Date[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.DOUBLE) {
    value.setDouble((Double)defaultData);
  }
 else   if (type == ExpandoColumnConstants.DOUBLE_ARRAY) {
    value.setDoubleArray((double[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.FLOAT) {
    value.setFloat((Float)defaultData);
  }
 else   if (type == ExpandoColumnConstants.FLOAT_ARRAY) {
    value.setFloatArray((float[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.INTEGER) {
    value.setInteger((Integer)defaultData);
  }
 else   if (type == ExpandoColumnConstants.INTEGER_ARRAY) {
    value.setIntegerArray((int[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.LONG) {
    value.setLong((Long)defaultData);
  }
 else   if (type == ExpandoColumnConstants.LONG_ARRAY) {
    value.setLongArray((long[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.NUMBER) {
    value.setNumber((Number)defaultData);
  }
 else   if (type == ExpandoColumnConstants.NUMBER_ARRAY) {
    value.setNumberArray((Number[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.SHORT) {
    value.setShort((Short)defaultData);
  }
 else   if (type == ExpandoColumnConstants.SHORT_ARRAY) {
    value.setShortArray((short[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.STRING) {
    value.setString((String)defaultData);
  }
 else   if (type == ExpandoColumnConstants.STRING_ARRAY) {
    value.setStringArray((String[])defaultData);
  }
 else   if (type == ExpandoColumnConstants.STRING_ARRAY_LOCALIZED) {
    value.setStringArrayMap((Map<Locale,String[]>)defaultData,LocaleUtil.getDefault());
  }
 else   if (type == ExpandoColumnConstants.STRING_LOCALIZED) {
    value.setStringMap((Map<Locale,String>)defaultData,LocaleUtil.getDefault());
  }
  return value;
}
