{
  VelocityEngine velocityEngine=new VelocityEngine();
  velocityEngine.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM_CLASS,"org.apache.velocity.runtime.log.SimpleLog4JLogSystem");
  velocityEngine.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM + ".log4j.category","org.apache.velocity");
  velocityEngine.init();
  VelocityContext velocityContext=new VelocityContext();
  if (variables != null) {
    for (    Map.Entry<String,Object> entry : variables.entrySet()) {
      String key=entry.getKey();
      Object value=entry.getValue();
      if (Validator.isNotNull(key)) {
        velocityContext.put(key,value);
      }
    }
  }
  UnsyncStringWriter unsyncStringWriter=new UnsyncStringWriter();
  velocityEngine.evaluate(velocityContext,unsyncStringWriter,VelocityUtil.class.getName(),input);
  return unsyncStringWriter.toString();
}
