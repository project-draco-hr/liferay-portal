{
  if (!signedIn) {
    return false;
  }
  if (isOmniadmin()) {
    return true;
  }
  if (groupId <= 0) {
    return false;
  }
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  if (isCompanyAdmin(group.getCompanyId())) {
    return true;
  }
  PermissionCheckerBag bag=getUserBag(user.getUserId(),groupId);
  if (bag == null) {
    _log.error("Bag should never be null");
  }
  if (bag.isGroupAdmin(this,group)) {
    return true;
  }
  StopWatch stopWatch=null;
  if (_log.isDebugEnabled()) {
    stopWatch=new StopWatch();
    stopWatch.start();
  }
  if (group.isSite()) {
    while (!group.isRoot()) {
      Group parentGroup=group.getParentGroup();
      if (doCheckPermission(parentGroup.getCompanyId(),parentGroup.getGroupId(),Group.class.getName(),String.valueOf(parentGroup.getGroupId()),ActionKeys.MANAGE_SUBGROUPS,stopWatch)) {
        return true;
      }
      group=parentGroup;
    }
  }
  if (group.isOrganization()) {
    Organization organization=OrganizationLocalServiceUtil.getOrganization(group.getOrganizationId());
    while (!organization.isRoot()) {
      Organization parentOrganization=organization.getParentOrganization();
      Group parentGroup=parentOrganization.getGroup();
      if (doCheckPermission(parentGroup.getCompanyId(),parentGroup.getGroupId(),Organization.class.getName(),String.valueOf(parentOrganization.getOrganizationId()),ActionKeys.MANAGE_SUBORGANIZATIONS,stopWatch)) {
        return true;
      }
      organization=parentOrganization;
    }
  }
  return false;
}
