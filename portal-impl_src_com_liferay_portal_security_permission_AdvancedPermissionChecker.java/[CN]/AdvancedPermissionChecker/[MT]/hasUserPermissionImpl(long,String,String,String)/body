{
  StopWatch stopWatch=new StopWatch();
  stopWatch.start();
  long companyId=user.getCompanyId();
  if (groupId > 0) {
    Group group=GroupLocalServiceUtil.getGroup(groupId);
    companyId=group.getCompanyId();
  }
 else   if (name.equals(User.class.getName())) {
    User user=UserLocalServiceUtil.fetchUser(GetterUtil.getLong(primKey));
    if (user != null) {
      companyId=user.getCompanyId();
    }
  }
  boolean hasLayoutManagerPermission=true;
  if (Validator.isNotNull(name) && Validator.isNotNull(primKey) && primKey.contains(PortletConstants.LAYOUT_SEPARATOR)) {
    hasLayoutManagerPermission=PortletPermissionUtil.hasLayoutManagerPermission(name,actionId);
  }
  if (isCompanyAdminImpl(companyId)) {
    return true;
  }
  if (name.equals(Organization.class.getName())) {
    if (isOrganizationAdminImpl(GetterUtil.getLong(primKey))) {
      return true;
    }
  }
 else   if (isGroupAdminImpl(groupId) && hasLayoutManagerPermission) {
    return true;
  }
  return doCheckPermission(companyId,groupId,name,primKey,actionId,stopWatch);
}
