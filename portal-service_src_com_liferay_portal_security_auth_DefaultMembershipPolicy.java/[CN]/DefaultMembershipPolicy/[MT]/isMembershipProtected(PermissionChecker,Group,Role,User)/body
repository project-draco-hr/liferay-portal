{
  if (group.isOrganization()) {
    Organization organization=OrganizationLocalServiceUtil.getOrganization(group.getClassPK());
    return isMembershipProtected(permissionChecker,organization,role,user);
  }
  if (permissionChecker.isGroupOwner(group.getGroupId())) {
    return false;
  }
  String roleName=role.getName();
  if (!roleName.equals(RoleConstants.SITE_ADMINISTRATOR) && !roleName.equals(RoleConstants.SITE_OWNER)) {
    return false;
  }
  if (UserGroupRoleLocalServiceUtil.hasUserGroupRole(user.getUserId(),group.getGroupId(),role.getRoleId())) {
    return true;
  }
  return false;
}
