{
  try {
    String cmd=ParamUtil.getString(req,Constants.CMD);
    if (!cmd.equals(Constants.UPDATE)) {
      return;
    }
    ThemeDisplay themeDisplay=(ThemeDisplay)req.getAttribute(WebKeys.THEME_DISPLAY);
    String companyId=themeDisplay.getCompanyId();
    String groupId=ParamUtil.getString(req,"groupId");
    String languageId=LanguageUtil.getLanguageId(req);
    Map articleIdsMap=new TreeMap();
    Enumeration enu=req.getParameterNames();
    while (enu.hasMoreElements()) {
      String name=(String)enu.nextElement();
      if (name.startsWith("article")) {
        String articleId=ParamUtil.getString(req,name).toUpperCase();
        String content=JournalContentUtil.getContent(companyId,groupId,articleId,languageId,themeDisplay);
        if (Validator.isNull(content)) {
          throw new NoSuchArticleException();
        }
        articleIdsMap.put(name,articleId);
      }
    }
    String[] articleIds=(String[])articleIdsMap.values().toArray(new String[0]);
    String portletResource=ParamUtil.getString(req,"portletResource");
    PortletPreferences prefs=PortletPreferencesFactory.getPortletSetup(req,portletResource,true,true);
    prefs.setValue("group-id",groupId);
    prefs.setValues("article-id",articleIds);
    prefs.store();
    updateContentSearch(req,portletResource,articleIds);
    res.sendRedirect(ParamUtil.getString(req,"redirect"));
  }
 catch (  NoSuchArticleException nsae) {
    SessionErrors.add(req,nsae.getClass().getName());
  }
}
