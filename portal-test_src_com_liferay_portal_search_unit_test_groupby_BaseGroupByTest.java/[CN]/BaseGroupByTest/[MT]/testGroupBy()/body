{
  addDocuments("sixteen",16);
  addDocuments("three",3);
  addDocuments("two",2);
  IdempotentRetryAssert.retryAssert(3,TimeUnit.SECONDS,new Callable<Void>(){
    @Override public Void call() throws Exception {
      SearchContext searchContext=createSearchContext();
      searchContext.setGroupBy(new GroupBy(GROUP_FIELD));
      Map<String,Hits> groupedHitsMap=searchGroups(searchContext);
      Assert.assertEquals(3,groupedHitsMap.size());
      assertGroup("sixteen",16,groupedHitsMap);
      assertGroup("three",3,groupedHitsMap);
      assertGroup("two",2,groupedHitsMap);
      return null;
    }
  }
);
}
