{
  SPI spi=SPIRegistryUtil.getPortletSPI(portlet.getRootPortletId());
  if (spi == null) {
    return null;
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Portlet " + portlet + " is registered to SPI "+ spi);
  }
  try {
    return spi.getSPIAgent();
  }
 catch (  RemoteException re) {
    throw new PortletContainerException(re);
  }
}
