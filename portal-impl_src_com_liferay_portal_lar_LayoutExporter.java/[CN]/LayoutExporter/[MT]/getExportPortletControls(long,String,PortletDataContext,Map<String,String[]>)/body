{
  boolean exportPortletData=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA);
  boolean exportPortletDataAll=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA_ALL);
  boolean exportPortletSetup=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_SETUP);
  boolean exportPortletSetupAll=MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_SETUP_ALL);
  if (_log.isDebugEnabled()) {
    _log.debug("Export portlet data " + exportPortletData);
    _log.debug("Export all portlet data " + exportPortletDataAll);
    _log.debug("Export portlet setup " + exportPortletSetup);
  }
  boolean exportCurPortletData=exportPortletData;
  boolean exportCurPortletSetup=exportPortletSetup;
  if (exportPortletDataAll) {
    exportCurPortletData=true;
    exportCurPortletSetup=true;
  }
 else {
    Portlet portlet=PortletLocalServiceUtil.getPortletById(companyId,portletId);
    if (portlet != null) {
      String portletDataHandlerClass=portlet.getPortletDataHandlerClass();
      if (portletDataHandlerClass != null) {
        String rootPortletId=PortletConstants.getRootPortletId(portletId);
        exportCurPortletData=exportPortletData && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_DATA + StringPool.UNDERLINE + rootPortletId);
        exportCurPortletSetup=exportPortletSetup && MapUtil.getBoolean(parameterMap,PortletDataHandlerKeys.PORTLET_SETUP + StringPool.UNDERLINE + rootPortletId);
      }
    }
  }
  if (exportPortletSetupAll) {
    exportCurPortletSetup=true;
  }
  return new boolean[]{exportCurPortletData,exportCurPortletSetup};
}
