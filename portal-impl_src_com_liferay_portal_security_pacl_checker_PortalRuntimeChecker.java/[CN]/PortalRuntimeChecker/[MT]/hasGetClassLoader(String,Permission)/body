{
  int stackIndex=getStackIndex(12,11);
  if (_classLoaderReferenceIds.contains(classLoaderReferenceId)) {
    return true;
  }
  Class<?> callerClass=Reflection.getCallerClass(stackIndex);
  if (callerClass.getName().equals(PortalClassLoaderUtil.class.getName()) || callerClass.getName().equals(PortletClassLoaderUtil.class.getName())) {
    callerClass=Reflection.getCallerClass(stackIndex + 1);
  }
 else   if (callerClass.getName().equals(DynamicQueryFactoryImpl.class.getName())) {
    callerClass=Reflection.getCallerClass(stackIndex + 3);
  }
  if (isTrustedCaller(callerClass,permission)) {
    return true;
  }
  Class<?> superClass=callerClass.getSuperclass();
  if (Modifier.isAbstract(callerClass.getModifiers()) && (superClass.equals(BaseLocalServiceImpl.class) || superClass.equals(BasePersistenceImpl.class) || superClass.equals(BaseServiceImpl.class))) {
    return true;
  }
  return false;
}
