{
  Properties properties=getProperties();
  for (  Map.Entry<Object,Object> entry : properties.entrySet()) {
    String key=(String)entry.getKey();
    String value=(String)entry.getValue();
    if (!key.startsWith("security-manager-set-bean-property[")) {
      continue;
    }
    int x=key.indexOf("[");
    int y=key.indexOf("]",x);
    String servletContextName=key.substring(x + 1,y);
    Set<String> beanPropertyClassNames=SetUtil.fromArray(StringUtil.split(value));
    _setBeanPropertyClassNamesMap.put(servletContextName,beanPropertyClassNames);
    if (_log.isDebugEnabled() && !servletContextName.equals(_PORTAL_SERVLET_CONTEXT_NAME)) {
      Set<String> classNames=new TreeSet<String>(beanPropertyClassNames);
      for (      String className : classNames) {
        _log.debug("Allowing set bean property from " + servletContextName + " on class "+ className);
      }
    }
  }
  Set<String> beanPropertyClassNames=_setBeanPropertyClassNamesMap.get(_PORTAL_SERVLET_CONTEXT_NAME);
  if (beanPropertyClassNames == null) {
    beanPropertyClassNames=getPropertySet("security-manager-set-bean-property");
  }
 else {
    beanPropertyClassNames.addAll(getPropertySet("security-manager-set-bean-property"));
  }
  _setBeanPropertyClassNamesMap.put(_PORTAL_SERVLET_CONTEXT_NAME,beanPropertyClassNames);
  if (_log.isDebugEnabled()) {
    Set<String> classNames=new TreeSet<String>(beanPropertyClassNames);
    for (    String className : classNames) {
      _log.debug("Allowing set bean property from " + _PORTAL_SERVLET_CONTEXT_NAME + " on class "+ className);
    }
  }
}
