{
  PortalRuntimePermission portalRuntimePermission=(PortalRuntimePermission)permission;
  String name=portalRuntimePermission.getShortName();
  String subject=portalRuntimePermission.getSubject();
  String servletContextName=portalRuntimePermission.getServletContextName();
  String property=GetterUtil.getString(portalRuntimePermission.getProperty());
  if (name.equals(PORTAL_RUNTIME_PERMISSION_EXPANDO_BRIDGE)) {
    if (!_expandoBridgeClassNames.contains(subject)) {
      logSecurityException(_log,"Attempted to get Expando bridge on " + subject);
      return false;
    }
  }
 else   if (name.equals(PORTAL_RUNTIME_PERMISSION_GET_BEAN_PROPERTY)) {
    if (!hasGetBeanProperty(servletContextName,subject,property,permission)) {
      if (Validator.isNotNull(property)) {
        logSecurityException(_log,"Attempted to get bean property " + property + " on "+ subject+ " from "+ servletContextName);
      }
 else {
        logSecurityException(_log,"Attempted to get bean property on " + subject + " from "+ servletContextName);
      }
      return false;
    }
  }
 else   if (name.startsWith(PORTAL_RUNTIME_PERMISSION_GET_CLASSLOADER)) {
    if (!hasGetClassLoader(subject,permission)) {
      logSecurityException(_log,"Attempted to get class loader " + subject);
      return false;
    }
  }
 else   if (name.equals(PORTAL_RUNTIME_PERMISSION_PORTLET_BAG_POOL)) {
    if (!hasPortletBagPoolPortletId(subject)) {
      logSecurityException(_log,"Attempted to handle portlet bag pool portlet ID " + subject);
      return false;
    }
  }
 else   if (name.equals(PORTAL_RUNTIME_PERMISSION_SEARCH_ENGINE)) {
    if (!_searchEngineIds.contains(subject)) {
      logSecurityException(_log,"Attempted to get search engine " + subject);
      return false;
    }
  }
 else   if (name.equals(PORTAL_RUNTIME_PERMISSION_SET_BEAN_PROPERTY)) {
    if (!hasSetBeanProperty(servletContextName,subject,property)) {
      if (Validator.isNotNull(property)) {
        logSecurityException(_log,"Attempted to set bean property " + property + " on "+ subject+ " from "+ servletContextName);
      }
 else {
        logSecurityException(_log,"Attempted to set bean property on " + subject + " from "+ servletContextName);
      }
      return false;
    }
  }
 else   if (name.equals(PORTAL_RUNTIME_PERMISSION_THREAD_POOL_EXECUTOR)) {
    if (!hasThreadPoolExecutorNames(subject)) {
      logSecurityException(_log,"Attempted to modify thread pool executor " + subject);
      return false;
    }
  }
  return true;
}
