{
  if (state.wrapResponse == null)   return;
  ServletResponse previous=null;
  ServletResponse current=state.outerResponse;
  while (current != null) {
    if ((current instanceof org.apache.catalina.Response) || (current instanceof ResponseFacade))     break;
    if (current == state.wrapResponse) {
      ServletResponse next=((ServletResponseWrapper)current).getResponse();
      if (previous == null)       state.outerResponse=next;
 else       ((ServletResponseWrapper)previous).setResponse(next);
      break;
    }
    previous=current;
    current=((ServletResponseWrapper)current).getResponse();
  }
}
