{
  _renderRequest=renderRequest;
  _renderResponse=renderResponse;
  _portletPreferences=portletPreferences;
  if ((getKeywords() == null) || (getKeywords().length() == 0)) {
    _hits=null;
    _searchContext=null;
    _searchContainer=null;
    return;
  }
  HttpServletRequest request=PortalUtil.getHttpServletRequest(_renderRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)_renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String emptyResultMessage=LanguageUtil.format(request,"no-results-were-found-that-matched-the-keywords-x","<strong>" + HtmlUtil.escape(getKeywords()) + "</strong>",false);
  SearchContainer<Document> searchContainer=new SearchContainer<>(_renderRequest,getPortletURL(),null,emptyResultMessage);
  FacetedSearcherManager facetedSearcherManager=FacetedSearcherManagerUtil.getFacetedSearcherManager();
  FacetedSearcher facetedSearcher=facetedSearcherManager.createFacetedSearcher();
  SearchContext searchContext=SearchContextFactory.getInstance(request);
  searchContext.setAttribute("paginationType","more");
  searchContext.setEnd(searchContainer.getEnd());
  searchContext.setQueryConfig(getQueryConfig());
  searchContext.setStart(searchContainer.getStart());
  addAssetEntriesFacet(searchContext);
  addScopeFacet(searchContext);
  addEnabledSearchFacets(themeDisplay.getCompanyId(),searchContext);
  Hits hits=facetedSearcher.search(searchContext);
  searchContainer.setTotal(hits.getLength());
  searchContainer.setResults(hits.toList());
  searchContainer.setSearch(true);
  _hits=hits;
  _searchContext=searchContext;
  _searchContainer=searchContainer;
}
