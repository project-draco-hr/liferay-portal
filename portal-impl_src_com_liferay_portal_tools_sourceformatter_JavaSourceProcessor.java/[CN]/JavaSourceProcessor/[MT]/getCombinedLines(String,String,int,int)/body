{
  if (Validator.isNull(line) || Validator.isNull(previousLine)) {
    return null;
  }
  String trimmedPreviousLine=StringUtil.trimLeading(previousLine);
  int previousLineLength=getLineLength(previousLine);
  if (line.startsWith("// ") && trimmedPreviousLine.startsWith("// ")) {
    String linePart=line.substring(3);
    if (!linePart.startsWith("PLACEHOLDER") && !linePart.startsWith(StringPool.OPEN_BRACKET)) {
      int pos=linePart.indexOf(StringPool.SPACE);
      if (pos == -1) {
        pos=linePart.length();
      }
      if ((previousLineLength + pos) < 80) {
        if (linePart.contains(StringPool.SPACE)) {
          return new Tuple(previousLine + StringPool.SPACE,linePart.substring(0,pos + 1),true);
        }
 else {
          return new Tuple(previousLine + StringPool.SPACE + linePart);
        }
      }
    }
    return null;
  }
 else   if (line.startsWith("// ") || trimmedPreviousLine.startsWith("// ")) {
    return null;
  }
  if (previousLine.endsWith(" extends")) {
    return new Tuple(previousLine,"extends ",false);
  }
  if (previousLine.endsWith(" implements")) {
    return new Tuple(previousLine,"implements ",false);
  }
  if (line.startsWith("+ ") || line.startsWith("- ") || line.startsWith("|| ")|| line.startsWith("&& ")) {
    int pos=line.indexOf(StringPool.SPACE);
    String linePart=line.substring(0,pos);
    return new Tuple(previousLine + StringPool.SPACE,linePart,true);
  }
  if ((line.length() + previousLineLength) < 80) {
    if (trimmedPreviousLine.startsWith("for ") && previousLine.endsWith(StringPool.COLON) && line.endsWith(StringPool.OPEN_CURLY_BRACE)) {
      return new Tuple(previousLine + StringPool.SPACE + line);
    }
    if ((previousLine.endsWith(StringPool.EQUAL) || previousLine.endsWith(StringPool.PERIOD) || trimmedPreviousLine.equals("return")) && line.endsWith(StringPool.SEMICOLON)) {
      return new Tuple(previousLine + StringPool.SPACE + line);
    }
    if ((trimmedPreviousLine.startsWith("if ") || trimmedPreviousLine.startsWith("else ")) && (previousLine.endsWith("||") || previousLine.endsWith("&&")) && line.endsWith(StringPool.OPEN_CURLY_BRACE)) {
      return new Tuple(previousLine + StringPool.SPACE + line);
    }
    if ((line.startsWith("extends ") || line.startsWith("implements ") || line.startsWith("throws")) && line.endsWith(StringPool.OPEN_CURLY_BRACE) && (lineTabCount == (previousLineTabCount + 1))) {
      return new Tuple(previousLine + StringPool.SPACE + line);
    }
  }
  if (previousLine.endsWith(StringPool.EQUAL) && line.endsWith(StringPool.SEMICOLON)) {
    String tempLine=line;
    for (int pos=0; ; ) {
      pos=tempLine.indexOf(StringPool.DASH);
      if (pos == -1) {
        pos=tempLine.indexOf(StringPool.PLUS);
      }
      if (pos == -1) {
        pos=tempLine.indexOf(StringPool.SLASH);
      }
      if (pos == -1) {
        pos=tempLine.indexOf(StringPool.STAR);
      }
      if (pos == -1) {
        pos=tempLine.indexOf("||");
      }
      if (pos == -1) {
        pos=tempLine.indexOf("&&");
      }
      if (pos == -1) {
        break;
      }
      String linePart=tempLine.substring(0,pos);
      int openParenthesisCount=StringUtil.count(linePart,StringPool.OPEN_PARENTHESIS);
      int closeParenthesisCount=StringUtil.count(linePart,StringPool.CLOSE_PARENTHESIS);
      if (openParenthesisCount == closeParenthesisCount) {
        return null;
      }
      tempLine=tempLine.substring(0,pos) + tempLine.substring(pos + 1);
    }
    int x=line.indexOf(StringPool.OPEN_PARENTHESIS);
    if (x == 0) {
      x=line.indexOf(StringPool.OPEN_PARENTHESIS,1);
    }
    if (x != -1) {
      int y=line.indexOf(StringPool.CLOSE_PARENTHESIS,x);
      int z=line.indexOf(StringPool.QUOTE);
      if (((x + 1) != y) && ((z == -1) || (z > x))) {
        char previousChar=line.charAt(x - 1);
        if ((previousChar != CharPool.CLOSE_PARENTHESIS) && (previousChar != CharPool.OPEN_PARENTHESIS) && (previousChar != CharPool.SPACE)&& (previousLineLength + 1 + x) < 80) {
          String linePart=line.substring(0,x + 1);
          if (linePart.startsWith(StringPool.OPEN_PARENTHESIS) && !linePart.contains(StringPool.CLOSE_PARENTHESIS)) {
            return null;
          }
          return new Tuple(previousLine + StringPool.SPACE,linePart,true);
        }
      }
    }
  }
  if (previousLine.endsWith(StringPool.COMMA) && (previousLineTabCount == lineTabCount) && !previousLine.contains(StringPool.CLOSE_CURLY_BRACE)) {
    int x=line.indexOf(StringPool.COMMA);
    if (x != -1) {
      while ((previousLineLength + 1 + x) < 80) {
        String linePart=line.substring(0,x + 1);
        if (isValidJavaParameter(linePart)) {
          if (line.equals(linePart)) {
            return new Tuple(previousLine + StringPool.SPACE + linePart);
          }
 else {
            return new Tuple(previousLine + StringPool.SPACE,linePart + StringPool.SPACE,true);
          }
        }
        String partAfterComma=line.substring(x + 1);
        int pos=partAfterComma.indexOf(StringPool.COMMA);
        if (pos == -1) {
          break;
        }
        x=x + pos + 1;
      }
    }
 else     if (!line.endsWith(StringPool.OPEN_PARENTHESIS) && !line.endsWith(StringPool.PLUS) && !line.endsWith(StringPool.PERIOD)&& (!line.startsWith("new ") || !line.endsWith(StringPool.OPEN_CURLY_BRACE))&& ((line.length() + previousLineLength) < 80)) {
      return new Tuple(previousLine + StringPool.SPACE + line);
    }
  }
  if (!previousLine.endsWith(StringPool.OPEN_PARENTHESIS)) {
    return null;
  }
  if (StringUtil.count(previousLine,StringPool.OPEN_PARENTHESIS) > 1) {
    int pos=trimmedPreviousLine.lastIndexOf(StringPool.OPEN_PARENTHESIS,trimmedPreviousLine.length() - 2);
    if ((pos > 0) && Character.isLetterOrDigit(trimmedPreviousLine.charAt(pos - 1))) {
      String filePart=trimmedPreviousLine.substring(pos + 1);
      if (!filePart.contains(StringPool.CLOSE_PARENTHESIS) && !filePart.contains(StringPool.QUOTE)) {
        return new Tuple(previousLine,filePart,false);
      }
    }
  }
  if ((line.length() + previousLineLength) > 80) {
    return null;
  }
  if (line.endsWith(StringPool.SEMICOLON)) {
    return new Tuple(previousLine + line);
  }
  if (line.endsWith(StringPool.COMMA)) {
    String strippedQuotesLine=stripQuotes(line,CharPool.QUOTE);
    int openParenthesisCount=StringUtil.count(strippedQuotesLine,StringPool.OPEN_PARENTHESIS);
    int closeParenthesisCount=StringUtil.count(strippedQuotesLine,StringPool.CLOSE_PARENTHESIS);
    if (closeParenthesisCount > openParenthesisCount) {
      return new Tuple(previousLine + line);
    }
  }
  if (((line.endsWith(StringPool.OPEN_CURLY_BRACE) && !line.startsWith("new ")) || line.endsWith(StringPool.CLOSE_PARENTHESIS)) && (trimmedPreviousLine.startsWith("else ") || trimmedPreviousLine.startsWith("if ") || trimmedPreviousLine.startsWith("private ")|| trimmedPreviousLine.startsWith("protected ")|| trimmedPreviousLine.startsWith("public "))) {
    return new Tuple(previousLine + line);
  }
  return null;
}
