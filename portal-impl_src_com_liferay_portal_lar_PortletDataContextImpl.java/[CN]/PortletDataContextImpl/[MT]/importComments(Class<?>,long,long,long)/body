{
  Map<Long,Long> messagePKs=new HashMap<Long,Long>();
  Map<Long,Long> threadPKs=new HashMap<Long,Long>();
  List<MBMessage> messages=_commentsMap.get(getPrimaryKeyString(classObj,classPK));
  if (messages == null) {
    return;
  }
  for (  MBMessage message : messages) {
    long userId=getUserId(message.getUserUuid());
    long parentMessageId=MapUtil.getLong(messagePKs,message.getParentMessageId(),message.getParentMessageId());
    long threadId=MapUtil.getLong(threadPKs,message.getThreadId(),message.getThreadId());
    ServiceContext serviceContext=new ServiceContext();
    serviceContext.setScopeGroupId(groupId);
    MBMessage newMessage=MBMessageLocalServiceUtil.addDiscussionMessage(userId,message.getUserName(),classObj.getName(),((Long)newClassPK).longValue(),threadId,parentMessageId,message.getSubject(),message.getBody(),serviceContext);
    messagePKs.put(message.getMessageId(),newMessage.getMessageId());
    threadPKs.put(message.getThreadId(),newMessage.getThreadId());
  }
}
