{
  User user=UserTestUtil.addGroupUser(_group,RoleConstants.POWER_USER);
  PermissionChecker permissionChecker=PermissionCheckerFactoryUtil.create(user);
  PermissionChecker originalPermissionChecker=PermissionThreadLocal.getPermissionChecker();
  PermissionThreadLocal.setPermissionChecker(permissionChecker);
  try {
    ServiceContext serviceContext=ServiceContextTestUtil.getServiceContext(_group.getGroupId(),_user.getUserId());
    serviceContext.setAddGroupPermissions(false);
    serviceContext.setAddGuestPermissions(false);
    DLFileEntryType fileEntryType=addFileEntryType(serviceContext);
    List<DLFileEntryType> fileEntryTypes=DLFileEntryTypeFinderUtil.filterFindByKeywords(_group.getCompanyId(),new long[]{_group.getGroupId()},_DL_FILE_ENTRY_TYPE_NAME,true,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
    Assert.assertFalse(fileEntryTypes.contains(fileEntryType));
    Assert.assertEquals(fileEntryTypes.size(),DLFileEntryTypeFinderUtil.filterCountByKeywords(_group.getCompanyId(),new long[]{_group.getGroupId()},_DL_FILE_ENTRY_TYPE_NAME,true));
  }
  finally {
    PermissionThreadLocal.setPermissionChecker(originalPermissionChecker);
  }
}
