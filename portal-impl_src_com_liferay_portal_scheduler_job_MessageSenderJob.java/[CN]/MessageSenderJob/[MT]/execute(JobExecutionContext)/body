{
  try {
    JobDetail jobDetail=jobExecutionContext.getJobDetail();
    JobDataMap jobDataMap=jobDetail.getJobDataMap();
    String destinationName=jobDataMap.getString(SchedulerEngine.DESTINATION_NAME);
    Message message=(Message)jobDataMap.get(SchedulerEngine.MESSAGE);
    if (message == null) {
      message=new Message();
    }
    message.put(SchedulerEngine.DESTINATION_NAME,destinationName);
    if (jobExecutionContext.getNextFireTime() == null) {
      message.put(SchedulerEngine.DISABLE,true);
    }
    Scheduler scheduler=jobExecutionContext.getScheduler();
    SchedulerContext schedulerContext=scheduler.getContext();
    ObjectValuePair<TriggerState,Exception> jobState=(ObjectValuePair<TriggerState,Exception>)schedulerContext.get(jobDetail.getFullName());
    if (jobState == null) {
      jobState=new ObjectValuePair<TriggerState,Exception>();
      schedulerContext.put(jobDetail.getFullName(),jobState);
    }
    message.put(SchedulerEngine.JOB_STATE,jobState);
    MessageBusUtil.sendMessage(destinationName,message);
  }
 catch (  Exception e) {
    _log.error("Unable to execute job",e);
  }
}
