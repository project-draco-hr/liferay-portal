{
  try {
    JobDetail jobDetail=jobExecutionContext.getJobDetail();
    JobDataMap jobDataMap=jobDetail.getJobDataMap();
    String destinationName=jobDataMap.getString(SchedulerEngine.DESTINATION_NAME);
    Message message=(Message)jobDataMap.get(SchedulerEngine.MESSAGE);
    if (message == null) {
      message=new Message();
    }
    message.put("scheduledFireTime",jobExecutionContext.getScheduledFireTime());
    Scheduler scheduler=jobExecutionContext.getScheduler();
    SchedulerContext schedulerContext=scheduler.getContext();
    String jobFullName=jobDetail.getFullName();
    ObjectValuePair<TriggerState,Exception> jobState=(ObjectValuePair<TriggerState,Exception>)schedulerContext.get(jobFullName);
    if (jobState == null) {
      jobState=new ObjectValuePair<TriggerState,Exception>();
      schedulerContext.put(jobFullName,jobState);
    }
    message.put(SchedulerEngine.JOB_STATE,jobState);
    if (jobExecutionContext.getNextFireTime() == null) {
      message.put(SchedulerEngine.DISABLE,true);
    }
    MessageBusUtil.sendMessage(destinationName,message);
  }
 catch (  Exception e) {
    _log.error("Unable to execute job",e);
  }
}
