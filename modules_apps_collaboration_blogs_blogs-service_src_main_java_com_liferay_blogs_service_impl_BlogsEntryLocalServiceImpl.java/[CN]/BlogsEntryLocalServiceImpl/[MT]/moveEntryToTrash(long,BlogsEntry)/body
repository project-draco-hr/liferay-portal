{
  if (entry.isInTrash()) {
    throw new TrashEntryException();
  }
  int oldStatus=entry.getStatus();
  if (oldStatus == WorkflowConstants.STATUS_PENDING) {
    entry.setStatus(WorkflowConstants.STATUS_DRAFT);
    blogsEntryPersistence.update(entry);
  }
  entry=updateStatus(userId,entry.getEntryId(),WorkflowConstants.STATUS_IN_TRASH,new ServiceContext());
  JSONObject extraDataJSONObject=JSONFactoryUtil.createJSONObject();
  extraDataJSONObject.put("title",entry.getTitle());
  SocialActivityManagerUtil.addActivity(userId,entry,SocialActivityConstants.TYPE_MOVE_TO_TRASH,extraDataJSONObject.toString(),0);
  if (oldStatus == WorkflowConstants.STATUS_PENDING) {
    workflowInstanceLinkLocalService.deleteWorkflowInstanceLink(entry.getCompanyId(),entry.getGroupId(),BlogsEntry.class.getName(),entry.getEntryId());
  }
  return entry;
}
