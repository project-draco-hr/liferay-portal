{
  List<Role> roles=rolePersistence.findByName(roleName);
  for (  Role role : roles) {
    List<String> primKeys=resourcePermissionFinder.findByC_N_S(role.getCompanyId(),resourceName,scope);
    for (    String primKey : primKeys) {
      ResourcePermission resourcePermission=resourcePermissionPersistence.fetchByC_N_S_P_R(role.getCompanyId(),resourceName,scope,primKey,role.getRoleId());
      if (resourcePermission == null) {
        long resourcePermissionId=counterLocalService.increment(ResourcePermission.class.getName());
        resourcePermission=resourcePermissionPersistence.create(resourcePermissionId);
        resourcePermission.setCompanyId(role.getCompanyId());
        resourcePermission.setName(resourceName);
        resourcePermission.setScope(scope);
        resourcePermission.setPrimKey(primKey);
        resourcePermission.setRoleId(role.getRoleId());
      }
      long actionIdsLong=resourcePermission.getActionIds();
      actionIdsLong|=resourceActionBitwiseValue;
      resourcePermission.setActionIds(actionIdsLong);
      resourcePermissionPersistence.update(resourcePermission,false);
    }
  }
}
