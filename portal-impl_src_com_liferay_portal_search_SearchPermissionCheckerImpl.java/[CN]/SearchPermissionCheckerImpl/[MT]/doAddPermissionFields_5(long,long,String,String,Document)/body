{
  Resource resource=ResourceLocalServiceUtil.getResource(companyId,className,ResourceConstants.SCOPE_INDIVIDUAL,classPK);
  Group group=new GroupImpl();
  group.setCompanyId(companyId);
  if (groupId > 0) {
    group=GroupLocalServiceUtil.getGroup(groupId);
  }
  List<Role> roles=ResourceActionsUtil.getRoles(group,className);
  List<Long> roleIds=new ArrayList<Long>();
  List<String> groupRoleIds=new ArrayList<String>();
  for (  Role role : roles) {
    long roleId=role.getRoleId();
    if (hasPermission(roleId,resource.getResourceId())) {
      if ((role.getType() == RoleConstants.TYPE_COMMUNITY) || (role.getType() == RoleConstants.TYPE_ORGANIZATION)) {
        groupRoleIds.add(groupId + StringPool.DASH + roleId);
      }
 else {
        roleIds.add(roleId);
      }
    }
  }
  doc.addKeyword(Field.ROLE_ID,roleIds.toArray(new Long[roleIds.size()]));
  doc.addKeyword(Field.GROUP_ROLE_ID,groupRoleIds.toArray(new String[groupRoleIds.size()]));
}
