{
  long recordId=ParamUtil.getLong(resourceRequest,"recordId");
  long structureId=ParamUtil.getLong(resourceRequest,"ddmStructureId");
  String fieldName=ParamUtil.getString(resourceRequest,"fieldName");
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getDDMStructure(structureId);
  DDLRecord record=DDLRecordLocalServiceUtil.fetchByPrimaryKey(recordId);
  JSONObject fileJSONObject=null;
  if (record != null) {
    String oldFieldValue=String.valueOf(record.getFieldValue(fieldName));
    fileJSONObject=JSONFactoryUtil.createJSONObject(oldFieldValue);
  }
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(resourceRequest);
  ServiceContext serviceContext=ServiceContextFactory.getInstance(DLFileEntry.class.getName(),resourceRequest);
  return DDLUtil.uploadFieldFile(ddmStructure,fieldName,fileJSONObject,uploadPortletRequest,serviceContext);
}
