{
  long recordId=ParamUtil.getLong(resourceRequest,"recordId");
  long ddmStructureId=ParamUtil.getLong(resourceRequest,"ddmStructureId");
  String fieldName=ParamUtil.getString(resourceRequest,"fieldName");
  DDLRecord record=DDLRecordLocalServiceUtil.fetchRecord(recordId);
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getDDMStructure(ddmStructureId);
  JSONObject fileJSONObject=null;
  if (record != null) {
    String fieldValue=String.valueOf(record.getFieldValue(fieldName));
    fileJSONObject=JSONFactoryUtil.createJSONObject(fieldValue);
  }
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(resourceRequest);
  ServiceContext serviceContext=ServiceContextFactory.getInstance(DLFileEntry.class.getName(),resourceRequest);
  return DDLUtil.uploadFieldFile(ddmStructure,fieldName,fileJSONObject,uploadPortletRequest,serviceContext);
}
