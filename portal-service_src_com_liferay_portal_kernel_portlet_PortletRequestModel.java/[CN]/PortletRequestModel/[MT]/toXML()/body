{
  Element requestElement=new Element("request");
  requestElement.addElement("container-type","portlet");
  requestElement.addElement("container-namespace",_contextPath);
  requestElement.addElement("content-type",_contentType);
  requestElement.addElement("server-name",_serverName);
  requestElement.addElement("server-port",_serverPort);
  requestElement.addElement("secure",_secure);
  requestElement.addElement("auth-type",_authType);
  requestElement.addElement("remote-user",_remoteUser);
  requestElement.addElement("context-path",_contextPath);
  requestElement.addElement("locale",_locale);
  requestElement.addElement("portlet-mode",_portletMode);
  requestElement.addElement("portlet-session-id",_portletSessionId);
  requestElement.addElement("scheme",_scheme);
  requestElement.addElement("window-state",_windowState);
  requestElement.addElement("lifecycle",_lifecycle);
  if (_portletNamespace != null) {
    requestElement.addElement("portlet-namespace",_portletNamespace);
    if (_actionURL != null) {
      requestElement.addElement("action-url",_actionURL);
    }
    if (_renderURL != null) {
      requestElement.addElement("render-url",_renderURL);
      if (_renderURLExclusive != null) {
        requestElement.addElement("render-url-exclusive",_renderURLExclusive);
      }
      if (_renderURLMaximized != null) {
        requestElement.addElement("render-url-maximized",_renderURLMaximized);
      }
      if (_renderURLMinimized != null) {
        requestElement.addElement("render-url-minimized",_renderURLMinimized);
      }
      if (_renderURLNormal != null) {
        requestElement.addElement("render-url-normal",_renderURLNormal);
      }
      if (_renderURLPopUp != null) {
        requestElement.addElement("render-url-pop-up",_renderURLPopUp);
      }
    }
    requestElement.addElement("resource-url",_resourceURL);
  }
  if (_themeDisplayModel != null) {
    Element themeDisplayElement=requestElement.addElement("theme-display");
    themeDisplayElement.addElement("cdn-host",_themeDisplayModel.getCdnHost());
    themeDisplayElement.addElement("company-id",_themeDisplayModel.getCompanyId());
    themeDisplayElement.addElement("do-as-user-id",_themeDisplayModel.getDoAsUserId());
    themeDisplayElement.addElement("i18n-language-id",_themeDisplayModel.getI18nLanguageId());
    themeDisplayElement.addElement("i18n-path",_themeDisplayModel.getI18nPath());
    themeDisplayElement.addElement("language-id",_themeDisplayModel.getLanguageId());
    themeDisplayElement.addElement("locale",_themeDisplayModel.getLocale());
    themeDisplayElement.addElement("path-context",_themeDisplayModel.getPathContext());
    themeDisplayElement.addElement("path-friendly-url-private-group",_themeDisplayModel.getPathFriendlyURLPrivateGroup());
    themeDisplayElement.addElement("path-friendly-url-private-user",_themeDisplayModel.getPathFriendlyURLPrivateUser());
    themeDisplayElement.addElement("path-friendly-url-public",_themeDisplayModel.getPathFriendlyURLPublic());
    themeDisplayElement.addElement("path-image",_themeDisplayModel.getPathImage());
    themeDisplayElement.addElement("path-main",_themeDisplayModel.getPathMain());
    themeDisplayElement.addElement("path-theme-images",_themeDisplayModel.getPathThemeImages());
    themeDisplayElement.addElement("plid",_themeDisplayModel.getPlid());
    themeDisplayElement.addElement("portal-url",_themeDisplayModel.getPortalURL());
    themeDisplayElement.addElement("real-user-id",_themeDisplayModel.getRealUserId());
    themeDisplayElement.addElement("scope-group-id",_themeDisplayModel.getScopeGroupId());
    themeDisplayElement.addElement("secure",_themeDisplayModel.isSecure());
    themeDisplayElement.addElement("server-name",_themeDisplayModel.getServerName());
    themeDisplayElement.addElement("server-port",_themeDisplayModel.getServerPort());
    themeDisplayElement.addElement("time-zone",_themeDisplayModel.getTimeZone().getID());
    themeDisplayElement.addElement("url-portal",_themeDisplayModel.getURLPortal());
    themeDisplayElement.addElement("user-id",_themeDisplayModel.getUserId());
    PortletDisplayModel portletDisplayModel=_themeDisplayModel.getPortletDisplayModel();
    if (portletDisplayModel != null) {
      Element portletDisplayElement=themeDisplayElement.addElement("portlet-display");
      portletDisplayElement.addElement("id",portletDisplayModel.getId());
      portletDisplayElement.addElement("instance-id",portletDisplayModel.getInstanceId());
      portletDisplayElement.addElement("portlet-name",portletDisplayModel.getPortletName());
      portletDisplayElement.addElement("resource-pk",portletDisplayModel.getResourcePK());
      portletDisplayElement.addElement("root-portlet-id",portletDisplayModel.getRootPortletId());
      portletDisplayElement.addElement("title",portletDisplayModel.getTitle());
    }
  }
  Element parametersElement=requestElement.addElement("parameters");
  for (  Map.Entry<String,String[]> entry : _parameters.entrySet()) {
    Element parameterElement=parametersElement.addElement("parameter");
    parameterElement.addElement("name",entry.getKey());
    for (    String value : entry.getValue()) {
      parameterElement.addElement("value",value);
    }
  }
  Element attributesElement=requestElement.addElement("attributes");
  for (  Map.Entry<String,Object> entry : _attributes.entrySet()) {
    String name=entry.getKey();
    if (!_isValidAttributeName(name)) {
      continue;
    }
    Object value=entry.getValue();
    if (!_isValidAttributeValue(value)) {
      continue;
    }
    Element attributeElement=attributesElement.addElement("attribute");
    attributeElement.addElement("name",name);
    attributeElement.addElement("value",value);
  }
  Element portletSessionElement=requestElement.addElement("portlet-session");
  attributesElement=portletSessionElement.addElement("portlet-attributes");
  for (  Map.Entry<String,Object> entry : _portletScopeSessioAttributes.entrySet()) {
    String name=entry.getKey();
    if (!_isValidAttributeName(name)) {
      continue;
    }
    Object value=entry.getValue();
    if (!_isValidAttributeValue(value)) {
      continue;
    }
    Element attributeElement=attributesElement.addElement("attribute");
    attributeElement.addElement("name",name);
    attributeElement.addElement("value",value);
  }
  attributesElement=portletSessionElement.addElement("application-attributes");
  for (  Map.Entry<String,Object> entry : _applicationScopeSessionAttributes.entrySet()) {
    String name=entry.getKey();
    if (!_isValidAttributeName(name)) {
      continue;
    }
    Object value=entry.getValue();
    if (!_isValidAttributeValue(value)) {
      continue;
    }
    Element attributeElement=attributesElement.addElement("attribute");
    attributeElement.addElement("name",name);
    attributeElement.addElement("value",value);
  }
  return requestElement.toXMLString();
}
