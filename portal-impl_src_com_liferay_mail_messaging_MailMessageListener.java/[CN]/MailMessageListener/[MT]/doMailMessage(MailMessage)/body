{
  InternetAddress from=filterInternetAddress(mailMessage.getFrom());
  if (from == null) {
    if (_log.isWarnEnabled()) {
      _log.warn("Skipping email because the sender is not specified");
    }
    return;
  }
  mailMessage.setFrom(from);
  InternetAddress[] to=filterInternetAddresses(mailMessage.getTo());
  mailMessage.setTo(to);
  InternetAddress[] cc=filterInternetAddresses(mailMessage.getCC());
  mailMessage.setCC(cc);
  InternetAddress[] bcc=filterInternetAddresses(mailMessage.getBCC());
  InternetAddress[] auditTrail=InternetAddress.parse(PropsValues.MAIL_AUDIT_TRAIL);
  if (auditTrail.length > 0) {
    if (ArrayUtil.isNotEmpty(bcc)) {
      for (      InternetAddress internetAddress : auditTrail) {
        bcc=ArrayUtil.append(bcc,internetAddress);
      }
    }
 else {
      bcc=auditTrail;
    }
  }
  mailMessage.setBCC(bcc);
  InternetAddress[] bulkAddresses=filterInternetAddresses(mailMessage.getBulkAddresses());
  mailMessage.setBulkAddresses(bulkAddresses);
  InternetAddress[] replyTo=filterInternetAddresses(mailMessage.getReplyTo());
  mailMessage.setReplyTo(replyTo);
  if (ArrayUtil.isNotEmpty(to) || ArrayUtil.isNotEmpty(cc) || ArrayUtil.isNotEmpty(bcc)|| ArrayUtil.isNotEmpty(bulkAddresses)) {
    MailEngine.send(mailMessage);
  }
}
