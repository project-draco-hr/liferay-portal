{
  InternetAddress from=filterInternetAddress(mailMessage.getFrom());
  if (from == null) {
    return;
  }
  mailMessage.setFrom(from);
  InternetAddress[] auditTrail=InternetAddress.parse(PropsValues.MAIL_AUDIT_TRAIL);
  if (auditTrail.length > 0) {
    InternetAddress[] bcc=mailMessage.getBCC();
    if (bcc != null) {
      InternetAddress[] allBCC=new InternetAddress[bcc.length + auditTrail.length];
      ArrayUtil.combine(bcc,auditTrail,allBCC);
      mailMessage.setBCC(allBCC);
    }
 else {
      mailMessage.setBCC(auditTrail);
    }
  }
  InternetAddress[] to=filterInternetAddresses(mailMessage.getTo());
  mailMessage.setTo(to);
  InternetAddress[] cc=filterInternetAddresses(mailMessage.getCC());
  mailMessage.setCC(cc);
  InternetAddress[] bcc=filterInternetAddresses(mailMessage.getBCC());
  mailMessage.setBCC(bcc);
  InternetAddress[] bulkAddresses=filterInternetAddresses(mailMessage.getBulkAddresses());
  mailMessage.setBulkAddresses(bulkAddresses);
  InternetAddress[] replyTo=filterInternetAddresses(mailMessage.getReplyTo());
  mailMessage.setReplyTo(replyTo);
  if (ArrayUtil.isNotEmpty(to) || ArrayUtil.isNotEmpty(cc) || ArrayUtil.isNotEmpty(bcc)|| ArrayUtil.isNotEmpty(bulkAddresses)) {
    MailEngine.send(mailMessage);
  }
}
