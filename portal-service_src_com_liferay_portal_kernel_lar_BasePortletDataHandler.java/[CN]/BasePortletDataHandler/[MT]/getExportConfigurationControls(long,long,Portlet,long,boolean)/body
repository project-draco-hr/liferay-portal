{
  List<PortletDataHandlerBoolean> configurationControls=new ArrayList<PortletDataHandlerBoolean>();
  if ((PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(PortletKeys.PREFS_OWNER_ID_DEFAULT,PortletKeys.PREFS_OWNER_TYPE_LAYOUT,plid,portlet,false) > 0) || (PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(groupId,PortletKeys.PREFS_OWNER_TYPE_GROUP,portlet.getRootPortletId(),false) > 0) || (PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(companyId,PortletKeys.PREFS_OWNER_TYPE_COMPANY,portlet.getRootPortletId(),false) > 0)) {
    PortletDataHandlerControl[] portletDataHandlerControls=null;
    String namespace=null;
    if (isDisplayPortlet()) {
      portletDataHandlerControls=getExportControls();
      if ((portletDataHandlerControls != null) && (portletDataHandlerControls.length > 0)) {
        namespace=portletDataHandlerControls[0].getNamespace();
      }
    }
    configurationControls.add(new PortletDataHandlerBoolean(namespace,PortletDataHandlerKeys.PORTLET_SETUP,"setup",true,false,portletDataHandlerControls,null,null));
  }
  if (PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(-1,PortletKeys.PREFS_OWNER_TYPE_ARCHIVED,portlet.getRootPortletId(),false) > 0) {
    configurationControls.add(new PortletDataHandlerBoolean(null,PortletDataHandlerKeys.PORTLET_ARCHIVED_SETUPS,"archived-setups",true,false,null,null,null));
  }
  if ((PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(-1,PortletKeys.PREFS_OWNER_TYPE_USER,plid,portlet,false) > 0) || (PortletPreferencesLocalServiceUtil.getPortletPreferencesCount(groupId,PortletKeys.PREFS_OWNER_TYPE_USER,PortletKeys.PREFS_PLID_SHARED,portlet,false) > 0)) {
    configurationControls.add(new PortletDataHandlerBoolean(null,PortletDataHandlerKeys.PORTLET_USER_PREFERENCES,"user-preferences",true,false,null,null,null));
  }
  return configurationControls.toArray(new PortletDataHandlerBoolean[configurationControls.size()]);
}
