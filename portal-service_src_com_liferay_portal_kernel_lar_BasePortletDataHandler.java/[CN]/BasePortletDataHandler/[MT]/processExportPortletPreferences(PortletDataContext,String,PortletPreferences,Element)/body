{
  String displayStyle=getDisplayTemplate(portletDataContext,portletId,portletPreferences);
  if (Validator.isNotNull(displayStyle)) {
    DDMTemplate ddmTemplate=PortletDisplayTemplateUtil.fetchDDMTemplate(portletDataContext.getGroupId(),displayStyle);
    if (ddmTemplate != null) {
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,ddmTemplate);
    }
  }
  try {
    return doProcessExportPortletPreferences(portletDataContext,portletId,portletPreferences,rootElement);
  }
 catch (  Exception e) {
    throw new PortletDataException(e);
  }
}
