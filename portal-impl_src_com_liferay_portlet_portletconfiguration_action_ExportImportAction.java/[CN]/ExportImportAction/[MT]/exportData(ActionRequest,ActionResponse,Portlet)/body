{
  try {
    long plid=ParamUtil.getLong(actionRequest,"plid");
    long groupId=ParamUtil.getLong(actionRequest,"groupId");
    String fileName=ParamUtil.getString(actionRequest,"exportFileName");
    DateRange dateRange=ExportImportHelperUtil.getDateRange(actionRequest,groupId,false,plid,portlet.getPortletId(),"all");
    LayoutServiceUtil.exportPortletInfoAsFileInBackground(portlet.getPortletId(),plid,groupId,portlet.getPortletId(),actionRequest.getParameterMap(),dateRange.getStartDate(),dateRange.getEndDate(),fileName);
  }
 catch (  Exception e) {
    if (_log.isDebugEnabled()) {
      _log.debug(e,e);
    }
    SessionErrors.add(actionRequest,e.getClass(),e);
  }
}
