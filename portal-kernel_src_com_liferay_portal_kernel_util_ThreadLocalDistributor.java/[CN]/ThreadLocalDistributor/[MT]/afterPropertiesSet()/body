{
  if (_threadLocalSources == null) {
    throw new IllegalArgumentException("Thread local sources is null");
  }
  ClassLoader classLoader=getClassLoader();
  for (  KeyValuePair keyValuePair : _threadLocalSources) {
    String className=keyValuePair.getKey();
    String fieldName=keyValuePair.getValue();
    Class<?> clazz=classLoader.loadClass(className);
    Field field=ReflectionUtil.getDeclaredField(clazz,fieldName);
    if (!ThreadLocal.class.isAssignableFrom(field.getType())) {
      if (_log.isWarnEnabled()) {
        _log.warn(fieldName + " is not of type ThreadLocal");
      }
      continue;
    }
    if (!Modifier.isStatic(field.getModifiers())) {
      if (_log.isWarnEnabled()) {
        _log.warn(fieldName + " is not a static ThreadLocal");
      }
      continue;
    }
    ThreadLocal<Serializable> threadLocal=(ThreadLocal<Serializable>)field.get(null);
    if (threadLocal == null) {
      if (_log.isWarnEnabled()) {
        _log.warn(fieldName + " is not initialized");
      }
      continue;
    }
    _threadLocals.add(threadLocal);
  }
  _threadLocalValues=new Serializable[_threadLocals.size()];
  _index=ThreadLocalDistributorRegistry.addThreadLocalDistributor(this);
}
