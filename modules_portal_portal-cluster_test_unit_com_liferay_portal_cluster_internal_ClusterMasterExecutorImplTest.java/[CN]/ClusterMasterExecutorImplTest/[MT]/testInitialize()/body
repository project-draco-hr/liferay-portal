{
  ClusterMasterExecutorImpl clusterMasterExecutorImpl=createMasterExecutorImpl(false);
  clusterMasterExecutorImpl.setClusterExecutor(new MockClusterExecutor(false));
  clusterMasterExecutorImpl.activate();
  Assert.assertFalse(clusterMasterExecutorImpl.isEnabled());
  Assert.assertTrue(clusterMasterExecutorImpl.isMaster());
  Assert.assertNull(_mockLockLocalService.getLock());
  clusterMasterExecutorImpl=createMasterExecutorImpl(true);
  clusterMasterExecutorImpl.setClusterExecutor(new MockClusterExecutor(true));
  clusterMasterExecutorImpl.activate();
  Assert.assertTrue(clusterMasterExecutorImpl.isEnabled());
  Assert.assertTrue(clusterMasterExecutorImpl.isMaster());
  MockClusterExecutor mockClusterExecutor=new MockClusterExecutor(true);
  String otherClusterNodeId=mockClusterExecutor.addClusterNode();
  _mockLockLocalService.setLock(otherClusterNodeId);
  Assert.assertNotNull(_mockLockLocalService.getLock());
  clusterMasterExecutorImpl=createMasterExecutorImpl(true);
  clusterMasterExecutorImpl.setClusterExecutor(mockClusterExecutor);
  clusterMasterExecutorImpl.activate();
  Assert.assertTrue(clusterMasterExecutorImpl.isEnabled());
  Assert.assertFalse(clusterMasterExecutorImpl.isMaster());
}
