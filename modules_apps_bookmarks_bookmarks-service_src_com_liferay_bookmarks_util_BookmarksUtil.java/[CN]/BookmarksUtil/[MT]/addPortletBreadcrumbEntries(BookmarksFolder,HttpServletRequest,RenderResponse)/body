{
  String strutsAction=ParamUtil.getString(request,"struts_action");
  PortletURL portletURL=renderResponse.createRenderURL();
  if (strutsAction.equals("/bookmarks/select_folder")) {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    portletURL.setParameter("struts_action","/bookmarks/select_folder");
    portletURL.setWindowState(LiferayWindowState.POP_UP);
    PortalUtil.addPortletBreadcrumbEntry(request,themeDisplay.translate("home"),portletURL.toString());
  }
 else {
    portletURL.setParameter("struts_action","/bookmarks/view");
  }
  List<BookmarksFolder> ancestorFolders=folder.getAncestors();
  Collections.reverse(ancestorFolders);
  for (  BookmarksFolder ancestorFolder : ancestorFolders) {
    portletURL.setParameter("folderId",String.valueOf(ancestorFolder.getFolderId()));
    PortalUtil.addPortletBreadcrumbEntry(request,ancestorFolder.getName(),portletURL.toString());
  }
  portletURL.setParameter("folderId",String.valueOf(folder.getFolderId()));
  if (folder.getFolderId() != BookmarksFolderConstants.DEFAULT_PARENT_FOLDER_ID) {
    BookmarksFolder unescapedFolder=folder.toUnescapedModel();
    PortalUtil.addPortletBreadcrumbEntry(request,unescapedFolder.getName(),portletURL.toString());
  }
}
