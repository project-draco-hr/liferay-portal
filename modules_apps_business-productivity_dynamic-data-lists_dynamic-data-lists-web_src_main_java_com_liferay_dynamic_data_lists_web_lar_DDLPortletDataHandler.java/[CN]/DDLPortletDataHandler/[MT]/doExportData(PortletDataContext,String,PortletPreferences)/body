{
  portletDataContext.addPortletPermissions(DDLPermission.RESOURCE_NAME);
  Element rootElement=addExportDataRootElement(portletDataContext);
  if (portletDataContext.getBooleanParameter(NAMESPACE,"data-definitions")) {
    List<DDMTemplate> ddmTemplates=new ArrayList<>();
    ActionableDynamicQuery ddmStructureActionableDynamicQuery=getDDMStructureActionableDynamicQuery(portletDataContext,ddmTemplates);
    ddmStructureActionableDynamicQuery.performActions();
    for (    DDMTemplate ddmTemplate : ddmTemplates) {
      StagedModelDataHandlerUtil.exportStagedModel(portletDataContext,ddmTemplate);
    }
  }
  if (portletDataContext.getBooleanParameter(NAMESPACE,"record-sets")) {
    ActionableDynamicQuery recordSetActionableDynamicQuery=getRecordSetActionableDynamicQuery(portletDataContext);
    recordSetActionableDynamicQuery.performActions();
  }
  if (portletDataContext.getBooleanParameter(NAMESPACE,"records")) {
    ActionableDynamicQuery recordActionableDynamicQuery=getRecordActionableDynamicQuery(portletDataContext);
    recordActionableDynamicQuery.performActions();
  }
  return getExportDataRootElementString(rootElement);
}
