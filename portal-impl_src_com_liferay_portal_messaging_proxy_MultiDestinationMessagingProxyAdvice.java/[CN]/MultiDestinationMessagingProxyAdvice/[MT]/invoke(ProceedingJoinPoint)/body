{
  Message message=new Message();
  ProxyRequest proxyRequest=createProxyRequest(proceedingJoinPoint);
  message.setPayload(proxyRequest);
  Map<String,Object> messageValues=MessageValuesThreadLocal.getValues();
  if (!messageValues.isEmpty()) {
    for (    String key : messageValues.keySet()) {
      message.put(key,messageValues.get(key));
    }
  }
  BaseMultiDestinationProxyBean baseMultiDestinationProxyBean=(BaseMultiDestinationProxyBean)proceedingJoinPoint.getTarget();
  String destinationName=baseMultiDestinationProxyBean.getDestinationName(proxyRequest);
  if (proxyRequest.isSynchronous() || ProxyModeThreadLocal.isForceSync()) {
    return doInvokeSynchronous(message,baseMultiDestinationProxyBean,destinationName);
  }
 else {
    doInvokeAsynchronous(message,baseMultiDestinationProxyBean,destinationName);
    return null;
  }
}
