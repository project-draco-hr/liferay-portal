{
  HttpSession session=request.getSession();
  String emailAddress=GetterUtil.getString(session.getAttribute(GoogleWebKeys.GOOGLE_USER_EMAIL_ADDRESS));
  if (Validator.isNotNull(emailAddress)) {
    session.removeAttribute(GoogleWebKeys.GOOGLE_USER_EMAIL_ADDRESS);
    return _userLocalService.getUserByEmailAddress(companyId,emailAddress);
  }
 else {
    String googleId=GetterUtil.getString((String)session.getAttribute(GoogleWebKeys.GOOGLE_USER_ID));
    if (Validator.isNotNull(googleId)) {
      return _userLocalService.getUserByGoogleId(companyId,googleId);
    }
  }
  return null;
}
