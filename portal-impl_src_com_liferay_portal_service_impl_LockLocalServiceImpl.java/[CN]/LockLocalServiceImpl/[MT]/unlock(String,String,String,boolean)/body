{
  Lock lock=lockFinder.fetchByC_K(className,key,LockMode.UPGRADE);
  if (lock == null) {
    return;
  }
  if (Validator.equals(lock.getOwner(),owner)) {
    LockListener lockListener=LockListenerRegistryUtil.getLockListener(lock.getClassName());
    if (lockListener != null) {
      lockListener.onBeforeUnlock(key);
    }
    try {
      lockPersistence.remove(lock);
    }
  finally {
      if (lockListener != null) {
        lockListener.onAfterUnlock(key);
      }
    }
  }
}
