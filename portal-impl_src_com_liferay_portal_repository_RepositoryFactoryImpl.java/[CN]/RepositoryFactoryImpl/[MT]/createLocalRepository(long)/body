{
  long classNameId=getRepositoryClassNameId(repositoryId);
  RepositoryClassDefinition repositoryClassDefinition=getRepositoryClassDefinition(classNameId);
  RepositoryFactory repositoryFactory=repositoryClassDefinition.getRepositoryFactory();
  LocalRepository localRepository=repositoryFactory.createLocalRepository(repositoryId);
  CapabilityLocalRepository capabilityLocalRepository=new CapabilityLocalRepository(localRepository,repositoryClassDefinition.getRepositoryEventTrigger());
  RepositoryInstanceDefinition repositoryInstanceDefinition=repositoryClassDefinition.createRepositoryInstanceDefinition(capabilityLocalRepository);
  _setupCommonCapabilities(capabilityLocalRepository,repositoryClassDefinition,repositoryInstanceDefinition);
  return capabilityLocalRepository;
}
