{
  addStructure(_parentStructureId,DDMStructureConstants.DEFAULT_PARENT_STRUCTURE_ID,DDMStructureConstants.VERSION_DEFAULT,read("ddm-structure-parent.xsd"),"xml");
  addStructure(_structureId,_parentStructureId,DDMStructureConstants.VERSION_DEFAULT,read("ddm-structure-child.xsd"),"xml");
  long recordSetId=RandomTestUtil.randomLong();
  addRecordSet(recordSetId,_structureId);
  addContent(_contentId,read("ddm-content-hierarchy.xsd"));
  addStorageLink(_storageLinkId,_contentId,_structureId);
  long recordId=RandomTestUtil.randomLong();
  addRecord(recordId,recordSetId,_contentId);
  _upgradeDynamicDataMapping.upgrade();
  String content=getContentData(_contentId);
  String expectedContent=read("ddm-content-hierarchy.json");
  JSONAssert.assertEquals(expectedContent,content,false);
  deleteRecord(recordId);
  deleteRecordSet(recordSetId);
}
