{
  PortletPreferencesImpl preferences=PortletPreferencesSerializer.fromXML(companyId,ownerId,ownerType,plid,portletId,xml);
  String andOperatorPreference=preferences.getValue("and-operator",StringPool.BLANK);
  boolean andOperator=false;
  if (Validator.isNotNull(andOperatorPreference)) {
    andOperator=GetterUtil.getBoolean(andOperatorPreference);
  }
  String[] assetTagNames=preferences.getValues("entries",null);
  String[] notAssetTagNames=preferences.getValues("not-entries",null);
  int i=0;
  if (assetTagNames != null) {
    preferences.setValue("queryContains" + i,String.valueOf(true));
    preferences.setValue("queryAndOperator" + i,String.valueOf(andOperator));
    preferences.setValue("queryName" + i,"assetTags");
    preferences.setValues("queryValues" + i,assetTagNames);
    i++;
  }
  if (notAssetTagNames != null) {
    preferences.setValue("queryContains" + i,String.valueOf(false));
    preferences.setValue("queryAndOperator" + i,String.valueOf(andOperator));
    preferences.setValue("queryName" + i,"assetTags");
    preferences.setValues("queryValues" + i,notAssetTagNames);
    i++;
  }
  return PortletPreferencesSerializer.toXML(preferences);
}
