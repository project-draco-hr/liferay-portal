{
  Map<String,String[]> parameters=portletRequest.getParameterMap();
  String itemSelectedCallback=getValue(parameters,PARAMETER_ITEM_SELECTED_CALLBACK);
  List<ItemSelectorViewRenderer> itemSelectorViewRenderers=new ArrayList<>();
  List<ItemSelectorCriterion> itemSelectorCriteria=getItemSelectorCriteria(parameters);
  ItemSelectorCriterion[] itemSelectorCriteriaArray=itemSelectorCriteria.toArray(new ItemSelectorCriterion[itemSelectorCriteria.size()]);
  for (int i=0; i < itemSelectorCriteria.size(); i++) {
    ItemSelectorCriterion itemSelectorCriterion=itemSelectorCriteria.get(i);
    Class<? extends ItemSelectorCriterion> itemSelectorCriterionClass=itemSelectorCriterion.getClass();
    ItemSelectorCriterionHandler<ItemSelectorCriterion> itemSelectorCriterionHandler=_itemSelectionCriterionHandlers.get(itemSelectorCriterionClass.getName());
    List<ItemSelectorView<ItemSelectorCriterion>> itemSelectorViews=itemSelectorCriterionHandler.getItemSelectorViews(itemSelectorCriterion);
    for (    ItemSelectorView<ItemSelectorCriterion> itemSelectorView : itemSelectorViews) {
      PortletURL portletURL=getItemSelectorURL(portletRequest,itemSelectedCallback,itemSelectorCriteriaArray);
      portletURL.setParameter(PARAMETER_SELECTED_TAB,itemSelectorView.getTitle(portletRequest.getLocale()));
      itemSelectorViewRenderers.add(new ItemSelectorViewRendererImpl(itemSelectorView,itemSelectorCriterion,portletURL,itemSelectedCallback));
    }
  }
  return new ItemSelectorRenderingImpl(itemSelectedCallback,getValue(parameters,PARAMETER_SELECTED_TAB),itemSelectorViewRenderers);
}
