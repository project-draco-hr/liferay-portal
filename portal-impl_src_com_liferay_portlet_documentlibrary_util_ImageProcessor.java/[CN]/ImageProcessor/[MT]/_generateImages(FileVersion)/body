{
  try {
    InputStream inputStream=fileVersion.getContentStream(false);
    byte[] bytes=FileUtil.getBytes(inputStream);
    ImageBag imageBag=ImageProcessorUtil.read(bytes);
    RenderedImage renderedImage=imageBag.getRenderedImage();
    if (renderedImage == null) {
      return;
    }
    String type=_instance._getType(fileVersion);
    _saveThumbnailImage(fileVersion,renderedImage,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_MAX_HEIGHT,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_MAX_WIDTH,getThumbnailFilePath(fileVersion,type));
    if ((PrefsPropsUtil.getInteger(PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_1_MAX_HEIGHT) > 0) || (PrefsPropsUtil.getInteger(PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_1_MAX_WIDTH) > 0)) {
      _saveThumbnailImage(fileVersion,renderedImage,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_1_MAX_HEIGHT,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_1_MAX_WIDTH,_getCustom1FilePath(fileVersion,type));
    }
    if ((PrefsPropsUtil.getInteger(PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_2_MAX_HEIGHT) > 0) || (PrefsPropsUtil.getInteger(PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_2_MAX_WIDTH) > 0)) {
      _saveThumbnailImage(fileVersion,renderedImage,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_2_MAX_HEIGHT,PropsKeys.DL_FILE_ENTRY_THUMBNAIL_CUSTOM_2_MAX_WIDTH,_getCustom2FilePath(fileVersion,type));
    }
  }
 catch (  NoSuchFileEntryException nsfee) {
  }
catch (  Exception e) {
    _log.error(e,e);
  }
 finally {
    _fileVersionIds.remove(fileVersion.getFileVersionId());
  }
}
