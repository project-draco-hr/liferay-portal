{
  String password=user.getPasswordUnencrypted();
  String algorithm=PrefsPropsUtil.getString(user.getCompanyId(),PropsKeys.LDAP_AUTH_PASSWORD_ENCRYPTION_ALGORITHM);
  if (Validator.isNotNull(algorithm)) {
    try {
      password="{" + algorithm + "}"+ PwdEncryptor.encrypt(algorithm,password,null);
    }
 catch (    PwdEncryptorException e) {
      throw new SystemException(e);
    }
  }
  return password;
}
