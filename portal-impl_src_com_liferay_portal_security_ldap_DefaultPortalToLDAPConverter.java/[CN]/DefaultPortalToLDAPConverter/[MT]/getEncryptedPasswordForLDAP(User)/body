{
  String password=user.getPasswordUnencrypted();
  if (Validator.isNull(password)) {
    return password;
  }
  String algorithm=PrefsPropsUtil.getString(user.getCompanyId(),PropsKeys.LDAP_AUTH_PASSWORD_ENCRYPTION_ALGORITHM);
  if (Validator.isNull(algorithm)) {
    return password;
  }
  try {
    StringBundler sb=new StringBundler(4);
    if (!algorithm.equals(PasswordEncryptorUtil.TYPE_NONE)) {
      sb.append(StringPool.OPEN_CURLY_BRACE);
      sb.append(algorithm);
      sb.append(StringPool.CLOSE_CURLY_BRACE);
    }
    sb.append(PasswordEncryptorUtil.encrypt(algorithm,password,null));
    return sb.toString();
  }
 catch (  PwdEncryptorException pee) {
    throw new SystemException(pee);
  }
}
