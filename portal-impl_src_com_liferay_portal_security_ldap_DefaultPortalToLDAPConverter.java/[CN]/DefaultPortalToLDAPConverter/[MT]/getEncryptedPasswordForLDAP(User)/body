{
  String password=user.getPasswordUnencrypted();
  String algorithm=PrefsPropsUtil.getString(user.getCompanyId(),PropsKeys.LDAP_AUTH_PASSWORD_ENCRYPTION_ALGORITHM);
  if (Validator.isNotNull(algorithm)) {
    try {
      StringBundler sb=new StringBundler(4);
      sb.append(StringPool.OPEN_CURLY_BRACE);
      sb.append(algorithm);
      sb.append(StringPool.CLOSE_CURLY_BRACE);
      sb.append(PwdEncryptor.encrypt(algorithm,password,null));
      password=sb.toString();
    }
 catch (    PwdEncryptorException pee) {
      throw new SystemException(pee);
    }
  }
  return password;
}
