{
  List<DLFileEntry> srcFileEntries=getFileEntries(srcFolder.getGroupId(),srcFolder.getFolderId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  for (  DLFileEntry srcFileEntry : srcFileEntries) {
    String name=srcFileEntry.getName();
    String title=srcFileEntry.getTitle();
    String description=srcFileEntry.getDescription();
    String extraSettings=srcFileEntry.getExtraSettings();
    long size=srcFileEntry.getSize();
    try {
      InputStream is=dlLocalService.getFileAsStream(srcFolder.getCompanyId(),srcFolder.getFolderId(),name);
      addFileEntry(destFolder.getGroupId(),destFolder.getFolderId(),title,description,null,extraSettings,is,size,serviceContext);
    }
 catch (    Exception e) {
      _log.error(e,e);
      continue;
    }
  }
  List<DLFolder> srcSubfolders=getFolders(srcFolder.getGroupId(),srcFolder.getFolderId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  DLFolder srcSubfolder : srcSubfolders) {
    String name=srcSubfolder.getName();
    String description=srcSubfolder.getDescription();
    DLFolder destSubfolder=addFolder(destFolder.getGroupId(),destFolder.getFolderId(),name,description,serviceContext);
    copyFolder(srcSubfolder,destSubfolder,serviceContext);
  }
}
