{
  String resourceID=GetterUtil.getString(resourceRequest.getResourceID());
  if (resourceID.equals("getCategories")) {
    try {
      JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
      List<AssetCategory> categories=getCategories(resourceRequest);
      for (      AssetCategory category : categories) {
        JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
        List<AssetCategory> childCategories=_assetCategoryService.getChildCategories(category.getCategoryId());
        jsonObject.put("categoryId",category.getCategoryId());
        jsonObject.put("childrenCount",childCategories.size());
        jsonObject.put("hasChildren",!childCategories.isEmpty());
        jsonObject.put("name",category.getName());
        jsonObject.put("parentCategoryId",category.getParentCategoryId());
        jsonObject.put("titleCurrentValue",category.getTitleCurrentValue());
        jsonArray.put(jsonObject);
      }
      writeJSON(resourceRequest,resourceResponse,jsonArray.toString());
    }
 catch (    PortalException pe) {
      throw new PortletException();
    }
  }
 else {
    super.serveResource(resourceRequest,resourceResponse);
  }
}
