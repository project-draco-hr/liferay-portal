{
  WikiPage oldPage=getPage(nodeId,title,version);
  String[] assetTagNames=assetTagLocalService.getTagNames(WikiPage.class.getName(),oldPage.getResourcePrimKey());
  long[] assetCategoryIds=assetCategoryLocalService.getCategoryIds(WikiPage.class.getName(),oldPage.getResourcePrimKey());
  AssetEntry entry=assetEntryLocalService.getEntry(WikiPage.class.getName(),oldPage.getResourcePrimKey());
  List<AssetLink> assetLinks=assetLinkLocalService.getLinks(entry.getEntryId());
  long[] assetLinkIds=StringUtil.split(ListUtil.toString(assetLinks,AssetLink.ENTRY_ID2_ACCESSOR),0L);
  serviceContext.setAssetTagNames(assetTagNames);
  serviceContext.setAssetCategoryIds(assetCategoryIds);
  serviceContext.setAssetLinkEntryIds(assetLinkIds);
  return updatePage(userId,nodeId,title,0,oldPage.getContent(),WikiPageConstants.REVERTED + " to " + version,false,oldPage.getFormat(),getParentPageTitle(oldPage),oldPage.getRedirectTitle(),serviceContext);
}
