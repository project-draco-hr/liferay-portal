{
  long controlPanelPlid=PortalUtil.getControlPanelPlid(serviceContext.getCompanyId());
  String layoutFullURL=getLayoutURL(node.getGroupId(),PortletKeys.WIKI,serviceContext);
  String pageURL=StringPool.BLANK;
  if (Validator.isNotNull(layoutFullURL)) {
    pageURL=layoutFullURL + Portal.FRIENDLY_URL_SEPARATOR + "wiki/"+ node.getNodeId()+ StringPool.SLASH+ HttpUtil.encodeURL(page.getTitle());
  }
 else {
    PortletURL portletURL=PortletURLFactoryUtil.create(request,PortletKeys.WIKI_ADMIN,controlPanelPlid,PortletRequest.RENDER_PHASE);
    portletURL.setParameter("struts_action","/wiki_admin/view_page_activities");
    portletURL.setParameter("nodeId",String.valueOf(node.getNodeId()));
    portletURL.setParameter("title",page.getTitle());
    pageURL=portletURL.toString();
  }
  return pageURL;
}
