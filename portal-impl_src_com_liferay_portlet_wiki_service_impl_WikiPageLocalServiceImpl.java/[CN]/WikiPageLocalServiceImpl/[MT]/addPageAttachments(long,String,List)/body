{
  long primKey=WikiPageResourceLocalServiceUtil.getPageResourcePrimKey(nodeId,title);
  WikiPageResource pageResource=WikiPageResourceLocalServiceUtil.getPageResource(primKey);
  if (files.size() > 0) {
    long companyId=pageResource.getNode().getCompanyId();
    String portletId=CompanyImpl.SYSTEM_STRING;
    long groupId=GroupImpl.DEFAULT_PARENT_GROUP_ID;
    long repositoryId=CompanyImpl.SYSTEM;
    String dirName=pageResource.getAttachmentsDir();
    try {
      try {
        dlService.addDirectory(companyId,repositoryId,dirName);
      }
 catch (      DuplicateDirectoryException dde) {
      }
      for (int i=0; i < files.size(); i++) {
        ObjectValuePair ovp=(ObjectValuePair)files.get(i);
        String fileName=(String)ovp.getKey();
        byte[] byteArray=(byte[])ovp.getValue();
        try {
          dlService.addFile(companyId,portletId,groupId,repositoryId,dirName + "/" + fileName,StringPool.BLANK,new String[0],byteArray);
        }
 catch (        DuplicateFileException dfe) {
        }
      }
    }
 catch (    RemoteException re) {
      throw new SystemException(re);
    }
  }
}
