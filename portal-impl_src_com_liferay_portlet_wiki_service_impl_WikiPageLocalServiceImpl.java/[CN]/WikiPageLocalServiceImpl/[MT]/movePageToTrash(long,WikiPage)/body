{
  WikiPage updatedPage=updateStatus(userId,page,WorkflowConstants.STATUS_IN_TRASH,new ServiceContext());
  TrashEntry trashEntry=trashEntryLocalService.getEntry(WikiPage.class.getName(),updatedPage.getResourcePrimKey());
  String trashTitle=TrashUtil.getTrashTitle(trashEntry.getEntryId());
  List<WikiPage> versionPages=wikiPagePersistence.findByR_N_H(page.getResourcePrimKey(),page.getNodeId(),false);
  for (  WikiPage versionPage : versionPages) {
    versionPage.setTitle(trashTitle);
    wikiPagePersistence.update(versionPage);
  }
  WikiPageResource pageResource=wikiPageResourcePersistence.fetchByPrimaryKey(page.getResourcePrimKey());
  pageResource.setTitle(trashTitle);
  wikiPageResourcePersistence.update(pageResource);
  updatedPage.setTitle(trashTitle);
  return wikiPagePersistence.update(updatedPage);
}
