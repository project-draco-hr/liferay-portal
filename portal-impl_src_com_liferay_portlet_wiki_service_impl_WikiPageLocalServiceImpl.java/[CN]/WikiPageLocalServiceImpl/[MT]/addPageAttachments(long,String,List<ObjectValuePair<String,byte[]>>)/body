{
  if (files.size() == 0) {
    return;
  }
  WikiPage page=getPage(nodeId,title);
  long companyId=page.getCompanyId();
  String portletId=CompanyConstants.SYSTEM_STRING;
  long groupId=GroupImpl.DEFAULT_PARENT_GROUP_ID;
  long repositoryId=CompanyConstants.SYSTEM;
  String dirName=page.getAttachmentsDir();
  try {
    try {
      dlService.addDirectory(companyId,repositoryId,dirName);
    }
 catch (    DuplicateDirectoryException dde) {
    }
    for (int i=0; i < files.size(); i++) {
      ObjectValuePair<String,byte[]> ovp=files.get(i);
      String fileName=ovp.getKey();
      byte[] byteArray=ovp.getValue();
      if (Validator.isNull(fileName)) {
        continue;
      }
      try {
        dlService.addFile(companyId,portletId,groupId,repositoryId,dirName + "/" + fileName,StringPool.BLANK,new String[0],byteArray);
      }
 catch (      DuplicateFileException dfe) {
      }
    }
  }
 catch (  RemoteException re) {
    throw new SystemException(re);
  }
}
