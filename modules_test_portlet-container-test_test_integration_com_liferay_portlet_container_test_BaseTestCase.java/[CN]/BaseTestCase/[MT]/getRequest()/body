{
  MockHttpServletRequest request=new MockHttpServletRequest();
  ThemeDisplay themeDisplay=ThemeDisplayFactory.create();
  Company company=CompanyLocalServiceUtil.getCompany(layout.getCompanyId());
  themeDisplay.setCompany(company);
  themeDisplay.setLayout(layout);
  themeDisplay.setPlid(layout.getPlid());
  themeDisplay.setPortalURL(TestPropsValues.PORTAL_URL);
  themeDisplay.setRequest(request);
  themeDisplay.setScopeGroupId(group.getGroupId());
  themeDisplay.setSiteGroupId(group.getGroupId());
  themeDisplay.setUser(TestPropsValues.getUser());
  request.setAttribute(WebKeys.LAYOUT,layout);
  request.setAttribute(WebKeys.THEME_DISPLAY,themeDisplay);
  return request;
}
