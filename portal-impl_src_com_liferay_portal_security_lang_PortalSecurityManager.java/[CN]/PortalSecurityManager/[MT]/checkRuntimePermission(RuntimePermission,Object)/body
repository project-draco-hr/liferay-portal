{
  if (_inProcessCheck.get().booleanValue()) {
    return;
  }
  _log(permission,context);
  String name=permission.getName();
  if (name.equals(_PERMISSION_SET_SECURITY_MANAGER)) {
    throw new SecurityException("Attempted to set another security manager");
  }
 else   if (name.equals(_PERMISSION_EXIT_VM)) {
    Thread.dumpStack();
    throw new SecurityException("Attempted to shutdown the VM!");
  }
 else   if (name.startsWith("accessClassInPackage.")) {
    int pos=name.indexOf(StringPool.PERIOD);
    String pkg=name.substring(pos);
    _checkPackageAccess(pkg);
  }
}
