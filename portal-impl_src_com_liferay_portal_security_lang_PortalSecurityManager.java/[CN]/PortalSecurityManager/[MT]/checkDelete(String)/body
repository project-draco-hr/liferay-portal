{
  if (!PortalSecurityManagerThreadLocal.isEnabled()) {
    return;
  }
  PACLPolicy paclPolicy=getPACLPolicy(_logCheckDelete.isDebugEnabled());
  if (_logCheckDelete.isDebugEnabled()) {
    _logCheckDelete.debug("Using PACL policy " + paclPolicy + " to check permissions to delete file "+ fileName);
  }
  if (paclPolicy != null) {
    if (!paclPolicy.hasFileDelete(fileName)) {
      throw new SecurityException("Attempted to delete file " + fileName);
    }
  }
  super.checkDelete(fileName);
}
