{
  boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
  if (!enabled) {
    parentCheckPermission(permission,context);
    return;
  }
  PACLPolicy paclPolicy=PACLPolicyManager.getDefaultPACLPolicy();
  if (!paclPolicy.isCheckablePermission(permission)) {
    parentCheckPermission(permission,context);
    return;
  }
  paclPolicy=getPACLPolicy(permission);
  if ((paclPolicy == null) || !paclPolicy.isActive()) {
    parentCheckPermission(permission,context);
    return;
  }
  paclPolicy.checkPermission(permission);
  parentCheckPermission(permission,context);
}
