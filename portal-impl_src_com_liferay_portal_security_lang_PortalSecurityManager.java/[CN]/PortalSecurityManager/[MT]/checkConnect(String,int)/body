{
  if (!PortalSecurityManagerThreadLocal.isEnabled()) {
    return;
  }
  if (port == -1) {
    if (_logCheckConnect.isDebugEnabled()) {
      _logCheckConnect.debug("Always allow resolving of host " + host);
    }
    return;
  }
  PACLPolicy paclPolicy=getPACLPolicy(_logCheckConnect.isDebugEnabled());
  if (_logCheckConnect.isDebugEnabled()) {
    _logCheckConnect.debug("Using PACL policy " + paclPolicy + " to check permissions to connect to host "+ host+ " on port "+ port);
  }
  if (paclPolicy != null) {
    if (!paclPolicy.hasSocketConnect(host,port)) {
      throw new SecurityException("Attempted to connect to host " + host + " on port "+ port);
    }
  }
  super.checkConnect(host,port);
}
