{
  if (!PortalSecurityManagerThreadLocal.isEnabled()) {
    return;
  }
  PACLPolicy paclPolicy=getPACLPolicy(_logCheckExec.isDebugEnabled());
  if (_logCheckExec.isDebugEnabled()) {
    _logCheckExec.debug("Using PACL policy " + paclPolicy + " to check permissions to execute file "+ fileName);
  }
  if (paclPolicy != null) {
    if (!paclPolicy.hasFileExecute(fileName)) {
      throw new SecurityException("Attempted to execute file " + fileName);
    }
  }
  super.checkExec(fileName);
}
