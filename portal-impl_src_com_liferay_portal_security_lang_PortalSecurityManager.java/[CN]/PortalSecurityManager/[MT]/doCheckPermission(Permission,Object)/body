{
  boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
  if (!enabled) {
    if (_parentSecurityManager != null) {
      _parentSecurityManager.checkPermission(permission,context);
    }
    return;
  }
  PACLPolicy paclPolicy=getPACLPolicy(permission,_log.isDebugEnabled());
  if ((paclPolicy == null) || !paclPolicy.isActive()) {
    if (_parentSecurityManager != null) {
      _parentSecurityManager.checkPermission(permission,context);
    }
    return;
  }
  paclPolicy.checkPermission(permission);
  if (_parentSecurityManager != null) {
    _parentSecurityManager.checkPermission(permission,context);
  }
}
