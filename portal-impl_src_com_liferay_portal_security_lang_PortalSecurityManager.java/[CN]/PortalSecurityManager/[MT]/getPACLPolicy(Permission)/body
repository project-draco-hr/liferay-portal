{
  if (permission instanceof PortalHookPermission) {
    PortalHookPermission portalHookPermission=(PortalHookPermission)permission;
    ClassLoader classLoader=portalHookPermission.getClassLoader();
    PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
    if (paclPolicy == null) {
      paclPolicy=PACLPolicyManager.getDefaultPACLPolicy();
    }
    return paclPolicy;
  }
  if (!PortalSecurityManagerThreadLocal.isCheckGetClassLoaderEnabled() && (permission instanceof RuntimePermission)) {
    String name=permission.getName();
    if (name.startsWith(PACLConstants.RUNTIME_PERMISSION_GET_CLASSLOADER)) {
      return PACLPolicyManager.getDefaultPACLPolicy();
    }
  }
  return PACLClassUtil.getPACLPolicyByReflection(_log.isDebugEnabled());
}
