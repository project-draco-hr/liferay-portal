{
  PACLPolicy paclPolicy=PortalSecurityManagerThreadLocal.getPACLPolicy();
  if (paclPolicy != null) {
    return paclPolicy;
  }
  if (permission instanceof PortalHookPermission) {
    PortalHookPermission portalHookPermission=(PortalHookPermission)permission;
    ClassLoader classLoader=portalHookPermission.getClassLoader();
    paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
    if (paclPolicy == null) {
      paclPolicy=PACLPolicyManager.getDefaultPACLPolicy();
    }
    return paclPolicy;
  }
  return PACLClassUtil.getPACLPolicyByReflection(_log.isDebugEnabled());
}
