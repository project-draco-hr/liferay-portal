{
  if (permission instanceof PortalHookPermission) {
    PortalHookPermission portalHookPermission=(PortalHookPermission)permission;
    ClassLoader classLoader=portalHookPermission.getClassLoader();
    PACLPolicy paclPolicy=PACLPolicyManager.getPACLPolicy(classLoader);
    if (paclPolicy == null) {
      paclPolicy=PACLPolicyManager.getDefaultPACLPolicy();
    }
    return paclPolicy;
  }
 else   if ((permission instanceof RuntimePermission) && (permission.getName().startsWith(PACLConstants.RUNTIME_PERMISSION_GET_CLASSLOADER)) && !PortalSecurityManagerThreadLocal.isGetClassLoaderCheckEnabled()) {
    return PACLPolicyManager.getDefaultPACLPolicy();
  }
  return PACLClassUtil.getPACLPolicyByReflection(_log.isDebugEnabled());
}
