{
  if (!PortalSecurityManagerThreadLocal.isEnabled()) {
    return;
  }
  PACLPolicy paclPolicy=getPACLPolicy(_logCheckWrite.isDebugEnabled());
  if (_logCheckWrite.isDebugEnabled()) {
    _logCheckWrite.debug("Using PACL policy " + paclPolicy + " to check permissions to write file "+ fileName);
  }
  if (paclPolicy != null) {
    if (!paclPolicy.hasFileWrite(fileName)) {
      throw new SecurityException("Attempted to write file " + fileName);
    }
  }
  super.checkWrite(fileName);
}
