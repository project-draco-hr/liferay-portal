{
  Group group=GroupLocalServiceUtil.getGroup(portletDataContext.getGroupId());
  String range=MapUtil.getString(portletDataContext.getParameterMap(),RANGE);
  if (!group.isStagedRemotely() && range.equals(RANGE_FROM_LAST_PUBLISH_DATE)) {
    Date portletLastPublishDate=getLastPublishDate(jxPortletPreferences);
    if (portletLastPublishDate == null) {
      return null;
    }
    if (portletDataContext.getStartDate() == null) {
      return portletLastPublishDate;
    }
    if (portletLastPublishDate.before(portletDataContext.getStartDate())) {
      return portletLastPublishDate;
    }
  }
  return portletDataContext.getStartDate();
}
