{
  Map<String,String> namesMap=new HashMap<>();
  if (Validator.isNotNull(firstName)) {
    if (useInitials) {
      firstName=firstName.substring(0,1);
    }
    namesMap.put("first-name",firstName);
  }
  if (Validator.isNotNull(middleName)) {
    if (useInitials) {
      middleName=middleName.substring(0,1);
    }
    namesMap.put("middle-name",middleName);
  }
  if (Validator.isNotNull(lastName)) {
    namesMap.put("last-name",lastName);
  }
  if (prefixId != 0) {
    try {
      String prefix=ListTypeServiceUtil.getListType(prefixId).getName();
      prefix=LanguageUtil.get(locale,prefix);
      namesMap.put("prefix",prefix);
    }
 catch (    NoSuchListTypeException nslte) {
      if (_log.isDebugEnabled()) {
        _log.debug("Ignoring full name prefix " + prefixId,nslte);
      }
    }
catch (    PortalException pe) {
      throw new SystemException(pe);
    }
  }
  if (suffixId != 0) {
    try {
      String suffix=ListTypeServiceUtil.getListType(suffixId).getName();
      suffix=LanguageUtil.get(locale,suffix);
      namesMap.put("suffix",suffix);
    }
 catch (    NoSuchListTypeException nslte) {
      if (_log.isDebugEnabled()) {
        _log.debug("Ignoring full name suffix " + suffixId,nslte);
      }
    }
catch (    PortalException pe) {
      throw new SystemException(pe);
    }
  }
  FullNameDefinition fullNameDefinition=FullNameDefinitionFactory.getInstance(locale);
  List<FullNameField> fullNameFields=fullNameDefinition.getFullNameFields();
  StringBundler sb=new StringBundler(2 * fullNameFields.size());
  for (  FullNameField fullNameField : fullNameFields) {
    String name=namesMap.get(fullNameField.getName());
    if (name != null) {
      sb.append(StringPool.SPACE);
      sb.append(name);
    }
  }
  return StringUtil.trim(sb.toString());
}
