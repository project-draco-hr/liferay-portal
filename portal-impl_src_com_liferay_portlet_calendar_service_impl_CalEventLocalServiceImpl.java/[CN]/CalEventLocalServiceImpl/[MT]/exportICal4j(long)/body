{
  net.fortuna.ical4j.model.Calendar iCal=new net.fortuna.ical4j.model.Calendar();
  ProdId prodId=new ProdId("-//Liferay Inc//Liferay Portal " + ReleaseInfo.getVersion() + "//EN");
  PropertyList props=iCal.getProperties();
  props.add(prodId);
  props.add(Version.VERSION_2_0);
  props.add(CalScale.GREGORIAN);
  CalEvent event=CalEventUtil.findByPrimaryKey(eventId);
  VEvent vEvent=new VEvent();
  PropertyList eventProps=vEvent.getProperties();
  Uid uid=new Uid(UUID.timeUUID().toString());
  eventProps.add(uid);
  iCal.getComponents().add(vEvent);
  DateTime dateTime=new DateTime(event.getStartDate());
  DtStart dtStart=new DtStart(dateTime);
  eventProps.add(dtStart);
  Calendar cal=Calendar.getInstance();
  Date start=cal.getTime();
  cal.add(Calendar.HOUR,event.getDurationHour());
  cal.add(Calendar.MINUTE,event.getDurationHour());
  Date end=cal.getTime();
  Duration duration=new Duration(start,end);
  eventProps.add(duration);
  Summary summary=new Summary(event.getTitle());
  eventProps.add(summary);
  Description description=new Description(event.getDescription());
  eventProps.add(description);
  Comment comment=new Comment(event.getType());
  eventProps.add(comment);
  if (event.isRepeating()) {
    Recur recur=toRecur(event.getRecurrenceObj());
    RRule rRule=new RRule(recur);
    eventProps.add(rRule);
  }
  return iCal;
}
