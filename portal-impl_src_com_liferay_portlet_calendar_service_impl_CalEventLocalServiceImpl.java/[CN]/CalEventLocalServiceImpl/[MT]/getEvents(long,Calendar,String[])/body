{
  types=ArrayUtil.distinct(types);
  Arrays.sort(types);
  Map<String,List<CalEvent>> eventsPool=CalEventLocalUtil.getEventsPool(groupId);
  String key=CalUtil.toString(cal,types);
  List<CalEvent> events=eventsPool.get(key);
  if (events == null) {
    List<CalEvent> events1=calEventFinder.findByG_SD_T(groupId,CalendarUtil.getGTDate(cal),CalendarUtil.getLTDate(cal),true,types);
    Calendar tzICal=CalendarFactoryUtil.getCalendar(cal.get(Calendar.YEAR),cal.get(Calendar.MONTH),cal.get(Calendar.DATE));
    List<CalEvent> events2=calEventFinder.findByG_SD_T(groupId,CalendarUtil.getGTDate(tzICal),CalendarUtil.getLTDate(tzICal),false,types);
    events=new ArrayList<CalEvent>();
    events.addAll(events1);
    events.addAll(events2);
    events.addAll(getRepeatingEvents(groupId,cal,types));
    events=new UnmodifiableList<CalEvent>(events);
    eventsPool.put(key,events);
  }
  return events;
}
