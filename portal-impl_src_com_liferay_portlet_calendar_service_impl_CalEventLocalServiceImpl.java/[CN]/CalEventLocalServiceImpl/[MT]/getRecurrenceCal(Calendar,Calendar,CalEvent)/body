{
  Calendar eventCal=CalendarFactoryUtil.getCalendar(TimeZoneUtil.getTimeZone(StringPool.UTC));
  eventCal.setTime(event.getStartDate());
  Calendar recurrenceCal=(Calendar)tzICal.clone();
  recurrenceCal.set(Calendar.HOUR_OF_DAY,eventCal.get(Calendar.HOUR_OF_DAY));
  recurrenceCal.set(Calendar.MINUTE,eventCal.get(Calendar.MINUTE));
  recurrenceCal.set(Calendar.SECOND,0);
  recurrenceCal.set(Calendar.MILLISECOND,0);
  if (event.isTimeZoneSensitive()) {
    int gmtDate=eventCal.get(Calendar.DATE);
    long gmtMills=eventCal.getTimeInMillis();
    eventCal.setTimeZone(cal.getTimeZone());
    int tziDate=eventCal.get(Calendar.DATE);
    long tziMills=Time.getDate(eventCal).getTime();
    if (gmtDate != tziDate) {
      int diffDate=0;
      if (gmtMills > tziMills) {
        diffDate=(int)Math.ceil((double)(gmtMills - tziMills) / Time.DAY);
      }
 else {
        diffDate=(int)Math.floor((double)(gmtMills - tziMills) / Time.DAY);
      }
      recurrenceCal.add(Calendar.DATE,diffDate);
    }
  }
  return recurrenceCal;
}
