{
  List<CalEvent> localAndRemoteEvents=new ArrayList<CalEvent>();
  List<String> extCalEventIds=new ArrayList<String>();
  String extCalId=null;
  int index=0;
  CalEvent localEvent=null;
  boolean isSameEvent=true;
  if (remoteEvents == null) {
    return new UnmodifiableList<CalEvent>(localEvents);
  }
  for (Iterator<CalEvent> it=localEvents.iterator(); it.hasNext(); ) {
    CalEvent calEvent=it.next();
    if (calEvent.getSaveToExternalSystem()) {
      localAndRemoteEvents.add(calEvent);
      extCalEventIds.add(calEvent.getExtCalEventId());
    }
  }
  for (Iterator<CalEvent> iterator=remoteEvents.iterator(); iterator.hasNext(); ) {
    CalEvent remoteEvent=iterator.next();
    extCalId=remoteEvent.getExtCalEventId();
    if (extCalEventIds.size() > 0) {
      if (extCalEventIds.contains(extCalId)) {
        index=extCalEventIds.indexOf(extCalId);
        localEvent=localAndRemoteEvents.get(index);
        isSameEvent=CalendarEventSynchronizer.isSameEvent(localEvent,remoteEvent);
        if (isSameEvent == true) {
          iterator.remove();
        }
      }
    }
  }
  List<CalEvent> events=new ArrayList<CalEvent>();
  events.addAll(localEvents);
  events.addAll(remoteEvents);
  return new UnmodifiableList<CalEvent>(events);
}
