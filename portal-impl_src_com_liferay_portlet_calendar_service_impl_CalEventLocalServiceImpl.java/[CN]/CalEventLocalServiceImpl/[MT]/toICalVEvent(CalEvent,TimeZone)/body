{
  VEvent vEvent=new VEvent();
  PropertyList eventProps=vEvent.getProperties();
  Uid uid=new Uid(PortalUUIDUtil.generate());
  eventProps.add(uid);
  DtStart dtStart=new DtStart(new DateTime(event.getStartDate()));
  eventProps.add(dtStart);
  Calendar cal=Calendar.getInstance();
  Date start=cal.getTime();
  cal.add(Calendar.HOUR,event.getDurationHour());
  cal.add(Calendar.MINUTE,event.getDurationHour());
  Date end=cal.getTime();
  Duration duration=new Duration(start,end);
  eventProps.add(duration);
  Summary summary=new Summary(event.getTitle());
  eventProps.add(summary);
  Description description=new Description(event.getDescription());
  eventProps.add(description);
  Comment comment=new Comment(event.getType());
  eventProps.add(comment);
  if (event.isRepeating()) {
    Recur recur=toICalRecurrence(event.getRecurrenceObj());
    RRule rRule=new RRule(recur);
    eventProps.add(rRule);
  }
  return vEvent;
}
