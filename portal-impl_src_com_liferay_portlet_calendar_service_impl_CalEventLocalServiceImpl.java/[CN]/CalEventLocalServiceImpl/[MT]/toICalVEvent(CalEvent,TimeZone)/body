{
  VEvent vEvent=new VEvent();
  PropertyList eventProps=vEvent.getProperties();
  Uid uid=new Uid(PortalUUIDUtil.generate());
  eventProps.add(uid);
  if (event.isAllDay()) {
    DtStart dtStart=new DtStart(new net.fortuna.ical4j.model.Date(event.getStartDate()));
    eventProps.add(dtStart);
    Property dtStartProperty=eventProps.getProperty(Property.DTSTART);
    dtStartProperty.getParameters().add(Value.DATE);
  }
 else {
    DtStart dtStart=new DtStart(new DateTime(event.getStartDate()));
    eventProps.add(dtStart);
    Duration duration=new Duration(new Dur(0,event.getDurationHour(),event.getDurationMinute(),0));
    eventProps.add(duration);
  }
  Summary summary=new Summary(event.getTitle());
  eventProps.add(summary);
  Description description=new Description(event.getDescription());
  eventProps.add(description);
  Location location=new Location(event.getLocation());
  eventProps.add(location);
  Comment comment=new Comment(event.getType());
  eventProps.add(comment);
  if (event.isRepeating()) {
    Recur recur=toICalRecurrence(event.getRecurrenceObj());
    RRule rRule=new RRule(recur);
    eventProps.add(rRule);
  }
  if (!event.getTimeZoneSensitive()) {
    eventProps.add(new TimeZoneSensitive("FALSE"));
  }
  return vEvent;
}
