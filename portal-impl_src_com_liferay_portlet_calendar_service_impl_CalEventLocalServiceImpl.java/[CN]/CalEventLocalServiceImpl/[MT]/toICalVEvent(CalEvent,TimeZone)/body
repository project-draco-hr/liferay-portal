{
  VEvent vEvent=new VEvent();
  PropertyList eventProps=vEvent.getProperties();
  Uid uid=new Uid(event.getUuid());
  eventProps.add(uid);
  if (event.isAllDay()) {
    DtStart dtStart=new DtStart(new net.fortuna.ical4j.model.Date(event.getStartDate()));
    eventProps.add(dtStart);
  }
 else {
    DtStart dtStart=new DtStart(new DateTime(event.getStartDate()));
    eventProps.add(dtStart);
    Dur dur=new Dur(0,event.getDurationHour(),event.getDurationMinute(),0);
    DtEnd dtEnd=new DtEnd(new DateTime(dur.getTime(event.getStartDate())));
    eventProps.add(dtEnd);
  }
  Summary summary=new Summary(event.getTitle());
  eventProps.add(summary);
  Description description=new Description(HtmlUtil.render(event.getDescription()));
  eventProps.add(description);
  XProperty xProperty=new XProperty("X-ALT-DESC",event.getDescription());
  ParameterList parameters=xProperty.getParameters();
  parameters.add(new XParameter("FMTTYPE","text/html"));
  eventProps.add(xProperty);
  Location location=new Location(event.getLocation());
  eventProps.add(location);
  Comment comment=new Comment(event.getType());
  eventProps.add(comment);
  if (event.isRepeating()) {
    Recur recur=toICalRecurrence(event.getRecurrenceObj());
    RRule rRule=new RRule(recur);
    eventProps.add(rRule);
  }
  if (!event.getTimeZoneSensitive()) {
    eventProps.add(new TimeZoneSensitive("FALSE"));
  }
  return vEvent;
}
