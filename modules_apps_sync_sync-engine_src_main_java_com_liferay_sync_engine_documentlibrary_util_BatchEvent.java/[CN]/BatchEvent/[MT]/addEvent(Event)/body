{
  SyncAccount syncAccount=SyncAccountService.fetchSyncAccount(_syncAccountId);
  if (syncAccount.getBatchFileMaxSize() <= 0) {
    return false;
  }
  try {
    Map<String,Object> parameters=event.getParameters();
    SyncFile syncFile=(SyncFile)parameters.get("syncFile");
    String zipFileId=syncFile.getSyncFileId() + "_" + System.currentTimeMillis();
    Path deltaFilePath=(Path)parameters.get("deltaFilePath");
    Path filePath=(Path)parameters.get("filePath");
    if (deltaFilePath != null) {
      if (!addFile(deltaFilePath,zipFileId,syncAccount.getBatchFileMaxSize())) {
        return false;
      }
    }
 else     if (filePath != null) {
      if (!addFile(filePath,zipFileId,syncAccount.getBatchFileMaxSize())) {
        return false;
      }
    }
    parameters.put("urlPath",event.getURLPath());
    parameters.put("zipFileId",zipFileId);
    parameters=new HashMap<>(parameters);
    parameters.remove("deltaFilePath");
    parameters.remove("filePath");
    parameters.remove("syncFile");
    _batchParameters.add(parameters);
    _eventCount++;
    _handlers.put(zipFileId,event.getHandler());
    if ((_eventCount >= 250) || (_totalFileSize >= syncAccount.getBatchFileMaxSize())) {
      fireBatchEvent();
    }
    return true;
  }
 catch (  IOException ioe) {
    if (_logger.isDebugEnabled()) {
      _logger.debug(ioe.getMessage(),ioe);
    }
    return false;
  }
}
