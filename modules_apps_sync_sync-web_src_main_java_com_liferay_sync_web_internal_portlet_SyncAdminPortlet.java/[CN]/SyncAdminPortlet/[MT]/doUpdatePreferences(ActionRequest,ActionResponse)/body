{
  PortletPreferences portletPreferences=PrefsPropsUtil.getPreferences(CompanyThreadLocal.getCompanyId());
  boolean allowUserPersonalSites=ParamUtil.getBoolean(actionRequest,"allowUserPersonalSites");
  portletPreferences.setValue(SyncServiceConfigurationKeys.SYNC_ALLOW_USER_PERSONAL_SITES,String.valueOf(allowUserPersonalSites));
  boolean enabled=ParamUtil.getBoolean(actionRequest,"enabled");
  portletPreferences.setValue(SyncServiceConfigurationKeys.SYNC_SERVICES_ENABLED,String.valueOf(enabled));
  int maxConnections=ParamUtil.getInteger(actionRequest,"maxConnections");
  portletPreferences.setValue(SyncServiceConfigurationKeys.SYNC_CLIENT_MAX_CONNECTIONS,String.valueOf(maxConnections));
  boolean oAuthEnabled=ParamUtil.getBoolean(actionRequest,"oAuthEnabled");
  portletPreferences.setValue(SyncConstants.SYNC_OAUTH_ENABLED,String.valueOf(oAuthEnabled));
  int pollInterval=ParamUtil.getInteger(actionRequest,"pollInterval");
  portletPreferences.setValue(SyncServiceConfigurationKeys.SYNC_CLIENT_POLL_INTERVAL,String.valueOf(pollInterval));
  portletPreferences.store();
  if (oAuthEnabled) {
    if (!_syncOAuthHelperUtil.isDeployed()) {
      SessionErrors.add(actionRequest,OAuthPortletUndeployedException.class);
      return;
    }
    ServiceContext serviceContext=ServiceContextFactory.getInstance(actionRequest);
    _syncOAuthHelperUtil.enableOAuth(CompanyThreadLocal.getCompanyId(),serviceContext);
  }
}
