{
  UnicodeProperties settingsProperties=vocabulary.getSettingsProperties();
  long[] selectedClassNameIds=StringUtil.split(settingsProperties.getProperty("selectedClassNameIds"),0L);
  if (selectedClassNameIds.length == 0) {
    return;
  }
  if ((selectedClassNameIds[0] != AssetCategoryConstants.ALL_CLASS_NAME_IDS) && !ArrayUtil.contains(selectedClassNameIds,classNameId)) {
    return;
  }
  String className=PortalUtil.getClassName(classNameId);
  AssetRendererFactory assetRendererFactory=AssetRendererFactoryRegistryUtil.getAssetRendererFactoryByClassName(className);
  if (!assetRendererFactory.isCategorizable()) {
    return;
  }
  long[] requiredClassNameIds=StringUtil.split(settingsProperties.getProperty("requiredClassNameIds"),0L);
  List<AssetCategory> categories=AssetCategoryLocalServiceUtil.getVocabularyCategories(vocabulary.getVocabularyId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
  if ((requiredClassNameIds.length > 0) && ((requiredClassNameIds[0] == AssetCategoryConstants.ALL_CLASS_NAME_IDS) || ArrayUtil.contains(requiredClassNameIds,classNameId))) {
    boolean found=false;
    for (    AssetCategory category : categories) {
      if (ArrayUtil.contains(categoryIds,category.getCategoryId())) {
        found=true;
        break;
      }
    }
    if (!found && !categories.isEmpty()) {
      throw new AssetCategoryException(vocabulary,AssetCategoryException.AT_LEAST_ONE_CATEGORY);
    }
  }
  if (!vocabulary.isMultiValued()) {
    boolean duplicate=false;
    for (    AssetCategory category : categories) {
      if (ArrayUtil.contains(categoryIds,category.getCategoryId())) {
        if (!duplicate) {
          duplicate=true;
        }
 else {
          throw new AssetCategoryException(vocabulary,AssetCategoryException.TOO_MANY_CATEGORIES);
        }
      }
    }
  }
}
