{
  if (name.startsWith(StringPool.SLASH)) {
    name=name.substring(1);
  }
  if (is == null) {
    return;
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Adding " + name);
  }
  ZipEntry entry=new ZipEntry(name);
  _zos.putNextEntry(entry);
  if (StreamUtil.USE_NIO) {
    ReadableByteChannel readableByteChannel=Channels.newChannel(is);
    WritableByteChannel writableByteChannel=Channels.newChannel(_zos);
    StreamUtil.transfer(readableByteChannel,writableByteChannel);
    StreamUtil.cleanUp(readableByteChannel);
  }
 else {
    int count=-1;
    while ((count=is.read(_data,0,_BUFFER)) != -1) {
      _zos.write(_data,0,count);
    }
    StreamUtil.cleanUp(is);
  }
  _zos.closeEntry();
}
