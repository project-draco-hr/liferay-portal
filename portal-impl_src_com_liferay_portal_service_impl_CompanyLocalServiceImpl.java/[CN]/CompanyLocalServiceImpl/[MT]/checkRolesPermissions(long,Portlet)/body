{
  if (portlet.isSystem()) {
    return;
  }
  String[] roleNames=portlet.getRolesArray();
  if (roleNames.length > 0) {
    String selResource=portlet.getPortletId();
    int scope=ResourceConstants.SCOPE_COMPANY;
    String actionId=ActionKeys.ADD_TO_PAGE;
    for (    String roleName : roleNames) {
      Role role=roleLocalService.getRole(companyId,roleName);
      if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
        resourcePermissionLocalService.addResourcePermission(companyId,selResource,scope,String.valueOf(companyId),role.getRoleId(),actionId);
      }
 else {
        permissionLocalService.setRolePermission(role.getRoleId(),companyId,selResource,scope,String.valueOf(companyId),actionId);
      }
    }
    portletLocalService.updatePortlet(companyId,portlet.getPortletId(),StringPool.BLANK,true);
  }
}
