{
  try {
    SearchContext searchContext=new SearchContext();
    Facet assetEntriesFacet=new AssetEntriesFacet(searchContext);
    assetEntriesFacet.setStatic(true);
    searchContext.addFacet(assetEntriesFacet);
    Facet scopeFacet=new ScopeFacet(searchContext);
    scopeFacet.setStatic(true);
    searchContext.addFacet(scopeFacet);
    searchContext.setCompanyId(companyId);
    searchContext.setEnd(end);
    searchContext.setEntryClassNames(SearchEngineUtil.getEntryClassNames());
    if (groupId > 0) {
      searchContext.setGroupIds(new long[]{groupId});
    }
    searchContext.setKeywords(keywords);
    if (Validator.isNotNull(portletId)) {
      searchContext.setPortletIds(new String[]{portletId});
    }
    searchContext.setSearchEngineId(SearchEngineUtil.SYSTEM_ENGINE_ID);
    searchContext.setStart(start);
    searchContext.setUserId(userId);
    Indexer indexer=FacetedSearcher.getInstance();
    return indexer.search(searchContext);
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
