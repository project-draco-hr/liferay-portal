{
  virtualHost=virtualHost.trim().toLowerCase();
  if ((Validator.isNull(webId)) || (webId.equals(PropsValues.COMPANY_DEFAULT_WEB_ID)) || (companyPersistence.fetchByWebId(webId) != null)) {
    throw new CompanyWebIdException();
  }
  validate(webId,virtualHost,mx);
  Map<String,String> shardParams=new HashMap<String,String>();
  shardParams.put("webId",webId);
  shardParams.put("virtualHost",virtualHost);
  shardParams.put("mx",mx);
  shardName=ShardUtil.getShardSelector().getShardName(ShardUtil.COMPANY_SCOPE,shardName,shardParams);
  Company company=checkCompany(webId,mx,shardName);
  company.setVirtualHost(virtualHost);
  company.setMx(mx);
  companyPersistence.update(company,false);
  return company;
}
