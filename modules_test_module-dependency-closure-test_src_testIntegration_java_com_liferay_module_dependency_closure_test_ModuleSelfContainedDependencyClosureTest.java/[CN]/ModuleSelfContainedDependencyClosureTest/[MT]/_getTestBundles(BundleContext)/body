{
  Set<Bundle> testBundles=new HashSet<>();
  testBundles.add(bundleContext.getBundle());
  Path modulesPath=Paths.get(PropsValues.MODULE_FRAMEWORK_MODULES_DIR);
  try (DirectoryStream<Path> directoryStream=Files.newDirectoryStream(Paths.get(PropsValues.MODULE_FRAMEWORK_BASE_DIR,"test"),"*.jar")){
    for (    Path jarPath : directoryStream) {
      Path deployedJarPath=modulesPath.resolve(jarPath.getFileName());
      File deployedJarFile=deployedJarPath.toFile();
      URI uri=deployedJarFile.toURI();
      Bundle deployedBundle=bundleContext.getBundle(uri.toString());
      if (deployedBundle == null) {
        throw new IllegalStateException("Unable to find module " + deployedJarPath);
      }
      testBundles.add(deployedBundle);
    }
  }
   return testBundles;
}
