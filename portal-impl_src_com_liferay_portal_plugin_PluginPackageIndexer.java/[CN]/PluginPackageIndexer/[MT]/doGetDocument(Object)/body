{
  PluginPackage pluginPackage=(PluginPackage)obj;
  String moduleId=pluginPackage.getModuleId();
  String name=pluginPackage.getName();
  String version=pluginPackage.getVersion();
  Date modifiedDate=pluginPackage.getModifiedDate();
  String author=pluginPackage.getAuthor();
  List<String> types=pluginPackage.getTypes();
  List<String> tags=pluginPackage.getTags();
  List<License> licenses=pluginPackage.getLicenses();
  String shortDescription=HtmlUtil.extractText(pluginPackage.getShortDescription());
  String longDescription=HtmlUtil.extractText(pluginPackage.getLongDescription());
  String changeLog=pluginPackage.getChangeLog();
  String pageURL=pluginPackage.getPageURL();
  String repositoryURL=pluginPackage.getRepositoryURL();
  String[] statusAndInstalledVersion=PluginPackageUtil.getStatusAndInstalledVersion(pluginPackage);
  String status=statusAndInstalledVersion[0];
  String installedVersion=statusAndInstalledVersion[1];
  ModuleId moduleIdObj=ModuleId.getInstance(moduleId);
  StringBundler sb=new StringBundler(7);
  sb.append(name);
  sb.append(StringPool.SPACE);
  sb.append(author);
  sb.append(StringPool.SPACE);
  sb.append(shortDescription);
  sb.append(StringPool.SPACE);
  sb.append(longDescription);
  String content=sb.toString();
  Document document=new DocumentImpl();
  document.addUID(PORTLET_ID,moduleId);
  document.addModifiedDate(modifiedDate);
  document.addKeyword(Field.COMPANY_ID,CompanyConstants.SYSTEM);
  document.addKeyword(Field.PORTLET_ID,PORTLET_ID);
  document.addKeyword(Field.GROUP_ID,moduleIdObj.getGroupId());
  document.addText(Field.TITLE,name);
  document.addText(Field.CONTENT,content);
  document.addKeyword("moduleId",moduleId);
  document.addKeyword("artifactId",moduleIdObj.getArtifactId());
  document.addKeyword("version",version);
  document.addText("author",author);
  document.addKeyword("type",types.toArray(new String[0]));
  document.addKeyword("tag",tags.toArray(new String[0]));
  String[] licenseNames=new String[licenses.size()];
  boolean osiLicense=false;
  for (int i=0; i < licenses.size(); i++) {
    License license=licenses.get(i);
    licenseNames[i]=license.getName();
    if (license.isOsiApproved()) {
      osiLicense=true;
    }
  }
  document.addKeyword("license",licenseNames);
  document.addKeyword("osi-approved-license",String.valueOf(osiLicense));
  document.addText("shortDescription",shortDescription);
  document.addText("longDescription",longDescription);
  document.addText("changeLog",changeLog);
  document.addText("pageURL",pageURL);
  document.addKeyword("repositoryURL",repositoryURL);
  document.addKeyword(Field.STATUS,status);
  document.addKeyword("installedVersion",installedVersion);
  return document;
}
