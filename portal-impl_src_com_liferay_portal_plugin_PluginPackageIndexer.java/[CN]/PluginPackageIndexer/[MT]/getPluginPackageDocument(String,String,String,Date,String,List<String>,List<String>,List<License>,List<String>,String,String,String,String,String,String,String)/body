{
  ModuleId moduleIdObj=ModuleId.getInstance(moduleId);
  shortDescription=HtmlUtil.extractText(shortDescription);
  longDescription=HtmlUtil.extractText(longDescription);
  String content=name + " " + author+ " "+ shortDescription+ " "+ longDescription;
  Document doc=new DocumentImpl();
  doc.addUID(PORTLET_ID,moduleId);
  doc.addModifiedDate(modifiedDate);
  doc.addKeyword(Field.PORTLET_ID,PORTLET_ID);
  doc.addKeyword(Field.GROUP_ID,moduleIdObj.getGroupId());
  doc.addText(Field.TITLE,name);
  doc.addText(Field.CONTENT,content);
  doc.addKeyword("moduleId",moduleId);
  doc.addKeyword("artifactId",moduleIdObj.getArtifactId());
  doc.addKeyword("version",version);
  doc.addText("author",author);
  doc.addKeyword("type",types.toArray(new String[0]));
  doc.addKeyword("tag",tags.toArray(new String[0]));
  String[] licenseNames=new String[licenses.size()];
  boolean osiLicense=false;
  for (int i=0; i < licenses.size(); i++) {
    License license=licenses.get(i);
    licenseNames[i]=license.getName();
    if (license.isOsiApproved()) {
      osiLicense=true;
    }
  }
  doc.addKeyword("license",licenseNames);
  doc.addKeyword("osi-approved-license",String.valueOf(osiLicense));
  doc.addText("shortDescription",shortDescription);
  doc.addText("longDescription",longDescription);
  doc.addText("changeLog",changeLog);
  doc.addText("pageURL",pageURL);
  doc.addKeyword("repositoryURL",repositoryURL);
  doc.addKeyword("status",status);
  doc.addKeyword("installedVersion",installedVersion);
  return doc;
}
