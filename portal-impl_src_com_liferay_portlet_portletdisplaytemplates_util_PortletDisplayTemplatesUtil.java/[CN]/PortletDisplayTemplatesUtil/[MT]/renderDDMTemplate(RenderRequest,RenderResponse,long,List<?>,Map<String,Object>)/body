{
  ThemeDisplay themeDisplay=(ThemeDisplay)renderRequest.getAttribute(WebKeys.THEME_DISPLAY);
  DDMTemplate ddmTemplate=DDMTemplateLocalServiceUtil.getTemplate(ddmTemplateId);
  contextObjects.put(PortletDisplayTemplatesConstants.DDM_TEMPLATE_ID,ddmTemplateId);
  contextObjects.put(PortletDisplayTemplatesConstants.ENTRIES,entries);
  if (entries.size() == 1) {
    contextObjects.put(PortletDisplayTemplatesConstants.ENTRY,entries.get(0));
  }
  contextObjects.put(PortletDisplayTemplatesConstants.LOCALE,renderRequest.getLocale());
  contextObjects.put(PortletDisplayTemplatesConstants.RENDER_REQUEST,renderRequest);
  contextObjects.put(PortletDisplayTemplatesConstants.RENDER_RESPONSE,renderResponse);
  contextObjects.put(PortletDisplayTemplatesConstants.THEME_DISPLAY,themeDisplay);
  contextObjects.putAll(_getPortletPreferences(renderRequest));
  return _transformer.transform(themeDisplay,contextObjects,ddmTemplate.getScript(),ddmTemplate.getLanguage());
}
