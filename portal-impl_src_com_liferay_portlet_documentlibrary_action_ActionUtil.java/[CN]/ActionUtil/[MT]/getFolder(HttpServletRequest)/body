{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long folderId=ParamUtil.getLong(request,"folderId");
  Folder folder=null;
  if ((folderId > 0) && (folderId != DLFolderConstants.DEFAULT_PARENT_FOLDER_ID)) {
    folder=DLAppServiceUtil.getFolder(folderId);
    if (folder.getModel() instanceof DLFolder) {
      DLFolder dlFolder=(DLFolder)folder.getModel();
      if (dlFolder.isInTrash() || dlFolder.isInTrashContainer()) {
        throw new NoSuchFolderException();
      }
    }
  }
 else {
    DLPermission.check(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.VIEW);
  }
  request.setAttribute(WebKeys.DOCUMENT_LIBRARY_FOLDER,folder);
}
