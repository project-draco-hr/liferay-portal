{
  PortletPreferences prefs=req.getPreferences();
  String alfrescoWebClientURL=prefs.getValue("alfresco-web-client-url",StringPool.BLANK);
  String nodeUuid=prefs.getValue("node-uuid",StringPool.BLANK);
  String userId=prefs.getValue("user-id",StringPool.BLANK);
  String password=prefs.getValue("password",StringPool.BLANK);
  boolean maximizeLinks=GetterUtil.getBoolean(prefs.getValue("maximize-links",StringPool.BLANK));
  String previewURL=ParamUtil.getString(req,"previewURL");
  String nodePath=ParamUtil.getString(req,"nodePath");
  String content=null;
  if (Validator.isNotNull(nodePath)) {
    content=AlfrescoContentLocalServiceUtil.getContent(null,nodePath,alfrescoWebClientURL,userId,password);
  }
 else   if (Validator.isNotNull(nodeUuid)) {
    content=AlfrescoContentLocalServiceUtil.getContent(nodeUuid,null,alfrescoWebClientURL,userId,password);
  }
  content=AlfrescoContentUtil.formatContent(content,maximizeLinks,res);
  req.setAttribute(WebKeys.ALFRESCO_CONTENT,content);
  if (Validator.isNull(previewURL)) {
    return mapping.findForward("portlet.alfresco_content.view_1");
  }
 else {
    return mapping.findForward("portlet.alfresco_content.view_2");
  }
}
