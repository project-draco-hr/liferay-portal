{
  if (!_SUPPORTED) {
    throw new IllegalStateException(HeapUtil.class.getName() + " does not support the current JVM");
  }
  StringBundler sb=new StringBundler(5);
  sb.append("-dump:");
  if (live) {
    sb.append("live,");
  }
  if (binary) {
    sb.append("format=b,");
  }
  sb.append("file=");
  sb.append(file);
  List<String> arguments=new ArrayList<String>();
  arguments.add("jmap");
  arguments.add(sb.toString());
  arguments.add(String.valueOf(processId));
  try {
    return ProcessUtil.execute(ProcessUtil.LOGGING_OUTPUT_PROCESSOR,arguments);
  }
 catch (  Exception e) {
    throw new RuntimeException("Unable to perform heap dump",e);
  }
}
