{
  DDMStructure ddmStructure=DDMStructureLocalServiceUtil.getDDMStructure(ddmStructureId);
  DDMFormValues ddmFormValues=FieldsToDDMFormValuesConverterUtil.convert(ddmStructure,fields);
  DDMFormValuesTransformer ddmFormValuesTransformer=new DDMFormValuesTransformer(ddmFormValues);
  ddmFormValuesTransformer.addTransformer("ddm-documentlibrary",new DocumentLibraryDDMFormFieldValueTransformer());
  ddmFormValuesTransformer.addTransformer("ddm-text-html",new HTMLSanitizerDDMFormFieldValueTransformer(serviceContext.getCompanyId(),serviceContext.getScopeGroupId(),serviceContext.getUserId()));
  ddmFormValuesTransformer.transform();
  return DDMFormValuesToFieldsConverterUtil.convert(ddmStructure,ddmFormValues);
}
