{
  String sql=CustomSQLUtil.get(FIND_BY_AND_CATEGORY_IDS);
  sb.append(" AND (");
  for (int i=0; i < categoryIds.length; i++) {
    if (PropsValues.ASSET_CATEGORIES_SEARCH_HIERARCHICAL) {
      List<Long> treeCategoryIdArray=AssetCategoryFinderUtil.getTreeCategoryIds(categoryIds[i]);
      if (treeCategoryIdArray.size() > 1) {
        long[] treeCategoryIds=new long[treeCategoryIdArray.size()];
        for (int j=0; j < treeCategoryIdArray.size(); j++) {
          treeCategoryIds[j]=treeCategoryIdArray.get(j);
        }
        String categoryIdsString=StringUtil.merge(treeCategoryIds);
        String tempSQL=StringUtil.replace(sql,"[$CATEGORY_IDS$]",categoryIdsString);
        sb.append(tempSQL);
        continue;
      }
    }
    String tempSQL=StringUtil.replace(sql,"IN ([$CATEGORY_IDS$])","= ".concat(String.valueOf(categoryIds[i])));
    sb.append(tempSQL);
    if ((i + 1) < categoryIds.length) {
      sb.append(" AND ");
    }
  }
  sb.append(StringPool.CLOSE_PARENTHESIS);
}
