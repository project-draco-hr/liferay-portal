{
  String sql=CustomSQLUtil.get(FIND_BY_AND_CATEGORY_IDS);
  sb.append(" AND (");
  for (int i=0; i < categoryIds.length; i++) {
    String tempSQL=null;
    if (PropsValues.ASSET_CATEGORIES_SEARCH_HIERARCHICAL) {
      List<Long> treeCategoryIds=AssetCategoryFinderUtil.findByG_L(categoryIds[i]);
      if (treeCategoryIds.size() > 1) {
        tempSQL=StringUtil.replace(sql,"[$CATEGORY_ID$]",StringUtil.merge(treeCategoryIds));
      }
    }
    if (tempSQL == null) {
      tempSQL=StringUtil.replace(sql," IN ([$CATEGORY_ID$])"," = " + categoryIds[i]);
    }
    sb.append(tempSQL);
    if ((i + 1) < categoryIds.length) {
      sb.append(" AND ");
    }
  }
  sb.append(StringPool.CLOSE_PARENTHESIS);
}
