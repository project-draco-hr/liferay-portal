{
  Locale locale=null;
  if (languageId != null) {
    locale=LocaleUtil.fromLanguageId(languageId);
  }
  if (locale == null) {
    locale=LocaleThreadLocal.getThemeDisplayLocale();
  }
  if (locale == null) {
    locale=LocaleUtil.getDefault();
  }
  return locale;
}
