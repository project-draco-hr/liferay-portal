{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    StringBundler sb=new StringBundler(5);
    sb.append("select userId, MIN(userName), classNameId, classPK, ");
    sb.append("MIN(createDate), MIN(modifiedDate) from MBMessage ");
    sb.append("where (companyId = " + companyId + ") and ");
    sb.append("(classNameId != 0) and (parentMessageId != 0) ");
    sb.append("group by userId, userName, classNameId, classPK");
    String sql=sb.toString();
    ps=con.prepareStatement(sql);
    rs=ps.executeQuery();
    while (rs.next()) {
      long userId=rs.getLong("userId");
      String userName=rs.getString("userName");
      Date createDate=rs.getDate("createDate");
      Date modifiedDate=rs.getDate("modifiedDate");
      long classNameId=rs.getLong("classNameId");
      long classPK=rs.getLong("classPK");
      long subscriptionId=increment();
      String frequency="instant";
      addSubscription(subscriptionId,companyId,userId,userName,createDate,modifiedDate,classNameId,classPK,frequency);
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
