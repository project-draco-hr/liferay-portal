{
  if (userId != null) {
    Iterator itr=messages.iterator();
    while (itr.hasNext()) {
      MBMessage message=(MBMessage)itr.next();
      MBMessageFlagPK messageFlagPK=new MBMessageFlagPK(message.getTopicId(),message.getMessageId(),userId);
      MBMessageFlag messageFlag=MBMessageFlagUtil.fetchByPrimaryKey(messageFlagPK);
      if (messageFlag == null) {
        messageFlag=MBMessageFlagUtil.create(messageFlagPK);
        messageFlag.setFlag(MBMessageFlag.READ_FLAG);
        MBMessageFlagUtil.update(messageFlag);
      }
    }
  }
}
