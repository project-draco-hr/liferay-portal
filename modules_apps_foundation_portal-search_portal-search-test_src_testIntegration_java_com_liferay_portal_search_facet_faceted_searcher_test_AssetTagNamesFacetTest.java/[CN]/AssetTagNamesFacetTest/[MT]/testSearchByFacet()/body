{
  Group group=userSearchFixture.addGroup();
  final String tag="enterprise. open-source for life";
  userSearchFixture.addUser(group,tag);
  final SearchContext searchContext=getSearchContext(tag);
  MultiValueFacet multiValueFacet=new MultiValueFacet(searchContext);
  multiValueFacet.setFieldName(Field.ASSET_TAG_NAMES);
  multiValueFacet.setStatic(false);
  searchContext.addFacet(multiValueFacet);
  IdempotentRetryAssert.retryAssert(10,TimeUnit.SECONDS,new Callable<Void>(){
    @Override public Void call() throws Exception {
      FacetedSearcher facetedSearcher=createFacetedSearcher();
      facetedSearcher.search(searchContext);
      Map<String,Facet> facets=searchContext.getFacets();
      Facet facet=facets.get(Field.ASSET_TAG_NAMES);
      FacetCollector facetCollector=facet.getFacetCollector();
      AssertUtils.assertEquals(searchContext.getKeywords(),Collections.singletonMap(tag,1),toMap(facetCollector.getTermCollectors()));
      return null;
    }
  }
);
}
