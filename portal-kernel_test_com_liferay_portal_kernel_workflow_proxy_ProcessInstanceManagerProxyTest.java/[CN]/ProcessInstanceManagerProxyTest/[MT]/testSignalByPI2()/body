{
  final long testProcessInstanceId=101;
  final int testProcessInstanceVersion=2;
  final String testActivityName="testActivityName";
  MessageListener getListener=new MessageListener(){
    public void receive(    Message message){
      ProcessInstanceRequest request=(ProcessInstanceRequest)message.getPayload();
      assertNotNull(request);
      assertTrue(request instanceof ProcessInstanceRequest);
      assertEquals(ProcessInstanceRequestType.SIGNAL,request.getType());
      assertEquals(testProcessInstanceId,request.getProcessInstanceId());
      assertEquals(testActivityName,request.getActivityName());
      String responseDestination=message.getResponseDestination();
      if (responseDestination != null) {
        ProcessInstanceInfo instance=new ProcessInstanceInfo(testProcessInstanceId,testProcessInstanceVersion);
        message.setPayload(new WorkflowResultContainer<ProcessInstanceInfo>(instance));
        messageBus.sendMessage(responseDestination,message);
      }
    }
  }
;
  messageBus.registerMessageListener(DestinationNames.WORKFLOW_INSTANCE,getListener);
  ProcessInstanceInfo instance=_proxy.signalProcessInstanceById(testProcessInstanceId,testActivityName,null);
  assertNotNull(instance);
  assertEquals(testProcessInstanceId,instance.getProcessInstanceId());
}
