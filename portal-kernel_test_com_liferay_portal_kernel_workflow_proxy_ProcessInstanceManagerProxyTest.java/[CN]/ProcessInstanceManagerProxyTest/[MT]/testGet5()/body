{
  final String testName="testName";
  final boolean retrieveTokenInfo=true;
  final boolean finished=true;
  MessageListener getListener=new MessageListener(){
    public void receive(    Message message){
      ProcessInstanceRequest request=(ProcessInstanceRequest)message.getPayload();
      assertEquals(ProcessInstanceRequestType.GET,request.getType());
      assertEquals(testName,request.getWorkflowDefinitionName());
      assertFalse(request.isGetAll());
      assertEquals(finished,request.isFinished());
      assertTrue(request.isRetrieveTokenInfo());
      String responseDestination=message.getResponseDestination();
      if (responseDestination != null) {
        List<ProcessInstanceInfo> instances=new ArrayList<ProcessInstanceInfo>();
        message.setPayload(new WorkflowResultContainer<List<ProcessInstanceInfo>>(instances));
        messageBus.sendMessage(responseDestination,message);
      }
    }
  }
;
  messageBus.registerMessageListener(DestinationNames.WORKFLOW_INSTANCE,getListener);
  List<ProcessInstanceInfo> instances=_proxy.getProcessInstanceInfos(testName,retrieveTokenInfo,finished);
  assertNotNull(instances);
  assertEquals(0,instances.size());
}
