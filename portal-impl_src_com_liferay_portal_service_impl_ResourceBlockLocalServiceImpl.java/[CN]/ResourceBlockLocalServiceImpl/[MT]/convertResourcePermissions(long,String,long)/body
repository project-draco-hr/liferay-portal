{
  PermissionedModel permissionedModel=getPermissionedModel(name,primKey);
  long groupId=0;
  if (permissionedModel instanceof GroupedModel) {
    GroupedModel groupedModel=(GroupedModel)permissionedModel;
    groupId=groupedModel.getGroupId();
  }
  ResourceBlock resourceBlock=resourceBlockPersistence.fetchByPrimaryKey(permissionedModel.getResourceBlockId());
  ResourceBlockPermissionsContainer resourceBlockPermissionsContainer=resourceBlockPermissionLocalService.getResourceBlockPermissionsContainer(companyId,groupId,name,primKey);
  String permissionsHash=getPermissionsHash(resourceBlockPermissionsContainer);
  if (resourceBlock != null) {
    if (permissionsHash.equals(resourceBlock.getPermissionsHash())) {
      return resourceBlock;
    }
    releaseResourceBlock(resourceBlock);
  }
  resourceBlock=updateResourceBlockId(companyId,groupId,name,permissionedModel,permissionsHash,resourceBlockPermissionsContainer);
  return resourceBlock;
}
