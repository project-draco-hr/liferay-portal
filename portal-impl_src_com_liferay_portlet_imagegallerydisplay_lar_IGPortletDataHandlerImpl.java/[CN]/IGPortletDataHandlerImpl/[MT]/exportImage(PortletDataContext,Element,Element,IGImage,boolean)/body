{
  if (checkDateRange && !portletDataContext.isWithinDateRange(image.getModifiedDate())) {
    return;
  }
  if (foldersElement != null) {
    exportParentFolder(portletDataContext,foldersElement,image.getFolderId());
  }
  String path=getImagePath(portletDataContext,image);
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  Element imageElement=imagesElement.addElement("image");
  Image largeImage=ImageUtil.findByPrimaryKey(image.getLargeImageId());
  image.setImageType(largeImage.getType());
  portletDataContext.addPermissions(IGImage.class,image.getImageId());
  if (!portletDataContext.isPerformDirectBinaryImport()) {
    String binPath=getImageBinPath(portletDataContext,image);
    imageElement.addAttribute("bin-path",binPath);
    portletDataContext.addZipEntry(binPath,largeImage.getTextObj());
  }
  portletDataContext.addClassedModel(imageElement,path,image,_NAMESPACE);
}
