{
  ActionableDynamicQuery actionableDynamicQuery=new SystemEventActionableDynamicQuery(){
    @Override protected void addCriteria(    DynamicQuery dynamicQuery){
      setGroupId(portletDataContext.getScopeGroupId());
      Property classNameIdProperty=PropertyFactoryUtil.forName("classNameId");
      if (!deletionEventClassNameIds.isEmpty()) {
        dynamicQuery.add(classNameIdProperty.in(deletionEventClassNameIds.toArray()));
      }
      Property typeProperty=PropertyFactoryUtil.forName("type");
      dynamicQuery.add(typeProperty.eq(SystemEventConstants.TYPE_DELETE));
      _addCreateDateProperty(dynamicQuery);
    }
    @Override protected void performAction(    Object object){
      SystemEvent systemEvent=(SystemEvent)object;
      exportDeletionSystemEvent(portletDataContext,systemEvent,rootElement);
    }
    private void _addCreateDateProperty(    DynamicQuery dynamicQuery){
      if (!portletDataContext.hasDateRange()) {
        return;
      }
      Property createDateProperty=PropertyFactoryUtil.forName("createDate");
      Date startDate=portletDataContext.getStartDate();
      dynamicQuery.add(createDateProperty.ge(startDate));
      Date endDate=portletDataContext.getEndDate();
      dynamicQuery.add(createDateProperty.le(endDate));
    }
  }
;
  actionableDynamicQuery.performActions();
}
