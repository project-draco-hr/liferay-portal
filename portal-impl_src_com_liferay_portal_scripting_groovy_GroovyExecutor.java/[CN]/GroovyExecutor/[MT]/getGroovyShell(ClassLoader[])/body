{
  if (ArrayUtil.isEmpty(classLoaders)) {
    if (_groovyShell == null) {
synchronized (this) {
        if (_groovyShell == null) {
          _groovyShell=new GroovyShell();
        }
      }
    }
    return _groovyShell;
  }
  ClassLoader aggregateClassLoader=AggregateClassLoader.getAggregateClassLoader(ClassLoaderUtil.getPortalClassLoader(),classLoaders);
  GroovyShell groovyShell=null;
  if (!_groovyShells.containsKey(aggregateClassLoader)) {
synchronized (this) {
      if (!_groovyShells.containsKey(aggregateClassLoader)) {
        groovyShell=new GroovyShell(aggregateClassLoader);
        _groovyShells.put(aggregateClassLoader,groovyShell);
      }
    }
  }
  return groovyShell;
}
