{
  if (ArrayUtil.isEmpty(classLoaders)) {
    if (_groovyShell == null) {
synchronized (this) {
        if (_groovyShell == null) {
          _groovyShell=new GroovyShell();
        }
      }
    }
    return _groovyShell;
  }
  ClassLoader aggregateClassLoader=AggregateClassLoader.getAggregateClassLoader(ClassLoaderUtil.getPortalClassLoader(),classLoaders);
  GroovyShell groovyShell=_groovyShells.get(aggregateClassLoader);
  if (groovyShell == null) {
synchronized (this) {
      if (groovyShell == null) {
        groovyShell=new GroovyShell(aggregateClassLoader);
        _groovyShells.put(aggregateClassLoader,groovyShell);
      }
    }
  }
  return groovyShell;
}
