{
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  long listId=ParamUtil.getLong(actionRequest,"listId");
  long listItemId=ParamUtil.getLong(actionRequest,"listItemId");
  DDMList list=DDMListLocalServiceUtil.getList(listId);
  DDMStructure structure=list.getStructure();
  Set<String> fieldNames=structure.getFieldNames();
  Fields fields=new Fields();
  for (  String name : fieldNames) {
    Field field=new Field();
    field.setName(name);
    field.setValue(ParamUtil.getString(actionRequest,name));
    fields.put(field);
  }
  ServiceContext serviceContext=ServiceContextFactory.getInstance(DDMListItem.class.getName(),actionRequest);
  DDMListItem listItem=null;
  if (cmd.equals(Constants.ADD)) {
    listItem=DDMListItemLocalServiceUtil.addListItem(listId,fields,serviceContext);
  }
 else {
    listItem=DDMListItemLocalServiceUtil.updateListItem(listItemId,fields,serviceContext);
  }
  return listItem;
}
