{
  long userId=portletDataContext.getUserId(team.getUserUuid());
  Team existingTeam=fetchExistingTeam(team.getUuid(),portletDataContext.getScopeGroupId(),team.getName());
  Team importedTeam=null;
  if (existingTeam == null) {
    ServiceContext serviceContext=portletDataContext.createServiceContext(team);
    serviceContext.setUuid(team.getUuid());
    importedTeam=_teamLocalService.addTeam(userId,portletDataContext.getScopeGroupId(),team.getName(),team.getDescription(),serviceContext);
  }
 else {
    importedTeam=_teamLocalService.updateTeam(existingTeam.getTeamId(),team.getName(),team.getDescription());
  }
  List<Element> userElements=portletDataContext.getReferenceElements(team,User.class);
  for (  Element userElement : userElements) {
    long companyId=GetterUtil.getLong(userElement.attributeValue("company-id"));
    String uuid=userElement.attributeValue("uuid");
    User user=_userLocalService.fetchUserByUuidAndCompanyId(uuid,companyId);
    if ((user != null) && !_userLocalService.hasTeamUser(importedTeam.getTeamId(),user.getUserId())) {
      _userLocalService.addTeamUser(importedTeam.getTeamId(),user);
    }
  }
  List<Element> userGroupElements=portletDataContext.getReferenceElements(team,UserGroup.class);
  for (  Element userGroupElement : userGroupElements) {
    long companyId=GetterUtil.getLong(userGroupElement.attributeValue("company-id"));
    String uuid=userGroupElement.attributeValue("uuid");
    UserGroup userGroup=_userGroupLocalService.fetchUserGroupByUuidAndCompanyId(uuid,companyId);
    if ((userGroup != null) && !_userGroupLocalService.hasTeamUserGroup(importedTeam.getTeamId(),userGroup.getUserGroupId())) {
      _userGroupLocalService.addTeamUserGroup(importedTeam.getTeamId(),userGroup);
    }
  }
  portletDataContext.importClassedModel(team,importedTeam);
}
