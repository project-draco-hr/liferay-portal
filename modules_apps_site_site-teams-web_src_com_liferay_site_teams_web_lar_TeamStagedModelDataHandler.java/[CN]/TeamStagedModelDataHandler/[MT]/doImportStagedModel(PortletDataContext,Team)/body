{
  long userId=portletDataContext.getUserId(team.getUserUuid());
  Team existingTeam=TeamLocalServiceUtil.fetchTeamByUuidAndGroupId(team.getUuid(),portletDataContext.getScopeGroupId());
  if (existingTeam == null) {
    try {
      existingTeam=TeamLocalServiceUtil.getTeam(portletDataContext.getScopeGroupId(),team.getName());
    }
 catch (    NoSuchTeamException nste) {
    }
  }
  Team importedTeam=null;
  if (existingTeam == null) {
    ServiceContext serviceContext=portletDataContext.createServiceContext(team);
    serviceContext.setUuid(team.getUuid());
    importedTeam=TeamLocalServiceUtil.addTeam(userId,portletDataContext.getScopeGroupId(),team.getName(),team.getDescription(),serviceContext);
  }
 else {
    importedTeam=TeamLocalServiceUtil.updateTeam(existingTeam.getTeamId(),team.getName(),team.getDescription());
  }
  List<Element> userElements=portletDataContext.getReferenceElements(team,User.class);
  for (  Element userElement : userElements) {
    long companyId=GetterUtil.getLong(userElement.attributeValue("company-id"));
    String uuid=userElement.attributeValue("uuid");
    User user=UserLocalServiceUtil.fetchUserByUuidAndCompanyId(uuid,companyId);
    if ((user != null) && !UserLocalServiceUtil.hasTeamUser(importedTeam.getTeamId(),user.getUserId())) {
      UserLocalServiceUtil.addTeamUser(importedTeam.getTeamId(),user);
    }
  }
  List<Element> userGroupElements=portletDataContext.getReferenceElements(team,UserGroup.class);
  for (  Element userGroupElement : userGroupElements) {
    long companyId=GetterUtil.getLong(userGroupElement.attributeValue("company-id"));
    String uuid=userGroupElement.attributeValue("uuid");
    UserGroup userGroup=UserGroupLocalServiceUtil.fetchUserGroupByUuidAndCompanyId(uuid,companyId);
    if ((userGroup != null) && !UserGroupLocalServiceUtil.hasTeamUserGroup(importedTeam.getTeamId(),userGroup.getUserGroupId())) {
      UserGroupLocalServiceUtil.addTeamUserGroup(importedTeam.getTeamId(),userGroup);
    }
  }
  portletDataContext.importClassedModel(team,importedTeam);
}
