{
  try {
    String xslContent=JS.decodeURIComponent(ParamUtil.getString(request,"xslContent"));
    boolean formatXsl=ParamUtil.getBoolean(request,"formatXsl");
    String langType=ParamUtil.getString(request,"langType",JournalTemplateConstants.LANG_TYPE_XSL);
    if (formatXsl) {
      if (langType.equals(JournalTemplateConstants.LANG_TYPE_VM)) {
        xslContent=JournalUtil.formatVM(xslContent);
      }
 else {
        xslContent=XMLFormatter.formatXML(xslContent);
      }
    }
    String fileName="template." + langType;
    byte[] bytes=xslContent.getBytes();
    ServletResponseUtil.sendFile(request,response,fileName,bytes,ContentTypes.TEXT_XML_UTF8);
    return null;
  }
 catch (  Exception e) {
    PortalUtil.sendError(e,request,response);
    return null;
  }
}
