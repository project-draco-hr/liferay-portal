{
  long groupId=searchContext.getGroupId();
  if (groupId <= 0) {
    return;
  }
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  long parentGroupId=groupId;
  if (group.isLayout() || searchContext.isScopeStrict()) {
    contextQuery.addRequiredTerm(Field.SCOPE_GROUP_ID,groupId);
  }
  if (group.isLayout()) {
    parentGroupId=group.getParentGroupId();
  }
  contextQuery.addRequiredTerm(Field.GROUP_ID,parentGroupId);
  searchContext.setGroupId(parentGroupId);
}
