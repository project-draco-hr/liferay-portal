{
  AsyncBroker<Path,FileResponse> asyncBroker=new AsyncBroker<Path,FileResponse>();
  _channelPipeline.addLast(new FileResponseChannelHandler(asyncBroker,_embeddedChannel.eventLoop()));
  NettyRepository repository=new NettyRepository(_repositoryPath,asyncBroker,0);
  NoticeableFuture<Path> noticeableFuture=repository.getFile(_embeddedChannel,Paths.get("remoteFile"),Paths.get("localFile"),false,false);
  Assert.assertTrue(noticeableFuture.isDone());
  Assert.assertTrue(noticeableFuture.isCancelled());
}
