{
  Element permissionsEl=portletEl.element("permissions");
  Element rolesEl=portletEl.element("roles");
  if (permissionsEl != null) {
    String resourceName=PortletConstants.getRootPortletId(portletId);
    String resourcePrimKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),portletId);
    if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 5) {
      importPermissions_5(companyId,groupId,userId,resourceName,resourcePrimKey,permissionsEl,true);
    }
 else     if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
      importPermissions_6(companyId,groupId,userId,resourceName,resourcePrimKey,permissionsEl,true);
    }
 else {
      Group guestGroup=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.GUEST);
      importPortletPermissions_4(companyId,groupId,guestGroup,layout,permissionsEl,importUserPermissions);
    }
  }
  if ((PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM < 5) && (rolesEl != null)) {
    importPortletRoles(companyId,groupId,portletEl);
    importPortletRoles(companyId,groupId,portletId,rolesEl);
  }
}
