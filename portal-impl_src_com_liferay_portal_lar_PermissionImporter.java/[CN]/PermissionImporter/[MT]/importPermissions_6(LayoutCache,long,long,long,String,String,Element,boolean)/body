{
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  List<Element> roleElements=permissionsElement.elements("role");
  for (  Element roleElement : roleElements) {
    String name=roleElement.attributeValue("name");
    int type=GetterUtil.getInteger(roleElement.attributeValue("type"));
    Role role=null;
    if (name.startsWith(PermissionExporter.ROLE_TEAM_PREFIX)) {
      name=name.substring(PermissionExporter.ROLE_TEAM_PREFIX.length());
      String description=roleElement.attributeValue("description");
      Team team=null;
      try {
        team=TeamLocalServiceUtil.getTeam(groupId,name);
      }
 catch (      NoSuchTeamException nste) {
        team=TeamLocalServiceUtil.addTeam(userId,groupId,name,description);
      }
      role=RoleLocalServiceUtil.getTeamRole(companyId,team.getTeamId());
    }
 else {
      role=layoutCache.getRole(companyId,name);
    }
    if ((type == RoleConstants.TYPE_COMMUNITY) && group.isOrganization()) {
      type=RoleConstants.TYPE_ORGANIZATION;
      if ((role != null) && (role.getType() != RoleConstants.TYPE_ORGANIZATION)) {
        role=null;
        if (name.equals(RoleConstants.COMMUNITY_ADMINISTRATOR)) {
          name=RoleConstants.ORGANIZATION_ADMINISTRATOR;
        }
 else         if (name.equals(RoleConstants.COMMUNITY_MEMBER)) {
          name=RoleConstants.ORGANIZATION_MEMBER;
        }
 else         if (name.equals(RoleConstants.COMMUNITY_OWNER)) {
          name=RoleConstants.ORGANIZATION_OWNER;
        }
 else {
          if (name.contains("Community")) {
            name=StringUtil.replace(name,"Community","Organization");
          }
 else {
            name="Organization ".concat(name);
          }
        }
        try {
          role=RoleLocalServiceUtil.getRole(companyId,name);
        }
 catch (        Exception e) {
        }
      }
    }
 else     if ((type == RoleConstants.TYPE_ORGANIZATION) && group.isCommunity()) {
      type=RoleConstants.TYPE_COMMUNITY;
      if ((role != null) && (role.getType() != RoleConstants.TYPE_COMMUNITY)) {
        role=null;
        if (name.equals(RoleConstants.ORGANIZATION_ADMINISTRATOR)) {
          name=RoleConstants.COMMUNITY_ADMINISTRATOR;
        }
 else         if (name.equals(RoleConstants.ORGANIZATION_MEMBER)) {
          name=RoleConstants.COMMUNITY_MEMBER;
        }
 else         if (name.equals(RoleConstants.ORGANIZATION_OWNER)) {
          name=RoleConstants.COMMUNITY_OWNER;
        }
 else {
          if (name.contains("Organization")) {
            name=StringUtil.replace(name,"Organization","Community");
          }
 else {
            name="Community ".concat(name);
          }
        }
        try {
          role=RoleLocalServiceUtil.getRole(companyId,name);
        }
 catch (        Exception e) {
        }
      }
    }
    if (role == null) {
      String description=roleElement.attributeValue("description");
      role=RoleLocalServiceUtil.addRole(userId,companyId,name,null,description,type);
    }
    List<String> actions=getActions(roleElement);
    ResourcePermissionLocalServiceUtil.setResourcePermissions(companyId,resourceName,ResourceConstants.SCOPE_INDIVIDUAL,resourcePrimKey,role.getRoleId(),actions.toArray(new String[actions.size()]));
  }
}
