{
  Element permissionsEl=portletEl.element("permissions");
  if (permissionsEl != null) {
    String resourceName=PortletConstants.getRootPortletId(portletId);
    String resourcePrimKey=PortletPermissionUtil.getPrimaryKey(layout.getPlid(),portletId);
    if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 5) {
      importPermissions_5(layoutCache,companyId,groupId,userId,resourceName,resourcePrimKey,permissionsEl,true);
    }
 else     if (PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM == 6) {
      importPermissions_6(layoutCache,companyId,groupId,userId,resourceName,resourcePrimKey,permissionsEl,true);
    }
 else {
      Group guestGroup=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.GUEST);
      importPortletPermissions_1to4(layoutCache,companyId,groupId,guestGroup,layout,permissionsEl,importUserPermissions);
    }
  }
  Element rolesEl=portletEl.element("roles");
  if ((PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM < 5) && (rolesEl != null)) {
    importPortletRoles(layoutCache,companyId,groupId,portletEl);
    importPortletRoles(layoutCache,companyId,groupId,portletId,rolesEl);
  }
}
