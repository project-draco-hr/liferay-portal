{
  String layoutTemplateId=getParameter(actionRequest,"layoutTemplateId");
  String portletResource=ParamUtil.getString(actionRequest,"portletResource");
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
  NestedPortletsPortletInstanceConfiguration nestedPortletsPortletInstanceConfiguration=portletDisplay.getPortletInstanceConfiguration(NestedPortletsPortletInstanceConfiguration.class);
  String oldLayoutTemplateId=nestedPortletsPortletInstanceConfiguration.layoutTemplateId();
  if (Validator.isNull(oldLayoutTemplateId)) {
    oldLayoutTemplateId=_nestedPortletsConfiguration.layoutTemplateDefault();
  }
  if (!oldLayoutTemplateId.equals(layoutTemplateId)) {
    reorganizeNestedColumns(actionRequest,portletResource,layoutTemplateId,oldLayoutTemplateId);
  }
  super.processAction(portletConfig,actionRequest,actionResponse);
}
