{
  IFrameDisplayContext iFrameDisplayContext=new IFrameDisplayContext(renderRequest);
  IFramePortletInstanceConfiguration iFramePortletInstanceConfiguration=iFrameDisplayContext.getIFramePortletInstanceConfiguration();
  String src=ParamUtil.getString(renderRequest,"src",iFramePortletInstanceConfiguration.src());
  if (!iFramePortletInstanceConfiguration.auth()) {
    return src;
  }
  String authType=iFrameDisplayContext.getAuthType();
  if (authType.equals("basic")) {
    String userName=IFrameUtil.getUserName(renderRequest,iFramePortletInstanceConfiguration.basicUserName());
    String password=IFrameUtil.getPassword(renderRequest,iFramePortletInstanceConfiguration.basicPassword());
    int pos=src.indexOf("://");
    String protocol=src.substring(0,pos + 3);
    String url=src.substring(pos + 3);
    src=protocol + userName + ":"+ password+ "@"+ url;
  }
 else {
    PortletURL proxyURL=renderResponse.createRenderURL();
    proxyURL.setParameter("mvcPath","/proxy.jsp");
    src=proxyURL.toString();
  }
  return src;
}
