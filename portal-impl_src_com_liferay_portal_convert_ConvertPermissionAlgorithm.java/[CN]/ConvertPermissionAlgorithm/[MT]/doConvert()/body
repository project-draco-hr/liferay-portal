{
  try {
    BatchSessionUtil.setEnabled(true);
    _initialize();
    _convertPermissions(RoleConstants.TYPE_REGULAR,"Users_Permissions",new String[]{"userId"},"Users_Roles",new Object[][]{{"userId",Types.BIGINT},{"roleId",Types.BIGINT}});
    _convertPermissions(RoleConstants.TYPE_COMMUNITY,"Groups_Permissions",new String[]{"groupId"},"Groups_Roles",new Object[][]{{"groupId",Types.BIGINT},{"roleId",Types.BIGINT}});
    _convertPermissions(RoleConstants.TYPE_ORGANIZATION,"OrgGroupPermission",new String[]{"organizationId","groupId"},"OrgGroupRole",new Object[][]{{"organizationId",Types.BIGINT},{"groupId",Types.BIGINT},{"roleId",Types.BIGINT}});
    PermissionCacheUtil.clearCache();
    _log.info("Please set " + PropsKeys.PERMISSIONS_USER_CHECK_ALGORITHM + " in your portal-ext.properties to use algorithm 5");
    PropsValues.PERMISSIONS_USER_CHECK_ALGORITHM=5;
  }
 catch (  Exception e) {
    _log.fatal(e);
  }
 finally {
    CacheRegistry.clear();
    BatchSessionUtil.setEnabled(false);
  }
}
