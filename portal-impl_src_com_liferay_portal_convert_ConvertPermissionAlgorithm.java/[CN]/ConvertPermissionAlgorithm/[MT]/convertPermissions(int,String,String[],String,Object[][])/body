{
  MaintenanceUtil.appendStatus("Processing " + legacyName);
  Table legacyTable=new PermissionView(legacyName,primKeys);
  String legacyFile=legacyTable.generateTempFile();
  if (legacyFile == null) {
    return;
  }
  if (type == RoleConstants.TYPE_REGULAR) {
    legacyFile=convertGuestUsers(legacyFile);
    MaintenanceUtil.appendStatus("Converted guest users to guest roles");
  }
  convertRoles(legacyFile,type,newName,newColumns);
  MaintenanceUtil.appendStatus("Converted roles for " + legacyName);
  DB db=DBFactoryUtil.getDB();
  db.runSQL(legacyTable.getDeleteSQL());
  FileUtil.delete(legacyFile);
}
