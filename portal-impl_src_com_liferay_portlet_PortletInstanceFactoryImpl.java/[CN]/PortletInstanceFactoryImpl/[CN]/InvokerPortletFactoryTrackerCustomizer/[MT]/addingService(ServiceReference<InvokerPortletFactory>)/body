{
  Registry registry=RegistryUtil.getRegistry();
  InvokerPortletFactory invokerPortletFactory=registry.getService(serviceReference);
  long serviceRanking=GetterUtil.getLong(serviceReference.getProperty("service.ranking"));
  if ((_invokerPortletFactory == null) || (serviceRanking > _serviceRanking)) {
    _invokerPortletFactory=invokerPortletFactory;
    _serviceRanking=serviceRanking;
  }
  return invokerPortletFactory;
}
