{
  StreamSource xmlSource=new StreamSource(new UnsyncStringReader(getXML()));
  XSLContext xslContext=(XSLContext)templateContext;
  Transformer transformer=xslContext.getTransformer();
  try {
    transformer.transform(xmlSource,new StreamResult(unsyncStringWriter));
  }
 catch (  Exception e) {
    String errorTemplateContent=getErrorTemplateContent();
    XSLContext errorXSLContext=(XSLContext)_getTemplateContext(errorTemplateContent);
    populateTemplateContext(errorXSLContext);
    Transformer errorTransformer=errorXSLContext.getTransformer();
    XSLErrorListener xslErrorListener=_getXSLErrorListener();
    errorTransformer.setParameter("exception",xslErrorListener.getMessageAndLocation());
    errorTransformer.setParameter("script",getScript());
    if (xslErrorListener.getLocation() != null) {
      errorTransformer.setParameter("column",new Integer(xslErrorListener.getColumnNumber()));
      errorTransformer.setParameter("line",new Integer(xslErrorListener.getLineNumber()));
    }
    unsyncStringWriter.reset();
    errorTransformer.transform(xmlSource,new StreamResult(unsyncStringWriter));
  }
  return true;
}
