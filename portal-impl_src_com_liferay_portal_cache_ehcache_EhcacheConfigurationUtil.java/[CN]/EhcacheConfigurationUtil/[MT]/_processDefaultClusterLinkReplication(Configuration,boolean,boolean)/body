{
  boolean clearCachePeerProviderConfigurations=((usingDefault && enableClusterLinkReplication) || (usingDefault && !PropsValues.CLUSTER_LINK_ENABLED));
  if (clearCachePeerProviderConfigurations) {
    configuration.getCacheManagerPeerProviderFactoryConfiguration().clear();
    configuration.getCacheManagerPeerListenerFactoryConfigurations().clear();
  }
  CacheConfiguration defaultCacheConfiguration=configuration.getDefaultCacheConfiguration();
  _configureCacheEventListeners(enableClusterLinkReplication,clearCachePeerProviderConfigurations,usingDefault,defaultCacheConfiguration);
  for (  CacheConfiguration cacheConfiguration : configuration.getCacheConfigurations().values()) {
    _configureCacheEventListeners(enableClusterLinkReplication,clearCachePeerProviderConfigurations,usingDefault,cacheConfiguration);
  }
  return configuration;
}
