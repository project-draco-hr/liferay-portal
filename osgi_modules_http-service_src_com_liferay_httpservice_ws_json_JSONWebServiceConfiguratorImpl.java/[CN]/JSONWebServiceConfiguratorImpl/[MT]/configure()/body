{
  ServletContext servletContext=getServletContext();
  Bundle bundle=(Bundle)servletContext.getAttribute(WebKeys.OSGI_BUNDLE);
  String path=StringPool.SLASH;
  URL url=bundle.getEntry("WEB-INF/service.xml");
  if (url != null) {
    try {
      Document document=SAXReaderUtil.read(url.openStream());
      Element rootElement=document.getRootElement();
      String packagePath=rootElement.attributeValue("package-path");
      if (Validator.isNotNull(packagePath)) {
        path+=StringUtil.replace(packagePath,StringPool.PERIOD,StringPool.SLASH);
      }
    }
 catch (    Exception e) {
      _log.error(e,e);
    }
  }
  BundleWiring bundleWiring=bundle.adapt(BundleWiring.class);
  Collection<String> classPaths=bundleWiring.listResources(path,"*.class",BundleWiring.LISTRESOURCES_RECURSE);
  registerClasses(classPaths);
}
