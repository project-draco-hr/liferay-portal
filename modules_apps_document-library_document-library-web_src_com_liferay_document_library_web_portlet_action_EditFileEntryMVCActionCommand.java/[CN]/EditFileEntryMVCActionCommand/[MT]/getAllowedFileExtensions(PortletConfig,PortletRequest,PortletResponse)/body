{
  String portletName=portletConfig.getPortletName();
  if (!portletName.equals(DLPortletKeys.MEDIA_GALLERY_DISPLAY)) {
    return PrefsPropsUtil.getStringArray(PropsKeys.DL_FILE_EXTENSIONS,StringPool.COMMA);
  }
 else {
    ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
    PortletDisplay portletDisplay=themeDisplay.getPortletDisplay();
    DLPortletInstanceSettings dlPortletInstanceSettings=DLPortletInstanceSettings.getInstance(themeDisplay.getLayout(),portletDisplay.getId());
    Set<String> extensions=new HashSet<>();
    String[] mimeTypes=dlPortletInstanceSettings.getMimeTypes();
    for (    String mimeType : mimeTypes) {
      extensions.addAll(MimeTypesUtil.getExtensions(mimeType));
    }
    return extensions.toArray(new String[extensions.size()]);
  }
}
