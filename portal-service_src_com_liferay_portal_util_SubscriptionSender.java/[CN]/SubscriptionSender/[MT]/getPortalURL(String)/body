{
  String portalURL=PortalUtil.getPortalURL(virtualHostname,Http.HTTP_PORT,false);
  if ((serviceContext != null) && Validator.isNotNull(serviceContext.getPortalURL())) {
    return serviceContext.getPortalURL();
  }
  if (groupId <= 0) {
    return portalURL;
  }
  Group group=GroupLocalServiceUtil.getGroup(groupId);
  if (group.hasPublicLayouts()) {
    LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(groupId,false);
    if (Validator.isNotNull(layoutSet.getVirtualHostname())) {
      portalURL=PortalUtil.getPortalURL(layoutSet.getVirtualHostname(),Http.HTTP_PORT,false);
    }
  }
 else   if (group.hasPrivateLayouts()) {
    LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(groupId,true);
    if (Validator.isNotNull(layoutSet.getVirtualHostname())) {
      portalURL=PortalUtil.getPortalURL(layoutSet.getVirtualHostname(),Http.HTTP_PORT,false);
    }
  }
  return portalURL;
}
