{
  Files.walkFileTree(Paths.get(System.getProperty("osgi.state.dir")),Collections.<FileVisitOption>emptySet(),1,new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult visitFile(    Path path,    BasicFileAttributes basicFileAttributes) throws IOException {
      String pathString=StringUtil.toLowerCase(path.toString());
      if (pathString.endsWith(".log")) {
        StringBundler sb=new StringBundler();
        sb.append("\nPortal log assert failure, OSGi log found: ");
        sb.append(path);
        sb.append(StringPool.COLON);
        sb.append(StringPool.NEW_LINE);
        List<String> lines=Files.readAllLines(path,Charset.defaultCharset());
        for (        String line : lines) {
          sb.append(line);
          sb.append(StringPool.NEW_LINE);
        }
        Assert.fail(sb.toString());
      }
      return FileVisitResult.CONTINUE;
    }
  }
);
}
