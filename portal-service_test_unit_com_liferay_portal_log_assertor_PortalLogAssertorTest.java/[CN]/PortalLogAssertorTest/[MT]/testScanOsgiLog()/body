{
  StringBundler sb=new StringBundler();
  try (DirectoryStream<Path> directoryStream=Files.newDirectoryStream(Paths.get(System.getProperty("osgi.state.dir")),"*.log")){
    for (    Path path : directoryStream) {
      if (!Files.isRegularFile(path)) {
        continue;
      }
      sb.append("\nPortal log assert failure, OSGi log found: ");
      sb.append(path);
      sb.append(StringPool.COLON);
      sb.append(StringPool.NEW_LINE);
      sb.append(new String(Files.readAllBytes(path),Charset.defaultCharset()));
      sb.append(StringPool.NEW_LINE);
    }
  }
   if (sb.index() != 0) {
    Assert.fail(sb.toString());
  }
}
