{
  try (DirectoryStream<Path> directoryStream=Files.newDirectoryStream(Paths.get(System.getProperty("osgi.state.dir")),"*.log")){
    for (    Path path : directoryStream) {
      if (!Files.isRegularFile(path)) {
        continue;
      }
      StringBundler sb=new StringBundler();
      sb.append("\nPortal log assert failure, OSGi log found: ");
      sb.append(path);
      sb.append(StringPool.COLON);
      sb.append(StringPool.NEW_LINE);
      List<String> lines=Files.readAllLines(path,Charset.defaultCharset());
      for (      String line : lines) {
        sb.append(line);
        sb.append(StringPool.NEW_LINE);
      }
      Assert.fail(sb.toString());
    }
  }
 }
