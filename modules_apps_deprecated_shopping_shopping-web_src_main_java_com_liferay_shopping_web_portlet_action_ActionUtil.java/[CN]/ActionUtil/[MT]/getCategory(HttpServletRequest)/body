{
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  long categoryId=ParamUtil.getLong(request,"categoryId");
  ShoppingCategory category=null;
  if ((categoryId > 0) && (categoryId != ShoppingCategoryConstants.DEFAULT_PARENT_CATEGORY_ID)) {
    category=ShoppingCategoryServiceUtil.getCategory(categoryId);
  }
 else {
    ShoppingPermission.check(themeDisplay.getPermissionChecker(),themeDisplay.getScopeGroupId(),ActionKeys.VIEW);
  }
  request.setAttribute(WebKeys.SHOPPING_CATEGORY,category);
}
