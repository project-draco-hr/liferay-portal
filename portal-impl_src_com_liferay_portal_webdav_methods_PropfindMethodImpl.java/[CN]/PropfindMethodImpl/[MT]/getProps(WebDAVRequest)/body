{
  try {
    Set<Tuple> props=new HashSet<Tuple>();
    HttpServletRequest req=webDavReq.getHttpServletRequest();
    String xml=new String(FileUtil.getBytes(req.getInputStream()));
    if (Validator.isNull(xml)) {
      props.add(new Tuple("displayname",WebDAVUtil.DAV_URI));
      props.add(new Tuple("resourcetype",WebDAVUtil.DAV_URI));
      props.add(new Tuple("getcontenttype",WebDAVUtil.DAV_URI));
      props.add(new Tuple("getcontentlength",WebDAVUtil.DAV_URI));
      props.add(new Tuple("getlastmodified",WebDAVUtil.DAV_URI));
      props.add(new Tuple("lockdiscovery",WebDAVUtil.DAV_URI));
      props.add(new Tuple("checked-in",WebDAVUtil.DAV_URI));
      props.add(new Tuple("checked-out",WebDAVUtil.DAV_URI));
      props.add(new Tuple("version-name",WebDAVUtil.DAV_URI));
      return props;
    }
    if (_log.isDebugEnabled()) {
      _log.debug("Request XML: \n" + XMLFormatter.toString(xml,StringPool.FOUR_SPACES));
    }
    SAXReader reader=new SAXReader();
    Document doc=reader.read(new StringReader(xml));
    Element root=doc.getRootElement();
    Element prop=root.element("prop");
    Iterator<Element> itr=prop.elements().iterator();
    while (itr.hasNext()) {
      Element el=itr.next();
      String prefix=el.getNamespacePrefix();
      String uri=el.getNamespaceURI();
      Namespace namespace=null;
      if (uri.equals(WebDAVUtil.DAV_URI.getURI())) {
        namespace=WebDAVUtil.DAV_URI;
      }
 else       if (Validator.isNull(prefix)) {
        namespace=Namespace.get(uri);
      }
 else {
        namespace=Namespace.get(prefix,uri);
      }
      props.add(new Tuple(el.getName(),namespace));
    }
    return props;
  }
 catch (  Exception e) {
    throw new InvalidRequestException(e);
  }
}
