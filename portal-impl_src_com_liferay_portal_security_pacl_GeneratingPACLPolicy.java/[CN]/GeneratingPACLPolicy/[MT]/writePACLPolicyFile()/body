{
  boolean enabled=PortalSecurityManagerThreadLocal.isEnabled();
  try {
    PortalSecurityManagerThreadLocal.setEnabled(false);
    StringBundler sb=new StringBundler();
    for (    Map.Entry<String,Set<String>> entry : _properties.entrySet()) {
      String key=entry.getKey();
      sb.append(key);
      sb.append(StringPool.EQUAL);
      Set<String> values=entry.getValue();
      for (      String value : values) {
        sb.append(StringPool.BACK_SLASH);
        sb.append(StringPool.NEW_LINE);
        sb.append(StringPool.FOUR_SPACES);
        sb.append(value);
        sb.append(StringPool.COMMA);
      }
      sb.setIndex(sb.index() - 1);
      sb.append(StringPool.NEW_LINE + StringPool.NEW_LINE);
    }
    if (sb.length() > 0) {
      sb.setIndex(sb.index() - 1);
    }
    FileUtil.write(PropsValues.LIFERAY_HOME + "/pacl-policy",getServletContextName() + ".pacl-policy",sb.toString());
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
  }
 finally {
    PortalSecurityManagerThreadLocal.setEnabled(enabled);
  }
}
