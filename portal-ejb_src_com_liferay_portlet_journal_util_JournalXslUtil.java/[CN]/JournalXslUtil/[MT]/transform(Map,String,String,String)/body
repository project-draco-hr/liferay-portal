{
  ByteArrayOutputStream outputBaos=new ByteArrayOutputStream();
  try {
    StreamSource xmlSource=new StreamSource(new StringReader(xml));
    StreamSource scriptSource=new StreamSource(new StringReader(script));
    TransformerFactory transformerFactory=TransformerFactory.newInstance();
    transformerFactory.setURIResolver(new URIResolver(tokens,languageId));
    Transformer transformer=transformerFactory.newTransformer(scriptSource);
    transformer.transform(xmlSource,new StreamResult(outputBaos));
  }
 catch (  TransformerException te) {
    throw new TransformException(te.getMessage());
  }
  return outputBaos.toString();
}
