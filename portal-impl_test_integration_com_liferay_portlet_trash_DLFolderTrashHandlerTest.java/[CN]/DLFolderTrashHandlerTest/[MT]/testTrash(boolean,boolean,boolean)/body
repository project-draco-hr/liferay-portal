{
  int initialFoldersAndFileEntriesCount=getFolderAndFileEntriesNotInTrashCount();
  int initialTrashEntriesCount=getTrashEntriesCount();
  int initialSearchFileEntriesCount=searchFileEntriesCount();
  Folder folder=addFolder(parentFolder.getFolderId(),"Test Folder");
  Folder subfolder=addFolder(folder.getFolderId(),"Test Subfolder");
  long fileEntryId=0;
  if (file) {
    FileEntry fileEntry=addFileEntry(subfolder.getFolderId(),"Test File.txt");
    fileEntryId=fileEntry.getFileEntryId();
    Assert.assertEquals(initialSearchFileEntriesCount + 1,searchFileEntriesCount());
    Assert.assertTrue(isAssetEntryVisible(fileEntryId));
    if (trashFile) {
      DLAppServiceUtil.moveFileEntryToTrash(fileEntryId);
    }
  }
  Assert.assertEquals(initialFoldersAndFileEntriesCount + 1,getFolderAndFileEntriesNotInTrashCount());
  if (trashFile) {
    Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount());
  }
 else {
    Assert.assertEquals(initialTrashEntriesCount,getTrashEntriesCount());
  }
  DLAppServiceUtil.moveFolderToTrash(folder.getFolderId());
  Assert.assertEquals(initialFoldersAndFileEntriesCount,getFolderAndFileEntriesNotInTrashCount());
  if (trashFile) {
    Assert.assertEquals(initialTrashEntriesCount + 2,getTrashEntriesCount());
  }
 else {
    Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount());
  }
  Assert.assertEquals(initialSearchFileEntriesCount,searchFileEntriesCount());
  if (file) {
    Assert.assertFalse(isAssetEntryVisible(fileEntryId));
  }
  if (delete) {
    TrashEntryServiceUtil.deleteEntries(folder.getGroupId());
    Assert.assertEquals(initialFoldersAndFileEntriesCount,getFolderAndFileEntriesNotInTrashCount());
    Assert.assertEquals(initialSearchFileEntriesCount,searchFileEntriesCount());
    if (file) {
      Assert.assertNull(fetchAssetEntry(fileEntryId));
    }
  }
 else {
    DLAppServiceUtil.restoreFolderFromTrash(folder.getFolderId());
    Assert.assertEquals(initialFoldersAndFileEntriesCount + 1,getFolderAndFileEntriesNotInTrashCount());
    if (file) {
      if (trashFile) {
        Assert.assertEquals(initialTrashEntriesCount + 1,getTrashEntriesCount());
        Assert.assertEquals(initialSearchFileEntriesCount,searchFileEntriesCount());
        Assert.assertFalse(isAssetEntryVisible(fileEntryId));
        return;
      }
 else {
        Assert.assertEquals(initialSearchFileEntriesCount + 1,searchFileEntriesCount());
        Assert.assertTrue(isAssetEntryVisible(fileEntryId));
      }
    }
  }
  Assert.assertEquals(initialTrashEntriesCount,getTrashEntriesCount());
}
