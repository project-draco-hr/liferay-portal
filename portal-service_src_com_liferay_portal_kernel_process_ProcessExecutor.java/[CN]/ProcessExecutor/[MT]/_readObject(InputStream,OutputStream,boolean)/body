{
  if (outputStream != null) {
    inputStream=new UnsyncBufferedInputStream(inputStream);
    inputStream.mark(4);
  }
  try {
    ObjectInputStream objectInputStream=new ObjectInputStream(inputStream);
    try {
      return objectInputStream.readObject();
    }
  finally {
      if (close) {
        objectInputStream.close();
      }
    }
  }
 catch (  ObjectStreamException ose) {
    if (outputStream != null) {
      inputStream.reset();
      int b=-1;
      while ((b=inputStream.read()) != -1) {
        outputStream.write(b);
      }
      outputStream.flush();
      return null;
    }
 else {
      throw ose;
    }
  }
}
