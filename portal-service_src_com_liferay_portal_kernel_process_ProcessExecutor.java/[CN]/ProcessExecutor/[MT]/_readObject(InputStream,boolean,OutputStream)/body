{
  if (failDumpOutputStream != null) {
    inputStream=new UnsyncBufferedInputStream(inputStream);
    inputStream.mark(4);
  }
  try {
    ObjectInputStream objectInputStream=new ObjectInputStream(inputStream);
    try {
      return objectInputStream.readObject();
    }
  finally {
      if (close) {
        objectInputStream.close();
      }
    }
  }
 catch (  ObjectStreamException ose) {
    if (failDumpOutputStream != null) {
      inputStream.reset();
      int ch=-1;
      while ((ch=inputStream.read()) != -1) {
        failDumpOutputStream.write(ch);
      }
      failDumpOutputStream.flush();
      return null;
    }
 else {
      throw ose;
    }
  }
}
