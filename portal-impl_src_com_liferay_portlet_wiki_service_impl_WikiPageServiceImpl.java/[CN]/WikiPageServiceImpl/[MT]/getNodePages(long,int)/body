{
  List<WikiPage> pages=new ArrayList<WikiPage>();
  int lastIntervalStart=0;
  boolean listNotExhausted=true;
  while ((pages.size() < max) && listNotExhausted) {
    List<WikiPage> pageList=wikiPageLocalService.getPages(nodeId,true,lastIntervalStart,lastIntervalStart + max);
    Iterator<WikiPage> itr=pageList.iterator();
    lastIntervalStart+=max;
    listNotExhausted=(pageList.size() == max);
    while (itr.hasNext() && (pages.size() < max)) {
      WikiPage page=itr.next();
      if (WikiPagePermission.contains(getPermissionChecker(),page,ActionKeys.VIEW)) {
        pages.add(page);
      }
    }
  }
  return pages;
}
