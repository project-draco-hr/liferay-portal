{
  List<WikiPage> pages=new ArrayList<WikiPage>();
  int lastIntervalStart=0;
  boolean listNotExhausted=true;
  while ((pages.size() < max) && listNotExhausted) {
    List<WikiPage> pageList=wikiPageLocalService.getPages(nodeId,true,lastIntervalStart,lastIntervalStart + max);
    lastIntervalStart+=max;
    listNotExhausted=(pageList.size() == max);
    for (    WikiPage page : pageList) {
      if (pages.size() >= max) {
        break;
      }
      if (WikiPagePermission.contains(getPermissionChecker(),page,ActionKeys.VIEW)) {
        pages.add(page);
      }
    }
  }
  return pages;
}
