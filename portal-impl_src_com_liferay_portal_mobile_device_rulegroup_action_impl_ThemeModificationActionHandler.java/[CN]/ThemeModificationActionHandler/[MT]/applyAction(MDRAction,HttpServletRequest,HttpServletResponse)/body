{
  UnicodeProperties typeSettingsProperties=action.getTypeSettingsProperties();
  String themeId=GetterUtil.get(typeSettingsProperties.getProperty(THEME_ID),StringPool.BLANK);
  String colorSchemeId=GetterUtil.get(typeSettingsProperties.getProperty(COLOR_SCHEME_ID),StringPool.BLANK);
  long companyId=PortalUtil.getCompanyId(request);
  Theme theme=_themeLocalService.fetchTheme(companyId,themeId);
  if (theme == null) {
    return;
  }
  ColorScheme colorScheme=_themeLocalService.fetchColorScheme(companyId,themeId,colorSchemeId);
  if (colorScheme == null) {
    colorScheme=ColorSchemeImpl.getNullColorScheme();
  }
  request.setAttribute(WebKeys.THEME,theme);
  request.setAttribute(WebKeys.COLOR_SCHEME,colorScheme);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  String contextPath=PortalUtil.getPathContext();
  themeDisplay.setLookAndFeel(contextPath,theme,colorScheme);
}
