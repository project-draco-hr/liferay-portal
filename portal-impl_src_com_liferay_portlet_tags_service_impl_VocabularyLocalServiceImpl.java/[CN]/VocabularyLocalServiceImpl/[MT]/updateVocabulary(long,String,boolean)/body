{
  name=name.trim().toLowerCase();
  validate(name);
  Vocabulary vocabulary=vocabularyPersistence.findByPrimaryKey(vocabularyId);
  if (!vocabulary.getName().equals(name)) {
    if (hasVocabulary(vocabulary.getCompanyId(),name)) {
      throw new DuplicateVocabularyException();
    }
  }
  vocabulary.setFolksonomy(folksonomy);
  vocabulary.setModifiedDate(new Date());
  vocabulary.setName(name);
  vocabularyPersistence.update(vocabulary,false);
  return vocabulary;
}
