{
  OpenSearch instance=instances.get(className);
  if (instance != null) {
    return instance;
  }
  PortletBag portletBag=PortletBagPool.get(portletId);
  if (portletBag != null) {
    ClassLoader portletClassLoader=(ClassLoader)portletBag.getServletContext().getAttribute(PortletServlet.PORTLET_CLASS_LOADER);
    instance=new OpenSearchImplInvoker(className,portletId);
    instances.put(className,instance);
    return instance;
  }
  return (OpenSearch)InstancePool.get(className);
}
