{
  PortletPreferencesImpl prefs=PortletPreferencesSerializer.fromXML(companyId,ownerId,ownerType,plid,portletId,preferences);
  long rootPlid=GetterUtil.getLong(prefs.getValue("root-plid",StringPool.BLANK));
  if (rootPlid > 0) {
    try {
      Layout layout=LayoutLocalServiceUtil.getLayout(rootPlid);
      prefs.setValue("root-layout-id",String.valueOf(layout.getLayoutId()));
    }
 catch (    NoSuchLayoutException nsle) {
    }
  }
  prefs.setValue("root-plid",null);
  return PortletPreferencesSerializer.toXML(prefs);
}
