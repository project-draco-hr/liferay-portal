{
  if (plid != LayoutConstants.DEFAULT_PLID) {
    try {
      Layout layout=LayoutLocalServiceUtil.getLayout(plid);
      LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
      for (      String portletId : _portletIds) {
        if (layoutTypePortlet.hasPortletId(portletId)) {
          return new Object[]{plid,portletId};
        }
      }
    }
 catch (    NoSuchLayoutException nsle) {
    }
  }
  long groupId=0;
  if (primaryKey > 0) {
    try {
      groupId=getGroupId(primaryKey);
    }
 catch (    Exception e) {
      if (_log.isDebugEnabled()) {
        _log.debug(e,e);
      }
    }
  }
  if (groupId <= 0) {
    ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
    groupId=themeDisplay.getScopeGroupId();
  }
  for (  String portletId : _portletIds) {
    plid=PortalUtil.getPlidFromPortletId(groupId,portletId);
    if (plid != LayoutConstants.DEFAULT_PLID) {
      return new Object[]{plid,portletId};
    }
  }
  throw new NoSuchLayoutException();
}
