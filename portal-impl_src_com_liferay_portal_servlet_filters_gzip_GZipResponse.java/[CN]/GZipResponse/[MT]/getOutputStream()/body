{
  if (_printWriter != null) {
    throw new IllegalStateException();
  }
  if (_servletOutputStream == null) {
    if (_gZipContentType) {
      _servletOutputStream=_response.getOutputStream();
    }
 else {
      _response.addHeader(HttpHeaders.CONTENT_ENCODING,_GZIP);
      if (_firefox && RSSThreadLocal.isExportRSS()) {
        _unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream();
        _servletOutputStream=new GZipServletOutputStream(_unsyncByteArrayOutputStream);
      }
 else {
        _servletOutputStream=new GZipServletOutputStream(_response.getOutputStream());
      }
    }
  }
  return _servletOutputStream;
}
