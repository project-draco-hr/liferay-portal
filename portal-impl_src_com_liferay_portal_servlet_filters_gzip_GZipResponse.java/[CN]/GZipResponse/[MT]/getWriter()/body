{
  if (_writer != null) {
    return _writer;
  }
  if (_stream != null) {
    throw new IllegalStateException();
  }
  if (_log.isWarnEnabled()) {
    _log.warn("GZipFilter should work at byte level, it should not use " + "Writer to do output. GZipResponse can tolerate this, but it " + "will sacrifice performance.");
  }
  _stream=new GZipServletOutputStream(_response.getOutputStream());
  _writer=new UnsyncPrintWriter(new OutputStreamWriter(_stream,StringPool.UTF8));
  return _writer;
}
