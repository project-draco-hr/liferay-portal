{
  ScriptingResultContainer scriptingResultContainer=new ScriptingResultContainer();
  try {
    Object payload=message.getPayload();
    if (payload == null) {
      throw new ScriptingException("Payload is null");
    }
 else     if (!ScriptingRequest.class.isAssignableFrom(payload.getClass())) {
      throw new ScriptingException("Payload " + payload.getClass() + " is not of type "+ ScriptingRequest.class.getName());
    }
 else {
      ScriptingRequest scriptingRequest=(ScriptingRequest)payload;
      Object result=scriptingRequest.execute(_scripting);
      scriptingResultContainer.setResult(result);
    }
  }
 catch (  ScriptingException se) {
    _log.error(se,se);
    scriptingResultContainer.setScriptingException(se);
  }
 finally {
    String responseDestination=message.getResponseDestinationName();
    if (Validator.isNotNull(responseDestination)) {
      Message responseMessage=MessageBusUtil.createResponseMessage(message);
      responseMessage.setPayload(scriptingResultContainer);
      MessageBusUtil.sendMessage(responseDestination,responseMessage);
    }
  }
}
