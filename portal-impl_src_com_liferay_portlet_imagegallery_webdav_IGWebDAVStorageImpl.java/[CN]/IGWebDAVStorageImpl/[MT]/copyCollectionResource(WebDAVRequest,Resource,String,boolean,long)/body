{
  try {
    IGFolder srcFolder=(IGFolder)resource.getModel();
    String[] destinationArray=WebDAVUtil.getPathArray(destination,true);
    long parentFolderId;
    try {
      parentFolderId=getParentFolderId(destinationArray);
    }
 catch (    NoSuchFolderException nsfe) {
      return HttpServletResponse.SC_CONFLICT;
    }
    long groupId=WebDAVUtil.getGroupId(destination);
    long plid=getPlid(groupId);
    String name=WebDAVUtil.getResourceName(destinationArray);
    String description=srcFolder.getDescription();
    boolean addCommunityPermissions=true;
    boolean addGuestPermissions=true;
    int status=HttpServletResponse.SC_CREATED;
    if (overwrite) {
      if (deleteResource(groupId,parentFolderId,name)) {
        status=HttpServletResponse.SC_NO_CONTENT;
      }
    }
    if (depth == 0) {
      IGFolderServiceUtil.addFolder(plid,parentFolderId,name,description,addCommunityPermissions,addGuestPermissions);
    }
 else {
      IGFolderServiceUtil.copyFolder(plid,srcFolder.getFolderId(),parentFolderId,name,description,addCommunityPermissions,addGuestPermissions);
    }
    return status;
  }
 catch (  DuplicateFolderNameException dfne) {
    return HttpServletResponse.SC_PRECONDITION_FAILED;
  }
catch (  PrincipalException pe) {
    return HttpServletResponse.SC_FORBIDDEN;
  }
catch (  Exception e) {
    throw new WebDAVException(e);
  }
}
