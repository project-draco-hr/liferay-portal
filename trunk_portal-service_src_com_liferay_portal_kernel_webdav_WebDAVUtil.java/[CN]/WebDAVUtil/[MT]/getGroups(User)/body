{
  if (user.isDefaultUser()) {
    List<Group> groups=new ArrayList<Group>();
    Group group=GroupLocalServiceUtil.getGroup(user.getCompanyId(),GroupConstants.GUEST);
    groups.add(group);
    return groups;
  }
  LinkedHashMap<String,Object> params=new LinkedHashMap<String,Object>();
  params.put("usersGroups",user.getUserId());
  OrderByComparator orderByComparator=new GroupFriendlyURLComparator(true);
  List<Group> groups=GroupLocalServiceUtil.search(user.getCompanyId(),null,null,params,QueryUtil.ALL_POS,QueryUtil.ALL_POS,orderByComparator);
  groups.addAll(GroupLocalServiceUtil.getUserOrganizationsGroups(user.getUserId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS));
  if (!user.isDefaultUser()) {
    groups.add(user.getGroup());
  }
  Collections.sort(groups,orderByComparator);
  return groups;
}
