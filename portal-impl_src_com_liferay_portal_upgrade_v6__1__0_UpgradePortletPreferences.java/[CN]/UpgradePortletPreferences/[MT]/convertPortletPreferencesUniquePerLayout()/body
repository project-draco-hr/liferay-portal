{
  StringBundler sb=new StringBundler(8);
  sb.append("select portletPreferencesId, plid, portletId, preferences ");
  sb.append("from PortletPreferences where ownerId = ");
  sb.append(PortletKeys.PREFS_OWNER_ID_DEFAULT);
  sb.append(" and ownerType = ");
  sb.append(PortletKeys.PREFS_OWNER_TYPE_LAYOUT);
  sb.append(" and portletId in (");
  sb.append(_CONVERT_UNIQUE_PER_LAYOUT_PORTLET_IDS);
  sb.append(")");
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getConnection();
    ps=con.prepareStatement(sb.toString());
    rs=ps.executeQuery();
    while (rs.next()) {
      long plid=rs.getLong("plid");
      String portletId=rs.getString("portletId");
      String preferences=rs.getString("preferences");
      long ownerId=getOwnerId(plid);
      if (ownerId != 0) {
        convertPortletPreferences(ownerId,PortletKeys.PREFS_OWNER_TYPE_GROUP,PortletKeys.PREFS_PLID_SHARED,portletId,preferences);
      }
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
