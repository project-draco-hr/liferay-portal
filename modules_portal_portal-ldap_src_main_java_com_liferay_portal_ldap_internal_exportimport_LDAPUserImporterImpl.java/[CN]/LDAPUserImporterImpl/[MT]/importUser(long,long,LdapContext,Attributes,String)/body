{
  Properties userMappings=_ldapSettings.getUserMappings(ldapServerId,companyId);
  Properties userExpandoMappings=_ldapSettings.getUserExpandoMappings(ldapServerId,companyId);
  Properties contactMappings=_ldapSettings.getContactMappings(ldapServerId,companyId);
  Properties contactExpandoMappings=_ldapSettings.getContactExpandoMappings(ldapServerId,companyId);
  LDAPImportConfiguration ldapImportConfiguration=_ldapImportConfigurationProvider.getConfiguration(companyId);
  LDAPServerConfiguration ldapServerConfiguration=_ldapServerConfigurationProvider.getConfiguration(companyId,ldapServerId);
  String[] userIgnoreAttributes=ldapServerConfiguration.userIgnoreAttributes();
  Set<String> ldapUserIgnoreAttributes=new HashSet<>(Arrays.asList(userIgnoreAttributes));
  User user=importUser(ldapServerId,companyId,attributes,userMappings,userExpandoMappings,contactMappings,contactExpandoMappings,password,ldapUserIgnoreAttributes);
  Properties groupMappings=_ldapSettings.getGroupMappings(ldapServerId,companyId);
  importGroups(ldapServerId,companyId,ldapContext,attributes,user,userMappings,groupMappings);
  return user;
}
