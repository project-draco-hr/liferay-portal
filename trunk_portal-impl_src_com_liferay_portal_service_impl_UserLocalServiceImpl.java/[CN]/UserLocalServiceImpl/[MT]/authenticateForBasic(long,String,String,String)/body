{
  if (PropsValues.AUTH_LOGIN_DISABLED) {
    return 0;
  }
  try {
    User user=null;
    if (authType.equals(CompanyConstants.AUTH_TYPE_EA)) {
      user=getUserByEmailAddress(companyId,login);
    }
 else     if (authType.equals(CompanyConstants.AUTH_TYPE_SN)) {
      user=getUserByScreenName(companyId,login);
    }
 else     if (authType.equals(CompanyConstants.AUTH_TYPE_ID)) {
      user=getUserById(companyId,GetterUtil.getLong(login));
    }
    if (user.isDefaultUser()) {
      if (_log.isInfoEnabled()) {
        _log.info("Basic authentication is disabled for the default " + "user");
      }
      return 0;
    }
 else     if (!user.isActive()) {
      if (_log.isInfoEnabled()) {
        _log.info("Basic authentication is disabled for inactive user " + user.getUserId());
      }
      return 0;
    }
    if (!PropsValues.BASIC_AUTH_PASSWORD_REQUIRED) {
      return user.getUserId();
    }
    String userPassword=user.getPassword();
    if (!user.isPasswordEncrypted()) {
      userPassword=PwdEncryptor.encrypt(userPassword);
    }
    String encPassword=PwdEncryptor.encrypt(password);
    if (userPassword.equals(password) || userPassword.equals(encPassword)) {
      return user.getUserId();
    }
  }
 catch (  NoSuchUserException nsue) {
  }
  return 0;
}
