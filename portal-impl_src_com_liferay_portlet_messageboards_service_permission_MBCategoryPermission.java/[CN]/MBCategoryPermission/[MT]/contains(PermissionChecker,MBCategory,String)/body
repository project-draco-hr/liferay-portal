{
  if (actionId.equals(ActionKeys.ADD_CATEGORY)) {
    actionId=ActionKeys.ADD_SUBCATEGORY;
  }
  if (MBBanLocalServiceUtil.hasBan(category.getGroupId(),permissionChecker.getUserId())) {
    return false;
  }
  long categoryId=category.getCategoryId();
  while (categoryId != MBCategoryImpl.DEFAULT_PARENT_CATEGORY_ID) {
    category=MBCategoryLocalServiceUtil.getCategory(categoryId);
    categoryId=category.getParentCategoryId();
    if (permissionChecker.hasOwnerPermission(category.getCompanyId(),MBCategory.class.getName(),category.getCategoryId(),category.getUserId(),actionId)) {
      return true;
    }
    if (permissionChecker.hasPermission(category.getGroupId(),MBCategory.class.getName(),category.getCategoryId(),actionId)) {
      return true;
    }
    if (actionId.equals(ActionKeys.VIEW)) {
      break;
    }
  }
  return false;
}
