{
  Set<String> clusterNodeIds=new HashSet<>();
  if (clusterRequest.isMulticast()) {
    clusterNodeIds.addAll(_clusterNodes.keySet());
  }
 else {
    clusterNodeIds.addAll(clusterRequest.getTargetClusterNodeIds());
  }
  if (clusterRequest.isSkipLocal()) {
    clusterNodeIds.remove(_LOCAL_CLUSTER_NODE_ID);
  }
  FutureClusterResponses futureClusterResponses=new FutureClusterResponses(clusterNodeIds);
  for (  String clusterNodeId : clusterNodeIds) {
    MethodHandler methodHandler=clusterRequest.getMethodHandler();
    try {
      futureClusterResponses.addClusterNodeResponse(ClusterNodeResponse.createResultClusterNodeResponse(_clusterNodes.get(clusterNodeId),clusterRequest.getUuid(),methodHandler.invoke()));
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
  return futureClusterResponses;
}
