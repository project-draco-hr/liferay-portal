{
  Set<String> clusterNodeIds=new HashSet<>();
  if (clusterRequest.isMulticast()) {
    clusterNodeIds.addAll(_clusterNodes.keySet());
  }
 else {
    clusterNodeIds.addAll(clusterRequest.getTargetClusterNodeIds());
  }
  if (clusterRequest.isSkipLocal()) {
    clusterNodeIds.remove(_LOCAL_CLUSTER_NODE_ID);
  }
  FutureClusterResponses futureClusterResponses=new FutureClusterResponses(clusterNodeIds);
  for (  String clusterNodeId : clusterNodeIds) {
    ClusterNodeResponse clusterNodeResponse=new ClusterNodeResponse();
    clusterNodeResponse.setClusterMessageType(ClusterMessageType.EXECUTE);
    clusterNodeResponse.setMulticast(clusterRequest.isMulticast());
    clusterNodeResponse.setUuid(clusterRequest.getUuid());
    clusterNodeResponse.setClusterNode(_clusterNodes.get(clusterNodeId));
    try {
      MethodHandler methodHandler=clusterRequest.getMethodHandler();
      clusterNodeResponse.setResult(methodHandler.invoke());
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
    futureClusterResponses.addClusterNodeResponse(clusterNodeResponse);
  }
  return futureClusterResponses;
}
