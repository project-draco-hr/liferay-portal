{
  ClusterMasterExecutorImpl clusterMasterExecutorImpl=new ClusterMasterExecutorImpl();
  clusterMasterExecutorImpl.setClusterExecutor(new MockClusterExecutor(true));
  clusterMasterExecutorImpl.initialize();
  CaptureHandler captureHandler=JDKLoggerTestUtil.configureJDKLogger(ClusterMasterExecutorImpl.class.getName(),Level.INFO);
  try {
    String otherOwner=AddressSerializerUtil.serialize(_OTHER_ADDRESS);
    _mockLockLocalService.setLock(otherOwner);
    Assert.assertEquals(_LOCAL_ADDRESS,AddressSerializerUtil.deserialize(clusterMasterExecutorImpl.getMasterAddressString()));
    List<LogRecord> logRecords=captureHandler.getLogRecords();
    Assert.assertEquals(2,logRecords.size());
    LogRecord logRecord=logRecords.get(0);
    Assert.assertEquals("Lock currently held by " + otherOwner,logRecord.getMessage());
    logRecord=logRecords.get(1);
    Assert.assertEquals("Reattempting to acquire the cluster master lock",logRecord.getMessage());
  }
  finally {
    captureHandler.close();
  }
  captureHandler=JDKLoggerTestUtil.configureJDKLogger(ClusterMasterExecutorImpl.class.getName(),Level.INFO);
  try {
    _mockLockLocalService.setLock(null);
    Assert.assertEquals(_LOCAL_ADDRESS,AddressSerializerUtil.deserialize(clusterMasterExecutorImpl.getMasterAddressString()));
    List<LogRecord> logRecords=captureHandler.getLogRecords();
    Assert.assertEquals(2,logRecords.size());
    LogRecord logRecord=logRecords.get(0);
    Assert.assertEquals("Unable to acquire the cluster master lock",logRecord.getMessage());
    logRecord=logRecords.get(1);
    Assert.assertEquals("Reattempting to acquire the cluster master lock",logRecord.getMessage());
  }
  finally {
    captureHandler.close();
  }
  captureHandler=JDKLoggerTestUtil.configureJDKLogger(ClusterMasterExecutorImpl.class.getName(),Level.OFF);
  try {
    _mockLockLocalService.setLock(null);
    Assert.assertEquals(_LOCAL_ADDRESS,AddressSerializerUtil.deserialize(clusterMasterExecutorImpl.getMasterAddressString()));
    List<LogRecord> logRecords=captureHandler.getLogRecords();
    Assert.assertTrue(logRecords.isEmpty());
  }
  finally {
    captureHandler.close();
  }
}
