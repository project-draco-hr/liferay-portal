{
  List<String> actionsList=ResourceActionsUtil.getResourceActions(portletResource,resourceName);
  Map<Long,String[]> roleIdsToActionIds=new HashMap<>();
  for (  String roleName : roleNames) {
    Role role=RoleLocalServiceUtil.getRole(TestPropsValues.getCompanyId(),roleName);
    List<String> roleActions=ListUtil.copy(actionsList);
    if (roleName.equals(RoleConstants.GUEST)) {
      List<String> unsupportedActionIds=ResourceActionsUtil.getResourceGuestUnsupportedActions(resourceName,resourceName);
      roleActions.removeAll(unsupportedActionIds);
    }
    roleActions.removeAll(actionIds);
    roleIdsToActionIds.put(role.getRoleId(),ArrayUtil.toStringArray(roleActions));
  }
  ResourceBlockLocalServiceUtil.setIndividualScopePermissions(companyId,groupId,resourceName,classPK,roleIdsToActionIds);
}
