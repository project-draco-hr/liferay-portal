{
  String sql="select * from IGImage";
  if (companyId != 0) {
    sql="select * from IGImage where companyId = ?";
  }
  try (PreparedStatement ps=connection.prepareStatement(sql)){
    if (companyId != 0) {
      ps.setLong(1,companyId);
    }
    try (ResultSet rs=ps.executeQuery()){
      while (rs.next()) {
        String uuid=rs.getString("uuid_");
        long imageId=rs.getLong("imageId");
        long groupId=rs.getLong("groupId");
        companyId=rs.getLong("companyId");
        long userId=rs.getLong("userId");
        String userName=rs.getString("userName");
        Timestamp createDate=rs.getTimestamp("createDate");
        Timestamp modifiedDate=rs.getTimestamp("modifiedDate");
        long folderId=rs.getLong("folderId");
        String title=rs.getString("name");
        String description=rs.getString("description");
        long smallImageId=rs.getLong("smallImageId");
        long largeImageId=rs.getLong("largeImageId");
        long custom1ImageId=rs.getLong("custom1ImageId");
        long custom2ImageId=rs.getLong("custom2ImageId");
        Image image=getImage(largeImageId);
        if (image == null) {
          continue;
        }
        String extension=image.getType();
        String mimeType=MimeTypesUtil.getExtensionContentType(extension);
        String name=String.valueOf(increment("com.liferay.portlet.documentlibrary.model." + "DLFileEntry"));
        long size=image.getSize();
        try {
          addDLFileEntry(uuid,imageId,groupId,companyId,userId,userName,userId,userName,createDate,modifiedDate,groupId,folderId,name,extension,mimeType,title,description,StringPool.BLANK,fileEntryTypeId,"1.0",size,0,smallImageId,largeImageId,custom1ImageId,custom2ImageId);
        }
 catch (        Exception e) {
          title=title.concat(StringPool.SPACE).concat(String.valueOf(imageId));
          addDLFileEntry(uuid,imageId,groupId,companyId,userId,userName,userId,userName,createDate,modifiedDate,groupId,folderId,name,extension,mimeType,title,description,StringPool.BLANK,fileEntryTypeId,"1.0",size,0,smallImageId,largeImageId,custom1ImageId,custom2ImageId);
        }
        addDLFileVersion(increment(),groupId,companyId,userId,userName,createDate,groupId,folderId,imageId,extension,mimeType,title,description,StringPool.BLANK,StringPool.BLANK,fileEntryTypeId,"1.0",size,0,userId,userName,modifiedDate);
      }
    }
   }
 }
