{
  Image thumbnailImage=null;
  try {
    thumbnailImage=getImage(thumbnailImageId);
    InputStream is=getHookImageAsStream(thumbnailImage);
    ImageProcessorUtil.storeThumbnail(companyId,groupId,fileEntryId,fileVersionId,custom1ImageId,custom2ImageId,is,thumbnailImage.getType());
    if (largeImageId != thumbnailImageId) {
      _sourceHook.deleteImage(thumbnailImage);
      runSQL("delete from Image where imageId = " + thumbnailImageId);
    }
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Ignoring exception for image " + thumbnailImageId,e);
    }
  }
}
