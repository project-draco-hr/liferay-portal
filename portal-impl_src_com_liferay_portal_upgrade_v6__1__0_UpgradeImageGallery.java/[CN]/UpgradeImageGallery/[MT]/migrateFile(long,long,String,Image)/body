{
  byte[] bytes=null;
  if (_sourceHook instanceof DatabaseHook) {
    bytes=getImageBytesFromDB(image);
  }
 else {
    InputStream is=_sourceHook.getImageAsStream(image);
    bytes=FileUtil.getBytes(is);
  }
  if (name == null) {
    name=image.getImageId() + StringPool.PERIOD + image.getType();
  }
  if (DLStoreUtil.hasFile(companyId,repositoryId,name)) {
    DLStoreUtil.deleteFile(companyId,repositoryId,name);
  }
  DLStoreUtil.addFile(companyId,repositoryId,name,false,bytes);
}
