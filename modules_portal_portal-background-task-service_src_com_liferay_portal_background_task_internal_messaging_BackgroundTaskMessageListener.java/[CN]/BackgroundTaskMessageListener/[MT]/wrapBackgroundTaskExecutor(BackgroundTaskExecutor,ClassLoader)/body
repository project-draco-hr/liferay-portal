{
  if (classLoader != ClassLoaderUtil.getPortalClassLoader()) {
    backgroundTaskExecutor=new ClassLoaderAwareBackgroundTaskExecutor(backgroundTaskExecutor,classLoader);
  }
  if (backgroundTaskExecutor.isSerial()) {
    backgroundTaskExecutor=new SerialBackgroundTaskExecutor(backgroundTaskExecutor);
  }
  backgroundTaskExecutor=new ThreadLocalAwareBackgroundTaskExecutor(backgroundTaskExecutor,_backgroundTaskThreadLocalManager);
  return backgroundTaskExecutor;
}
