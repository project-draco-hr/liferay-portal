{
  User user=UserTestUtil.addUser();
  PermissionChecker permissionChecker=_getPermissionChecker(user);
  if (!hasRootPermission) {
    RoleTestUtil.removeResourcePermission(RoleConstants.POWER_USER,ShoppingPermission.RESOURCE_NAME,ResourceConstants.SCOPE_GROUP,String.valueOf(_group.getGroupId()),ActionKeys.VIEW);
  }
  boolean hasViewPermission=ShoppingItemPermission.contains(permissionChecker,_item.getItemId(),ActionKeys.VIEW);
  boolean hasSubitemViewPermission=ShoppingItemPermission.contains(permissionChecker,_subitem.getItemId(),ActionKeys.VIEW);
  if (!hasRootPermission) {
    Assert.assertFalse(hasViewPermission);
    Assert.assertFalse(hasSubitemViewPermission);
  }
 else {
    Assert.assertTrue(hasViewPermission);
    Assert.assertTrue(hasSubitemViewPermission);
  }
  if (!hasRootPermission) {
    RoleTestUtil.addResourcePermission(RoleConstants.POWER_USER,ShoppingPermission.RESOURCE_NAME,ResourceConstants.SCOPE_GROUP,String.valueOf(_group.getGroupId()),ActionKeys.VIEW);
  }
  ServiceTestUtil.setUser(TestPropsValues.getUser());
}
