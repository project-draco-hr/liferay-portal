{
  DocumentRepository documentRepository=capabilityRegistry.getTarget();
  DLAppServiceAdapter dlAppServiceAdapter=DLAppServiceAdapter.create(documentRepository);
  DLFileEntryServiceAdapter dlFileEntryServiceAdapter=DLFileEntryServiceAdapter.create(documentRepository);
  DLFolderServiceAdapter dlFolderServiceAdapter=DLFolderServiceAdapter.create(documentRepository);
  RepositoryServiceAdapter repositoryServiceAdapter=RepositoryServiceAdapter.create(documentRepository);
  capabilityRegistry.addExportedCapability(RelatedModelCapability.class,new LiferayRelatedModelCapability(new RepositoryEntryConverter(),new RepositoryEntryChecker(documentRepository)));
  TrashCapability trashCapability=new LiferayTrashCapability(dlAppServiceAdapter,DLAppHelperLocalServiceUtil.getService(),dlFileEntryServiceAdapter,dlFolderServiceAdapter,repositoryServiceAdapter,TrashEntryLocalServiceUtil.getService(),TrashVersionLocalServiceUtil.getService());
  capabilityRegistry.addExportedCapability(TrashCapability.class,trashCapability);
  capabilityRegistry.addExportedCapability(WorkflowCapability.class,new MinimalWorkflowCapability(dlFileEntryServiceAdapter));
}
