{
  ThreadLocalCache<Object[]> threadLocalCache=ThreadLocalCacheManager.getThreadLocalCache(Lifecycle.REQUEST,AssetEntryServiceImpl.class.getName());
  threadLocalCache.removeAll();
  AssetEntryQuery assetEntryQuery=new AssetEntryQuery();
  if (assetCategoryIds != null) {
    assetEntryQuery=buildAssetEntryQueryWithAssetCategoryIds(assetEntryQuery,assetCategoryIds,any,not);
  }
  Group group=ServiceTestUtil.addGroup();
  long[] assetTagIds=null;
  if (assetTagNames != null) {
    assetTagIds=AssetTagLocalServiceUtil.getTagIds(group.getGroupId(),assetTagNames);
    assetEntryQuery=buildAssetEntryQueryWithAssetTagIds(assetEntryQuery,assetTagIds,any,not);
  }
  assetEntryQuery.setGroupIds(new long[]{group.getGroupId()});
  int initialEntries=AssetEntryServiceUtil.getEntriesCount(assetEntryQuery);
  ServiceContext serviceContext=ServiceTestUtil.getServiceContext(group.getGroupId());
  if (assetCategoryIds1 != null) {
    serviceContext.setAssetCategoryIds(assetCategoryIds1);
  }
  if (assetTagNames1 != null) {
    serviceContext.setAssetTagNames(assetTagNames1);
  }
  BlogsEntryLocalServiceUtil.addEntry(TestPropsValues.getUserId(),title1,StringPool.BLANK,"This is a blog entry for testing purposes",1,1,1965,0,0,true,true,null,false,null,null,null,serviceContext);
  if (assetCategoryIds2 != null) {
    serviceContext.setAssetCategoryIds(assetCategoryIds2);
  }
  if (assetTagNames2 != null) {
    serviceContext.setAssetTagNames(assetTagNames2);
  }
  BlogsEntryLocalServiceUtil.addEntry(TestPropsValues.getUserId(),title2,StringPool.BLANK,"This is a blog entry for testing purposes",1,1,1965,0,0,true,true,null,false,null,null,null,serviceContext);
  threadLocalCache.removeAll();
  assetEntryQuery=new AssetEntryQuery();
  if (assetCategoryIds != null) {
    assetEntryQuery=buildAssetEntryQueryWithAssetCategoryIds(assetEntryQuery,assetCategoryIds,any,not);
  }
  if (assetTagNames != null) {
    assetTagIds=AssetTagLocalServiceUtil.getTagIds(group.getGroupId(),assetTagNames);
    assetEntryQuery=buildAssetEntryQueryWithAssetTagIds(assetEntryQuery,assetTagIds,any,not);
  }
  assetEntryQuery.setGroupIds(new long[]{group.getGroupId()});
  int allTagsEntries=AssetEntryServiceUtil.getEntriesCount(assetEntryQuery);
  Assert.assertEquals(initialEntries + expectedResults,allTagsEntries);
}
