{
  long[] remoteMessageIds=new long[messageIds.length];
  for (int i=0; i < messageIds.length; i++) {
    com.liferay.mail.model.Message message=MessageLocalServiceUtil.getMessage(messageIds[i]);
    remoteMessageIds[i]=message.getRemoteMessageId();
  }
  List<Message> jxMessages=new ArrayList<>();
  Message[] jxMessagesArray=getMessagesByUID(jxFolder,remoteMessageIds);
  for (int i=0; i < jxMessagesArray.length; i++) {
    Message jxMessage=jxMessagesArray[i];
    if (jxMessage != null) {
      jxMessages.add(jxMessage);
    }
 else     if (deleteMissingMessages && (remoteMessageIds[i] != 0)) {
      MessageLocalServiceUtil.deleteMessage(messageIds[i]);
    }
  }
  return jxMessages;
}
