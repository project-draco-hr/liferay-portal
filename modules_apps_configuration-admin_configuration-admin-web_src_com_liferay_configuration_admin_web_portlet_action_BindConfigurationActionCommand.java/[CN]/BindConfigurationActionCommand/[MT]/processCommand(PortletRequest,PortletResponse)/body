{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String factoryPid=ParamUtil.getString(portletRequest,"factoryPid");
  String pid=ParamUtil.getString(portletRequest,"pid",factoryPid);
  if (_log.isDebugEnabled()) {
    _log.debug("Binding attributes for service: " + pid);
  }
  ConfigurationHelper configurationHelper=new ConfigurationHelper(_bundleContext,_configurationAdmin,_metaTypeService,themeDisplay.getLanguageId());
  ConfigurationModel configurationModel=configurationHelper.getConfigurationModel(pid);
  Configuration configuration=configurationHelper.getConfiguration(pid);
  DDMFormValues ddmFormValues=getDDMFormValues(portletRequest,configurationModel,configuration,pid,themeDisplay.getLocale());
  Map<String,List<DDMFormFieldValue>> ddmFormFieldValuesMap=ddmFormValues.getDDMFormFieldValuesMap();
  Dictionary<String,Object> properties=ConfigurationProperties.load(configurationModel,ddmFormFieldValuesMap,themeDisplay.getLocale());
  properties.put(Constants.SERVICE_PID,pid);
  if (Validator.isNotNull(factoryPid)) {
    properties.put(ConfigurationAdmin.SERVICE_FACTORYPID,factoryPid);
  }
  configureTargetService(configurationModel,configuration,properties);
  return true;
}
