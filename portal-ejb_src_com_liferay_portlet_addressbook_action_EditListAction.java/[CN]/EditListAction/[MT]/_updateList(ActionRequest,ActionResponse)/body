{
  String listId=req.getParameter("list_id");
  String name=ParamUtil.getString(req,"list_name");
  String[] contactIds=StringUtil.split(ParamUtil.getString(req,"contact_ids"));
  List contacts=new ArrayList();
  for (int i=0; i < contactIds.length; i++) {
    contacts.add(ABContactServiceUtil.getContact(contactIds[i]));
  }
  if (Validator.isNull(listId)) {
    ABList list=ABListServiceUtil.addList(name);
    ABListServiceUtil.setContacts(list.getListId(),contacts);
  }
 else {
    ABListServiceUtil.updateList(listId,name);
    ABListServiceUtil.setContacts(listId,contacts);
  }
  res.sendRedirect(ParamUtil.getString(req,"redirect"));
}
