{
  if (_bufferedOutput instanceof ByteArrayOutputStream) {
    ByteArrayOutputStream baos=(ByteArrayOutputStream)_bufferedOutput;
    if (baos.size() + length > _BUFFER_SIZE) {
      _res.addHeader(_CONTENT_ENCODING,_GZIP);
      GZIPOutputStream gzipOutput=new GZIPOutputStream(_output);
      gzipOutput.write(baos.toByteArray());
      _bufferedOutput=gzipOutput;
    }
  }
}
