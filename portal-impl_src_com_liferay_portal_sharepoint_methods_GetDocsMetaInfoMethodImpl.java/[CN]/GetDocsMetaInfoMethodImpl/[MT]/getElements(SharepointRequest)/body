{
  List<ResponseElement> elements=new ArrayList<ResponseElement>();
  String urlList=ParamUtil.getString(sharepointRequest.getHttpRequest(),"url_list");
  urlList=urlList.substring(1);
  urlList=urlList.substring(0,urlList.length() - 1);
  int pos=urlList.lastIndexOf("sharepoint/") + 11;
  String documentName=urlList.substring(pos);
  Tree documentListTree=new Tree();
  try {
    documentListTree.addChild(SharepointUtil.getDocumentTree(documentName));
  }
 catch (  Exception e1) {
    if (e1 instanceof NoSuchFileEntryException) {
      try {
        documentListTree.addChild(SharepointUtil.getDLFolderTree(urlList));
      }
 catch (      Exception e2) {
      }
    }
  }
  Property documentProperty=new Property("document_list",documentListTree);
  elements.add(documentProperty);
  elements.add(new Property("urldirs",new Tree()));
  return elements;
}
