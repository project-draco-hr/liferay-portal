{
  WSRPProducer wsrpProducer=getWSRPProducer();
  Http.Options httpOptions=new Http.Options();
  addHeaders(getMarkup.getMarkupParams(),httpOptions);
  httpOptions.setLocation(getURL(getMarkup,wsrpProducer));
  String rawContent=getRawContent(httpOptions);
  String windowState=getWindowState(getMarkup.getMarkupParams());
  String content=getContent(rawContent,windowState);
  MarkupContext markupContext=new MarkupContext();
  markupContext.setItemString(content);
  markupContext.setMimeType(ContentTypes.TEXT_HTML_UTF8);
  markupContext.setRequiresRewriting(true);
  MarkupResponse markupResponse=new MarkupResponse();
  markupResponse.setMarkupContext(markupContext);
  return markupResponse;
}
