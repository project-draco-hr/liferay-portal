{
  long[] unsetUserIds=new long[userIds.length];
  List<User> oldUsers=userGroupPersistence.getUsers(userGroupId);
  for (int i=0; i < oldUsers.size(); i++) {
    User user=oldUsers.get(i);
    if (!ArrayUtil.contains(userIds,user.getUserId())) {
      unsetUserIds[i]=user.getUserId();
    }
  }
  checkUnsetUserGroupUsersMembershipPolicy(userGroupId,unsetUserIds);
  checkAddUserGroupUsersMembershipPolicy(userGroupId,userIds);
}
