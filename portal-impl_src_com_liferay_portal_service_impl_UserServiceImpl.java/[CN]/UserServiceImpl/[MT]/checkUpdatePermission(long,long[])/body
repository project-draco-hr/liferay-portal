{
  try {
    GroupPermissionUtil.check(getPermissionChecker(),groupId,ActionKeys.UPDATE);
  }
 catch (  PrincipalException pe) {
    boolean hasPermission=false;
    long userId=getUserId();
    if ((userIds.length == 1) && (userId == userIds[0])) {
      Group group=GroupLocalServiceUtil.getGroup(groupId);
      if (group.getType().equals(GroupImpl.TYPE_COMMUNITY_OPEN)) {
        hasPermission=true;
      }
    }
    if (!hasPermission) {
      throw new PrincipalException();
    }
  }
}
