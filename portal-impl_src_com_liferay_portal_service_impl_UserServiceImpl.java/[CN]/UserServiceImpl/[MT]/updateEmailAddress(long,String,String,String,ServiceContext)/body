{
  UserPermissionUtil.check(getPermissionChecker(),userId,ActionKeys.UPDATE);
  User user=userPersistence.findByPrimaryKey(userId);
  validateEmailAddress(user,emailAddress2);
  return userLocalService.updateEmailAddress(userId,password,emailAddress1,emailAddress2,serviceContext);
}
