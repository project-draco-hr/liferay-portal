{
  boolean indexingEnabled=true;
  if (serviceContext != null) {
    indexingEnabled=serviceContext.isIndexingEnabled();
    serviceContext.setIndexingEnabled(false);
  }
  try {
    User user=addUserWithWorkflow(companyId,autoPassword,password1,password2,autoScreenName,screenName,emailAddress,facebookId,openId,locale,firstName,middleName,lastName,prefixId,suffixId,male,birthdayMonth,birthdayDay,birthdayYear,jobTitle,groupIds,organizationIds,roleIds,userGroupIds,sendEmail,serviceContext);
    UsersAdminUtil.updateAddresses(Contact.class.getName(),user.getContactId(),addresses);
    UsersAdminUtil.updateEmailAddresses(Contact.class.getName(),user.getContactId(),emailAddresses);
    UsersAdminUtil.updatePhones(Contact.class.getName(),user.getContactId(),phones);
    UsersAdminUtil.updateWebsites(Contact.class.getName(),user.getContactId(),websites);
    updateAnnouncementsDeliveries(user.getUserId(),announcementsDelivers);
    if (indexingEnabled) {
      Indexer indexer=IndexerRegistryUtil.nullSafeGetIndexer(User.class);
      indexer.reindex(user);
    }
    return user;
  }
  finally {
    serviceContext.setIndexingEnabled(indexingEnabled);
  }
}
