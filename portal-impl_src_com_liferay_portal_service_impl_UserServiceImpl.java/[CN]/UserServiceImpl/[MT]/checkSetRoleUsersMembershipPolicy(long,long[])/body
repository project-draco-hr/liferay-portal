{
  long[] unsetUserIds=new long[userIds.length];
  List<User> oldUsers=rolePersistence.getUsers(roleId);
  for (int i=0; i < oldUsers.size(); i++) {
    User user=oldUsers.get(i);
    if (!ArrayUtil.contains(userIds,user.getUserId())) {
      unsetUserIds[i]=user.getUserId();
    }
  }
  checkUnsetRoleUsersMembershipPolicy(roleId,unsetUserIds);
  checkAddRoleUsersMembershipPolicy(roleId,userIds);
}
