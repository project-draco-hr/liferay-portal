{
  if (!ClusterInvokeThreadLocal.isEnabled()) {
    return null;
  }
  Clusterable clusterable=findAnnotation(methodInvocation);
  if (clusterable == NullClusterable.NULL_CLUSTERABLE) {
    return null;
  }
  if (!clusterable.onMaster()) {
    return null;
  }
  Method method=methodInvocation.getMethod();
  Class<?> returnType=method.getReturnType();
  if (ClusterMasterExecutorUtil.isMaster()) {
    Object result=methodInvocation.proceed();
    if (returnType == void.class) {
      result=nullResult;
    }
    return result;
  }
  MethodHandler methodHandler=ClusterableInvokerUtil.createMethodHandler(clusterable.acceptor(),methodInvocation);
  Future<Object> futureResult=ClusterMasterExecutorUtil.executeOnMaster(methodHandler);
  Object result=futureResult.get(PropsValues.CLUSTERABLE_ADVICE_CALL_MASTER_TIMEOUT,TimeUnit.SECONDS);
  if (returnType == void.class) {
    result=nullResult;
  }
  return result;
}
