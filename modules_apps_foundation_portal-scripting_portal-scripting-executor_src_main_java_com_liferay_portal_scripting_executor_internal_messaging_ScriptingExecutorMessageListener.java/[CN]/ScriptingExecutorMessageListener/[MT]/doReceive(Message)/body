{
  String scriptingLanguage=message.getString(ScriptingExecutorMessagingConstants.MESSAGE_KEY_SCRIPTING_LANGUAGE);
  List<URL> urls=(List<URL>)message.get(ScriptingExecutorMessagingConstants.MESSAGE_KEY_URLS);
  Thread thread=Thread.currentThread();
  ClassLoader threadClassLoader=Thread.currentThread().getContextClassLoader();
  for (  URL url : urls) {
    try (InputStream inputStream=url.openStream()){
      ClassLoader bundleClassLoader=(ClassLoader)message.get(ScriptingExecutorMessagingConstants.BUNDLE_CLASS_LOADER);
      ClassLoader classLoader=AggregateClassLoader.getAggregateClassLoader(threadClassLoader,bundleClassLoader);
      thread.setContextClassLoader(classLoader);
      _scripting.exec(null,new HashMap<String,Object>(),scriptingLanguage,StringUtil.read(inputStream));
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn("Unable to execute script " + url.getFile(),e);
      }
    }
 finally {
      thread.setContextClassLoader(threadClassLoader);
    }
  }
}
