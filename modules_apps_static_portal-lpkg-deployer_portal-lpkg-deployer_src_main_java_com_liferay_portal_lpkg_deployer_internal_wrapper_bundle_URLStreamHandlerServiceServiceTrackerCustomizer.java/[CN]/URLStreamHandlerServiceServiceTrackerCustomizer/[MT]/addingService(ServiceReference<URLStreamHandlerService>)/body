{
  AbstractURLStreamHandlerService abstractURLStreamHandlerService=(AbstractURLStreamHandlerService)_bundleContext.getService(serviceReference);
  try {
    Bundle bundle=_bundleContext.getBundle();
    URL wabURL=new URL("webbundle",null,-1,_lpkgURL.toExternalForm() + "?" + Constants.BUNDLE_VERSION+ "="+ bundle.getVersion()+ "&Web-ContextPath=/"+ _contextName,abstractURLStreamHandlerService);
    URLConnection urlConnection=abstractURLStreamHandlerService.openConnection(wabURL);
    Bundle newBundle=_bundleContext.installBundle(wabURL.toExternalForm(),urlConnection.getInputStream());
    BundleStartLevel bundleStartLevel=newBundle.adapt(BundleStartLevel.class);
    bundleStartLevel.setStartLevel(_startLevel);
    newBundle.start();
    return newBundle;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
