{
  UploadPortletRequest uploadReq=PortalUtil.getUploadPortletRequest(req);
  String importerType=ParamUtil.get(uploadReq,"importer_type",ABUtil.IE_OUTLOOK);
  byte[] bytes=FileUtil.getBytes(uploadReq.getFile("import_file"));
  if (bytes == null || bytes.length == 0) {
    throw new UploadException();
  }
  Importer importer=null;
  if (importerType.equals(ABUtil.IE_OUTLOOK)) {
    importer=new OutlookImporter();
  }
 else   if (importerType.equals(ABUtil.IE_YAHOO)) {
    importer=new OutlookImporter();
  }
  if (importer != null) {
    importer.setData(bytes);
    ABContactServiceUtil.addContacts(importer);
  }
  res.sendRedirect(ParamUtil.getString(req,"redirect"));
}
