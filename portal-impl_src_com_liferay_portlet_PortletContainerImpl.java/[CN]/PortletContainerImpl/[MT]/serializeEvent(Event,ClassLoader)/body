{
  Serializable value=event.getValue();
  if (value == null) {
    return event;
  }
  Class<?> valueClass=value.getClass();
  String valueClassName=valueClass.getName();
  try {
    Class<?> loadedValueClass=portletClassLoader.loadClass(valueClassName);
    if (loadedValueClass.equals(valueClass)) {
      return event;
    }
  }
 catch (  ClassNotFoundException cnfe) {
    if (_log.isWarnEnabled()) {
      _log.warn(portletClassLoader.toString() + " does not contain " + valueClassName,cnfe);
    }
  }
  EventImpl eventImpl=(EventImpl)event;
  byte[] serializedValue=eventImpl.getSerializedValue();
  value=(Serializable)SerializableUtil.deserialize(serializedValue,portletClassLoader);
  return new EventImpl(event.getName(),event.getQName(),value);
}
