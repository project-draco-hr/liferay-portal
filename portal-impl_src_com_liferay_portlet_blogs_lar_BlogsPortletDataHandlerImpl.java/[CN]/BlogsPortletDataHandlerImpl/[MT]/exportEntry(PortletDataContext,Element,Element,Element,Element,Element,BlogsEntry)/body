{
  if (!portletDataContext.isWithinDateRange(entry.getModifiedDate())) {
    return;
  }
  if (entry.getStatus() != WorkflowConstants.STATUS_APPROVED) {
    return;
  }
  String path=getEntryPath(portletDataContext,entry);
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  entry=(BlogsEntry)entry.clone();
  Element entryElement=(Element)entriesElement.selectSingleNode("//page[@path='".concat(path).concat("']"));
  if (entryElement == null) {
    entryElement=entriesElement.addElement("entry");
  }
  String content=JournalPortletDataHandlerImpl.exportReferencedContent(portletDataContext,dlFileEntryTypesElement,dlFoldersElement,dlFileEntriesElement,dlFileRanksElement,entryElement,entry.getContent());
  entry.setContent(content);
  String imagePath=getEntryImagePath(portletDataContext,entry);
  entryElement.addAttribute("image-path",imagePath);
  Image smallImage=ImageUtil.fetchByPrimaryKey(entry.getSmallImageId());
  if (entry.isSmallImage() && (smallImage != null)) {
    String smallImagePath=getEntrySmallImagePath(portletDataContext,entry);
    entryElement.addAttribute("small-image-path",smallImagePath);
    entry.setSmallImageType(smallImage.getType());
    portletDataContext.addZipEntry(smallImagePath,smallImage.getTextObj());
  }
  portletDataContext.addClassedModel(entryElement,path,entry,_NAMESPACE);
}
