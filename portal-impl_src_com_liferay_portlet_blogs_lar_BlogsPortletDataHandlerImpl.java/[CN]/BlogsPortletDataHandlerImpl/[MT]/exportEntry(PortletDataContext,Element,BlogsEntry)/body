{
  if (!portletDataContext.isWithinDateRange(entry.getModifiedDate())) {
    return;
  }
  if (entry.getStatus() != WorkflowConstants.STATUS_APPROVED) {
    return;
  }
  String path=getEntryPath(portletDataContext,entry);
  if (!portletDataContext.isPathNotProcessed(path)) {
    return;
  }
  Element entryElement=rootElement.addElement("entry");
  entryElement.addAttribute("path",path);
  entry.setUserUuid(entry.getUserUuid());
  Image smallImage=ImageUtil.fetchByPrimaryKey(entry.getSmallImageId());
  if (entry.isSmallImage() && (smallImage != null)) {
    String smallImagePath=getEntrySmallImagePath(portletDataContext,entry);
    entryElement.addAttribute("small-image-path",smallImagePath);
    entry.setSmallImageType(smallImage.getType());
    portletDataContext.addZipEntry(smallImagePath,smallImage.getTextObj());
  }
  portletDataContext.addPermissions(BlogsEntry.class,entry.getEntryId());
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"categories")) {
    portletDataContext.addAssetCategories(BlogsEntry.class,entry.getEntryId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"comments")) {
    portletDataContext.addComments(BlogsEntry.class,entry.getEntryId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"ratings")) {
    portletDataContext.addRatingsEntries(BlogsEntry.class,entry.getEntryId());
  }
  if (portletDataContext.getBooleanParameter(_NAMESPACE,"tags")) {
    portletDataContext.addAssetTags(BlogsEntry.class,entry.getEntryId());
  }
  portletDataContext.addZipEntry(path,entry);
}
