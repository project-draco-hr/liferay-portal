{
  PermissionedModel permissionedModel=new MockPermissionedModel();
  ResourceBlockPermissionsContainer resourceBlockPermissionsContainer=new ResourceBlockPermissionsContainer();
  resourceBlockPermissionsContainer.addPermission(_ROLE_ID,_ACTION_IDS);
  String permissionsHash=resourceBlockPermissionsContainer.getPermissionsHash();
  Semaphore semaphore=new Semaphore(0);
  List<Callable<Void>> callables=new ArrayList<Callable<Void>>();
  for (int i=0; i < _REFERENCE_COUNT; i++) {
    callables.add(new UpdateResourceBlockIdCallable(permissionedModel,permissionsHash,resourceBlockPermissionsContainer,semaphore));
    callables.add(new ReleaseResourceBlockCallable(permissionedModel,semaphore));
  }
  ExecutorService executorService=Executors.newFixedThreadPool(_THREAD_COUNT);
  List<Future<Void>> futures=executorService.invokeAll(callables);
  for (  Future<Void> future : futures) {
    future.get();
  }
  executorService.shutdownNow();
  _assertNoSuchResourceBlock(_COMPANY_ID,_GROUP_ID,_MODEL_NAME);
}
