{
  Annotation annotation=ServiceMethodAnnotationCache.get(methodInvocation,_annotationType,_nullAnnotation);
  if (annotation != null) {
    return (T)annotation;
  }
  Class<?> targetClass=methodInvocation.getThis().getClass();
  Method method=methodInvocation.getMethod();
  Method targetMethod=null;
  try {
    targetMethod=targetClass.getDeclaredMethod(method.getName(),method.getParameterTypes());
  }
 catch (  Throwable t) {
  }
  Annotation[] annotations=null;
  if (targetMethod != null) {
    annotations=targetMethod.getAnnotations();
  }
  if ((annotations == null) || (annotations.length == 0)) {
    annotations=method.getAnnotations();
  }
  if ((annotations != null) && annotations.length > 0) {
    List<Annotation> filteredAnnotations=new ArrayList<Annotation>(annotations.length);
    for (    Annotation tempAnnotation : annotations) {
      if (_annotationTypeSet.contains(tempAnnotation.annotationType())) {
        filteredAnnotations.add(tempAnnotation);
      }
    }
    annotations=filteredAnnotations.toArray(new Annotation[filteredAnnotations.size()]);
  }
  ServiceMethodAnnotationCache.put(methodInvocation,annotations);
  for (  Annotation tempAnnotation : annotations) {
    if (tempAnnotation.annotationType() == _annotationType) {
      return (T)tempAnnotation;
    }
  }
  return _nullAnnotation;
}
