{
  TempFileEntryUtil.addTempFileEntry(_group.getGroupId(),_user.getUserId(),RandomTestUtil.randomString(),"image.jpg",getInputStream(),ContentTypes.IMAGE_JPEG);
  Repository repository=RepositoryLocalServiceUtil.fetchRepository(_group.getGroupId(),TempFileEntryUtil.class.getName(),StringPool.BLANK);
  LocalRepository localRepository=RepositoryProviderUtil.getLocalRepository(repository.getRepositoryId());
  int foldersAndFileEntriesAndFileShortcutsCount=getFoldersAndFileEntriesAndFileShortcutsCount(localRepository);
  Assert.assertTrue(foldersAndFileEntriesAndFileShortcutsCount > 0);
  TemporaryFileEntriesCapability temporaryFileEntriesCapability=localRepository.getCapability(TemporaryFileEntriesCapability.class);
  temporaryFileEntriesCapability.setTemporaryFileEntriesTimeout(1);
  Thread.sleep(2);
  temporaryFileEntriesCapability.deleteExpiredTemporaryFileEntries();
  foldersAndFileEntriesAndFileShortcutsCount=getFoldersAndFileEntriesAndFileShortcutsCount(localRepository);
  Assert.assertEquals(foldersAndFileEntriesAndFileShortcutsCount,0);
}
