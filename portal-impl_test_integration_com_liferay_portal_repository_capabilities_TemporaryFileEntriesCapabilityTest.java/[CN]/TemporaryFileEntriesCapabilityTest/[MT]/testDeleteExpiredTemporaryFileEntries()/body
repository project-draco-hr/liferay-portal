{
  FileEntry fileEntry=TempFileEntryUtil.addTempFileEntry(_group.getGroupId(),_user.getUserId(),RandomTestUtil.randomString(),"image.jpg",getInputStream(),ContentTypes.IMAGE_JPEG);
  DLFileEntry dlFileEntry=DLFileEntryLocalServiceUtil.getDLFileEntry(fileEntry.getFileEntryId());
  dlFileEntry.setCreateDate(new Date(System.currentTimeMillis() - Time.WEEK));
  DLFileEntryLocalServiceUtil.updateDLFileEntry(dlFileEntry);
  Repository repository=RepositoryLocalServiceUtil.fetchRepository(_group.getGroupId(),TempFileEntryUtil.class.getName(),StringPool.BLANK);
  LocalRepository localRepository=RepositoryProviderUtil.getLocalRepository(repository.getRepositoryId());
  int foldersAndFileEntriesAndFileShortcutsCount=getFoldersAndFileEntriesAndFileShortcutsCount(localRepository);
  Assert.assertTrue(foldersAndFileEntriesAndFileShortcutsCount > 0);
  TemporaryFileEntriesCapability temporaryFileEntriesCapability=localRepository.getCapability(TemporaryFileEntriesCapability.class);
  temporaryFileEntriesCapability.setTemporaryFileEntriesTimeout(Time.DAY);
  temporaryFileEntriesCapability.deleteExpiredTemporaryFileEntries();
  foldersAndFileEntriesAndFileShortcutsCount=getFoldersAndFileEntriesAndFileShortcutsCount(localRepository);
  Assert.assertEquals(0,foldersAndFileEntriesAndFileShortcutsCount);
}
