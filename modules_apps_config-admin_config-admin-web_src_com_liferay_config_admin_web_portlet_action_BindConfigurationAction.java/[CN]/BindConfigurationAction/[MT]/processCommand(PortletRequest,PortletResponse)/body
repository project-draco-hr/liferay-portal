{
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String languageId=themeDisplay.getLanguageId();
  Locale locale=themeDisplay.getLocale();
  String factoryPid=ParamUtil.getString(portletRequest,"factoryPid");
  String pid=ParamUtil.getString(portletRequest,"pid",factoryPid);
  if (_log.isDebugEnabled()) {
    _log.debug("Binding attributes for service: " + pid);
  }
  ConfigurationHelper configurationHelper=new ConfigurationHelper(_bundleContext,_configurationAdmin,_metaTypeService,languageId);
  ConfigurationModel model=configurationHelper.getModel(pid);
  Configuration configuration=configurationHelper.getConfiguration(pid);
  DDMFormValues ddmFormValues=getDDMFormValues(portletRequest,model,configuration,pid,locale);
  Map<String,List<DDMFormFieldValue>> ddmFormFieldValuesMap=ddmFormValues.getDDMFormFieldValuesMap();
  Dictionary<String,Object> properties=ConfigurationProperties.load(model,ddmFormFieldValuesMap,locale);
  properties.put(Constants.SERVICE_PID,pid);
  if (Validator.isNotNull(factoryPid)) {
    properties.put(ConfigurationAdmin.SERVICE_FACTORYPID,factoryPid);
  }
  configureTargetService(model,configuration,properties);
  return true;
}
