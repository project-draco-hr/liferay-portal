{
  String field=STAT_SORTABLE_FIELD;
  SearchContext searchContext=createSearchContext();
  Stats stats=new Stats();
  stats.setCount(true);
  stats.setField(field);
  stats.setMax(true);
  stats.setMean(true);
  stats.setMin(true);
  stats.setSum(true);
  stats.setSumOfSquares(true);
  searchContext.addStats(stats);
  Hits hits=search(searchContext);
  Map<String,StatsResults> statsResultsMap=hits.getStatsResults();
  Assert.assertNotNull(statsResultsMap);
  StatsResults statsResults=statsResultsMap.get(field);
  Assert.assertNotNull(statsResults);
  StatsResults expectedStatsResults=new StatsResults(field);
  expectedStatsResults.setCount(31);
  expectedStatsResults.setMax(31);
  expectedStatsResults.setMean(16);
  expectedStatsResults.setMin(1);
  expectedStatsResults.setSum(496);
  expectedStatsResults.setSumOfSquares(10416);
  Assert.assertEquals(toString(expectedStatsResults),toString(statsResults));
}
