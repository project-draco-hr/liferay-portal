{
  if (sql == null) {
    return sql;
  }
  String newSQL=_sqlMap.get(sql);
  if (newSQL != null) {
    return newSQL;
  }
 else {
    newSQL=sql;
  }
  if (_vendorMySQL) {
    DB db=DBFactoryUtil.getDB();
    if (!db.isSupportsStringCaseSensitiveQuery()) {
      newSQL=_removeLower(newSQL);
    }
  }
 else   if (_vendorSQLServer) {
    newSQL=_replaceMode(newSQL);
  }
  if (_log.isDebugEnabled()) {
    _log.debug("Original SQL " + sql);
    _log.debug("Modified SQL " + newSQL);
  }
  if (!sql.equals(newSQL)) {
    _sqlMap.put(sql,newSQL);
  }
  return sql;
}
