{
  MockHttpServletRequest request=getRequest();
  String url=layout.getRegularURL(request) + "?p_p_id='\"><script>alert(1)</script>&p_p_lifecycle=0&" + "p_p_state=exclusive";
  Map<String,List<String>> responseMap=request(url);
  Assert.assertEquals("200",responseMap.get("responseCode").get(0));
  String expected="You do not have the roles required to access this portlet.";
  String responseBody=responseMap.get("responseBody").get(0);
  Assert.assertTrue("Expected to contain <" + expected + "> but was <"+ responseBody+ ">",responseBody.contains("You do not have the roles required to access this portlet."));
}
