{
  String friendlyURLPath=null;
  String topLink=GetterUtil.getString(portletURL.getParameter("topLink"));
  String strutsAction=GetterUtil.getString(portletURL.getParameter("struts_action"));
  if (strutsAction.equals("/message_boards/search")) {
    friendlyURLPath="/message_boards/search";
  }
 else   if (strutsAction.equals("/message_boards/view")) {
    String categoryId=GetterUtil.getString(portletURL.getParameter("mbCategoryId"));
    if (Validator.isNotNull(categoryId) && !categoryId.equals("0")) {
      friendlyURLPath="/message_boards/category/" + categoryId;
      portletURL.addParameterIncludedInPath("mbCategoryId");
    }
 else {
      friendlyURLPath="/message_boards";
      if (Validator.isNotNull(topLink) && !topLink.equals("message-boards-home")) {
        friendlyURLPath+=StringPool.SLASH + topLink;
      }
      portletURL.addParameterIncludedInPath("topLink");
      if (categoryId.equals("0")) {
        portletURL.addParameterIncludedInPath("mbCategoryId");
      }
    }
  }
 else   if (strutsAction.equals("/message_boards/view_message")) {
    String messageId=portletURL.getParameter("messageId");
    if (Validator.isNotNull(messageId)) {
      friendlyURLPath="/message_boards/message/" + messageId;
      portletURL.addParameterIncludedInPath("messageId");
    }
  }
 else {
    if (_log.isWarnEnabled()) {
      _log.warn("Struts action " + strutsAction + " does not have a friendly URL path ");
    }
  }
  if (Validator.isNotNull(friendlyURLPath)) {
    WindowState windowState=portletURL.getWindowState();
    if (!windowState.equals(WindowState.NORMAL)) {
      friendlyURLPath+=StringPool.SLASH + windowState;
    }
    portletURL.addParameterIncludedInPath("p_p_id");
    portletURL.addParameterIncludedInPath("struts_action");
  }
  return friendlyURLPath;
}
