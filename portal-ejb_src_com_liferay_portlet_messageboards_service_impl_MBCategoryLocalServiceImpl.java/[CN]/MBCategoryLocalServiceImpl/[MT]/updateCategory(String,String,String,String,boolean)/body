{
  MBCategory category=MBCategoryUtil.findByPrimaryKey(categoryId);
  String oldCategoryId=category.getParentCategoryId();
  parentCategoryId=getParentCategoryId(category,parentCategoryId);
  validate(name);
  category.setModifiedDate(new Date());
  category.setParentCategoryId(parentCategoryId);
  category.setName(name);
  category.setDescription(description);
  MBCategoryUtil.update(category);
  if (mergeWithParentCategory && !oldCategoryId.equals(parentCategoryId) && !parentCategoryId.equals(MBCategory.DEFAULT_PARENT_CATEGORY_ID)) {
    mergeCategories(category,parentCategoryId);
  }
  return category;
}
