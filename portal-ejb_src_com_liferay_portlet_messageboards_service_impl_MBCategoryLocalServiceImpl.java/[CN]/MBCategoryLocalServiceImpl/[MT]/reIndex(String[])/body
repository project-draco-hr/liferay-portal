{
  try {
    String companyId=ids[0];
    Iterator itr1=MBTopicUtil.findByCompanyId(companyId).iterator();
    while (itr1.hasNext()) {
      MBTopic topic=(MBTopic)itr1.next();
      String topicId=topic.getTopicId();
      MBCategory category=topic.getCategory();
      Iterator itr2=MBMessageUtil.findByTopicId(topicId).iterator();
      while (itr2.hasNext()) {
        MBMessage message=(MBMessage)itr2.next();
        String groupId=category.getGroupId();
        String categoryId=category.getCategoryId();
        String threadId=message.getThreadId();
        String messageId=message.getMessageId();
        String title=message.getSubject();
        String content=message.getBody();
        try {
          Indexer.addMessage(companyId,groupId,categoryId,topicId,threadId,messageId,title,content);
        }
 catch (        Exception e1) {
          _log.error(e1.getMessage());
        }
      }
    }
  }
 catch (  SystemException se) {
    throw se;
  }
catch (  Exception e2) {
    throw new SystemException(e2);
  }
}
