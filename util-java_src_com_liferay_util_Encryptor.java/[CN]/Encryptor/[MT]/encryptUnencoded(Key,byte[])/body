{
  String algorithm=key.getAlgorithm();
  Cipher cipher=_encryptCipherMap.get(algorithm);
  try {
    if (cipher == null) {
      Security.addProvider(getProvider());
      cipher=Cipher.getInstance(algorithm);
      cipher.init(Cipher.ENCRYPT_MODE,key);
      _encryptCipherMap.put(algorithm,cipher);
    }
synchronized (cipher) {
      return cipher.doFinal(plainBytes);
    }
  }
 catch (  Exception e) {
    throw new EncryptorException(e);
  }
}
