{
  String algorithm=key.getAlgorithm();
  Cipher cipher=_decryptCipherMap.get(algorithm);
  try {
    if (cipher == null) {
      Security.addProvider(getProvider());
      cipher=Cipher.getInstance(algorithm);
      cipher.init(Cipher.DECRYPT_MODE,key);
      _decryptCipherMap.put(algorithm,cipher);
    }
synchronized (cipher) {
      return cipher.doFinal(encryptedBytes);
    }
  }
 catch (  Exception e) {
    throw new EncryptorException(e);
  }
}
