{
  String storageClass=null;
  if (path == null) {
    return null;
  }
  String[] pathArray=getPathArray(path);
  if (pathArray.length == 0) {
    storageClass=CompanySharepointStorageImpl.class.getName();
  }
 else   if (pathArray.length == 1) {
    storageClass=GroupSharepointStorageImpl.class.getName();
  }
 else   if (pathArray.length >= 2) {
    storageClass=getStorageClass(pathArray[1]);
  }
  if (_log.isInfoEnabled()) {
    _log.info("Storage class for path " + path + " is "+ storageClass);
  }
  return (SharepointStorage)InstancePool.get(storageClass);
}
