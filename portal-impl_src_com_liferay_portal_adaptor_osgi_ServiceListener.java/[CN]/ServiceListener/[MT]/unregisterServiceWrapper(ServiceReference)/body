{
  String serviceType=(String)serviceReference.getProperty(OSGiConstants.PORTAL_SERVICE_TYPE);
  ServiceReference[] previousServiceReferences=_bundleContext.getServiceReferences(serviceType,_PREVIOUS_SERVICE_FILTER);
  if ((previousServiceReferences == null) || (previousServiceReferences.length == 0)) {
    return;
  }
  ServiceReference previousServiceReference=previousServiceReferences[0];
  Object previousService=_bundleContext.getService(previousServiceReference);
  Object serviceProxy=PortalBeanLocatorUtil.locate(serviceType);
  AdvisedSupport advisedSupport=ServiceWrapperUtil.getAdvisedSupport(serviceProxy);
  TargetSource previousTargetSource=new SingletonTargetSource(previousService);
  advisedSupport.setTargetSource(previousTargetSource);
  ServiceRegistration serviceRegistration=_serviceRegistrations.get(previousServiceReference);
  serviceRegistration.unregister();
  _serviceRegistrations.remove(previousServiceReference);
}
