{
  Properties env=new Properties();
  env.put(Context.INITIAL_CONTEXT_FACTORY,PrefsPropsUtil.getString(companyId,PropsUtil.LDAP_FACTORY_INITIAL));
  env.put(Context.PROVIDER_URL,PrefsPropsUtil.getString(companyId,PropsUtil.LDAP_BASE_PROVIDER_URL));
  env.put(Context.SECURITY_PRINCIPAL,PrefsPropsUtil.getString(companyId,PropsUtil.LDAP_SECURITY_PRINCIPAL));
  env.put(Context.SECURITY_CREDENTIALS,PrefsPropsUtil.getString(companyId,PropsUtil.LDAP_SECURITY_CREDENTIALS));
  LogUtil.debug(_log,env);
  LdapContext ctx=null;
  try {
    ctx=new InitialLdapContext(env,null);
  }
 catch (  Exception e) {
    if (_log.isWarnEnabled()) {
      _log.warn("Failed to bind to the LDAP server");
    }
    if (_log.isDebugEnabled()) {
      _log.debug(e);
    }
  }
  return ctx;
}
