{
  List<ListenerDefinition> listenerDefinitions=_webXMLDefinition.getListenerDefinitions();
  for (  ListenerDefinition listenerDefinition : listenerDefinitions) {
    Dictionary<String,Object> properties=new Hashtable<>();
    properties.put(HttpWhiteboardConstants.HTTP_WHITEBOARD_CONTEXT_SELECT,_contextName);
    properties.put(HttpWhiteboardConstants.HTTP_WHITEBOARD_LISTENER,Boolean.TRUE.toString());
    String[] classNames=getClassNames(listenerDefinition.getEventListener());
    ServiceRegistration<?> serviceRegistration=_bundleContext.registerService(classNames,listenerDefinition.getEventListener(),properties);
    _listenerRegistrations.add(serviceRegistration);
    if (!ServletContextListener.class.isInstance(listenerDefinition.getEventListener())) {
      continue;
    }
    ServletContextListenerExceptionAdapter servletContextListenerExceptionAdaptor=new ServletContextListenerExceptionAdapter((ServletContextListener)listenerDefinition.getEventListener());
    serviceRegistration=_bundleContext.registerService(ServletContextListener.class,servletContextListenerExceptionAdaptor,properties);
    Exception exception=servletContextListenerExceptionAdaptor.getException();
    if (exception != null) {
      serviceRegistration.unregister();
      throw exception;
    }
    _listenerRegistrations.add(serviceRegistration);
  }
}
