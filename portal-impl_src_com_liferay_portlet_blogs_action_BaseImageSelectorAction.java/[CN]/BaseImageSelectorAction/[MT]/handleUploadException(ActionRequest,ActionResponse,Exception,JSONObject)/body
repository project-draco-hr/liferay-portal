{
  jsonObject.put("success",Boolean.FALSE);
  if (e instanceof AntivirusScannerException || e instanceof CoverImageNameException || e instanceof CoverImageSizeException|| e instanceof FileNameException) {
    String errorMessage=StringPool.BLANK;
    int errorType=0;
    ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
    if (e instanceof AntivirusScannerException) {
      errorType=ServletResponseConstants.SC_FILE_ANTIVIRUS_EXCEPTION;
      AntivirusScannerException ase=(AntivirusScannerException)e;
      errorMessage=themeDisplay.translate(ase.getMessageKey());
    }
 else     if (e instanceof CoverImageNameException) {
      errorType=ServletResponseConstants.SC_FILE_EXTENSION_EXCEPTION;
    }
 else     if (e instanceof CoverImageSizeException) {
      errorType=ServletResponseConstants.SC_FILE_SIZE_EXCEPTION;
    }
 else     if (e instanceof FileNameException) {
      errorType=ServletResponseConstants.SC_FILE_NAME_EXCEPTION;
    }
    JSONObject errorJSONObject=JSONFactoryUtil.createJSONObject();
    errorJSONObject.put("errorType",errorType);
    errorJSONObject.put("message",errorMessage);
    jsonObject.put("error",errorJSONObject);
    writeJSON(actionRequest,actionResponse,jsonObject);
  }
 else {
    throw e;
  }
}
