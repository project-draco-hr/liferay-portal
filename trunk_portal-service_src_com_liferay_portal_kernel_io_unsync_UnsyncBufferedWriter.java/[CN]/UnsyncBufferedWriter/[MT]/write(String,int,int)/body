{
  if (writer == null) {
    throw new IOException("Writer is null");
  }
  int x=offset;
  int y=offset + length;
  while (x < y) {
    if (count >= size) {
      writer.write(buffer);
      count=0;
    }
    int leftFreeSpace=size - count;
    int leftDataSize=y - x;
    if (leftFreeSpace > leftDataSize) {
      string.getChars(x,y,buffer,count);
      count+=leftDataSize;
      break;
    }
 else {
      int copyEnd=x + leftFreeSpace;
      string.getChars(x,copyEnd,buffer,count);
      count+=leftFreeSpace;
      x=copyEnd;
    }
  }
}
