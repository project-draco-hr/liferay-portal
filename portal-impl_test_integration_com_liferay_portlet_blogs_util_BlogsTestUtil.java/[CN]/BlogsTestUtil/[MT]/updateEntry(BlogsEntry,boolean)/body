{
  boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
  try {
    WorkflowThreadLocal.setEnabled(true);
    ServiceContext serviceContext=ServiceTestUtil.getServiceContext(entry.getGroupId());
    serviceContext.setCommand(Constants.UPDATE);
    serviceContext.setLayoutFullURL("http://localhost");
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
    entry=BlogsEntryLocalServiceUtil.updateEntry(entry.getUserId(),entry.getEntryId(),ServiceTestUtil.randomString(),entry.getDescription(),entry.getContent(),1,1,2012,12,00,true,true,new String[0],entry.getSmallImage(),entry.getSmallImageURL(),StringPool.BLANK,null,serviceContext);
    if (approved) {
      return updateStatus(entry,serviceContext);
    }
    return entry;
  }
  finally {
    WorkflowThreadLocal.setEnabled(workflowEnabled);
  }
}
