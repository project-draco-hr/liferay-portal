{
  boolean workflowEnabled=WorkflowThreadLocal.isEnabled();
  try {
    WorkflowThreadLocal.setEnabled(true);
    String description="Description";
    String content="Content";
    int displayDateMonth=1;
    int displayDateDay=1;
    int displayDateYear=2012;
    int displayDateHour=12;
    int displayDateMinute=0;
    boolean allowPingbacks=true;
    boolean allowTrackbacks=true;
    String[] trackbacks=new String[0];
    boolean smallImage=false;
    String smallImageURL=StringPool.BLANK;
    String smallImageFileName=StringPool.BLANK;
    InputStream smallImageInputStream=null;
    ServiceContext serviceContext=ServiceTestUtil.getServiceContext(group.getGroupId());
    serviceContext.setWorkflowAction(WorkflowConstants.ACTION_SAVE_DRAFT);
    BlogsEntry entry=BlogsEntryLocalServiceUtil.addEntry(userId,title,description,content,displayDateMonth,displayDateDay,displayDateYear,displayDateHour,displayDateMinute,allowPingbacks,allowTrackbacks,trackbacks,smallImage,smallImageURL,smallImageFileName,smallImageInputStream,serviceContext);
    if (approved) {
      entry=BlogsEntryLocalServiceUtil.updateStatus(userId,entry.getEntryId(),WorkflowConstants.STATUS_APPROVED,serviceContext);
    }
    return entry;
  }
  finally {
    WorkflowThreadLocal.setEnabled(workflowEnabled);
  }
}
