{
  Map<String,Map<String,String>> fieldsMap1=_localizedFieldsMap1.get(locale);
  Map<String,Map<String,String>> fieldsMap2=_localizedFieldsMap2.get(locale);
  if (fieldsMap1 == null) {
    if (getParentStructureId() > 0) {
      DDMStructure parentStructure=DDMStructureLocalServiceUtil.getStructure(getParentStructureId());
      fieldsMap1=parentStructure.getFieldsMap(locale);
      fieldsMap2=parentStructure.getTransientFieldsMap(locale);
    }
 else {
      fieldsMap1=new LinkedHashMap<String,Map<String,String>>();
      fieldsMap2=new LinkedHashMap<String,Map<String,String>>();
    }
    XPath xPathSelector=SAXReaderUtil.createXPath("//dynamic-element");
    List<Node> nodes=xPathSelector.selectNodes(getDocument());
    for (    Node node : nodes) {
      Element element=(Element)node;
      String name=element.attributeValue("name");
      if (Validator.isNotNull(element.attributeValue("dataType"))) {
        fieldsMap1.put(name,_getField(element,locale));
      }
 else {
        fieldsMap2.put(name,_getField(element,locale));
      }
    }
    _localizedFieldsMap1.put(locale,fieldsMap1);
    _localizedFieldsMap2.put(locale,fieldsMap2);
  }
}
