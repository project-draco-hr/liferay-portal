{
  Map<String,Map<String,String>> fieldsMap=_localizedFieldsMap.get(locale);
  if (fieldsMap == null) {
    fieldsMap=new LinkedHashMap<String,Map<String,String>>();
    if (getParentStructureId() > 0) {
      DDMStructure parentStructure=null;
      parentStructure=DDMStructureLocalServiceUtil.getStructure(getParentStructureId());
      fieldsMap=parentStructure.getFieldsMap(locale);
    }
    XPath xPathSelector=SAXReaderUtil.createXPath("//dynamic-element[@dataType]");
    List<Node> nodes=xPathSelector.selectNodes(getDocument());
    for (    Node node : nodes) {
      Element element=(Element)node;
      String name=element.attributeValue("name");
      fieldsMap.put(name,_getField(element,locale));
    }
    _localizedFieldsMap.put(locale,fieldsMap);
  }
  return fieldsMap;
}
